/*! For license information please see main.f4a1c0e4.js.LICENSE.txt */
(()=>{var e={8210:function(e,t,n){var r;!function(){"use strict";var i,o=1e9,a={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},s=!0,l="[DecimalError] ",c=l+"Invalid argument: ",u=l+"Exponent out of range: ",h=Math.floor,d=Math.pow,p=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,f=1e7,m=9007199254740991,g=h(1286742750677284.5),y={};function _(e,t){var n,r,i,o,a,l,c,u,h=e.constructor,d=h.precision;if(!e.s||!t.s)return t.s||(t=new h(e)),s?P(t,d):t;if(c=e.d,u=t.d,a=e.e,i=t.e,c=c.slice(),o=a-i){for(o<0?(r=c,o=-o,l=u.length):(r=u,i=a,l=c.length),o>(l=(a=Math.ceil(d/7))>l?a+1:l+1)&&(o=l,r.length=1),r.reverse();o--;)r.push(0);r.reverse()}for((l=c.length)-(o=u.length)<0&&(o=l,r=u,u=c,c=r),n=0;o;)n=(c[--o]=c[o]+u[o]+n)/f|0,c[o]%=f;for(n&&(c.unshift(n),++i),l=c.length;0==c[--l];)c.pop();return t.d=c,t.e=i,s?P(t,d):t}function v(e,t,n){if(e!==~~e||e<t||e>n)throw Error(c+e)}function x(e){var t,n,r,i=e.length-1,o="",a=e[0];if(i>0){for(o+=a,t=1;t<i;t++)(n=7-(r=e[t]+"").length)&&(o+=E(n)),o+=r;(n=7-(r=(a=e[t])+"").length)&&(o+=E(n))}else if(0===a)return"0";for(;a%10===0;)a/=10;return o+a}y.absoluteValue=y.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e},y.comparedTo=y.cmp=function(e){var t,n,r,i,o=this;if(e=new o.constructor(e),o.s!==e.s)return o.s||-e.s;if(o.e!==e.e)return o.e>e.e^o.s<0?1:-1;for(t=0,n=(r=o.d.length)<(i=e.d.length)?r:i;t<n;++t)if(o.d[t]!==e.d[t])return o.d[t]>e.d[t]^o.s<0?1:-1;return r===i?0:r>i^o.s<0?1:-1},y.decimalPlaces=y.dp=function(){var e=this,t=e.d.length-1,n=7*(t-e.e);if(t=e.d[t])for(;t%10==0;t/=10)n--;return n<0?0:n},y.dividedBy=y.div=function(e){return b(this,new this.constructor(e))},y.dividedToIntegerBy=y.idiv=function(e){var t=this.constructor;return P(b(this,new t(e),0,1),t.precision)},y.equals=y.eq=function(e){return!this.cmp(e)},y.exponent=function(){return S(this)},y.greaterThan=y.gt=function(e){return this.cmp(e)>0},y.greaterThanOrEqualTo=y.gte=function(e){return this.cmp(e)>=0},y.isInteger=y.isint=function(){return this.e>this.d.length-2},y.isNegative=y.isneg=function(){return this.s<0},y.isPositive=y.ispos=function(){return this.s>0},y.isZero=function(){return 0===this.s},y.lessThan=y.lt=function(e){return this.cmp(e)<0},y.lessThanOrEqualTo=y.lte=function(e){return this.cmp(e)<1},y.logarithm=y.log=function(e){var t,n=this,r=n.constructor,o=r.precision,a=o+5;if(void 0===e)e=new r(10);else if((e=new r(e)).s<1||e.eq(i))throw Error(l+"NaN");if(n.s<1)throw Error(l+(n.s?"NaN":"-Infinity"));return n.eq(i)?new r(0):(s=!1,t=b(A(n,a),A(e,a),a),s=!0,P(t,o))},y.minus=y.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?k(t,e):_(t,(e.s=-e.s,e))},y.modulo=y.mod=function(e){var t,n=this,r=n.constructor,i=r.precision;if(!(e=new r(e)).s)throw Error(l+"NaN");return n.s?(s=!1,t=b(n,e,0,1).times(e),s=!0,n.minus(t)):P(new r(n),i)},y.naturalExponential=y.exp=function(){return w(this)},y.naturalLogarithm=y.ln=function(){return A(this)},y.negated=y.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e},y.plus=y.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?_(t,e):k(t,(e.s=-e.s,e))},y.precision=y.sd=function(e){var t,n,r,i=this;if(void 0!==e&&e!==!!e&&1!==e&&0!==e)throw Error(c+e);if(t=S(i)+1,n=7*(r=i.d.length-1)+1,r=i.d[r]){for(;r%10==0;r/=10)n--;for(r=i.d[0];r>=10;r/=10)n++}return e&&t>n?t:n},y.squareRoot=y.sqrt=function(){var e,t,n,r,i,o,a,c=this,u=c.constructor;if(c.s<1){if(!c.s)return new u(0);throw Error(l+"NaN")}for(e=S(c),s=!1,0==(i=Math.sqrt(+c))||i==1/0?(((t=x(c.d)).length+e)%2==0&&(t+="0"),i=Math.sqrt(t),e=h((e+1)/2)-(e<0||e%2),r=new u(t=i==1/0?"5e"+e:(t=i.toExponential()).slice(0,t.indexOf("e")+1)+e)):r=new u(i.toString()),i=a=(n=u.precision)+3;;)if(r=(o=r).plus(b(c,o,a+2)).times(.5),x(o.d).slice(0,a)===(t=x(r.d)).slice(0,a)){if(t=t.slice(a-3,a+1),i==a&&"4999"==t){if(P(o,n+1,0),o.times(o).eq(c)){r=o;break}}else if("9999"!=t)break;a+=4}return s=!0,P(r,n)},y.times=y.mul=function(e){var t,n,r,i,o,a,l,c,u,h=this,d=h.constructor,p=h.d,m=(e=new d(e)).d;if(!h.s||!e.s)return new d(0);for(e.s*=h.s,n=h.e+e.e,(c=p.length)<(u=m.length)&&(o=p,p=m,m=o,a=c,c=u,u=a),o=[],r=a=c+u;r--;)o.push(0);for(r=u;--r>=0;){for(t=0,i=c+r;i>r;)l=o[i]+m[r]*p[i-r-1]+t,o[i--]=l%f|0,t=l/f|0;o[i]=(o[i]+t)%f|0}for(;!o[--a];)o.pop();return t?++n:o.shift(),e.d=o,e.e=n,s?P(e,d.precision):e},y.toDecimalPlaces=y.todp=function(e,t){var n=this,r=n.constructor;return n=new r(n),void 0===e?n:(v(e,0,o),void 0===t?t=r.rounding:v(t,0,8),P(n,e+S(n)+1,t))},y.toExponential=function(e,t){var n,r=this,i=r.constructor;return void 0===e?n=C(r,!0):(v(e,0,o),void 0===t?t=i.rounding:v(t,0,8),n=C(r=P(new i(r),e+1,t),!0,e+1)),n},y.toFixed=function(e,t){var n,r,i=this,a=i.constructor;return void 0===e?C(i):(v(e,0,o),void 0===t?t=a.rounding:v(t,0,8),n=C((r=P(new a(i),e+S(i)+1,t)).abs(),!1,e+S(r)+1),i.isneg()&&!i.isZero()?"-"+n:n)},y.toInteger=y.toint=function(){var e=this,t=e.constructor;return P(new t(e),S(e)+1,t.rounding)},y.toNumber=function(){return+this},y.toPower=y.pow=function(e){var t,n,r,o,a,c,u=this,d=u.constructor,p=+(e=new d(e));if(!e.s)return new d(i);if(!(u=new d(u)).s){if(e.s<1)throw Error(l+"Infinity");return u}if(u.eq(i))return u;if(r=d.precision,e.eq(i))return P(u,r);if(c=(t=e.e)>=(n=e.d.length-1),a=u.s,c){if((n=p<0?-p:p)<=m){for(o=new d(i),t=Math.ceil(r/7+4),s=!1;n%2&&j((o=o.times(u)).d,t),0!==(n=h(n/2));)j((u=u.times(u)).d,t);return s=!0,e.s<0?new d(i).div(o):P(o,r)}}else if(a<0)throw Error(l+"NaN");return a=a<0&&1&e.d[Math.max(t,n)]?-1:1,u.s=1,s=!1,o=e.times(A(u,r+12)),s=!0,(o=w(o)).s=a,o},y.toPrecision=function(e,t){var n,r,i=this,a=i.constructor;return void 0===e?r=C(i,(n=S(i))<=a.toExpNeg||n>=a.toExpPos):(v(e,1,o),void 0===t?t=a.rounding:v(t,0,8),r=C(i=P(new a(i),e,t),e<=(n=S(i))||n<=a.toExpNeg,e)),r},y.toSignificantDigits=y.tosd=function(e,t){var n=this.constructor;return void 0===e?(e=n.precision,t=n.rounding):(v(e,1,o),void 0===t?t=n.rounding:v(t,0,8)),P(new n(this),e,t)},y.toString=y.valueOf=y.val=y.toJSON=function(){var e=this,t=S(e),n=e.constructor;return C(e,t<=n.toExpNeg||t>=n.toExpPos)};var b=function(){function e(e,t){var n,r=0,i=e.length;for(e=e.slice();i--;)n=e[i]*t+r,e[i]=n%f|0,r=n/f|0;return r&&e.unshift(r),e}function t(e,t,n,r){var i,o;if(n!=r)o=n>r?1:-1;else for(i=o=0;i<n;i++)if(e[i]!=t[i]){o=e[i]>t[i]?1:-1;break}return o}function n(e,t,n){for(var r=0;n--;)e[n]-=r,r=e[n]<t[n]?1:0,e[n]=r*f+e[n]-t[n];for(;!e[0]&&e.length>1;)e.shift()}return function(r,i,o,a){var s,c,u,h,d,p,m,g,y,_,v,x,b,w,T,E,A,M,k=r.constructor,C=r.s==i.s?1:-1,j=r.d,I=i.d;if(!r.s)return new k(r);if(!i.s)throw Error(l+"Division by zero");for(c=r.e-i.e,A=I.length,T=j.length,g=(m=new k(C)).d=[],u=0;I[u]==(j[u]||0);)++u;if(I[u]>(j[u]||0)&&--c,(x=null==o?o=k.precision:a?o+(S(r)-S(i))+1:o)<0)return new k(0);if(x=x/7+2|0,u=0,1==A)for(h=0,I=I[0],x++;(u<T||h)&&x--;u++)b=h*f+(j[u]||0),g[u]=b/I|0,h=b%I|0;else{for((h=f/(I[0]+1)|0)>1&&(I=e(I,h),j=e(j,h),A=I.length,T=j.length),w=A,_=(y=j.slice(0,A)).length;_<A;)y[_++]=0;(M=I.slice()).unshift(0),E=I[0],I[1]>=f/2&&++E;do{h=0,(s=t(I,y,A,_))<0?(v=y[0],A!=_&&(v=v*f+(y[1]||0)),(h=v/E|0)>1?(h>=f&&(h=f-1),1==(s=t(d=e(I,h),y,p=d.length,_=y.length))&&(h--,n(d,A<p?M:I,p))):(0==h&&(s=h=1),d=I.slice()),(p=d.length)<_&&d.unshift(0),n(y,d,_),-1==s&&(s=t(I,y,A,_=y.length))<1&&(h++,n(y,A<_?M:I,_)),_=y.length):0===s&&(h++,y=[0]),g[u++]=h,s&&y[0]?y[_++]=j[w]||0:(y=[j[w]],_=1)}while((w++<T||void 0!==y[0])&&x--)}return g[0]||g.shift(),m.e=c,P(m,a?o+S(m)+1:o)}}();function w(e,t){var n,r,o,a,l,c=0,h=0,p=e.constructor,f=p.precision;if(S(e)>16)throw Error(u+S(e));if(!e.s)return new p(i);for(null==t?(s=!1,l=f):l=t,a=new p(.03125);e.abs().gte(.1);)e=e.times(a),h+=5;for(l+=Math.log(d(2,h))/Math.LN10*2+5|0,n=r=o=new p(i),p.precision=l;;){if(r=P(r.times(e),l),n=n.times(++c),x((a=o.plus(b(r,n,l))).d).slice(0,l)===x(o.d).slice(0,l)){for(;h--;)o=P(o.times(o),l);return p.precision=f,null==t?(s=!0,P(o,f)):o}o=a}}function S(e){for(var t=7*e.e,n=e.d[0];n>=10;n/=10)t++;return t}function T(e,t,n){if(t>e.LN10.sd())throw s=!0,n&&(e.precision=n),Error(l+"LN10 precision limit exceeded");return P(new e(e.LN10),t)}function E(e){for(var t="";e--;)t+="0";return t}function A(e,t){var n,r,o,a,c,u,h,d,p,f=1,m=e,g=m.d,y=m.constructor,_=y.precision;if(m.s<1)throw Error(l+(m.s?"NaN":"-Infinity"));if(m.eq(i))return new y(0);if(null==t?(s=!1,d=_):d=t,m.eq(10))return null==t&&(s=!0),T(y,d);if(d+=10,y.precision=d,r=(n=x(g)).charAt(0),a=S(m),!(Math.abs(a)<15e14))return h=T(y,d+2,_).times(a+""),m=A(new y(r+"."+n.slice(1)),d-10).plus(h),y.precision=_,null==t?(s=!0,P(m,_)):m;for(;r<7&&1!=r||1==r&&n.charAt(1)>3;)r=(n=x((m=m.times(e)).d)).charAt(0),f++;for(a=S(m),r>1?(m=new y("0."+n),a++):m=new y(r+"."+n.slice(1)),u=c=m=b(m.minus(i),m.plus(i),d),p=P(m.times(m),d),o=3;;){if(c=P(c.times(p),d),x((h=u.plus(b(c,new y(o),d))).d).slice(0,d)===x(u.d).slice(0,d))return u=u.times(2),0!==a&&(u=u.plus(T(y,d+2,_).times(a+""))),u=b(u,new y(f),d),y.precision=_,null==t?(s=!0,P(u,_)):u;u=h,o+=2}}function M(e,t){var n,r,i;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(n<0&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):n<0&&(n=t.length),r=0;48===t.charCodeAt(r);)++r;for(i=t.length;48===t.charCodeAt(i-1);)--i;if(t=t.slice(r,i)){if(i-=r,n=n-r-1,e.e=h(n/7),e.d=[],r=(n+1)%7,n<0&&(r+=7),r<i){for(r&&e.d.push(+t.slice(0,r)),i-=7;r<i;)e.d.push(+t.slice(r,r+=7));r=7-(t=t.slice(r)).length}else r-=i;for(;r--;)t+="0";if(e.d.push(+t),s&&(e.e>g||e.e<-g))throw Error(u+n)}else e.s=0,e.e=0,e.d=[0];return e}function P(e,t,n){var r,i,o,a,l,c,p,m,y=e.d;for(a=1,o=y[0];o>=10;o/=10)a++;if((r=t-a)<0)r+=7,i=t,p=y[m=0];else{if((m=Math.ceil((r+1)/7))>=(o=y.length))return e;for(p=o=y[m],a=1;o>=10;o/=10)a++;i=(r%=7)-7+a}if(void 0!==n&&(l=p/(o=d(10,a-i-1))%10|0,c=t<0||void 0!==y[m+1]||p%o,c=n<4?(l||c)&&(0==n||n==(e.s<0?3:2)):l>5||5==l&&(4==n||c||6==n&&(r>0?i>0?p/d(10,a-i):0:y[m-1])%10&1||n==(e.s<0?8:7))),t<1||!y[0])return c?(o=S(e),y.length=1,t=t-o-1,y[0]=d(10,(7-t%7)%7),e.e=h(-t/7)||0):(y.length=1,y[0]=e.e=e.s=0),e;if(0==r?(y.length=m,o=1,m--):(y.length=m+1,o=d(10,7-r),y[m]=i>0?(p/d(10,a-i)%d(10,i)|0)*o:0),c)for(;;){if(0==m){(y[0]+=o)==f&&(y[0]=1,++e.e);break}if(y[m]+=o,y[m]!=f)break;y[m--]=0,o=1}for(r=y.length;0===y[--r];)y.pop();if(s&&(e.e>g||e.e<-g))throw Error(u+S(e));return e}function k(e,t){var n,r,i,o,a,l,c,u,h,d,p=e.constructor,m=p.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new p(e),s?P(t,m):t;if(c=e.d,d=t.d,r=t.e,u=e.e,c=c.slice(),a=u-r){for((h=a<0)?(n=c,a=-a,l=d.length):(n=d,r=u,l=c.length),a>(i=Math.max(Math.ceil(m/7),l)+2)&&(a=i,n.length=1),n.reverse(),i=a;i--;)n.push(0);n.reverse()}else{for((h=(i=c.length)<(l=d.length))&&(l=i),i=0;i<l;i++)if(c[i]!=d[i]){h=c[i]<d[i];break}a=0}for(h&&(n=c,c=d,d=n,t.s=-t.s),l=c.length,i=d.length-l;i>0;--i)c[l++]=0;for(i=d.length;i>a;){if(c[--i]<d[i]){for(o=i;o&&0===c[--o];)c[o]=f-1;--c[o],c[i]+=f}c[i]-=d[i]}for(;0===c[--l];)c.pop();for(;0===c[0];c.shift())--r;return c[0]?(t.d=c,t.e=r,s?P(t,m):t):new p(0)}function C(e,t,n){var r,i=S(e),o=x(e.d),a=o.length;return t?(n&&(r=n-a)>0?o=o.charAt(0)+"."+o.slice(1)+E(r):a>1&&(o=o.charAt(0)+"."+o.slice(1)),o=o+(i<0?"e":"e+")+i):i<0?(o="0."+E(-i-1)+o,n&&(r=n-a)>0&&(o+=E(r))):i>=a?(o+=E(i+1-a),n&&(r=n-i-1)>0&&(o=o+"."+E(r))):((r=i+1)<a&&(o=o.slice(0,r)+"."+o.slice(r)),n&&(r=n-a)>0&&(i+1===a&&(o+="."),o+=E(r))),e.s<0?"-"+o:o}function j(e,t){if(e.length>t)return e.length=t,!0}function I(e){if(!e||"object"!==typeof e)throw Error(l+"Object expected");var t,n,r,i=["precision",1,o,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<i.length;t+=3)if(void 0!==(r=e[n=i[t]])){if(!(h(r)===r&&r>=i[t+1]&&r<=i[t+2]))throw Error(c+n+": "+r);this[n]=r}if(void 0!==(r=e[n="LN10"])){if(r!=Math.LN10)throw Error(c+n+": "+r);this[n]=new this(r)}return this}a=function e(t){var n,r,i;function o(e){var t=this;if(!(t instanceof o))return new o(e);if(t.constructor=o,e instanceof o)return t.s=e.s,t.e=e.e,void(t.d=(e=e.d)?e.slice():e);if("number"===typeof e){if(0*e!==0)throw Error(c+e);if(e>0)t.s=1;else{if(!(e<0))return t.s=0,t.e=0,void(t.d=[0]);e=-e,t.s=-1}return e===~~e&&e<1e7?(t.e=0,void(t.d=[e])):M(t,e.toString())}if("string"!==typeof e)throw Error(c+e);if(45===e.charCodeAt(0)?(e=e.slice(1),t.s=-1):t.s=1,!p.test(e))throw Error(c+e);M(t,e)}if(o.prototype=y,o.ROUND_UP=0,o.ROUND_DOWN=1,o.ROUND_CEIL=2,o.ROUND_FLOOR=3,o.ROUND_HALF_UP=4,o.ROUND_HALF_DOWN=5,o.ROUND_HALF_EVEN=6,o.ROUND_HALF_CEIL=7,o.ROUND_HALF_FLOOR=8,o.clone=e,o.config=o.set=I,void 0===t&&(t={}),t)for(i=["precision","rounding","toExpNeg","toExpPos","LN10"],n=0;n<i.length;)t.hasOwnProperty(r=i[n++])||(t[r]=this[r]);return o.config(t),o}(a),a.default=a.Decimal=a,i=new a(1),void 0===(r=function(){return a}.call(t,n,t,e))||(e.exports=r)}()},7283:e=>{"use strict";var t=Object.prototype.hasOwnProperty,n="~";function r(){}function i(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function o(e,t,r,o,a){if("function"!==typeof r)throw new TypeError("The listener must be a function");var s=new i(r,o||e,a),l=n?n+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],s]:e._events[l].push(s):(e._events[l]=s,e._eventsCount++),e}function a(e,t){0===--e._eventsCount?e._events=new r:delete e._events[t]}function s(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),s.prototype.eventNames=function(){var e,r,i=[];if(0===this._eventsCount)return i;for(r in e=this._events)t.call(e,r)&&i.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},s.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,o=r.length,a=new Array(o);i<o;i++)a[i]=r[i].fn;return a},s.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},s.prototype.emit=function(e,t,r,i,o,a){var s=n?n+e:e;if(!this._events[s])return!1;var l,c,u=this._events[s],h=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),h){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,r),!0;case 4:return u.fn.call(u.context,t,r,i),!0;case 5:return u.fn.call(u.context,t,r,i,o),!0;case 6:return u.fn.call(u.context,t,r,i,o,a),!0}for(c=1,l=new Array(h-1);c<h;c++)l[c-1]=arguments[c];u.fn.apply(u.context,l)}else{var d,p=u.length;for(c=0;c<p;c++)switch(u[c].once&&this.removeListener(e,u[c].fn,void 0,!0),h){case 1:u[c].fn.call(u[c].context);break;case 2:u[c].fn.call(u[c].context,t);break;case 3:u[c].fn.call(u[c].context,t,r);break;case 4:u[c].fn.call(u[c].context,t,r,i);break;default:if(!l)for(d=1,l=new Array(h-1);d<h;d++)l[d-1]=arguments[d];u[c].fn.apply(u[c].context,l)}}return!0},s.prototype.on=function(e,t,n){return o(this,e,t,n,!1)},s.prototype.once=function(e,t,n){return o(this,e,t,n,!0)},s.prototype.removeListener=function(e,t,r,i){var o=n?n+e:e;if(!this._events[o])return this;if(!t)return a(this,o),this;var s=this._events[o];if(s.fn)s.fn!==t||i&&!s.once||r&&s.context!==r||a(this,o);else{for(var l=0,c=[],u=s.length;l<u;l++)(s[l].fn!==t||i&&!s[l].once||r&&s[l].context!==r)&&c.push(s[l]);c.length?this._events[o]=1===c.length?c[0]:c:a(this,o)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&a(this,t)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,e.exports=s},228:function(e,t){!function(e){"use strict";var t="1.9.4";function n(e){var t,n,r,i;for(n=1,r=arguments.length;n<r;n++)for(t in i=arguments[n])e[t]=i[t];return e}var r=Object.create||function(){function e(){}return function(t){return e.prototype=t,new e}}();function i(e,t){var n=Array.prototype.slice;if(e.bind)return e.bind.apply(e,n.call(arguments,1));var r=n.call(arguments,2);return function(){return e.apply(t,r.length?r.concat(n.call(arguments)):arguments)}}var o=0;function a(e){return"_leaflet_id"in e||(e._leaflet_id=++o),e._leaflet_id}function s(e,t,n){var r,i,o,a;return a=function(){r=!1,i&&(o.apply(n,i),i=!1)},o=function(){r?i=arguments:(e.apply(n,arguments),setTimeout(a,t),r=!0)},o}function l(e,t,n){var r=t[1],i=t[0],o=r-i;return e===r&&n?e:((e-i)%o+o)%o+i}function c(){return!1}function u(e,t){if(!1===t)return e;var n=Math.pow(10,void 0===t?6:t);return Math.round(e*n)/n}function h(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function d(e){return h(e).split(/\s+/)}function p(e,t){for(var n in Object.prototype.hasOwnProperty.call(e,"options")||(e.options=e.options?r(e.options):{}),t)e.options[n]=t[n];return e.options}function f(e,t,n){var r=[];for(var i in e)r.push(encodeURIComponent(n?i.toUpperCase():i)+"="+encodeURIComponent(e[i]));return(t&&-1!==t.indexOf("?")?"&":"?")+r.join("&")}var m=/\{ *([\w_ -]+) *\}/g;function g(e,t){return e.replace(m,(function(e,n){var r=t[n];if(void 0===r)throw new Error("No value provided for variable "+e);return"function"===typeof r&&(r=r(t)),r}))}var y=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function _(e,t){for(var n=0;n<e.length;n++)if(e[n]===t)return n;return-1}var v="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function x(e){return window["webkit"+e]||window["moz"+e]||window["ms"+e]}var b=0;function w(e){var t=+new Date,n=Math.max(0,16-(t-b));return b=t+n,window.setTimeout(e,n)}var S=window.requestAnimationFrame||x("RequestAnimationFrame")||w,T=window.cancelAnimationFrame||x("CancelAnimationFrame")||x("CancelRequestAnimationFrame")||function(e){window.clearTimeout(e)};function E(e,t,n){if(!n||S!==w)return S.call(window,i(e,t));e.call(t)}function A(e){e&&T.call(window,e)}var M={__proto__:null,extend:n,create:r,bind:i,get lastId(){return o},stamp:a,throttle:s,wrapNum:l,falseFn:c,formatNum:u,trim:h,splitWords:d,setOptions:p,getParamString:f,template:g,isArray:y,indexOf:_,emptyImageUrl:v,requestFn:S,cancelFn:T,requestAnimFrame:E,cancelAnimFrame:A};function P(){}function k(e){if("undefined"!==typeof L&&L&&L.Mixin){e=y(e)?e:[e];for(var t=0;t<e.length;t++)e[t]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",(new Error).stack)}}P.extend=function(e){var t=function(){p(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},i=t.__super__=this.prototype,o=r(i);for(var a in o.constructor=t,t.prototype=o,this)Object.prototype.hasOwnProperty.call(this,a)&&"prototype"!==a&&"__super__"!==a&&(t[a]=this[a]);return e.statics&&n(t,e.statics),e.includes&&(k(e.includes),n.apply(null,[o].concat(e.includes))),n(o,e),delete o.statics,delete o.includes,o.options&&(o.options=i.options?r(i.options):{},n(o.options,e.options)),o._initHooks=[],o.callInitHooks=function(){if(!this._initHooksCalled){i.callInitHooks&&i.callInitHooks.call(this),this._initHooksCalled=!0;for(var e=0,t=o._initHooks.length;e<t;e++)o._initHooks[e].call(this)}},t},P.include=function(e){var t=this.prototype.options;return n(this.prototype,e),e.options&&(this.prototype.options=t,this.mergeOptions(e.options)),this},P.mergeOptions=function(e){return n(this.prototype.options,e),this},P.addInitHook=function(e){var t=Array.prototype.slice.call(arguments,1),n="function"===typeof e?e:function(){this[e].apply(this,t)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(n),this};var C={on:function(e,t,n){if("object"===typeof e)for(var r in e)this._on(r,e[r],t);else for(var i=0,o=(e=d(e)).length;i<o;i++)this._on(e[i],t,n);return this},off:function(e,t,n){if(arguments.length)if("object"===typeof e)for(var r in e)this._off(r,e[r],t);else{e=d(e);for(var i=1===arguments.length,o=0,a=e.length;o<a;o++)i?this._off(e[o]):this._off(e[o],t,n)}else delete this._events;return this},_on:function(e,t,n,r){if("function"===typeof t){if(!1===this._listens(e,t,n)){n===this&&(n=void 0);var i={fn:t,ctx:n};r&&(i.once=!0),this._events=this._events||{},this._events[e]=this._events[e]||[],this._events[e].push(i)}}else console.warn("wrong listener type: "+typeof t)},_off:function(e,t,n){var r,i,o;if(this._events&&(r=this._events[e]))if(1!==arguments.length)if("function"===typeof t){var a=this._listens(e,t,n);if(!1!==a){var s=r[a];this._firingCount&&(s.fn=c,this._events[e]=r=r.slice()),r.splice(a,1)}}else console.warn("wrong listener type: "+typeof t);else{if(this._firingCount)for(i=0,o=r.length;i<o;i++)r[i].fn=c;delete this._events[e]}},fire:function(e,t,r){if(!this.listens(e,r))return this;var i=n({},t,{type:e,target:this,sourceTarget:t&&t.sourceTarget||this});if(this._events){var o=this._events[e];if(o){this._firingCount=this._firingCount+1||1;for(var a=0,s=o.length;a<s;a++){var l=o[a],c=l.fn;l.once&&this.off(e,c,l.ctx),c.call(l.ctx||this,i)}this._firingCount--}}return r&&this._propagateEvent(i),this},listens:function(e,t,n,r){"string"!==typeof e&&console.warn('"string" type argument expected');var i=t;"function"!==typeof t&&(r=!!t,i=void 0,n=void 0);var o=this._events&&this._events[e];if(o&&o.length&&!1!==this._listens(e,i,n))return!0;if(r)for(var a in this._eventParents)if(this._eventParents[a].listens(e,t,n,r))return!0;return!1},_listens:function(e,t,n){if(!this._events)return!1;var r=this._events[e]||[];if(!t)return!!r.length;n===this&&(n=void 0);for(var i=0,o=r.length;i<o;i++)if(r[i].fn===t&&r[i].ctx===n)return i;return!1},once:function(e,t,n){if("object"===typeof e)for(var r in e)this._on(r,e[r],t,!0);else for(var i=0,o=(e=d(e)).length;i<o;i++)this._on(e[i],t,n,!0);return this},addEventParent:function(e){return this._eventParents=this._eventParents||{},this._eventParents[a(e)]=e,this},removeEventParent:function(e){return this._eventParents&&delete this._eventParents[a(e)],this},_propagateEvent:function(e){for(var t in this._eventParents)this._eventParents[t].fire(e.type,n({layer:e.target,propagatedFrom:e.target},e),!0)}};C.addEventListener=C.on,C.removeEventListener=C.clearAllEventListeners=C.off,C.addOneTimeEventListener=C.once,C.fireEvent=C.fire,C.hasEventListeners=C.listens;var j=P.extend(C);function I(e,t,n){this.x=n?Math.round(e):e,this.y=n?Math.round(t):t}var O=Math.trunc||function(e){return e>0?Math.floor(e):Math.ceil(e)};function N(e,t,n){return e instanceof I?e:y(e)?new I(e[0],e[1]):void 0===e||null===e?e:"object"===typeof e&&"x"in e&&"y"in e?new I(e.x,e.y):new I(e,t,n)}function D(e,t){if(e)for(var n=t?[e,t]:e,r=0,i=n.length;r<i;r++)this.extend(n[r])}function z(e,t){return!e||e instanceof D?e:new D(e,t)}function R(e,t){if(e)for(var n=t?[e,t]:e,r=0,i=n.length;r<i;r++)this.extend(n[r])}function F(e,t){return e instanceof R?e:new R(e,t)}function B(e,t,n){if(isNaN(e)||isNaN(t))throw new Error("Invalid LatLng object: ("+e+", "+t+")");this.lat=+e,this.lng=+t,void 0!==n&&(this.alt=+n)}function V(e,t,n){return e instanceof B?e:y(e)&&"object"!==typeof e[0]?3===e.length?new B(e[0],e[1],e[2]):2===e.length?new B(e[0],e[1]):null:void 0===e||null===e?e:"object"===typeof e&&"lat"in e?new B(e.lat,"lng"in e?e.lng:e.lon,e.alt):void 0===t?null:new B(e,t,n)}I.prototype={clone:function(){return new I(this.x,this.y)},add:function(e){return this.clone()._add(N(e))},_add:function(e){return this.x+=e.x,this.y+=e.y,this},subtract:function(e){return this.clone()._subtract(N(e))},_subtract:function(e){return this.x-=e.x,this.y-=e.y,this},divideBy:function(e){return this.clone()._divideBy(e)},_divideBy:function(e){return this.x/=e,this.y/=e,this},multiplyBy:function(e){return this.clone()._multiplyBy(e)},_multiplyBy:function(e){return this.x*=e,this.y*=e,this},scaleBy:function(e){return new I(this.x*e.x,this.y*e.y)},unscaleBy:function(e){return new I(this.x/e.x,this.y/e.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=O(this.x),this.y=O(this.y),this},distanceTo:function(e){var t=(e=N(e)).x-this.x,n=e.y-this.y;return Math.sqrt(t*t+n*n)},equals:function(e){return(e=N(e)).x===this.x&&e.y===this.y},contains:function(e){return e=N(e),Math.abs(e.x)<=Math.abs(this.x)&&Math.abs(e.y)<=Math.abs(this.y)},toString:function(){return"Point("+u(this.x)+", "+u(this.y)+")"}},D.prototype={extend:function(e){var t,n;if(!e)return this;if(e instanceof I||"number"===typeof e[0]||"x"in e)t=n=N(e);else if(t=(e=z(e)).min,n=e.max,!t||!n)return this;return this.min||this.max?(this.min.x=Math.min(t.x,this.min.x),this.max.x=Math.max(n.x,this.max.x),this.min.y=Math.min(t.y,this.min.y),this.max.y=Math.max(n.y,this.max.y)):(this.min=t.clone(),this.max=n.clone()),this},getCenter:function(e){return N((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,e)},getBottomLeft:function(){return N(this.min.x,this.max.y)},getTopRight:function(){return N(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(e){var t,n;return(e="number"===typeof e[0]||e instanceof I?N(e):z(e))instanceof D?(t=e.min,n=e.max):t=n=e,t.x>=this.min.x&&n.x<=this.max.x&&t.y>=this.min.y&&n.y<=this.max.y},intersects:function(e){e=z(e);var t=this.min,n=this.max,r=e.min,i=e.max,o=i.x>=t.x&&r.x<=n.x,a=i.y>=t.y&&r.y<=n.y;return o&&a},overlaps:function(e){e=z(e);var t=this.min,n=this.max,r=e.min,i=e.max,o=i.x>t.x&&r.x<n.x,a=i.y>t.y&&r.y<n.y;return o&&a},isValid:function(){return!(!this.min||!this.max)},pad:function(e){var t=this.min,n=this.max,r=Math.abs(t.x-n.x)*e,i=Math.abs(t.y-n.y)*e;return z(N(t.x-r,t.y-i),N(n.x+r,n.y+i))},equals:function(e){return!!e&&(e=z(e),this.min.equals(e.getTopLeft())&&this.max.equals(e.getBottomRight()))}},R.prototype={extend:function(e){var t,n,r=this._southWest,i=this._northEast;if(e instanceof B)t=e,n=e;else{if(!(e instanceof R))return e?this.extend(V(e)||F(e)):this;if(t=e._southWest,n=e._northEast,!t||!n)return this}return r||i?(r.lat=Math.min(t.lat,r.lat),r.lng=Math.min(t.lng,r.lng),i.lat=Math.max(n.lat,i.lat),i.lng=Math.max(n.lng,i.lng)):(this._southWest=new B(t.lat,t.lng),this._northEast=new B(n.lat,n.lng)),this},pad:function(e){var t=this._southWest,n=this._northEast,r=Math.abs(t.lat-n.lat)*e,i=Math.abs(t.lng-n.lng)*e;return new R(new B(t.lat-r,t.lng-i),new B(n.lat+r,n.lng+i))},getCenter:function(){return new B((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new B(this.getNorth(),this.getWest())},getSouthEast:function(){return new B(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(e){e="number"===typeof e[0]||e instanceof B||"lat"in e?V(e):F(e);var t,n,r=this._southWest,i=this._northEast;return e instanceof R?(t=e.getSouthWest(),n=e.getNorthEast()):t=n=e,t.lat>=r.lat&&n.lat<=i.lat&&t.lng>=r.lng&&n.lng<=i.lng},intersects:function(e){e=F(e);var t=this._southWest,n=this._northEast,r=e.getSouthWest(),i=e.getNorthEast(),o=i.lat>=t.lat&&r.lat<=n.lat,a=i.lng>=t.lng&&r.lng<=n.lng;return o&&a},overlaps:function(e){e=F(e);var t=this._southWest,n=this._northEast,r=e.getSouthWest(),i=e.getNorthEast(),o=i.lat>t.lat&&r.lat<n.lat,a=i.lng>t.lng&&r.lng<n.lng;return o&&a},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(e,t){return!!e&&(e=F(e),this._southWest.equals(e.getSouthWest(),t)&&this._northEast.equals(e.getNorthEast(),t))},isValid:function(){return!(!this._southWest||!this._northEast)}},B.prototype={equals:function(e,t){return!!e&&(e=V(e),Math.max(Math.abs(this.lat-e.lat),Math.abs(this.lng-e.lng))<=(void 0===t?1e-9:t))},toString:function(e){return"LatLng("+u(this.lat,e)+", "+u(this.lng,e)+")"},distanceTo:function(e){return G.distance(this,V(e))},wrap:function(){return G.wrapLatLng(this)},toBounds:function(e){var t=180*e/40075017,n=t/Math.cos(Math.PI/180*this.lat);return F([this.lat-t,this.lng-n],[this.lat+t,this.lng+n])},clone:function(){return new B(this.lat,this.lng,this.alt)}};var U={latLngToPoint:function(e,t){var n=this.projection.project(e),r=this.scale(t);return this.transformation._transform(n,r)},pointToLatLng:function(e,t){var n=this.scale(t),r=this.transformation.untransform(e,n);return this.projection.unproject(r)},project:function(e){return this.projection.project(e)},unproject:function(e){return this.projection.unproject(e)},scale:function(e){return 256*Math.pow(2,e)},zoom:function(e){return Math.log(e/256)/Math.LN2},getProjectedBounds:function(e){if(this.infinite)return null;var t=this.projection.bounds,n=this.scale(e);return new D(this.transformation.transform(t.min,n),this.transformation.transform(t.max,n))},infinite:!1,wrapLatLng:function(e){var t=this.wrapLng?l(e.lng,this.wrapLng,!0):e.lng;return new B(this.wrapLat?l(e.lat,this.wrapLat,!0):e.lat,t,e.alt)},wrapLatLngBounds:function(e){var t=e.getCenter(),n=this.wrapLatLng(t),r=t.lat-n.lat,i=t.lng-n.lng;if(0===r&&0===i)return e;var o=e.getSouthWest(),a=e.getNorthEast();return new R(new B(o.lat-r,o.lng-i),new B(a.lat-r,a.lng-i))}},G=n({},U,{wrapLng:[-180,180],R:6371e3,distance:function(e,t){var n=Math.PI/180,r=e.lat*n,i=t.lat*n,o=Math.sin((t.lat-e.lat)*n/2),a=Math.sin((t.lng-e.lng)*n/2),s=o*o+Math.cos(r)*Math.cos(i)*a*a,l=2*Math.atan2(Math.sqrt(s),Math.sqrt(1-s));return this.R*l}}),H=6378137,Z={R:H,MAX_LATITUDE:85.0511287798,project:function(e){var t=Math.PI/180,n=this.MAX_LATITUDE,r=Math.max(Math.min(n,e.lat),-n),i=Math.sin(r*t);return new I(this.R*e.lng*t,this.R*Math.log((1+i)/(1-i))/2)},unproject:function(e){var t=180/Math.PI;return new B((2*Math.atan(Math.exp(e.y/this.R))-Math.PI/2)*t,e.x*t/this.R)},bounds:function(){var e=H*Math.PI;return new D([-e,-e],[e,e])}()};function q(e,t,n,r){if(y(e))return this._a=e[0],this._b=e[1],this._c=e[2],void(this._d=e[3]);this._a=e,this._b=t,this._c=n,this._d=r}function W(e,t,n,r){return new q(e,t,n,r)}q.prototype={transform:function(e,t){return this._transform(e.clone(),t)},_transform:function(e,t){return t=t||1,e.x=t*(this._a*e.x+this._b),e.y=t*(this._c*e.y+this._d),e},untransform:function(e,t){return t=t||1,new I((e.x/t-this._b)/this._a,(e.y/t-this._d)/this._c)}};var X=n({},G,{code:"EPSG:3857",projection:Z,transformation:function(){var e=.5/(Math.PI*Z.R);return W(e,.5,-e,.5)}()}),Y=n({},X,{code:"EPSG:900913"});function K(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function J(e,t){var n,r,i,o,a,s,l="";for(n=0,i=e.length;n<i;n++){for(r=0,o=(a=e[n]).length;r<o;r++)l+=(r?"L":"M")+(s=a[r]).x+" "+s.y;l+=t?Le.svg?"z":"x":""}return l||"M0 0"}var Q=document.documentElement.style,$="ActiveXObject"in window,ee=$&&!document.addEventListener,te="msLaunchUri"in navigator&&!("documentMode"in document),ne=De("webkit"),re=De("android"),ie=De("android 2")||De("android 3"),oe=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),ae=re&&De("Google")&&oe<537&&!("AudioNode"in window),se=!!window.opera,le=!te&&De("chrome"),ce=De("gecko")&&!ne&&!se&&!$,ue=!le&&De("safari"),he=De("phantom"),de="OTransition"in Q,pe=0===navigator.platform.indexOf("Win"),fe=$&&"transition"in Q,me="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!ie,ge="MozPerspective"in Q,ye=!window.L_DISABLE_3D&&(fe||me||ge)&&!de&&!he,_e="undefined"!==typeof orientation||De("mobile"),ve=_e&&ne,xe=_e&&me,be=!window.PointerEvent&&window.MSPointerEvent,we=!(!window.PointerEvent&&!be),Se="ontouchstart"in window||!!window.TouchEvent,Te=!window.L_NO_TOUCH&&(Se||we),Ee=_e&&se,Ae=_e&&ce,Me=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Pe=function(){var e=!1;try{var t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("testPassiveEventSupport",c,t),window.removeEventListener("testPassiveEventSupport",c,t)}catch(n){}return e}(),ke=!!document.createElement("canvas").getContext,Ce=!(!document.createElementNS||!K("svg").createSVGRect),je=!!Ce&&function(){var e=document.createElement("div");return e.innerHTML="<svg/>","http://www.w3.org/2000/svg"===(e.firstChild&&e.firstChild.namespaceURI)}(),Ie=!Ce&&function(){try{var e=document.createElement("div");e.innerHTML='<v:shape adj="1"/>';var t=e.firstChild;return t.style.behavior="url(#default#VML)",t&&"object"===typeof t.adj}catch(n){return!1}}(),Oe=0===navigator.platform.indexOf("Mac"),Ne=0===navigator.platform.indexOf("Linux");function De(e){return navigator.userAgent.toLowerCase().indexOf(e)>=0}var Le={ie:$,ielt9:ee,edge:te,webkit:ne,android:re,android23:ie,androidStock:ae,opera:se,chrome:le,gecko:ce,safari:ue,phantom:he,opera12:de,win:pe,ie3d:fe,webkit3d:me,gecko3d:ge,any3d:ye,mobile:_e,mobileWebkit:ve,mobileWebkit3d:xe,msPointer:be,pointer:we,touch:Te,touchNative:Se,mobileOpera:Ee,mobileGecko:Ae,retina:Me,passiveEvents:Pe,canvas:ke,svg:Ce,vml:Ie,inlineSvg:je,mac:Oe,linux:Ne},ze=Le.msPointer?"MSPointerDown":"pointerdown",Re=Le.msPointer?"MSPointerMove":"pointermove",Fe=Le.msPointer?"MSPointerUp":"pointerup",Be=Le.msPointer?"MSPointerCancel":"pointercancel",Ve={touchstart:ze,touchmove:Re,touchend:Fe,touchcancel:Be},Ue={touchstart:Qe,touchmove:Je,touchend:Je,touchcancel:Je},Ge={},He=!1;function Ze(e,t,n){return"touchstart"===t&&Ke(),Ue[t]?(n=Ue[t].bind(this,n),e.addEventListener(Ve[t],n,!1),n):(console.warn("wrong event specified:",t),c)}function qe(e,t,n){Ve[t]?e.removeEventListener(Ve[t],n,!1):console.warn("wrong event specified:",t)}function We(e){Ge[e.pointerId]=e}function Xe(e){Ge[e.pointerId]&&(Ge[e.pointerId]=e)}function Ye(e){delete Ge[e.pointerId]}function Ke(){He||(document.addEventListener(ze,We,!0),document.addEventListener(Re,Xe,!0),document.addEventListener(Fe,Ye,!0),document.addEventListener(Be,Ye,!0),He=!0)}function Je(e,t){if(t.pointerType!==(t.MSPOINTER_TYPE_MOUSE||"mouse")){for(var n in t.touches=[],Ge)t.touches.push(Ge[n]);t.changedTouches=[t],e(t)}}function Qe(e,t){t.MSPOINTER_TYPE_TOUCH&&t.pointerType===t.MSPOINTER_TYPE_TOUCH&&Wt(t),Je(e,t)}function $e(e){var t,n,r={};for(n in e)t=e[n],r[n]=t&&t.bind?t.bind(e):t;return e=r,r.type="dblclick",r.detail=2,r.isTrusted=!1,r._simulated=!0,r}var et=200;function tt(e,t){e.addEventListener("dblclick",t);var n,r=0;function i(e){if(1===e.detail){if("mouse"!==e.pointerType&&(!e.sourceCapabilities||e.sourceCapabilities.firesTouchEvents)){var i=Yt(e);if(!i.some((function(e){return e instanceof HTMLLabelElement&&e.attributes.for}))||i.some((function(e){return e instanceof HTMLInputElement||e instanceof HTMLSelectElement}))){var o=Date.now();o-r<=et?2===++n&&t($e(e)):n=1,r=o}}}else n=e.detail}return e.addEventListener("click",i),{dblclick:t,simDblclick:i}}function nt(e,t){e.removeEventListener("dblclick",t.dblclick),e.removeEventListener("click",t.simDblclick)}var rt,it,ot,at,st,lt=Et(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),ct=Et(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),ut="webkitTransition"===ct||"OTransition"===ct?ct+"End":"transitionend";function ht(e){return"string"===typeof e?document.getElementById(e):e}function dt(e,t){var n=e.style[t]||e.currentStyle&&e.currentStyle[t];if((!n||"auto"===n)&&document.defaultView){var r=document.defaultView.getComputedStyle(e,null);n=r?r[t]:null}return"auto"===n?null:n}function pt(e,t,n){var r=document.createElement(e);return r.className=t||"",n&&n.appendChild(r),r}function ft(e){var t=e.parentNode;t&&t.removeChild(e)}function mt(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function gt(e){var t=e.parentNode;t&&t.lastChild!==e&&t.appendChild(e)}function yt(e){var t=e.parentNode;t&&t.firstChild!==e&&t.insertBefore(e,t.firstChild)}function _t(e,t){if(void 0!==e.classList)return e.classList.contains(t);var n=wt(e);return n.length>0&&new RegExp("(^|\\s)"+t+"(\\s|$)").test(n)}function vt(e,t){if(void 0!==e.classList)for(var n=d(t),r=0,i=n.length;r<i;r++)e.classList.add(n[r]);else if(!_t(e,t)){var o=wt(e);bt(e,(o?o+" ":"")+t)}}function xt(e,t){void 0!==e.classList?e.classList.remove(t):bt(e,h((" "+wt(e)+" ").replace(" "+t+" "," ")))}function bt(e,t){void 0===e.className.baseVal?e.className=t:e.className.baseVal=t}function wt(e){return e.correspondingElement&&(e=e.correspondingElement),void 0===e.className.baseVal?e.className:e.className.baseVal}function St(e,t){"opacity"in e.style?e.style.opacity=t:"filter"in e.style&&Tt(e,t)}function Tt(e,t){var n=!1,r="DXImageTransform.Microsoft.Alpha";try{n=e.filters.item(r)}catch(i){if(1===t)return}t=Math.round(100*t),n?(n.Enabled=100!==t,n.Opacity=t):e.style.filter+=" progid:"+r+"(opacity="+t+")"}function Et(e){for(var t=document.documentElement.style,n=0;n<e.length;n++)if(e[n]in t)return e[n];return!1}function At(e,t,n){var r=t||new I(0,0);e.style[lt]=(Le.ie3d?"translate("+r.x+"px,"+r.y+"px)":"translate3d("+r.x+"px,"+r.y+"px,0)")+(n?" scale("+n+")":"")}function Mt(e,t){e._leaflet_pos=t,Le.any3d?At(e,t):(e.style.left=t.x+"px",e.style.top=t.y+"px")}function Pt(e){return e._leaflet_pos||new I(0,0)}if("onselectstart"in document)rt=function(){zt(window,"selectstart",Wt)},it=function(){Ft(window,"selectstart",Wt)};else{var kt=Et(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);rt=function(){if(kt){var e=document.documentElement.style;ot=e[kt],e[kt]="none"}},it=function(){kt&&(document.documentElement.style[kt]=ot,ot=void 0)}}function Ct(){zt(window,"dragstart",Wt)}function jt(){Ft(window,"dragstart",Wt)}function It(e){for(;-1===e.tabIndex;)e=e.parentNode;e.style&&(Ot(),at=e,st=e.style.outlineStyle,e.style.outlineStyle="none",zt(window,"keydown",Ot))}function Ot(){at&&(at.style.outlineStyle=st,at=void 0,st=void 0,Ft(window,"keydown",Ot))}function Nt(e){do{e=e.parentNode}while((!e.offsetWidth||!e.offsetHeight)&&e!==document.body);return e}function Dt(e){var t=e.getBoundingClientRect();return{x:t.width/e.offsetWidth||1,y:t.height/e.offsetHeight||1,boundingClientRect:t}}var Lt={__proto__:null,TRANSFORM:lt,TRANSITION:ct,TRANSITION_END:ut,get:ht,getStyle:dt,create:pt,remove:ft,empty:mt,toFront:gt,toBack:yt,hasClass:_t,addClass:vt,removeClass:xt,setClass:bt,getClass:wt,setOpacity:St,testProp:Et,setTransform:At,setPosition:Mt,getPosition:Pt,get disableTextSelection(){return rt},get enableTextSelection(){return it},disableImageDrag:Ct,enableImageDrag:jt,preventOutline:It,restoreOutline:Ot,getSizedParentNode:Nt,getScale:Dt};function zt(e,t,n,r){if(t&&"object"===typeof t)for(var i in t)Ut(e,i,t[i],n);else for(var o=0,a=(t=d(t)).length;o<a;o++)Ut(e,t[o],n,r);return this}var Rt="_leaflet_events";function Ft(e,t,n,r){if(1===arguments.length)Bt(e),delete e[Rt];else if(t&&"object"===typeof t)for(var i in t)Gt(e,i,t[i],n);else if(t=d(t),2===arguments.length)Bt(e,(function(e){return-1!==_(t,e)}));else for(var o=0,a=t.length;o<a;o++)Gt(e,t[o],n,r);return this}function Bt(e,t){for(var n in e[Rt]){var r=n.split(/\d/)[0];t&&!t(r)||Gt(e,r,null,null,n)}}var Vt={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Ut(e,t,n,r){var i=t+a(n)+(r?"_"+a(r):"");if(e[Rt]&&e[Rt][i])return this;var o=function(t){return n.call(r||e,t||window.event)},s=o;!Le.touchNative&&Le.pointer&&0===t.indexOf("touch")?o=Ze(e,t,o):Le.touch&&"dblclick"===t?o=tt(e,o):"addEventListener"in e?"touchstart"===t||"touchmove"===t||"wheel"===t||"mousewheel"===t?e.addEventListener(Vt[t]||t,o,!!Le.passiveEvents&&{passive:!1}):"mouseenter"===t||"mouseleave"===t?(o=function(t){t=t||window.event,$t(e,t)&&s(t)},e.addEventListener(Vt[t],o,!1)):e.addEventListener(t,s,!1):e.attachEvent("on"+t,o),e[Rt]=e[Rt]||{},e[Rt][i]=o}function Gt(e,t,n,r,i){i=i||t+a(n)+(r?"_"+a(r):"");var o=e[Rt]&&e[Rt][i];if(!o)return this;!Le.touchNative&&Le.pointer&&0===t.indexOf("touch")?qe(e,t,o):Le.touch&&"dblclick"===t?nt(e,o):"removeEventListener"in e?e.removeEventListener(Vt[t]||t,o,!1):e.detachEvent("on"+t,o),e[Rt][i]=null}function Ht(e){return e.stopPropagation?e.stopPropagation():e.originalEvent?e.originalEvent._stopped=!0:e.cancelBubble=!0,this}function Zt(e){return Ut(e,"wheel",Ht),this}function qt(e){return zt(e,"mousedown touchstart dblclick contextmenu",Ht),e._leaflet_disable_click=!0,this}function Wt(e){return e.preventDefault?e.preventDefault():e.returnValue=!1,this}function Xt(e){return Wt(e),Ht(e),this}function Yt(e){if(e.composedPath)return e.composedPath();for(var t=[],n=e.target;n;)t.push(n),n=n.parentNode;return t}function Kt(e,t){if(!t)return new I(e.clientX,e.clientY);var n=Dt(t),r=n.boundingClientRect;return new I((e.clientX-r.left)/n.x-t.clientLeft,(e.clientY-r.top)/n.y-t.clientTop)}var Jt=Le.linux&&Le.chrome?window.devicePixelRatio:Le.mac?3*window.devicePixelRatio:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Qt(e){return Le.edge?e.wheelDeltaY/2:e.deltaY&&0===e.deltaMode?-e.deltaY/Jt:e.deltaY&&1===e.deltaMode?20*-e.deltaY:e.deltaY&&2===e.deltaMode?60*-e.deltaY:e.deltaX||e.deltaZ?0:e.wheelDelta?(e.wheelDeltaY||e.wheelDelta)/2:e.detail&&Math.abs(e.detail)<32765?20*-e.detail:e.detail?e.detail/-32765*60:0}function $t(e,t){var n=t.relatedTarget;if(!n)return!0;try{for(;n&&n!==e;)n=n.parentNode}catch(r){return!1}return n!==e}var en={__proto__:null,on:zt,off:Ft,stopPropagation:Ht,disableScrollPropagation:Zt,disableClickPropagation:qt,preventDefault:Wt,stop:Xt,getPropagationPath:Yt,getMousePosition:Kt,getWheelDelta:Qt,isExternalTarget:$t,addListener:zt,removeListener:Ft},tn=j.extend({run:function(e,t,n,r){this.stop(),this._el=e,this._inProgress=!0,this._duration=n||.25,this._easeOutPower=1/Math.max(r||.5,.2),this._startPos=Pt(e),this._offset=t.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=E(this._animate,this),this._step()},_step:function(e){var t=+new Date-this._startTime,n=1e3*this._duration;t<n?this._runFrame(this._easeOut(t/n),e):(this._runFrame(1),this._complete())},_runFrame:function(e,t){var n=this._startPos.add(this._offset.multiplyBy(e));t&&n._round(),Mt(this._el,n),this.fire("step")},_complete:function(){A(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(e){return 1-Math.pow(1-e,this._easeOutPower)}}),nn=j.extend({options:{crs:X,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(e,t){t=p(this,t),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(e),this._initLayout(),this._onResize=i(this._onResize,this),this._initEvents(),t.maxBounds&&this.setMaxBounds(t.maxBounds),void 0!==t.zoom&&(this._zoom=this._limitZoom(t.zoom)),t.center&&void 0!==t.zoom&&this.setView(V(t.center),t.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=ct&&Le.any3d&&!Le.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),zt(this._proxy,ut,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(e,t,r){return t=void 0===t?this._zoom:this._limitZoom(t),e=this._limitCenter(V(e),t,this.options.maxBounds),r=r||{},this._stop(),this._loaded&&!r.reset&&!0!==r&&(void 0!==r.animate&&(r.zoom=n({animate:r.animate},r.zoom),r.pan=n({animate:r.animate,duration:r.duration},r.pan)),this._zoom!==t?this._tryAnimatedZoom&&this._tryAnimatedZoom(e,t,r.zoom):this._tryAnimatedPan(e,r.pan))?(clearTimeout(this._sizeTimer),this):(this._resetView(e,t,r.pan&&r.pan.noMoveStart),this)},setZoom:function(e,t){return this._loaded?this.setView(this.getCenter(),e,{zoom:t}):(this._zoom=e,this)},zoomIn:function(e,t){return e=e||(Le.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+e,t)},zoomOut:function(e,t){return e=e||(Le.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-e,t)},setZoomAround:function(e,t,n){var r=this.getZoomScale(t),i=this.getSize().divideBy(2),o=(e instanceof I?e:this.latLngToContainerPoint(e)).subtract(i).multiplyBy(1-1/r),a=this.containerPointToLatLng(i.add(o));return this.setView(a,t,{zoom:n})},_getBoundsCenterZoom:function(e,t){t=t||{},e=e.getBounds?e.getBounds():F(e);var n=N(t.paddingTopLeft||t.padding||[0,0]),r=N(t.paddingBottomRight||t.padding||[0,0]),i=this.getBoundsZoom(e,!1,n.add(r));if((i="number"===typeof t.maxZoom?Math.min(t.maxZoom,i):i)===1/0)return{center:e.getCenter(),zoom:i};var o=r.subtract(n).divideBy(2),a=this.project(e.getSouthWest(),i),s=this.project(e.getNorthEast(),i);return{center:this.unproject(a.add(s).divideBy(2).add(o),i),zoom:i}},fitBounds:function(e,t){if(!(e=F(e)).isValid())throw new Error("Bounds are not valid.");var n=this._getBoundsCenterZoom(e,t);return this.setView(n.center,n.zoom,t)},fitWorld:function(e){return this.fitBounds([[-90,-180],[90,180]],e)},panTo:function(e,t){return this.setView(e,this._zoom,{pan:t})},panBy:function(e,t){if(t=t||{},!(e=N(e).round()).x&&!e.y)return this.fire("moveend");if(!0!==t.animate&&!this.getSize().contains(e))return this._resetView(this.unproject(this.project(this.getCenter()).add(e)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new tn,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),t.noMoveStart||this.fire("movestart"),!1!==t.animate){vt(this._mapPane,"leaflet-pan-anim");var n=this._getMapPanePos().subtract(e).round();this._panAnim.run(this._mapPane,n,t.duration||.25,t.easeLinearity)}else this._rawPanBy(e),this.fire("move").fire("moveend");return this},flyTo:function(e,t,n){if(!1===(n=n||{}).animate||!Le.any3d)return this.setView(e,t,n);this._stop();var r=this.project(this.getCenter()),i=this.project(e),o=this.getSize(),a=this._zoom;e=V(e),t=void 0===t?a:t;var s=Math.max(o.x,o.y),l=s*this.getZoomScale(a,t),c=i.distanceTo(r)||1,u=1.42,h=u*u;function d(e){var t=(l*l-s*s+(e?-1:1)*h*h*c*c)/(2*(e?l:s)*h*c),n=Math.sqrt(t*t+1)-t;return n<1e-9?-18:Math.log(n)}function p(e){return(Math.exp(e)-Math.exp(-e))/2}function f(e){return(Math.exp(e)+Math.exp(-e))/2}function m(e){return p(e)/f(e)}var g=d(0);function y(e){return s*(f(g)/f(g+u*e))}function _(e){return s*(f(g)*m(g+u*e)-p(g))/h}function v(e){return 1-Math.pow(1-e,1.5)}var x=Date.now(),b=(d(1)-g)/u,w=n.duration?1e3*n.duration:1e3*b*.8;function S(){var n=(Date.now()-x)/w,o=v(n)*b;n<=1?(this._flyToFrame=E(S,this),this._move(this.unproject(r.add(i.subtract(r).multiplyBy(_(o)/c)),a),this.getScaleZoom(s/y(o),a),{flyTo:!0})):this._move(e,t)._moveEnd(!0)}return this._moveStart(!0,n.noMoveStart),S.call(this),this},flyToBounds:function(e,t){var n=this._getBoundsCenterZoom(e,t);return this.flyTo(n.center,n.zoom,t)},setMaxBounds:function(e){return e=F(e),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),e.isValid()?(this.options.maxBounds=e,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(e){var t=this.options.minZoom;return this.options.minZoom=e,this._loaded&&t!==e&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(e):this},setMaxZoom:function(e){var t=this.options.maxZoom;return this.options.maxZoom=e,this._loaded&&t!==e&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(e):this},panInsideBounds:function(e,t){this._enforcingBounds=!0;var n=this.getCenter(),r=this._limitCenter(n,this._zoom,F(e));return n.equals(r)||this.panTo(r,t),this._enforcingBounds=!1,this},panInside:function(e,t){var n=N((t=t||{}).paddingTopLeft||t.padding||[0,0]),r=N(t.paddingBottomRight||t.padding||[0,0]),i=this.project(this.getCenter()),o=this.project(e),a=this.getPixelBounds(),s=z([a.min.add(n),a.max.subtract(r)]),l=s.getSize();if(!s.contains(o)){this._enforcingBounds=!0;var c=o.subtract(s.getCenter()),u=s.extend(o).getSize().subtract(l);i.x+=c.x<0?-u.x:u.x,i.y+=c.y<0?-u.y:u.y,this.panTo(this.unproject(i),t),this._enforcingBounds=!1}return this},invalidateSize:function(e){if(!this._loaded)return this;e=n({animate:!1,pan:!0},!0===e?{animate:!0}:e);var t=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var r=this.getSize(),o=t.divideBy(2).round(),a=r.divideBy(2).round(),s=o.subtract(a);return s.x||s.y?(e.animate&&e.pan?this.panBy(s):(e.pan&&this._rawPanBy(s),this.fire("move"),e.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(i(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:t,newSize:r})):this},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(e){if(e=this._locateOptions=n({timeout:1e4,watch:!1},e),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var t=i(this._handleGeolocationResponse,this),r=i(this._handleGeolocationError,this);return e.watch?this._locationWatchId=navigator.geolocation.watchPosition(t,r,e):navigator.geolocation.getCurrentPosition(t,r,e),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(e){if(this._container._leaflet_id){var t=e.code,n=e.message||(1===t?"permission denied":2===t?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:t,message:"Geolocation error: "+n+"."})}},_handleGeolocationResponse:function(e){if(this._container._leaflet_id){var t=new B(e.coords.latitude,e.coords.longitude),n=t.toBounds(2*e.coords.accuracy),r=this._locateOptions;if(r.setView){var i=this.getBoundsZoom(n);this.setView(t,r.maxZoom?Math.min(i,r.maxZoom):i)}var o={latlng:t,bounds:n,timestamp:e.timestamp};for(var a in e.coords)"number"===typeof e.coords[a]&&(o[a]=e.coords[a]);this.fire("locationfound",o)}},addHandler:function(e,t){if(!t)return this;var n=this[e]=new t(this);return this._handlers.push(n),this.options[e]&&n.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(t){this._container._leaflet_id=void 0,this._containerId=void 0}var e;for(e in void 0!==this._locationWatchId&&this.stopLocate(),this._stop(),ft(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(A(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload"),this._layers)this._layers[e].remove();for(e in this._panes)ft(this._panes[e]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(e,t){var n=pt("div","leaflet-pane"+(e?" leaflet-"+e.replace("Pane","")+"-pane":""),t||this._mapPane);return e&&(this._panes[e]=n),n},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var e=this.getPixelBounds();return new R(this.unproject(e.getBottomLeft()),this.unproject(e.getTopRight()))},getMinZoom:function(){return void 0===this.options.minZoom?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return void 0===this.options.maxZoom?void 0===this._layersMaxZoom?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(e,t,n){e=F(e),n=N(n||[0,0]);var r=this.getZoom()||0,i=this.getMinZoom(),o=this.getMaxZoom(),a=e.getNorthWest(),s=e.getSouthEast(),l=this.getSize().subtract(n),c=z(this.project(s,r),this.project(a,r)).getSize(),u=Le.any3d?this.options.zoomSnap:1,h=l.x/c.x,d=l.y/c.y,p=t?Math.max(h,d):Math.min(h,d);return r=this.getScaleZoom(p,r),u&&(r=Math.round(r/(u/100))*(u/100),r=t?Math.ceil(r/u)*u:Math.floor(r/u)*u),Math.max(i,Math.min(o,r))},getSize:function(){return this._size&&!this._sizeChanged||(this._size=new I(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(e,t){var n=this._getTopLeftPoint(e,t);return new D(n,n.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(e){return this.options.crs.getProjectedBounds(void 0===e?this.getZoom():e)},getPane:function(e){return"string"===typeof e?this._panes[e]:e},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(e,t){var n=this.options.crs;return t=void 0===t?this._zoom:t,n.scale(e)/n.scale(t)},getScaleZoom:function(e,t){var n=this.options.crs;t=void 0===t?this._zoom:t;var r=n.zoom(e*n.scale(t));return isNaN(r)?1/0:r},project:function(e,t){return t=void 0===t?this._zoom:t,this.options.crs.latLngToPoint(V(e),t)},unproject:function(e,t){return t=void 0===t?this._zoom:t,this.options.crs.pointToLatLng(N(e),t)},layerPointToLatLng:function(e){var t=N(e).add(this.getPixelOrigin());return this.unproject(t)},latLngToLayerPoint:function(e){return this.project(V(e))._round()._subtract(this.getPixelOrigin())},wrapLatLng:function(e){return this.options.crs.wrapLatLng(V(e))},wrapLatLngBounds:function(e){return this.options.crs.wrapLatLngBounds(F(e))},distance:function(e,t){return this.options.crs.distance(V(e),V(t))},containerPointToLayerPoint:function(e){return N(e).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(e){return N(e).add(this._getMapPanePos())},containerPointToLatLng:function(e){var t=this.containerPointToLayerPoint(N(e));return this.layerPointToLatLng(t)},latLngToContainerPoint:function(e){return this.layerPointToContainerPoint(this.latLngToLayerPoint(V(e)))},mouseEventToContainerPoint:function(e){return Kt(e,this._container)},mouseEventToLayerPoint:function(e){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(e))},mouseEventToLatLng:function(e){return this.layerPointToLatLng(this.mouseEventToLayerPoint(e))},_initContainer:function(e){var t=this._container=ht(e);if(!t)throw new Error("Map container not found.");if(t._leaflet_id)throw new Error("Map container is already initialized.");zt(t,"scroll",this._onScroll,this),this._containerId=a(t)},_initLayout:function(){var e=this._container;this._fadeAnimated=this.options.fadeAnimation&&Le.any3d,vt(e,"leaflet-container"+(Le.touch?" leaflet-touch":"")+(Le.retina?" leaflet-retina":"")+(Le.ielt9?" leaflet-oldie":"")+(Le.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var t=dt(e,"position");"absolute"!==t&&"relative"!==t&&"fixed"!==t&&"sticky"!==t&&(e.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var e=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Mt(this._mapPane,new I(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(vt(e.markerPane,"leaflet-zoom-hide"),vt(e.shadowPane,"leaflet-zoom-hide"))},_resetView:function(e,t,n){Mt(this._mapPane,new I(0,0));var r=!this._loaded;this._loaded=!0,t=this._limitZoom(t),this.fire("viewprereset");var i=this._zoom!==t;this._moveStart(i,n)._move(e,t)._moveEnd(i),this.fire("viewreset"),r&&this.fire("load")},_moveStart:function(e,t){return e&&this.fire("zoomstart"),t||this.fire("movestart"),this},_move:function(e,t,n,r){void 0===t&&(t=this._zoom);var i=this._zoom!==t;return this._zoom=t,this._lastCenter=e,this._pixelOrigin=this._getNewPixelOrigin(e),r?n&&n.pinch&&this.fire("zoom",n):((i||n&&n.pinch)&&this.fire("zoom",n),this.fire("move",n)),this},_moveEnd:function(e){return e&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return A(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(e){Mt(this._mapPane,this._getMapPanePos().subtract(e))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(e){this._targets={},this._targets[a(this._container)]=this;var t=e?Ft:zt;t(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&t(window,"resize",this._onResize,this),Le.any3d&&this.options.transform3DLimit&&(e?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){A(this._resizeRequest),this._resizeRequest=E((function(){this.invalidateSize({debounceMoveend:!0})}),this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var e=this._getMapPanePos();Math.max(Math.abs(e.x),Math.abs(e.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(e,t){for(var n,r=[],i="mouseout"===t||"mouseover"===t,o=e.target||e.srcElement,s=!1;o;){if((n=this._targets[a(o)])&&("click"===t||"preclick"===t)&&this._draggableMoved(n)){s=!0;break}if(n&&n.listens(t,!0)){if(i&&!$t(o,e))break;if(r.push(n),i)break}if(o===this._container)break;o=o.parentNode}return r.length||s||i||!this.listens(t,!0)||(r=[this]),r},_isClickDisabled:function(e){for(;e&&e!==this._container;){if(e._leaflet_disable_click)return!0;e=e.parentNode}},_handleDOMEvent:function(e){var t=e.target||e.srcElement;if(!(!this._loaded||t._leaflet_disable_events||"click"===e.type&&this._isClickDisabled(t))){var n=e.type;"mousedown"===n&&It(t),this._fireDOMEvent(e,n)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(e,t,r){if("click"===e.type){var i=n({},e);i.type="preclick",this._fireDOMEvent(i,i.type,r)}var o=this._findEventTargets(e,t);if(r){for(var a=[],s=0;s<r.length;s++)r[s].listens(t,!0)&&a.push(r[s]);o=a.concat(o)}if(o.length){"contextmenu"===t&&Wt(e);var l=o[0],c={originalEvent:e};if("keypress"!==e.type&&"keydown"!==e.type&&"keyup"!==e.type){var u=l.getLatLng&&(!l._radius||l._radius<=10);c.containerPoint=u?this.latLngToContainerPoint(l.getLatLng()):this.mouseEventToContainerPoint(e),c.layerPoint=this.containerPointToLayerPoint(c.containerPoint),c.latlng=u?l.getLatLng():this.layerPointToLatLng(c.layerPoint)}for(s=0;s<o.length;s++)if(o[s].fire(t,c,!0),c.originalEvent._stopped||!1===o[s].options.bubblingMouseEvents&&-1!==_(this._mouseEvents,t))return}},_draggableMoved:function(e){return(e=e.dragging&&e.dragging.enabled()?e:this).dragging&&e.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var e=0,t=this._handlers.length;e<t;e++)this._handlers[e].disable()},whenReady:function(e,t){return this._loaded?e.call(t||this,{target:this}):this.on("load",e,t),this},_getMapPanePos:function(){return Pt(this._mapPane)||new I(0,0)},_moved:function(){var e=this._getMapPanePos();return e&&!e.equals([0,0])},_getTopLeftPoint:function(e,t){return(e&&void 0!==t?this._getNewPixelOrigin(e,t):this.getPixelOrigin()).subtract(this._getMapPanePos())},_getNewPixelOrigin:function(e,t){var n=this.getSize()._divideBy(2);return this.project(e,t)._subtract(n)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(e,t,n){var r=this._getNewPixelOrigin(n,t);return this.project(e,t)._subtract(r)},_latLngBoundsToNewLayerBounds:function(e,t,n){var r=this._getNewPixelOrigin(n,t);return z([this.project(e.getSouthWest(),t)._subtract(r),this.project(e.getNorthWest(),t)._subtract(r),this.project(e.getSouthEast(),t)._subtract(r),this.project(e.getNorthEast(),t)._subtract(r)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(e){return this.latLngToLayerPoint(e).subtract(this._getCenterLayerPoint())},_limitCenter:function(e,t,n){if(!n)return e;var r=this.project(e,t),i=this.getSize().divideBy(2),o=new D(r.subtract(i),r.add(i)),a=this._getBoundsOffset(o,n,t);return Math.abs(a.x)<=1&&Math.abs(a.y)<=1?e:this.unproject(r.add(a),t)},_limitOffset:function(e,t){if(!t)return e;var n=this.getPixelBounds(),r=new D(n.min.add(e),n.max.add(e));return e.add(this._getBoundsOffset(r,t))},_getBoundsOffset:function(e,t,n){var r=z(this.project(t.getNorthEast(),n),this.project(t.getSouthWest(),n)),i=r.min.subtract(e.min),o=r.max.subtract(e.max);return new I(this._rebound(i.x,-o.x),this._rebound(i.y,-o.y))},_rebound:function(e,t){return e+t>0?Math.round(e-t)/2:Math.max(0,Math.ceil(e))-Math.max(0,Math.floor(t))},_limitZoom:function(e){var t=this.getMinZoom(),n=this.getMaxZoom(),r=Le.any3d?this.options.zoomSnap:1;return r&&(e=Math.round(e/r)*r),Math.max(t,Math.min(n,e))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){xt(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(e,t){var n=this._getCenterOffset(e)._trunc();return!(!0!==(t&&t.animate)&&!this.getSize().contains(n))&&(this.panBy(n,t),!0)},_createAnimProxy:function(){var e=this._proxy=pt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(e),this.on("zoomanim",(function(e){var t=lt,n=this._proxy.style[t];At(this._proxy,this.project(e.center,e.zoom),this.getZoomScale(e.zoom,1)),n===this._proxy.style[t]&&this._animatingZoom&&this._onZoomTransitionEnd()}),this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){ft(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var e=this.getCenter(),t=this.getZoom();At(this._proxy,this.project(e,t),this.getZoomScale(t,1))},_catchTransitionEnd:function(e){this._animatingZoom&&e.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(e,t,n){if(this._animatingZoom)return!0;if(n=n||{},!this._zoomAnimated||!1===n.animate||this._nothingToAnimate()||Math.abs(t-this._zoom)>this.options.zoomAnimationThreshold)return!1;var r=this.getZoomScale(t),i=this._getCenterOffset(e)._divideBy(1-1/r);return!(!0!==n.animate&&!this.getSize().contains(i))&&(E((function(){this._moveStart(!0,n.noMoveStart||!1)._animateZoom(e,t,!0)}),this),!0)},_animateZoom:function(e,t,n,r){this._mapPane&&(n&&(this._animatingZoom=!0,this._animateToCenter=e,this._animateToZoom=t,vt(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:e,zoom:t,noUpdate:r}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(i(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&xt(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function rn(e,t){return new nn(e,t)}var on=P.extend({options:{position:"topright"},initialize:function(e){p(this,e)},getPosition:function(){return this.options.position},setPosition:function(e){var t=this._map;return t&&t.removeControl(this),this.options.position=e,t&&t.addControl(this),this},getContainer:function(){return this._container},addTo:function(e){this.remove(),this._map=e;var t=this._container=this.onAdd(e),n=this.getPosition(),r=e._controlCorners[n];return vt(t,"leaflet-control"),-1!==n.indexOf("bottom")?r.insertBefore(t,r.firstChild):r.appendChild(t),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(ft(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(e){this._map&&e&&e.screenX>0&&e.screenY>0&&this._map.getContainer().focus()}}),an=function(e){return new on(e)};nn.include({addControl:function(e){return e.addTo(this),this},removeControl:function(e){return e.remove(),this},_initControlPos:function(){var e=this._controlCorners={},t="leaflet-",n=this._controlContainer=pt("div",t+"control-container",this._container);function r(r,i){var o=t+r+" "+t+i;e[r+i]=pt("div",o,n)}r("top","left"),r("top","right"),r("bottom","left"),r("bottom","right")},_clearControlPos:function(){for(var e in this._controlCorners)ft(this._controlCorners[e]);ft(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var sn=on.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(e,t,n,r){return n<r?-1:r<n?1:0}},initialize:function(e,t,n){for(var r in p(this,n),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1,e)this._addLayer(e[r],r);for(r in t)this._addLayer(t[r],r,!0)},onAdd:function(e){this._initLayout(),this._update(),this._map=e,e.on("zoomend",this._checkDisabledLayers,this);for(var t=0;t<this._layers.length;t++)this._layers[t].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(e){return on.prototype.addTo.call(this,e),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var e=0;e<this._layers.length;e++)this._layers[e].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(e,t){return this._addLayer(e,t),this._map?this._update():this},addOverlay:function(e,t){return this._addLayer(e,t,!0),this._map?this._update():this},removeLayer:function(e){e.off("add remove",this._onLayerChange,this);var t=this._getLayer(a(e));return t&&this._layers.splice(this._layers.indexOf(t),1),this._map?this._update():this},expand:function(){vt(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var e=this._map.getSize().y-(this._container.offsetTop+50);return e<this._section.clientHeight?(vt(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=e+"px"):xt(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return xt(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var e="leaflet-control-layers",t=this._container=pt("div",e),n=this.options.collapsed;t.setAttribute("aria-haspopup",!0),qt(t),Zt(t);var r=this._section=pt("section",e+"-list");n&&(this._map.on("click",this.collapse,this),zt(t,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var i=this._layersLink=pt("a",e+"-toggle",t);i.href="#",i.title="Layers",i.setAttribute("role","button"),zt(i,{keydown:function(e){13===e.keyCode&&this._expandSafely()},click:function(e){Wt(e),this._expandSafely()}},this),n||this.expand(),this._baseLayersList=pt("div",e+"-base",r),this._separator=pt("div",e+"-separator",r),this._overlaysList=pt("div",e+"-overlays",r),t.appendChild(r)},_getLayer:function(e){for(var t=0;t<this._layers.length;t++)if(this._layers[t]&&a(this._layers[t].layer)===e)return this._layers[t]},_addLayer:function(e,t,n){this._map&&e.on("add remove",this._onLayerChange,this),this._layers.push({layer:e,name:t,overlay:n}),this.options.sortLayers&&this._layers.sort(i((function(e,t){return this.options.sortFunction(e.layer,t.layer,e.name,t.name)}),this)),this.options.autoZIndex&&e.setZIndex&&(this._lastZIndex++,e.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;mt(this._baseLayersList),mt(this._overlaysList),this._layerControlInputs=[];var e,t,n,r,i=0;for(n=0;n<this._layers.length;n++)r=this._layers[n],this._addItem(r),t=t||r.overlay,e=e||!r.overlay,i+=r.overlay?0:1;return this.options.hideSingleBase&&(e=e&&i>1,this._baseLayersList.style.display=e?"":"none"),this._separator.style.display=t&&e?"":"none",this},_onLayerChange:function(e){this._handlingClick||this._update();var t=this._getLayer(a(e.target)),n=t.overlay?"add"===e.type?"overlayadd":"overlayremove":"add"===e.type?"baselayerchange":null;n&&this._map.fire(n,t)},_createRadioElement:function(e,t){var n='<input type="radio" class="leaflet-control-layers-selector" name="'+e+'"'+(t?' checked="checked"':"")+"/>",r=document.createElement("div");return r.innerHTML=n,r.firstChild},_addItem:function(e){var t,n=document.createElement("label"),r=this._map.hasLayer(e.layer);e.overlay?((t=document.createElement("input")).type="checkbox",t.className="leaflet-control-layers-selector",t.defaultChecked=r):t=this._createRadioElement("leaflet-base-layers_"+a(this),r),this._layerControlInputs.push(t),t.layerId=a(e.layer),zt(t,"click",this._onInputClick,this);var i=document.createElement("span");i.innerHTML=" "+e.name;var o=document.createElement("span");return n.appendChild(o),o.appendChild(t),o.appendChild(i),(e.overlay?this._overlaysList:this._baseLayersList).appendChild(n),this._checkDisabledLayers(),n},_onInputClick:function(){if(!this._preventClick){var e,t,n=this._layerControlInputs,r=[],i=[];this._handlingClick=!0;for(var o=n.length-1;o>=0;o--)e=n[o],t=this._getLayer(e.layerId).layer,e.checked?r.push(t):e.checked||i.push(t);for(o=0;o<i.length;o++)this._map.hasLayer(i[o])&&this._map.removeLayer(i[o]);for(o=0;o<r.length;o++)this._map.hasLayer(r[o])||this._map.addLayer(r[o]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var e,t,n=this._layerControlInputs,r=this._map.getZoom(),i=n.length-1;i>=0;i--)e=n[i],t=this._getLayer(e.layerId).layer,e.disabled=void 0!==t.options.minZoom&&r<t.options.minZoom||void 0!==t.options.maxZoom&&r>t.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var e=this._section;this._preventClick=!0,zt(e,"click",Wt),this.expand();var t=this;setTimeout((function(){Ft(e,"click",Wt),t._preventClick=!1}))}}),ln=function(e,t,n){return new sn(e,t,n)},cn=on.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(e){var t="leaflet-control-zoom",n=pt("div",t+" leaflet-bar"),r=this.options;return this._zoomInButton=this._createButton(r.zoomInText,r.zoomInTitle,t+"-in",n,this._zoomIn),this._zoomOutButton=this._createButton(r.zoomOutText,r.zoomOutTitle,t+"-out",n,this._zoomOut),this._updateDisabled(),e.on("zoomend zoomlevelschange",this._updateDisabled,this),n},onRemove:function(e){e.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(e){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(e.shiftKey?3:1))},_zoomOut:function(e){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(e.shiftKey?3:1))},_createButton:function(e,t,n,r,i){var o=pt("a",n,r);return o.innerHTML=e,o.href="#",o.title=t,o.setAttribute("role","button"),o.setAttribute("aria-label",t),qt(o),zt(o,"click",Xt),zt(o,"click",i,this),zt(o,"click",this._refocusOnMap,this),o},_updateDisabled:function(){var e=this._map,t="leaflet-disabled";xt(this._zoomInButton,t),xt(this._zoomOutButton,t),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||e._zoom===e.getMinZoom())&&(vt(this._zoomOutButton,t),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||e._zoom===e.getMaxZoom())&&(vt(this._zoomInButton,t),this._zoomInButton.setAttribute("aria-disabled","true"))}});nn.mergeOptions({zoomControl:!0}),nn.addInitHook((function(){this.options.zoomControl&&(this.zoomControl=new cn,this.addControl(this.zoomControl))}));var un=function(e){return new cn(e)},hn=on.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(e){var t="leaflet-control-scale",n=pt("div",t),r=this.options;return this._addScales(r,t+"-line",n),e.on(r.updateWhenIdle?"moveend":"move",this._update,this),e.whenReady(this._update,this),n},onRemove:function(e){e.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(e,t,n){e.metric&&(this._mScale=pt("div",t,n)),e.imperial&&(this._iScale=pt("div",t,n))},_update:function(){var e=this._map,t=e.getSize().y/2,n=e.distance(e.containerPointToLatLng([0,t]),e.containerPointToLatLng([this.options.maxWidth,t]));this._updateScales(n)},_updateScales:function(e){this.options.metric&&e&&this._updateMetric(e),this.options.imperial&&e&&this._updateImperial(e)},_updateMetric:function(e){var t=this._getRoundNum(e),n=t<1e3?t+" m":t/1e3+" km";this._updateScale(this._mScale,n,t/e)},_updateImperial:function(e){var t,n,r,i=3.2808399*e;i>5280?(t=i/5280,n=this._getRoundNum(t),this._updateScale(this._iScale,n+" mi",n/t)):(r=this._getRoundNum(i),this._updateScale(this._iScale,r+" ft",r/i))},_updateScale:function(e,t,n){e.style.width=Math.round(this.options.maxWidth*n)+"px",e.innerHTML=t},_getRoundNum:function(e){var t=Math.pow(10,(Math.floor(e)+"").length-1),n=e/t;return t*(n=n>=10?10:n>=5?5:n>=3?3:n>=2?2:1)}}),dn=function(e){return new hn(e)},pn='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',fn=on.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Le.inlineSvg?pn+" ":"")+"Leaflet</a>"},initialize:function(e){p(this,e),this._attributions={}},onAdd:function(e){for(var t in e.attributionControl=this,this._container=pt("div","leaflet-control-attribution"),qt(this._container),e._layers)e._layers[t].getAttribution&&this.addAttribution(e._layers[t].getAttribution());return this._update(),e.on("layeradd",this._addAttribution,this),this._container},onRemove:function(e){e.off("layeradd",this._addAttribution,this)},_addAttribution:function(e){e.layer.getAttribution&&(this.addAttribution(e.layer.getAttribution()),e.layer.once("remove",(function(){this.removeAttribution(e.layer.getAttribution())}),this))},setPrefix:function(e){return this.options.prefix=e,this._update(),this},addAttribution:function(e){return e?(this._attributions[e]||(this._attributions[e]=0),this._attributions[e]++,this._update(),this):this},removeAttribution:function(e){return e?(this._attributions[e]&&(this._attributions[e]--,this._update()),this):this},_update:function(){if(this._map){var e=[];for(var t in this._attributions)this._attributions[t]&&e.push(t);var n=[];this.options.prefix&&n.push(this.options.prefix),e.length&&n.push(e.join(", ")),this._container.innerHTML=n.join(' <span aria-hidden="true">|</span> ')}}});nn.mergeOptions({attributionControl:!0}),nn.addInitHook((function(){this.options.attributionControl&&(new fn).addTo(this)}));var mn=function(e){return new fn(e)};on.Layers=sn,on.Zoom=cn,on.Scale=hn,on.Attribution=fn,an.layers=ln,an.zoom=un,an.scale=dn,an.attribution=mn;var gn=P.extend({initialize:function(e){this._map=e},enable:function(){return this._enabled||(this._enabled=!0,this.addHooks()),this},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});gn.addTo=function(e,t){return e.addHandler(t,this),this};var yn={Events:C},_n=Le.touch?"touchstart mousedown":"mousedown",vn=j.extend({options:{clickTolerance:3},initialize:function(e,t,n,r){p(this,r),this._element=e,this._dragStartTarget=t||e,this._preventOutline=n},enable:function(){this._enabled||(zt(this._dragStartTarget,_n,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(vn._dragging===this&&this.finishDrag(!0),Ft(this._dragStartTarget,_n,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(e){if(this._enabled&&(this._moved=!1,!_t(this._element,"leaflet-zoom-anim")))if(e.touches&&1!==e.touches.length)vn._dragging===this&&this.finishDrag();else if(!(vn._dragging||e.shiftKey||1!==e.which&&1!==e.button&&!e.touches)&&(vn._dragging=this,this._preventOutline&&It(this._element),Ct(),rt(),!this._moving)){this.fire("down");var t=e.touches?e.touches[0]:e,n=Nt(this._element);this._startPoint=new I(t.clientX,t.clientY),this._startPos=Pt(this._element),this._parentScale=Dt(n);var r="mousedown"===e.type;zt(document,r?"mousemove":"touchmove",this._onMove,this),zt(document,r?"mouseup":"touchend touchcancel",this._onUp,this)}},_onMove:function(e){if(this._enabled)if(e.touches&&e.touches.length>1)this._moved=!0;else{var t=e.touches&&1===e.touches.length?e.touches[0]:e,n=new I(t.clientX,t.clientY)._subtract(this._startPoint);(n.x||n.y)&&(Math.abs(n.x)+Math.abs(n.y)<this.options.clickTolerance||(n.x/=this._parentScale.x,n.y/=this._parentScale.y,Wt(e),this._moved||(this.fire("dragstart"),this._moved=!0,vt(document.body,"leaflet-dragging"),this._lastTarget=e.target||e.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),vt(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(n),this._moving=!0,this._lastEvent=e,this._updatePosition()))}},_updatePosition:function(){var e={originalEvent:this._lastEvent};this.fire("predrag",e),Mt(this._element,this._newPos),this.fire("drag",e)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(e){xt(document.body,"leaflet-dragging"),this._lastTarget&&(xt(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Ft(document,"mousemove touchmove",this._onMove,this),Ft(document,"mouseup touchend touchcancel",this._onUp,this),jt(),it();var t=this._moved&&this._moving;this._moving=!1,vn._dragging=!1,t&&this.fire("dragend",{noInertia:e,distance:this._newPos.distanceTo(this._startPos)})}});function xn(e,t,n){var r,i,o,a,s,l,c,u,h,d=[1,4,2,8];for(i=0,c=e.length;i<c;i++)e[i]._code=On(e[i],t);for(a=0;a<4;a++){for(u=d[a],r=[],i=0,o=(c=e.length)-1;i<c;o=i++)s=e[i],l=e[o],s._code&u?l._code&u||((h=In(l,s,u,t,n))._code=On(h,t),r.push(h)):(l._code&u&&((h=In(l,s,u,t,n))._code=On(h,t),r.push(h)),r.push(s));e=r}return e}function bn(e,t){var n,r,i,o,a,s,l,c,u;if(!e||0===e.length)throw new Error("latlngs not passed");Ln(e)||(console.warn("latlngs are not flat! Only the first ring will be used"),e=e[0]);var h=V([0,0]),d=F(e);d.getNorthWest().distanceTo(d.getSouthWest())*d.getNorthEast().distanceTo(d.getNorthWest())<1700&&(h=wn(e));var p=e.length,f=[];for(n=0;n<p;n++){var m=V(e[n]);f.push(t.project(V([m.lat-h.lat,m.lng-h.lng])))}for(s=l=c=0,n=0,r=p-1;n<p;r=n++)i=f[n],o=f[r],a=i.y*o.x-o.y*i.x,l+=(i.x+o.x)*a,c+=(i.y+o.y)*a,s+=3*a;u=0===s?f[0]:[l/s,c/s];var g=t.unproject(N(u));return V([g.lat+h.lat,g.lng+h.lng])}function wn(e){for(var t=0,n=0,r=0,i=0;i<e.length;i++){var o=V(e[i]);t+=o.lat,n+=o.lng,r++}return V([t/r,n/r])}var Sn,Tn={__proto__:null,clipPolygon:xn,polygonCenter:bn,centroid:wn};function En(e,t){if(!t||!e.length)return e.slice();var n=t*t;return e=Pn(e=Cn(e,n),n)}function An(e,t,n){return Math.sqrt(Dn(e,t,n,!0))}function Mn(e,t,n){return Dn(e,t,n)}function Pn(e,t){var n=e.length,r=new(typeof Uint8Array!==void 0+""?Uint8Array:Array)(n);r[0]=r[n-1]=1,kn(e,r,t,0,n-1);var i,o=[];for(i=0;i<n;i++)r[i]&&o.push(e[i]);return o}function kn(e,t,n,r,i){var o,a,s,l=0;for(a=r+1;a<=i-1;a++)(s=Dn(e[a],e[r],e[i],!0))>l&&(o=a,l=s);l>n&&(t[o]=1,kn(e,t,n,r,o),kn(e,t,n,o,i))}function Cn(e,t){for(var n=[e[0]],r=1,i=0,o=e.length;r<o;r++)Nn(e[r],e[i])>t&&(n.push(e[r]),i=r);return i<o-1&&n.push(e[o-1]),n}function jn(e,t,n,r,i){var o,a,s,l=r?Sn:On(e,n),c=On(t,n);for(Sn=c;;){if(!(l|c))return[e,t];if(l&c)return!1;s=On(a=In(e,t,o=l||c,n,i),n),o===l?(e=a,l=s):(t=a,c=s)}}function In(e,t,n,r,i){var o,a,s=t.x-e.x,l=t.y-e.y,c=r.min,u=r.max;return 8&n?(o=e.x+s*(u.y-e.y)/l,a=u.y):4&n?(o=e.x+s*(c.y-e.y)/l,a=c.y):2&n?(o=u.x,a=e.y+l*(u.x-e.x)/s):1&n&&(o=c.x,a=e.y+l*(c.x-e.x)/s),new I(o,a,i)}function On(e,t){var n=0;return e.x<t.min.x?n|=1:e.x>t.max.x&&(n|=2),e.y<t.min.y?n|=4:e.y>t.max.y&&(n|=8),n}function Nn(e,t){var n=t.x-e.x,r=t.y-e.y;return n*n+r*r}function Dn(e,t,n,r){var i,o=t.x,a=t.y,s=n.x-o,l=n.y-a,c=s*s+l*l;return c>0&&((i=((e.x-o)*s+(e.y-a)*l)/c)>1?(o=n.x,a=n.y):i>0&&(o+=s*i,a+=l*i)),s=e.x-o,l=e.y-a,r?s*s+l*l:new I(o,a)}function Ln(e){return!y(e[0])||"object"!==typeof e[0][0]&&"undefined"!==typeof e[0][0]}function zn(e){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Ln(e)}function Rn(e,t){var n,r,i,o,a,s,l,c;if(!e||0===e.length)throw new Error("latlngs not passed");Ln(e)||(console.warn("latlngs are not flat! Only the first ring will be used"),e=e[0]);var u=V([0,0]),h=F(e);h.getNorthWest().distanceTo(h.getSouthWest())*h.getNorthEast().distanceTo(h.getNorthWest())<1700&&(u=wn(e));var d=e.length,p=[];for(n=0;n<d;n++){var f=V(e[n]);p.push(t.project(V([f.lat-u.lat,f.lng-u.lng])))}for(n=0,r=0;n<d-1;n++)r+=p[n].distanceTo(p[n+1])/2;if(0===r)c=p[0];else for(n=0,o=0;n<d-1;n++)if(a=p[n],s=p[n+1],(o+=i=a.distanceTo(s))>r){l=(o-r)/i,c=[s.x-l*(s.x-a.x),s.y-l*(s.y-a.y)];break}var m=t.unproject(N(c));return V([m.lat+u.lat,m.lng+u.lng])}var Fn={__proto__:null,simplify:En,pointToSegmentDistance:An,closestPointOnSegment:Mn,clipSegment:jn,_getEdgeIntersection:In,_getBitCode:On,_sqClosestPointOnSegment:Dn,isFlat:Ln,_flat:zn,polylineCenter:Rn},Bn={project:function(e){return new I(e.lng,e.lat)},unproject:function(e){return new B(e.y,e.x)},bounds:new D([-180,-90],[180,90])},Vn={R:6378137,R_MINOR:6356752.314245179,bounds:new D([-20037508.34279,-15496570.73972],[20037508.34279,18764656.23138]),project:function(e){var t=Math.PI/180,n=this.R,r=e.lat*t,i=this.R_MINOR/n,o=Math.sqrt(1-i*i),a=o*Math.sin(r),s=Math.tan(Math.PI/4-r/2)/Math.pow((1-a)/(1+a),o/2);return r=-n*Math.log(Math.max(s,1e-10)),new I(e.lng*t*n,r)},unproject:function(e){for(var t,n=180/Math.PI,r=this.R,i=this.R_MINOR/r,o=Math.sqrt(1-i*i),a=Math.exp(-e.y/r),s=Math.PI/2-2*Math.atan(a),l=0,c=.1;l<15&&Math.abs(c)>1e-7;l++)t=o*Math.sin(s),t=Math.pow((1-t)/(1+t),o/2),s+=c=Math.PI/2-2*Math.atan(a*t)-s;return new B(s*n,e.x*n/r)}},Un={__proto__:null,LonLat:Bn,Mercator:Vn,SphericalMercator:Z},Gn=n({},G,{code:"EPSG:3395",projection:Vn,transformation:function(){var e=.5/(Math.PI*Vn.R);return W(e,.5,-e,.5)}()}),Hn=n({},G,{code:"EPSG:4326",projection:Bn,transformation:W(1/180,1,-1/180,.5)}),Zn=n({},U,{projection:Bn,transformation:W(1,0,-1,0),scale:function(e){return Math.pow(2,e)},zoom:function(e){return Math.log(e)/Math.LN2},distance:function(e,t){var n=t.lng-e.lng,r=t.lat-e.lat;return Math.sqrt(n*n+r*r)},infinite:!0});U.Earth=G,U.EPSG3395=Gn,U.EPSG3857=X,U.EPSG900913=Y,U.EPSG4326=Hn,U.Simple=Zn;var qn=j.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(e){return e.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(e){return e&&e.removeLayer(this),this},getPane:function(e){return this._map.getPane(e?this.options[e]||e:this.options.pane)},addInteractiveTarget:function(e){return this._map._targets[a(e)]=this,this},removeInteractiveTarget:function(e){return delete this._map._targets[a(e)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(e){var t=e.target;if(t.hasLayer(this)){if(this._map=t,this._zoomAnimated=t._zoomAnimated,this.getEvents){var n=this.getEvents();t.on(n,this),this.once("remove",(function(){t.off(n,this)}),this)}this.onAdd(t),this.fire("add"),t.fire("layeradd",{layer:this})}}});nn.include({addLayer:function(e){if(!e._layerAdd)throw new Error("The provided object is not a Layer.");var t=a(e);return this._layers[t]||(this._layers[t]=e,e._mapToAdd=this,e.beforeAdd&&e.beforeAdd(this),this.whenReady(e._layerAdd,e)),this},removeLayer:function(e){var t=a(e);return this._layers[t]?(this._loaded&&e.onRemove(this),delete this._layers[t],this._loaded&&(this.fire("layerremove",{layer:e}),e.fire("remove")),e._map=e._mapToAdd=null,this):this},hasLayer:function(e){return a(e)in this._layers},eachLayer:function(e,t){for(var n in this._layers)e.call(t,this._layers[n]);return this},_addLayers:function(e){for(var t=0,n=(e=e?y(e)?e:[e]:[]).length;t<n;t++)this.addLayer(e[t])},_addZoomLimit:function(e){isNaN(e.options.maxZoom)&&isNaN(e.options.minZoom)||(this._zoomBoundLayers[a(e)]=e,this._updateZoomLevels())},_removeZoomLimit:function(e){var t=a(e);this._zoomBoundLayers[t]&&(delete this._zoomBoundLayers[t],this._updateZoomLevels())},_updateZoomLevels:function(){var e=1/0,t=-1/0,n=this._getZoomSpan();for(var r in this._zoomBoundLayers){var i=this._zoomBoundLayers[r].options;e=void 0===i.minZoom?e:Math.min(e,i.minZoom),t=void 0===i.maxZoom?t:Math.max(t,i.maxZoom)}this._layersMaxZoom=t===-1/0?void 0:t,this._layersMinZoom=e===1/0?void 0:e,n!==this._getZoomSpan()&&this.fire("zoomlevelschange"),void 0===this.options.maxZoom&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),void 0===this.options.minZoom&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Wn=qn.extend({initialize:function(e,t){var n,r;if(p(this,t),this._layers={},e)for(n=0,r=e.length;n<r;n++)this.addLayer(e[n])},addLayer:function(e){var t=this.getLayerId(e);return this._layers[t]=e,this._map&&this._map.addLayer(e),this},removeLayer:function(e){var t=e in this._layers?e:this.getLayerId(e);return this._map&&this._layers[t]&&this._map.removeLayer(this._layers[t]),delete this._layers[t],this},hasLayer:function(e){return("number"===typeof e?e:this.getLayerId(e))in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(e){var t,n,r=Array.prototype.slice.call(arguments,1);for(t in this._layers)(n=this._layers[t])[e]&&n[e].apply(n,r);return this},onAdd:function(e){this.eachLayer(e.addLayer,e)},onRemove:function(e){this.eachLayer(e.removeLayer,e)},eachLayer:function(e,t){for(var n in this._layers)e.call(t,this._layers[n]);return this},getLayer:function(e){return this._layers[e]},getLayers:function(){var e=[];return this.eachLayer(e.push,e),e},setZIndex:function(e){return this.invoke("setZIndex",e)},getLayerId:function(e){return a(e)}}),Xn=function(e,t){return new Wn(e,t)},Yn=Wn.extend({addLayer:function(e){return this.hasLayer(e)?this:(e.addEventParent(this),Wn.prototype.addLayer.call(this,e),this.fire("layeradd",{layer:e}))},removeLayer:function(e){return this.hasLayer(e)?(e in this._layers&&(e=this._layers[e]),e.removeEventParent(this),Wn.prototype.removeLayer.call(this,e),this.fire("layerremove",{layer:e})):this},setStyle:function(e){return this.invoke("setStyle",e)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var e=new R;for(var t in this._layers){var n=this._layers[t];e.extend(n.getBounds?n.getBounds():n.getLatLng())}return e}}),Kn=function(e,t){return new Yn(e,t)},Jn=P.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(e){p(this,e)},createIcon:function(e){return this._createIcon("icon",e)},createShadow:function(e){return this._createIcon("shadow",e)},_createIcon:function(e,t){var n=this._getIconUrl(e);if(!n){if("icon"===e)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var r=this._createImg(n,t&&"IMG"===t.tagName?t:null);return this._setIconStyles(r,e),(this.options.crossOrigin||""===this.options.crossOrigin)&&(r.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),r},_setIconStyles:function(e,t){var n=this.options,r=n[t+"Size"];"number"===typeof r&&(r=[r,r]);var i=N(r),o=N("shadow"===t&&n.shadowAnchor||n.iconAnchor||i&&i.divideBy(2,!0));e.className="leaflet-marker-"+t+" "+(n.className||""),o&&(e.style.marginLeft=-o.x+"px",e.style.marginTop=-o.y+"px"),i&&(e.style.width=i.x+"px",e.style.height=i.y+"px")},_createImg:function(e,t){return(t=t||document.createElement("img")).src=e,t},_getIconUrl:function(e){return Le.retina&&this.options[e+"RetinaUrl"]||this.options[e+"Url"]}});function Qn(e){return new Jn(e)}var $n=Jn.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(e){return"string"!==typeof $n.imagePath&&($n.imagePath=this._detectIconPath()),(this.options.imagePath||$n.imagePath)+Jn.prototype._getIconUrl.call(this,e)},_stripUrl:function(e){var t=function(e,t,n){var r=t.exec(e);return r&&r[n]};return(e=t(e,/^url\((['"])?(.+)\1\)$/,2))&&t(e,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var e=pt("div","leaflet-default-icon-path",document.body),t=dt(e,"background-image")||dt(e,"backgroundImage");if(document.body.removeChild(e),t=this._stripUrl(t))return t;var n=document.querySelector('link[href$="leaflet.css"]');return n?n.href.substring(0,n.href.length-11-1):""}}),er=gn.extend({initialize:function(e){this._marker=e},addHooks:function(){var e=this._marker._icon;this._draggable||(this._draggable=new vn(e,e,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),vt(e,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&xt(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(e){var t=this._marker,n=t._map,r=this._marker.options.autoPanSpeed,i=this._marker.options.autoPanPadding,o=Pt(t._icon),a=n.getPixelBounds(),s=n.getPixelOrigin(),l=z(a.min._subtract(s).add(i),a.max._subtract(s).subtract(i));if(!l.contains(o)){var c=N((Math.max(l.max.x,o.x)-l.max.x)/(a.max.x-l.max.x)-(Math.min(l.min.x,o.x)-l.min.x)/(a.min.x-l.min.x),(Math.max(l.max.y,o.y)-l.max.y)/(a.max.y-l.max.y)-(Math.min(l.min.y,o.y)-l.min.y)/(a.min.y-l.min.y)).multiplyBy(r);n.panBy(c,{animate:!1}),this._draggable._newPos._add(c),this._draggable._startPos._add(c),Mt(t._icon,this._draggable._newPos),this._onDrag(e),this._panRequest=E(this._adjustPan.bind(this,e))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(e){this._marker.options.autoPan&&(A(this._panRequest),this._panRequest=E(this._adjustPan.bind(this,e)))},_onDrag:function(e){var t=this._marker,n=t._shadow,r=Pt(t._icon),i=t._map.layerPointToLatLng(r);n&&Mt(n,r),t._latlng=i,e.latlng=i,e.oldLatLng=this._oldLatLng,t.fire("move",e).fire("drag",e)},_onDragEnd:function(e){A(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",e)}}),tr=qn.extend({options:{icon:new $n,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(e,t){p(this,t),this._latlng=V(e)},onAdd:function(e){this._zoomAnimated=this._zoomAnimated&&e.options.markerZoomAnimation,this._zoomAnimated&&e.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(e){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&e.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(e){var t=this._latlng;return this._latlng=V(e),this.update(),this.fire("move",{oldLatLng:t,latlng:this._latlng})},setZIndexOffset:function(e){return this.options.zIndexOffset=e,this.update()},getIcon:function(){return this.options.icon},setIcon:function(e){return this.options.icon=e,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var e=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(e)}return this},_initIcon:function(){var e=this.options,t="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),n=e.icon.createIcon(this._icon),r=!1;n!==this._icon&&(this._icon&&this._removeIcon(),r=!0,e.title&&(n.title=e.title),"IMG"===n.tagName&&(n.alt=e.alt||"")),vt(n,t),e.keyboard&&(n.tabIndex="0",n.setAttribute("role","button")),this._icon=n,e.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&zt(n,"focus",this._panOnFocus,this);var i=e.icon.createShadow(this._shadow),o=!1;i!==this._shadow&&(this._removeShadow(),o=!0),i&&(vt(i,t),i.alt=""),this._shadow=i,e.opacity<1&&this._updateOpacity(),r&&this.getPane().appendChild(this._icon),this._initInteraction(),i&&o&&this.getPane(e.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Ft(this._icon,"focus",this._panOnFocus,this),ft(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&ft(this._shadow),this._shadow=null},_setPos:function(e){this._icon&&Mt(this._icon,e),this._shadow&&Mt(this._shadow,e),this._zIndex=e.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(e){this._icon&&(this._icon.style.zIndex=this._zIndex+e)},_animateZoom:function(e){var t=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center).round();this._setPos(t)},_initInteraction:function(){if(this.options.interactive&&(vt(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),er)){var e=this.options.draggable;this.dragging&&(e=this.dragging.enabled(),this.dragging.disable()),this.dragging=new er(this),e&&this.dragging.enable()}},setOpacity:function(e){return this.options.opacity=e,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var e=this.options.opacity;this._icon&&St(this._icon,e),this._shadow&&St(this._shadow,e)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var e=this._map;if(e){var t=this.options.icon.options,n=t.iconSize?N(t.iconSize):N(0,0),r=t.iconAnchor?N(t.iconAnchor):N(0,0);e.panInside(this._latlng,{paddingTopLeft:r,paddingBottomRight:n.subtract(r)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function nr(e,t){return new tr(e,t)}var rr=qn.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(e){this._renderer=e.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(e){return p(this,e),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&e&&Object.prototype.hasOwnProperty.call(e,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),ir=rr.extend({options:{fill:!0,radius:10},initialize:function(e,t){p(this,t),this._latlng=V(e),this._radius=this.options.radius},setLatLng:function(e){var t=this._latlng;return this._latlng=V(e),this.redraw(),this.fire("move",{oldLatLng:t,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(e){return this.options.radius=this._radius=e,this.redraw()},getRadius:function(){return this._radius},setStyle:function(e){var t=e&&e.radius||this._radius;return rr.prototype.setStyle.call(this,e),this.setRadius(t),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var e=this._radius,t=this._radiusY||e,n=this._clickTolerance(),r=[e+n,t+n];this._pxBounds=new D(this._point.subtract(r),this._point.add(r))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(e){return e.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function or(e,t){return new ir(e,t)}var ar=ir.extend({initialize:function(e,t,r){if("number"===typeof t&&(t=n({},r,{radius:t})),p(this,t),this._latlng=V(e),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(e){return this._mRadius=e,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var e=[this._radius,this._radiusY||this._radius];return new R(this._map.layerPointToLatLng(this._point.subtract(e)),this._map.layerPointToLatLng(this._point.add(e)))},setStyle:rr.prototype.setStyle,_project:function(){var e=this._latlng.lng,t=this._latlng.lat,n=this._map,r=n.options.crs;if(r.distance===G.distance){var i=Math.PI/180,o=this._mRadius/G.R/i,a=n.project([t+o,e]),s=n.project([t-o,e]),l=a.add(s).divideBy(2),c=n.unproject(l).lat,u=Math.acos((Math.cos(o*i)-Math.sin(t*i)*Math.sin(c*i))/(Math.cos(t*i)*Math.cos(c*i)))/i;(isNaN(u)||0===u)&&(u=o/Math.cos(Math.PI/180*t)),this._point=l.subtract(n.getPixelOrigin()),this._radius=isNaN(u)?0:l.x-n.project([c,e-u]).x,this._radiusY=l.y-a.y}else{var h=r.unproject(r.project(this._latlng).subtract([this._mRadius,0]));this._point=n.latLngToLayerPoint(this._latlng),this._radius=this._point.x-n.latLngToLayerPoint(h).x}this._updateBounds()}});function sr(e,t,n){return new ar(e,t,n)}var lr=rr.extend({options:{smoothFactor:1,noClip:!1},initialize:function(e,t){p(this,t),this._setLatLngs(e)},getLatLngs:function(){return this._latlngs},setLatLngs:function(e){return this._setLatLngs(e),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(e){for(var t,n,r=1/0,i=null,o=Dn,a=0,s=this._parts.length;a<s;a++)for(var l=this._parts[a],c=1,u=l.length;c<u;c++){var h=o(e,t=l[c-1],n=l[c],!0);h<r&&(r=h,i=o(e,t,n))}return i&&(i.distance=Math.sqrt(r)),i},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Rn(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(e,t){return t=t||this._defaultShape(),e=V(e),t.push(e),this._bounds.extend(e),this.redraw()},_setLatLngs:function(e){this._bounds=new R,this._latlngs=this._convertLatLngs(e)},_defaultShape:function(){return Ln(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(e){for(var t=[],n=Ln(e),r=0,i=e.length;r<i;r++)n?(t[r]=V(e[r]),this._bounds.extend(t[r])):t[r]=this._convertLatLngs(e[r]);return t},_project:function(){var e=new D;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,e),this._bounds.isValid()&&e.isValid()&&(this._rawPxBounds=e,this._updateBounds())},_updateBounds:function(){var e=this._clickTolerance(),t=new I(e,e);this._rawPxBounds&&(this._pxBounds=new D([this._rawPxBounds.min.subtract(t),this._rawPxBounds.max.add(t)]))},_projectLatlngs:function(e,t,n){var r,i,o=e[0]instanceof B,a=e.length;if(o){for(i=[],r=0;r<a;r++)i[r]=this._map.latLngToLayerPoint(e[r]),n.extend(i[r]);t.push(i)}else for(r=0;r<a;r++)this._projectLatlngs(e[r],t,n)},_clipPoints:function(){var e=this._renderer._bounds;if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(e))if(this.options.noClip)this._parts=this._rings;else{var t,n,r,i,o,a,s,l=this._parts;for(t=0,r=0,i=this._rings.length;t<i;t++)for(n=0,o=(s=this._rings[t]).length;n<o-1;n++)(a=jn(s[n],s[n+1],e,n,!0))&&(l[r]=l[r]||[],l[r].push(a[0]),a[1]===s[n+1]&&n!==o-2||(l[r].push(a[1]),r++))}},_simplifyPoints:function(){for(var e=this._parts,t=this.options.smoothFactor,n=0,r=e.length;n<r;n++)e[n]=En(e[n],t)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(e,t){var n,r,i,o,a,s,l=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(e))return!1;for(n=0,o=this._parts.length;n<o;n++)for(r=0,i=(a=(s=this._parts[n]).length)-1;r<a;i=r++)if((t||0!==r)&&An(e,s[i],s[r])<=l)return!0;return!1}});function cr(e,t){return new lr(e,t)}lr._flat=zn;var ur=lr.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return bn(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(e){var t=lr.prototype._convertLatLngs.call(this,e),n=t.length;return n>=2&&t[0]instanceof B&&t[0].equals(t[n-1])&&t.pop(),t},_setLatLngs:function(e){lr.prototype._setLatLngs.call(this,e),Ln(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Ln(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var e=this._renderer._bounds,t=this.options.weight,n=new I(t,t);if(e=new D(e.min.subtract(n),e.max.add(n)),this._parts=[],this._pxBounds&&this._pxBounds.intersects(e))if(this.options.noClip)this._parts=this._rings;else for(var r,i=0,o=this._rings.length;i<o;i++)(r=xn(this._rings[i],e,!0)).length&&this._parts.push(r)},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(e){var t,n,r,i,o,a,s,l,c=!1;if(!this._pxBounds||!this._pxBounds.contains(e))return!1;for(i=0,s=this._parts.length;i<s;i++)for(o=0,a=(l=(t=this._parts[i]).length)-1;o<l;a=o++)n=t[o],r=t[a],n.y>e.y!==r.y>e.y&&e.x<(r.x-n.x)*(e.y-n.y)/(r.y-n.y)+n.x&&(c=!c);return c||lr.prototype._containsPoint.call(this,e,!0)}});function hr(e,t){return new ur(e,t)}var dr=Yn.extend({initialize:function(e,t){p(this,t),this._layers={},e&&this.addData(e)},addData:function(e){var t,n,r,i=y(e)?e:e.features;if(i){for(t=0,n=i.length;t<n;t++)((r=i[t]).geometries||r.geometry||r.features||r.coordinates)&&this.addData(r);return this}var o=this.options;if(o.filter&&!o.filter(e))return this;var a=pr(e,o);return a?(a.feature=xr(e),a.defaultOptions=a.options,this.resetStyle(a),o.onEachFeature&&o.onEachFeature(e,a),this.addLayer(a)):this},resetStyle:function(e){return void 0===e?this.eachLayer(this.resetStyle,this):(e.options=n({},e.defaultOptions),this._setLayerStyle(e,this.options.style),this)},setStyle:function(e){return this.eachLayer((function(t){this._setLayerStyle(t,e)}),this)},_setLayerStyle:function(e,t){e.setStyle&&("function"===typeof t&&(t=t(e.feature)),e.setStyle(t))}});function pr(e,t){var n,r,i,o,a="Feature"===e.type?e.geometry:e,s=a?a.coordinates:null,l=[],c=t&&t.pointToLayer,u=t&&t.coordsToLatLng||mr;if(!s&&!a)return null;switch(a.type){case"Point":return fr(c,e,n=u(s),t);case"MultiPoint":for(i=0,o=s.length;i<o;i++)n=u(s[i]),l.push(fr(c,e,n,t));return new Yn(l);case"LineString":case"MultiLineString":return r=gr(s,"LineString"===a.type?0:1,u),new lr(r,t);case"Polygon":case"MultiPolygon":return r=gr(s,"Polygon"===a.type?1:2,u),new ur(r,t);case"GeometryCollection":for(i=0,o=a.geometries.length;i<o;i++){var h=pr({geometry:a.geometries[i],type:"Feature",properties:e.properties},t);h&&l.push(h)}return new Yn(l);case"FeatureCollection":for(i=0,o=a.features.length;i<o;i++){var d=pr(a.features[i],t);d&&l.push(d)}return new Yn(l);default:throw new Error("Invalid GeoJSON object.")}}function fr(e,t,n,r){return e?e(t,n):new tr(n,r&&r.markersInheritOptions&&r)}function mr(e){return new B(e[1],e[0],e[2])}function gr(e,t,n){for(var r,i=[],o=0,a=e.length;o<a;o++)r=t?gr(e[o],t-1,n):(n||mr)(e[o]),i.push(r);return i}function yr(e,t){return void 0!==(e=V(e)).alt?[u(e.lng,t),u(e.lat,t),u(e.alt,t)]:[u(e.lng,t),u(e.lat,t)]}function _r(e,t,n,r){for(var i=[],o=0,a=e.length;o<a;o++)i.push(t?_r(e[o],Ln(e[o])?0:t-1,n,r):yr(e[o],r));return!t&&n&&i.length>0&&i.push(i[0].slice()),i}function vr(e,t){return e.feature?n({},e.feature,{geometry:t}):xr(t)}function xr(e){return"Feature"===e.type||"FeatureCollection"===e.type?e:{type:"Feature",properties:{},geometry:e}}var br={toGeoJSON:function(e){return vr(this,{type:"Point",coordinates:yr(this.getLatLng(),e)})}};function wr(e,t){return new dr(e,t)}tr.include(br),ar.include(br),ir.include(br),lr.include({toGeoJSON:function(e){var t=!Ln(this._latlngs);return vr(this,{type:(t?"Multi":"")+"LineString",coordinates:_r(this._latlngs,t?1:0,!1,e)})}}),ur.include({toGeoJSON:function(e){var t=!Ln(this._latlngs),n=t&&!Ln(this._latlngs[0]),r=_r(this._latlngs,n?2:t?1:0,!0,e);return t||(r=[r]),vr(this,{type:(n?"Multi":"")+"Polygon",coordinates:r})}}),Wn.include({toMultiPoint:function(e){var t=[];return this.eachLayer((function(n){t.push(n.toGeoJSON(e).geometry.coordinates)})),vr(this,{type:"MultiPoint",coordinates:t})},toGeoJSON:function(e){var t=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===t)return this.toMultiPoint(e);var n="GeometryCollection"===t,r=[];return this.eachLayer((function(t){if(t.toGeoJSON){var i=t.toGeoJSON(e);if(n)r.push(i.geometry);else{var o=xr(i);"FeatureCollection"===o.type?r.push.apply(r,o.features):r.push(o)}}})),n?vr(this,{geometries:r,type:"GeometryCollection"}):{type:"FeatureCollection",features:r}}});var Sr=wr,Tr=qn.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(e,t,n){this._url=e,this._bounds=F(t),p(this,n)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(vt(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){ft(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(e){return this.options.opacity=e,this._image&&this._updateOpacity(),this},setStyle:function(e){return e.opacity&&this.setOpacity(e.opacity),this},bringToFront:function(){return this._map&&gt(this._image),this},bringToBack:function(){return this._map&&yt(this._image),this},setUrl:function(e){return this._url=e,this._image&&(this._image.src=e),this},setBounds:function(e){return this._bounds=F(e),this._map&&this._reset(),this},getEvents:function(){var e={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(e.zoomanim=this._animateZoom),e},setZIndex:function(e){return this.options.zIndex=e,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var e="IMG"===this._url.tagName,t=this._image=e?this._url:pt("img");vt(t,"leaflet-image-layer"),this._zoomAnimated&&vt(t,"leaflet-zoom-animated"),this.options.className&&vt(t,this.options.className),t.onselectstart=c,t.onmousemove=c,t.onload=i(this.fire,this,"load"),t.onerror=i(this._overlayOnError,this,"error"),(this.options.crossOrigin||""===this.options.crossOrigin)&&(t.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),e?this._url=t.src:(t.src=this._url,t.alt=this.options.alt)},_animateZoom:function(e){var t=this._map.getZoomScale(e.zoom),n=this._map._latLngBoundsToNewLayerBounds(this._bounds,e.zoom,e.center).min;At(this._image,n,t)},_reset:function(){var e=this._image,t=new D(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),n=t.getSize();Mt(e,t.min),e.style.width=n.x+"px",e.style.height=n.y+"px"},_updateOpacity:function(){St(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var e=this.options.errorOverlayUrl;e&&this._url!==e&&(this._url=e,this._image.src=e)},getCenter:function(){return this._bounds.getCenter()}}),Er=function(e,t,n){return new Tr(e,t,n)},Ar=Tr.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var e="VIDEO"===this._url.tagName,t=this._image=e?this._url:pt("video");if(vt(t,"leaflet-image-layer"),this._zoomAnimated&&vt(t,"leaflet-zoom-animated"),this.options.className&&vt(t,this.options.className),t.onselectstart=c,t.onmousemove=c,t.onloadeddata=i(this.fire,this,"load"),e){for(var n=t.getElementsByTagName("source"),r=[],o=0;o<n.length;o++)r.push(n[o].src);this._url=n.length>0?r:[t.src]}else{y(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(t.style,"objectFit")&&(t.style.objectFit="fill"),t.autoplay=!!this.options.autoplay,t.loop=!!this.options.loop,t.muted=!!this.options.muted,t.playsInline=!!this.options.playsInline;for(var a=0;a<this._url.length;a++){var s=pt("source");s.src=this._url[a],t.appendChild(s)}}}});function Mr(e,t,n){return new Ar(e,t,n)}var Pr=Tr.extend({_initImage:function(){var e=this._image=this._url;vt(e,"leaflet-image-layer"),this._zoomAnimated&&vt(e,"leaflet-zoom-animated"),this.options.className&&vt(e,this.options.className),e.onselectstart=c,e.onmousemove=c}});function kr(e,t,n){return new Pr(e,t,n)}var Cr=qn.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(e,t){e&&(e instanceof B||y(e))?(this._latlng=V(e),p(this,t)):(p(this,e),this._source=t),this.options.content&&(this._content=this.options.content)},openOn:function(e){return(e=arguments.length?e:this._source._map).hasLayer(this)||e.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(e){return this._map?this.close():(arguments.length?this._source=e:e=this._source,this._prepareOpen(),this.openOn(e._map)),this},onAdd:function(e){this._zoomAnimated=e._zoomAnimated,this._container||this._initLayout(),e._fadeAnimated&&St(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),e._fadeAnimated&&St(this._container,1),this.bringToFront(),this.options.interactive&&(vt(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(e){e._fadeAnimated?(St(this._container,0),this._removeTimeout=setTimeout(i(ft,void 0,this._container),200)):ft(this._container),this.options.interactive&&(xt(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(e){return this._latlng=V(e),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(e){return this._content=e,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var e={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(e.zoomanim=this._animateZoom),e},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&gt(this._container),this},bringToBack:function(){return this._map&&yt(this._container),this},_prepareOpen:function(e){var t=this._source;if(!t._map)return!1;if(t instanceof Yn){t=null;var n=this._source._layers;for(var r in n)if(n[r]._map){t=n[r];break}if(!t)return!1;this._source=t}if(!e)if(t.getCenter)e=t.getCenter();else if(t.getLatLng)e=t.getLatLng();else{if(!t.getBounds)throw new Error("Unable to get source layer LatLng.");e=t.getBounds().getCenter()}return this.setLatLng(e),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var e=this._contentNode,t="function"===typeof this._content?this._content(this._source||this):this._content;if("string"===typeof t)e.innerHTML=t;else{for(;e.hasChildNodes();)e.removeChild(e.firstChild);e.appendChild(t)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var e=this._map.latLngToLayerPoint(this._latlng),t=N(this.options.offset),n=this._getAnchor();this._zoomAnimated?Mt(this._container,e.add(n)):t=t.add(e).add(n);var r=this._containerBottom=-t.y,i=this._containerLeft=-Math.round(this._containerWidth/2)+t.x;this._container.style.bottom=r+"px",this._container.style.left=i+"px"}},_getAnchor:function(){return[0,0]}});nn.include({_initOverlay:function(e,t,n,r){var i=t;return i instanceof e||(i=new e(r).setContent(t)),n&&i.setLatLng(n),i}}),qn.include({_initOverlay:function(e,t,n,r){var i=n;return i instanceof e?(p(i,r),i._source=this):(i=t&&!r?t:new e(r,this)).setContent(n),i}});var jr=Cr.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(e){return!(e=arguments.length?e:this._source._map).hasLayer(this)&&e._popup&&e._popup.options.autoClose&&e.removeLayer(e._popup),e._popup=this,Cr.prototype.openOn.call(this,e)},onAdd:function(e){Cr.prototype.onAdd.call(this,e),e.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof rr||this._source.on("preclick",Ht))},onRemove:function(e){Cr.prototype.onRemove.call(this,e),e.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof rr||this._source.off("preclick",Ht))},getEvents:function(){var e=Cr.prototype.getEvents.call(this);return(void 0!==this.options.closeOnClick?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(e.preclick=this.close),this.options.keepInView&&(e.moveend=this._adjustPan),e},_initLayout:function(){var e="leaflet-popup",t=this._container=pt("div",e+" "+(this.options.className||"")+" leaflet-zoom-animated"),n=this._wrapper=pt("div",e+"-content-wrapper",t);if(this._contentNode=pt("div",e+"-content",n),qt(t),Zt(this._contentNode),zt(t,"contextmenu",Ht),this._tipContainer=pt("div",e+"-tip-container",t),this._tip=pt("div",e+"-tip",this._tipContainer),this.options.closeButton){var r=this._closeButton=pt("a",e+"-close-button",t);r.setAttribute("role","button"),r.setAttribute("aria-label","Close popup"),r.href="#close",r.innerHTML='<span aria-hidden="true">&#215;</span>',zt(r,"click",(function(e){Wt(e),this.close()}),this)}},_updateLayout:function(){var e=this._contentNode,t=e.style;t.width="",t.whiteSpace="nowrap";var n=e.offsetWidth;n=Math.min(n,this.options.maxWidth),n=Math.max(n,this.options.minWidth),t.width=n+1+"px",t.whiteSpace="",t.height="";var r=e.offsetHeight,i=this.options.maxHeight,o="leaflet-popup-scrolled";i&&r>i?(t.height=i+"px",vt(e,o)):xt(e,o),this._containerWidth=this._container.offsetWidth},_animateZoom:function(e){var t=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center),n=this._getAnchor();Mt(this._container,t.add(n))},_adjustPan:function(){if(this.options.autoPan)if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning)this._autopanning=!1;else{var e=this._map,t=parseInt(dt(this._container,"marginBottom"),10)||0,n=this._container.offsetHeight+t,r=this._containerWidth,i=new I(this._containerLeft,-n-this._containerBottom);i._add(Pt(this._container));var o=e.layerPointToContainerPoint(i),a=N(this.options.autoPanPadding),s=N(this.options.autoPanPaddingTopLeft||a),l=N(this.options.autoPanPaddingBottomRight||a),c=e.getSize(),u=0,h=0;o.x+r+l.x>c.x&&(u=o.x+r-c.x+l.x),o.x-u-s.x<0&&(u=o.x-s.x),o.y+n+l.y>c.y&&(h=o.y+n-c.y+l.y),o.y-h-s.y<0&&(h=o.y-s.y),(u||h)&&(this.options.keepInView&&(this._autopanning=!0),e.fire("autopanstart").panBy([u,h]))}},_getAnchor:function(){return N(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Ir=function(e,t){return new jr(e,t)};nn.mergeOptions({closePopupOnClick:!0}),nn.include({openPopup:function(e,t,n){return this._initOverlay(jr,e,t,n).openOn(this),this},closePopup:function(e){return(e=arguments.length?e:this._popup)&&e.close(),this}}),qn.include({bindPopup:function(e,t){return this._popup=this._initOverlay(jr,this._popup,e,t),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(e){return this._popup&&(this instanceof Yn||(this._popup._source=this),this._popup._prepareOpen(e||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return!!this._popup&&this._popup.isOpen()},setPopupContent:function(e){return this._popup&&this._popup.setContent(e),this},getPopup:function(){return this._popup},_openPopup:function(e){if(this._popup&&this._map){Xt(e);var t=e.layer||e.target;this._popup._source!==t||t instanceof rr?(this._popup._source=t,this.openPopup(e.latlng)):this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(e.latlng)}},_movePopup:function(e){this._popup.setLatLng(e.latlng)},_onKeyPress:function(e){13===e.originalEvent.keyCode&&this._openPopup(e)}});var Or=Cr.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(e){Cr.prototype.onAdd.call(this,e),this.setOpacity(this.options.opacity),e.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(e){Cr.prototype.onRemove.call(this,e),e.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var e=Cr.prototype.getEvents.call(this);return this.options.permanent||(e.preclick=this.close),e},_initLayout:function(){var e="leaflet-tooltip "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=pt("div",e),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+a(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(e){var t,n,r=this._map,i=this._container,o=r.latLngToContainerPoint(r.getCenter()),a=r.layerPointToContainerPoint(e),s=this.options.direction,l=i.offsetWidth,c=i.offsetHeight,u=N(this.options.offset),h=this._getAnchor();"top"===s?(t=l/2,n=c):"bottom"===s?(t=l/2,n=0):"center"===s?(t=l/2,n=c/2):"right"===s?(t=0,n=c/2):"left"===s?(t=l,n=c/2):a.x<o.x?(s="right",t=0,n=c/2):(s="left",t=l+2*(u.x+h.x),n=c/2),e=e.subtract(N(t,n,!0)).add(u).add(h),xt(i,"leaflet-tooltip-right"),xt(i,"leaflet-tooltip-left"),xt(i,"leaflet-tooltip-top"),xt(i,"leaflet-tooltip-bottom"),vt(i,"leaflet-tooltip-"+s),Mt(i,e)},_updatePosition:function(){var e=this._map.latLngToLayerPoint(this._latlng);this._setPosition(e)},setOpacity:function(e){this.options.opacity=e,this._container&&St(this._container,e)},_animateZoom:function(e){var t=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center);this._setPosition(t)},_getAnchor:function(){return N(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Nr=function(e,t){return new Or(e,t)};nn.include({openTooltip:function(e,t,n){return this._initOverlay(Or,e,t,n).openOn(this),this},closeTooltip:function(e){return e.close(),this}}),qn.include({bindTooltip:function(e,t){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Or,this._tooltip,e,t),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(e){if(e||!this._tooltipHandlersAdded){var t=e?"off":"on",n={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?n.add=this._openTooltip:(n.mouseover=this._openTooltip,n.mouseout=this.closeTooltip,n.click=this._openTooltip,this._map?this._addFocusListeners():n.add=this._addFocusListeners),this._tooltip.options.sticky&&(n.mousemove=this._moveTooltip),this[t](n),this._tooltipHandlersAdded=!e}},openTooltip:function(e){return this._tooltip&&(this instanceof Yn||(this._tooltip._source=this),this._tooltip._prepareOpen(e)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(e){return this._tooltip&&this._tooltip.setContent(e),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(e){var t="function"===typeof e.getElement&&e.getElement();t&&(zt(t,"focus",(function(){this._tooltip._source=e,this.openTooltip()}),this),zt(t,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(e){var t="function"===typeof e.getElement&&e.getElement();t&&t.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(e){if(this._tooltip&&this._map)if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var t=this;this._map.once("moveend",(function(){t._openOnceFlag=!1,t._openTooltip(e)}))}else this._tooltip._source=e.layer||e.target,this.openTooltip(this._tooltip.options.sticky?e.latlng:void 0)},_moveTooltip:function(e){var t,n,r=e.latlng;this._tooltip.options.sticky&&e.originalEvent&&(t=this._map.mouseEventToContainerPoint(e.originalEvent),n=this._map.containerPointToLayerPoint(t),r=this._map.layerPointToLatLng(n)),this._tooltip.setLatLng(r)}});var Dr=Jn.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(e){var t=e&&"DIV"===e.tagName?e:document.createElement("div"),n=this.options;if(n.html instanceof Element?(mt(t),t.appendChild(n.html)):t.innerHTML=!1!==n.html?n.html:"",n.bgPos){var r=N(n.bgPos);t.style.backgroundPosition=-r.x+"px "+-r.y+"px"}return this._setIconStyles(t,"icon"),t},createShadow:function(){return null}});function Lr(e){return new Dr(e)}Jn.Default=$n;var zr=qn.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Le.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(e){p(this,e)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(e){e._addZoomLimit(this)},onRemove:function(e){this._removeAllTiles(),ft(this._container),e._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(gt(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(yt(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(e){return this.options.opacity=e,this._updateOpacity(),this},setZIndex:function(e){return this.options.zIndex=e,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var e=this._clampZoom(this._map.getZoom());e!==this._tileZoom&&(this._tileZoom=e,this._updateLevels()),this._update()}return this},getEvents:function(){var e={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=s(this._onMoveEnd,this.options.updateInterval,this)),e.move=this._onMove),this._zoomAnimated&&(e.zoomanim=this._animateZoom),e},createTile:function(){return document.createElement("div")},getTileSize:function(){var e=this.options.tileSize;return e instanceof I?e:new I(e,e)},_updateZIndex:function(){this._container&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(e){for(var t,n=this.getPane().children,r=-e(-1/0,1/0),i=0,o=n.length;i<o;i++)t=n[i].style.zIndex,n[i]!==this._container&&t&&(r=e(r,+t));isFinite(r)&&(this.options.zIndex=r+e(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Le.ielt9){St(this._container,this.options.opacity);var e=+new Date,t=!1,n=!1;for(var r in this._tiles){var i=this._tiles[r];if(i.current&&i.loaded){var o=Math.min(1,(e-i.loaded)/200);St(i.el,o),o<1?t=!0:(i.active?n=!0:this._onOpaqueTile(i),i.active=!0)}}n&&!this._noPrune&&this._pruneTiles(),t&&(A(this._fadeFrame),this._fadeFrame=E(this._updateOpacity,this))}},_onOpaqueTile:c,_initContainer:function(){this._container||(this._container=pt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var e=this._tileZoom,t=this.options.maxZoom;if(void 0!==e){for(var n in this._levels)n=Number(n),this._levels[n].el.children.length||n===e?(this._levels[n].el.style.zIndex=t-Math.abs(e-n),this._onUpdateLevel(n)):(ft(this._levels[n].el),this._removeTilesAtZoom(n),this._onRemoveLevel(n),delete this._levels[n]);var r=this._levels[e],i=this._map;return r||((r=this._levels[e]={}).el=pt("div","leaflet-tile-container leaflet-zoom-animated",this._container),r.el.style.zIndex=t,r.origin=i.project(i.unproject(i.getPixelOrigin()),e).round(),r.zoom=e,this._setZoomTransform(r,i.getCenter(),i.getZoom()),c(r.el.offsetWidth),this._onCreateLevel(r)),this._level=r,r}},_onUpdateLevel:c,_onRemoveLevel:c,_onCreateLevel:c,_pruneTiles:function(){if(this._map){var e,t,n=this._map.getZoom();if(n>this.options.maxZoom||n<this.options.minZoom)this._removeAllTiles();else{for(e in this._tiles)(t=this._tiles[e]).retain=t.current;for(e in this._tiles)if((t=this._tiles[e]).current&&!t.active){var r=t.coords;this._retainParent(r.x,r.y,r.z,r.z-5)||this._retainChildren(r.x,r.y,r.z,r.z+2)}for(e in this._tiles)this._tiles[e].retain||this._removeTile(e)}}},_removeTilesAtZoom:function(e){for(var t in this._tiles)this._tiles[t].coords.z===e&&this._removeTile(t)},_removeAllTiles:function(){for(var e in this._tiles)this._removeTile(e)},_invalidateAll:function(){for(var e in this._levels)ft(this._levels[e].el),this._onRemoveLevel(Number(e)),delete this._levels[e];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(e,t,n,r){var i=Math.floor(e/2),o=Math.floor(t/2),a=n-1,s=new I(+i,+o);s.z=+a;var l=this._tileCoordsToKey(s),c=this._tiles[l];return c&&c.active?(c.retain=!0,!0):(c&&c.loaded&&(c.retain=!0),a>r&&this._retainParent(i,o,a,r))},_retainChildren:function(e,t,n,r){for(var i=2*e;i<2*e+2;i++)for(var o=2*t;o<2*t+2;o++){var a=new I(i,o);a.z=n+1;var s=this._tileCoordsToKey(a),l=this._tiles[s];l&&l.active?l.retain=!0:(l&&l.loaded&&(l.retain=!0),n+1<r&&this._retainChildren(i,o,n+1,r))}},_resetView:function(e){var t=e&&(e.pinch||e.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),t,t)},_animateZoom:function(e){this._setView(e.center,e.zoom,!0,e.noUpdate)},_clampZoom:function(e){var t=this.options;return void 0!==t.minNativeZoom&&e<t.minNativeZoom?t.minNativeZoom:void 0!==t.maxNativeZoom&&t.maxNativeZoom<e?t.maxNativeZoom:e},_setView:function(e,t,n,r){var i=Math.round(t);i=void 0!==this.options.maxZoom&&i>this.options.maxZoom||void 0!==this.options.minZoom&&i<this.options.minZoom?void 0:this._clampZoom(i);var o=this.options.updateWhenZooming&&i!==this._tileZoom;r&&!o||(this._tileZoom=i,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),void 0!==i&&this._update(e),n||this._pruneTiles(),this._noPrune=!!n),this._setZoomTransforms(e,t)},_setZoomTransforms:function(e,t){for(var n in this._levels)this._setZoomTransform(this._levels[n],e,t)},_setZoomTransform:function(e,t,n){var r=this._map.getZoomScale(n,e.zoom),i=e.origin.multiplyBy(r).subtract(this._map._getNewPixelOrigin(t,n)).round();Le.any3d?At(e.el,i,r):Mt(e.el,i)},_resetGrid:function(){var e=this._map,t=e.options.crs,n=this._tileSize=this.getTileSize(),r=this._tileZoom,i=this._map.getPixelWorldBounds(this._tileZoom);i&&(this._globalTileRange=this._pxBoundsToTileRange(i)),this._wrapX=t.wrapLng&&!this.options.noWrap&&[Math.floor(e.project([0,t.wrapLng[0]],r).x/n.x),Math.ceil(e.project([0,t.wrapLng[1]],r).x/n.y)],this._wrapY=t.wrapLat&&!this.options.noWrap&&[Math.floor(e.project([t.wrapLat[0],0],r).y/n.x),Math.ceil(e.project([t.wrapLat[1],0],r).y/n.y)]},_onMoveEnd:function(){this._map&&!this._map._animatingZoom&&this._update()},_getTiledPixelBounds:function(e){var t=this._map,n=t._animatingZoom?Math.max(t._animateToZoom,t.getZoom()):t.getZoom(),r=t.getZoomScale(n,this._tileZoom),i=t.project(e,this._tileZoom).floor(),o=t.getSize().divideBy(2*r);return new D(i.subtract(o),i.add(o))},_update:function(e){var t=this._map;if(t){var n=this._clampZoom(t.getZoom());if(void 0===e&&(e=t.getCenter()),void 0!==this._tileZoom){var r=this._getTiledPixelBounds(e),i=this._pxBoundsToTileRange(r),o=i.getCenter(),a=[],s=this.options.keepBuffer,l=new D(i.getBottomLeft().subtract([s,-s]),i.getTopRight().add([s,-s]));if(!(isFinite(i.min.x)&&isFinite(i.min.y)&&isFinite(i.max.x)&&isFinite(i.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var c in this._tiles){var u=this._tiles[c].coords;u.z===this._tileZoom&&l.contains(new I(u.x,u.y))||(this._tiles[c].current=!1)}if(Math.abs(n-this._tileZoom)>1)this._setView(e,n);else{for(var h=i.min.y;h<=i.max.y;h++)for(var d=i.min.x;d<=i.max.x;d++){var p=new I(d,h);if(p.z=this._tileZoom,this._isValidTile(p)){var f=this._tiles[this._tileCoordsToKey(p)];f?f.current=!0:a.push(p)}}if(a.sort((function(e,t){return e.distanceTo(o)-t.distanceTo(o)})),0!==a.length){this._loading||(this._loading=!0,this.fire("loading"));var m=document.createDocumentFragment();for(d=0;d<a.length;d++)this._addTile(a[d],m);this._level.el.appendChild(m)}}}}},_isValidTile:function(e){var t=this._map.options.crs;if(!t.infinite){var n=this._globalTileRange;if(!t.wrapLng&&(e.x<n.min.x||e.x>n.max.x)||!t.wrapLat&&(e.y<n.min.y||e.y>n.max.y))return!1}if(!this.options.bounds)return!0;var r=this._tileCoordsToBounds(e);return F(this.options.bounds).overlaps(r)},_keyToBounds:function(e){return this._tileCoordsToBounds(this._keyToTileCoords(e))},_tileCoordsToNwSe:function(e){var t=this._map,n=this.getTileSize(),r=e.scaleBy(n),i=r.add(n);return[t.unproject(r,e.z),t.unproject(i,e.z)]},_tileCoordsToBounds:function(e){var t=this._tileCoordsToNwSe(e),n=new R(t[0],t[1]);return this.options.noWrap||(n=this._map.wrapLatLngBounds(n)),n},_tileCoordsToKey:function(e){return e.x+":"+e.y+":"+e.z},_keyToTileCoords:function(e){var t=e.split(":"),n=new I(+t[0],+t[1]);return n.z=+t[2],n},_removeTile:function(e){var t=this._tiles[e];t&&(ft(t.el),delete this._tiles[e],this.fire("tileunload",{tile:t.el,coords:this._keyToTileCoords(e)}))},_initTile:function(e){vt(e,"leaflet-tile");var t=this.getTileSize();e.style.width=t.x+"px",e.style.height=t.y+"px",e.onselectstart=c,e.onmousemove=c,Le.ielt9&&this.options.opacity<1&&St(e,this.options.opacity)},_addTile:function(e,t){var n=this._getTilePos(e),r=this._tileCoordsToKey(e),o=this.createTile(this._wrapCoords(e),i(this._tileReady,this,e));this._initTile(o),this.createTile.length<2&&E(i(this._tileReady,this,e,null,o)),Mt(o,n),this._tiles[r]={el:o,coords:e,current:!0},t.appendChild(o),this.fire("tileloadstart",{tile:o,coords:e})},_tileReady:function(e,t,n){t&&this.fire("tileerror",{error:t,tile:n,coords:e});var r=this._tileCoordsToKey(e);(n=this._tiles[r])&&(n.loaded=+new Date,this._map._fadeAnimated?(St(n.el,0),A(this._fadeFrame),this._fadeFrame=E(this._updateOpacity,this)):(n.active=!0,this._pruneTiles()),t||(vt(n.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:n.el,coords:e})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Le.ielt9||!this._map._fadeAnimated?E(this._pruneTiles,this):setTimeout(i(this._pruneTiles,this),250)))},_getTilePos:function(e){return e.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(e){var t=new I(this._wrapX?l(e.x,this._wrapX):e.x,this._wrapY?l(e.y,this._wrapY):e.y);return t.z=e.z,t},_pxBoundsToTileRange:function(e){var t=this.getTileSize();return new D(e.min.unscaleBy(t).floor(),e.max.unscaleBy(t).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var e in this._tiles)if(!this._tiles[e].loaded)return!1;return!0}});function Rr(e){return new zr(e)}var Fr=zr.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(e,t){this._url=e,(t=p(this,t)).detectRetina&&Le.retina&&t.maxZoom>0?(t.tileSize=Math.floor(t.tileSize/2),t.zoomReverse?(t.zoomOffset--,t.minZoom=Math.min(t.maxZoom,t.minZoom+1)):(t.zoomOffset++,t.maxZoom=Math.max(t.minZoom,t.maxZoom-1)),t.minZoom=Math.max(0,t.minZoom)):t.zoomReverse?t.minZoom=Math.min(t.maxZoom,t.minZoom):t.maxZoom=Math.max(t.minZoom,t.maxZoom),"string"===typeof t.subdomains&&(t.subdomains=t.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(e,t){return this._url===e&&void 0===t&&(t=!0),this._url=e,t||this.redraw(),this},createTile:function(e,t){var n=document.createElement("img");return zt(n,"load",i(this._tileOnLoad,this,t,n)),zt(n,"error",i(this._tileOnError,this,t,n)),(this.options.crossOrigin||""===this.options.crossOrigin)&&(n.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),"string"===typeof this.options.referrerPolicy&&(n.referrerPolicy=this.options.referrerPolicy),n.alt="",n.src=this.getTileUrl(e),n},getTileUrl:function(e){var t={r:Le.retina?"@2x":"",s:this._getSubdomain(e),x:e.x,y:e.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var r=this._globalTileRange.max.y-e.y;this.options.tms&&(t.y=r),t["-y"]=r}return g(this._url,n(t,this.options))},_tileOnLoad:function(e,t){Le.ielt9?setTimeout(i(e,this,null,t),0):e(null,t)},_tileOnError:function(e,t,n){var r=this.options.errorTileUrl;r&&t.getAttribute("src")!==r&&(t.src=r),e(n,t)},_onTileRemove:function(e){e.tile.onload=null},_getZoomForUrl:function(){var e=this._tileZoom,t=this.options.maxZoom;return this.options.zoomReverse&&(e=t-e),e+this.options.zoomOffset},_getSubdomain:function(e){var t=Math.abs(e.x+e.y)%this.options.subdomains.length;return this.options.subdomains[t]},_abortLoading:function(){var e,t;for(e in this._tiles)if(this._tiles[e].coords.z!==this._tileZoom&&((t=this._tiles[e].el).onload=c,t.onerror=c,!t.complete)){t.src=v;var n=this._tiles[e].coords;ft(t),delete this._tiles[e],this.fire("tileabort",{tile:t,coords:n})}},_removeTile:function(e){var t=this._tiles[e];if(t)return t.el.setAttribute("src",v),zr.prototype._removeTile.call(this,e)},_tileReady:function(e,t,n){if(this._map&&(!n||n.getAttribute("src")!==v))return zr.prototype._tileReady.call(this,e,t,n)}});function Br(e,t){return new Fr(e,t)}var Vr=Fr.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(e,t){this._url=e;var r=n({},this.defaultWmsParams);for(var i in t)i in this.options||(r[i]=t[i]);var o=(t=p(this,t)).detectRetina&&Le.retina?2:1,a=this.getTileSize();r.width=a.x*o,r.height=a.y*o,this.wmsParams=r},onAdd:function(e){this._crs=this.options.crs||e.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var t=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[t]=this._crs.code,Fr.prototype.onAdd.call(this,e)},getTileUrl:function(e){var t=this._tileCoordsToNwSe(e),n=this._crs,r=z(n.project(t[0]),n.project(t[1])),i=r.min,o=r.max,a=(this._wmsVersion>=1.3&&this._crs===Hn?[i.y,i.x,o.y,o.x]:[i.x,i.y,o.x,o.y]).join(","),s=Fr.prototype.getTileUrl.call(this,e);return s+f(this.wmsParams,s,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+a},setParams:function(e,t){return n(this.wmsParams,e),t||this.redraw(),this}});function Ur(e,t){return new Vr(e,t)}Fr.WMS=Vr,Br.wms=Ur;var Gr=qn.extend({options:{padding:.1},initialize:function(e){p(this,e),a(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),vt(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var e={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(e.zoomanim=this._onAnimZoom),e},_onAnimZoom:function(e){this._updateTransform(e.center,e.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(e,t){var n=this._map.getZoomScale(t,this._zoom),r=this._map.getSize().multiplyBy(.5+this.options.padding),i=this._map.project(this._center,t),o=r.multiplyBy(-n).add(i).subtract(this._map._getNewPixelOrigin(e,t));Le.any3d?At(this._container,o,n):Mt(this._container,o)},_reset:function(){for(var e in this._update(),this._updateTransform(this._center,this._zoom),this._layers)this._layers[e]._reset()},_onZoomEnd:function(){for(var e in this._layers)this._layers[e]._project()},_updatePaths:function(){for(var e in this._layers)this._layers[e]._update()},_update:function(){var e=this.options.padding,t=this._map.getSize(),n=this._map.containerPointToLayerPoint(t.multiplyBy(-e)).round();this._bounds=new D(n,n.add(t.multiplyBy(1+2*e)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Hr=Gr.extend({options:{tolerance:0},getEvents:function(){var e=Gr.prototype.getEvents.call(this);return e.viewprereset=this._onViewPreReset,e},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Gr.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var e=this._container=document.createElement("canvas");zt(e,"mousemove",this._onMouseMove,this),zt(e,"click dblclick mousedown mouseup contextmenu",this._onClick,this),zt(e,"mouseout",this._handleMouseOut,this),e._leaflet_disable_events=!0,this._ctx=e.getContext("2d")},_destroyContainer:function(){A(this._redrawRequest),delete this._ctx,ft(this._container),Ft(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){for(var e in this._redrawBounds=null,this._layers)this._layers[e]._update();this._redraw()}},_update:function(){if(!this._map._animatingZoom||!this._bounds){Gr.prototype._update.call(this);var e=this._bounds,t=this._container,n=e.getSize(),r=Le.retina?2:1;Mt(t,e.min),t.width=r*n.x,t.height=r*n.y,t.style.width=n.x+"px",t.style.height=n.y+"px",Le.retina&&this._ctx.scale(2,2),this._ctx.translate(-e.min.x,-e.min.y),this.fire("update")}},_reset:function(){Gr.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(e){this._updateDashArray(e),this._layers[a(e)]=e;var t=e._order={layer:e,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=t),this._drawLast=t,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(e){this._requestRedraw(e)},_removePath:function(e){var t=e._order,n=t.next,r=t.prev;n?n.prev=r:this._drawLast=r,r?r.next=n:this._drawFirst=n,delete e._order,delete this._layers[a(e)],this._requestRedraw(e)},_updatePath:function(e){this._extendRedrawBounds(e),e._project(),e._update(),this._requestRedraw(e)},_updateStyle:function(e){this._updateDashArray(e),this._requestRedraw(e)},_updateDashArray:function(e){if("string"===typeof e.options.dashArray){var t,n,r=e.options.dashArray.split(/[, ]+/),i=[];for(n=0;n<r.length;n++){if(t=Number(r[n]),isNaN(t))return;i.push(t)}e.options._dashArray=i}else e.options._dashArray=e.options.dashArray},_requestRedraw:function(e){this._map&&(this._extendRedrawBounds(e),this._redrawRequest=this._redrawRequest||E(this._redraw,this))},_extendRedrawBounds:function(e){if(e._pxBounds){var t=(e.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new D,this._redrawBounds.extend(e._pxBounds.min.subtract([t,t])),this._redrawBounds.extend(e._pxBounds.max.add([t,t]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var e=this._redrawBounds;if(e){var t=e.getSize();this._ctx.clearRect(e.min.x,e.min.y,t.x,t.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var e,t=this._redrawBounds;if(this._ctx.save(),t){var n=t.getSize();this._ctx.beginPath(),this._ctx.rect(t.min.x,t.min.y,n.x,n.y),this._ctx.clip()}this._drawing=!0;for(var r=this._drawFirst;r;r=r.next)e=r.layer,(!t||e._pxBounds&&e._pxBounds.intersects(t))&&e._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(e,t){if(this._drawing){var n,r,i,o,a=e._parts,s=a.length,l=this._ctx;if(s){for(l.beginPath(),n=0;n<s;n++){for(r=0,i=a[n].length;r<i;r++)o=a[n][r],l[r?"lineTo":"moveTo"](o.x,o.y);t&&l.closePath()}this._fillStroke(l,e)}}},_updateCircle:function(e){if(this._drawing&&!e._empty()){var t=e._point,n=this._ctx,r=Math.max(Math.round(e._radius),1),i=(Math.max(Math.round(e._radiusY),1)||r)/r;1!==i&&(n.save(),n.scale(1,i)),n.beginPath(),n.arc(t.x,t.y/i,r,0,2*Math.PI,!1),1!==i&&n.restore(),this._fillStroke(n,e)}},_fillStroke:function(e,t){var n=t.options;n.fill&&(e.globalAlpha=n.fillOpacity,e.fillStyle=n.fillColor||n.color,e.fill(n.fillRule||"evenodd")),n.stroke&&0!==n.weight&&(e.setLineDash&&e.setLineDash(t.options&&t.options._dashArray||[]),e.globalAlpha=n.opacity,e.lineWidth=n.weight,e.strokeStyle=n.color,e.lineCap=n.lineCap,e.lineJoin=n.lineJoin,e.stroke())},_onClick:function(e){for(var t,n,r=this._map.mouseEventToLayerPoint(e),i=this._drawFirst;i;i=i.next)(t=i.layer).options.interactive&&t._containsPoint(r)&&("click"!==e.type&&"preclick"!==e.type||!this._map._draggableMoved(t))&&(n=t);this._fireEvent(!!n&&[n],e)},_onMouseMove:function(e){if(this._map&&!this._map.dragging.moving()&&!this._map._animatingZoom){var t=this._map.mouseEventToLayerPoint(e);this._handleMouseHover(e,t)}},_handleMouseOut:function(e){var t=this._hoveredLayer;t&&(xt(this._container,"leaflet-interactive"),this._fireEvent([t],e,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(e,t){if(!this._mouseHoverThrottled){for(var n,r,o=this._drawFirst;o;o=o.next)(n=o.layer).options.interactive&&n._containsPoint(t)&&(r=n);r!==this._hoveredLayer&&(this._handleMouseOut(e),r&&(vt(this._container,"leaflet-interactive"),this._fireEvent([r],e,"mouseover"),this._hoveredLayer=r)),this._fireEvent(!!this._hoveredLayer&&[this._hoveredLayer],e),this._mouseHoverThrottled=!0,setTimeout(i((function(){this._mouseHoverThrottled=!1}),this),32)}},_fireEvent:function(e,t,n){this._map._fireDOMEvent(t,n||t.type,e)},_bringToFront:function(e){var t=e._order;if(t){var n=t.next,r=t.prev;n&&(n.prev=r,r?r.next=n:n&&(this._drawFirst=n),t.prev=this._drawLast,this._drawLast.next=t,t.next=null,this._drawLast=t,this._requestRedraw(e))}},_bringToBack:function(e){var t=e._order;if(t){var n=t.next,r=t.prev;r&&(r.next=n,n?n.prev=r:r&&(this._drawLast=r),t.prev=null,t.next=this._drawFirst,this._drawFirst.prev=t,this._drawFirst=t,this._requestRedraw(e))}}});function Zr(e){return Le.canvas?new Hr(e):null}var qr=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(e){return document.createElement("<lvml:"+e+' class="lvml">')}}catch(e){}return function(e){return document.createElement("<"+e+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),Wr={_initContainer:function(){this._container=pt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Gr.prototype._update.call(this),this.fire("update"))},_initPath:function(e){var t=e._container=qr("shape");vt(t,"leaflet-vml-shape "+(this.options.className||"")),t.coordsize="1 1",e._path=qr("path"),t.appendChild(e._path),this._updateStyle(e),this._layers[a(e)]=e},_addPath:function(e){var t=e._container;this._container.appendChild(t),e.options.interactive&&e.addInteractiveTarget(t)},_removePath:function(e){var t=e._container;ft(t),e.removeInteractiveTarget(t),delete this._layers[a(e)]},_updateStyle:function(e){var t=e._stroke,n=e._fill,r=e.options,i=e._container;i.stroked=!!r.stroke,i.filled=!!r.fill,r.stroke?(t||(t=e._stroke=qr("stroke")),i.appendChild(t),t.weight=r.weight+"px",t.color=r.color,t.opacity=r.opacity,r.dashArray?t.dashStyle=y(r.dashArray)?r.dashArray.join(" "):r.dashArray.replace(/( *, *)/g," "):t.dashStyle="",t.endcap=r.lineCap.replace("butt","flat"),t.joinstyle=r.lineJoin):t&&(i.removeChild(t),e._stroke=null),r.fill?(n||(n=e._fill=qr("fill")),i.appendChild(n),n.color=r.fillColor||r.color,n.opacity=r.fillOpacity):n&&(i.removeChild(n),e._fill=null)},_updateCircle:function(e){var t=e._point.round(),n=Math.round(e._radius),r=Math.round(e._radiusY||n);this._setPath(e,e._empty()?"M0 0":"AL "+t.x+","+t.y+" "+n+","+r+" 0,23592600")},_setPath:function(e,t){e._path.v=t},_bringToFront:function(e){gt(e._container)},_bringToBack:function(e){yt(e._container)}},Xr=Le.vml?qr:K,Yr=Gr.extend({_initContainer:function(){this._container=Xr("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Xr("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){ft(this._container),Ft(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!this._map._animatingZoom||!this._bounds){Gr.prototype._update.call(this);var e=this._bounds,t=e.getSize(),n=this._container;this._svgSize&&this._svgSize.equals(t)||(this._svgSize=t,n.setAttribute("width",t.x),n.setAttribute("height",t.y)),Mt(n,e.min),n.setAttribute("viewBox",[e.min.x,e.min.y,t.x,t.y].join(" ")),this.fire("update")}},_initPath:function(e){var t=e._path=Xr("path");e.options.className&&vt(t,e.options.className),e.options.interactive&&vt(t,"leaflet-interactive"),this._updateStyle(e),this._layers[a(e)]=e},_addPath:function(e){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(e._path),e.addInteractiveTarget(e._path)},_removePath:function(e){ft(e._path),e.removeInteractiveTarget(e._path),delete this._layers[a(e)]},_updatePath:function(e){e._project(),e._update()},_updateStyle:function(e){var t=e._path,n=e.options;t&&(n.stroke?(t.setAttribute("stroke",n.color),t.setAttribute("stroke-opacity",n.opacity),t.setAttribute("stroke-width",n.weight),t.setAttribute("stroke-linecap",n.lineCap),t.setAttribute("stroke-linejoin",n.lineJoin),n.dashArray?t.setAttribute("stroke-dasharray",n.dashArray):t.removeAttribute("stroke-dasharray"),n.dashOffset?t.setAttribute("stroke-dashoffset",n.dashOffset):t.removeAttribute("stroke-dashoffset")):t.setAttribute("stroke","none"),n.fill?(t.setAttribute("fill",n.fillColor||n.color),t.setAttribute("fill-opacity",n.fillOpacity),t.setAttribute("fill-rule",n.fillRule||"evenodd")):t.setAttribute("fill","none"))},_updatePoly:function(e,t){this._setPath(e,J(e._parts,t))},_updateCircle:function(e){var t=e._point,n=Math.max(Math.round(e._radius),1),r="a"+n+","+(Math.max(Math.round(e._radiusY),1)||n)+" 0 1,0 ",i=e._empty()?"M0 0":"M"+(t.x-n)+","+t.y+r+2*n+",0 "+r+2*-n+",0 ";this._setPath(e,i)},_setPath:function(e,t){e._path.setAttribute("d",t)},_bringToFront:function(e){gt(e._path)},_bringToBack:function(e){yt(e._path)}});function Kr(e){return Le.svg||Le.vml?new Yr(e):null}Le.vml&&Yr.include(Wr),nn.include({getRenderer:function(e){var t=e.options.renderer||this._getPaneRenderer(e.options.pane)||this.options.renderer||this._renderer;return t||(t=this._renderer=this._createRenderer()),this.hasLayer(t)||this.addLayer(t),t},_getPaneRenderer:function(e){if("overlayPane"===e||void 0===e)return!1;var t=this._paneRenderers[e];return void 0===t&&(t=this._createRenderer({pane:e}),this._paneRenderers[e]=t),t},_createRenderer:function(e){return this.options.preferCanvas&&Zr(e)||Kr(e)}});var Jr=ur.extend({initialize:function(e,t){ur.prototype.initialize.call(this,this._boundsToLatLngs(e),t)},setBounds:function(e){return this.setLatLngs(this._boundsToLatLngs(e))},_boundsToLatLngs:function(e){return[(e=F(e)).getSouthWest(),e.getNorthWest(),e.getNorthEast(),e.getSouthEast()]}});function Qr(e,t){return new Jr(e,t)}Yr.create=Xr,Yr.pointsToPath=J,dr.geometryToLayer=pr,dr.coordsToLatLng=mr,dr.coordsToLatLngs=gr,dr.latLngToCoords=yr,dr.latLngsToCoords=_r,dr.getFeature=vr,dr.asFeature=xr,nn.mergeOptions({boxZoom:!0});var $r=gn.extend({initialize:function(e){this._map=e,this._container=e._container,this._pane=e._panes.overlayPane,this._resetStateTimeout=0,e.on("unload",this._destroy,this)},addHooks:function(){zt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Ft(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){ft(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){0!==this._resetStateTimeout&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(e){if(!e.shiftKey||1!==e.which&&1!==e.button)return!1;this._clearDeferredResetState(),this._resetState(),rt(),Ct(),this._startPoint=this._map.mouseEventToContainerPoint(e),zt(document,{contextmenu:Xt,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(e){this._moved||(this._moved=!0,this._box=pt("div","leaflet-zoom-box",this._container),vt(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(e);var t=new D(this._point,this._startPoint),n=t.getSize();Mt(this._box,t.min),this._box.style.width=n.x+"px",this._box.style.height=n.y+"px"},_finish:function(){this._moved&&(ft(this._box),xt(this._container,"leaflet-crosshair")),it(),jt(),Ft(document,{contextmenu:Xt,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(e){if((1===e.which||1===e.button)&&(this._finish(),this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(i(this._resetState,this),0);var t=new R(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(t).fire("boxzoomend",{boxZoomBounds:t})}},_onKeyDown:function(e){27===e.keyCode&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});nn.addInitHook("addHandler","boxZoom",$r),nn.mergeOptions({doubleClickZoom:!0});var ei=gn.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(e){var t=this._map,n=t.getZoom(),r=t.options.zoomDelta,i=e.originalEvent.shiftKey?n-r:n+r;"center"===t.options.doubleClickZoom?t.setZoom(i):t.setZoomAround(e.containerPoint,i)}});nn.addInitHook("addHandler","doubleClickZoom",ei),nn.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var ti=gn.extend({addHooks:function(){if(!this._draggable){var e=this._map;this._draggable=new vn(e._mapPane,e._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),e.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),e.on("zoomend",this._onZoomEnd,this),e.whenReady(this._onZoomEnd,this))}vt(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){xt(this._map._container,"leaflet-grab"),xt(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var e=this._map;if(e._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var t=F(this._map.options.maxBounds);this._offsetLimit=z(this._map.latLngToContainerPoint(t.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(t.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;e.fire("movestart").fire("dragstart"),e.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(e){if(this._map.options.inertia){var t=this._lastTime=+new Date,n=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(n),this._times.push(t),this._prunePositions(t)}this._map.fire("move",e).fire("drag",e)},_prunePositions:function(e){for(;this._positions.length>1&&e-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var e=this._map.getSize().divideBy(2),t=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=t.subtract(e).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(e,t){return e-(e-t)*this._viscosity},_onPreDragLimit:function(){if(this._viscosity&&this._offsetLimit){var e=this._draggable._newPos.subtract(this._draggable._startPos),t=this._offsetLimit;e.x<t.min.x&&(e.x=this._viscousLimit(e.x,t.min.x)),e.y<t.min.y&&(e.y=this._viscousLimit(e.y,t.min.y)),e.x>t.max.x&&(e.x=this._viscousLimit(e.x,t.max.x)),e.y>t.max.y&&(e.y=this._viscousLimit(e.y,t.max.y)),this._draggable._newPos=this._draggable._startPos.add(e)}},_onPreDragWrap:function(){var e=this._worldWidth,t=Math.round(e/2),n=this._initialWorldOffset,r=this._draggable._newPos.x,i=(r-t+n)%e+t-n,o=(r+t+n)%e-t-n,a=Math.abs(i+n)<Math.abs(o+n)?i:o;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=a},_onDragEnd:function(e){var t=this._map,n=t.options,r=!n.inertia||e.noInertia||this._times.length<2;if(t.fire("dragend",e),r)t.fire("moveend");else{this._prunePositions(+new Date);var i=this._lastPos.subtract(this._positions[0]),o=(this._lastTime-this._times[0])/1e3,a=n.easeLinearity,s=i.multiplyBy(a/o),l=s.distanceTo([0,0]),c=Math.min(n.inertiaMaxSpeed,l),u=s.multiplyBy(c/l),h=c/(n.inertiaDeceleration*a),d=u.multiplyBy(-h/2).round();d.x||d.y?(d=t._limitOffset(d,t.options.maxBounds),E((function(){t.panBy(d,{duration:h,easeLinearity:a,noMoveStart:!0,animate:!0})}))):t.fire("moveend")}}});nn.addInitHook("addHandler","dragging",ti),nn.mergeOptions({keyboard:!0,keyboardPanDelta:80});var ni=gn.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(e){this._map=e,this._setPanDelta(e.options.keyboardPanDelta),this._setZoomDelta(e.options.zoomDelta)},addHooks:function(){var e=this._map._container;e.tabIndex<=0&&(e.tabIndex="0"),zt(e,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Ft(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var e=document.body,t=document.documentElement,n=e.scrollTop||t.scrollTop,r=e.scrollLeft||t.scrollLeft;this._map._container.focus(),window.scrollTo(r,n)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(e){var t,n,r=this._panKeys={},i=this.keyCodes;for(t=0,n=i.left.length;t<n;t++)r[i.left[t]]=[-1*e,0];for(t=0,n=i.right.length;t<n;t++)r[i.right[t]]=[e,0];for(t=0,n=i.down.length;t<n;t++)r[i.down[t]]=[0,e];for(t=0,n=i.up.length;t<n;t++)r[i.up[t]]=[0,-1*e]},_setZoomDelta:function(e){var t,n,r=this._zoomKeys={},i=this.keyCodes;for(t=0,n=i.zoomIn.length;t<n;t++)r[i.zoomIn[t]]=e;for(t=0,n=i.zoomOut.length;t<n;t++)r[i.zoomOut[t]]=-e},_addHooks:function(){zt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Ft(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(e){if(!(e.altKey||e.ctrlKey||e.metaKey)){var t,n=e.keyCode,r=this._map;if(n in this._panKeys){if(!r._panAnim||!r._panAnim._inProgress)if(t=this._panKeys[n],e.shiftKey&&(t=N(t).multiplyBy(3)),r.options.maxBounds&&(t=r._limitOffset(N(t),r.options.maxBounds)),r.options.worldCopyJump){var i=r.wrapLatLng(r.unproject(r.project(r.getCenter()).add(t)));r.panTo(i)}else r.panBy(t)}else if(n in this._zoomKeys)r.setZoom(r.getZoom()+(e.shiftKey?3:1)*this._zoomKeys[n]);else{if(27!==n||!r._popup||!r._popup.options.closeOnEscapeKey)return;r.closePopup()}Xt(e)}}});nn.addInitHook("addHandler","keyboard",ni),nn.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var ri=gn.extend({addHooks:function(){zt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Ft(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(e){var t=Qt(e),n=this._map.options.wheelDebounceTime;this._delta+=t,this._lastMousePos=this._map.mouseEventToContainerPoint(e),this._startTime||(this._startTime=+new Date);var r=Math.max(n-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(i(this._performZoom,this),r),Xt(e)},_performZoom:function(){var e=this._map,t=e.getZoom(),n=this._map.options.zoomSnap||0;e._stop();var r=this._delta/(4*this._map.options.wheelPxPerZoomLevel),i=4*Math.log(2/(1+Math.exp(-Math.abs(r))))/Math.LN2,o=n?Math.ceil(i/n)*n:i,a=e._limitZoom(t+(this._delta>0?o:-o))-t;this._delta=0,this._startTime=null,a&&("center"===e.options.scrollWheelZoom?e.setZoom(t+a):e.setZoomAround(this._lastMousePos,t+a))}});nn.addInitHook("addHandler","scrollWheelZoom",ri);var ii=600;nn.mergeOptions({tapHold:Le.touchNative&&Le.safari&&Le.mobile,tapTolerance:15});var oi=gn.extend({addHooks:function(){zt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Ft(this._map._container,"touchstart",this._onDown,this)},_onDown:function(e){if(clearTimeout(this._holdTimeout),1===e.touches.length){var t=e.touches[0];this._startPos=this._newPos=new I(t.clientX,t.clientY),this._holdTimeout=setTimeout(i((function(){this._cancel(),this._isTapValid()&&(zt(document,"touchend",Wt),zt(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",t))}),this),ii),zt(document,"touchend touchcancel contextmenu",this._cancel,this),zt(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function e(){Ft(document,"touchend",Wt),Ft(document,"touchend touchcancel",e)},_cancel:function(){clearTimeout(this._holdTimeout),Ft(document,"touchend touchcancel contextmenu",this._cancel,this),Ft(document,"touchmove",this._onMove,this)},_onMove:function(e){var t=e.touches[0];this._newPos=new I(t.clientX,t.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(e,t){var n=new MouseEvent(e,{bubbles:!0,cancelable:!0,view:window,screenX:t.screenX,screenY:t.screenY,clientX:t.clientX,clientY:t.clientY});n._simulated=!0,t.target.dispatchEvent(n)}});nn.addInitHook("addHandler","tapHold",oi),nn.mergeOptions({touchZoom:Le.touch,bounceAtZoomLimits:!0});var ai=gn.extend({addHooks:function(){vt(this._map._container,"leaflet-touch-zoom"),zt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){xt(this._map._container,"leaflet-touch-zoom"),Ft(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(e){var t=this._map;if(e.touches&&2===e.touches.length&&!t._animatingZoom&&!this._zooming){var n=t.mouseEventToContainerPoint(e.touches[0]),r=t.mouseEventToContainerPoint(e.touches[1]);this._centerPoint=t.getSize()._divideBy(2),this._startLatLng=t.containerPointToLatLng(this._centerPoint),"center"!==t.options.touchZoom&&(this._pinchStartLatLng=t.containerPointToLatLng(n.add(r)._divideBy(2))),this._startDist=n.distanceTo(r),this._startZoom=t.getZoom(),this._moved=!1,this._zooming=!0,t._stop(),zt(document,"touchmove",this._onTouchMove,this),zt(document,"touchend touchcancel",this._onTouchEnd,this),Wt(e)}},_onTouchMove:function(e){if(e.touches&&2===e.touches.length&&this._zooming){var t=this._map,n=t.mouseEventToContainerPoint(e.touches[0]),r=t.mouseEventToContainerPoint(e.touches[1]),o=n.distanceTo(r)/this._startDist;if(this._zoom=t.getScaleZoom(o,this._startZoom),!t.options.bounceAtZoomLimits&&(this._zoom<t.getMinZoom()&&o<1||this._zoom>t.getMaxZoom()&&o>1)&&(this._zoom=t._limitZoom(this._zoom)),"center"===t.options.touchZoom){if(this._center=this._startLatLng,1===o)return}else{var a=n._add(r)._divideBy(2)._subtract(this._centerPoint);if(1===o&&0===a.x&&0===a.y)return;this._center=t.unproject(t.project(this._pinchStartLatLng,this._zoom).subtract(a),this._zoom)}this._moved||(t._moveStart(!0,!1),this._moved=!0),A(this._animRequest);var s=i(t._move,t,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=E(s,this,!0),Wt(e)}},_onTouchEnd:function(){this._moved&&this._zooming?(this._zooming=!1,A(this._animRequest),Ft(document,"touchmove",this._onTouchMove,this),Ft(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))):this._zooming=!1}});nn.addInitHook("addHandler","touchZoom",ai),nn.BoxZoom=$r,nn.DoubleClickZoom=ei,nn.Drag=ti,nn.Keyboard=ni,nn.ScrollWheelZoom=ri,nn.TapHold=oi,nn.TouchZoom=ai,e.Bounds=D,e.Browser=Le,e.CRS=U,e.Canvas=Hr,e.Circle=ar,e.CircleMarker=ir,e.Class=P,e.Control=on,e.DivIcon=Dr,e.DivOverlay=Cr,e.DomEvent=en,e.DomUtil=Lt,e.Draggable=vn,e.Evented=j,e.FeatureGroup=Yn,e.GeoJSON=dr,e.GridLayer=zr,e.Handler=gn,e.Icon=Jn,e.ImageOverlay=Tr,e.LatLng=B,e.LatLngBounds=R,e.Layer=qn,e.LayerGroup=Wn,e.LineUtil=Fn,e.Map=nn,e.Marker=tr,e.Mixin=yn,e.Path=rr,e.Point=I,e.PolyUtil=Tn,e.Polygon=ur,e.Polyline=lr,e.Popup=jr,e.PosAnimation=tn,e.Projection=Un,e.Rectangle=Jr,e.Renderer=Gr,e.SVG=Yr,e.SVGOverlay=Pr,e.TileLayer=Fr,e.Tooltip=Or,e.Transformation=q,e.Util=M,e.VideoOverlay=Ar,e.bind=i,e.bounds=z,e.canvas=Zr,e.circle=sr,e.circleMarker=or,e.control=an,e.divIcon=Lr,e.extend=n,e.featureGroup=Kn,e.geoJSON=wr,e.geoJson=Sr,e.gridLayer=Rr,e.icon=Qn,e.imageOverlay=Er,e.latLng=V,e.latLngBounds=F,e.layerGroup=Xn,e.map=rn,e.marker=nr,e.point=N,e.polygon=hr,e.polyline=cr,e.popup=Ir,e.rectangle=Qr,e.setOptions=p,e.stamp=a,e.svg=Kr,e.svgOverlay=kr,e.tileLayer=Br,e.tooltip=Nr,e.transformation=W,e.version=t,e.videoOverlay=Mr;var si=window.L;e.noConflict=function(){return window.L=si,this},window.L=e}(t)},7685:(e,t,n)=>{var r=n(7937)(n(6552),"DataView");e.exports=r},8724:(e,t,n)=>{var r=n(7615),i=n(5051),o=n(2154),a=n(8734),s=n(2662);function l(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}l.prototype.clear=r,l.prototype.delete=i,l.prototype.get=o,l.prototype.has=a,l.prototype.set=s,e.exports=l},7160:(e,t,n)=>{var r=n(7563),i=n(9935),o=n(4190),a=n(1946),s=n(1714);function l(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}l.prototype.clear=r,l.prototype.delete=i,l.prototype.get=o,l.prototype.has=a,l.prototype.set=s,e.exports=l},5204:(e,t,n)=>{var r=n(7937)(n(6552),"Map");e.exports=r},4816:(e,t,n)=>{var r=n(7251),i=n(7159),o=n(438),a=n(9394),s=n(6874);function l(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}l.prototype.clear=r,l.prototype.delete=i,l.prototype.get=o,l.prototype.has=a,l.prototype.set=s,e.exports=l},5387:(e,t,n)=>{var r=n(7937)(n(6552),"Promise");e.exports=r},2070:(e,t,n)=>{var r=n(7937)(n(6552),"Set");e.exports=r},8902:(e,t,n)=>{var r=n(4816),i=n(6179),o=n(6704);function a(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new r;++t<n;)this.add(e[t])}a.prototype.add=a.prototype.push=i,a.prototype.has=o,e.exports=a},5538:(e,t,n)=>{var r=n(7160),i=n(4545),o=n(793),a=n(7760),s=n(3892),l=n(6788);function c(e){var t=this.__data__=new r(e);this.size=t.size}c.prototype.clear=i,c.prototype.delete=o,c.prototype.get=a,c.prototype.has=s,c.prototype.set=l,e.exports=c},9812:(e,t,n)=>{var r=n(6552).Symbol;e.exports=r},2929:(e,t,n)=>{var r=n(6552).Uint8Array;e.exports=r},6600:(e,t,n)=>{var r=n(7937)(n(6552),"WeakMap");e.exports=r},1170:e=>{e.exports=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}},5295:e=>{e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}},7529:e=>{e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var a=e[n];t(a,n,e)&&(o[i++]=a)}return o}},5866:(e,t,n)=>{var r=n(8468);e.exports=function(e,t){return!!(null==e?0:e.length)&&r(e,t,0)>-1}},1558:e=>{e.exports=function(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1}},3204:(e,t,n)=>{var r=n(3343),i=n(2777),o=n(4052),a=n(4543),s=n(9194),l=n(1268),c=Object.prototype.hasOwnProperty;e.exports=function(e,t){var n=o(e),u=!n&&i(e),h=!n&&!u&&a(e),d=!n&&!u&&!h&&l(e),p=n||u||h||d,f=p?r(e.length,String):[],m=f.length;for(var g in e)!t&&!c.call(e,g)||p&&("length"==g||h&&("offset"==g||"parent"==g)||d&&("buffer"==g||"byteLength"==g||"byteOffset"==g)||s(g,m))||f.push(g);return f}},149:e=>{e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}},8895:e=>{e.exports=function(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}},2587:e=>{e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}},5967:e=>{e.exports=function(e){return e.split("")}},1340:(e,t,n)=>{var r=n(3211);e.exports=function(e,t){for(var n=e.length;n--;)if(r(e[n][0],t))return n;return-1}},1775:(e,t,n)=>{var r=n(5654);e.exports=function(e,t,n){"__proto__"==t&&r?r(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}},5652:(e,t,n)=>{var r=n(4664),i=n(6516)(r);e.exports=i},4746:(e,t,n)=>{var r=n(5652);e.exports=function(e,t){var n=!0;return r(e,(function(e,r,i){return n=!!t(e,r,i)})),n}},9742:(e,t,n)=>{var r=n(9841);e.exports=function(e,t,n){for(var i=-1,o=e.length;++i<o;){var a=e[i],s=t(a);if(null!=s&&(void 0===l?s===s&&!r(s):n(s,l)))var l=s,c=a}return c}},5816:e=>{e.exports=function(e,t,n,r){for(var i=e.length,o=n+(r?1:-1);r?o--:++o<i;)if(t(e[o],o,e))return o;return-1}},755:(e,t,n)=>{var r=n(8895),i=n(7116);e.exports=function e(t,n,o,a,s){var l=-1,c=t.length;for(o||(o=i),s||(s=[]);++l<c;){var u=t[l];n>0&&o(u)?n>1?e(u,n-1,o,a,s):r(s,u):a||(s[s.length]=u)}return s}},4258:(e,t,n)=>{var r=n(5906)();e.exports=r},4664:(e,t,n)=>{var r=n(4258),i=n(8673);e.exports=function(e,t){return e&&r(e,t,i)}},2969:(e,t,n)=>{var r=n(5324),i=n(914);e.exports=function(e,t){for(var n=0,o=(t=r(t,e)).length;null!=e&&n<o;)e=e[i(t[n++])];return n&&n==o?e:void 0}},4262:(e,t,n)=>{var r=n(8895),i=n(4052);e.exports=function(e,t,n){var o=t(e);return i(e)?o:r(o,n(e))}},6913:(e,t,n)=>{var r=n(9812),i=n(4552),o=n(6095),a=r?r.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":a&&a in Object(e)?i(e):o(e)}},7498:e=>{e.exports=function(e,t){return e>t}},7894:e=>{e.exports=function(e,t){return null!=e&&t in Object(e)}},8468:(e,t,n)=>{var r=n(5816),i=n(644),o=n(4020);e.exports=function(e,t,n){return t===t?o(e,t,n):r(e,i,n)}},5193:(e,t,n)=>{var r=n(6913),i=n(2761);e.exports=function(e){return i(e)&&"[object Arguments]"==r(e)}},6989:(e,t,n)=>{var r=n(6399),i=n(2761);e.exports=function e(t,n,o,a,s){return t===n||(null==t||null==n||!i(t)&&!i(n)?t!==t&&n!==n:r(t,n,o,a,e,s))}},6399:(e,t,n)=>{var r=n(5538),i=n(3668),o=n(9987),a=n(5752),s=n(6924),l=n(4052),c=n(4543),u=n(1268),h="[object Arguments]",d="[object Array]",p="[object Object]",f=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,m,g,y){var _=l(e),v=l(t),x=_?d:s(e),b=v?d:s(t),w=(x=x==h?p:x)==p,S=(b=b==h?p:b)==p,T=x==b;if(T&&c(e)){if(!c(t))return!1;_=!0,w=!1}if(T&&!w)return y||(y=new r),_||u(e)?i(e,t,n,m,g,y):o(e,t,x,n,m,g,y);if(!(1&n)){var E=w&&f.call(e,"__wrapped__"),A=S&&f.call(t,"__wrapped__");if(E||A){var M=E?e.value():e,P=A?t.value():t;return y||(y=new r),g(M,P,n,m,y)}}return!!T&&(y||(y=new r),a(e,t,n,m,g,y))}},6532:(e,t,n)=>{var r=n(5538),i=n(6989);e.exports=function(e,t,n,o){var a=n.length,s=a,l=!o;if(null==e)return!s;for(e=Object(e);a--;){var c=n[a];if(l&&c[2]?c[1]!==e[c[0]]:!(c[0]in e))return!1}for(;++a<s;){var u=(c=n[a])[0],h=e[u],d=c[1];if(l&&c[2]){if(void 0===h&&!(u in e))return!1}else{var p=new r;if(o)var f=o(h,d,u,e,t,p);if(!(void 0===f?i(d,h,3,o,p):f))return!1}}return!0}},644:e=>{e.exports=function(e){return e!==e}},6954:(e,t,n)=>{var r=n(1629),i=n(7857),o=n(6686),a=n(6996),s=/^\[object .+?Constructor\]$/,l=Function.prototype,c=Object.prototype,u=l.toString,h=c.hasOwnProperty,d=RegExp("^"+u.call(h).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!o(e)||i(e))&&(r(e)?d:s).test(a(e))}},5428:(e,t,n)=>{var r=n(6913),i=n(6173),o=n(2761),a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1,e.exports=function(e){return o(e)&&i(e.length)&&!!a[r(e)]}},9096:(e,t,n)=>{var r=n(9256),i=n(5029),o=n(3279),a=n(4052),s=n(3932);e.exports=function(e){return"function"==typeof e?e:null==e?o:"object"==typeof e?a(e)?i(e[0],e[1]):r(e):s(e)}},3713:(e,t,n)=>{var r=n(6140),i=n(1143),o=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return i(e);var t=[];for(var n in Object(e))o.call(e,n)&&"constructor"!=n&&t.push(n);return t}},61:e=>{e.exports=function(e,t){return e<t}},8883:(e,t,n)=>{var r=n(5652),i=n(6571);e.exports=function(e,t){var n=-1,o=i(e)?Array(e.length):[];return r(e,(function(e,r,i){o[++n]=t(e,r,i)})),o}},9256:(e,t,n)=>{var r=n(6532),i=n(3781),o=n(1310);e.exports=function(e){var t=i(e);return 1==t.length&&t[0][2]?o(t[0][0],t[0][1]):function(n){return n===e||r(n,e,t)}}},5029:(e,t,n)=>{var r=n(6989),i=n(3097),o=n(3366),a=n(2597),s=n(9417),l=n(1310),c=n(914);e.exports=function(e,t){return a(e)&&s(t)?l(c(e),t):function(n){var a=i(n,e);return void 0===a&&a===t?o(n,e):r(t,a,3)}}},2536:(e,t,n)=>{var r=n(149),i=n(2969),o=n(9096),a=n(8883),s=n(320),l=n(7574),c=n(5893),u=n(3279),h=n(4052);e.exports=function(e,t,n){t=t.length?r(t,(function(e){return h(e)?function(t){return i(t,1===e.length?e[0]:e)}:e})):[u];var d=-1;t=r(t,l(o));var p=a(e,(function(e,n,i){return{criteria:r(t,(function(t){return t(e)})),index:++d,value:e}}));return s(p,(function(e,t){return c(e,t,n)}))}},396:e=>{e.exports=function(e){return function(t){return null==t?void 0:t[e]}}},2866:(e,t,n)=>{var r=n(2969);e.exports=function(e){return function(t){return r(t,e)}}},9676:e=>{var t=Math.ceil,n=Math.max;e.exports=function(e,r,i,o){for(var a=-1,s=n(t((r-e)/(i||1)),0),l=Array(s);s--;)l[o?s:++a]=e,e+=i;return l}},5647:(e,t,n)=>{var r=n(3279),i=n(5636),o=n(6350);e.exports=function(e,t){return o(i(e,t,r),e+"")}},8325:(e,t,n)=>{var r=n(2541),i=n(5654),o=n(3279),a=i?function(e,t){return i(e,"toString",{configurable:!0,enumerable:!1,value:r(t),writable:!0})}:o;e.exports=a},3871:e=>{e.exports=function(e,t,n){var r=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(n=n>i?i:n)<0&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var o=Array(i);++r<i;)o[r]=e[r+t];return o}},2165:(e,t,n)=>{var r=n(5652);e.exports=function(e,t){var n;return r(e,(function(e,r,i){return!(n=t(e,r,i))})),!!n}},320:e=>{e.exports=function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}},3343:e=>{e.exports=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}},8541:(e,t,n)=>{var r=n(9812),i=n(149),o=n(4052),a=n(9841),s=r?r.prototype:void 0,l=s?s.toString:void 0;e.exports=function e(t){if("string"==typeof t)return t;if(o(t))return i(t,e)+"";if(a(t))return l?l.call(t):"";var n=t+"";return"0"==n&&1/t==-1/0?"-0":n}},1141:(e,t,n)=>{var r=n(143),i=/^\s+/;e.exports=function(e){return e?e.slice(0,r(e)+1).replace(i,""):e}},7574:e=>{e.exports=function(e){return function(t){return e(t)}}},4416:(e,t,n)=>{var r=n(8902),i=n(5866),o=n(1558),a=n(8114),s=n(8182),l=n(2074);e.exports=function(e,t,n){var c=-1,u=i,h=e.length,d=!0,p=[],f=p;if(n)d=!1,u=o;else if(h>=200){var m=t?null:s(e);if(m)return l(m);d=!1,u=a,f=new r}else f=t?[]:p;e:for(;++c<h;){var g=e[c],y=t?t(g):g;if(g=n||0!==g?g:0,d&&y===y){for(var _=f.length;_--;)if(f[_]===y)continue e;t&&f.push(y),p.push(g)}else u(f,y,n)||(f!==p&&f.push(y),p.push(g))}return p}},8114:e=>{e.exports=function(e,t){return e.has(t)}},5324:(e,t,n)=>{var r=n(4052),i=n(2597),o=n(4079),a=n(1069);e.exports=function(e,t){return r(e)?e:i(e,t)?[e]:o(a(e))}},8189:(e,t,n)=>{var r=n(3871);e.exports=function(e,t,n){var i=e.length;return n=void 0===n?i:n,!t&&n>=i?e:r(e,t,n)}},6599:(e,t,n)=>{var r=n(9841);e.exports=function(e,t){if(e!==t){var n=void 0!==e,i=null===e,o=e===e,a=r(e),s=void 0!==t,l=null===t,c=t===t,u=r(t);if(!l&&!u&&!a&&e>t||a&&s&&c&&!l&&!u||i&&s&&c||!n&&c||!o)return 1;if(!i&&!a&&!u&&e<t||u&&n&&o&&!i&&!a||l&&n&&o||!s&&o||!c)return-1}return 0}},5893:(e,t,n)=>{var r=n(6599);e.exports=function(e,t,n){for(var i=-1,o=e.criteria,a=t.criteria,s=o.length,l=n.length;++i<s;){var c=r(o[i],a[i]);if(c)return i>=l?c:c*("desc"==n[i]?-1:1)}return e.index-t.index}},3440:(e,t,n)=>{var r=n(6552)["__core-js_shared__"];e.exports=r},6516:(e,t,n)=>{var r=n(6571);e.exports=function(e,t){return function(n,i){if(null==n)return n;if(!r(n))return e(n,i);for(var o=n.length,a=t?o:-1,s=Object(n);(t?a--:++a<o)&&!1!==i(s[a],a,s););return n}}},5906:e=>{e.exports=function(e){return function(t,n,r){for(var i=-1,o=Object(t),a=r(t),s=a.length;s--;){var l=a[e?s:++i];if(!1===n(o[l],l,o))break}return t}}},7676:(e,t,n)=>{var r=n(8189),i=n(6311),o=n(9115),a=n(1069);e.exports=function(e){return function(t){t=a(t);var n=i(t)?o(t):void 0,s=n?n[0]:t.charAt(0),l=n?r(n,1).join(""):t.slice(1);return s[e]()+l}}},9995:(e,t,n)=>{var r=n(9096),i=n(6571),o=n(8673);e.exports=function(e){return function(t,n,a){var s=Object(t);if(!i(t)){var l=r(n,3);t=o(t),n=function(e){return l(s[e],e,s)}}var c=e(t,n,a);return c>-1?s[l?t[c]:c]:void 0}}},3331:(e,t,n)=>{var r=n(9676),i=n(929),o=n(7303);e.exports=function(e){return function(t,n,a){return a&&"number"!=typeof a&&i(t,n,a)&&(n=a=void 0),t=o(t),void 0===n?(n=t,t=0):n=o(n),a=void 0===a?t<n?1:-1:o(a),r(t,n,a,e)}}},8182:(e,t,n)=>{var r=n(2070),i=n(5713),o=n(2074),a=r&&1/o(new r([,-0]))[1]==1/0?function(e){return new r(e)}:i;e.exports=a},5654:(e,t,n)=>{var r=n(7937),i=function(){try{var e=r(Object,"defineProperty");return e({},"",{}),e}catch(t){}}();e.exports=i},3668:(e,t,n)=>{var r=n(8902),i=n(2587),o=n(8114);e.exports=function(e,t,n,a,s,l){var c=1&n,u=e.length,h=t.length;if(u!=h&&!(c&&h>u))return!1;var d=l.get(e),p=l.get(t);if(d&&p)return d==t&&p==e;var f=-1,m=!0,g=2&n?new r:void 0;for(l.set(e,t),l.set(t,e);++f<u;){var y=e[f],_=t[f];if(a)var v=c?a(_,y,f,t,e,l):a(y,_,f,e,t,l);if(void 0!==v){if(v)continue;m=!1;break}if(g){if(!i(t,(function(e,t){if(!o(g,t)&&(y===e||s(y,e,n,a,l)))return g.push(t)}))){m=!1;break}}else if(y!==_&&!s(y,_,n,a,l)){m=!1;break}}return l.delete(e),l.delete(t),m}},9987:(e,t,n)=>{var r=n(9812),i=n(2929),o=n(3211),a=n(3668),s=n(4160),l=n(2074),c=r?r.prototype:void 0,u=c?c.valueOf:void 0;e.exports=function(e,t,n,r,c,h,d){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!h(new i(e),new i(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return o(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var p=s;case"[object Set]":var f=1&r;if(p||(p=l),e.size!=t.size&&!f)return!1;var m=d.get(e);if(m)return m==t;r|=2,d.set(e,t);var g=a(p(e),p(t),r,c,h,d);return d.delete(e),g;case"[object Symbol]":if(u)return u.call(e)==u.call(t)}return!1}},5752:(e,t,n)=>{var r=n(9395),i=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,o,a,s){var l=1&n,c=r(e),u=c.length;if(u!=r(t).length&&!l)return!1;for(var h=u;h--;){var d=c[h];if(!(l?d in t:i.call(t,d)))return!1}var p=s.get(e),f=s.get(t);if(p&&f)return p==t&&f==e;var m=!0;s.set(e,t),s.set(t,e);for(var g=l;++h<u;){var y=e[d=c[h]],_=t[d];if(o)var v=l?o(_,y,d,t,e,s):o(y,_,d,e,t,s);if(!(void 0===v?y===_||a(y,_,n,o,s):v)){m=!1;break}g||(g="constructor"==d)}if(m&&!g){var x=e.constructor,b=t.constructor;x==b||!("constructor"in e)||!("constructor"in t)||"function"==typeof x&&x instanceof x&&"function"==typeof b&&b instanceof b||(m=!1)}return s.delete(e),s.delete(t),m}},7105:(e,t,n)=>{var r="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g;e.exports=r},9395:(e,t,n)=>{var r=n(4262),i=n(9621),o=n(8673);e.exports=function(e){return r(e,o,i)}},2622:(e,t,n)=>{var r=n(705);e.exports=function(e,t){var n=e.__data__;return r(t)?n["string"==typeof t?"string":"hash"]:n.map}},3781:(e,t,n)=>{var r=n(9417),i=n(8673);e.exports=function(e){for(var t=i(e),n=t.length;n--;){var o=t[n],a=e[o];t[n]=[o,a,r(a)]}return t}},7937:(e,t,n)=>{var r=n(6954),i=n(4657);e.exports=function(e,t){var n=i(e,t);return r(n)?n:void 0}},5990:(e,t,n)=>{var r=n(3028)(Object.getPrototypeOf,Object);e.exports=r},4552:(e,t,n)=>{var r=n(9812),i=Object.prototype,o=i.hasOwnProperty,a=i.toString,s=r?r.toStringTag:void 0;e.exports=function(e){var t=o.call(e,s),n=e[s];try{e[s]=void 0;var r=!0}catch(l){}var i=a.call(e);return r&&(t?e[s]=n:delete e[s]),i}},9621:(e,t,n)=>{var r=n(7529),i=n(7828),o=Object.prototype.propertyIsEnumerable,a=Object.getOwnPropertySymbols,s=a?function(e){return null==e?[]:(e=Object(e),r(a(e),(function(t){return o.call(e,t)})))}:i;e.exports=s},6924:(e,t,n)=>{var r=n(7685),i=n(5204),o=n(5387),a=n(2070),s=n(6600),l=n(6913),c=n(6996),u="[object Map]",h="[object Promise]",d="[object Set]",p="[object WeakMap]",f="[object DataView]",m=c(r),g=c(i),y=c(o),_=c(a),v=c(s),x=l;(r&&x(new r(new ArrayBuffer(1)))!=f||i&&x(new i)!=u||o&&x(o.resolve())!=h||a&&x(new a)!=d||s&&x(new s)!=p)&&(x=function(e){var t=l(e),n="[object Object]"==t?e.constructor:void 0,r=n?c(n):"";if(r)switch(r){case m:return f;case g:return u;case y:return h;case _:return d;case v:return p}return t}),e.exports=x},4657:e=>{e.exports=function(e,t){return null==e?void 0:e[t]}},9057:(e,t,n)=>{var r=n(5324),i=n(2777),o=n(4052),a=n(9194),s=n(6173),l=n(914);e.exports=function(e,t,n){for(var c=-1,u=(t=r(t,e)).length,h=!1;++c<u;){var d=l(t[c]);if(!(h=null!=e&&n(e,d)))break;e=e[d]}return h||++c!=u?h:!!(u=null==e?0:e.length)&&s(u)&&a(d,u)&&(o(e)||i(e))}},6311:e=>{var t=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");e.exports=function(e){return t.test(e)}},7615:(e,t,n)=>{var r=n(5575);e.exports=function(){this.__data__=r?r(null):{},this.size=0}},5051:e=>{e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},2154:(e,t,n)=>{var r=n(5575),i=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(r){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return i.call(t,e)?t[e]:void 0}},8734:(e,t,n)=>{var r=n(5575),i=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return r?void 0!==t[e]:i.call(t,e)}},2662:(e,t,n)=>{var r=n(5575);e.exports=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=r&&void 0===t?"__lodash_hash_undefined__":t,this}},7116:(e,t,n)=>{var r=n(9812),i=n(2777),o=n(4052),a=r?r.isConcatSpreadable:void 0;e.exports=function(e){return o(e)||i(e)||!!(a&&e&&e[a])}},9194:e=>{var t=/^(?:0|[1-9]\d*)$/;e.exports=function(e,n){var r=typeof e;return!!(n=null==n?9007199254740991:n)&&("number"==r||"symbol"!=r&&t.test(e))&&e>-1&&e%1==0&&e<n}},929:(e,t,n)=>{var r=n(3211),i=n(6571),o=n(9194),a=n(6686);e.exports=function(e,t,n){if(!a(n))return!1;var s=typeof t;return!!("number"==s?i(n)&&o(t,n.length):"string"==s&&t in n)&&r(n[t],e)}},2597:(e,t,n)=>{var r=n(4052),i=n(9841),o=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/;e.exports=function(e,t){if(r(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!i(e))||(a.test(e)||!o.test(e)||null!=t&&e in Object(t))}},705:e=>{e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},7857:(e,t,n)=>{var r=n(3440),i=function(){var e=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();e.exports=function(e){return!!i&&i in e}},6140:e=>{var t=Object.prototype;e.exports=function(e){var n=e&&e.constructor;return e===("function"==typeof n&&n.prototype||t)}},9417:(e,t,n)=>{var r=n(6686);e.exports=function(e){return e===e&&!r(e)}},7563:e=>{e.exports=function(){this.__data__=[],this.size=0}},9935:(e,t,n)=>{var r=n(1340),i=Array.prototype.splice;e.exports=function(e){var t=this.__data__,n=r(t,e);return!(n<0)&&(n==t.length-1?t.pop():i.call(t,n,1),--this.size,!0)}},4190:(e,t,n)=>{var r=n(1340);e.exports=function(e){var t=this.__data__,n=r(t,e);return n<0?void 0:t[n][1]}},1946:(e,t,n)=>{var r=n(1340);e.exports=function(e){return r(this.__data__,e)>-1}},1714:(e,t,n)=>{var r=n(1340);e.exports=function(e,t){var n=this.__data__,i=r(n,e);return i<0?(++this.size,n.push([e,t])):n[i][1]=t,this}},7251:(e,t,n)=>{var r=n(8724),i=n(7160),o=n(5204);e.exports=function(){this.size=0,this.__data__={hash:new r,map:new(o||i),string:new r}}},7159:(e,t,n)=>{var r=n(2622);e.exports=function(e){var t=r(this,e).delete(e);return this.size-=t?1:0,t}},438:(e,t,n)=>{var r=n(2622);e.exports=function(e){return r(this,e).get(e)}},9394:(e,t,n)=>{var r=n(2622);e.exports=function(e){return r(this,e).has(e)}},6874:(e,t,n)=>{var r=n(2622);e.exports=function(e,t){var n=r(this,e),i=n.size;return n.set(e,t),this.size+=n.size==i?0:1,this}},4160:e=>{e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}},1310:e=>{e.exports=function(e,t){return function(n){return null!=n&&(n[e]===t&&(void 0!==t||e in Object(n)))}}},8259:(e,t,n)=>{var r=n(5797);e.exports=function(e){var t=r(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}},5575:(e,t,n)=>{var r=n(7937)(Object,"create");e.exports=r},1143:(e,t,n)=>{var r=n(3028)(Object.keys,Object);e.exports=r},6832:(e,t,n)=>{e=n.nmd(e);var r=n(7105),i=t&&!t.nodeType&&t,o=i&&e&&!e.nodeType&&e,a=o&&o.exports===i&&r.process,s=function(){try{var e=o&&o.require&&o.require("util").types;return e||a&&a.binding&&a.binding("util")}catch(t){}}();e.exports=s},6095:e=>{var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},3028:e=>{e.exports=function(e,t){return function(n){return e(t(n))}}},5636:(e,t,n)=>{var r=n(1170),i=Math.max;e.exports=function(e,t,n){return t=i(void 0===t?e.length-1:t,0),function(){for(var o=arguments,a=-1,s=i(o.length-t,0),l=Array(s);++a<s;)l[a]=o[t+a];a=-1;for(var c=Array(t+1);++a<t;)c[a]=o[a];return c[t]=n(l),r(e,this,c)}}},6552:(e,t,n)=>{var r=n(7105),i="object"==typeof self&&self&&self.Object===Object&&self,o=r||i||Function("return this")();e.exports=o},6179:e=>{e.exports=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},6704:e=>{e.exports=function(e){return this.__data__.has(e)}},2074:e=>{e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}},6350:(e,t,n)=>{var r=n(8325),i=n(6578)(r);e.exports=i},6578:e=>{var t=Date.now;e.exports=function(e){var n=0,r=0;return function(){var i=t(),o=16-(i-r);if(r=i,o>0){if(++n>=800)return arguments[0]}else n=0;return e.apply(void 0,arguments)}}},4545:(e,t,n)=>{var r=n(7160);e.exports=function(){this.__data__=new r,this.size=0}},793:e=>{e.exports=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}},7760:e=>{e.exports=function(e){return this.__data__.get(e)}},3892:e=>{e.exports=function(e){return this.__data__.has(e)}},6788:(e,t,n)=>{var r=n(7160),i=n(5204),o=n(4816);e.exports=function(e,t){var n=this.__data__;if(n instanceof r){var a=n.__data__;if(!i||a.length<199)return a.push([e,t]),this.size=++n.size,this;n=this.__data__=new o(a)}return n.set(e,t),this.size=n.size,this}},4020:e=>{e.exports=function(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1}},9115:(e,t,n)=>{var r=n(5967),i=n(6311),o=n(715);e.exports=function(e){return i(e)?o(e):r(e)}},4079:(e,t,n)=>{var r=n(8259),i=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,o=/\\(\\)?/g,a=r((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(i,(function(e,n,r,i){t.push(r?i.replace(o,"$1"):n||e)})),t}));e.exports=a},914:(e,t,n)=>{var r=n(9841);e.exports=function(e){if("string"==typeof e||r(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}},6996:e=>{var t=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return t.call(e)}catch(n){}try{return e+""}catch(n){}}return""}},143:e=>{var t=/\s/;e.exports=function(e){for(var n=e.length;n--&&t.test(e.charAt(n)););return n}},715:e=>{var t="\\ud800-\\udfff",n="["+t+"]",r="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",i="\\ud83c[\\udffb-\\udfff]",o="[^"+t+"]",a="(?:\\ud83c[\\udde6-\\uddff]){2}",s="[\\ud800-\\udbff][\\udc00-\\udfff]",l="(?:"+r+"|"+i+")"+"?",c="[\\ufe0e\\ufe0f]?",u=c+l+("(?:\\u200d(?:"+[o,a,s].join("|")+")"+c+l+")*"),h="(?:"+[o+r+"?",r,a,s,n].join("|")+")",d=RegExp(i+"(?="+i+")|"+h+u,"g");e.exports=function(e){return e.match(d)||[]}},2541:e=>{e.exports=function(e){return function(){return e}}},3950:(e,t,n)=>{var r=n(6686),i=n(4757),o=n(801),a=Math.max,s=Math.min;e.exports=function(e,t,n){var l,c,u,h,d,p,f=0,m=!1,g=!1,y=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function _(t){var n=l,r=c;return l=c=void 0,f=t,h=e.apply(r,n)}function v(e){var n=e-p;return void 0===p||n>=t||n<0||g&&e-f>=u}function x(){var e=i();if(v(e))return b(e);d=setTimeout(x,function(e){var n=t-(e-p);return g?s(n,u-(e-f)):n}(e))}function b(e){return d=void 0,y&&l?_(e):(l=c=void 0,h)}function w(){var e=i(),n=v(e);if(l=arguments,c=this,p=e,n){if(void 0===d)return function(e){return f=e,d=setTimeout(x,t),m?_(e):h}(p);if(g)return clearTimeout(d),d=setTimeout(x,t),_(p)}return void 0===d&&(d=setTimeout(x,t)),h}return t=o(t)||0,r(n)&&(m=!!n.leading,u=(g="maxWait"in n)?a(o(n.maxWait)||0,t):u,y="trailing"in n?!!n.trailing:y),w.cancel=function(){void 0!==d&&clearTimeout(d),f=0,l=p=c=d=void 0},w.flush=function(){return void 0===d?h:b(i())},w}},3211:e=>{e.exports=function(e,t){return e===t||e!==e&&t!==t}},7002:(e,t,n)=>{var r=n(5295),i=n(4746),o=n(9096),a=n(4052),s=n(929);e.exports=function(e,t,n){var l=a(e)?r:i;return n&&s(e,t,n)&&(t=void 0),l(e,o(t,3))}},8990:(e,t,n)=>{var r=n(9995)(n(2520));e.exports=r},2520:(e,t,n)=>{var r=n(5816),i=n(9096),o=n(9140),a=Math.max;e.exports=function(e,t,n){var s=null==e?0:e.length;if(!s)return-1;var l=null==n?0:o(n);return l<0&&(l=a(s+l,0)),r(e,i(t,3),l)}},3538:(e,t,n)=>{var r=n(755),i=n(3411);e.exports=function(e,t){return r(i(e,t),1)}},3097:(e,t,n)=>{var r=n(2969);e.exports=function(e,t,n){var i=null==e?void 0:r(e,t);return void 0===i?n:i}},3366:(e,t,n)=>{var r=n(7894),i=n(9057);e.exports=function(e,t){return null!=e&&i(e,t,r)}},3279:e=>{e.exports=function(e){return e}},2777:(e,t,n)=>{var r=n(5193),i=n(2761),o=Object.prototype,a=o.hasOwnProperty,s=o.propertyIsEnumerable,l=r(function(){return arguments}())?r:function(e){return i(e)&&a.call(e,"callee")&&!s.call(e,"callee")};e.exports=l},4052:e=>{var t=Array.isArray;e.exports=t},6571:(e,t,n)=>{var r=n(1629),i=n(6173);e.exports=function(e){return null!=e&&i(e.length)&&!r(e)}},6361:(e,t,n)=>{var r=n(6913),i=n(2761);e.exports=function(e){return!0===e||!1===e||i(e)&&"[object Boolean]"==r(e)}},4543:(e,t,n)=>{e=n.nmd(e);var r=n(6552),i=n(14),o=t&&!t.nodeType&&t,a=o&&e&&!e.nodeType&&e,s=a&&a.exports===o?r.Buffer:void 0,l=(s?s.isBuffer:void 0)||i;e.exports=l},9853:(e,t,n)=>{var r=n(6989);e.exports=function(e,t){return r(e,t)}},1629:(e,t,n)=>{var r=n(6913),i=n(6686);e.exports=function(e){if(!i(e))return!1;var t=r(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},6173:e=>{e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},5268:(e,t,n)=>{var r=n(9160);e.exports=function(e){return r(e)&&e!=+e}},9686:e=>{e.exports=function(e){return null==e}},9160:(e,t,n)=>{var r=n(6913),i=n(2761);e.exports=function(e){return"number"==typeof e||i(e)&&"[object Number]"==r(e)}},6686:e=>{e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},2761:e=>{e.exports=function(e){return null!=e&&"object"==typeof e}},2322:(e,t,n)=>{var r=n(6913),i=n(5990),o=n(2761),a=Function.prototype,s=Object.prototype,l=a.toString,c=s.hasOwnProperty,u=l.call(Object);e.exports=function(e){if(!o(e)||"[object Object]"!=r(e))return!1;var t=i(e);if(null===t)return!0;var n=c.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&l.call(n)==u}},620:(e,t,n)=>{var r=n(6913),i=n(4052),o=n(2761);e.exports=function(e){return"string"==typeof e||!i(e)&&o(e)&&"[object String]"==r(e)}},9841:(e,t,n)=>{var r=n(6913),i=n(2761);e.exports=function(e){return"symbol"==typeof e||i(e)&&"[object Symbol]"==r(e)}},1268:(e,t,n)=>{var r=n(5428),i=n(7574),o=n(6832),a=o&&o.isTypedArray,s=a?i(a):r;e.exports=s},8673:(e,t,n)=>{var r=n(3204),i=n(3713),o=n(6571);e.exports=function(e){return o(e)?r(e):i(e)}},4065:e=>{e.exports=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}},3411:(e,t,n)=>{var r=n(149),i=n(9096),o=n(8883),a=n(4052);e.exports=function(e,t){return(a(e)?r:o)(e,i(t,3))}},1733:(e,t,n)=>{var r=n(1775),i=n(4664),o=n(9096);e.exports=function(e,t){var n={};return t=o(t,3),i(e,(function(e,i,o){r(n,i,t(e,i,o))})),n}},539:(e,t,n)=>{var r=n(9742),i=n(7498),o=n(3279);e.exports=function(e){return e&&e.length?r(e,o,i):void 0}},2794:(e,t,n)=>{var r=n(9742),i=n(7498),o=n(9096);e.exports=function(e,t){return e&&e.length?r(e,o(t,2),i):void 0}},5797:(e,t,n)=>{var r=n(4816);function i(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=e.apply(this,r);return n.cache=o.set(i,a)||o,a};return n.cache=new(i.Cache||r),n}i.Cache=r,e.exports=i},6745:(e,t,n)=>{var r=n(9742),i=n(61),o=n(3279);e.exports=function(e){return e&&e.length?r(e,o,i):void 0}},9364:(e,t,n)=>{var r=n(9742),i=n(9096),o=n(61);e.exports=function(e,t){return e&&e.length?r(e,i(t,2),o):void 0}},5713:e=>{e.exports=function(){}},4757:(e,t,n)=>{var r=n(6552);e.exports=function(){return r.Date.now()}},3932:(e,t,n)=>{var r=n(396),i=n(2866),o=n(2597),a=n(914);e.exports=function(e){return o(e)?r(a(e)):i(e)}},6604:(e,t,n)=>{var r=n(3331)();e.exports=r},4597:(e,t,n)=>{var r=n(2587),i=n(9096),o=n(2165),a=n(4052),s=n(929);e.exports=function(e,t,n){var l=a(e)?r:o;return n&&s(e,t,n)&&(t=void 0),l(e,i(t,3))}},7424:(e,t,n)=>{var r=n(755),i=n(2536),o=n(5647),a=n(929),s=o((function(e,t){if(null==e)return[];var n=t.length;return n>1&&a(e,t[0],t[1])?t=[]:n>2&&a(t[0],t[1],t[2])&&(t=[t[0]]),i(e,r(t,1),[])}));e.exports=s},7828:e=>{e.exports=function(){return[]}},14:e=>{e.exports=function(){return!1}},9889:(e,t,n)=>{var r=n(3950),i=n(6686);e.exports=function(e,t,n){var o=!0,a=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return i(n)&&(o="leading"in n?!!n.leading:o,a="trailing"in n?!!n.trailing:a),r(e,t,{leading:o,maxWait:t,trailing:a})}},7303:(e,t,n)=>{var r=n(801),i=1/0;e.exports=function(e){return e?(e=r(e))===i||e===-1/0?17976931348623157e292*(e<0?-1:1):e===e?e:0:0===e?e:0}},9140:(e,t,n)=>{var r=n(7303);e.exports=function(e){var t=r(e),n=t%1;return t===t?n?t-n:t:0}},801:(e,t,n)=>{var r=n(1141),i=n(6686),o=n(9841),a=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,l=/^0o[0-7]+$/i,c=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(o(e))return NaN;if(i(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=i(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=r(e);var n=s.test(e);return n||l.test(e)?c(e.slice(2),n?2:8):a.test(e)?NaN:+e}},1069:(e,t,n)=>{var r=n(8541);e.exports=function(e){return null==e?"":r(e)}},977:(e,t,n)=>{var r=n(9096),i=n(4416);e.exports=function(e,t){return e&&e.length?i(e,r(t,2)):[]}},643:(e,t,n)=>{var r=n(7676)("toUpperCase");e.exports=r},879:function(e,t,n){var r=n(1847).default,i=n(2897).default;const o=["data"],a=["data"];e.exports=function(){"use strict";var e,t,n;function s(r,i){if(e)if(t){var o="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+e+")(sharedChunk); ("+t+")(sharedChunk); self.onerror = null;",a={};e(a),n=i(a),"undefined"!==typeof window&&window&&window.URL&&window.URL.createObjectURL&&(n.workerUrl=window.URL.createObjectURL(new Blob([o],{type:"text/javascript"})))}else t=i;else e=i}return s(["exports"],(function(e){function t(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var n,r={},o={};function a(){if(n)return o;n=1,Object.defineProperty(o,"__esModule",{value:!0}),o.setMatrixArrayType=function(e){o.ARRAY_TYPE=t=e},o.toRadian=function(e){return e*i},o.equals=function(t,n){return Math.abs(t-n)<=e*Math.max(1,Math.abs(t),Math.abs(n))},o.RANDOM=o.ARRAY_TYPE=o.EPSILON=void 0;var e=1e-6;o.EPSILON=e;var t="undefined"!=typeof Float32Array?Float32Array:Array;o.ARRAY_TYPE=t;var r=Math.random;o.RANDOM=r;var i=Math.PI/180;return Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)}),o}var s,l={};function c(){if(s)return l;function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}s=1,Object.defineProperty(l,"__esModule",{value:!0}),l.create=function(){var e=new t.ARRAY_TYPE(4);return t.ARRAY_TYPE!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e},l.clone=function(e){var n=new t.ARRAY_TYPE(4);return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n},l.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},l.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},l.fromValues=function(e,n,r,i){var o=new t.ARRAY_TYPE(4);return o[0]=e,o[1]=n,o[2]=r,o[3]=i,o},l.set=function(e,t,n,r,i){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e},l.transpose=function(e,t){if(e===t){var n=t[1];e[1]=t[2],e[2]=n}else e[0]=t[0],e[1]=t[2],e[2]=t[1],e[3]=t[3];return e},l.invert=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n*o-i*r;return a?(e[0]=o*(a=1/a),e[1]=-r*a,e[2]=-i*a,e[3]=n*a,e):null},l.adjoint=function(e,t){var n=t[0];return e[0]=t[3],e[1]=-t[1],e[2]=-t[2],e[3]=n,e},l.determinant=function(e){return e[0]*e[3]-e[2]*e[1]},l.multiply=r,l.rotate=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=Math.sin(n),l=Math.cos(n);return e[0]=r*l+o*s,e[1]=i*l+a*s,e[2]=r*-s+o*l,e[3]=i*-s+a*l,e},l.scale=function(e,t,n){var r=t[1],i=t[2],o=t[3],a=n[0],s=n[1];return e[0]=t[0]*a,e[1]=r*a,e[2]=i*s,e[3]=o*s,e},l.fromRotation=function(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=-n,e[3]=r,e},l.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e},l.str=function(e){return"mat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},l.frob=function(e){return Math.hypot(e[0],e[1],e[2],e[3])},l.LDU=function(e,t,n,r){return e[2]=r[2]/r[0],n[0]=r[0],n[1]=r[1],n[3]=r[3]-e[2]*n[1],[e,t,n]},l.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e},l.subtract=i,l.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},l.equals=function(e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=n[0],l=n[1],c=n[2],u=n[3];return Math.abs(r-s)<=t.EPSILON*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-l)<=t.EPSILON*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(o-c)<=t.EPSILON*Math.max(1,Math.abs(o),Math.abs(c))&&Math.abs(a-u)<=t.EPSILON*Math.max(1,Math.abs(a),Math.abs(u))},l.multiplyScalar=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e},l.multiplyScalarAndAdd=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e},l.sub=l.mul=void 0;var t=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==e(t)&&"function"!=typeof t)return{default:t};var r=n(void 0);if(r&&r.has(t))return r.get(t);var i={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&Object.prototype.hasOwnProperty.call(t,a)){var s=o?Object.getOwnPropertyDescriptor(t,a):null;s&&(s.get||s.set)?Object.defineProperty(i,a,s):i[a]=t[a]}return i.default=t,r&&r.set(t,i),i}(a());function n(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(n=function(e){return e?r:t})(e)}function r(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=n[0],l=n[1],c=n[2],u=n[3];return e[0]=r*s+o*l,e[1]=i*s+a*l,e[2]=r*c+o*u,e[3]=i*c+a*u,e}function i(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e}return l.mul=r,l.sub=i,l}var u,h={};function d(){if(u)return h;function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}u=1,Object.defineProperty(h,"__esModule",{value:!0}),h.create=function(){var e=new t.ARRAY_TYPE(6);return t.ARRAY_TYPE!=Float32Array&&(e[1]=0,e[2]=0,e[4]=0,e[5]=0),e[0]=1,e[3]=1,e},h.clone=function(e){var n=new t.ARRAY_TYPE(6);return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n},h.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},h.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e},h.fromValues=function(e,n,r,i,o,a){var s=new t.ARRAY_TYPE(6);return s[0]=e,s[1]=n,s[2]=r,s[3]=i,s[4]=o,s[5]=a,s},h.set=function(e,t,n,r,i,o,a){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e[4]=o,e[5]=a,e},h.invert=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],l=n*o-r*i;return l?(e[0]=o*(l=1/l),e[1]=-r*l,e[2]=-i*l,e[3]=n*l,e[4]=(i*s-o*a)*l,e[5]=(r*a-n*s)*l,e):null},h.determinant=function(e){return e[0]*e[3]-e[1]*e[2]},h.multiply=r,h.rotate=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],l=t[5],c=Math.sin(n),u=Math.cos(n);return e[0]=r*u+o*c,e[1]=i*u+a*c,e[2]=r*-c+o*u,e[3]=i*-c+a*u,e[4]=s,e[5]=l,e},h.scale=function(e,t,n){var r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],l=n[0],c=n[1];return e[0]=t[0]*l,e[1]=r*l,e[2]=i*c,e[3]=o*c,e[4]=a,e[5]=s,e},h.translate=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],l=t[5],c=n[0],u=n[1];return e[0]=r,e[1]=i,e[2]=o,e[3]=a,e[4]=r*c+o*u+s,e[5]=i*c+a*u+l,e},h.fromRotation=function(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=-n,e[3]=r,e[4]=0,e[5]=0,e},h.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e[4]=0,e[5]=0,e},h.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=t[0],e[5]=t[1],e},h.str=function(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"},h.frob=function(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],1)},h.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e},h.subtract=i,h.multiplyScalar=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e},h.multiplyScalarAndAdd=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e[4]=t[4]+n[4]*r,e[5]=t[5]+n[5]*r,e},h.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]},h.equals=function(e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],l=e[5],c=n[0],u=n[1],h=n[2],d=n[3],p=n[4],f=n[5];return Math.abs(r-c)<=t.EPSILON*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(i-u)<=t.EPSILON*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(o-h)<=t.EPSILON*Math.max(1,Math.abs(o),Math.abs(h))&&Math.abs(a-d)<=t.EPSILON*Math.max(1,Math.abs(a),Math.abs(d))&&Math.abs(s-p)<=t.EPSILON*Math.max(1,Math.abs(s),Math.abs(p))&&Math.abs(l-f)<=t.EPSILON*Math.max(1,Math.abs(l),Math.abs(f))},h.sub=h.mul=void 0;var t=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==e(t)&&"function"!=typeof t)return{default:t};var r=n(void 0);if(r&&r.has(t))return r.get(t);var i={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&Object.prototype.hasOwnProperty.call(t,a)){var s=o?Object.getOwnPropertyDescriptor(t,a):null;s&&(s.get||s.set)?Object.defineProperty(i,a,s):i[a]=t[a]}return i.default=t,r&&r.set(t,i),i}(a());function n(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(n=function(e){return e?r:t})(e)}function r(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],l=t[5],c=n[0],u=n[1],h=n[2],d=n[3],p=n[4],f=n[5];return e[0]=r*c+o*u,e[1]=i*c+a*u,e[2]=r*h+o*d,e[3]=i*h+a*d,e[4]=r*p+o*f+s,e[5]=i*p+a*f+l,e}function i(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e[4]=t[4]-n[4],e[5]=t[5]-n[5],e}return h.mul=r,h.sub=i,h}var p,f={};function m(){if(p)return f;function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}p=1,Object.defineProperty(f,"__esModule",{value:!0}),f.create=function(){var e=new t.ARRAY_TYPE(9);return t.ARRAY_TYPE!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e},f.fromMat4=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e},f.clone=function(e){var n=new t.ARRAY_TYPE(9);return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n},f.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},f.fromValues=function(e,n,r,i,o,a,s,l,c){var u=new t.ARRAY_TYPE(9);return u[0]=e,u[1]=n,u[2]=r,u[3]=i,u[4]=o,u[5]=a,u[6]=s,u[7]=l,u[8]=c,u},f.set=function(e,t,n,r,i,o,a,s,l,c){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e[4]=o,e[5]=a,e[6]=s,e[7]=l,e[8]=c,e},f.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},f.transpose=function(e,t){if(e===t){var n=t[1],r=t[2],i=t[5];e[1]=t[3],e[2]=t[6],e[3]=n,e[5]=t[7],e[6]=r,e[7]=i}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e},f.invert=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],l=t[6],c=t[7],u=t[8],h=u*a-s*c,d=-u*o+s*l,p=c*o-a*l,f=n*h+r*d+i*p;return f?(e[0]=h*(f=1/f),e[1]=(-u*r+i*c)*f,e[2]=(s*r-i*a)*f,e[3]=d*f,e[4]=(u*n-i*l)*f,e[5]=(-s*n+i*o)*f,e[6]=p*f,e[7]=(-c*n+r*l)*f,e[8]=(a*n-r*o)*f,e):null},f.adjoint=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],l=t[6],c=t[7],u=t[8];return e[0]=a*u-s*c,e[1]=i*c-r*u,e[2]=r*s-i*a,e[3]=s*l-o*u,e[4]=n*u-i*l,e[5]=i*o-n*s,e[6]=o*c-a*l,e[7]=r*l-n*c,e[8]=n*a-r*o,e},f.determinant=function(e){var t=e[3],n=e[4],r=e[5],i=e[6],o=e[7],a=e[8];return e[0]*(a*n-r*o)+e[1]*(-a*t+r*i)+e[2]*(o*t-n*i)},f.multiply=r,f.translate=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=n[0],p=n[1];return e[0]=r,e[1]=i,e[2]=o,e[3]=a,e[4]=s,e[5]=l,e[6]=d*r+p*a+c,e[7]=d*i+p*s+u,e[8]=d*o+p*l+h,e},f.rotate=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=Math.sin(n),p=Math.cos(n);return e[0]=p*r+d*a,e[1]=p*i+d*s,e[2]=p*o+d*l,e[3]=p*a-d*r,e[4]=p*s-d*i,e[5]=p*l-d*o,e[6]=c,e[7]=u,e[8]=h,e},f.scale=function(e,t,n){var r=n[0],i=n[1];return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=i*t[3],e[4]=i*t[4],e[5]=i*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},f.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e},f.fromRotation=function(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=0,e[3]=-n,e[4]=r,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},f.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},f.fromMat2d=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e},f.fromQuat=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n+n,s=r+r,l=i+i,c=n*a,u=r*a,h=r*s,d=i*a,p=i*s,f=i*l,m=o*a,g=o*s,y=o*l;return e[0]=1-h-f,e[3]=u-y,e[6]=d+g,e[1]=u+y,e[4]=1-c-f,e[7]=p-m,e[2]=d-g,e[5]=p+m,e[8]=1-c-h,e},f.normalFromMat4=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],l=t[6],c=t[7],u=t[8],h=t[9],d=t[10],p=t[11],f=t[12],m=t[13],g=t[14],y=t[15],_=n*s-r*a,v=n*l-i*a,x=n*c-o*a,b=r*l-i*s,w=r*c-o*s,S=i*c-o*l,T=u*m-h*f,E=u*g-d*f,A=u*y-p*f,M=h*g-d*m,P=h*y-p*m,k=d*y-p*g,C=_*k-v*P+x*M+b*A-w*E+S*T;return C?(e[0]=(s*k-l*P+c*M)*(C=1/C),e[1]=(l*A-a*k-c*E)*C,e[2]=(a*P-s*A+c*T)*C,e[3]=(i*P-r*k-o*M)*C,e[4]=(n*k-i*A+o*E)*C,e[5]=(r*A-n*P-o*T)*C,e[6]=(m*S-g*w+y*b)*C,e[7]=(g*x-f*S-y*v)*C,e[8]=(f*w-m*x+y*_)*C,e):null},f.projection=function(e,t,n){return e[0]=2/t,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/n,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e},f.str=function(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"},f.frob=function(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])},f.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e[6]=t[6]+n[6],e[7]=t[7]+n[7],e[8]=t[8]+n[8],e},f.subtract=i,f.multiplyScalar=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*n,e},f.multiplyScalarAndAdd=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e[4]=t[4]+n[4]*r,e[5]=t[5]+n[5]*r,e[6]=t[6]+n[6]*r,e[7]=t[7]+n[7]*r,e[8]=t[8]+n[8]*r,e},f.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]},f.equals=function(e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],l=e[5],c=e[6],u=e[7],h=e[8],d=n[0],p=n[1],f=n[2],m=n[3],g=n[4],y=n[5],_=n[6],v=n[7],x=n[8];return Math.abs(r-d)<=t.EPSILON*Math.max(1,Math.abs(r),Math.abs(d))&&Math.abs(i-p)<=t.EPSILON*Math.max(1,Math.abs(i),Math.abs(p))&&Math.abs(o-f)<=t.EPSILON*Math.max(1,Math.abs(o),Math.abs(f))&&Math.abs(a-m)<=t.EPSILON*Math.max(1,Math.abs(a),Math.abs(m))&&Math.abs(s-g)<=t.EPSILON*Math.max(1,Math.abs(s),Math.abs(g))&&Math.abs(l-y)<=t.EPSILON*Math.max(1,Math.abs(l),Math.abs(y))&&Math.abs(c-_)<=t.EPSILON*Math.max(1,Math.abs(c),Math.abs(_))&&Math.abs(u-v)<=t.EPSILON*Math.max(1,Math.abs(u),Math.abs(v))&&Math.abs(h-x)<=t.EPSILON*Math.max(1,Math.abs(h),Math.abs(x))},f.sub=f.mul=void 0;var t=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==e(t)&&"function"!=typeof t)return{default:t};var r=n(void 0);if(r&&r.has(t))return r.get(t);var i={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&Object.prototype.hasOwnProperty.call(t,a)){var s=o?Object.getOwnPropertyDescriptor(t,a):null;s&&(s.get||s.set)?Object.defineProperty(i,a,s):i[a]=t[a]}return i.default=t,r&&r.set(t,i),i}(a());function n(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(n=function(e){return e?r:t})(e)}function r(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=n[0],p=n[1],f=n[2],m=n[3],g=n[4],y=n[5],_=n[6],v=n[7],x=n[8];return e[0]=d*r+p*a+f*c,e[1]=d*i+p*s+f*u,e[2]=d*o+p*l+f*h,e[3]=m*r+g*a+y*c,e[4]=m*i+g*s+y*u,e[5]=m*o+g*l+y*h,e[6]=_*r+v*a+x*c,e[7]=_*i+v*s+x*u,e[8]=_*o+v*l+x*h,e}function i(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e[4]=t[4]-n[4],e[5]=t[5]-n[5],e[6]=t[6]-n[6],e[7]=t[7]-n[7],e[8]=t[8]-n[8],e}return f.mul=r,f.sub=i,f}var g,y={};function _(){if(g)return y;function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}g=1,Object.defineProperty(y,"__esModule",{value:!0}),y.create=function(){var e=new t.ARRAY_TYPE(16);return t.ARRAY_TYPE!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},y.clone=function(e){var n=new t.ARRAY_TYPE(16);return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n},y.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},y.fromValues=function(e,n,r,i,o,a,s,l,c,u,h,d,p,f,m,g){var y=new t.ARRAY_TYPE(16);return y[0]=e,y[1]=n,y[2]=r,y[3]=i,y[4]=o,y[5]=a,y[6]=s,y[7]=l,y[8]=c,y[9]=u,y[10]=h,y[11]=d,y[12]=p,y[13]=f,y[14]=m,y[15]=g,y},y.set=function(e,t,n,r,i,o,a,s,l,c,u,h,d,p,f,m,g){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e[4]=o,e[5]=a,e[6]=s,e[7]=l,e[8]=c,e[9]=u,e[10]=h,e[11]=d,e[12]=p,e[13]=f,e[14]=m,e[15]=g,e},y.identity=r,y.transpose=function(e,t){if(e===t){var n=t[1],r=t[2],i=t[3],o=t[6],a=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=o,e[11]=t[14],e[12]=i,e[13]=a,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e},y.invert=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],l=t[6],c=t[7],u=t[8],h=t[9],d=t[10],p=t[11],f=t[12],m=t[13],g=t[14],y=t[15],_=n*s-r*a,v=n*l-i*a,x=n*c-o*a,b=r*l-i*s,w=r*c-o*s,S=i*c-o*l,T=u*m-h*f,E=u*g-d*f,A=u*y-p*f,M=h*g-d*m,P=h*y-p*m,k=d*y-p*g,C=_*k-v*P+x*M+b*A-w*E+S*T;return C?(e[0]=(s*k-l*P+c*M)*(C=1/C),e[1]=(i*P-r*k-o*M)*C,e[2]=(m*S-g*w+y*b)*C,e[3]=(d*w-h*S-p*b)*C,e[4]=(l*A-a*k-c*E)*C,e[5]=(n*k-i*A+o*E)*C,e[6]=(g*x-f*S-y*v)*C,e[7]=(u*S-d*x+p*v)*C,e[8]=(a*P-s*A+c*T)*C,e[9]=(r*A-n*P-o*T)*C,e[10]=(f*w-m*x+y*_)*C,e[11]=(h*x-u*w-p*_)*C,e[12]=(s*E-a*M-l*T)*C,e[13]=(n*M-r*E+i*T)*C,e[14]=(m*v-f*b-g*_)*C,e[15]=(u*b-h*v+d*_)*C,e):null},y.adjoint=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],l=t[6],c=t[7],u=t[8],h=t[9],d=t[10],p=t[11],f=t[12],m=t[13],g=t[14],y=t[15];return e[0]=s*(d*y-p*g)-h*(l*y-c*g)+m*(l*p-c*d),e[1]=-(r*(d*y-p*g)-h*(i*y-o*g)+m*(i*p-o*d)),e[2]=r*(l*y-c*g)-s*(i*y-o*g)+m*(i*c-o*l),e[3]=-(r*(l*p-c*d)-s*(i*p-o*d)+h*(i*c-o*l)),e[4]=-(a*(d*y-p*g)-u*(l*y-c*g)+f*(l*p-c*d)),e[5]=n*(d*y-p*g)-u*(i*y-o*g)+f*(i*p-o*d),e[6]=-(n*(l*y-c*g)-a*(i*y-o*g)+f*(i*c-o*l)),e[7]=n*(l*p-c*d)-a*(i*p-o*d)+u*(i*c-o*l),e[8]=a*(h*y-p*m)-u*(s*y-c*m)+f*(s*p-c*h),e[9]=-(n*(h*y-p*m)-u*(r*y-o*m)+f*(r*p-o*h)),e[10]=n*(s*y-c*m)-a*(r*y-o*m)+f*(r*c-o*s),e[11]=-(n*(s*p-c*h)-a*(r*p-o*h)+u*(r*c-o*s)),e[12]=-(a*(h*g-d*m)-u*(s*g-l*m)+f*(s*d-l*h)),e[13]=n*(h*g-d*m)-u*(r*g-i*m)+f*(r*d-i*h),e[14]=-(n*(s*g-l*m)-a*(r*g-i*m)+f*(r*l-i*s)),e[15]=n*(s*d-l*h)-a*(r*d-i*h)+u*(r*l-i*s),e},y.determinant=function(e){var t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],a=e[5],s=e[6],l=e[7],c=e[8],u=e[9],h=e[10],d=e[11],p=e[12],f=e[13],m=e[14],g=e[15];return(t*a-n*o)*(h*g-d*m)-(t*s-r*o)*(u*g-d*f)+(t*l-i*o)*(u*m-h*f)+(n*s-r*a)*(c*g-d*p)-(n*l-i*a)*(c*m-h*p)+(r*l-i*s)*(c*f-u*p)},y.multiply=i,y.translate=function(e,t,n){var r,i,o,a,s,l,c,u,h,d,p,f,m=n[0],g=n[1],y=n[2];return t===e?(e[12]=t[0]*m+t[4]*g+t[8]*y+t[12],e[13]=t[1]*m+t[5]*g+t[9]*y+t[13],e[14]=t[2]*m+t[6]*g+t[10]*y+t[14],e[15]=t[3]*m+t[7]*g+t[11]*y+t[15]):(i=t[1],o=t[2],a=t[3],s=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=t[9],p=t[10],f=t[11],e[0]=r=t[0],e[1]=i,e[2]=o,e[3]=a,e[4]=s,e[5]=l,e[6]=c,e[7]=u,e[8]=h,e[9]=d,e[10]=p,e[11]=f,e[12]=r*m+s*g+h*y+t[12],e[13]=i*m+l*g+d*y+t[13],e[14]=o*m+c*g+p*y+t[14],e[15]=a*m+u*g+f*y+t[15]),e},y.scale=function(e,t,n){var r=n[0],i=n[1],o=n[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},y.rotate=function(e,n,r,i){var o,a,s,l,c,u,h,d,p,f,m,g,y,_,v,x,b,w,S,T,E,A,M,P,k=i[0],C=i[1],j=i[2],I=Math.hypot(k,C,j);return I<t.EPSILON?null:(k*=I=1/I,C*=I,j*=I,o=Math.sin(r),a=Math.cos(r),c=n[1],u=n[2],h=n[3],p=n[5],f=n[6],m=n[7],y=n[9],_=n[10],v=n[11],x=k*k*(s=1-a)+a,S=k*C*s-j*o,T=C*C*s+a,E=j*C*s+k*o,A=k*j*s+C*o,M=C*j*s-k*o,P=j*j*s+a,e[0]=(l=n[0])*x+(d=n[4])*(b=C*k*s+j*o)+(g=n[8])*(w=j*k*s-C*o),e[1]=c*x+p*b+y*w,e[2]=u*x+f*b+_*w,e[3]=h*x+m*b+v*w,e[4]=l*S+d*T+g*E,e[5]=c*S+p*T+y*E,e[6]=u*S+f*T+_*E,e[7]=h*S+m*T+v*E,e[8]=l*A+d*M+g*P,e[9]=c*A+p*M+y*P,e[10]=u*A+f*M+_*P,e[11]=h*A+m*M+v*P,n!==e&&(e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e)},y.rotateX=function(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[4],a=t[5],s=t[6],l=t[7],c=t[8],u=t[9],h=t[10],d=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=o*i+c*r,e[5]=a*i+u*r,e[6]=s*i+h*r,e[7]=l*i+d*r,e[8]=c*i-o*r,e[9]=u*i-a*r,e[10]=h*i-s*r,e[11]=d*i-l*r,e},y.rotateY=function(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[0],a=t[1],s=t[2],l=t[3],c=t[8],u=t[9],h=t[10],d=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i-c*r,e[1]=a*i-u*r,e[2]=s*i-h*r,e[3]=l*i-d*r,e[8]=o*r+c*i,e[9]=a*r+u*i,e[10]=s*r+h*i,e[11]=l*r+d*i,e},y.rotateZ=function(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[0],a=t[1],s=t[2],l=t[3],c=t[4],u=t[5],h=t[6],d=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i+c*r,e[1]=a*i+u*r,e[2]=s*i+h*r,e[3]=l*i+d*r,e[4]=c*i-o*r,e[5]=u*i-a*r,e[6]=h*i-s*r,e[7]=d*i-l*r,e},y.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e},y.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},y.fromRotation=function(e,n,r){var i,o,a,s=r[0],l=r[1],c=r[2],u=Math.hypot(s,l,c);return u<t.EPSILON?null:(s*=u=1/u,l*=u,c*=u,i=Math.sin(n),o=Math.cos(n),e[0]=s*s*(a=1-o)+o,e[1]=l*s*a+c*i,e[2]=c*s*a-l*i,e[3]=0,e[4]=s*l*a-c*i,e[5]=l*l*a+o,e[6]=c*l*a+s*i,e[7]=0,e[8]=s*c*a+l*i,e[9]=l*c*a-s*i,e[10]=c*c*a+o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)},y.fromXRotation=function(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r,e[6]=n,e[7]=0,e[8]=0,e[9]=-n,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},y.fromYRotation=function(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=0,e[2]=-n,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=n,e[9]=0,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},y.fromZRotation=function(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=0,e[3]=0,e[4]=-n,e[5]=r,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},y.fromRotationTranslation=o,y.fromQuat2=function(e,n){var r=new t.ARRAY_TYPE(3),i=-n[0],a=-n[1],s=-n[2],l=n[3],c=n[4],u=n[5],h=n[6],d=n[7],p=i*i+a*a+s*s+l*l;return p>0?(r[0]=2*(c*l+d*i+u*s-h*a)/p,r[1]=2*(u*l+d*a+h*i-c*s)/p,r[2]=2*(h*l+d*s+c*a-u*i)/p):(r[0]=2*(c*l+d*i+u*s-h*a),r[1]=2*(u*l+d*a+h*i-c*s),r[2]=2*(h*l+d*s+c*a-u*i)),o(e,n,r),e},y.getTranslation=function(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e},y.getScaling=s,y.getRotation=function(e,n){var r=new t.ARRAY_TYPE(3);s(r,n);var i=1/r[0],o=1/r[1],a=1/r[2],l=n[0]*i,c=n[1]*o,u=n[2]*a,h=n[4]*i,d=n[5]*o,p=n[6]*a,f=n[8]*i,m=n[9]*o,g=n[10]*a,y=l+d+g,_=0;return y>0?(_=2*Math.sqrt(y+1),e[3]=.25*_,e[0]=(p-m)/_,e[1]=(f-u)/_,e[2]=(c-h)/_):l>d&&l>g?(_=2*Math.sqrt(1+l-d-g),e[3]=(p-m)/_,e[0]=.25*_,e[1]=(c+h)/_,e[2]=(f+u)/_):d>g?(_=2*Math.sqrt(1+d-l-g),e[3]=(f-u)/_,e[0]=(c+h)/_,e[1]=.25*_,e[2]=(p+m)/_):(_=2*Math.sqrt(1+g-l-d),e[3]=(c-h)/_,e[0]=(f+u)/_,e[1]=(p+m)/_,e[2]=.25*_),e},y.fromRotationTranslationScale=function(e,t,n,r){var i=t[0],o=t[1],a=t[2],s=t[3],l=i+i,c=o+o,u=a+a,h=i*l,d=i*c,p=i*u,f=o*c,m=o*u,g=a*u,y=s*l,_=s*c,v=s*u,x=r[0],b=r[1],w=r[2];return e[0]=(1-(f+g))*x,e[1]=(d+v)*x,e[2]=(p-_)*x,e[3]=0,e[4]=(d-v)*b,e[5]=(1-(h+g))*b,e[6]=(m+y)*b,e[7]=0,e[8]=(p+_)*w,e[9]=(m-y)*w,e[10]=(1-(h+f))*w,e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e},y.fromRotationTranslationScaleOrigin=function(e,t,n,r,i){var o=t[0],a=t[1],s=t[2],l=t[3],c=o+o,u=a+a,h=s+s,d=o*c,p=o*u,f=o*h,m=a*u,g=a*h,y=s*h,_=l*c,v=l*u,x=l*h,b=r[0],w=r[1],S=r[2],T=i[0],E=i[1],A=i[2],M=(1-(m+y))*b,P=(p+x)*b,k=(f-v)*b,C=(p-x)*w,j=(1-(d+y))*w,I=(g+_)*w,O=(f+v)*S,N=(g-_)*S,D=(1-(d+m))*S;return e[0]=M,e[1]=P,e[2]=k,e[3]=0,e[4]=C,e[5]=j,e[6]=I,e[7]=0,e[8]=O,e[9]=N,e[10]=D,e[11]=0,e[12]=n[0]+T-(M*T+C*E+O*A),e[13]=n[1]+E-(P*T+j*E+N*A),e[14]=n[2]+A-(k*T+I*E+D*A),e[15]=1,e},y.fromQuat=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n+n,s=r+r,l=i+i,c=n*a,u=r*a,h=r*s,d=i*a,p=i*s,f=i*l,m=o*a,g=o*s,y=o*l;return e[0]=1-h-f,e[1]=u+y,e[2]=d-g,e[3]=0,e[4]=u-y,e[5]=1-c-f,e[6]=p+m,e[7]=0,e[8]=d+g,e[9]=p-m,e[10]=1-c-h,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},y.frustum=function(e,t,n,r,i,o,a){var s=1/(n-t),l=1/(i-r),c=1/(o-a);return e[0]=2*o*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*o*l,e[6]=0,e[7]=0,e[8]=(n+t)*s,e[9]=(i+r)*l,e[10]=(a+o)*c,e[11]=-1,e[12]=0,e[13]=0,e[14]=a*o*2*c,e[15]=0,e},y.perspectiveNO=l,y.perspectiveZO=function(e,t,n,r,i){var o,a=1/Math.tan(t/2);return e[0]=a/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=i&&i!==1/0?(e[10]=i*(o=1/(r-i)),e[14]=i*r*o):(e[10]=-1,e[14]=-r),e},y.perspectiveFromFieldOfView=function(e,t,n,r){var i=Math.tan(t.upDegrees*Math.PI/180),o=Math.tan(t.downDegrees*Math.PI/180),a=Math.tan(t.leftDegrees*Math.PI/180),s=Math.tan(t.rightDegrees*Math.PI/180),l=2/(a+s),c=2/(i+o);return e[0]=l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=c,e[6]=0,e[7]=0,e[8]=-(a-s)*l*.5,e[9]=(i-o)*c*.5,e[10]=r/(n-r),e[11]=-1,e[12]=0,e[13]=0,e[14]=r*n/(n-r),e[15]=0,e},y.orthoNO=c,y.orthoZO=function(e,t,n,r,i,o,a){var s=1/(t-n),l=1/(r-i),c=1/(o-a);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=c,e[11]=0,e[12]=(t+n)*s,e[13]=(i+r)*l,e[14]=o*c,e[15]=1,e},y.lookAt=function(e,n,i,o){var a,s,l,c,u,h,d,p,f,m,g=n[0],y=n[1],_=n[2],v=o[0],x=o[1],b=o[2],w=i[0],S=i[1],T=i[2];return Math.abs(g-w)<t.EPSILON&&Math.abs(y-S)<t.EPSILON&&Math.abs(_-T)<t.EPSILON?r(e):(d=g-w,p=y-S,f=_-T,a=x*(f*=m=1/Math.hypot(d,p,f))-b*(p*=m),s=b*(d*=m)-v*f,l=v*p-x*d,(m=Math.hypot(a,s,l))?(a*=m=1/m,s*=m,l*=m):(a=0,s=0,l=0),c=p*l-f*s,u=f*a-d*l,h=d*s-p*a,(m=Math.hypot(c,u,h))?(c*=m=1/m,u*=m,h*=m):(c=0,u=0,h=0),e[0]=a,e[1]=c,e[2]=d,e[3]=0,e[4]=s,e[5]=u,e[6]=p,e[7]=0,e[8]=l,e[9]=h,e[10]=f,e[11]=0,e[12]=-(a*g+s*y+l*_),e[13]=-(c*g+u*y+h*_),e[14]=-(d*g+p*y+f*_),e[15]=1,e)},y.targetTo=function(e,t,n,r){var i=t[0],o=t[1],a=t[2],s=r[0],l=r[1],c=r[2],u=i-n[0],h=o-n[1],d=a-n[2],p=u*u+h*h+d*d;p>0&&(u*=p=1/Math.sqrt(p),h*=p,d*=p);var f=l*d-c*h,m=c*u-s*d,g=s*h-l*u;return(p=f*f+m*m+g*g)>0&&(f*=p=1/Math.sqrt(p),m*=p,g*=p),e[0]=f,e[1]=m,e[2]=g,e[3]=0,e[4]=h*g-d*m,e[5]=d*f-u*g,e[6]=u*m-h*f,e[7]=0,e[8]=u,e[9]=h,e[10]=d,e[11]=0,e[12]=i,e[13]=o,e[14]=a,e[15]=1,e},y.str=function(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"},y.frob=function(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])},y.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e[6]=t[6]+n[6],e[7]=t[7]+n[7],e[8]=t[8]+n[8],e[9]=t[9]+n[9],e[10]=t[10]+n[10],e[11]=t[11]+n[11],e[12]=t[12]+n[12],e[13]=t[13]+n[13],e[14]=t[14]+n[14],e[15]=t[15]+n[15],e},y.subtract=u,y.multiplyScalar=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*n,e[9]=t[9]*n,e[10]=t[10]*n,e[11]=t[11]*n,e[12]=t[12]*n,e[13]=t[13]*n,e[14]=t[14]*n,e[15]=t[15]*n,e},y.multiplyScalarAndAdd=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e[4]=t[4]+n[4]*r,e[5]=t[5]+n[5]*r,e[6]=t[6]+n[6]*r,e[7]=t[7]+n[7]*r,e[8]=t[8]+n[8]*r,e[9]=t[9]+n[9]*r,e[10]=t[10]+n[10]*r,e[11]=t[11]+n[11]*r,e[12]=t[12]+n[12]*r,e[13]=t[13]+n[13]*r,e[14]=t[14]+n[14]*r,e[15]=t[15]+n[15]*r,e},y.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]},y.equals=function(e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],l=e[5],c=e[6],u=e[7],h=e[8],d=e[9],p=e[10],f=e[11],m=e[12],g=e[13],y=e[14],_=e[15],v=n[0],x=n[1],b=n[2],w=n[3],S=n[4],T=n[5],E=n[6],A=n[7],M=n[8],P=n[9],k=n[10],C=n[11],j=n[12],I=n[13],O=n[14],N=n[15];return Math.abs(r-v)<=t.EPSILON*Math.max(1,Math.abs(r),Math.abs(v))&&Math.abs(i-x)<=t.EPSILON*Math.max(1,Math.abs(i),Math.abs(x))&&Math.abs(o-b)<=t.EPSILON*Math.max(1,Math.abs(o),Math.abs(b))&&Math.abs(a-w)<=t.EPSILON*Math.max(1,Math.abs(a),Math.abs(w))&&Math.abs(s-S)<=t.EPSILON*Math.max(1,Math.abs(s),Math.abs(S))&&Math.abs(l-T)<=t.EPSILON*Math.max(1,Math.abs(l),Math.abs(T))&&Math.abs(c-E)<=t.EPSILON*Math.max(1,Math.abs(c),Math.abs(E))&&Math.abs(u-A)<=t.EPSILON*Math.max(1,Math.abs(u),Math.abs(A))&&Math.abs(h-M)<=t.EPSILON*Math.max(1,Math.abs(h),Math.abs(M))&&Math.abs(d-P)<=t.EPSILON*Math.max(1,Math.abs(d),Math.abs(P))&&Math.abs(p-k)<=t.EPSILON*Math.max(1,Math.abs(p),Math.abs(k))&&Math.abs(f-C)<=t.EPSILON*Math.max(1,Math.abs(f),Math.abs(C))&&Math.abs(m-j)<=t.EPSILON*Math.max(1,Math.abs(m),Math.abs(j))&&Math.abs(g-I)<=t.EPSILON*Math.max(1,Math.abs(g),Math.abs(I))&&Math.abs(y-O)<=t.EPSILON*Math.max(1,Math.abs(y),Math.abs(O))&&Math.abs(_-N)<=t.EPSILON*Math.max(1,Math.abs(_),Math.abs(N))},y.sub=y.mul=y.ortho=y.perspective=void 0;var t=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==e(t)&&"function"!=typeof t)return{default:t};var r=n(void 0);if(r&&r.has(t))return r.get(t);var i={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&Object.prototype.hasOwnProperty.call(t,a)){var s=o?Object.getOwnPropertyDescriptor(t,a):null;s&&(s.get||s.set)?Object.defineProperty(i,a,s):i[a]=t[a]}return i.default=t,r&&r.set(t,i),i}(a());function n(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(n=function(e){return e?r:t})(e)}function r(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function i(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=t[9],p=t[10],f=t[11],m=t[12],g=t[13],y=t[14],_=t[15],v=n[0],x=n[1],b=n[2],w=n[3];return e[0]=v*r+x*s+b*h+w*m,e[1]=v*i+x*l+b*d+w*g,e[2]=v*o+x*c+b*p+w*y,e[3]=v*a+x*u+b*f+w*_,e[4]=(v=n[4])*r+(x=n[5])*s+(b=n[6])*h+(w=n[7])*m,e[5]=v*i+x*l+b*d+w*g,e[6]=v*o+x*c+b*p+w*y,e[7]=v*a+x*u+b*f+w*_,e[8]=(v=n[8])*r+(x=n[9])*s+(b=n[10])*h+(w=n[11])*m,e[9]=v*i+x*l+b*d+w*g,e[10]=v*o+x*c+b*p+w*y,e[11]=v*a+x*u+b*f+w*_,e[12]=(v=n[12])*r+(x=n[13])*s+(b=n[14])*h+(w=n[15])*m,e[13]=v*i+x*l+b*d+w*g,e[14]=v*o+x*c+b*p+w*y,e[15]=v*a+x*u+b*f+w*_,e}function o(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=r+r,l=i+i,c=o+o,u=r*s,h=r*l,d=r*c,p=i*l,f=i*c,m=o*c,g=a*s,y=a*l,_=a*c;return e[0]=1-(p+m),e[1]=h+_,e[2]=d-y,e[3]=0,e[4]=h-_,e[5]=1-(u+m),e[6]=f+g,e[7]=0,e[8]=d+y,e[9]=f-g,e[10]=1-(u+p),e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}function s(e,t){var n=t[4],r=t[5],i=t[6],o=t[8],a=t[9],s=t[10];return e[0]=Math.hypot(t[0],t[1],t[2]),e[1]=Math.hypot(n,r,i),e[2]=Math.hypot(o,a,s),e}function l(e,t,n,r,i){var o,a=1/Math.tan(t/2);return e[0]=a/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=i&&i!==1/0?(e[10]=(i+r)*(o=1/(r-i)),e[14]=2*i*r*o):(e[10]=-1,e[14]=-2*r),e}function c(e,t,n,r,i,o,a){var s=1/(t-n),l=1/(r-i),c=1/(o-a);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+n)*s,e[13]=(i+r)*l,e[14]=(a+o)*c,e[15]=1,e}function u(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e[4]=t[4]-n[4],e[5]=t[5]-n[5],e[6]=t[6]-n[6],e[7]=t[7]-n[7],e[8]=t[8]-n[8],e[9]=t[9]-n[9],e[10]=t[10]-n[10],e[11]=t[11]-n[11],e[12]=t[12]-n[12],e[13]=t[13]-n[13],e[14]=t[14]-n[14],e[15]=t[15]-n[15],e}return y.perspective=l,y.ortho=c,y.mul=i,y.sub=u,y}var v,x={},b={};function w(){if(v)return b;function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}v=1,Object.defineProperty(b,"__esModule",{value:!0}),b.create=r,b.clone=function(e){var n=new t.ARRAY_TYPE(3);return n[0]=e[0],n[1]=e[1],n[2]=e[2],n},b.length=i,b.fromValues=function(e,n,r){var i=new t.ARRAY_TYPE(3);return i[0]=e,i[1]=n,i[2]=r,i},b.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},b.set=function(e,t,n,r){return e[0]=t,e[1]=n,e[2]=r,e},b.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e},b.subtract=o,b.multiply=s,b.divide=l,b.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e},b.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e},b.min=function(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e},b.max=function(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e},b.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e},b.scale=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e},b.scaleAndAdd=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e},b.distance=c,b.squaredDistance=u,b.squaredLength=h,b.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e},b.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e},b.normalize=function(e,t){var n=t[0],r=t[1],i=t[2],o=n*n+r*r+i*i;return o>0&&(o=1/Math.sqrt(o)),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o,e},b.dot=d,b.cross=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=n[0],s=n[1],l=n[2];return e[0]=i*l-o*s,e[1]=o*a-r*l,e[2]=r*s-i*a,e},b.lerp=function(e,t,n,r){var i=t[0],o=t[1],a=t[2];return e[0]=i+r*(n[0]-i),e[1]=o+r*(n[1]-o),e[2]=a+r*(n[2]-a),e},b.hermite=function(e,t,n,r,i,o){var a=o*o,s=a*(2*o-3)+1,l=a*(o-2)+o,c=a*(o-1),u=a*(3-2*o);return e[0]=t[0]*s+n[0]*l+r[0]*c+i[0]*u,e[1]=t[1]*s+n[1]*l+r[1]*c+i[1]*u,e[2]=t[2]*s+n[2]*l+r[2]*c+i[2]*u,e},b.bezier=function(e,t,n,r,i,o){var a=1-o,s=a*a,l=o*o,c=s*a,u=3*o*s,h=3*l*a,d=l*o;return e[0]=t[0]*c+n[0]*u+r[0]*h+i[0]*d,e[1]=t[1]*c+n[1]*u+r[1]*h+i[1]*d,e[2]=t[2]*c+n[2]*u+r[2]*h+i[2]*d,e},b.random=function(e,n){n=n||1;var r=2*t.RANDOM()*Math.PI,i=2*t.RANDOM()-1,o=Math.sqrt(1-i*i)*n;return e[0]=Math.cos(r)*o,e[1]=Math.sin(r)*o,e[2]=i*n,e},b.transformMat4=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=n[3]*r+n[7]*i+n[11]*o+n[15];return e[0]=(n[0]*r+n[4]*i+n[8]*o+n[12])/(a=a||1),e[1]=(n[1]*r+n[5]*i+n[9]*o+n[13])/a,e[2]=(n[2]*r+n[6]*i+n[10]*o+n[14])/a,e},b.transformMat3=function(e,t,n){var r=t[0],i=t[1],o=t[2];return e[0]=r*n[0]+i*n[3]+o*n[6],e[1]=r*n[1]+i*n[4]+o*n[7],e[2]=r*n[2]+i*n[5]+o*n[8],e},b.transformQuat=function(e,t,n){var r=n[0],i=n[1],o=n[2],a=t[0],s=t[1],l=t[2],c=i*l-o*s,u=o*a-r*l,h=r*s-i*a,d=i*h-o*u,p=o*c-r*h,f=r*u-i*c,m=2*n[3];return u*=m,h*=m,p*=2,f*=2,e[0]=a+(c*=m)+(d*=2),e[1]=s+u+p,e[2]=l+h+f,e},b.rotateX=function(e,t,n,r){var i=[],o=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],o[0]=i[0],o[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),o[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),e[0]=o[0]+n[0],e[1]=o[1]+n[1],e[2]=o[2]+n[2],e},b.rotateY=function(e,t,n,r){var i=[],o=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],o[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),o[1]=i[1],o[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),e[0]=o[0]+n[0],e[1]=o[1]+n[1],e[2]=o[2]+n[2],e},b.rotateZ=function(e,t,n,r){var i=[],o=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],o[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),o[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),o[2]=i[2],e[0]=o[0]+n[0],e[1]=o[1]+n[1],e[2]=o[2]+n[2],e},b.angle=function(e,t){var n=e[0],r=e[1],i=e[2],o=t[0],a=t[1],s=t[2],l=Math.sqrt(n*n+r*r+i*i)*Math.sqrt(o*o+a*a+s*s),c=l&&d(e,t)/l;return Math.acos(Math.min(Math.max(c,-1),1))},b.zero=function(e){return e[0]=0,e[1]=0,e[2]=0,e},b.str=function(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"},b.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]},b.equals=function(e,n){var r=e[0],i=e[1],o=e[2],a=n[0],s=n[1],l=n[2];return Math.abs(r-a)<=t.EPSILON*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(i-s)<=t.EPSILON*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(o-l)<=t.EPSILON*Math.max(1,Math.abs(o),Math.abs(l))},b.forEach=b.sqrLen=b.len=b.sqrDist=b.dist=b.div=b.mul=b.sub=void 0;var t=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==e(t)&&"function"!=typeof t)return{default:t};var r=n(void 0);if(r&&r.has(t))return r.get(t);var i={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&Object.prototype.hasOwnProperty.call(t,a)){var s=o?Object.getOwnPropertyDescriptor(t,a):null;s&&(s.get||s.set)?Object.defineProperty(i,a,s):i[a]=t[a]}return i.default=t,r&&r.set(t,i),i}(a());function n(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(n=function(e){return e?r:t})(e)}function r(){var e=new t.ARRAY_TYPE(3);return t.ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function i(e){return Math.hypot(e[0],e[1],e[2])}function o(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e}function s(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e}function l(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e}function c(e,t){return Math.hypot(t[0]-e[0],t[1]-e[1],t[2]-e[2])}function u(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return n*n+r*r+i*i}function h(e){var t=e[0],n=e[1],r=e[2];return t*t+n*n+r*r}function d(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}b.sub=o,b.mul=s,b.div=l,b.dist=c,b.sqrDist=u,b.len=i,b.sqrLen=h;var p,f=(p=r(),function(e,t,n,r,i,o){var a,s;for(t||(t=3),n||(n=0),s=r?Math.min(r*t+n,e.length):e.length,a=n;a<s;a+=t)p[0]=e[a],p[1]=e[a+1],p[2]=e[a+2],i(p,p,o),e[a]=p[0],e[a+1]=p[1],e[a+2]=p[2];return e});return b.forEach=f,b}var S,T,E={};function A(){if(S)return E;function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}S=1,Object.defineProperty(E,"__esModule",{value:!0}),E.create=r,E.clone=function(e){var n=new t.ARRAY_TYPE(4);return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n},E.fromValues=function(e,n,r,i){var o=new t.ARRAY_TYPE(4);return o[0]=e,o[1]=n,o[2]=r,o[3]=i,o},E.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},E.set=function(e,t,n,r,i){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e},E.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e},E.subtract=i,E.multiply=o,E.divide=s,E.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e},E.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e},E.min=function(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e[3]=Math.min(t[3],n[3]),e},E.max=function(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e[3]=Math.max(t[3],n[3]),e},E.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e},E.scale=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e},E.scaleAndAdd=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e},E.distance=l,E.squaredDistance=c,E.length=u,E.squaredLength=h,E.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e},E.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e},E.normalize=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n*n+r*r+i*i+o*o;return a>0&&(a=1/Math.sqrt(a)),e[0]=n*a,e[1]=r*a,e[2]=i*a,e[3]=o*a,e},E.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},E.cross=function(e,t,n,r){var i=n[0]*r[1]-n[1]*r[0],o=n[0]*r[2]-n[2]*r[0],a=n[0]*r[3]-n[3]*r[0],s=n[1]*r[2]-n[2]*r[1],l=n[1]*r[3]-n[3]*r[1],c=n[2]*r[3]-n[3]*r[2],u=t[0],h=t[1],d=t[2],p=t[3];return e[0]=h*c-d*l+p*s,e[1]=-u*c+d*a-p*o,e[2]=u*l-h*a+p*i,e[3]=-u*s+h*o-d*i,e},E.lerp=function(e,t,n,r){var i=t[0],o=t[1],a=t[2],s=t[3];return e[0]=i+r*(n[0]-i),e[1]=o+r*(n[1]-o),e[2]=a+r*(n[2]-a),e[3]=s+r*(n[3]-s),e},E.random=function(e,n){var r,i,o,a,s,l;n=n||1;do{s=(r=2*t.RANDOM()-1)*r+(i=2*t.RANDOM()-1)*i}while(s>=1);do{l=(o=2*t.RANDOM()-1)*o+(a=2*t.RANDOM()-1)*a}while(l>=1);var c=Math.sqrt((1-s)/l);return e[0]=n*r,e[1]=n*i,e[2]=n*o*c,e[3]=n*a*c,e},E.transformMat4=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3];return e[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*a,e[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*a,e[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*a,e[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*a,e},E.transformQuat=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=n[0],s=n[1],l=n[2],c=n[3],u=c*r+s*o-l*i,h=c*i+l*r-a*o,d=c*o+a*i-s*r,p=-a*r-s*i-l*o;return e[0]=u*c+p*-a+h*-l-d*-s,e[1]=h*c+p*-s+d*-a-u*-l,e[2]=d*c+p*-l+u*-s-h*-a,e[3]=t[3],e},E.zero=function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e},E.str=function(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},E.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},E.equals=function(e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=n[0],l=n[1],c=n[2],u=n[3];return Math.abs(r-s)<=t.EPSILON*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-l)<=t.EPSILON*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(o-c)<=t.EPSILON*Math.max(1,Math.abs(o),Math.abs(c))&&Math.abs(a-u)<=t.EPSILON*Math.max(1,Math.abs(a),Math.abs(u))},E.forEach=E.sqrLen=E.len=E.sqrDist=E.dist=E.div=E.mul=E.sub=void 0;var t=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==e(t)&&"function"!=typeof t)return{default:t};var r=n(void 0);if(r&&r.has(t))return r.get(t);var i={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&Object.prototype.hasOwnProperty.call(t,a)){var s=o?Object.getOwnPropertyDescriptor(t,a):null;s&&(s.get||s.set)?Object.defineProperty(i,a,s):i[a]=t[a]}return i.default=t,r&&r.set(t,i),i}(a());function n(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(n=function(e){return e?r:t})(e)}function r(){var e=new t.ARRAY_TYPE(4);return t.ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function i(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e}function o(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e[3]=t[3]*n[3],e}function s(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e[3]=t[3]/n[3],e}function l(e,t){return Math.hypot(t[0]-e[0],t[1]-e[1],t[2]-e[2],t[3]-e[3])}function c(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2],o=t[3]-e[3];return n*n+r*r+i*i+o*o}function u(e){return Math.hypot(e[0],e[1],e[2],e[3])}function h(e){var t=e[0],n=e[1],r=e[2],i=e[3];return t*t+n*n+r*r+i*i}E.sub=i,E.mul=o,E.div=s,E.dist=l,E.sqrDist=c,E.len=u,E.sqrLen=h;var d,p=(d=r(),function(e,t,n,r,i,o){var a,s;for(t||(t=4),n||(n=0),s=r?Math.min(r*t+n,e.length):e.length,a=n;a<s;a+=t)d[0]=e[a],d[1]=e[a+1],d[2]=e[a+2],d[3]=e[a+3],i(d,d,o),e[a]=d[0],e[a+1]=d[1],e[a+2]=d[2],e[a+3]=d[3];return e});return E.forEach=p,E}function M(){if(T)return x;function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}T=1,Object.defineProperty(x,"__esModule",{value:!0}),x.create=l,x.identity=function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},x.setAxisAngle=c,x.getAxisAngle=function(e,n){var r=2*Math.acos(n[3]),i=Math.sin(r/2);return i>t.EPSILON?(e[0]=n[0]/i,e[1]=n[1]/i,e[2]=n[2]/i):(e[0]=1,e[1]=0,e[2]=0),r},x.getAngle=function(e,t){var n=y(e,t);return Math.acos(2*n*n-1)},x.multiply=u,x.rotateX=function(e,t,n){n*=.5;var r=t[0],i=t[1],o=t[2],a=t[3],s=Math.sin(n),l=Math.cos(n);return e[0]=r*l+a*s,e[1]=i*l+o*s,e[2]=o*l-i*s,e[3]=a*l-r*s,e},x.rotateY=function(e,t,n){n*=.5;var r=t[0],i=t[1],o=t[2],a=t[3],s=Math.sin(n),l=Math.cos(n);return e[0]=r*l-o*s,e[1]=i*l+a*s,e[2]=o*l+r*s,e[3]=a*l-i*s,e},x.rotateZ=function(e,t,n){n*=.5;var r=t[0],i=t[1],o=t[2],a=t[3],s=Math.sin(n),l=Math.cos(n);return e[0]=r*l+i*s,e[1]=i*l-r*s,e[2]=o*l+a*s,e[3]=a*l-o*s,e},x.calculateW=function(e,t){var n=t[0],r=t[1],i=t[2];return e[0]=n,e[1]=r,e[2]=i,e[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),e},x.exp=h,x.ln=d,x.pow=function(e,t,n){return d(e,t),g(e,e,n),h(e,e),e},x.slerp=p,x.random=function(e){var n=t.RANDOM(),r=t.RANDOM(),i=t.RANDOM(),o=Math.sqrt(1-n),a=Math.sqrt(n);return e[0]=o*Math.sin(2*Math.PI*r),e[1]=o*Math.cos(2*Math.PI*r),e[2]=a*Math.sin(2*Math.PI*i),e[3]=a*Math.cos(2*Math.PI*i),e},x.invert=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n*n+r*r+i*i+o*o,s=a?1/a:0;return e[0]=-n*s,e[1]=-r*s,e[2]=-i*s,e[3]=o*s,e},x.conjugate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e},x.fromMat3=f,x.fromEuler=function(e,t,n,r){var i=.5*Math.PI/180;t*=i,n*=i,r*=i;var o=Math.sin(t),a=Math.cos(t),s=Math.sin(n),l=Math.cos(n),c=Math.sin(r),u=Math.cos(r);return e[0]=o*l*u-a*s*c,e[1]=a*s*u+o*l*c,e[2]=a*l*c-o*s*u,e[3]=a*l*u+o*s*c,e},x.str=function(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},x.setAxes=x.sqlerp=x.rotationTo=x.equals=x.exactEquals=x.normalize=x.sqrLen=x.squaredLength=x.len=x.length=x.lerp=x.dot=x.scale=x.mul=x.add=x.set=x.copy=x.fromValues=x.clone=void 0;var t=s(a()),n=s(m()),r=s(w()),i=s(A());function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(o=function(e){return e?n:t})(e)}function s(t,n){if(t&&t.__esModule)return t;if(null===t||"object"!==e(t)&&"function"!=typeof t)return{default:t};var r=o(n);if(r&&r.has(t))return r.get(t);var i={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if("default"!==s&&Object.prototype.hasOwnProperty.call(t,s)){var l=a?Object.getOwnPropertyDescriptor(t,s):null;l&&(l.get||l.set)?Object.defineProperty(i,s,l):i[s]=t[s]}return i.default=t,r&&r.set(t,i),i}function l(){var e=new t.ARRAY_TYPE(4);return t.ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function c(e,t,n){n*=.5;var r=Math.sin(n);return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=Math.cos(n),e}function u(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=n[0],l=n[1],c=n[2],u=n[3];return e[0]=r*u+a*s+i*c-o*l,e[1]=i*u+a*l+o*s-r*c,e[2]=o*u+a*c+r*l-i*s,e[3]=a*u-r*s-i*l-o*c,e}function h(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=Math.sqrt(n*n+r*r+i*i),s=Math.exp(o),l=a>0?s*Math.sin(a)/a:0;return e[0]=n*l,e[1]=r*l,e[2]=i*l,e[3]=s*Math.cos(a),e}function d(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=Math.sqrt(n*n+r*r+i*i),s=a>0?Math.atan2(a,o)/a:0;return e[0]=n*s,e[1]=r*s,e[2]=i*s,e[3]=.5*Math.log(n*n+r*r+i*i+o*o),e}function p(e,n,r,i){var o,a,s,l,c,u=n[0],h=n[1],d=n[2],p=n[3],f=r[0],m=r[1],g=r[2],y=r[3];return(a=u*f+h*m+d*g+p*y)<0&&(a=-a,f=-f,m=-m,g=-g,y=-y),1-a>t.EPSILON?(o=Math.acos(a),s=Math.sin(o),l=Math.sin((1-i)*o)/s,c=Math.sin(i*o)/s):(l=1-i,c=i),e[0]=l*u+c*f,e[1]=l*h+c*m,e[2]=l*d+c*g,e[3]=l*p+c*y,e}function f(e,t){var n,r=t[0]+t[4]+t[8];if(r>0)n=Math.sqrt(r+1),e[3]=.5*n,e[0]=(t[5]-t[7])*(n=.5/n),e[1]=(t[6]-t[2])*n,e[2]=(t[1]-t[3])*n;else{var i=0;t[4]>t[0]&&(i=1),t[8]>t[3*i+i]&&(i=2);var o=(i+1)%3,a=(i+2)%3;n=Math.sqrt(t[3*i+i]-t[3*o+o]-t[3*a+a]+1),e[i]=.5*n,e[3]=(t[3*o+a]-t[3*a+o])*(n=.5/n),e[o]=(t[3*o+i]+t[3*i+o])*n,e[a]=(t[3*a+i]+t[3*i+a])*n}return e}x.clone=i.clone,x.fromValues=i.fromValues,x.copy=i.copy,x.set=i.set,x.add=i.add,x.mul=u;var g=i.scale;x.scale=g;var y=i.dot;x.dot=y,x.lerp=i.lerp;var _=i.length;x.length=_,x.len=_;var v=i.squaredLength;x.squaredLength=v,x.sqrLen=v;var b=i.normalize;x.normalize=b,x.exactEquals=i.exactEquals,x.equals=i.equals;var S,E,M,P=(S=r.create(),E=r.fromValues(1,0,0),M=r.fromValues(0,1,0),function(e,t,n){var i=r.dot(t,n);return i<-.999999?(r.cross(S,E,t),r.len(S)<1e-6&&r.cross(S,M,t),r.normalize(S,S),c(e,S,Math.PI),e):i>.999999?(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e):(r.cross(S,t,n),e[0]=S[0],e[1]=S[1],e[2]=S[2],e[3]=1+i,b(e,e))});x.rotationTo=P;var k,C,j=(k=l(),C=l(),function(e,t,n,r,i,o){return p(k,t,i,o),p(C,n,r,o),p(e,k,C,2*o*(1-o)),e});x.sqlerp=j;var I,O=(I=n.create(),function(e,t,n,r){return I[0]=n[0],I[3]=n[1],I[6]=n[2],I[1]=r[0],I[4]=r[1],I[7]=r[2],I[2]=-t[0],I[5]=-t[1],I[8]=-t[2],b(e,f(e,I))});return x.setAxes=O,x}var P,k={};function C(){if(P)return k;function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}P=1,Object.defineProperty(k,"__esModule",{value:!0}),k.create=function(){var e=new t.ARRAY_TYPE(8);return t.ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0),e[3]=1,e},k.clone=function(e){var n=new t.ARRAY_TYPE(8);return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n},k.fromValues=function(e,n,r,i,o,a,s,l){var c=new t.ARRAY_TYPE(8);return c[0]=e,c[1]=n,c[2]=r,c[3]=i,c[4]=o,c[5]=a,c[6]=s,c[7]=l,c},k.fromRotationTranslationValues=function(e,n,r,i,o,a,s){var l=new t.ARRAY_TYPE(8);l[0]=e,l[1]=n,l[2]=r,l[3]=i;var c=.5*o,u=.5*a,h=.5*s;return l[4]=c*i+u*r-h*n,l[5]=u*i+h*e-c*r,l[6]=h*i+c*n-u*e,l[7]=-c*e-u*n-h*r,l},k.fromRotationTranslation=s,k.fromTranslation=function(e,t){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=.5*t[0],e[5]=.5*t[1],e[6]=.5*t[2],e[7]=0,e},k.fromRotation=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=0,e[5]=0,e[6]=0,e[7]=0,e},k.fromMat4=function(e,i){var o=n.create();r.getRotation(o,i);var a=new t.ARRAY_TYPE(3);return r.getTranslation(a,i),s(e,o,a),e},k.copy=l,k.identity=function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e},k.set=function(e,t,n,r,i,o,a,s,l){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e[4]=o,e[5]=a,e[6]=s,e[7]=l,e},k.getDual=function(e,t){return e[0]=t[4],e[1]=t[5],e[2]=t[6],e[3]=t[7],e},k.setDual=function(e,t){return e[4]=t[0],e[5]=t[1],e[6]=t[2],e[7]=t[3],e},k.getTranslation=function(e,t){var n=t[4],r=t[5],i=t[6],o=t[7],a=-t[0],s=-t[1],l=-t[2],c=t[3];return e[0]=2*(n*c+o*a+r*l-i*s),e[1]=2*(r*c+o*s+i*a-n*l),e[2]=2*(i*c+o*l+n*s-r*a),e},k.translate=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=.5*n[0],l=.5*n[1],c=.5*n[2],u=t[4],h=t[5],d=t[6],p=t[7];return e[0]=r,e[1]=i,e[2]=o,e[3]=a,e[4]=a*s+i*c-o*l+u,e[5]=a*l+o*s-r*c+h,e[6]=a*c+r*l-i*s+d,e[7]=-r*s-i*l-o*c+p,e},k.rotateX=function(e,t,r){var i=-t[0],o=-t[1],a=-t[2],s=t[3],l=t[4],c=t[5],u=t[6],h=t[7],d=l*s+h*i+c*a-u*o,p=c*s+h*o+u*i-l*a,f=u*s+h*a+l*o-c*i,m=h*s-l*i-c*o-u*a;return n.rotateX(e,t,r),e[4]=d*(s=e[3])+m*(i=e[0])+p*(a=e[2])-f*(o=e[1]),e[5]=p*s+m*o+f*i-d*a,e[6]=f*s+m*a+d*o-p*i,e[7]=m*s-d*i-p*o-f*a,e},k.rotateY=function(e,t,r){var i=-t[0],o=-t[1],a=-t[2],s=t[3],l=t[4],c=t[5],u=t[6],h=t[7],d=l*s+h*i+c*a-u*o,p=c*s+h*o+u*i-l*a,f=u*s+h*a+l*o-c*i,m=h*s-l*i-c*o-u*a;return n.rotateY(e,t,r),e[4]=d*(s=e[3])+m*(i=e[0])+p*(a=e[2])-f*(o=e[1]),e[5]=p*s+m*o+f*i-d*a,e[6]=f*s+m*a+d*o-p*i,e[7]=m*s-d*i-p*o-f*a,e},k.rotateZ=function(e,t,r){var i=-t[0],o=-t[1],a=-t[2],s=t[3],l=t[4],c=t[5],u=t[6],h=t[7],d=l*s+h*i+c*a-u*o,p=c*s+h*o+u*i-l*a,f=u*s+h*a+l*o-c*i,m=h*s-l*i-c*o-u*a;return n.rotateZ(e,t,r),e[4]=d*(s=e[3])+m*(i=e[0])+p*(a=e[2])-f*(o=e[1]),e[5]=p*s+m*o+f*i-d*a,e[6]=f*s+m*a+d*o-p*i,e[7]=m*s-d*i-p*o-f*a,e},k.rotateByQuatAppend=function(e,t,n){var r=n[0],i=n[1],o=n[2],a=n[3],s=t[0],l=t[1],c=t[2],u=t[3];return e[0]=s*a+u*r+l*o-c*i,e[1]=l*a+u*i+c*r-s*o,e[2]=c*a+u*o+s*i-l*r,e[3]=u*a-s*r-l*i-c*o,e[4]=(s=t[4])*a+(u=t[7])*r+(l=t[5])*o-(c=t[6])*i,e[5]=l*a+u*i+c*r-s*o,e[6]=c*a+u*o+s*i-l*r,e[7]=u*a-s*r-l*i-c*o,e},k.rotateByQuatPrepend=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=n[0],l=n[1],c=n[2],u=n[3];return e[0]=r*u+a*s+i*c-o*l,e[1]=i*u+a*l+o*s-r*c,e[2]=o*u+a*c+r*l-i*s,e[3]=a*u-r*s-i*l-o*c,e[4]=r*(u=n[7])+a*(s=n[4])+i*(c=n[6])-o*(l=n[5]),e[5]=i*u+a*l+o*s-r*c,e[6]=o*u+a*c+r*l-i*s,e[7]=a*u-r*s-i*l-o*c,e},k.rotateAroundAxis=function(e,n,r,i){if(Math.abs(i)<t.EPSILON)return l(e,n);var o=Math.hypot(r[0],r[1],r[2]);i*=.5;var a=Math.sin(i),s=a*r[0]/o,c=a*r[1]/o,u=a*r[2]/o,h=Math.cos(i),d=n[0],p=n[1],f=n[2],m=n[3];e[0]=d*h+m*s+p*u-f*c,e[1]=p*h+m*c+f*s-d*u,e[2]=f*h+m*u+d*c-p*s,e[3]=m*h-d*s-p*c-f*u;var g=n[4],y=n[5],_=n[6],v=n[7];return e[4]=g*h+v*s+y*u-_*c,e[5]=y*h+v*c+_*s-g*u,e[6]=_*h+v*u+g*c-y*s,e[7]=v*h-g*s-y*c-_*u,e},k.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e[6]=t[6]+n[6],e[7]=t[7]+n[7],e},k.multiply=c,k.scale=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e},k.lerp=function(e,t,n,r){var i=1-r;return u(t,n)<0&&(r=-r),e[0]=t[0]*i+n[0]*r,e[1]=t[1]*i+n[1]*r,e[2]=t[2]*i+n[2]*r,e[3]=t[3]*i+n[3]*r,e[4]=t[4]*i+n[4]*r,e[5]=t[5]*i+n[5]*r,e[6]=t[6]*i+n[6]*r,e[7]=t[7]*i+n[7]*r,e},k.invert=function(e,t){var n=d(t);return e[0]=-t[0]/n,e[1]=-t[1]/n,e[2]=-t[2]/n,e[3]=t[3]/n,e[4]=-t[4]/n,e[5]=-t[5]/n,e[6]=-t[6]/n,e[7]=t[7]/n,e},k.conjugate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e[4]=-t[4],e[5]=-t[5],e[6]=-t[6],e[7]=t[7],e},k.normalize=function(e,t){var n=d(t);if(n>0){n=Math.sqrt(n);var r=t[0]/n,i=t[1]/n,o=t[2]/n,a=t[3]/n,s=t[4],l=t[5],c=t[6],u=t[7],h=r*s+i*l+o*c+a*u;e[0]=r,e[1]=i,e[2]=o,e[3]=a,e[4]=(s-r*h)/n,e[5]=(l-i*h)/n,e[6]=(c-o*h)/n,e[7]=(u-a*h)/n}return e},k.str=function(e){return"quat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+")"},k.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]},k.equals=function(e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],l=e[5],c=e[6],u=e[7],h=n[0],d=n[1],p=n[2],f=n[3],m=n[4],g=n[5],y=n[6],_=n[7];return Math.abs(r-h)<=t.EPSILON*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(i-d)<=t.EPSILON*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(o-p)<=t.EPSILON*Math.max(1,Math.abs(o),Math.abs(p))&&Math.abs(a-f)<=t.EPSILON*Math.max(1,Math.abs(a),Math.abs(f))&&Math.abs(s-m)<=t.EPSILON*Math.max(1,Math.abs(s),Math.abs(m))&&Math.abs(l-g)<=t.EPSILON*Math.max(1,Math.abs(l),Math.abs(g))&&Math.abs(c-y)<=t.EPSILON*Math.max(1,Math.abs(c),Math.abs(y))&&Math.abs(u-_)<=t.EPSILON*Math.max(1,Math.abs(u),Math.abs(_))},k.sqrLen=k.squaredLength=k.len=k.length=k.dot=k.mul=k.setReal=k.getReal=void 0;var t=o(a()),n=o(M()),r=o(_());function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(i=function(e){return e?n:t})(e)}function o(t,n){if(t&&t.__esModule)return t;if(null===t||"object"!==e(t)&&"function"!=typeof t)return{default:t};var r=i(n);if(r&&r.has(t))return r.get(t);var o={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if("default"!==s&&Object.prototype.hasOwnProperty.call(t,s)){var l=a?Object.getOwnPropertyDescriptor(t,s):null;l&&(l.get||l.set)?Object.defineProperty(o,s,l):o[s]=t[s]}return o.default=t,r&&r.set(t,o),o}function s(e,t,n){var r=.5*n[0],i=.5*n[1],o=.5*n[2],a=t[0],s=t[1],l=t[2],c=t[3];return e[0]=a,e[1]=s,e[2]=l,e[3]=c,e[4]=r*c+i*l-o*s,e[5]=i*c+o*a-r*l,e[6]=o*c+r*s-i*a,e[7]=-r*a-i*s-o*l,e}function l(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e}function c(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=n[4],l=n[5],c=n[6],u=n[7],h=t[4],d=t[5],p=t[6],f=t[7],m=n[0],g=n[1],y=n[2],_=n[3];return e[0]=r*_+a*m+i*y-o*g,e[1]=i*_+a*g+o*m-r*y,e[2]=o*_+a*y+r*g-i*m,e[3]=a*_-r*m-i*g-o*y,e[4]=r*u+a*s+i*c-o*l+h*_+f*m+d*y-p*g,e[5]=i*u+a*l+o*s-r*c+d*_+f*g+p*m-h*y,e[6]=o*u+a*c+r*l-i*s+p*_+f*y+h*g-d*m,e[7]=a*u-r*s-i*l-o*c+f*_-h*m-d*g-p*y,e}k.getReal=n.copy,k.setReal=n.copy,k.mul=c;var u=n.dot;k.dot=u;var h=n.length;k.length=h,k.len=h;var d=n.squaredLength;return k.squaredLength=d,k.sqrLen=d,k}var j,I,O={};function N(){if(j)return O;function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}j=1,Object.defineProperty(O,"__esModule",{value:!0}),O.create=r,O.clone=function(e){var n=new t.ARRAY_TYPE(2);return n[0]=e[0],n[1]=e[1],n},O.fromValues=function(e,n){var r=new t.ARRAY_TYPE(2);return r[0]=e,r[1]=n,r},O.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e},O.set=function(e,t,n){return e[0]=t,e[1]=n,e},O.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e},O.subtract=i,O.multiply=o,O.divide=s,O.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e},O.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e},O.min=function(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e},O.max=function(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e},O.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e},O.scale=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e},O.scaleAndAdd=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e},O.distance=l,O.squaredDistance=c,O.length=u,O.squaredLength=h,O.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e},O.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e},O.normalize=function(e,t){var n=t[0],r=t[1],i=n*n+r*r;return i>0&&(i=1/Math.sqrt(i)),e[0]=t[0]*i,e[1]=t[1]*i,e},O.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]},O.cross=function(e,t,n){var r=t[0]*n[1]-t[1]*n[0];return e[0]=e[1]=0,e[2]=r,e},O.lerp=function(e,t,n,r){var i=t[0],o=t[1];return e[0]=i+r*(n[0]-i),e[1]=o+r*(n[1]-o),e},O.random=function(e,n){n=n||1;var r=2*t.RANDOM()*Math.PI;return e[0]=Math.cos(r)*n,e[1]=Math.sin(r)*n,e},O.transformMat2=function(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[2]*i,e[1]=n[1]*r+n[3]*i,e},O.transformMat2d=function(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[2]*i+n[4],e[1]=n[1]*r+n[3]*i+n[5],e},O.transformMat3=function(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[3]*i+n[6],e[1]=n[1]*r+n[4]*i+n[7],e},O.transformMat4=function(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[4]*i+n[12],e[1]=n[1]*r+n[5]*i+n[13],e},O.rotate=function(e,t,n,r){var i=t[0]-n[0],o=t[1]-n[1],a=Math.sin(r),s=Math.cos(r);return e[0]=i*s-o*a+n[0],e[1]=i*a+o*s+n[1],e},O.angle=function(e,t){var n=e[0],r=e[1],i=t[0],o=t[1],a=Math.sqrt(n*n+r*r)*Math.sqrt(i*i+o*o);return Math.acos(Math.min(Math.max(a&&(n*i+r*o)/a,-1),1))},O.zero=function(e){return e[0]=0,e[1]=0,e},O.str=function(e){return"vec2("+e[0]+", "+e[1]+")"},O.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]},O.equals=function(e,n){var r=e[0],i=e[1],o=n[0],a=n[1];return Math.abs(r-o)<=t.EPSILON*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(i-a)<=t.EPSILON*Math.max(1,Math.abs(i),Math.abs(a))},O.forEach=O.sqrLen=O.sqrDist=O.dist=O.div=O.mul=O.sub=O.len=void 0;var t=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==e(t)&&"function"!=typeof t)return{default:t};var r=n(void 0);if(r&&r.has(t))return r.get(t);var i={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&Object.prototype.hasOwnProperty.call(t,a)){var s=o?Object.getOwnPropertyDescriptor(t,a):null;s&&(s.get||s.set)?Object.defineProperty(i,a,s):i[a]=t[a]}return i.default=t,r&&r.set(t,i),i}(a());function n(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(n=function(e){return e?r:t})(e)}function r(){var e=new t.ARRAY_TYPE(2);return t.ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0),e}function i(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e}function o(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e}function s(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e}function l(e,t){return Math.hypot(t[0]-e[0],t[1]-e[1])}function c(e,t){var n=t[0]-e[0],r=t[1]-e[1];return n*n+r*r}function u(e){return Math.hypot(e[0],e[1])}function h(e){var t=e[0],n=e[1];return t*t+n*n}O.len=u,O.sub=i,O.mul=o,O.div=s,O.dist=l,O.sqrDist=c,O.sqrLen=h;var d,p=(d=r(),function(e,t,n,r,i,o){var a,s;for(t||(t=2),n||(n=0),s=r?Math.min(r*t+n,e.length):e.length,a=n;a<s;a+=t)d[0]=e[a],d[1]=e[a+1],i(d,d,o),e[a]=d[0],e[a+1]=d[1];return e});return O.forEach=p,O}function D(){if(I)return r;function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}I=1,Object.defineProperty(r,"__esModule",{value:!0}),r.vec4=r.vec3=r.vec2=r.quat2=r.quat=r.mat4=r.mat3=r.mat2d=r.mat2=r.glMatrix=void 0;var t=y(a());r.glMatrix=t;var n=y(c());r.mat2=n;var i=y(d());r.mat2d=i;var o=y(m());r.mat3=o;var s=y(_());r.mat4=s;var l=y(M());r.quat=l;var u=y(C());r.quat2=u;var h=y(N());r.vec2=h;var p=y(w());r.vec3=p;var f=y(A());function g(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(g=function(e){return e?n:t})(e)}function y(t,n){if(t&&t.__esModule)return t;if(null===t||"object"!==e(t)&&"function"!=typeof t)return{default:t};var r=g(n);if(r&&r.has(t))return r.get(t);var i={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&Object.prototype.hasOwnProperty.call(t,a)){var s=o?Object.getOwnPropertyDescriptor(t,a):null;s&&(s.get||s.set)?Object.defineProperty(i,a,s):i[a]=t[a]}return i.default=t,r&&r.set(t,i),i}return r.vec4=f,r}var L,z,R,F,B=D(),V=function(){if(z)return L;function e(e,t,n,r){this.cx=3*e,this.bx=3*(n-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(r-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=t,this.p2x=n,this.p2y=r}return z=1,L=e,e.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,t){if(void 0===t&&(t=1e-6),e<0)return 0;if(e>1)return 1;for(var n=e,r=0;r<8;r++){var i=this.sampleCurveX(n)-e;if(Math.abs(i)<t)return n;var o=this.sampleCurveDerivativeX(n);if(Math.abs(o)<1e-6)break;n-=i/o}var a=0,s=1;for(n=e,r=0;r<20&&(i=this.sampleCurveX(n),!(Math.abs(i-e)<t));r++)e>i?a=n:s=n,n=.5*(s-a)+a;return n},solve:function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))}},L}(),U=t(V);function G(){if(F)return R;function e(e,t){this.x=e,this.y=t}return F=1,R=e,e.prototype={clone:function(){return new e(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,n=e.y-this.y;return t*t+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[2]*this.x+e[3]*this.y;return this.x=e[0]*this.x+e[1]*this.y,this.y=t,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),n=Math.sin(e),r=n*this.x+t*this.y;return this.x=t*this.x-n*this.y,this.y=r,this},_rotateAround:function(e,t){var n=Math.cos(e),r=Math.sin(e),i=t.y+r*(this.x-t.x)+n*(this.y-t.y);return this.x=t.x+n*(this.x-t.x)-r*(this.y-t.y),this.y=i,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},e.convert=function(t){return t instanceof e?t:Array.isArray(t)?new e(t[0],t[1]):t},R}var H=t(G());function Z(e,t){if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!Z(e[n],t[n]))return!1;return!0}if("object"==typeof e&&null!==e&&null!==t){if("object"!=typeof t)return!1;if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(!Z(e[n],t[n]))return!1;return!0}return e===t}const q=Math.PI/180,W=180/Math.PI;function X(e){return e*q}function Y(e){return e*W}const K=[[0,0],[1,0],[1,1],[0,1]];function J(e){if(e<=0)return 0;if(e>=1)return 1;const t=e*e,n=t*e;return 4*(e<.5?n:3*(e-t)+n-.75)}function Q(e,t,n,r){const i=new U(e,t,n,r);return function(e){return i.solve(e)}}const $=Q(.25,.1,.25,1);function ee(e,t,n){return Math.min(n,Math.max(t,e))}function te(e,t,n){return(n=ee((n-e)/(t-e),0,1))*n*(3-2*n)}function ne(e,t,n){const r=n-t,i=((e-t)%r+r)%r+t;return i===t?n:i}function re(e,t,n){if(!e.length)return n(null,[]);let r=e.length;const i=new Array(e.length);let o=null;e.forEach(((e,a)=>{t(e,((e,t)=>{e&&(o=e),i[a]=t,0==--r&&n(o,i)}))}))}function ie(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(const i of n)for(const t in i)e[t]=i[t];return e}let oe=1;function ae(){return oe++}function se(e){return e<=1?1:Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))}function le(e,t){e.forEach((e=>{t[e]&&(t[e]=t[e].bind(t))}))}function ce(e,t){return-1!==e.indexOf(t,e.length-t.length)}function ue(e,t,n){const r={};for(const i in e)r[i]=t.call(this,e[i],i,e);return r}function he(e,t,n){const r={};for(const i in e)t.call(this,e[i],i,e)&&(r[i]=e[i]);return r}function de(e){return Array.isArray(e)?e.map(de):"object"==typeof e&&e?ue(e,de):e}const pe={};function fe(e){pe[e]||("undefined"!=typeof console&&console.warn(e),pe[e]=!0)}function me(e,t,n){return(n.y-e.y)*(t.x-e.x)>(t.y-e.y)*(n.x-e.x)}function ge(e){let t=0;for(let n,r,i=0,o=e.length,a=o-1;i<o;a=i++)n=e[i],r=e[a],t+=(r.x-n.x)*(n.y+r.y);return t}function ye(e){let[t,n,r]=e;const i=X(n+90),o=X(r);return{x:t*Math.cos(i)*Math.sin(o),y:t*Math.sin(i)*Math.sin(o),z:t*Math.cos(o),azimuthal:n,polar:r}}function _e(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function ve(e){const t={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((e,n,r,i)=>{const o=r||i;return t[n]=!o||o.toLowerCase(),""})),t["max-age"]){const e=parseInt(t["max-age"],10);isNaN(e)?delete t["max-age"]:t["max-age"]=e}return t}let xe=null;function be(e,t){return[e[4*t],e[4*t+1],e[4*t+2],e[4*t+3]]}function we(e,t,n,r){for(;t<n;){const i=t+n>>1;e[i]<r?t=i+1:n=i}return t}function Se(e,t,n,r){for(;t<n;){const i=t+n>>1;e[i]<=r?t=i+1:n=i}return t}function Te(e){return e>0?1/(1.001-e):1+e}function Ee(e){return e>0?1-1/(1.001-e):-e}const Ae={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!Ae.API_URL)return null;try{const e=new URL(Ae.API_URL);return"api.mapbox.cn"===e.hostname?"https://events.mapbox.cn/events/v2":"api.mapbox.com"===e.hostname?"https://events.mapbox.com/events/v2":null}catch(e){return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",TILES3D_URL_PREFIX:"3dtiles/v1"};function Me(e){return Ae.API_URL_REGEX.test(e)}function Pe(e){return Ae.API_SPRITE_REGEX.test(e)}let ke,Ce,je,Ie,Oe,Ne;function De(){return null==ke&&(ke=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof self.createImageBitmap),ke}const Le={now:()=>void 0!==Ie?Ie:performance.now(),setNow(e){Ie=e},restoreNow(){Ie=void 0},frame(e){const t=requestAnimationFrame(e);return{cancel:()=>cancelAnimationFrame(t)}},getImageData(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const{width:n,height:r}=e;Oe||(Oe=document.createElement("canvas"));const i=Oe.getContext("2d",{willReadFrequently:!0});if(!i)throw new Error("failed to create canvas 2d context");return(n>Oe.width||r>Oe.height)&&(Oe.width=n,Oe.height=r),i.clearRect(-t,-t,n+2*t,r+2*t),i.drawImage(e,0,0,n,r),i.getImageData(-t,-t,n+2*t,r+2*t)},resolveURL:e=>(Ce||(Ce=document.createElement("a")),Ce.href=e,Ce.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(null==je&&(je=window.matchMedia("(prefers-reduced-motion: reduce)")),je.matches)},hasCanvasFingerprintNoise(){if(void 0!==Ne)return Ne;if(!De())return Ne=!1,!1;const e=new OffscreenCanvas(85,1),t=e.getContext("2d",{willReadFrequently:!0});let n=0;for(let i=0;i<e.width;++i)t.fillStyle="rgba(".concat(n++,",").concat(n++,",").concat(n++,", 255)"),t.fillRect(i,0,1,1);const r=t.getImageData(0,0,e.width,e.height);n=0;for(let i=0;i<r.data.length;++i)if(i%4!=3&&n++!==r.data[i])return Ne=!0,!0;return Ne=!1,!1}};function ze(e,t){const n=e.indexOf("?");if(n<0)return"".concat(e,"?").concat(new URLSearchParams(t).toString());const r=new URLSearchParams(e.slice(n));for(const i in t)r.set(i,t[i]);return"".concat(e.slice(0,n),"?").concat(r.toString())}function Re(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{persistentParams:[]};const n=e.indexOf("?");if(n<0)return e;const r=new URLSearchParams,i=new URLSearchParams(e.slice(n));for(const a of t.persistentParams){const e=i.get(a);e&&r.set(a,e)}const o=r.toString();return"".concat(e.slice(0,n)).concat(o.length>0?"?".concat(o):"")}const Fe="mapbox-tiles";let Be=500,Ve=50;const Ue=["language","worldview","jobid"];let Ge,He;function Ze(){try{return caches}catch(e){}}function qe(){const e=Ze();e&&null==Ge&&(Ge=e.open(Fe))}let We=1/0;const Xe={supported:!1,testSupport:function(e){!Je&&Ke&&(Qe?et(e):Ye=e)}};let Ye,Ke,Je=!1,Qe=!1;const $e="undefined"!=typeof self?self:{};function et(e){const t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,Ke),e.isContextLost())return;Xe.supported=!0}catch(e){}e.deleteTexture(t),Je=!0}$e.document&&(Ke=$e.document.createElement("img"),Ke.onload=function(){Ye&&et(Ye),Ye=null,Qe=!0},Ke.onerror=function(){Je=!0,Ye=null},Ke.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const tt={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image",Model:"Model"};"function"==typeof Object.freeze&&Object.freeze(tt);class nt extends Error{constructor(e,t,n){401===t&&Me(n)&&(e+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(e),this.status=t,this.url=n}toString(){return"".concat(this.name,": ").concat(this.message," (").concat(this.status,"): ").concat(this.url)}}const rt=_e()?()=>self.worker&&self.worker.referrer:()=>("blob:"===location.protocol?parent:self).location.href,it=function(e,t){if(!(/^file:/.test(n=e.url)||/^file:/.test(rt())&&!/^\w+:/.test(n))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(e,t){const n=new AbortController,r=new Request(e.url,{method:e.method||"GET",body:e.body,credentials:e.credentials,headers:e.headers,referrer:rt(),referrerPolicy:e.referrerPolicy,signal:n.signal});let i=!1,o=!1;const a=(s=r.url).indexOf("sku=")>0&&Me(s);var s;"json"===e.type&&r.headers.set("Accept","application/json");const l=(n,i,s)=>{if(o)return;if(n&&"SecurityError"!==n.message&&fe(n.toString()),i&&s)return c(i);const l=Date.now();fetch(r).then((n=>{if(n.ok){const e=a?n.clone():null;return c(n,e,l)}return t(new nt(n.statusText,n.status,e.url))})).catch((n=>{"AbortError"!==n.name&&t(new Error("".concat(n.message," ").concat(e.url)))}))},c=(n,a,s)=>{("arrayBuffer"===e.type?n.arrayBuffer():"json"===e.type?n.json():n.text()).then((e=>{o||(a&&s&&function(e,t,n){if(qe(),null==Ge)return;const r=ve(t.headers.get("Cache-Control")||"");if(r["no-store"])return;const i={status:t.status,statusText:t.statusText,headers:new Headers};t.headers.forEach(((e,t)=>i.headers.set(t,e))),r["max-age"]&&i.headers.set("Expires",new Date(n+1e3*r["max-age"]).toUTCString());const o=i.headers.get("Expires");if(!o)return;if(new Date(o).getTime()-n<42e4)return;let a=Re(e.url,{persistentParams:Ue});if(206===t.status){const t=e.headers.get("Range");if(!t)return;i.status=200,a=ze(a,{range:t})}!function(e,t){if(void 0===He)try{new Response(new ReadableStream),He=!0}catch(e){He=!1}He?t(e.body):e.blob().then(t)}(t,(e=>{const n=new Response(200!==(r=t.status)&&404!==r&&[101,103,204,205,304].includes(r)?null:e,i);var r;qe(),null!=Ge&&Ge.then((e=>e.put(a,n))).catch((e=>fe(e.message)))}))}(r,a,s),i=!0,t(null,e,n.headers.get("Cache-Control"),n.headers.get("Expires")))})).catch((e=>{o||t(new Error(e.message))}))};return a?function(e,t){if(qe(),null==Ge)return t(null);Ge.then((n=>{let r=Re(e.url,{persistentParams:Ue});const i=e.headers.get("Range");i&&(r=ze(r,{range:i})),n.match(r).then((e=>{const i=function(e){if(!e)return!1;const t=new Date(e.headers.get("Expires")||0),n=ve(e.headers.get("Cache-Control")||"");return t>Date.now()&&!n["no-cache"]}(e);n.delete(r),i&&n.put(r,e.clone()),t(null,e,i)})).catch(t)})).catch(t)}(r,l):l(null,null),{cancel:()=>{o=!0,i||n.abort()}}}(e,t);if(_e()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",e,t,void 0,!0)}var n;return function(e,t){const n=new XMLHttpRequest;n.open(e.method||"GET",e.url,!0),"arrayBuffer"===e.type&&(n.responseType="arraybuffer");for(const r in e.headers)n.setRequestHeader(r,e.headers[r]);return"json"===e.type&&(n.responseType="text",n.setRequestHeader("Accept","application/json")),n.withCredentials="include"===e.credentials,n.onerror=()=>{t(new Error(n.statusText))},n.onload=()=>{if((n.status>=200&&n.status<300||0===n.status)&&null!==n.response){let r=n.response;if("json"===e.type)try{r=JSON.parse(n.response)}catch(e){return t(e)}t(null,r,n.getResponseHeader("Cache-Control"),n.getResponseHeader("Expires"))}else t(new nt(n.statusText,n.status,e.url))},n.send(e.body),{cancel:()=>n.abort()}}(e,t)},ot=function(e,t){return it(ie(e,{type:"arrayBuffer"}),t)};function at(e){const t=document.createElement("a");return t.href=e,t.protocol===location.protocol&&t.host===location.host}const st="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let lt,ct;lt=[],ct=0;const ut=function(e,t){if(Xe.supported&&(e.headers||(e.headers={}),e.headers.accept="image/webp,*/*"),ct>=Ae.MAX_PARALLEL_IMAGE_REQUESTS){const n={requestParameters:e,callback:t,cancelled:!1,cancel(){this.cancelled=!0}};return lt.push(n),n}ct++;let n=!1;const r=()=>{if(!n)for(n=!0,ct--;lt.length&&ct<Ae.MAX_PARALLEL_IMAGE_REQUESTS;){const e=lt.shift(),{requestParameters:t,callback:n,cancelled:r}=e;r||(e.cancel=ut(t,n).cancel)}},i=ot(e,((e,n,i,o)=>{r(),e?t(e):n&&(self.createImageBitmap?function(e,t){const n=new Blob([new Uint8Array(e)],{type:"image/png"});createImageBitmap(n).then((e=>{t(null,e)})).catch((e=>{t(new Error("Could not load image because of ".concat(e.message,". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")))}))}(n,((e,n)=>t(e,n,i,o))):function(e,t){const n=new Image;n.onload=()=>{t(null,n),URL.revokeObjectURL(n.src),n.onload=null,requestAnimationFrame((()=>{n.src=st}))},n.onerror=()=>t(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const r=new Blob([new Uint8Array(e)],{type:"image/png"});n.src=e.byteLength?URL.createObjectURL(r):st}(n,((e,n)=>t(e,n,i,o))))}));return{cancel:()=>{i.cancel(),r()}}};var ht,dt,pt,ft={exports:{}},mt={exports:{}},gt={exports:{}},yt=function(){if(pt)return ft.exports;pt=1;var e=(ht||(ht=1,mt.exports=function(e,t){var n,r,i,o,a,s,l,c;for(r=e.length-(n=3&e.length),i=t,a=3432918353,s=461845907,c=0;c<r;)l=255&e.charCodeAt(c)|(255&e.charCodeAt(++c))<<8|(255&e.charCodeAt(++c))<<16|(255&e.charCodeAt(++c))<<24,++c,i=27492+(65535&(o=5*(65535&(i=(i^=l=(65535&(l=(l=(65535&l)*a+(((l>>>16)*a&65535)<<16)&4294967295)<<15|l>>>17))*s+(((l>>>16)*s&65535)<<16)&4294967295)<<13|i>>>19))+((5*(i>>>16)&65535)<<16)&4294967295))+((58964+(o>>>16)&65535)<<16);switch(l=0,n){case 3:l^=(255&e.charCodeAt(c+2))<<16;case 2:l^=(255&e.charCodeAt(c+1))<<8;case 1:i^=l=(65535&(l=(l=(65535&(l^=255&e.charCodeAt(c)))*a+(((l>>>16)*a&65535)<<16)&4294967295)<<15|l>>>17))*s+(((l>>>16)*s&65535)<<16)&4294967295}return i^=e.length,i=2246822507*(65535&(i^=i>>>16))+((2246822507*(i>>>16)&65535)<<16)&4294967295,i=3266489909*(65535&(i^=i>>>13))+((3266489909*(i>>>16)&65535)<<16)&4294967295,(i^=i>>>16)>>>0}),mt.exports),t=(dt||(dt=1,gt.exports=function(e,t){for(var n,r=e.length,i=t^r,o=0;r>=4;)n=1540483477*(65535&(n=255&e.charCodeAt(o)|(255&e.charCodeAt(++o))<<8|(255&e.charCodeAt(++o))<<16|(255&e.charCodeAt(++o))<<24))+((1540483477*(n>>>16)&65535)<<16),i=1540483477*(65535&i)+((1540483477*(i>>>16)&65535)<<16)^(n=1540483477*(65535&(n^=n>>>24))+((1540483477*(n>>>16)&65535)<<16)),r-=4,++o;switch(r){case 3:i^=(255&e.charCodeAt(o+2))<<16;case 2:i^=(255&e.charCodeAt(o+1))<<8;case 1:i=1540483477*(65535&(i^=255&e.charCodeAt(o)))+((1540483477*(i>>>16)&65535)<<16)}return i=1540483477*(65535&(i^=i>>>13))+((1540483477*(i>>>16)&65535)<<16),(i^=i>>>15)>>>0}),gt.exports);return ft.exports=e,ft.exports.murmur3=e,ft.exports.murmur2=t,ft.exports}(),_t=t(yt);class vt{constructor(e){ie(this,(arguments.length<=1?void 0:arguments[1])||{}),this.type=e}}class xt extends vt{constructor(e){super("error",ie({error:e},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}}function bt(e,t,n){n[e]&&-1!==n[e].indexOf(t)||(n[e]=n[e]||[],n[e].push(t))}function wt(e,t,n){if(n&&n[e]){const r=n[e].indexOf(t);-1!==r&&n[e].splice(r,1)}}class St{on(e,t){return this._listeners=this._listeners||{},bt(e,t,this._listeners),this}off(e,t){return wt(e,t,this._listeners),wt(e,t,this._oneTimeListeners),this}once(e,t){return t?(this._oneTimeListeners=this._oneTimeListeners||{},bt(e,t,this._oneTimeListeners),this):new Promise((t=>this.once(e,t)))}fire(e,t){const n="string"==typeof e?new vt(e,t):e,r=n.type;if(this.listens(r)){n.target=this;const e=this._listeners&&this._listeners[r]?this._listeners[r].slice():[];for(const r of e)r.call(this,n);const t=this._oneTimeListeners&&this._oneTimeListeners[r]?this._oneTimeListeners[r].slice():[];for(const o of t)wt(r,o,this._oneTimeListeners),o.call(this,n);const i=this._eventedParent;i&&(ie(n,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),i.fire(n))}else n instanceof xt&&console.error(n.error);return this}listens(e){return!!(this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e))}setEventedParent(e,t){return this._eventedParent=e,this._eventedParentData=t,this}}var Tt,Et={},At=function(){if(Tt)return Et;Tt=1;var e={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function t(e){return(e=Math.round(e))<0?0:e>255?255:e}function n(e){return t("%"===e[e.length-1]?parseFloat(e)/100*255:parseInt(e))}function r(e){return(t="%"===e[e.length-1]?parseFloat(e)/100:parseFloat(e))<0?0:t>1?1:t;var t}function i(e,t,n){return n<0?n+=1:n>1&&(n-=1),6*n<1?e+(t-e)*n*6:2*n<1?t:3*n<2?e+(t-e)*(2/3-n)*6:e}try{Et.parseCSSColor=function(o){var a,s=o.replace(/ /g,"").toLowerCase();if(s in e)return e[s].slice();if("#"===s[0])return 4===s.length?(a=parseInt(s.substr(1),16))>=0&&a<=4095?[(3840&a)>>4|(3840&a)>>8,240&a|(240&a)>>4,15&a|(15&a)<<4,1]:null:7===s.length&&(a=parseInt(s.substr(1),16))>=0&&a<=16777215?[(16711680&a)>>16,(65280&a)>>8,255&a,1]:null;var l=s.indexOf("("),c=s.indexOf(")");if(-1!==l&&c+1===s.length){var u=s.substr(0,l),h=s.substr(l+1,c-(l+1)).split(","),d=1;switch(u){case"rgba":if(4!==h.length)return null;d=r(h.pop());case"rgb":return 3!==h.length?null:[n(h[0]),n(h[1]),n(h[2]),d];case"hsla":if(4!==h.length)return null;d=r(h.pop());case"hsl":if(3!==h.length)return null;var p=(parseFloat(h[0])%360+360)%360/360,f=r(h[1]),m=r(h[2]),g=m<=.5?m*(f+1):m+f-m*f,y=2*m-g;return[t(255*i(y,g,p+1/3)),t(255*i(y,g,p)),t(255*i(y,g,p-1/3)),d];default:return null}}return null}}catch(e){}return Et}();class Mt{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;this.r=e,this.g=t,this.b=n,this.a=r}static parse(e){if(!e)return;if(e instanceof Mt)return e;if("string"!=typeof e)return;const t=At.parseCSSColor(e);return t?new Mt(t[0]/255*t[3],t[1]/255*t[3],t[2]/255*t[3],t[3]):void 0}toString(){const[e,t,n,r]=0===this.a?[0,0,0,0]:[255*this.r/this.a,255*this.g/this.a,255*this.b/this.a,this.a];return"rgba(".concat(Math.round(e),",").concat(Math.round(t),",").concat(Math.round(n),",").concat(r,")")}toRenderColor(e){const{r:t,g:n,b:r,a:i}=this;return new Pt(e,t,n,r,i)}}class Pt{constructor(e,t,n,r,i){if(e){const o=e.image.height,a=o*o;t=0===i?0:t/i*(o-1),n=0===i?0:n/i*(o-1),r=0===i?0:r/i*(o-1);const s=Math.floor(t),l=Math.floor(n),c=Math.floor(r),u=Math.ceil(t),h=Math.ceil(n),d=Math.ceil(r),p=t-s,f=n-l,m=r-c,g=e.image.data,y=4*(s+l*a+c*o),_=4*(s+l*a+d*o),v=4*(s+h*a+c*o),x=4*(s+h*a+d*o),b=4*(u+l*a+c*o),w=4*(u+l*a+d*o),S=4*(u+h*a+c*o),T=4*(u+h*a+d*o);if(y<0||T>=g.length)throw new Error("out of range");this.r=kt(kt(kt(g[y],g[_],m),kt(g[v],g[x],m),f),kt(kt(g[b],g[w],m),kt(g[S],g[T],m),f),p)/255*i,this.g=kt(kt(kt(g[y+1],g[_+1],m),kt(g[v+1],g[x+1],m),f),kt(kt(g[b+1],g[w+1],m),kt(g[S+1],g[T+1],m),f),p)/255*i,this.b=kt(kt(kt(g[y+2],g[_+2],m),kt(g[v+2],g[x+2],m),f),kt(kt(g[b+2],g[w+2],m),kt(g[S+2],g[T+2],m),f),p)/255*i,this.a=i}else this.r=t,this.g=n,this.b=r,this.a=i}toArray(){const{r:e,g:t,b:n,a:r}=this;return 0===r?[0,0,0,0]:[255*e/r,255*t/r,255*n/r,r]}toArray01(){const{r:e,g:t,b:n,a:r}=this;return 0===r?[0,0,0,0]:[e/r,t/r,n/r,r]}toArray01Scaled(e){const{r:t,g:n,b:r,a:i}=this;return 0===i?[0,0,0]:[t/i*e,n/i*e,r/i*e]}toArray01PremultipliedAlpha(){const{r:e,g:t,b:n,a:r}=this;return[e,t,n,r]}toArray01Linear(){const{r:e,g:t,b:n,a:r}=this;return 0===r?[0,0,0,0]:[Math.pow(e/r,2.2),Math.pow(t/r,2.2),Math.pow(n/r,2.2),r]}}function kt(e,t,n){return e*(1-n)+t*n}function Ct(e,t,n){return e.map(((e,r)=>kt(e,t[r],n)))}Mt.black=new Mt(0,0,0,1),Mt.white=new Mt(1,1,1,1),Mt.transparent=new Mt(0,0,0,0),Mt.red=new Mt(1,0,0,1),Mt.blue=new Mt(0,0,1,1);var jt=Object.freeze({__proto__:null,array:Ct,color:function(e,t,n){return new Mt(kt(e.r,t.r,n),kt(e.g,t.g,n),kt(e.b,t.b,n),kt(e.a,t.a,n))},number:kt});function It(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(const i of n)for(const t in i)e[t]=i[t];return e}class Ot extends Error{constructor(e,t){super(t),this.message=t,this.key=e}}class Nt{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.parent=e,this.bindings={};for(const[n,r]of t)this.bindings[n]=r}concat(e){return new Nt(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error("".concat(e," not found in scope."))}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}const Dt={kind:"null"},Lt={kind:"number"},zt={kind:"string"},Rt={kind:"boolean"},Ft={kind:"color"},Bt={kind:"object"},Vt={kind:"value"},Ut={kind:"collator"},Gt={kind:"formatted"},Ht={kind:"resolvedImage"};function Zt(e,t){return{kind:"array",itemType:e,N:t}}function qt(e){if("array"===e.kind){const t=qt(e.itemType);return"number"==typeof e.N?"array<".concat(t,", ").concat(e.N,">"):"value"===e.itemType.kind?"array":"array<".concat(t,">")}return e.kind}const Wt=[Dt,Lt,zt,Rt,Ft,Gt,Bt,Zt(Vt),Ht];function Xt(e,t){if("error"===t.kind)return null;if("array"===e.kind){if("array"===t.kind&&(0===t.N&&"value"===t.itemType.kind||!Xt(e.itemType,t.itemType))&&("number"!=typeof e.N||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if("value"===e.kind)for(const e of Wt)if(!Xt(e,t))return null}return"Expected ".concat(qt(e)," but found ").concat(qt(t)," instead.")}function Yt(e,t){return t.some((t=>t.kind===e.kind))}function Kt(e,t){return t.some((t=>"null"===t?null===e:"array"===t?Array.isArray(e):"object"===t?e&&!Array.isArray(e)&&"object"==typeof e:t===typeof e))}class Jt{constructor(e,t,n){this.sensitivity=e?t?"variant":"case":t?"accent":"base",this.locale=n,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,t){return this.collator.compare(e,t)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Qt{constructor(e,t,n,r,i){this.text=e.normalize?e.normalize():e,this.image=t,this.scale=n,this.fontStack=r,this.textColor=i}}class $t{constructor(e){this.sections=e}static fromString(e){return new $t([new Qt(e,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some((e=>0!==e.text.length||e.image&&0!==e.image.namePrimary.length))}static factory(e){return e instanceof $t?e:$t.fromString(e)}toString(){return 0===this.sections.length?"":this.sections.map((e=>e.text)).join("")}serialize(){const e=["format"];for(const t of this.sections){if(t.image){e.push(["image",t.image.namePrimary]);continue}e.push(t.text);const n={};t.fontStack&&(n["text-font"]=["literal",t.fontStack.split(",")]),t.scale&&(n["font-scale"]=t.scale),t.textColor&&(n["text-color"]=["rgba"].concat(t.textColor.toRenderColor(null).toArray())),e.push(n)}return e}}class en{constructor(e){this.namePrimary=e.namePrimary,e.nameSecondary&&(this.nameSecondary=e.nameSecondary),this.available=e.available}toString(){return this.nameSecondary?"[".concat(this.namePrimary,",").concat(this.nameSecondary,"]"):this.namePrimary}static fromString(e,t){return e?new en({namePrimary:e,nameSecondary:t,available:!1}):null}serialize(){return this.nameSecondary?["image",this.namePrimary,this.nameSecondary]:["image",this.namePrimary]}}function tn(e,t,n,r){return"number"==typeof e&&e>=0&&e<=255&&"number"==typeof t&&t>=0&&t<=255&&"number"==typeof n&&n>=0&&n<=255?void 0===r||"number"==typeof r&&r>=0&&r<=1?null:"Invalid rgba value [".concat([e,t,n,r].join(", "),"]: 'a' must be between 0 and 1."):"Invalid rgba value [".concat(("number"==typeof r?[e,t,n,r]:[e,t,n]).join(", "),"]: 'r', 'g', and 'b' must be between 0 and 255.")}function nn(e){if(null===e)return!0;if("string"==typeof e)return!0;if("boolean"==typeof e)return!0;if("number"==typeof e)return!0;if(e instanceof Mt)return!0;if(e instanceof Jt)return!0;if(e instanceof $t)return!0;if(e instanceof en)return!0;if(Array.isArray(e)){for(const t of e)if(!nn(t))return!1;return!0}if("object"==typeof e){for(const t in e)if(!nn(e[t]))return!1;return!0}return!1}function rn(e){if(null===e)return Dt;if("string"==typeof e)return zt;if("boolean"==typeof e)return Rt;if("number"==typeof e)return Lt;if(e instanceof Mt)return Ft;if(e instanceof Jt)return Ut;if(e instanceof $t)return Gt;if(e instanceof en)return Ht;if(Array.isArray(e)){const t=e.length;let n;for(const r of e){const e=rn(r);if(n){if(n===e)continue;n=Vt;break}n=e}return Zt(n||Vt,t)}return Bt}function on(e){const t=typeof e;return null===e?"":"string"===t||"number"===t||"boolean"===t?String(e):e instanceof Mt||e instanceof $t||e instanceof en?e.toString():JSON.stringify(e)}class an{constructor(e,t){this.type=e,this.value=t}static parse(e,t){if(2!==e.length)return t.error("'literal' expression requires exactly one argument, but found ".concat(e.length-1," instead."));if(!nn(e[1]))return t.error("invalid value");const n=e[1];let r=rn(n);const i=t.expectedType;return"array"!==r.kind||0!==r.N||!i||"array"!==i.kind||"number"==typeof i.N&&0!==i.N||(r=i),new an(r,n)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof Mt?["rgba"].concat(this.value.toRenderColor(null).toArray()):this.value instanceof $t?this.value.serialize():this.value}}class sn{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}}const ln={string:zt,number:Lt,boolean:Rt,object:Bt};class cn{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");let n,r=1;const i=e[0];if("array"===i){let i,o;if(e.length>2){const n=e[1];if("string"!=typeof n||!(n in ln)||"object"===n)return t.error('The item type argument of "array" must be one of string, number, boolean',1);i=ln[n],r++}else i=Vt;if(e.length>3){if(null!==e[2]&&("number"!=typeof e[2]||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);o=e[2],r++}n=Zt(i,o)}else n=ln[i];const o=[];for(;r<e.length;r++){const n=t.parse(e[r],r,Vt);if(!n)return null;o.push(n)}return new cn(n,o)}evaluate(e){for(let t=0;t<this.args.length;t++){const n=this.args[t].evaluate(e);if(!Xt(this.type,rn(n)))return n;if(t===this.args.length-1)throw new sn("The expression ".concat(JSON.stringify(this.args[t].serialize())," evaluated to ").concat(qt(rn(n))," but was expected to be of type ").concat(qt(this.type),"."))}return null}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}serialize(){const e=this.type,t=[e.kind];if("array"===e.kind){const n=e.itemType;if("string"===n.kind||"number"===n.kind||"boolean"===n.kind){t.push(n.kind);const r=e.N;("number"==typeof r||this.args.length>1)&&t.push(r)}}return t.concat(this.args.map((e=>e.serialize())))}}class un{constructor(e){this.type=Gt,this.sections=e}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");const n=e[1];if(!Array.isArray(n)&&"object"==typeof n)return t.error("First argument must be an image or text section.");const r=[];let i=!1;for(let o=1;o<=e.length-1;++o){const n=e[o];if(i&&"object"==typeof n&&!Array.isArray(n)){i=!1;let e=null;if(n["font-scale"]&&(e=t.parseObjectValue(n["font-scale"],o,"font-scale",Lt),!e))return null;let a=null;if(n["text-font"]&&(a=t.parseObjectValue(n["text-font"],o,"text-font",Zt(zt)),!a))return null;let s=null;if(n["text-color"]&&(s=t.parseObjectValue(n["text-color"],o,"text-color",Ft),!s))return null;const l=r[r.length-1];l.scale=e,l.font=a,l.textColor=s}else{const n=t.parse(e[o],o,Vt);if(!n)return null;const a=n.type.kind;if("string"!==a&&"value"!==a&&"null"!==a&&"resolvedImage"!==a)return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");i=!0,r.push({content:n,scale:null,font:null,textColor:null})}}return new un(r)}evaluate(e){return new $t(this.sections.map((t=>{const n=t.content.evaluate(e);return rn(n)===Ht?new Qt("",n,null,null,null):new Qt(on(n),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null)})))}eachChild(e){for(const t of this.sections)e(t.content),t.scale&&e(t.scale),t.font&&e(t.font),t.textColor&&e(t.textColor)}outputDefined(){return!1}serialize(){const e=["format"];for(const t of this.sections){e.push(t.content.serialize());const n={};t.scale&&(n["font-scale"]=t.scale.serialize()),t.font&&(n["text-font"]=t.font.serialize()),t.textColor&&(n["text-color"]=t.textColor.serialize()),e.push(n)}return e}}class hn{constructor(e,t){this.type=Ht,this.inputPrimary=e,this.inputSecondary=t}static parse(e,t){if(e.length<2)return t.error("Expected two or more arguments.");const n=t.parse(e[1],1,zt);if(!n)return t.error("No image name provided.");if(2===e.length)return new hn(n);const r=t.parse(e[2],1,zt);return r?new hn(n,r):t.error("Secondary image variant is not a string.")}evaluate(e){const t=en.fromString(this.inputPrimary.evaluate(e),this.inputSecondary?this.inputSecondary.evaluate(e):void 0);return t&&e.availableImages&&(t.available=e.availableImages.indexOf(t.namePrimary)>-1,t.nameSecondary&&t.available&&e.availableImages&&(t.available=e.availableImages.indexOf(t.nameSecondary)>-1)),t}eachChild(e){e(this.inputPrimary),this.inputSecondary&&e(this.inputSecondary)}outputDefined(){return!1}serialize(){return this.inputSecondary?["image",this.inputPrimary.serialize(),this.inputSecondary.serialize()]:["image",this.inputPrimary.serialize()]}}function dn(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":null===e?"null":typeof e}const pn={"to-boolean":Rt,"to-color":Ft,"to-number":Lt,"to-string":zt};class fn{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");const n=e[0],r=[];let i=Dt;if("to-array"===n){if(!Array.isArray(e[1]))return null;const n=e[1].length;if(t.expectedType){if("array"!==t.expectedType.kind)return t.error("Expected ".concat(t.expectedType.kind," but found array."));i=Zt(t.expectedType.itemType,n)}else{if(!(n>0&&nn(e[1][0])))return null;i=Zt(rn(e[1][0]),n)}for(let o=0;o<n;o++){const n=e[1][o];let a;if("array"===dn(n))a=t.parse(n,void 0,i.itemType);else{const e=dn(n);if(e!==i.itemType.kind)return t.error("Expected ".concat(i.itemType.kind," but found ").concat(e,"."));a=t.registry.literal.parse(["literal",void 0===n?null:n],t)}if(!a)return null;r.push(a)}}else{if(("to-boolean"===n||"to-string"===n)&&2!==e.length)return t.error("Expected one argument.");i=pn[n];for(let n=1;n<e.length;n++){const i=t.parse(e[n],n,Vt);if(!i)return null;r.push(i)}}return new fn(i,r)}evaluate(e){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(e));if("color"===this.type.kind){let t,n;for(const r of this.args){if(t=r.evaluate(e),n=null,t instanceof Mt)return t;if("string"==typeof t){const n=e.parseColor(t);if(n)return n}else if(Array.isArray(t)&&(n=t.length<3||t.length>4?"Invalid rbga value ".concat(JSON.stringify(t),": expected an array containing either three or four numeric values."):tn(t[0],t[1],t[2],t[3]),!n))return new Mt(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new sn(n||"Could not parse color from value '".concat("string"==typeof t?t:String(JSON.stringify(t)),"'"))}if("number"===this.type.kind){let t=null;for(const n of this.args){if(t=n.evaluate(e),null===t)return 0;const r=Number(t);if(!isNaN(r))return r}throw new sn("Could not convert ".concat(JSON.stringify(t)," to number."))}return"formatted"===this.type.kind?$t.fromString(on(this.args[0].evaluate(e))):"resolvedImage"===this.type.kind?en.fromString(on(this.args[0].evaluate(e))):"array"===this.type.kind?this.args.map((t=>t.evaluate(e))):on(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}serialize(){if("formatted"===this.type.kind)return new un([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new hn(this.args[0]).serialize();const e="array"===this.type.kind?[]:["to-".concat(this.type.kind)];return this.eachChild((t=>{e.push(t.serialize())})),e}}const mn=["Unknown","Point","LineString","Polygon"];class gn{constructor(e,t){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=e,this.options=t}id(){return this.feature&&void 0!==this.feature.id?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?mn[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(e){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const e=this.featureDistanceData.center,t=this.featureDistanceData.scale,{x:n,y:r}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(n*t-e[0])+this.featureDistanceData.bearing[1]*(r*t-e[1])}return 0}parseColor(e){let t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=Mt.parse(e)),t}getConfig(e){return this.options?this.options.get(e):null}}class yn{constructor(e,t,n,r,i){this.name=e,this.type=t,this._evaluate=n,this.args=r,this._overloadIndex=i}evaluate(e){if(!this._evaluate){const e=yn.definitions[this.name];this._evaluate=Array.isArray(e)?e[2]:e.overloads[this._overloadIndex][1]}return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map((e=>e.serialize())))}static parse(e,t){const n=e[0],r=yn.definitions[n];if(!r)return t.error('Unknown expression "'.concat(n,'". If you wanted a literal array, use ["literal", [...]].'),0);const i=Array.isArray(r)?r[0]:r.type,o=Array.isArray(r)?[[r[1],r[2]]]:r.overloads,a=[];let s=null,l=-1;for(const[c,u]of o){if(Array.isArray(c)&&c.length!==e.length-1)continue;a.push(c),l++,s=new zr(t.registry,t.path,null,t.scope,void 0,t._scope,t.options);const r=[];let o=!1;for(let t=1;t<e.length;t++){const n=e[t],i=Array.isArray(c)?c[t-1]:c.type,a=s.parse(n,1+r.length,i);if(!a){o=!0;break}r.push(a)}if(!o)if(Array.isArray(c)&&c.length!==r.length)s.error("Expected ".concat(c.length," arguments, but found ").concat(r.length," instead."));else{for(let e=0;e<r.length;e++){const t=Array.isArray(c)?c[e]:c.type,n=r[e];s.concat(e+1).checkSubtype(t,n.type)}if(0===s.errors.length)return new yn(n,i,u,r,l)}}if(1===a.length)t.errors.push(...s.errors);else{const n=(a.length?a:o.map((e=>{let[t]=e;return t}))).map(_n).join(" | "),r=[];for(let i=1;i<e.length;i++){const n=t.parse(e[i],1+r.length);if(!n)return null;r.push(qt(n.type))}t.error("Expected arguments of type ".concat(n,", but found (").concat(r.join(", "),") instead."))}return null}static register(e,t){yn.definitions=t;for(const n in t)e[n]=yn}}function _n(e){return Array.isArray(e)?"(".concat(e.map(qt).join(", "),")"):"(".concat(qt(e.type),"...)")}class vn{constructor(e,t,n){this.type=Ut,this.locale=n,this.caseSensitive=e,this.diacriticSensitive=t}static parse(e,t){if(2!==e.length)return t.error("Expected one argument.");const n=e[1];if("object"!=typeof n||Array.isArray(n))return t.error("Collator options argument must be an object.");const r=void 0===n["case-sensitive"]?t.parse(!1,1,Rt):t.parseObjectValue(n["case-sensitive"],1,"case-sensitive",Rt);if(!r)return null;const i=void 0===n["diacritic-sensitive"]?t.parse(!1,1,Rt):t.parseObjectValue(n["diacritic-sensitive"],1,"diacritic-sensitive",Rt);if(!i)return null;let o=null;return n.locale&&(o=t.parseObjectValue(n.locale,1,"locale",zt),!o)?null:new vn(r,i,o)}evaluate(e){return new Jt(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}serialize(){const e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]}}function xn(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length-1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:wn;for(;r>n;){if(r-n>600){const o=r-n+1,a=t-n+1,s=Math.log(o),l=.5*Math.exp(2*s/3),c=.5*Math.sqrt(s*l*(o-l)/o)*(a-o/2<0?-1:1);xn(e,t,Math.max(n,Math.floor(t-a*l/o+c)),Math.min(r,Math.floor(t+(o-a)*l/o+c)),i)}const o=e[t];let a=n,s=r;for(bn(e,n,t),i(e[r],o)>0&&bn(e,n,r);a<s;){for(bn(e,a,s),a++,s--;i(e[a],o)<0;)a++;for(;i(e[s],o)>0;)s--}0===i(e[n],o)?bn(e,n,s):(s++,bn(e,s,r)),s<=t&&(n=s+1),t<=s&&(r=s-1)}}function bn(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function wn(e,t){return e<t?-1:e>t?1:0}function Sn(e){let t=0;for(let n,r,i=0,o=e.length,a=o-1;i<o;a=i++)n=e[i],r=e[a],t+=(r.x-n.x)*(n.y+r.y);return t}function Tn(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function En(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function An(e,t,n){const r=e[0]-t[0],i=e[1]-t[1],o=e[0]-n[0],a=e[1]-n[1];return r*a-o*i==0&&r*o<=0&&i*a<=0}function Mn(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=!1;for(let s=0,l=t.length;s<l;s++){const l=t[s];for(let t=0,s=l.length,c=s-1;t<s;c=t++){const s=l[c],u=l[t];if(An(e,s,u))return n;(o=s)[1]>(i=e)[1]!=(a=u)[1]>i[1]&&i[0]<(a[0]-o[0])*(i[1]-o[1])/(a[1]-o[1])+o[0]&&(r=!r)}}var i,o,a;return r}function Pn(e,t,n,r){const i=r[0]-n[0],o=r[1]-n[1],a=(e[0]-n[0])*o-i*(e[1]-n[1]),s=(t[0]-n[0])*o-i*(t[1]-n[1]);return a>0&&s<0||a<0&&s>0}function kn(e,t,n,r){return 0!=(i=[r[0]-n[0],r[1]-n[1]])[0]*(o=[t[0]-e[0],t[1]-e[1]])[1]-i[1]*o[0]&&!(!Pn(e,t,n,r)||!Pn(n,r,e,t));var i,o}const Cn=8192;function jn(e,t){const n=(180+e[0])/360,r=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,i=Math.pow(2,t.z);return[Math.round(n*i*Cn),Math.round(r*i*Cn)]}function In(e,t){for(let n=0;n<t.length;n++)if(Mn(e,t[n]))return!0;return!1}function On(e,t,n){for(const r of n)for(let n=0,i=r.length,o=i-1;n<i;o=n++)if(kn(e,t,r[o],r[n]))return!0;return!1}function Nn(e,t){for(let n=0;n<e.length;++n)if(!Mn(e[n],t))return!1;for(let n=0;n<e.length-1;++n)if(On(e[n],e[n+1],t))return!1;return!0}function Dn(e,t){for(let n=0;n<t.length;n++)if(Nn(e,t[n]))return!0;return!1}function Ln(e,t,n){const r=[];for(let i=0;i<e.length;i++){const o=[];for(let r=0;r<e[i].length;r++){const a=jn(e[i][r],n);Tn(t,a),o.push(a)}r.push(o)}return r}function zn(e,t,n){const r=[];for(let i=0;i<e.length;i++){const o=Ln(e[i],t,n);r.push(o)}return r}function Rn(e,t,n,r){if(e[0]<n[0]||e[0]>n[2]){const t=.5*r;let i=e[0]-n[0]>t?-r:n[0]-e[0]>t?r:0;0===i&&(i=e[0]-n[2]>t?-r:n[2]-e[0]>t?r:0),e[0]+=i}Tn(t,e)}function Fn(e,t,n,r){const i=Math.pow(2,r.z)*Cn,o=[r.x*Cn,r.y*Cn],a=[];if(!e)return a;for(const s of e)for(const e of s){const r=[e.x+o[0],e.y+o[1]];Rn(r,t,n,i),a.push(r)}return a}function Bn(e,t,n,r){const i=Math.pow(2,r.z)*Cn,o=[r.x*Cn,r.y*Cn],a=[];if(!e)return a;for(const l of e){const e=[];for(const n of l){const r=[n.x+o[0],n.y+o[1]];Tn(t,r),e.push(r)}a.push(e)}if(t[2]-t[0]<=i/2){(s=t)[0]=s[1]=1/0,s[2]=s[3]=-1/0;for(const e of a)for(const r of e)Rn(r,t,n,i)}var s;return a}class Vn{constructor(e,t){this.type=Rt,this.geojson=e,this.geometries=t}static parse(e,t){if(2!==e.length)return t.error("'within' expression requires exactly one argument, but found ".concat(e.length-1," instead."));if(nn(e[1])){const t=e[1];if("FeatureCollection"===t.type)for(let e=0;e<t.features.length;++e){const n=t.features[e].geometry.type;if("Polygon"===n||"MultiPolygon"===n)return new Vn(t,t.features[e].geometry)}else if("Feature"===t.type){const e=t.geometry.type;if("Polygon"===e||"MultiPolygon"===e)return new Vn(t,t.geometry)}else if("Polygon"===t.type||"MultiPolygon"===t.type)return new Vn(t,t)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(null!=e.geometry()&&null!=e.canonicalID()){if("Point"===e.geometryType())return function(e,t){const n=[1/0,1/0,-1/0,-1/0],r=[1/0,1/0,-1/0,-1/0],i=e.canonicalID();if(!i)return!1;if("Polygon"===t.type){const o=Ln(t.coordinates,r,i),a=Fn(e.geometry(),n,r,i);if(!En(n,r))return!1;for(const e of a)if(!Mn(e,o))return!1}if("MultiPolygon"===t.type){const o=zn(t.coordinates,r,i),a=Fn(e.geometry(),n,r,i);if(!En(n,r))return!1;for(const e of a)if(!In(e,o))return!1}return!0}(e,this.geometries);if("LineString"===e.geometryType())return function(e,t){const n=[1/0,1/0,-1/0,-1/0],r=[1/0,1/0,-1/0,-1/0],i=e.canonicalID();if(!i)return!1;if("Polygon"===t.type){const o=Ln(t.coordinates,r,i),a=Bn(e.geometry(),n,r,i);if(!En(n,r))return!1;for(const e of a)if(!Nn(e,o))return!1}if("MultiPolygon"===t.type){const o=zn(t.coordinates,r,i),a=Bn(e.geometry(),n,r,i);if(!En(n,r))return!1;for(const e of a)if(!Dn(e,o))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}const Un={kilometers:1,miles:1e3/1609.344,nauticalmiles:1e3/1852,meters:1e3,metres:1e3,yards:1e3/.9144,feet:1e3/.3048,inches:1e3/.0254},Gn=1/298.257223563,Hn=Gn*(2-Gn),Zn=Math.PI/180;class qn{static fromTile(e,t,n){const r=Math.PI*(1-2*(e+.5)/Math.pow(2,t)),i=Math.atan(.5*(Math.exp(r)-Math.exp(-r)))/Zn;return new qn(i,n)}static get units(){return Un}constructor(e,t){if(void 0===e)throw new Error("No latitude given.");if(t&&!Un[t])throw new Error("Unknown unit ".concat(t,". Use one of: ").concat(Object.keys(Un).join(", ")));const n=6378.137*Zn*(t?Un[t]:1),r=Math.cos(e*Zn),i=1/(1-Hn*(1-r*r)),o=Math.sqrt(i);this.kx=n*o*r,this.ky=n*o*i*(1-Hn)}distance(e,t){const n=Yn(e[0]-t[0])*this.kx,r=(e[1]-t[1])*this.ky;return Math.sqrt(n*n+r*r)}bearing(e,t){const n=Yn(t[0]-e[0])*this.kx;return Math.atan2(n,(t[1]-e[1])*this.ky)/Zn}destination(e,t,n){const r=n*Zn;return this.offset(e,Math.sin(r)*t,Math.cos(r)*t)}offset(e,t,n){return[e[0]+t/this.kx,e[1]+n/this.ky]}lineDistance(e){let t=0;for(let n=0;n<e.length-1;n++)t+=this.distance(e[n],e[n+1]);return t}area(e){let t=0;for(let n=0;n<e.length;n++){const r=e[n];for(let e=0,i=r.length,o=i-1;e<i;o=e++)t+=Yn(r[e][0]-r[o][0])*(r[e][1]+r[o][1])*(n?-1:1)}return Math.abs(t)/2*this.kx*this.ky}along(e,t){let n=0;if(t<=0)return e[0];for(let r=0;r<e.length-1;r++){const i=e[r],o=e[r+1],a=this.distance(i,o);if(n+=a,n>t)return Xn(i,o,(t-(n-a))/a)}return e[e.length-1]}pointToSegmentDistance(e,t,n){let[r,i]=t,o=Yn(n[0]-r)*this.kx,a=(n[1]-i)*this.ky;if(0!==o||0!==a){const t=(Yn(e[0]-r)*this.kx*o+(e[1]-i)*this.ky*a)/(o*o+a*a);t>1?(r=n[0],i=n[1]):t>0&&(r+=o/this.kx*t,i+=a/this.ky*t)}return o=Yn(e[0]-r)*this.kx,a=(e[1]-i)*this.ky,Math.sqrt(o*o+a*a)}pointOnLine(e,t){let n=1/0,r=e[0][0],i=e[0][1],o=0,a=0;for(let s=0;s<e.length-1;s++){let l=e[s][0],c=e[s][1],u=Yn(e[s+1][0]-l)*this.kx,h=(e[s+1][1]-c)*this.ky,d=0;0===u&&0===h||(d=(Yn(t[0]-l)*this.kx*u+(t[1]-c)*this.ky*h)/(u*u+h*h),d>1?(l=e[s+1][0],c=e[s+1][1]):d>0&&(l+=u/this.kx*d,c+=h/this.ky*d)),u=Yn(t[0]-l)*this.kx,h=(t[1]-c)*this.ky;const p=u*u+h*h;p<n&&(n=p,r=l,i=c,o=s,a=d)}return{point:[r,i],index:o,t:Math.max(0,Math.min(1,a))}}lineSlice(e,t,n){let r=this.pointOnLine(n,e),i=this.pointOnLine(n,t);if(r.index>i.index||r.index===i.index&&r.t>i.t){const e=r;r=i,i=e}const o=[r.point],a=r.index+1,s=i.index;!Wn(n[a],o[0])&&a<=s&&o.push(n[a]);for(let l=a+1;l<=s;l++)o.push(n[l]);return Wn(n[s],i.point)||o.push(i.point),o}lineSliceAlong(e,t,n){let r=0;const i=[];for(let o=0;o<n.length-1;o++){const a=n[o],s=n[o+1],l=this.distance(a,s);if(r+=l,r>e&&0===i.length&&i.push(Xn(a,s,(e-(r-l))/l)),r>=t)return i.push(Xn(a,s,(t-(r-l))/l)),i;r>e&&i.push(s)}return i}bufferPoint(e,t){const n=t/this.ky,r=t/this.kx;return[e[0]-r,e[1]-n,e[0]+r,e[1]+n]}bufferBBox(e,t){const n=t/this.ky,r=t/this.kx;return[e[0]-r,e[1]-n,e[2]+r,e[3]+n]}insideBBox(e,t){return Yn(e[0]-t[0])>=0&&Yn(e[0]-t[2])<=0&&e[1]>=t[1]&&e[1]<=t[3]}}function Wn(e,t){return e[0]===t[0]&&e[1]===t[1]}function Xn(e,t,n){const r=Yn(t[0]-e[0]);return[e[0]+r*n,e[1]+(t[1]-e[1])*n]}function Yn(e){for(;e<-180;)e+=360;for(;e>180;)e-=360;return e}class Kn{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(e,t)=>e<t?-1:e>t?1:0;if(this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(e){this.data.push(e),this._up(this.length++)}pop(){if(0===this.length)return;const e=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:t,compare:n}=this,r=t[e];for(;e>0;){const i=e-1>>1,o=t[i];if(n(r,o)>=0)break;t[e]=o,e=i}t[e]=r}_down(e){const{data:t,compare:n}=this,r=this.length>>1,i=t[e];for(;e<r;){let r=1+(e<<1);const o=r+1;if(o<this.length&&n(t[o],t[r])<0&&(r=o),n(t[r],i)>=0)break;t[e]=t[r],e=r}t[e]=i}}var Jn=8192;function Qn(e,t){return t.dist-e.dist}const $n=100,er=50;function tr(e){const t=[1/0,1/0,-1/0,-1/0];if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function nr(e){return e[1]-e[0]+1}function rr(e,t){const n=e[1]>=e[0]&&e[1]<t;return n||console.warn("Distance Expression: Index is out of range"),n}function ir(e,t){if(e[0]>e[1])return[null,null];const n=nr(e);if(t){if(2===n)return[e,null];const t=Math.floor(n/2);return[[e[0],e[0]+t],[e[0]+t,e[1]]]}{if(1===n)return[e,null];const t=Math.floor(n/2)-1;return[[e[0],e[0]+t],[e[0]+t+1,e[1]]]}}function or(e,t){const n=[1/0,1/0,-1/0,-1/0];if(!rr(t,e.length))return n;for(let r=t[0];r<=t[1];++r)Tn(n,e[r]);return n}function ar(e){const t=[1/0,1/0,-1/0,-1/0];for(let n=0;n<e.length;++n)for(let r=0;r<e[n].length;++r)Tn(t,e[n][r]);return t}function sr(e,t,n){if(tr(e)||tr(t))return NaN;let r=0,i=0;return e[2]<t[0]&&(r=t[0]-e[2]),e[0]>t[2]&&(r=e[0]-t[2]),e[1]>t[3]&&(i=e[1]-t[3]),e[3]<t[1]&&(i=t[1]-e[3]),n.distance([0,0],[r,i])}function lr(e){return 360*e-180}function cr(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}function ur(e,t){const n=Math.pow(2,t.z),r=(e.y/Jn+t.y)/n;return[lr((e.x/Jn+t.x)/n),cr(r)]}function hr(e,t){const n=[];for(let r=0;r<e.length;++r)n.push(ur(e[r],t));return n}function dr(e,t,n){const r=n.pointOnLine(t,e).point;return n.distance(e,r)}function pr(e,t,n,r,i){const o=n.slice(r[0],r[1]+1);let a=1/0;for(let s=t[0];s<=t[1];++s)if(0===(a=Math.min(a,dr(e[s],o,i))))return 0;return a}function fr(e,t,n,r,i){const o=Math.min(i.pointToSegmentDistance(e,n,r),i.pointToSegmentDistance(t,n,r)),a=Math.min(i.pointToSegmentDistance(n,e,t),i.pointToSegmentDistance(r,e,t));return Math.min(o,a)}function mr(e,t,n,r,i){if(!rr(t,e.length)||!rr(r,n.length))return NaN;let o=1/0;for(let a=t[0];a<t[1];++a)for(let t=r[0];t<r[1];++t){if(kn(e[a],e[a+1],n[t],n[t+1]))return 0;o=Math.min(o,fr(e[a],e[a+1],n[t],n[t+1],i))}return o}function gr(e,t,n,r,i){if(!rr(t,e.length)||!rr(r,n.length))return NaN;let o=1/0;for(let a=t[0];a<=t[1];++a)for(let t=r[0];t<=r[1];++t)if(0===(o=Math.min(o,i.distance(e[a],n[t]))))return o;return o}function yr(e,t,n){if(Mn(e,t,!0))return 0;let r=1/0;for(const i of t){const t=i.length;if(t<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(i[0]!==i[t-1]&&0===(r=Math.min(r,n.pointToSegmentDistance(e,i[t-1],i[0]))))return r;if(0===(r=Math.min(r,dr(e,i,n))))return r}return r}function _r(e,t,n,r){if(!rr(t,e.length))return NaN;for(let o=t[0];o<=t[1];++o)if(Mn(e[o],n,!0))return 0;let i=1/0;for(let o=t[0];o<t[1];++o)for(const t of n)for(let n=0,a=t.length,s=a-1;n<a;s=n++){if(kn(e[o],e[o+1],t[s],t[n]))return 0;i=Math.min(i,fr(e[o],e[o+1],t[s],t[n],r))}return i}function vr(e,t){for(const n of e)for(let e=0;e<=n.length-1;++e)if(Mn(n[e],t,!0))return!0;return!1}function xr(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;const i=ar(e),o=ar(t);if(r!==1/0&&sr(i,o,n)>=r)return r;if(En(i,o)){if(vr(e,t))return 0}else if(vr(t,e))return 0;let a=r;for(const s of e)for(let e=0,r=s.length,i=r-1;e<r;i=e++)for(const o of t)for(let t=0,r=o.length,l=r-1;t<r;l=t++){if(kn(s[i],s[e],o[l],o[t]))return 0;a=Math.min(a,fr(s[i],s[e],o[l],o[t],n))}return a}function br(e,t,n,r,i,o,a){if(null===o||null===a)return;const s=sr(or(r,o),or(i,a),n);s<t&&e.push({dist:s,range1:o,range2:a})}function wr(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1/0,o=Math.min(r.distance(e[0],n[0][0]),i);if(0===o)return o;const a=new Kn([{dist:0,range1:[0,e.length-1],range2:[0,0]}],Qn),s=t?er:$n,l=ar(n);for(;a.length;){const i=a.pop();if(i.dist>=o)continue;const c=i.range1;if(nr(c)<=s){if(!rr(c,e.length))return NaN;if(t){const t=_r(e,c,n,r);if(0===(o=Math.min(o,t)))return o}else for(let t=c[0];t<=c[1];++t){const i=yr(e[t],n,r);if(0===(o=Math.min(o,i)))return o}}else{const n=ir(c,t);if(null!==n[0]){const t=sr(or(e,n[0]),l,r);t<o&&a.push({dist:t,range1:n[0],range2:[0,0]})}if(null!==n[1]){const t=sr(or(e,n[1]),l,r);t<o&&a.push({dist:t,range1:n[1],range2:[0,0]})}}}return o}function Sr(e,t,n,r,i){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1/0,a=Math.min(o,i.distance(e[0],n[0]));if(0===a)return a;const s=new Kn([{dist:0,range1:[0,e.length-1],range2:[0,n.length-1]}],Qn),l=t?er:$n,c=r?er:$n;for(;s.length;){const o=s.pop();if(o.dist>=a)continue;const u=o.range1,h=o.range2;if(nr(u)<=l&&nr(h)<=c){if(!rr(u,e.length)||!rr(h,n.length))return NaN;if(t&&r?a=Math.min(a,mr(e,u,n,h,i)):t||r?t&&!r?a=Math.min(a,pr(n,h,e,u,i)):!t&&r&&(a=Math.min(a,pr(e,u,n,h,i))):a=Math.min(a,gr(e,u,n,h,i)),0===a)return a}else{const o=ir(u,t),l=ir(h,r);br(s,a,i,e,n,o[0],l[0]),br(s,a,i,e,n,o[0],l[1]),br(s,a,i,e,n,o[1],l[0]),br(s,a,i,e,n,o[1],l[1])}}return a}function Tr(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1/0;const o=or(e,[0,e.length-1]);for(const a of n)if(!(i!==1/0&&sr(o,or(a,[0,a.length-1]),r)>=i)&&(i=Math.min(i,Sr(e,t,a,!0,r,i)),0===i))return i;return i}function Er(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1/0;const o=or(e,[0,e.length-1]);for(const a of n){if(i!==1/0&&sr(o,ar(a),r)>=i)continue;const n=wr(e,t,a,r,i);if(isNaN(n))return n;if(0===(i=Math.min(i,n)))return i}return i}function Ar(e){return"Point"===e||"MultiPoint"===e||"LineString"===e||"MultiLineString"===e||"Polygon"===e||"MultiPolygon"===e}class Mr{constructor(e,t){this.type=Lt,this.geojson=e,this.geometries=t}static parse(e,t){if(2!==e.length)return t.error("'distance' expression requires either one argument, but found ' ".concat(e.length-1," instead."));if(nn(e[1])){const t=e[1];if("FeatureCollection"===t.type){for(let e=0;e<t.features.length;++e)if(Ar(t.features[e].geometry.type))return new Mr(t,t.features[e].geometry)}else if("Feature"===t.type){if(Ar(t.geometry.type))return new Mr(t,t.geometry)}else if(Ar(t.type))return new Mr(t,t)}return t.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(e){const t=e.geometry(),n=e.canonicalID();if(null!=t&&null!=n){if("Point"===e.geometryType())return function(e,t,n){const r=[];for(const o of e)for(const e of o)r.push(ur(e,t));const i=new qn(r[0][1],"meters");return"Point"===n.type||"MultiPoint"===n.type||"LineString"===n.type?Sr(r,!1,"Point"===n.type?[n.coordinates]:n.coordinates,"LineString"===n.type,i):"MultiLineString"===n.type?Tr(r,!1,n.coordinates,i):"Polygon"===n.type||"MultiPolygon"===n.type?Er(r,!1,"Polygon"===n.type?[n.coordinates]:n.coordinates,i):null}(t,n,this.geometries);if("LineString"===e.geometryType())return function(e,t,n){const r=[];for(const o of e){const e=[];for(const n of o)e.push(ur(n,t));r.push(e)}const i=new qn(r[0][0][1],"meters");if("Point"===n.type||"MultiPoint"===n.type||"LineString"===n.type)return Tr("Point"===n.type?[n.coordinates]:n.coordinates,"LineString"===n.type,r,i);if("MultiLineString"===n.type){let e=1/0;for(let t=0;t<n.coordinates.length;t++){const o=Tr(n.coordinates[t],!0,r,i,e);if(isNaN(o))return o;if(0===(e=Math.min(e,o)))return e}return e}if("Polygon"===n.type||"MultiPolygon"===n.type){let e=1/0;for(let t=0;t<r.length;t++){const o=Er(r[t],!0,"Polygon"===n.type?[n.coordinates]:n.coordinates,i,e);if(isNaN(o))return o;if(0===(e=Math.min(e,o)))return e}return e}return null}(t,n,this.geometries);if("Polygon"===e.geometryType())return function(e,t,n){const r=[];for(const o of function(e){const t=e.length;if(t<=1)return[e];const n=[];let r,i;for(let o=0;o<t;o++){const t=Sn(e[o]);0!==t&&(e[o].area=Math.abs(t),void 0===i&&(i=t<0),i===t<0?(r&&n.push(r),r=[e[o]]):r.push(e[o]))}return r&&n.push(r),n}(e)){const e=[];for(let n=0;n<o.length;++n)e.push(hr(o[n],t));r.push(e)}const i=new qn(r[0][0][0][1],"meters");if("Point"===n.type||"MultiPoint"===n.type||"LineString"===n.type)return Er("Point"===n.type?[n.coordinates]:n.coordinates,"LineString"===n.type,r,i);if("MultiLineString"===n.type){let e=1/0;for(let t=0;t<n.coordinates.length;t++){const o=Er(n.coordinates[t],!0,r,i,e);if(isNaN(o))return o;if(0===(e=Math.min(e,o)))return e}return e}return"Polygon"===n.type||"MultiPolygon"===n.type?function(e,t,n){let r=1/0;for(const i of e)for(const e of t){const t=xr(i,e,n,r);if(isNaN(t))return t;if(0===(r=Math.min(r,t)))return r}return r}("Polygon"===n.type?[n.coordinates]:n.coordinates,r,i):null}(t,n,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function Pr(e,t){switch(e){case"string":return on(t);case"number":return+t;case"boolean":return!!t;case"color":return Mt.parse(t);case"formatted":return $t.fromString(on(t));case"resolvedImage":return en.fromString(on(t))}return t}function kr(e,t,n,r){return void 0!==r&&(e=r*Math.round(e/r)),void 0!==t&&e<t&&(e=t),void 0!==n&&e>n&&(e=n),e}class Cr{constructor(e,t,n){this.type=e,this.key=t,this.scope=n}static parse(e,t){let n=t.expectedType;if(null==n&&(n=Vt),e.length<2||e.length>3)return t.error("Invalid number of arguments for 'config' expression.");const r=t.parse(e[1],1);if(!(r instanceof an))return t.error("Key name of 'config' expression must be a string literal.");if(e.length>=3){const i=t.parse(e[2],2);return i instanceof an?new Cr(n,on(r.value),on(i.value)):t.error("Scope of 'config' expression must be a string literal.")}return new Cr(n,on(r.value))}evaluate(e){const t=[this.key,this.scope,e.scope].filter(Boolean).join("\x1f"),n=e.getConfig(t);if(!n)return null;const{type:r,value:i,values:o,minValue:a,maxValue:s,stepValue:l}=n,c=n.default.evaluate(e);let u=c;if(i){const t=e.scope;e.scope=(t||"").split("\x1f").slice(1).join("\x1f"),u=i.evaluate(e),e.scope=t}return r&&(u=Pr(r,u)),void 0===u||void 0===a&&void 0===s&&void 0===l||("number"==typeof u?u=kr(u,a,s,l):Array.isArray(u)&&(u=u.map((e=>"number"==typeof e?kr(e,a,s,l):e)))),void 0!==i&&void 0!==u&&o&&!o.includes(u)&&(u=c,r&&(u=Pr(r,u))),(r&&r!==this.type||void 0!==u&&rn(u)!==this.type)&&(u=Pr(this.type.kind,u)),u}eachChild(){}outputDefined(){return!1}serialize(){const e=["config",this.key];return this.scope&&e.concat(this.key),e}}function jr(e){if(e instanceof yn){if("get"===e.name&&1===e.args.length)return!1;if("feature-state"===e.name)return!1;if("has"===e.name&&1===e.args.length)return!1;if("properties"===e.name||"geometry-type"===e.name||"id"===e.name)return!1;if(/^filter-/.test(e.name))return!1}if(e instanceof Vn)return!1;if(e instanceof Mr)return!1;let t=!0;return e.eachChild((e=>{t&&!jr(e)&&(t=!1)})),t}function Ir(e){if(e instanceof yn&&"feature-state"===e.name)return!1;let t=!0;return e.eachChild((e=>{t&&!Ir(e)&&(t=!1)})),t}function Or(e){if(e instanceof Cr)return new Set([e.key]);let t=new Set;return e.eachChild((e=>{t=new Set([...t,...Or(e)])})),t}function Nr(e,t){if(e instanceof yn&&t.indexOf(e.name)>=0)return!1;let n=!0;return e.eachChild((e=>{n&&!Nr(e,t)&&(n=!1)})),n}class Dr{constructor(e,t){this.type=t.type,this.name=e,this.boundExpression=t}static parse(e,t){if(2!==e.length||"string"!=typeof e[1])return t.error("'var' expression requires exactly one string literal argument.");const n=e[1];return t.scope.has(n)?new Dr(n,t.scope.get(n)):t.error('Unknown variable "'.concat(n,'". Make sure "').concat(n,'" has been bound in an enclosing "let" expression before using it.'),1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class Lr{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Nt,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],o=arguments.length>5?arguments[5]:void 0,a=arguments.length>6?arguments[6]:void 0;this.registry=e,this.path=t,this.key=t.map((e=>"string"==typeof e?"['".concat(e,"']"):"[".concat(e,"]"))).join(""),this.scope=r,this.errors=i,this.expectedType=n,this._scope=o,this.options=a}parse(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return t||n?this.concat(t,null,n,r)._parse(e,i):this._parse(e,i)}parseObjectValue(e,t,n,r,i){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};return this.concat(t,n,r,i)._parse(e,o)}_parse(e,t){function n(e,t,n){return"assert"===n?new cn(t,[e]):"coerce"===n?new fn(t,[e]):e}if(null!==e&&"string"!=typeof e&&"boolean"!=typeof e&&"number"!=typeof e||(e=["literal",e]),Array.isArray(e)){if(0===e.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const r="string"==typeof e[0]?this.registry[e[0]]:void 0;if(r){let i=r.parse(e,this);if(!i)return null;if(this.expectedType){const e=this.expectedType,r=i.type;if("string"!==e.kind&&"number"!==e.kind&&"boolean"!==e.kind&&"object"!==e.kind&&"array"!==e.kind||"value"!==r.kind)if("color"!==e.kind&&"formatted"!==e.kind&&"resolvedImage"!==e.kind||"value"!==r.kind&&"string"!==r.kind){if(this.checkSubtype(e,r))return null}else i=n(i,e,t.typeAnnotation||"coerce");else i=n(i,e,t.typeAnnotation||"assert")}if(!(i instanceof an)&&"resolvedImage"!==i.type.kind&&Rr(i)){const t=new gn(this._scope,this.options);try{i=new an(i.type,i.evaluate(t))}catch(e){return this.error(e.message),null}}return i}return fn.parse(["to-array",e],this)}return this.error(void 0===e?"'undefined' value invalid. Use null instead.":"object"==typeof e?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found ".concat(typeof e," instead."))}concat(e,t,n,r){let i="number"==typeof e?this.path.concat(e):this.path;i="string"==typeof t?i.concat(t):i;const o=r?this.scope.concat(r):this.scope;return new Lr(this.registry,i,n||null,o,this.errors,this._scope,this.options)}error(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i="".concat(this.key).concat(n.map((e=>"[".concat(e,"]"))).join(""));this.errors.push(new Ot(i,e))}checkSubtype(e,t){const n=Xt(e,t);return n&&this.error(n),n}}var zr=Lr;function Rr(e){if(e instanceof Dr)return Rr(e.boundExpression);if(e instanceof yn&&"error"===e.name)return!1;if(e instanceof vn)return!1;if(e instanceof Vn)return!1;if(e instanceof Mr)return!1;if(e instanceof Cr)return!1;const t=e instanceof fn||e instanceof cn;let n=!0;return e.eachChild((e=>{n=t?n&&Rr(e):n&&e instanceof an})),!!n&&jr(e)&&Nr(e,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function Fr(e,t){const n=e.length-1;let r,i,o=0,a=n,s=0;for(;o<=a;)if(s=Math.floor((o+a)/2),r=e[s],i=e[s+1],r<=t){if(s===n||t<i)return s;o=s+1}else{if(!(r>t))throw new sn("Input is not a number.");a=s-1}return 0}class Br{constructor(e,t,n){this.type=e,this.input=t,this.labels=[],this.outputs=[];for(const[r,i]of n)this.labels.push(r),this.outputs.push(i)}static parse(e,t){if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only ".concat(e.length-1,"."));if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");const n=t.parse(e[1],1,Lt);if(!n)return null;const r=[];let i=null;t.expectedType&&"value"!==t.expectedType.kind&&(i=t.expectedType);for(let o=1;o<e.length;o+=2){const n=1===o?-1/0:e[o],a=e[o+1],s=o,l=o+1;if("number"!=typeof n)return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',s);if(r.length&&r[r.length-1][0]>=n)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',s);const c=t.parse(a,l,i);if(!c)return null;i=i||c.type,r.push([n,c])}return new Br(i,n,r)}evaluate(e){const t=this.labels,n=this.outputs;if(1===t.length)return n[0].evaluate(e);const r=this.input.evaluate(e);if(r<=t[0])return n[0].evaluate(e);const i=t.length;return r>=t[i-1]?n[i-1].evaluate(e):n[Fr(t,r)].evaluate(e)}eachChild(e){e(this.input);for(const t of this.outputs)e(t)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))}serialize(){const e=["step",this.input.serialize()];for(let t=0;t<this.labels.length;t++)t>0&&e.push(this.labels[t]),e.push(this.outputs[t].serialize());return e}}const Vr=.95047,Ur=1.08883,Gr=4/29,Hr=6/29,Zr=3*Hr*Hr,qr=Hr*Hr*Hr,Wr=Math.PI/180,Xr=180/Math.PI;function Yr(e){return e>qr?Math.pow(e,1/3):e/Zr+Gr}function Kr(e){return e>Hr?e*e*e:Zr*(e-Gr)}function Jr(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Qr(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function $r(e){const t=Qr(e.r),n=Qr(e.g),r=Qr(e.b),i=Yr((.4124564*t+.3575761*n+.1804375*r)/Vr),o=Yr((.2126729*t+.7151522*n+.072175*r)/1);return{l:116*o-16,a:500*(i-o),b:200*(o-Yr((.0193339*t+.119192*n+.9503041*r)/Ur)),alpha:e.a}}function ei(e){let t=(e.l+16)/116,n=isNaN(e.a)?t:t+e.a/500,r=isNaN(e.b)?t:t-e.b/200;return t=1*Kr(t),n=Vr*Kr(n),r=Ur*Kr(r),new Mt(Jr(3.2404542*n-1.5371385*t-.4985314*r),Jr(-.969266*n+1.8760108*t+.041556*r),Jr(.0556434*n-.2040259*t+1.0572252*r),e.alpha)}function ti(e,t,n){const r=t-e;return e+n*(r>180||r<-180?r-360*Math.round(r/360):r)}const ni={forward:$r,reverse:ei,interpolate:function(e,t,n){return{l:kt(e.l,t.l,n),a:kt(e.a,t.a,n),b:kt(e.b,t.b,n),alpha:kt(e.alpha,t.alpha,n)}}},ri={forward:function(e){const{l:t,a:n,b:r}=$r(e),i=Math.atan2(r,n)*Xr;return{h:i<0?i+360:i,c:Math.sqrt(n*n+r*r),l:t,alpha:e.a}},reverse:function(e){const t=e.h*Wr,n=e.c;return ei({l:e.l,a:Math.cos(t)*n,b:Math.sin(t)*n,alpha:e.alpha})},interpolate:function(e,t,n){return{h:ti(e.h,t.h,n),c:kt(e.c,t.c,n),l:kt(e.l,t.l,n),alpha:kt(e.alpha,t.alpha,n)}}};var ii=Object.freeze({__proto__:null,hcl:ri,lab:ni});class oi{constructor(e,t,n,r,i){this.type=e,this.operator=t,this.interpolation=n,this.input=r,this.labels=[],this.outputs=[];for(const[o,a]of i)this.labels.push(o),this.outputs.push(a)}static interpolationFactor(e,t,n,r){let i=0;if("exponential"===e.name)i=ai(t,e.base,n,r);else if("linear"===e.name)i=ai(t,1,n,r);else if("cubic-bezier"===e.name){const o=e.controlPoints;i=new U(o[0],o[1],o[2],o[3]).solve(ai(t,1,n,r))}return i}static parse(e,t){let[n,r,i,...o]=e;if(!Array.isArray(r)||0===r.length)return t.error("Expected an interpolation type expression.",1);if("linear"===r[0])r={name:"linear"};else if("exponential"===r[0]){const e=r[1];if("number"!=typeof e)return t.error("Exponential interpolation requires a numeric base.",1,1);r={name:"exponential",base:e}}else{if("cubic-bezier"!==r[0])return t.error("Unknown interpolation type ".concat(String(r[0])),1,0);{const e=r.slice(1);if(4!==e.length||e.some((e=>"number"!=typeof e||e<0||e>1)))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);r={name:"cubic-bezier",controlPoints:e}}}if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only ".concat(e.length-1,"."));if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(i=t.parse(i,2,Lt),!i)return null;const a=[];let s=null;"interpolate-hcl"===n||"interpolate-lab"===n?s=Ft:t.expectedType&&"value"!==t.expectedType.kind&&(s=t.expectedType);for(let l=0;l<o.length;l+=2){const e=o[l],n=o[l+1],r=l+3,i=l+4;if("number"!=typeof e)return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',r);if(a.length&&a[a.length-1][0]>=e)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',r);const c=t.parse(n,i,s);if(!c)return null;s=s||c.type,a.push([e,c])}return"number"===s.kind||"color"===s.kind||"array"===s.kind&&"number"===s.itemType.kind&&"number"==typeof s.N?new oi(s,n,r,i,a):t.error("Type ".concat(qt(s)," is not interpolatable."))}evaluate(e){const t=this.labels,n=this.outputs;if(1===t.length)return n[0].evaluate(e);const r=this.input.evaluate(e);if(r<=t[0])return n[0].evaluate(e);const i=t.length;if(r>=t[i-1])return n[i-1].evaluate(e);const o=Fr(t,r),a=oi.interpolationFactor(this.interpolation,r,t[o],t[o+1]),s=n[o].evaluate(e),l=n[o+1].evaluate(e);return"interpolate"===this.operator?jt[this.type.kind.toLowerCase()](s,l,a):"interpolate-hcl"===this.operator?ri.reverse(ri.interpolate(ri.forward(s),ri.forward(l),a)):ni.reverse(ni.interpolate(ni.forward(s),ni.forward(l),a))}eachChild(e){e(this.input);for(const t of this.outputs)e(t)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))}serialize(){let e;e="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const t=[this.operator,e,this.input.serialize()];for(let n=0;n<this.labels.length;n++)t.push(this.labels[n],this.outputs[n].serialize());return t}}function ai(e,t,n,r){const i=r-n,o=e-n;return 0===i?0:1===t?o/i:(Math.pow(t,o)-1)/(Math.pow(t,i)-1)}class si{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expectected at least one argument.");let n=null;const r=t.expectedType;r&&"value"!==r.kind&&(n=r);const i=[];for(const a of e.slice(1)){const e=t.parse(a,1+i.length,n,void 0,{typeAnnotation:"omit"});if(!e)return null;n=n||e.type,i.push(e)}const o=r&&i.some((e=>Xt(r,e.type)));return new si(o?Vt:n,i)}evaluate(e){let t,n=null,r=0;for(const i of this.args){if(r++,n=i.evaluate(e),n&&n instanceof en&&!n.available&&(t||(t=n),n=null,r===this.args.length))return t;if(null!==n)break}return n}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}serialize(){const e=["coalesce"];return this.eachChild((t=>{e.push(t.serialize())})),e}}class li{constructor(e,t){this.type=t.type,this.bindings=[].concat(e),this.result=t}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const t of this.bindings)e(t[1]);e(this.result)}static parse(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found ".concat(e.length-1," instead."));const n=[];for(let i=1;i<e.length-1;i+=2){const r=e[i];if("string"!=typeof r)return t.error("Expected string, but found ".concat(typeof r," instead."),i);if(/[^a-zA-Z0-9_]/.test(r))return t.error("Variable names must contain only alphanumeric characters or '_'.",i);const o=t.parse(e[i+1],i+1);if(!o)return null;n.push([r,o])}const r=t.parse(e[e.length-1],e.length-1,t.expectedType,n);return r?new li(n,r):null}outputDefined(){return this.result.outputDefined()}serialize(){const e=["let"];for(const[t,n]of this.bindings)e.push(t,n.serialize());return e.push(this.result.serialize()),e}}class ci{constructor(e,t,n){this.type=e,this.index=t,this.input=n}static parse(e,t){if(3!==e.length)return t.error("Expected 2 arguments, but found ".concat(e.length-1," instead."));const n=t.parse(e[1],1,Lt),r=t.parse(e[2],2,Zt(t.expectedType||Vt));return n&&r?new ci(r.type.itemType,n,r):null}evaluate(e){const t=this.index.evaluate(e),n=this.input.evaluate(e);if(t<0)throw new sn("Array index out of bounds: ".concat(t," < 0."));if(t>n.length-1)throw new sn("Array index out of bounds: ".concat(t," > ").concat(n.length-1,"."));if(t===Math.floor(t))return n[t];const r=Math.floor(t),i=Math.ceil(t),o=n[r],a=n[i];if("number"!=typeof o||"number"!=typeof a)throw new sn("Cannot interpolate between non-number values at index ".concat(t,"."));const s=t-r;return o*(1-s)+a*s}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class ui{constructor(e,t){this.type=Rt,this.needle=e,this.haystack=t}static parse(e,t){if(3!==e.length)return t.error("Expected 2 arguments, but found ".concat(e.length-1," instead."));const n=t.parse(e[1],1,Vt),r=t.parse(e[2],2,Vt);return n&&r?Yt(n.type,[Rt,zt,Lt,Dt,Vt])?new ui(n,r):t.error("Expected first argument to be of type boolean, string, number or null, but found ".concat(qt(n.type)," instead")):null}evaluate(e){const t=this.needle.evaluate(e),n=this.haystack.evaluate(e);if(null==n)return!1;if(!Kt(t,["boolean","string","number","null"]))throw new sn("Expected first argument to be of type boolean, string, number or null, but found ".concat(qt(rn(t))," instead."));if(!Kt(n,["string","array"]))throw new sn("Expected second argument to be of type array or string, but found ".concat(qt(rn(n))," instead."));return n.indexOf(t)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class hi{constructor(e,t,n){this.type=Lt,this.needle=e,this.haystack=t,this.fromIndex=n}static parse(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found ".concat(e.length-1," instead."));const n=t.parse(e[1],1,Vt),r=t.parse(e[2],2,Vt);if(!n||!r)return null;if(!Yt(n.type,[Rt,zt,Lt,Dt,Vt]))return t.error("Expected first argument to be of type boolean, string, number or null, but found ".concat(qt(n.type)," instead"));if(4===e.length){const i=t.parse(e[3],3,Lt);return i?new hi(n,r,i):null}return new hi(n,r)}evaluate(e){const t=this.needle.evaluate(e),n=this.haystack.evaluate(e);if(!Kt(t,["boolean","string","number","null"]))throw new sn("Expected first argument to be of type boolean, string, number or null, but found ".concat(qt(rn(t))," instead."));if(!Kt(n,["string","array"]))throw new sn("Expected second argument to be of type array or string, but found ".concat(qt(rn(n))," instead."));if(this.fromIndex){const r=this.fromIndex.evaluate(e);return n.indexOf(t,r)}return n.indexOf(t)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class di{constructor(e,t,n,r,i,o){this.inputType=e,this.type=t,this.input=n,this.cases=r,this.outputs=i,this.otherwise=o}static parse(e,t){if(e.length<5)return t.error("Expected at least 4 arguments, but found only ".concat(e.length-1,"."));if(e.length%2!=1)return t.error("Expected an even number of arguments.");let n,r;t.expectedType&&"value"!==t.expectedType.kind&&(r=t.expectedType);const i={},o=[];for(let l=2;l<e.length-1;l+=2){let a=e[l];const s=e[l+1];Array.isArray(a)||(a=[a]);const c=t.concat(l);if(0===a.length)return c.error("Expected at least one branch label.");for(const e of a){if("number"!=typeof e&&"string"!=typeof e)return c.error("Branch labels must be numbers or strings.");if("number"==typeof e&&Math.abs(e)>Number.MAX_SAFE_INTEGER)return c.error("Branch labels must be integers no larger than ".concat(Number.MAX_SAFE_INTEGER,"."));if("number"==typeof e&&Math.floor(e)!==e)return c.error("Numeric branch labels must be integer values.");if(n){if(c.checkSubtype(n,rn(e)))return null}else n=rn(e);if(void 0!==i[String(e)])return c.error("Branch labels must be unique.");i[String(e)]=o.length}const u=t.parse(s,l,r);if(!u)return null;r=r||u.type,o.push(u)}const a=t.parse(e[1],1,Vt);if(!a)return null;const s=t.parse(e[e.length-1],e.length-1,r);return s?"value"!==a.type.kind&&t.concat(1).checkSubtype(n,a.type)?null:new di(n,r,a,i,o,s):null}evaluate(e){const t=this.input.evaluate(e);return(rn(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))&&this.otherwise.outputDefined()}serialize(){const e=["match",this.input.serialize()],t=Object.keys(this.cases).sort(),n=[],r={};for(const o of t){const e=r[this.cases[o]];void 0===e?(r[this.cases[o]]=n.length,n.push([this.cases[o],[o]])):n[e][1].push(o)}const i=e=>"number"===this.inputType.kind?Number(e):e;for(const[o,a]of n)e.push(1===a.length?i(a[0]):a.map(i)),e.push(this.outputs[o].serialize());return e.push(this.otherwise.serialize()),e}}class pi{constructor(e,t,n){this.type=e,this.branches=t,this.otherwise=n}static parse(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found only ".concat(e.length-1,"."));if(e.length%2!=0)return t.error("Expected an odd number of arguments.");let n;t.expectedType&&"value"!==t.expectedType.kind&&(n=t.expectedType);const r=[];for(let o=1;o<e.length-1;o+=2){const i=t.parse(e[o],o,Rt);if(!i)return null;const a=t.parse(e[o+1],o+1,n);if(!a)return null;r.push([i,a]),n=n||a.type}const i=t.parse(e[e.length-1],e.length-1,n);return i?new pi(n,r,i):null}evaluate(e){for(const[t,n]of this.branches)if(t.evaluate(e))return n.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[t,n]of this.branches)e(t),e(n);e(this.otherwise)}outputDefined(){return this.branches.every((e=>{let[t,n]=e;return n.outputDefined()}))&&this.otherwise.outputDefined()}serialize(){const e=["case"];return this.eachChild((t=>{e.push(t.serialize())})),e}}class fi{constructor(e,t,n,r){this.type=e,this.input=t,this.beginIndex=n,this.endIndex=r}static parse(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found ".concat(e.length-1," instead."));const n=t.parse(e[1],1,Vt),r=t.parse(e[2],2,Lt);if(!n||!r)return null;if(!Yt(n.type,[Zt(Vt),zt,Vt]))return t.error("Expected first argument to be of type array or string, but found ".concat(qt(n.type)," instead"));if(4===e.length){const i=t.parse(e[3],3,Lt);return i?new fi(n.type,n,r,i):null}return new fi(n.type,n,r)}evaluate(e){const t=this.input.evaluate(e),n=this.beginIndex.evaluate(e);if(!Kt(t,["string","array"]))throw new sn("Expected first argument to be of type array or string, but found ".concat(qt(rn(t))," instead."));if(this.endIndex){const r=this.endIndex.evaluate(e);return t.slice(n,r)}return t.slice(n)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function mi(e,t){return"=="===e||"!="===e?"boolean"===t.kind||"string"===t.kind||"number"===t.kind||"null"===t.kind||"value"===t.kind:"string"===t.kind||"number"===t.kind||"value"===t.kind}function gi(e,t,n,r){return 0===r.compare(t,n)}function yi(e,t,n){const r="=="!==e&&"!="!==e;return class i{constructor(e,t,n){this.type=Rt,this.lhs=e,this.rhs=t,this.collator=n,this.hasUntypedArgument="value"===e.type.kind||"value"===t.type.kind}static parse(e,t){if(3!==e.length&&4!==e.length)return t.error("Expected two or three arguments.");const n=e[0];let o=t.parse(e[1],1,Vt);if(!o)return null;if(!mi(n,o.type))return t.concat(1).error('"'.concat(n,"\" comparisons are not supported for type '").concat(qt(o.type),"'."));let a=t.parse(e[2],2,Vt);if(!a)return null;if(!mi(n,a.type))return t.concat(2).error('"'.concat(n,"\" comparisons are not supported for type '").concat(qt(a.type),"'."));if(o.type.kind!==a.type.kind&&"value"!==o.type.kind&&"value"!==a.type.kind)return t.error("Cannot compare types '".concat(qt(o.type),"' and '").concat(qt(a.type),"'."));r&&("value"===o.type.kind&&"value"!==a.type.kind?o=new cn(a.type,[o]):"value"!==o.type.kind&&"value"===a.type.kind&&(a=new cn(o.type,[a])));let s=null;if(4===e.length){if("string"!==o.type.kind&&"string"!==a.type.kind&&"value"!==o.type.kind&&"value"!==a.type.kind)return t.error("Cannot use collator to compare non-string types.");if(s=t.parse(e[3],3,Ut),!s)return null}return new i(o,a,s)}evaluate(i){const o=this.lhs.evaluate(i),a=this.rhs.evaluate(i);if(r&&this.hasUntypedArgument){const t=rn(o),n=rn(a);if(t.kind!==n.kind||"string"!==t.kind&&"number"!==t.kind)throw new sn('Expected arguments for "'.concat(e,'" to be (string, string) or (number, number), but found (').concat(t.kind,", ").concat(n.kind,") instead."))}if(this.collator&&!r&&this.hasUntypedArgument){const e=rn(o),n=rn(a);if("string"!==e.kind||"string"!==n.kind)return t(i,o,a)}return this.collator?n(i,o,a,this.collator.evaluate(i)):t(i,o,a)}eachChild(e){e(this.lhs),e(this.rhs),this.collator&&e(this.collator)}outputDefined(){return!0}serialize(){const t=[e];return this.eachChild((e=>{t.push(e.serialize())})),t}}}const _i=yi("==",(function(e,t,n){return t===n}),gi),vi=yi("!=",(function(e,t,n){return t!==n}),(function(e,t,n,r){return!gi(0,t,n,r)})),xi=yi("<",(function(e,t,n){return t<n}),(function(e,t,n,r){return r.compare(t,n)<0})),bi=yi(">",(function(e,t,n){return t>n}),(function(e,t,n,r){return r.compare(t,n)>0})),wi=yi("<=",(function(e,t,n){return t<=n}),(function(e,t,n,r){return r.compare(t,n)<=0})),Si=yi(">=",(function(e,t,n){return t>=n}),(function(e,t,n,r){return r.compare(t,n)>=0}));class Ti{constructor(e,t,n,r,i,o){this.type=zt,this.number=e,this.locale=t,this.currency=n,this.unit=r,this.minFractionDigits=i,this.maxFractionDigits=o}static parse(e,t){if(3!==e.length)return t.error("Expected two arguments.");const n=t.parse(e[1],1,Lt);if(!n)return null;const r=e[2];if("object"!=typeof r||Array.isArray(r))return t.error("NumberFormat options argument must be an object.");let i=null;if(r.locale&&(i=t.parseObjectValue(r.locale,2,"locale",zt),!i))return null;let o=null;if(r.currency&&(o=t.parseObjectValue(r.currency,2,"currency",zt),!o))return null;let a=null;if(r.unit&&(a=t.parseObjectValue(r.unit,2,"unit",zt),!a))return null;let s=null;if(r["min-fraction-digits"]&&(s=t.parseObjectValue(r["min-fraction-digits"],2,"min-fraction-digits",Lt),!s))return null;let l=null;return r["max-fraction-digits"]&&(l=t.parseObjectValue(r["max-fraction-digits"],2,"max-fraction-digits",Lt),!l)?null:new Ti(n,i,o,a,s,l)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(e):void 0,unit:this.unit?this.unit.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.unit&&e(this.unit),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.unit&&(e.unit=this.unit.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]}}class Ei{constructor(e){this.type=Lt,this.input=e}static parse(e,t){if(2!==e.length)return t.error("Expected 1 argument, but found ".concat(e.length-1," instead."));const n=t.parse(e[1],1);return n?"array"!==n.type.kind&&"string"!==n.type.kind&&"value"!==n.type.kind?t.error("Expected argument of type string or array, but found ".concat(qt(n.type)," instead.")):new Ei(n):null}evaluate(e){const t=this.input.evaluate(e);if("string"==typeof t)return t.length;if(Array.isArray(t))return t.length;throw new sn("Expected value to be of type string or array, but found ".concat(qt(rn(t))," instead."))}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){const e=["length"];return this.eachChild((t=>{e.push(t.serialize())})),e}}function Ai(e){return function(){e=1831565813+(e|=0)|0;let t=Math.imul(e^e>>>15,1|e);return t=t+Math.imul(t^t>>>7,61|t)^t,((t^t>>>14)>>>0)/4294967296}}const Mi={"==":_i,"!=":vi,">":bi,"<":xi,">=":Si,"<=":wi,array:cn,at:ci,boolean:cn,case:pi,coalesce:si,collator:vn,format:un,image:hn,in:ui,"index-of":hi,interpolate:oi,"interpolate-hcl":oi,"interpolate-lab":oi,length:Ei,let:li,literal:an,match:di,number:cn,"number-format":Ti,object:cn,slice:fi,step:Br,string:cn,"to-boolean":fn,"to-color":fn,"to-number":fn,"to-string":fn,var:Dr,within:Vn,distance:Mr,config:Cr};function Pi(e,t){let[n,r,i,o]=t;n=n.evaluate(e),r=r.evaluate(e),i=i.evaluate(e);const a=o?o.evaluate(e):1,s=tn(n,r,i,a);if(s)throw new sn(s);return new Mt(n/255*a,r/255*a,i/255*a,a)}function ki(e,t){let[n,r,i,o]=t;n=n.evaluate(e),r=r.evaluate(e),i=i.evaluate(e);const a=o?o.evaluate(e):1,s=function(e,t,n,r){return"number"==typeof e&&e>=0&&e<=360?"number"==typeof t&&t>=0&&t<=100&&"number"==typeof n&&n>=0&&n<=100?void 0===r||"number"==typeof r&&r>=0&&r<=1?null:"Invalid hsla value [".concat([e,t,n,r].join(", "),"]: 'a' must be between 0 and 1."):"Invalid hsla value [".concat(("number"==typeof r?[e,t,n,r]:[e,t,n]).join(", "),"]: 's', and 'l' must be between 0 and 100."):"Invalid hsla value [".concat(("number"==typeof r?[e,t,n,r]:[e,t,n]).join(", "),"]: 'h' must be between 0 and 360.")}(n,r,i,a);if(s)throw new sn(s);const l="hsla(".concat(n,", ").concat(r,"%, ").concat(i,"%, ").concat(a,")"),c=Mt.parse(l);if(!c)throw new sn("Failed to parse HSLA color: ".concat(l));return c}function Ci(e,t){return e in t}function ji(e,t){const n=t[e];return void 0===n?null:n}function Ii(e){return{type:e}}function Oi(e){return{result:"success",value:e}}function Ni(e){return{result:"error",value:e}}function Di(e,t){return!!e&&!!e.parameters&&e.parameters.indexOf(t)>-1}function Li(e){return"data-driven"===e["property-type"]}function zi(e){return Di(e.expression,"measure-light")}function Ri(e){return Di(e.expression,"zoom")}function Fi(e){return!!e.expression&&e.expression.interpolated}function Bi(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}function Vi(e){return e}function Ui(e,t){const n="color"===t.type,r=e.stops&&"object"==typeof e.stops[0][0],i=r||!(r||void 0!==e.property),o=e.type||(Fi(t)?"exponential":"interval");if(n&&((e=It({},e)).stops&&(e.stops=e.stops.map((e=>[e[0],Mt.parse(e[1])]))),e.default=Mt.parse(e.default?e.default:t.default)),e.colorSpace&&"rgb"!==e.colorSpace&&!ii[e.colorSpace])throw new Error("Unknown color space: ".concat(e.colorSpace));let a,s,l;if("exponential"===o)a=qi;else if("interval"===o)a=Zi;else if("categorical"===o){a=Hi,s=Object.create(null);for(const t of e.stops)s[t[0]]=t[1];l=typeof e.stops[0][0]}else{if("identity"!==o)throw new Error('Unknown function type "'.concat(o,'"'));a=Wi}if(r){const n={},r=[];for(let t=0;t<e.stops.length;t++){const i=e.stops[t],o=i[0].zoom;void 0===n[o]&&(n[o]={zoom:o,type:e.type,property:e.property,default:e.default,stops:[]},r.push(o)),n[o].stops.push([i[0].value,i[1]])}const i=[];for(const e of r)i.push([n[e].zoom,Ui(n[e],t)]);const o={name:"linear"};return{kind:"composite",interpolationType:o,interpolationFactor:oi.interpolationFactor.bind(void 0,o),zoomStops:i.map((e=>e[0])),evaluate:(n,r)=>{let{zoom:o}=n;return qi({stops:i,base:e.base},t,o).evaluate(o,r)}}}if(i){const n="exponential"===o?{name:"exponential",base:void 0!==e.base?e.base:1}:null;return{kind:"camera",interpolationType:n,interpolationFactor:oi.interpolationFactor.bind(void 0,n),zoomStops:e.stops.map((e=>e[0])),evaluate:n=>{let{zoom:r}=n;return a(e,t,r,s,l)}}}return{kind:"source",evaluate(n,r){const i=r&&r.properties?r.properties[e.property]:void 0;return void 0===i?Gi(e.default,t.default):a(e,t,i,s,l)}}}function Gi(e,t,n){return void 0!==e?e:void 0!==t?t:void 0!==n?n:void 0}function Hi(e,t,n,r,i){return Gi(typeof n===i?r[n]:void 0,e.default,t.default)}function Zi(e,t,n){if("number"!==dn(n))return Gi(e.default,t.default);const r=e.stops.length;if(1===r)return e.stops[0][1];if(n<=e.stops[0][0])return e.stops[0][1];if(n>=e.stops[r-1][0])return e.stops[r-1][1];const i=Fr(e.stops.map((e=>e[0])),n);return e.stops[i][1]}function qi(e,t,n){const r=void 0!==e.base?e.base:1;if("number"!==dn(n))return Gi(e.default,t.default);const i=e.stops.length;if(1===i)return e.stops[0][1];if(n<=e.stops[0][0])return e.stops[0][1];if(n>=e.stops[i-1][0])return e.stops[i-1][1];const o=Fr(e.stops.map((e=>e[0])),n),a=function(e,t,n,r){const i=r-n,o=e-n;return 0===i?0:1===t?o/i:(Math.pow(t,o)-1)/(Math.pow(t,i)-1)}(n,r,e.stops[o][0],e.stops[o+1][0]),s=e.stops[o][1],l=e.stops[o+1][1];let c=jt[t.type]||Vi;if(e.colorSpace&&"rgb"!==e.colorSpace){const t=ii[e.colorSpace];c=(e,n)=>t.reverse(t.interpolate(t.forward(e),t.forward(n),a))}return"function"==typeof s.evaluate?{evaluate(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=s.evaluate.apply(void 0,t),i=l.evaluate.apply(void 0,t);if(void 0!==r&&void 0!==i)return c(r,i,a)}}:c(s,l,a)}function Wi(e,t,n){return"color"===t.type?n=Mt.parse(n):"formatted"===t.type?n=$t.fromString(n.toString()):"resolvedImage"===t.type?n=en.fromString(n.toString()):dn(n)===t.type||"enum"===t.type&&t.values[n]||(n=void 0),Gi(n,e.default,t.default)}yn.register(Mi,{error:[{kind:"error"},[zt],(e,t)=>{let[n]=t;throw new sn(n.evaluate(e))}],typeof:[zt,[Vt],(e,t)=>{let[n]=t;return qt(rn(n.evaluate(e)))}],"to-rgba":[Zt(Lt,4),[Ft],(e,t)=>{let[n]=t;return n.evaluate(e).toRenderColor(null).toArray()}],rgb:[Ft,[Lt,Lt,Lt],Pi],rgba:[Ft,[Lt,Lt,Lt,Lt],Pi],hsl:[Ft,[Lt,Lt,Lt],ki],hsla:[Ft,[Lt,Lt,Lt,Lt],ki],has:{type:Rt,overloads:[[[zt],(e,t)=>{let[n]=t;return Ci(n.evaluate(e),e.properties())}],[[zt,Bt],(e,t)=>{let[n,r]=t;return Ci(n.evaluate(e),r.evaluate(e))}]]},get:{type:Vt,overloads:[[[zt],(e,t)=>{let[n]=t;return ji(n.evaluate(e),e.properties())}],[[zt,Bt],(e,t)=>{let[n,r]=t;return ji(n.evaluate(e),r.evaluate(e))}]]},"feature-state":[Vt,[zt],(e,t)=>{let[n]=t;return ji(n.evaluate(e),e.featureState||{})}],properties:[Bt,[],e=>e.properties()],"geometry-type":[zt,[],e=>e.geometryType()],id:[Vt,[],e=>e.id()],zoom:[Lt,[],e=>e.globals.zoom],pitch:[Lt,[],e=>e.globals.pitch||0],"distance-from-center":[Lt,[],e=>e.distanceFromCenter()],"measure-light":[Lt,[zt],(e,t)=>{let[n]=t;return e.measureLight(n.evaluate(e))}],"heatmap-density":[Lt,[],e=>e.globals.heatmapDensity||0],"line-progress":[Lt,[],e=>e.globals.lineProgress||0],"raster-value":[Lt,[],e=>e.globals.rasterValue||0],"raster-particle-speed":[Lt,[],e=>e.globals.rasterParticleSpeed||0],"sky-radial-progress":[Lt,[],e=>e.globals.skyRadialProgress||0],accumulated:[Vt,[],e=>void 0===e.globals.accumulated?null:e.globals.accumulated],"+":[Lt,Ii(Lt),(e,t)=>{let n=0;for(const r of t)n+=r.evaluate(e);return n}],"*":[Lt,Ii(Lt),(e,t)=>{let n=1;for(const r of t)n*=r.evaluate(e);return n}],"-":{type:Lt,overloads:[[[Lt,Lt],(e,t)=>{let[n,r]=t;return n.evaluate(e)-r.evaluate(e)}],[[Lt],(e,t)=>{let[n]=t;return-n.evaluate(e)}]]},"/":[Lt,[Lt,Lt],(e,t)=>{let[n,r]=t;return n.evaluate(e)/r.evaluate(e)}],"%":[Lt,[Lt,Lt],(e,t)=>{let[n,r]=t;return n.evaluate(e)%r.evaluate(e)}],ln2:[Lt,[],()=>Math.LN2],pi:[Lt,[],()=>Math.PI],e:[Lt,[],()=>Math.E],"^":[Lt,[Lt,Lt],(e,t)=>{let[n,r]=t;return Math.pow(n.evaluate(e),r.evaluate(e))}],sqrt:[Lt,[Lt],(e,t)=>{let[n]=t;return Math.sqrt(n.evaluate(e))}],log10:[Lt,[Lt],(e,t)=>{let[n]=t;return Math.log(n.evaluate(e))/Math.LN10}],ln:[Lt,[Lt],(e,t)=>{let[n]=t;return Math.log(n.evaluate(e))}],log2:[Lt,[Lt],(e,t)=>{let[n]=t;return Math.log(n.evaluate(e))/Math.LN2}],sin:[Lt,[Lt],(e,t)=>{let[n]=t;return Math.sin(n.evaluate(e))}],cos:[Lt,[Lt],(e,t)=>{let[n]=t;return Math.cos(n.evaluate(e))}],tan:[Lt,[Lt],(e,t)=>{let[n]=t;return Math.tan(n.evaluate(e))}],asin:[Lt,[Lt],(e,t)=>{let[n]=t;return Math.asin(n.evaluate(e))}],acos:[Lt,[Lt],(e,t)=>{let[n]=t;return Math.acos(n.evaluate(e))}],atan:[Lt,[Lt],(e,t)=>{let[n]=t;return Math.atan(n.evaluate(e))}],min:[Lt,Ii(Lt),(e,t)=>Math.min(...t.map((t=>t.evaluate(e))))],max:[Lt,Ii(Lt),(e,t)=>Math.max(...t.map((t=>t.evaluate(e))))],abs:[Lt,[Lt],(e,t)=>{let[n]=t;return Math.abs(n.evaluate(e))}],round:[Lt,[Lt],(e,t)=>{let[n]=t;const r=n.evaluate(e);return r<0?-Math.round(-r):Math.round(r)}],floor:[Lt,[Lt],(e,t)=>{let[n]=t;return Math.floor(n.evaluate(e))}],ceil:[Lt,[Lt],(e,t)=>{let[n]=t;return Math.ceil(n.evaluate(e))}],"filter-==":[Rt,[zt,Vt],(e,t)=>{let[n,r]=t;return e.properties()[n.value]===r.value}],"filter-id-==":[Rt,[Vt],(e,t)=>{let[n]=t;return e.id()===n.value}],"filter-type-==":[Rt,[zt],(e,t)=>{let[n]=t;return e.geometryType()===n.value}],"filter-<":[Rt,[zt,Vt],(e,t)=>{let[n,r]=t;const i=e.properties()[n.value],o=r.value;return typeof i==typeof o&&i<o}],"filter-id-<":[Rt,[Vt],(e,t)=>{let[n]=t;const r=e.id(),i=n.value;return typeof r==typeof i&&r<i}],"filter->":[Rt,[zt,Vt],(e,t)=>{let[n,r]=t;const i=e.properties()[n.value],o=r.value;return typeof i==typeof o&&i>o}],"filter-id->":[Rt,[Vt],(e,t)=>{let[n]=t;const r=e.id(),i=n.value;return typeof r==typeof i&&r>i}],"filter-<=":[Rt,[zt,Vt],(e,t)=>{let[n,r]=t;const i=e.properties()[n.value],o=r.value;return typeof i==typeof o&&i<=o}],"filter-id-<=":[Rt,[Vt],(e,t)=>{let[n]=t;const r=e.id(),i=n.value;return typeof r==typeof i&&r<=i}],"filter->=":[Rt,[zt,Vt],(e,t)=>{let[n,r]=t;const i=e.properties()[n.value],o=r.value;return typeof i==typeof o&&i>=o}],"filter-id->=":[Rt,[Vt],(e,t)=>{let[n]=t;const r=e.id(),i=n.value;return typeof r==typeof i&&r>=i}],"filter-has":[Rt,[Vt],(e,t)=>{let[n]=t;return n.value in e.properties()}],"filter-has-id":[Rt,[],e=>null!==e.id()&&void 0!==e.id()],"filter-type-in":[Rt,[Zt(zt)],(e,t)=>{let[n]=t;return n.value.indexOf(e.geometryType())>=0}],"filter-id-in":[Rt,[Zt(Vt)],(e,t)=>{let[n]=t;return n.value.indexOf(e.id())>=0}],"filter-in-small":[Rt,[zt,Zt(Vt)],(e,t)=>{let[n,r]=t;return r.value.indexOf(e.properties()[n.value])>=0}],"filter-in-large":[Rt,[zt,Zt(Vt)],(e,t)=>{let[n,r]=t;return function(e,t,n,r){for(;n<=r;){const i=n+r>>1;if(t[i]===e)return!0;t[i]>e?r=i-1:n=i+1}return!1}(e.properties()[n.value],r.value,0,r.value.length-1)}],all:{type:Rt,overloads:[[[Rt,Rt],(e,t)=>{let[n,r]=t;return n.evaluate(e)&&r.evaluate(e)}],[Ii(Rt),(e,t)=>{for(const n of t)if(!n.evaluate(e))return!1;return!0}]]},any:{type:Rt,overloads:[[[Rt,Rt],(e,t)=>{let[n,r]=t;return n.evaluate(e)||r.evaluate(e)}],[Ii(Rt),(e,t)=>{for(const n of t)if(n.evaluate(e))return!0;return!1}]]},"!":[Rt,[Rt],(e,t)=>{let[n]=t;return!n.evaluate(e)}],"is-supported-script":[Rt,[zt],(e,t)=>{let[n]=t;const r=e.globals&&e.globals.isSupportedScript;return!r||r(n.evaluate(e))}],upcase:[zt,[zt],(e,t)=>{let[n]=t;return n.evaluate(e).toUpperCase()}],downcase:[zt,[zt],(e,t)=>{let[n]=t;return n.evaluate(e).toLowerCase()}],concat:[zt,Ii(Vt),(e,t)=>t.map((t=>on(t.evaluate(e)))).join("")],"resolved-locale":[zt,[Ut],(e,t)=>{let[n]=t;return n.evaluate(e).resolvedLocale()}],random:[Lt,[Lt,Lt,Vt],(e,t)=>{const[n,r,i]=t.map((t=>t.evaluate(e)));if(n>r)return n;if(n===r)return n;let o;if("string"==typeof i)o=function(e){let t=0;if(0===e.length)return t;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return t}(i);else{if("number"!=typeof i)throw new sn("Invalid seed input: ".concat(i));o=i}return n+Ai(o)()*(r-n)}]});class Xi{constructor(e,t,n,r){this.expression=e,this._warningHistory={},this._evaluator=new gn(n,r),this._defaultValue=t?function(e){return"color"===e.type&&(Bi(e.default)||Array.isArray(e.default))?new Mt(0,0,0,0):"color"===e.type?Mt.parse(e.default)||null:void 0===e.default?null:e.default}(t):null,this._enumValues=t&&"enum"===t.type?t.values:null,this.configDependencies=Or(e)}evaluateWithoutErrorHandling(e,t,n,r,i,o,a,s){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=n,this._evaluator.canonical=r||null,this._evaluator.availableImages=i||null,this._evaluator.formattedSection=o,this._evaluator.featureTileCoord=a||null,this._evaluator.featureDistanceData=s||null,this.expression.evaluate(this._evaluator)}evaluate(e,t,n,r,i,o,a,s){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=n||null,this._evaluator.canonical=r||null,this._evaluator.availableImages=i||null,this._evaluator.formattedSection=o||null,this._evaluator.featureTileCoord=a||null,this._evaluator.featureDistanceData=s||null;try{const e=this.expression.evaluate(this._evaluator);if(null==e||"number"==typeof e&&e!=e)return this._defaultValue;if(this._enumValues&&!(e in this._enumValues))throw new sn("Expected value to be one of ".concat(Object.keys(this._enumValues).map((e=>JSON.stringify(e))).join(", "),", but found ").concat(JSON.stringify(e)," instead."));return e}catch(e){return this._warningHistory[e.message]||(this._warningHistory[e.message]=!0,"undefined"!=typeof console&&console.warn('Failed to evaluate expression "'.concat(JSON.stringify(this.expression.serialize()),'". ').concat(e.message))),this._defaultValue}}}function Yi(e){return Array.isArray(e)&&e.length>0&&"string"==typeof e[0]&&e[0]in Mi}function Ki(e,t,n,r){const i=new zr(Mi,[],t?function(e){const t={color:Ft,string:zt,number:Lt,enum:zt,boolean:Rt,formatted:Gt,resolvedImage:Ht};return"array"===e.type?Zt(t[e.value]||Vt,e.length):t[e.type]}(t):void 0,void 0,void 0,n,r),o=i.parse(e,void 0,void 0,void 0,t&&"string"===t.type?{typeAnnotation:"coerce"}:void 0);return o?Oi(new Xi(o,t,n,r)):Ni(i.errors)}class Ji{constructor(e,t,n){this.kind=e,this._styleExpression=t,this.isLightConstant=n,this.isStateDependent="constant"!==e&&!Ir(t.expression),this.configDependencies=Or(t.expression)}evaluateWithoutErrorHandling(e,t,n,r,i,o){return this._styleExpression.evaluateWithoutErrorHandling(e,t,n,r,i,o)}evaluate(e,t,n,r,i,o){return this._styleExpression.evaluate(e,t,n,r,i,o)}}class Qi{constructor(e,t,n,r,i){this.kind=e,this.zoomStops=n,this._styleExpression=t,this.isStateDependent="camera"!==e&&!Ir(t.expression),this.isLightConstant=i,this.configDependencies=Or(t.expression),this.interpolationType=r}evaluateWithoutErrorHandling(e,t,n,r,i,o){return this._styleExpression.evaluateWithoutErrorHandling(e,t,n,r,i,o)}evaluate(e,t,n,r,i,o){return this._styleExpression.evaluate(e,t,n,r,i,o)}interpolationFactor(e,t,n){return this.interpolationType?oi.interpolationFactor(this.interpolationType,e,t,n):0}}function $i(e,t,n,r){if("error"===(e=Ki(e,t,n,r)).result)return e;const i=e.value.expression,o=jr(i);if(!o&&!Li(t))return Ni([new Ot("","data expressions not supported")]);const a=Nr(i,["zoom","pitch","distance-from-center"]);if(!a&&!Ri(t))return Ni([new Ot("","zoom expressions not supported")]);const s=Nr(i,["measure-light"]);if(!s&&!zi(t))return Ni([new Ot("","measure-light expression not supported")]);const l=Nr(i,["line-progress"]);if(!l&&!function(e){return Di(e.expression,"line-progress")}(t))return Ni([new Ot("","line-progress expression not supported")]);const c=t.expression&&t.expression.relaxZoomRestriction,u=to(i);return u||a||c?u instanceof Ot?Ni([u]):u instanceof oi&&!Fi(t)?Ni([new Ot("",'"interpolate" expressions cannot be used with this property')]):Oi(u?new Qi(o&&l?"camera":"composite",e.value,u.labels,u instanceof oi?u.interpolation:void 0,s):new Ji(o&&l?"constant":"source",e.value,s)):Ni([new Ot("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class eo{constructor(e,t){this._parameters=e,this._specification=t,It(this,Ui(this._parameters,this._specification))}static deserialize(e){return new eo(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function to(e){let t=null;if(e instanceof li)t=to(e.result);else if(e instanceof si){for(const n of e.args)if(t=to(n),t)break}else(e instanceof Br||e instanceof oi)&&e.input instanceof yn&&"zoom"===e.input.name&&(t=e);return t instanceof Ot||e.eachChild((e=>{const n=to(e);n instanceof Ot?t=n:t&&n&&t!==n&&(t=new Ot("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),t}var no,ro,io=function(){if(ro)return no;ro=1,no=t;var e=3;function t(t,n,r){var i=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var o=new Int32Array(this.arrayBuffer);t=o[0],this.d=(n=o[1])+2*(r=o[2]);for(var a=0;a<this.d*this.d;a++){var s=o[e+a],l=o[e+a+1];i.push(s===l?null:o.subarray(s,l))}var c=o[e+i.length+1];this.keys=o.subarray(o[e+i.length],c),this.bboxes=o.subarray(c),this.insert=this._insertReadonly}else{this.d=n+2*r;for(var u=0;u<this.d*this.d;u++)i.push([]);this.keys=[],this.bboxes=[]}this.n=n,this.extent=t,this.padding=r,this.scale=n/t,this.uid=0;var h=r/n*t;this.min=-h,this.max=t+h}return t.prototype.insert=function(e,t,n,r,i){this._forEachCell(t,n,r,i,this._insertCell,this.uid++),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(n),this.bboxes.push(r),this.bboxes.push(i)},t.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},t.prototype._insertCell=function(e,t,n,r,i,o){this.cells[i].push(o)},t.prototype.query=function(e,t,n,r,i){var o=this.min,a=this.max;if(e<=o&&t<=o&&a<=n&&a<=r&&!i)return Array.prototype.slice.call(this.keys);var s=[];return this._forEachCell(e,t,n,r,this._queryCell,s,{},i),s},t.prototype._queryCell=function(e,t,n,r,i,o,a,s){var l=this.cells[i];if(null!==l)for(var c=this.keys,u=this.bboxes,h=0;h<l.length;h++){var d=l[h];if(void 0===a[d]){var p=4*d;(s?s(u[p+0],u[p+1],u[p+2],u[p+3]):e<=u[p+2]&&t<=u[p+3]&&n>=u[p+0]&&r>=u[p+1])?(a[d]=!0,o.push(c[d])):a[d]=!1}}},t.prototype._forEachCell=function(e,t,n,r,i,o,a,s){for(var l=this._convertToCellCoord(e),c=this._convertToCellCoord(t),u=this._convertToCellCoord(n),h=this._convertToCellCoord(r),d=l;d<=u;d++)for(var p=c;p<=h;p++){var f=this.d*p+d;if((!s||s(this._convertFromCellCoord(d),this._convertFromCellCoord(p),this._convertFromCellCoord(d+1),this._convertFromCellCoord(p+1)))&&i.call(this,e,t,n,r,f,o,a,s))return}},t.prototype._convertFromCellCoord=function(e){return(e-this.padding)/this.scale},t.prototype._convertToCellCoord=function(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))},t.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,n=e+this.cells.length+1+1,r=0,i=0;i<this.cells.length;i++)r+=this.cells[i].length;var o=new Int32Array(n+r+this.keys.length+this.bboxes.length);o[0]=this.extent,o[1]=this.n,o[2]=this.padding;for(var a=n,s=0;s<t.length;s++){var l=t[s];o[e+s]=a,o.set(l,a),a+=l.length}return o[e+t.length]=a,o.set(this.keys,a),o[e+t.length+1]=a+=this.keys.length,o.set(this.bboxes,a),a+=this.bboxes.length,o.buffer},no}(),oo=t(io);const ao={};function so(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.defineProperty(e,"_classRegistryKey",{value:t,writable:!1}),ao[t]={klass:e,omit:n.omit||[]}}so(Object,"Object"),oo.serialize=function(e,t){const n=e.toArrayBuffer();return t&&t.add(n),{buffer:n}},oo.deserialize=function(e){return new oo(e.buffer)},Object.defineProperty(oo,"name",{value:"Grid"}),so(oo,"Grid"),so(Mt,"Color"),so(Error,"Error"),so($t,"Formatted"),so(Qt,"FormattedSection"),so(nt,"AJAXError"),so(en,"ResolvedImage"),so(eo,"StylePropertyFunction"),so(Xi,"StyleExpression",{omit:["_evaluator"]}),so(Qi,"ZoomDependentExpression"),so(Ji,"ZoomConstantExpression"),so(yn,"CompoundExpression",{omit:["_evaluate"]});for(const i in Mi)ao[Mi[i]._classRegistryKey]||so(Mi[i],"Expression".concat(i));function lo(e){return e&&"undefined"!=typeof ArrayBuffer&&(e instanceof ArrayBuffer||e.constructor&&"ArrayBuffer"===e.constructor.name)}function co(e){return self.ImageBitmap&&e instanceof ImageBitmap}function uo(e,t){if(null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp)return e;if(lo(e)||co(e))return t&&t.add(e),e;if(ArrayBuffer.isView(e)){const n=e;return t&&t.add(n.buffer),n}if(e instanceof ImageData)return t&&t.add(e.data.buffer),e;if(Array.isArray(e)){const n=[];for(const r of e)n.push(uo(r,t));return n}if(e instanceof Map){const t={$name:"Map"};for(const[n,r]of e.entries())t[n]=uo(r);return t}if(e instanceof Set){const t={$name:"Set"};let n=0;for(const r of e.values())t[++n]=uo(r);return t}if("object"==typeof e){const n=e.constructor,r=n._classRegistryKey;if(!r)throw new Error("can't serialize object of unregistered class ".concat(r));const i=n.serialize?n.serialize(e,t):{};if(!n.serialize){for(const n in e)e.hasOwnProperty(n)&&(ao[r].omit.indexOf(n)>=0||(i[n]=uo(e[n],t)));e instanceof Error&&(i.message=e.message)}if(i.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==r&&(i.$name=r),i}throw new Error("can't serialize object of type "+typeof e)}function ho(e){if(null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||lo(e)||co(e)||ArrayBuffer.isView(e)||e instanceof ImageData)return e;if(Array.isArray(e))return e.map(ho);if("object"==typeof e){const t=e.$name||"Object";if("Map"===t){const t=new Map;for(const n of Object.keys(e))"$name"!==n&&t.set(n,ho(e[n]));return t}if("Set"===t){const t=new Set;for(const n of Object.keys(e))"$name"!==n&&t.add(ho(e[n]));return t}const{klass:n}=ao[t];if(!n)throw new Error("can't deserialize unregistered class ".concat(t));if(n.deserialize)return n.deserialize(e);const r=Object.create(n.prototype);for(const i of Object.keys(e))"$name"!==i&&(r[i]=ho(e[i]));return r}throw new Error("can't deserialize object of type "+typeof e)}const po={"Latin-1 Supplement":e=>e>=128&&e<=255,Arabic:e=>e>=1536&&e<=1791,"Arabic Supplement":e=>e>=1872&&e<=1919,"Arabic Extended-A":e=>e>=2208&&e<=2303,"Hangul Jamo":e=>e>=4352&&e<=4607,"Unified Canadian Aboriginal Syllabics":e=>e>=5120&&e<=5759,Khmer:e=>e>=6016&&e<=6143,"Unified Canadian Aboriginal Syllabics Extended":e=>e>=6320&&e<=6399,"General Punctuation":e=>e>=8192&&e<=8303,"Letterlike Symbols":e=>e>=8448&&e<=8527,"Number Forms":e=>e>=8528&&e<=8591,"Miscellaneous Technical":e=>e>=8960&&e<=9215,"Control Pictures":e=>e>=9216&&e<=9279,"Optical Character Recognition":e=>e>=9280&&e<=9311,"Enclosed Alphanumerics":e=>e>=9312&&e<=9471,"Geometric Shapes":e=>e>=9632&&e<=9727,"Miscellaneous Symbols":e=>e>=9728&&e<=9983,"Miscellaneous Symbols and Arrows":e=>e>=11008&&e<=11263,"CJK Radicals Supplement":e=>e>=11904&&e<=12031,"Kangxi Radicals":e=>e>=12032&&e<=12255,"Ideographic Description Characters":e=>e>=12272&&e<=12287,"CJK Symbols and Punctuation":e=>e>=12288&&e<=12351,Hiragana:e=>e>=12352&&e<=12447,Katakana:e=>e>=12448&&e<=12543,Bopomofo:e=>e>=12544&&e<=12591,"Hangul Compatibility Jamo":e=>e>=12592&&e<=12687,Kanbun:e=>e>=12688&&e<=12703,"Bopomofo Extended":e=>e>=12704&&e<=12735,"CJK Strokes":e=>e>=12736&&e<=12783,"Katakana Phonetic Extensions":e=>e>=12784&&e<=12799,"Enclosed CJK Letters and Months":e=>e>=12800&&e<=13055,"CJK Compatibility":e=>e>=13056&&e<=13311,"CJK Unified Ideographs Extension A":e=>e>=13312&&e<=19903,"Yijing Hexagram Symbols":e=>e>=19904&&e<=19967,"CJK Unified Ideographs":e=>e>=19968&&e<=40959,"Yi Syllables":e=>e>=40960&&e<=42127,"Yi Radicals":e=>e>=42128&&e<=42191,"Hangul Jamo Extended-A":e=>e>=43360&&e<=43391,"Hangul Syllables":e=>e>=44032&&e<=55215,"Hangul Jamo Extended-B":e=>e>=55216&&e<=55295,"Private Use Area":e=>e>=57344&&e<=63743,"CJK Compatibility Ideographs":e=>e>=63744&&e<=64255,"Arabic Presentation Forms-A":e=>e>=64336&&e<=65023,"Vertical Forms":e=>e>=65040&&e<=65055,"CJK Compatibility Forms":e=>e>=65072&&e<=65103,"Small Form Variants":e=>e>=65104&&e<=65135,"Arabic Presentation Forms-B":e=>e>=65136&&e<=65279,"Halfwidth and Fullwidth Forms":e=>e>=65280&&e<=65519,Osage:e=>e>=66736&&e<=66815,"CJK Unified Ideographs Extension B":e=>e>=131072&&e<=173791};function fo(e){for(const t of e)if(yo(t.charCodeAt(0)))return!0;return!1}function mo(e){for(const t of e)if(!go(t.charCodeAt(0)))return!1;return!0}function go(e){return!(po.Arabic(e)||po["Arabic Supplement"](e)||po["Arabic Extended-A"](e)||po["Arabic Presentation Forms-A"](e)||po["Arabic Presentation Forms-B"](e))}function yo(e){return!(746!==e&&747!==e&&(e<4352||!(po["Bopomofo Extended"](e)||po.Bopomofo(e)||po["CJK Compatibility Forms"](e)&&!(e>=65097&&e<=65103)||po["CJK Compatibility Ideographs"](e)||po["CJK Compatibility"](e)||po["CJK Radicals Supplement"](e)||po["CJK Strokes"](e)||!(!po["CJK Symbols and Punctuation"](e)||e>=12296&&e<=12305||e>=12308&&e<=12319||12336===e)||po["CJK Unified Ideographs Extension A"](e)||po["CJK Unified Ideographs"](e)||po["Enclosed CJK Letters and Months"](e)||po["Hangul Compatibility Jamo"](e)||po["Hangul Jamo Extended-A"](e)||po["Hangul Jamo Extended-B"](e)||po["Hangul Jamo"](e)||po["Hangul Syllables"](e)||po.Hiragana(e)||po["Ideographic Description Characters"](e)||po.Kanbun(e)||po["Kangxi Radicals"](e)||po["Katakana Phonetic Extensions"](e)||po.Katakana(e)&&12540!==e||!(!po["Halfwidth and Fullwidth Forms"](e)||65288===e||65289===e||65293===e||e>=65306&&e<=65310||65339===e||65341===e||65343===e||e>=65371&&e<=65503||65507===e||e>=65512&&e<=65519)||!(!po["Small Form Variants"](e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||po["Unified Canadian Aboriginal Syllabics"](e)||po["Unified Canadian Aboriginal Syllabics Extended"](e)||po["Vertical Forms"](e)||po["Yijing Hexagram Symbols"](e)||po["Yi Syllables"](e)||po["Yi Radicals"](e))))}function _o(e){return!(yo(e)||function(e){return!!(po["Latin-1 Supplement"](e)&&(167===e||169===e||174===e||177===e||188===e||189===e||190===e||215===e||247===e)||po["General Punctuation"](e)&&(8214===e||8224===e||8225===e||8240===e||8241===e||8251===e||8252===e||8258===e||8263===e||8264===e||8265===e||8273===e)||po["Letterlike Symbols"](e)||po["Number Forms"](e)||po["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||9003===e||e>=9085&&e<=9114||e>=9150&&e<=9165||9167===e||e>=9169&&e<=9179||e>=9186&&e<=9215)||po["Control Pictures"](e)&&9251!==e||po["Optical Character Recognition"](e)||po["Enclosed Alphanumerics"](e)||po["Geometric Shapes"](e)||po["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||po["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||po["CJK Symbols and Punctuation"](e)||po.Katakana(e)||po["Private Use Area"](e)||po["CJK Compatibility Forms"](e)||po["Small Form Variants"](e)||po["Halfwidth and Fullwidth Forms"](e)||8734===e||8756===e||8757===e||e>=9984&&e<=10087||e>=10102&&e<=10131||65532===e||65533===e)}(e))}function vo(e){return e>=1424&&e<=2303||po["Arabic Presentation Forms-A"](e)||po["Arabic Presentation Forms-B"](e)}function xo(e,t){return!(!t&&vo(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||po.Khmer(e))}function bo(e){for(const t of e)if(vo(t.charCodeAt(0)))return!0;return!1}const wo="deferred",So="loading",To="loaded";let Eo=null,Ao="unavailable",Mo=null;const Po=function(e){e&&"string"==typeof e&&e.indexOf("NetworkError")>-1&&(Ao="error"),Eo&&Eo(e)};function ko(){Co.fire(new vt("pluginStateChange",{pluginStatus:Ao,pluginURL:Mo}))}const Co=new St,jo=function(){return Ao},Io=function(){if(Ao!==wo||!Mo)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Ao=So,ko(),Mo&&ot({url:Mo},(e=>{e?Po(e):(Ao=To,ko())}))},Oo={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Ao===To||null!=Oo.applyArabicShaping,isLoading:()=>Ao===So,setState(e){Ao=e.pluginStatus,Mo=e.pluginURL},isParsed:()=>null!=Oo.applyArabicShaping&&null!=Oo.processBidirectionalText&&null!=Oo.processStyledBidirectionalText,getPluginURL:()=>Mo};class No{constructor(e,t){this.zoom=e,t?(this.now=t.now,this.fadeDuration=t.fadeDuration,this.transition=t.transition,this.pitch=t.pitch,this.brightness=t.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(e){return function(e,t){for(const n of e)if(!xo(n.charCodeAt(0),t))return!1;return!0}(e,Oo.isLoaded())}}class Do{constructor(e,t,n,r){this.property=e,this.value=t,this.expression=function(e,t,n,r){if(Bi(e))return new eo(e,t);if(Yi(e)||Array.isArray(e)&&e.length>0){const i=$i(e,t,n,r);if("error"===i.result)throw new Error(i.value.map((e=>"".concat(e.key,": ").concat(e.message))).join(", "));return i.value}{let n=e;return"string"==typeof e&&"color"===t.type&&(n=Mt.parse(e)),{kind:"constant",configDependencies:new Set,evaluate:()=>n}}}(void 0===t?e.specification.default:t,e.specification,n,r)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(e,t,n){return this.property.possiblyEvaluate(this,e,t,n)}}class Lo{constructor(e,t,n){this.property=e,this.value=new Do(e,void 0,t,n)}transitioned(e,t){return new Ro(this.property,this.value,t,ie({},e.transition,this.transition),e.now)}untransitioned(){return new Ro(this.property,this.value,null,{},0)}}class zo{constructor(e,t,n){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues),this._scope=t,this._options=n,this.configDependencies=new Set}getValue(e){return de(this._values[e].value.value)}setValue(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new Lo(this._values[e].property,this._scope,this._options)),this._values[e].value=new Do(this._values[e].property,null===t?void 0:de(t),this._scope,this._options),this._values[e].value.expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[e].value.expression.configDependencies]))}setTransitionOrValue(e,t){t&&(this._options=t);const n=this._properties.properties;if(e)for(const r in e){const t=e[r];if(ce(r,"-transition")){const e=r.slice(0,-11);n[e]&&this.setTransition(e,t)}else n.hasOwnProperty(r)&&this.setValue(r,t)}}getTransition(e){return de(this._values[e].transition)}setTransition(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new Lo(this._values[e].property)),this._values[e].transition=de(t)||void 0}serialize(){const e={};for(const t of Object.keys(this._values)){const n=this.getValue(t);void 0!==n&&(e[t]=n);const r=this.getTransition(t);void 0!==r&&(e["".concat(t,"-transition")]=r)}return e}transitioned(e,t){const n=new Fo(this._properties);for(const r of Object.keys(this._values))n._values[r]=this._values[r].transitioned(e,t._values[r]);return n}untransitioned(){const e=new Fo(this._properties);for(const t of Object.keys(this._values))e._values[t]=this._values[t].untransitioned();return e}}class Ro{constructor(e,t,n,r,i){const o=r.delay||0,a=r.duration||0;i=i||0,this.property=e,this.value=t,this.begin=i+o,this.end=this.begin+a,e.specification.transition&&(r.delay||r.duration)&&(this.prior=n)}possiblyEvaluate(e,t,n){const r=e.now||0,i=this.value.possiblyEvaluate(e,t,n),o=this.prior;if(o){if(r>this.end)return this.prior=null,i;if(this.value.isDataDriven())return this.prior=null,i;if(r<this.begin)return o.possiblyEvaluate(e,t,n);{const a=(r-this.begin)/(this.end-this.begin);return this.property.interpolate(o.possiblyEvaluate(e,t,n),i,J(a))}}return i}}class Fo{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,t,n){const r=new Uo(this._properties);for(const i of Object.keys(this._values))r._values[i]=this._values[i].possiblyEvaluate(e,t,n);return r}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class Bo{constructor(e,t,n){this._properties=e,this._values=Object.create(e.defaultPropertyValues),this._scope=t,this._options=n,this.configDependencies=new Set}getValue(e){return de(this._values[e].value)}setValue(e,t){this._values[e]=new Do(this._values[e].property,null===t?void 0:de(t),this._scope,this._options),this._values[e].expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[e].expression.configDependencies]))}serialize(){const e={};for(const t of Object.keys(this._values)){const n=this.getValue(t);void 0!==n&&(e[t]=n)}return e}possiblyEvaluate(e,t,n){const r=new Uo(this._properties);for(const i of Object.keys(this._values))r._values[i]=this._values[i].possiblyEvaluate(e,t,n);return r}}class Vo{constructor(e,t,n){this.property=e,this.value=t,this.parameters=n}isConstant(){return"constant"===this.value.kind}constantOr(e){return"constant"===this.value.kind?this.value.value:e}evaluate(e,t,n,r){return this.property.evaluate(this.value,this.parameters,e,t,n,r)}}class Uo{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class Go{constructor(e){this.specification=e}possiblyEvaluate(e,t){return e.expression.evaluate(t)}interpolate(e,t,n){const r=jt[this.specification.type];return r?r(e,t,n):e}}class Ho{constructor(e,t){this.specification=e,this.overrides=t}possiblyEvaluate(e,t,n,r){return new Vo(this,"constant"===e.expression.kind||"camera"===e.expression.kind?{kind:"constant",value:e.expression.evaluate(t,null,{},n,r)}:e.expression,t)}interpolate(e,t,n){if("constant"!==e.value.kind||"constant"!==t.value.kind)return e;if(void 0===e.value.value||void 0===t.value.value)return new Vo(this,{kind:"constant",value:void 0},e.parameters);const r=jt[this.specification.type];return r?new Vo(this,{kind:"constant",value:r(e.value.value,t.value.value,n)},e.parameters):e}evaluate(e,t,n,r,i,o){return"constant"===e.kind?e.value:e.evaluate(t,n,r,i,o)}}class Zo{constructor(e){this.specification=e}possiblyEvaluate(e,t,n,r){return!!e.expression.evaluate(t,null,{},n,r)}interpolate(){return!1}}class qo{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const t=new No(0,{});for(const n in e){const r=e[n];r.specification.overridable&&this.overridableProperties.push(n);const i=this.defaultPropertyValues[n]=new Do(r,void 0),o=this.defaultTransitionablePropertyValues[n]=new Lo(r);this.defaultTransitioningPropertyValues[n]=o.untransitioned(),this.defaultPossiblyEvaluatedValues[n]=i.possiblyEvaluate(t)}}}so(Ho,"DataDrivenProperty"),so(Go,"DataConstantProperty"),so(Zo,"ColorRampProperty");var Wo=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"required":false,"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"camera":{"type":"camera"},"color-theme":{"type":"colorTheme"},"imports":{"type":"array","value":"import"},"schema":{"type":"schema"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"},"models":{"type":"models"},"featuresets":{"experimental":true,"type":"featuresets"}},"featuresets":{"experimental":true,"*":{"type":"featureset"}},"featureset":{"experimental":true,"metadata":{"type":"*"},"selectors":{"type":"array","value":"selector"}},"selector":{"experimental":true,"layer":{"type":"string","required":true},"properties":{"type":"selectorProperty","required":false},"featureNamespace":{"type":"string","required":false}},"selectorProperty":{"experimental":true,"*":{"type":"*"}},"model":{"type":"string","required":true},"import":{"id":{"type":"string","required":true},"url":{"type":"string","required":true},"config":{"type":"config"},"data":{"type":"$root"}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","property-type":"data-constant","expression":{},"required":true},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string","required":true},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false,"property-type":"data-constant"},"shadow-intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"experimental":true,"type":{"required":true,"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":1}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":1}},"url":{"required":false,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"required":true,"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"raster-particle":{"experimental":true},"hillshade":{},"model":{"experimental":true},"background":{},"sky":{},"slot":{},"clip":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_clip","layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_clip":{"clip-layer-types":{"type":"array","value":"enum","values":{"model":1,"symbol":1},"default":[],"expression":{},"property-type":"data-constant","experimental":true},"clip-layer-scope":{"type":"array","value":"string","default":[],"expression":{},"property-type":"data-constant","experimental":true}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-base":1,"hd-road-markup":1},"default":"none","experimental":true,"private":true,"expression":{},"property-type":"data-constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-z-offset":{"type":"number","experimental":true,"default":0,"expression":{"parameters":["zoom","feature","line-progress"]},"property-type":"data-driven"},"line-elevation-reference":{"type":"enum","values":{"none":1,"sea":1,"ground":1,"hd-road-markup":1},"default":"none","experimental":true,"expression":{},"property-type":"data-constant"},"line-cross-slope":{"type":"number","experimental":true,"expression":{},"property-type":"constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1,"hd-road-markup":1},"default":"ground","experimental":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"experimental":true,"private":true,"expression":{},"property-type":"data-constant"},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"experimental":true,"private":true,"expression":{},"property-type":"data-constant"},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_hillshade":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster-particle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_clip":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_model":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"snow":{"density":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"opacity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","property-type":"data-constant","default":0,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"centerThinning":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,90],"minimum":0,"maximum":360,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"rain":{"density":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"opacity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","property-type":"data-constant","default":0,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"centerThinning":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,80],"minimum":0,"maximum":360,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective","property-type":"data-constant"}},"colorTheme":{"data":{"type":"string","property-type":"data-constant","expression":{}}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_raster-particle","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"fill-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-height-alignment":{"type":"enum","experimental":true,"values":{"terrain":1,"flat":1},"default":"flat","property-type":"data-constant"},"fill-extrusion-base-alignment":{"type":"enum","experimental":true,"values":{"terrain":1,"flat":1},"default":"terrain","property-type":"data-constant"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"property-type":"data-constant","type":"color","experimental":true,"default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"property-type":"data-constant","type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"property-type":"data-constant","type":"number","experimental":true,"default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"property-type":"data-constant","type":"boolean","default":true,"experimental":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"fill-extrusion-line-width":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"property-type":"constant"},"line-trim-fade-range":{"type":"array","value":"number","experimental":true,"length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-trim-color":{"type":"color","experimental":true,"default":"transparent","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-border-width":{"type":"number","private":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","private":true,"default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-occlusion-opacity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"property-type":"data-constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-image-cross-fade":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"symbol-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]},"property-type":"color-ramp"},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"raster-array-band":{"type":"string","required":false,"experimental":true,"property-type":"data-constant"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string","required":false,"property-type":"data-constant"},"raster-particle-count":{"type":"number","default":512,"minimum":1,"property-type":"data-constant"},"raster-particle-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-particle-speed"]},"property-type":"color-ramp"},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1,"property-type":"data-constant"},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1,"property-type":"data-constant"},"raster-particle-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_background":{"background-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":[]},"property-type":"data-constant"},"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d","property-type":"data-constant"},"model-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-receive-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant","transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"model-front-cutoff":{"type":"array","private":true,"value":"number","property-type":"data-constant","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function Xo(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function Yo(e){if(Array.isArray(e))return e.map(Yo);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){const t={};for(const n in e)t[n]=Yo(e[n]);return t}return Xo(e)}function Ko(e){if(!0===e||!1===e)return!0;if(!Array.isArray(e)||0===e.length)return!1;switch(e[0]){case"has":return e.length>=2&&"$id"!==e[1]&&"$type"!==e[1];case"in":return e.length>=3&&("string"!=typeof e[1]||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==e.length||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(const t of e.slice(1))if(!Ko(t)&&"boolean"!=typeof t)return!1;return!0;default:return!0}}function Jo(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"fill";if(null==e)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Ko(e)||(e=ia(e));const i=e;let o=!0;try{o=function(e){if(!ea(e))return e;let t=Yo(e);return $o(t),t=Qo(t),t}(i)}catch(e){console.warn("Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\nThis is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md\nand paste the contents of this message in the report.\nThank you!\nFilter Expression:\n".concat(JSON.stringify(i,null,2),"\n        "))}let a=null,s=null;if("background"!==r&&"sky"!==r&&"slot"!==r){s=Wo["filter_".concat(r)];const e=Ki(o,s,t,n);if("error"===e.result)throw new Error(e.value.map((e=>"".concat(e.key,": ").concat(e.message))).join(", "));a=(t,n,r)=>e.value.evaluate(t,n,{},r)}let l=null,c=null;if(o!==i){const e=Ki(i,s,t,n);if("error"===e.result)throw new Error(e.value.map((e=>"".concat(e.key,": ").concat(e.message))).join(", "));l=(t,n,r,i,o)=>e.value.evaluate(t,n,{},r,void 0,void 0,i,o),c=!jr(e.value.expression)}return{filter:a,dynamicFilter:l||void 0,needGeometry:ra(o),needFeature:!!c}}function Qo(e){if(!Array.isArray(e))return e;const t=function(e){if(ta.has(e[0]))for(let t=1;t<e.length;t++)if(ea(e[t]))return!0;return e}(e);return!0===t?t:t.map((e=>Qo(e)))}function $o(e){let t=!1;const n=[];if("case"===e[0]){for(let r=1;r<e.length-1;r+=2)t=t||ea(e[r]),n.push(e[r+1]);n.push(e[e.length-1])}else if("match"===e[0]){t=t||ea(e[1]);for(let t=2;t<e.length-1;t+=2)n.push(e[t+1]);n.push(e[e.length-1])}else if("step"===e[0]){t=t||ea(e[1]);for(let t=1;t<e.length-1;t+=2)n.push(e[t+1])}t&&(e.length=0,e.push("any",...n));for(let r=1;r<e.length;r++)$o(e[r])}function ea(e){if(!Array.isArray(e))return!1;if("pitch"===(t=e[0])||"distance-from-center"===t)return!0;var t;for(let n=1;n<e.length;n++)if(ea(e[n]))return!0;return!1}const ta=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function na(e,t){return e<t?-1:e>t?1:0}function ra(e){if(!Array.isArray(e))return!1;if("within"===e[0]||"distance"===e[0])return!0;for(let t=1;t<e.length;t++)if(ra(e[t]))return!0;return!1}function ia(e){if(!e)return!0;const t=e[0];return e.length<=1?"any"!==t:"=="===t?oa(e[1],e[2],"=="):"!="===t?la(oa(e[1],e[2],"==")):"<"===t||">"===t||"<="===t||">="===t?oa(e[1],e[2],t):"any"===t?(n=e.slice(1),["any"].concat(n.map(ia))):"all"===t?["all"].concat(e.slice(1).map(ia)):"none"===t?["all"].concat(e.slice(1).map(ia).map(la)):"in"===t?aa(e[1],e.slice(2)):"!in"===t?la(aa(e[1],e.slice(2))):"has"===t?sa(e[1]):"!has"!==t||la(sa(e[1]));var n}function oa(e,t,n){switch(e){case"$type":return["filter-type-".concat(n),t];case"$id":return["filter-id-".concat(n),t];default:return["filter-".concat(n),e,t]}}function aa(e,t){if(0===t.length)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some((e=>typeof e!=typeof t[0]))?["filter-in-large",e,["literal",t.sort(na)]]:["filter-in-small",e,["literal",t]]}}function sa(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function la(e){return["!",e]}const ca="\x1f";function ua(e,t){return t?"".concat(e).concat(ca).concat(t):e}const ha="-transition",da=new Set(["fill","line","background","hillshade","raster"]);class pa extends St{constructor(e,t,n,r,i){if(super(),this.id=e.id,this.fqid=ua(this.id,n),this.type=e.type,this.scope=n,this.lut=r,this.options=i,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.configDependencies=new Set,"custom"!==e.type){if(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type&&"background"!==e.type&&"sky"!==e.type&&"slot"!==e.type){this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter;const t=Ki(this.filter,Wo["filter_".concat(e.type)]);"error"!==t.result&&(this.configDependencies=new Set([...this.configDependencies,...t.value.configDependencies]))}if(e.slot&&(this.slot=e.slot),t.layout&&(this._unevaluatedLayout=new Bo(t.layout,this.scope,i),this.configDependencies=new Set([...this.configDependencies,...this._unevaluatedLayout.configDependencies])),t.paint){this._transitionablePaint=new zo(t.paint,this.scope,i);for(const t in e.paint)this.setPaintProperty(t,e.paint[t]);for(const t in e.layout)this.setLayoutProperty(t,e.layout[t]);this.configDependencies=new Set([...this.configDependencies,...this._transitionablePaint.configDependencies]),this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Uo(t.paint)}}}onAdd(e){}onRemove(e){}isDraped(e){return!this.is3D()&&da.has(this.type)}getLayoutProperty(e){return"visibility"===e?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,t){if("custom"===this.type&&"visibility"===e)return void(this.visibility=t);const n=this._unevaluatedLayout;n._properties.properties[e]&&(n.setValue(e,t),this.configDependencies=new Set([...this.configDependencies,...n.configDependencies]),"visibility"===e&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this._unevaluatedLayout._values.visibility&&(this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0}))}getPaintProperty(e){return ce(e,ha)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}setPaintProperty(e,t){const n=this._transitionablePaint,r=n._properties.properties;if(ce(e,ha)){const i=e.slice(0,-11);return r[i]&&n.setTransition(i,t||void 0),!1}if(!r[e])return!1;const i=n._values[e],o=i.value.isDataDriven(),a=i.value;n.setValue(e,t),this.configDependencies=new Set([...this.configDependencies,...n.configDependencies]),this._handleSpecialPaintPropertyUpdate(e);const s=n._values[e].value,l=s.isDataDriven(),c=ce(e,"pattern")||"line-dasharray"===e;return l||o||c||this._handleOverridablePaintPropertyUpdate(e,a,s)}_handleSpecialPaintPropertyUpdate(e){}getProgramIds(){return null}getDefaultProgramParams(e,t,n){return null}_handleOverridablePaintPropertyUpdate(e,t,n){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||"none"===this.visibility}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,t){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,t)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,t)}serialize(){return he({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},((e,t)=>!(void 0===e||"layout"===t&&!Object.keys(e).length||"paint"===t&&!Object.keys(e).length)))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}isStateDependent(){for(const e in this.paint._values){const t=this.paint.get(e);if(t instanceof Vo&&Li(t.property.specification)&&("source"===t.value.kind||"composite"===t.value.kind)&&t.value.isStateDependent)return!0}return!1}compileFilter(e){this._filterCompiled||(this._featureFilter=Jo(this.filter,this.scope,e),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(e){this._stats&&("shadow"===e.renderPass?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}queryRadius(e){}queryIntersectsFeature(e,t,n,r,i,o,a,s,l){}queryIntersectsMatchingFeature(e,t,n,r){}}const fa={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class ma{constructor(e,t){this._structArray=e,this._pos1=t*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class ga{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,t){return e._trim(),t&&(e.isTransferred=!0,t.add(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function ya(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=0,r=0;return{members:e.map((e=>{const i=fa[e.type].BYTES_PER_ELEMENT,o=n=_a(n,Math.max(t,i)),a=e.components||1;return r=Math.max(r,i),n+=i*a,{name:e.name,type:e.type,components:a,offset:o}})),size:_a(n,Math.max(r,t)),alignment:t}}function _a(e,t){return Math.ceil(e/t)*t}class va extends ga{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t){const n=this.length;return this.resize(n+1),this.emplace(n,e,t)}emplace(e,t,n){const r=2*e;return this.int16[r+0]=t,this.int16[r+1]=n,e}}va.prototype.bytesPerElement=4,so(va,"StructArrayLayout2i4");class xa extends ga{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,n){const r=this.length;return this.resize(r+1),this.emplace(r,e,t,n)}emplace(e,t,n,r){const i=3*e;return this.int16[i+0]=t,this.int16[i+1]=n,this.int16[i+2]=r,e}}xa.prototype.bytesPerElement=6,so(xa,"StructArrayLayout3i6");class ba extends ga{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,n,r){const i=this.length;return this.resize(i+1),this.emplace(i,e,t,n,r)}emplace(e,t,n,r,i){const o=4*e;return this.int16[o+0]=t,this.int16[o+1]=n,this.int16[o+2]=r,this.int16[o+3]=i,e}}ba.prototype.bytesPerElement=8,so(ba,"StructArrayLayout4i8");class wa extends ga{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,n,r,i){const o=this.length;return this.resize(o+1),this.emplace(o,e,t,n,r,i)}emplace(e,t,n,r,i,o){const a=5*e;return this.int16[a+0]=t,this.int16[a+1]=n,this.int16[a+2]=r,this.int16[a+3]=i,this.int16[a+4]=o,e}}wa.prototype.bytesPerElement=10,so(wa,"StructArrayLayout5i10");class Sa extends ga{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,n,r,i,o,a){const s=this.length;return this.resize(s+1),this.emplace(s,e,t,n,r,i,o,a)}emplace(e,t,n,r,i,o,a,s){const l=6*e,c=12*e,u=3*e;return this.int16[l+0]=t,this.int16[l+1]=n,this.uint8[c+4]=r,this.uint8[c+5]=i,this.uint8[c+6]=o,this.uint8[c+7]=a,this.float32[u+2]=s,e}}Sa.prototype.bytesPerElement=12,so(Sa,"StructArrayLayout2i4ub1f12");class Ta extends ga{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,n,r){const i=this.length;return this.resize(i+1),this.emplace(i,e,t,n,r)}emplace(e,t,n,r,i){const o=4*e;return this.float32[o+0]=t,this.float32[o+1]=n,this.float32[o+2]=r,this.float32[o+3]=i,e}}Ta.prototype.bytesPerElement=16,so(Ta,"StructArrayLayout4f16");class Ea extends ga{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,n){const r=this.length;return this.resize(r+1),this.emplace(r,e,t,n)}emplace(e,t,n,r){const i=3*e;return this.float32[i+0]=t,this.float32[i+1]=n,this.float32[i+2]=r,e}}Ea.prototype.bytesPerElement=12,so(Ea,"StructArrayLayout3f12");class Aa extends ga{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,n,r,i){const o=this.length;return this.resize(o+1),this.emplace(o,e,t,n,r,i)}emplace(e,t,n,r,i,o){const a=6*e,s=3*e;return this.uint16[a+0]=t,this.uint16[a+1]=n,this.uint16[a+2]=r,this.uint16[a+3]=i,this.float32[s+2]=o,e}}Aa.prototype.bytesPerElement=12,so(Aa,"StructArrayLayout4ui1f12");class Ma extends ga{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,n,r){const i=this.length;return this.resize(i+1),this.emplace(i,e,t,n,r)}emplace(e,t,n,r,i){const o=4*e;return this.uint16[o+0]=t,this.uint16[o+1]=n,this.uint16[o+2]=r,this.uint16[o+3]=i,e}}Ma.prototype.bytesPerElement=8,so(Ma,"StructArrayLayout4ui8");class Pa extends ga{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,n,r,i,o){const a=this.length;return this.resize(a+1),this.emplace(a,e,t,n,r,i,o)}emplace(e,t,n,r,i,o,a){const s=6*e;return this.int16[s+0]=t,this.int16[s+1]=n,this.int16[s+2]=r,this.int16[s+3]=i,this.int16[s+4]=o,this.int16[s+5]=a,e}}Pa.prototype.bytesPerElement=12,so(Pa,"StructArrayLayout6i12");class ka extends ga{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,n,r,i,o,a,s,l,c,u,h){const d=this.length;return this.resize(d+1),this.emplace(d,e,t,n,r,i,o,a,s,l,c,u,h)}emplace(e,t,n,r,i,o,a,s,l,c,u,h,d){const p=12*e;return this.int16[p+0]=t,this.int16[p+1]=n,this.int16[p+2]=r,this.int16[p+3]=i,this.uint16[p+4]=o,this.uint16[p+5]=a,this.uint16[p+6]=s,this.uint16[p+7]=l,this.int16[p+8]=c,this.int16[p+9]=u,this.int16[p+10]=h,this.int16[p+11]=d,e}}ka.prototype.bytesPerElement=24,so(ka,"StructArrayLayout4i4ui4i24");class Ca extends ga{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,n,r,i,o){const a=this.length;return this.resize(a+1),this.emplace(a,e,t,n,r,i,o)}emplace(e,t,n,r,i,o,a){const s=10*e,l=5*e;return this.int16[s+0]=t,this.int16[s+1]=n,this.int16[s+2]=r,this.float32[l+2]=i,this.float32[l+3]=o,this.float32[l+4]=a,e}}Ca.prototype.bytesPerElement=20,so(Ca,"StructArrayLayout3i3f20");class ja extends ga{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){return this.uint32[1*e+0]=t,e}}ja.prototype.bytesPerElement=4,so(ja,"StructArrayLayout1ul4");class Ia extends ga{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t){const n=this.length;return this.resize(n+1),this.emplace(n,e,t)}emplace(e,t,n){const r=2*e;return this.uint16[r+0]=t,this.uint16[r+1]=n,e}}Ia.prototype.bytesPerElement=4,so(Ia,"StructArrayLayout2ui4");class Oa extends ga{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,n,r,i,o,a,s,l,c,u,h,d){const p=this.length;return this.resize(p+1),this.emplace(p,e,t,n,r,i,o,a,s,l,c,u,h,d)}emplace(e,t,n,r,i,o,a,s,l,c,u,h,d,p){const f=20*e,m=10*e;return this.int16[f+0]=t,this.int16[f+1]=n,this.int16[f+2]=r,this.int16[f+3]=i,this.int16[f+4]=o,this.float32[m+3]=a,this.float32[m+4]=s,this.float32[m+5]=l,this.float32[m+6]=c,this.int16[f+14]=u,this.uint32[m+8]=h,this.uint16[f+18]=d,this.uint16[f+19]=p,e}}Oa.prototype.bytesPerElement=40,so(Oa,"StructArrayLayout5i4f1i1ul2ui40");class Na extends ga{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,n,r,i,o,a){const s=this.length;return this.resize(s+1),this.emplace(s,e,t,n,r,i,o,a)}emplace(e,t,n,r,i,o,a,s){const l=8*e;return this.int16[l+0]=t,this.int16[l+1]=n,this.int16[l+2]=r,this.int16[l+4]=i,this.int16[l+5]=o,this.int16[l+6]=a,this.int16[l+7]=s,e}}Na.prototype.bytesPerElement=16,so(Na,"StructArrayLayout3i2i2i16");class Da extends ga{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,n,r,i){const o=this.length;return this.resize(o+1),this.emplace(o,e,t,n,r,i)}emplace(e,t,n,r,i,o){const a=4*e,s=8*e;return this.float32[a+0]=t,this.float32[a+1]=n,this.float32[a+2]=r,this.int16[s+6]=i,this.int16[s+7]=o,e}}Da.prototype.bytesPerElement=16,so(Da,"StructArrayLayout2f1f2i16");class La extends ga{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,n,r,i,o){const a=this.length;return this.resize(a+1),this.emplace(a,e,t,n,r,i,o)}emplace(e,t,n,r,i,o,a){const s=20*e,l=5*e;return this.uint8[s+0]=t,this.uint8[s+1]=n,this.float32[l+1]=r,this.float32[l+2]=i,this.float32[l+3]=o,this.float32[l+4]=a,e}}La.prototype.bytesPerElement=20,so(La,"StructArrayLayout2ub4f20");class za extends ga{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,n){const r=this.length;return this.resize(r+1),this.emplace(r,e,t,n)}emplace(e,t,n,r){const i=3*e;return this.uint16[i+0]=t,this.uint16[i+1]=n,this.uint16[i+2]=r,e}}za.prototype.bytesPerElement=6,so(za,"StructArrayLayout3ui6");class Ra extends ga{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,t,n,r,i,o,a,s,l,c,u,h,d,p,f,m,g,y,_,v,x){const b=this.length;return this.resize(b+1),this.emplace(b,e,t,n,r,i,o,a,s,l,c,u,h,d,p,f,m,g,y,_,v,x)}emplace(e,t,n,r,i,o,a,s,l,c,u,h,d,p,f,m,g,y,_,v,x,b){const w=30*e,S=15*e,T=60*e;return this.int16[w+0]=t,this.int16[w+1]=n,this.int16[w+2]=r,this.float32[S+2]=i,this.float32[S+3]=o,this.uint16[w+8]=a,this.uint16[w+9]=s,this.uint32[S+5]=l,this.uint32[S+6]=c,this.uint32[S+7]=u,this.uint16[w+16]=h,this.uint16[w+17]=d,this.uint16[w+18]=p,this.float32[S+10]=f,this.float32[S+11]=m,this.uint8[T+48]=g,this.uint8[T+49]=y,this.uint8[T+50]=_,this.uint32[S+13]=v,this.int16[w+28]=x,this.uint8[T+58]=b,e}}Ra.prototype.bytesPerElement=60,so(Ra,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Fa extends ga{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,t,n,r,i,o,a,s,l,c,u,h,d,p,f,m,g,y,_,v,x,b,w,S,T,E,A,M,P,k,C,j){const I=this.length;return this.resize(I+1),this.emplace(I,e,t,n,r,i,o,a,s,l,c,u,h,d,p,f,m,g,y,_,v,x,b,w,S,T,E,A,M,P,k,C,j)}emplace(e,t,n,r,i,o,a,s,l,c,u,h,d,p,f,m,g,y,_,v,x,b,w,S,T,E,A,M,P,k,C,j,I){const O=20*e,N=40*e,D=80*e;return this.float32[O+0]=t,this.float32[O+1]=n,this.int16[N+4]=r,this.int16[N+5]=i,this.int16[N+6]=o,this.int16[N+7]=a,this.int16[N+8]=s,this.int16[N+9]=l,this.int16[N+10]=c,this.int16[N+11]=u,this.int16[N+12]=h,this.uint16[N+13]=d,this.uint16[N+14]=p,this.uint16[N+15]=f,this.uint16[N+16]=m,this.uint16[N+17]=g,this.uint16[N+18]=y,this.uint16[N+19]=_,this.uint16[N+20]=v,this.uint16[N+21]=x,this.uint16[N+22]=b,this.uint16[N+23]=w,this.uint16[N+24]=S,this.uint16[N+25]=T,this.uint16[N+26]=E,this.uint16[N+27]=A,this.uint32[O+14]=M,this.float32[O+15]=P,this.float32[O+16]=k,this.float32[O+17]=C,this.float32[O+18]=j,this.uint8[D+76]=I,e}}Fa.prototype.bytesPerElement=80,so(Fa,"StructArrayLayout2f9i15ui1ul4f1ub80");class Ba extends ga{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){return this.float32[1*e+0]=t,e}}Ba.prototype.bytesPerElement=4,so(Ba,"StructArrayLayout1f4");class Va extends ga{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,n,r,i){const o=this.length;return this.resize(o+1),this.emplace(o,e,t,n,r,i)}emplace(e,t,n,r,i,o){const a=5*e;return this.float32[a+0]=t,this.float32[a+1]=n,this.float32[a+2]=r,this.float32[a+3]=i,this.float32[a+4]=o,e}}Va.prototype.bytesPerElement=20,so(Va,"StructArrayLayout5f20");class Ua extends ga{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,n,r,i,o,a){const s=this.length;return this.resize(s+1),this.emplace(s,e,t,n,r,i,o,a)}emplace(e,t,n,r,i,o,a,s){const l=7*e;return this.float32[l+0]=t,this.float32[l+1]=n,this.float32[l+2]=r,this.float32[l+3]=i,this.float32[l+4]=o,this.float32[l+5]=a,this.float32[l+6]=s,e}}Ua.prototype.bytesPerElement=28,so(Ua,"StructArrayLayout7f28");class Ga extends ga{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,n,r,i,o,a,s,l,c,u){const h=this.length;return this.resize(h+1),this.emplace(h,e,t,n,r,i,o,a,s,l,c,u)}emplace(e,t,n,r,i,o,a,s,l,c,u,h){const d=11*e;return this.float32[d+0]=t,this.float32[d+1]=n,this.float32[d+2]=r,this.float32[d+3]=i,this.float32[d+4]=o,this.float32[d+5]=a,this.float32[d+6]=s,this.float32[d+7]=l,this.float32[d+8]=c,this.float32[d+9]=u,this.float32[d+10]=h,e}}Ga.prototype.bytesPerElement=44,so(Ga,"StructArrayLayout11f44");class Ha extends ga{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,n,r,i,o,a,s,l){const c=this.length;return this.resize(c+1),this.emplace(c,e,t,n,r,i,o,a,s,l)}emplace(e,t,n,r,i,o,a,s,l,c){const u=9*e;return this.float32[u+0]=t,this.float32[u+1]=n,this.float32[u+2]=r,this.float32[u+3]=i,this.float32[u+4]=o,this.float32[u+5]=a,this.float32[u+6]=s,this.float32[u+7]=l,this.float32[u+8]=c,e}}Ha.prototype.bytesPerElement=36,so(Ha,"StructArrayLayout9f36");class Za extends ga{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,n,r){const i=this.length;return this.resize(i+1),this.emplace(i,e,t,n,r)}emplace(e,t,n,r,i){const o=6*e;return this.uint32[3*e+0]=t,this.uint16[o+2]=n,this.uint16[o+3]=r,this.uint16[o+4]=i,e}}Za.prototype.bytesPerElement=12,so(Za,"StructArrayLayout1ul3ui12");class qa extends ga{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){return this.uint16[1*e+0]=t,e}}qa.prototype.bytesPerElement=2,so(qa,"StructArrayLayout1ui2");class Wa extends ga{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t){const n=this.length;return this.resize(n+1),this.emplace(n,e,t)}emplace(e,t,n){const r=2*e;return this.float32[r+0]=t,this.float32[r+1]=n,e}}Wa.prototype.bytesPerElement=8,so(Wa,"StructArrayLayout2f8");class Xa extends ga{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,n,r,i,o,a,s,l,c,u,h,d,p,f,m){const g=this.length;return this.resize(g+1),this.emplace(g,e,t,n,r,i,o,a,s,l,c,u,h,d,p,f,m)}emplace(e,t,n,r,i,o,a,s,l,c,u,h,d,p,f,m,g){const y=16*e;return this.float32[y+0]=t,this.float32[y+1]=n,this.float32[y+2]=r,this.float32[y+3]=i,this.float32[y+4]=o,this.float32[y+5]=a,this.float32[y+6]=s,this.float32[y+7]=l,this.float32[y+8]=c,this.float32[y+9]=u,this.float32[y+10]=h,this.float32[y+11]=d,this.float32[y+12]=p,this.float32[y+13]=f,this.float32[y+14]=m,this.float32[y+15]=g,e}}Xa.prototype.bytesPerElement=64,so(Xa,"StructArrayLayout16f64");class Ya extends ga{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,n,r,i,o,a){const s=this.length;return this.resize(s+1),this.emplace(s,e,t,n,r,i,o,a)}emplace(e,t,n,r,i,o,a,s){const l=10*e,c=5*e;return this.uint16[l+0]=t,this.uint16[l+1]=n,this.uint16[l+2]=r,this.uint16[l+3]=i,this.float32[c+2]=o,this.float32[c+3]=a,this.float32[c+4]=s,e}}Ya.prototype.bytesPerElement=20,so(Ya,"StructArrayLayout4ui3f20");class Ka extends ga{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e){const t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){return this.int16[1*e+0]=t,e}}Ka.prototype.bytesPerElement=2,so(Ka,"StructArrayLayout1i2");class Ja extends ga{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(e){const t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){return this.uint8[1*e+0]=t,e}}Ja.prototype.bytesPerElement=1,so(Ja,"StructArrayLayout1ub1");class Qa extends ma{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Qa.prototype.size=40;class $a extends Oa{get(e){return new Qa(this,e)}}so($a,"CollisionBoxArray");class es extends ma{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(e){this._structArray.uint8[this._pos1+49]=e}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(e){this._structArray.uint8[this._pos1+50]=e}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(e){this._structArray.uint32[this._pos4+13]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(e){this._structArray.uint8[this._pos1+58]=e}}es.prototype.size=60;class ts extends Ra{get(e){return new es(this,e)}}so(ts,"PlacedSymbolArray");class ns extends ma{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(e){this._structArray.uint32[this._pos4+14]=e}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(e){this._structArray.float32[this._pos4+18]=e}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}}ns.prototype.size=80;class rs extends Fa{get(e){return new ns(this,e)}}so(rs,"SymbolInstanceArray");class is extends Ba{getoffsetX(e){return this.float32[1*e+0]}}so(is,"GlyphOffsetArray");class os extends va{getx(e){return this.int16[2*e+0]}gety(e){return this.int16[2*e+1]}}so(os,"SymbolLineVertexArray");class as extends ma{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}as.prototype.size=12;class ss extends Za{get(e){return new as(this,e)}}so(ss,"FeatureIndexArray");class ls extends Ia{geta_centroid_pos0(e){return this.uint16[2*e+0]}geta_centroid_pos1(e){return this.uint16[2*e+1]}}so(ls,"FillExtrusionCentroidArray");class cs extends ma{get a_join_normal_inside0(){return this._structArray.int16[this._pos2+0]}get a_join_normal_inside1(){return this._structArray.int16[this._pos2+1]}get a_join_normal_inside2(){return this._structArray.int16[this._pos2+2]}}cs.prototype.size=6;class us extends xa{get(e){return new cs(this,e)}}so(us,"FillExtrusionWallArray");const hs=ya([{name:"a_pos",components:2,type:"Int16"}],4),ds=ya([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class ps{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.segments=e}_prepareSegment(e,t,n,r){let i=this.segments[this.segments.length-1];return e>ps.MAX_VERTEX_ARRAY_LENGTH&&fe("Max vertices per segment is ".concat(ps.MAX_VERTEX_ARRAY_LENGTH,": bucket requested ").concat(e)),(!i||i.vertexLength+e>ps.MAX_VERTEX_ARRAY_LENGTH||i.sortKey!==r)&&(i={vertexOffset:t,primitiveOffset:n,vertexLength:0,primitiveLength:0},void 0!==r&&(i.sortKey=r),this.segments.push(i)),i}prepareSegment(e,t,n,r){return this._prepareSegment(e,t.length,n.length,r)}get(){return this.segments}destroy(){for(const e of this.segments)for(const t in e.vaos)e.vaos[t].destroy()}static simpleSegment(e,t,n,r){return new ps([{vertexOffset:e,primitiveOffset:t,vertexLength:n,primitiveLength:r,vaos:{},sortKey:0}])}}function fs(e,t){return 256*(e=ee(Math.floor(e),0,255))+ee(Math.floor(t),0,255)}ps.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,so(ps,"SegmentVector");const ms=ya([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),gs=ya([{name:"a_dash",components:4,type:"Uint16"}]);class ys{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(e,t,n,r){this.ids.push(_s(e)),this.positions.push(t,n,r)}eachPosition(e,t){const n=_s(e);let r=0,i=this.ids.length-1;for(;r<i;){const e=r+i>>1;this.ids[e]>=n?i=e:r=e+1}for(;this.ids[r]===n;)t(this.positions[3*r],this.positions[3*r+1],this.positions[3*r+2]),r++}static serialize(e,t){const n=new Float64Array(e.ids),r=new Uint32Array(e.positions);return vs(n,r,0,n.length-1),t&&(t.add(n.buffer),t.add(r.buffer)),{ids:n,positions:r}}static deserialize(e){const t=new ys;let n;t.ids=e.ids,t.positions=e.positions;for(const r of t.ids)r!==n&&t.uniqueIds.push(r),n=r;return t.indexed=!0,t}}function _s(e){const t=+e;return!isNaN(t)&&Number.MIN_SAFE_INTEGER<=t&&t<=Number.MAX_SAFE_INTEGER?t:_t(String(e))}function vs(e,t,n,r){for(;n<r;){const i=e[n+r>>1];let o=n-1,a=r+1;for(;;){do{o++}while(e[o]<i);do{a--}while(e[a]>i);if(o>=a)break;xs(e,o,a),xs(t,3*o,3*a),xs(t,3*o+1,3*a+1),xs(t,3*o+2,3*a+2)}a-n<r-a?(vs(e,t,n,a),n=a+1):(vs(e,t,a+1,r),r=a)}}function xs(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}so(ys,"FeaturePositionMap");class bs{constructor(e){this.gl=e.gl,this.initialized=!1}fetchUniformLocation(e,t){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(e,t),this.initialized=!0),!!this.location}set(e,t,n){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class ws extends bs{constructor(e){super(e),this.current=0}set(e,t,n){this.fetchUniformLocation(e,t)&&this.current!==n&&(this.current=n,this.gl.uniform1i(this.location,n))}}class Ss extends bs{constructor(e){super(e),this.current=0}set(e,t,n){this.fetchUniformLocation(e,t)&&this.current!==n&&(this.current=n,this.gl.uniform1f(this.location,n))}}class Ts extends bs{constructor(e){super(e),this.current=[0,0]}set(e,t,n){this.fetchUniformLocation(e,t)&&(n[0]===this.current[0]&&n[1]===this.current[1]||(this.current=n,this.gl.uniform2f(this.location,n[0],n[1])))}}class Es extends bs{constructor(e){super(e),this.current=[0,0,0]}set(e,t,n){this.fetchUniformLocation(e,t)&&(n[0]===this.current[0]&&n[1]===this.current[1]&&n[2]===this.current[2]||(this.current=n,this.gl.uniform3f(this.location,n[0],n[1],n[2])))}}class As extends bs{constructor(e){super(e),this.current=[0,0,0,0]}set(e,t,n){this.fetchUniformLocation(e,t)&&(n[0]===this.current[0]&&n[1]===this.current[1]&&n[2]===this.current[2]&&n[3]===this.current[3]||(this.current=n,this.gl.uniform4f(this.location,n[0],n[1],n[2],n[3])))}}class Ms extends bs{constructor(e){super(e),this.current=Mt.transparent.toRenderColor(null)}set(e,t,n){this.fetchUniformLocation(e,t)&&(n.r===this.current.r&&n.g===this.current.g&&n.b===this.current.b&&n.a===this.current.a||(this.current=n,this.gl.uniform4f(this.location,n.r,n.g,n.b,n.a)))}}const Ps=new Float32Array(16);class ks extends bs{constructor(e){super(e),this.current=Ps}set(e,t,n){if(this.fetchUniformLocation(e,t)){if(n[12]!==this.current[12]||n[0]!==this.current[0])return this.current=n,void this.gl.uniformMatrix4fv(this.location,!1,n);for(let e=1;e<16;e++)if(n[e]!==this.current[e]){this.current=n,this.gl.uniformMatrix4fv(this.location,!1,n);break}}}}const Cs=new Float32Array(9),js=new Float32Array(4);class Is extends bs{constructor(e){super(e),this.current=js}set(e,t,n){if(this.fetchUniformLocation(e,t))for(let r=0;r<4;r++)if(n[r]!==this.current[r]){this.current=n,this.gl.uniformMatrix2fv(this.location,!1,n);break}}}function Os(e){return[fs(255*e.r,255*e.g),fs(255*e.b,255*e.a)]}class Ns{constructor(e,t,n,r){this.value=e,this.uniformNames=t.map((e=>"u_".concat(e))),this.type=n,this.context=r}setUniform(e,t,n,r,i){const o=r.constantOr(this.value);t.set(e,i,o instanceof Mt?o.toRenderColor(this.context.lut):o)}getBinding(e,t){return"color"===this.type?new Ms(e):new Ss(e)}}class Ds{constructor(e,t){this.uniformNames=t.map((e=>"u_".concat(e))),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(e){this.pixelRatio=e.pixelRatio||1,this.pattern=e.tl.concat(e.br)}setUniform(e,t,n,r,i){const o="u_pattern"===i||"u_dash"===i?this.pattern:"u_pixel_ratio"===i?this.pixelRatio:null;o&&t.set(e,i,o)}getBinding(e,t){return"u_pattern"===t||"u_dash"===t?new As(e):new Ss(e)}}class Ls{constructor(e,t,n,r){this.expression=e,this.type=n,this.maxValue=0,this.paintVertexAttributes=t.map((e=>({name:"a_".concat(e),type:"Float32",components:"color"===n?2:1,offset:0}))),this.paintVertexArray=new r}populatePaintArray(e,t,n,r,i,o,a){const s=this.paintVertexArray.length,l=this.expression.evaluate(new No(0,{brightness:o}),t,{},i,r,a);this.paintVertexArray.resize(e),this._setPaintValue(s,e,l,this.context)}updatePaintArray(e,t,n,r,i,o,a){const s=this.expression.evaluate({zoom:0,brightness:a},n,r,void 0,i);this._setPaintValue(e,t,s,this.context)}_setPaintValue(e,t,n,r){if("color"===this.type){const i=Os(n.toRenderColor(r.lut));for(let n=e;n<t;n++)this.paintVertexArray.emplace(n,i[0],i[1])}else{for(let r=e;r<t;r++)this.paintVertexArray.emplace(r,n);this.maxValue=Math.max(this.maxValue,Math.abs(n))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class zs{constructor(e,t,n,r,i,o){this.expression=e,this.uniformNames=t.map((e=>"u_".concat(e,"_t"))),this.type=n,this.useIntegerZoom=r,this.context=i,this.maxValue=0,this.paintVertexAttributes=t.map((e=>({name:"a_".concat(e),type:"Float32",components:"color"===n?4:2,offset:0}))),this.paintVertexArray=new o}populatePaintArray(e,t,n,r,i,o,a){const s=this.expression.evaluate(new No(this.context.zoom,{brightness:o}),t,{},i,r,a),l=this.expression.evaluate(new No(this.context.zoom+1,{brightness:o}),t,{},i,r,a),c=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(c,e,s,l,this.context)}updatePaintArray(e,t,n,r,i,o,a){const s=this.expression.evaluate({zoom:this.context.zoom,brightness:a},n,r,void 0,i),l=this.expression.evaluate({zoom:this.context.zoom+1,brightness:a},n,r,void 0,i);this._setPaintValue(e,t,s,l,this.context)}_setPaintValue(e,t,n,r,i){if("color"===this.type){const r=Os(n.toRenderColor(i.lut)),o=Os(n.toRenderColor(i.lut));for(let n=e;n<t;n++)this.paintVertexArray.emplace(n,r[0],r[1],o[0],o[1])}else{for(let i=e;i<t;i++)this.paintVertexArray.emplace(i,n,r);this.maxValue=Math.max(this.maxValue,Math.abs(n),Math.abs(r))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,t,n,r,i){const o=this.useIntegerZoom?Math.floor(n.zoom):n.zoom,a=ee(this.expression.interpolationFactor(o,this.context.zoom,this.context.zoom+1),0,1);t.set(e,i,a)}getBinding(e,t){return new Ss(e)}}class Rs{constructor(e,t,n,r,i){this.expression=e,this.layerId=i,this.paintVertexAttributes=("array"===n?gs:ms).members;for(let o=0;o<t.length;++o);this.paintVertexArray=new r}populatePaintArray(e,t,n,r){const i=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValues(i,e,t.patterns&&t.patterns[this.layerId],n)}updatePaintArray(e,t,n,r,i,o,a){this._setPaintValues(e,t,n.patterns&&n.patterns[this.layerId],o)}_setPaintValues(e,t,n,r){if(!r||!n)return;const i=r[n];if(!i)return;const{tl:o,br:a,pixelRatio:s}=i;for(let l=e;l<t;l++)this.paintVertexArray.emplace(l,o[0],o[1],a[0],a[1],s)}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Fs{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>!0;this.binders={},this._buffers=[],this.context=t;const r=[];for(const i in e.paint._values){const o=e.paint.get(i);if(!n(i))continue;if(!(o instanceof Vo&&Li(o.property.specification)))continue;const a=Us(i,e.type),s=o.value,l=o.property.specification.type,c=!!o.property.useIntegerZoom,u="line-dasharray"===i||i.endsWith("pattern"),h="line-dasharray"===i&&"constant"!==e.layout.get("line-cap").value.kind;if("constant"!==s.kind||h)if("source"===s.kind||h||u){const t=Zs(i,l,"source");this.binders[i]=u?new Rs(s,a,l,t,e.id):new Ls(s,a,l,t),r.push("/a_".concat(i))}else{const e=Zs(i,l,"composite");this.binders[i]=new zs(s,a,l,c,t,e),r.push("/z_".concat(i))}else this.binders[i]=u?new Ds(s.value,a):new Ns(s.value,a,l,t),r.push("/u_".concat(i))}this.cacheKey=r.sort().join("")}getMaxValue(e){const t=this.binders[e];return t instanceof Ls||t instanceof zs?t.maxValue:0}populatePaintArrays(e,t,n,r,i,o,a){for(const s in this.binders){const l=this.binders[s];l.context=this.context,(l instanceof Ls||l instanceof zs||l instanceof Rs)&&l.populatePaintArray(e,t,n,r,i,o,a)}}setConstantPatternPositions(e){for(const t in this.binders){const n=this.binders[t];n instanceof Ds&&n.setConstantPatternPositions(e)}}updatePaintArrays(e,t,n,r,i,o,a,s){let l=!1;const c=Object.keys(e),u=0!==c.length,h=u?c:t.uniqueIds;this.context.lut=i.lut;for(const d in this.binders){const c=this.binders[d];if(c.context=this.context,(c instanceof Ls||c instanceof zs||c instanceof Rs)&&(!0===c.expression.isStateDependent||!1===c.expression.isLightConstant)){const p=i.paint.get(d);c.expression=p.value;for(const n of h){const i=e[n.toString()];t.eachPosition(n,((e,t,n)=>{const l=r.feature(e);c.updatePaintArray(t,n,l,i,o,a,s)}))}if(!u)for(const t of n.uniqueIds){const i=e[t.toString()];n.eachPosition(t,((e,t,n)=>{const l=r.feature(e);c.updatePaintArray(t,n,l,i,o,a,s)}))}l=!0}}return l}defines(){const e=[];for(const t in this.binders){const n=this.binders[t];(n instanceof Ns||n instanceof Ds)&&e.push(...n.uniformNames.map((e=>"#define HAS_UNIFORM_".concat(e))))}return e}getBinderAttributes(){const e=[];for(const t in this.binders){const n=this.binders[t];if(n instanceof Ls||n instanceof zs||n instanceof Rs)for(let t=0;t<n.paintVertexAttributes.length;t++)e.push(n.paintVertexAttributes[t].name)}return e}getBinderUniforms(){const e=[];for(const t in this.binders){const n=this.binders[t];if(n instanceof Ns||n instanceof Ds||n instanceof zs)for(const t of n.uniformNames)e.push(t)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e){const t=[];for(const n in this.binders){const r=this.binders[n];if(r instanceof Ns||r instanceof Ds||r instanceof zs)for(const i of r.uniformNames)t.push({name:i,property:n,binding:r.getBinding(e,i)})}return t}setUniforms(e,t,n,r,i){for(const{name:o,property:a,binding:s}of n)this.binders[a].setUniform(e,s,i,r.get(a),o)}updatePaintBuffers(){this._buffers=[];for(const e in this.binders){const t=this.binders[e];(t instanceof Ls||t instanceof zs||t instanceof Rs)&&t.paintVertexBuffer&&this._buffers.push(t.paintVertexBuffer)}}upload(e){for(const t in this.binders){const n=this.binders[t];(n instanceof Ls||n instanceof zs||n instanceof Rs)&&n.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const t=this.binders[e];(t instanceof Ls||t instanceof zs||t instanceof Rs)&&t.destroy()}}}class Bs{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>!0;this.programConfigurations={};for(const r of e)this.programConfigurations[r.id]=new Fs(r,t,n);this.needsUpload=!1,this._featureMap=new ys,this._featureMapWithoutIds=new ys,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(e,t,n,r,i,o,a,s){for(const l in this.programConfigurations)this.programConfigurations[l].populatePaintArrays(e,t,r,i,o,a,s);void 0!==t.id?this._featureMap.add(t.id,n,this._bufferOffset,e):(this._featureMapWithoutIds.add(this._idlessCounter,n,this._bufferOffset,e),this._idlessCounter+=1),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,t,n,r,i,o){for(const a of n)this.needsUpload=this.programConfigurations[a.id].updatePaintArrays(e,this._featureMap,this._featureMapWithoutIds,t,a,r,i,o||0)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}const Vs={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-occlusion-opacity":["occlusion_opacity"],"icon-occlusion-opacity":["occlusion_opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"symbol-z-offset":["z_offset"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function Us(e,t){return Vs[e]||[e.replace("".concat(t,"-"),"").replace(/-/g,"_")]}const Gs={"line-pattern":{source:Aa,composite:Aa},"fill-pattern":{source:Aa,composite:Aa},"fill-extrusion-pattern":{source:Aa,composite:Aa},"line-dasharray":{source:Ma,composite:Ma}},Hs={color:{source:Wa,composite:Ta},number:{source:Ba,composite:Wa}};function Zs(e,t,n){const r=Gs[e];return r&&r[n]||Hs[t][n]}so(Ns,"ConstantBinder"),so(Ds,"PatternConstantBinder"),so(Ls,"SourceExpressionBinder"),so(Rs,"PatternCompositeBinder"),so(zs,"CompositeExpressionBinder"),so(Fs,"ProgramConfiguration",{omit:["_buffers"]}),so(Bs,"ProgramConfigurationSet");const qs=Jn/Math.PI/2,Ws=5,Xs=6,Ys=16383,Ks=64,Js=[Ks,32,16],Qs=-qs,$s=qs;function el(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:qs;return n=X(n),[e*Math.sin(n)*r,-t*r,e*Math.cos(n)*r]}function tl(e,t,n){return el(Math.cos(X(e)),Math.sin(X(e)),t,n)}const nl=6371008.8,rl=2*Math.PI*nl;class il{constructor(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid LngLat object: (".concat(e,", ").concat(t,")"));if(this.lng=+e,this.lat=+t,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new il(ne(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return"LngLat(".concat(this.lng,", ").concat(this.lat,")")}distanceTo(e){const t=Math.PI/180,n=this.lat*t,r=e.lat*t,i=Math.sin(n)*Math.sin(r)+Math.cos(n)*Math.cos(r)*Math.cos((e.lng-this.lng)*t);return nl*Math.acos(Math.min(i,1))}toBounds(){const e=360*(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)/40075017,t=e/Math.cos(Math.PI/180*this.lat);return new ol({lng:this.lng-t,lat:this.lat-e},{lng:this.lng+t,lat:this.lat+e})}toEcef(e){return tl(this.lat,this.lng,qs+e*qs/nl)}static convert(e){if(e instanceof il)return e;if(Array.isArray(e)&&(2===e.length||3===e.length))return new il(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&"object"==typeof e&&null!==e)return new il(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class ol{constructor(e,t){if(e)if(t)this.setSouthWest(e).setNorthEast(t);else if(4===e.length){const t=e;this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]])}else{const t=e;this.setSouthWest(t[0]).setNorthEast(t[1])}}setNorthEast(e){return this._ne=e instanceof il?new il(e.lng,e.lat):il.convert(e),this}setSouthWest(e){return this._sw=e instanceof il?new il(e.lng,e.lat):il.convert(e),this}extend(e){const t=this._sw,n=this._ne;let r,i;if(e instanceof il)r=e,i=e;else{if(!(e instanceof ol))return Array.isArray(e)?4===e.length||e.every(Array.isArray)?this.extend(ol.convert(e)):this.extend(il.convert(e)):"object"==typeof e&&null!==e&&e.hasOwnProperty("lat")&&(e.hasOwnProperty("lon")||e.hasOwnProperty("lng"))?this.extend(il.convert(e)):this;if(r=e._sw,i=e._ne,!r||!i)return this}return t||n?(t.lng=Math.min(r.lng,t.lng),t.lat=Math.min(r.lat,t.lat),n.lng=Math.max(i.lng,n.lng),n.lat=Math.max(i.lat,n.lat)):(this._sw=new il(r.lng,r.lat),this._ne=new il(i.lng,i.lat)),this}getCenter(){return new il((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new il(this.getWest(),this.getNorth())}getSouthEast(){return new il(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return"LngLatBounds(".concat(this._sw.toString(),", ").concat(this._ne.toString(),")")}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:t,lat:n}=il.convert(e);let r=this._sw.lng<=t&&t<=this._ne.lng;return this._sw.lng>this._ne.lng&&(r=this._sw.lng>=t&&t>=this._ne.lng),this._sw.lat<=n&&n<=this._ne.lat&&r}static convert(e){if(e)return e instanceof ol?e:new ol(e)}}const al=0,sl=25.5;function ll(e){return rl*Math.cos(e*Math.PI/180)}function cl(e){return(180+e)/360}function ul(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function hl(e,t){return e/ll(t)}function dl(e){return 360*e-180}function pl(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}function fl(e,t){return e*ll(pl(t))}const ml=85.051129;function gl(e){return Math.cos(X(ee(e,-ml,ml)))}function yl(e,t){const n=ee(t,al,sl),r=Math.pow(2,n);return gl(e)*rl/(512*r)}function _l(e){return 1/Math.cos(e*Math.PI/180)}function vl(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=Math.exp(Math.PI*(1-(e.y+t/Jn)/(1<<e.z)*2));return 80150034*n/(n*n+1)/Jn/(1<<e.z)}class xl{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.x=+e,this.y=+t,this.z=+n}static fromLngLat(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=il.convert(e);return new xl(cl(n.lng),ul(n.lat),hl(t,n.lat))}toLngLat(){return new il(dl(this.x),pl(this.y))}toAltitude(){return fl(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/rl*_l(pl(this.y))}}function bl(e,t,n,r,i,o,a,s,l){const c=(t+r)/2,u=(n+i)/2,h=new H(c,u);s(h),function(e,t,n,r,i,o){const a=n-i,s=r-o;return Math.abs((r-t)*a-(n-e)*s)/Math.hypot(a,s)}(h.x,h.y,o.x,o.y,a.x,a.y)>=l?(bl(e,t,n,c,u,o,h,s,l),bl(e,c,u,r,i,h,a,s,l)):e.push(a)}function wl(e,t,n){let r=e[0],i=r.x,o=r.y;t(r);const a=[r];for(let s=1;s<e.length;s++){const l=e[s],{x:c,y:u}=l;t(l),bl(a,i,o,c,u,r,l,t,n),i=c,o=u,r=l}return a}function Sl(e,t,n,r){if(r(t,n)){const i=t.add(n)._mult(.5);Sl(e,t,i,r),Sl(e,i,n,r)}else e.push(n)}function Tl(e,t){let n=e[0];const r=[n];for(let i=1;i<e.length;i++){const o=e[i];Sl(r,n,o,t),n=o}return r}const El=Math.pow(2,14)-1,Al=-El-1;function Ml(e,t){const n=Math.round(e.x*t),r=Math.round(e.y*t);return e.x=ee(n,Al,El),e.y=ee(r,Al,El),(n<e.x||n>e.x+1||r<e.y||r>e.y+1)&&fe("Geometry exceeds allowed extent, reduce your vector tile buffer size"),e}function Pl(e,t,n){const r=e.loadGeometry(),i=e.extent,o=Jn/i;if(t&&n&&n.projection.isReprojectedInTileSpace){const o=1<<t.z,{scale:a,x:s,y:l,projection:c}=n,u=e=>{const n=dl((t.x+e.x/i)/o),r=pl((t.y+e.y/i)/o),u=c.project(n,r);e.x=(u.x*a-s)*i,e.y=(u.y*a-l)*i};for(let t=0;t<r.length;t++)if(1!==e.type)r[t]=wl(r[t],u,1);else{const e=[];for(const n of r[t])n.x<0||n.x>=i||n.y<0||n.y>=i||(u(n),e.push(n));r[t]=e}}for(const a of r)for(const e of a)Ml(e,o);return r}function kl(e,t){return{type:e.type,id:e.id,properties:e.properties,geometry:t?Pl(e):[]}}function Cl(e,t,n,r,i){e.emplaceBack(2*t+(r+1)/2,2*n+(i+1)/2)}function jl(e,t,n){const r=16384;e.emplaceBack(t.x,t.y,t.z,n[0]*r,n[1]*r,n[2]*r)}class Il{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((e=>e.fqid)),this.index=e.index,this.hasPattern=!1,this.projection=e.projection,this.layoutVertexArray=new va,this.indexArray=new za,this.segments=new ps,this.programConfigurations=new Bs(e.layers,{zoom:e.zoom,lut:e.lut}),this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id))}updateFootprints(e,t){}populate(e,t,n,r){const i=this.layers[0],o=[];let a=null;"circle"===i.type&&(a=i.layout.get("circle-sort-key"));for(const{feature:l,id:c,index:u,sourceLayerIndex:h}of e){const e=this.layers[0]._featureFilter.needGeometry,t=kl(l,e);if(!this.layers[0]._featureFilter.filter(new No(this.zoom),t,n))continue;const i=a?a.evaluate(t,{},n):void 0,s={id:c,properties:l.properties,type:l.type,sourceLayerIndex:h,index:u,geometry:e?t.geometry:Pl(l,n,r),patterns:{},sortKey:i};o.push(s)}a&&o.sort(((e,t)=>e.sortKey-t.sortKey));let s=null;"globe"===r.projection.name&&(this.globeExtVertexArray=new Pa,s=r.projection);for(const l of o){const{geometry:r,index:i,sourceLayerIndex:o}=l,a=e[i].feature;this.addFeature(l,r,i,t.availableImages,n,s,t.brightness),t.featureIndex.insert(a,r,i,o,this.index)}}update(e,t,n,r,i){const o=0!==Object.keys(e).length;o&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(e,t,o?this.stateDependentLayers:this.layers,n,r,i)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,hs.members),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,ds.members))),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(e,t,n,r,i,o,a){for(const s of t)for(const t of s){const n=t.x,r=t.y;if(n<0||n>=Jn||r<0||r>=Jn)continue;if(o){const e=o.projectTilePoint(n,r,i),t=o.upVector(i,n,r),a=this.globeExtVertexArray;jl(a,e,t),jl(a,e,t),jl(a,e,t),jl(a,e,t)}const a=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),s=a.vertexLength;Cl(this.layoutVertexArray,n,r,-1,-1),Cl(this.layoutVertexArray,n,r,1,-1),Cl(this.layoutVertexArray,n,r,1,1),Cl(this.layoutVertexArray,n,r,-1,1),this.indexArray.emplaceBack(s,s+1,s+2),this.indexArray.emplaceBack(s,s+2,s+3),a.vertexLength+=4,a.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,n,{},r,i,a)}}function Ol(e,t){for(let n=0;n<e.length;n++)if(Ul(t,e[n]))return!0;for(let n=0;n<t.length;n++)if(Ul(e,t[n]))return!0;return!!zl(e,t)}function Nl(e,t,n){return!!Ul(e,t)||!!Fl(t,e,n)}function Dl(e,t){if(1===e.length)return Vl(t,e[0]);for(let n=0;n<t.length;n++){const r=t[n];for(let t=0;t<r.length;t++)if(Ul(e,r[t]))return!0}for(let n=0;n<e.length;n++)if(Vl(t,e[n]))return!0;for(let n=0;n<t.length;n++)if(zl(e,t[n]))return!0;return!1}function Ll(e,t,n){if(e.length>1){if(zl(e,t))return!0;for(let r=0;r<t.length;r++)if(Fl(t[r],e,n))return!0}for(let r=0;r<e.length;r++)if(Fl(e[r],t,n))return!0;return!1}function zl(e,t){if(0===e.length||0===t.length)return!1;for(let n=0;n<e.length-1;n++){const r=e[n],i=e[n+1];for(let e=0;e<t.length-1;e++)if(Rl(r,i,t[e],t[e+1]))return!0}return!1}function Rl(e,t,n,r){return me(e,n,r)!==me(t,n,r)&&me(e,t,n)!==me(e,t,r)}function Fl(e,t,n){const r=n*n;if(1===t.length)return e.distSqr(t[0])<r;for(let i=1;i<t.length;i++)if(Bl(e,t[i-1],t[i])<r)return!0;return!1}function Bl(e,t,n){const r=t.distSqr(n);if(0===r)return e.distSqr(t);const i=((e.x-t.x)*(n.x-t.x)+(e.y-t.y)*(n.y-t.y))/r;return e.distSqr(i<0?t:i>1?n:n.sub(t)._mult(i)._add(t))}function Vl(e,t){let n,r,i,o=!1;for(let a=0;a<e.length;a++){n=e[a];for(let e=0,a=n.length-1;e<n.length;a=e++)r=n[e],i=n[a],r.y>t.y!=i.y>t.y&&t.x<(i.x-r.x)*(t.y-r.y)/(i.y-r.y)+r.x&&(o=!o)}return o}function Ul(e,t){let n=!1;for(let r=0,i=e.length-1;r<e.length;i=r++){const o=e[r],a=e[i];o.y>t.y!=a.y>t.y&&t.x<(a.x-o.x)*(t.y-o.y)/(a.y-o.y)+o.x&&(n=!n)}return n}function Gl(e,t,n,r,i){for(const a of e)if(t<=a.x&&n<=a.y&&r>=a.x&&i>=a.y)return!0;const o=[new H(t,n),new H(t,i),new H(r,i),new H(r,n)];if(e.length>2)for(const a of o)if(Ul(e,a))return!0;for(let a=0;a<e.length-1;a++)if(Hl(e[a],e[a+1],o))return!0;return!1}function Hl(e,t,n){const r=n[0],i=n[2];if(e.x<r.x&&t.x<r.x||e.x>i.x&&t.x>i.x||e.y<r.y&&t.y<r.y||e.y>i.y&&t.y>i.y)return!1;const o=me(e,t,n[0]);return o!==me(e,t,n[1])||o!==me(e,t,n[2])||o!==me(e,t,n[3])}function Zl(e,t,n,r,i,o){let a=t.y-e.y,s=e.x-t.x;if(o=o||0){const e=a*a+s*s;if(0===e)return!0;const t=Math.sqrt(e);a/=t,s/=t}return!((n.x-e.x)*a+(n.y-e.y)*s-o<0||(r.x-e.x)*a+(r.y-e.y)*s-o<0||(i.x-e.x)*a+(i.y-e.y)*s-o<0)}function ql(e,t,n,r,i,o,a){return!(Zl(e,t,r,i,o,a)||Zl(t,n,r,i,o,a)||Zl(n,e,r,i,o,a)||Zl(r,i,e,t,n,a)||Zl(i,o,e,t,n,a)||Zl(o,r,e,t,n,a))}function Wl(e,t,n){const r=t.paint.get(e).value;return"constant"===r.kind?r.value:n.programConfigurations.get(t.id).getMaxValue(e)}function Xl(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function Yl(e,t,n,r,i){if(!t[0]&&!t[1])return e;const o=H.convert(t)._mult(i);"viewport"===n&&o._rotate(-r);const a=[];for(let s=0;s<e.length;s++)a.push(e[s].sub(o));return a}function Kl(e,t,n,r){const i=H.convert(e)._mult(r);return"viewport"===t&&i._rotate(-n),i}let Jl,Ql;so(Il,"CircleBucket",{omit:["layers"]});var $l,ec={exports:{}},tc=($l||($l=1,function(e,t){!function(e){function t(e,t,r){var i=n(256*e,256*(t=Math.pow(2,r)-t-1),r),o=n(256*(e+1),256*(t+1),r);return i[0]+","+i[1]+","+o[0]+","+o[1]}function n(e,t,n){var r=2*Math.PI*6378137/256/Math.pow(2,n);return[e*r-2*Math.PI*6378137/2,t*r-2*Math.PI*6378137/2]}e.getURL=function(e,n,r,i,o,a){return a=a||{},e+"?"+["bbox="+t(r,i,o),"format="+(a.format||"image/png"),"service="+(a.service||"WMS"),"version="+(a.version||"1.1.1"),"request="+(a.request||"GetMap"),"srs="+(a.srs||"EPSG:3857"),"width="+(a.width||256),"height="+(a.height||256),"layers="+n].join("&")},e.getTileBBox=t,e.getMercCoords=n,Object.defineProperty(e,"__esModule",{value:!0})}(t)}(0,ec.exports)),ec.exports);class nc{constructor(e,t,n){this.z=e,this.x=t,this.y=n,this.key=oc(0,e,e,t,n)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,t){const n=tc.getTileBBox(this.x,this.y,this.z),r=function(e,t,n){let r,i="";for(let o=e;o>0;o--)r=1<<o-1,i+=(t&r?1:0)+(n&r?2:0);return i}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===t?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",r).replace("{bbox-epsg-3857}",n)}toString(){return"".concat(this.z,"/").concat(this.x,"/").concat(this.y)}}class rc{constructor(e,t){this.wrap=e,this.canonical=t,this.key=oc(e,t.z,t.z,t.x,t.y)}}class ic{constructor(e,t,n,r,i){this.overscaledZ=e,this.wrap=t,this.canonical=new nc(n,+r,+i),this.key=0===t&&e===n?this.canonical.key:oc(t,e,n,r,i)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){const t=this.canonical.z-e;return e>this.canonical.z?new ic(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ic(e,this.wrap,e,this.canonical.x>>t,this.canonical.y>>t)}calculateScaledKey(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.overscaledZ===e&&t)return this.key;if(e>this.canonical.z)return oc(this.wrap*+t,e,this.canonical.z,this.canonical.x,this.canonical.y);{const n=this.canonical.z-e;return oc(this.wrap*+t,e,e,this.canonical.x>>n,this.canonical.y>>n)}}isChildOf(e){if(e.wrap!==this.wrap)return!1;const t=this.canonical.z-e.canonical.z;return 0===e.overscaledZ||e.overscaledZ<this.overscaledZ&&e.canonical.z<this.canonical.z&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t}children(e){if(this.overscaledZ>=e)return[new ic(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const t=this.canonical.z+1,n=2*this.canonical.x,r=2*this.canonical.y;return[new ic(t,this.wrap,t,n,r),new ic(t,this.wrap,t,n+1,r),new ic(t,this.wrap,t,n,r+1),new ic(t,this.wrap,t,n+1,r+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new ic(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new ic(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new rc(this.wrap,this.canonical)}toString(){return"".concat(this.overscaledZ,"/").concat(this.canonical.x,"/").concat(this.canonical.y)}}function oc(e,t,n,r,i){const o=1<<Math.min(n,22);let a=o*(i%o)+r%o;return e&&n<22&&(a+=o*o*((e<0?-2*e-1:2*e)%(1<<2*(22-n)))),16*(32*a+n)+(t-n)}const ac=[e=>{let t=e.canonical.x-1,n=e.wrap;return t<0&&(t=(1<<e.canonical.z)-1,n--),new ic(e.overscaledZ,n,e.canonical.z,t,e.canonical.y)},e=>{let t=e.canonical.x+1,n=e.wrap;return t===1<<e.canonical.z&&(t=0,n++),new ic(e.overscaledZ,n,e.canonical.z,t,e.canonical.y)},e=>new ic(e.overscaledZ,e.wrap,e.canonical.z,e.canonical.x,(0===e.canonical.y?1<<e.canonical.z:e.canonical.y)-1),e=>new ic(e.overscaledZ,e.wrap,e.canonical.z,e.canonical.x,e.canonical.y===(1<<e.canonical.z)-1?0:e.canonical.y+1)];so(nc,"CanonicalTileID"),so(ic,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const sc=ya([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:lc}=sc,cc=ya([{name:"a_pos_3",components:3,type:"Int16"}]);var uc=ya([{name:"a_pos",type:"Int16",components:2}]);class hc{constructor(e,t){this.pos=e,this.dir=t}intersectsPlane(e,t,n){const r=B.vec3.dot(t,this.dir);if(Math.abs(r)<1e-6)return!1;const i=((e[0]-this.pos[0])*t[0]+(e[1]-this.pos[1])*t[1]+(e[2]-this.pos[2])*t[2])/r;return n[0]=this.pos[0]+this.dir[0]*i,n[1]=this.pos[1]+this.dir[1]*i,n[2]=this.pos[2]+this.dir[2]*i,!0}closestPointOnSphere(e,t,n){if(B.vec3.equals(this.pos,e)||0===t)return n[0]=n[1]=n[2]=0,!1;const[r,i,o]=this.dir,a=this.pos[0]-e[0],s=this.pos[1]-e[1],l=this.pos[2]-e[2],c=r*r+i*i+o*o,u=2*(a*r+s*i+l*o),h=u*u-4*c*(a*a+s*s+l*l-t*t);if(h<0){const e=Math.max(-u/2,0),c=a+r*e,h=s+i*e,d=l+o*e,p=Math.hypot(c,h,d);return n[0]=c*t/p,n[1]=h*t/p,n[2]=d*t/p,!1}{const e=(-u-Math.sqrt(h))/(2*c);if(e<0){const e=Math.hypot(a,s,l);return n[0]=a*t/e,n[1]=s*t/e,n[2]=l*t/e,!1}return n[0]=a+r*e,n[1]=s+i*e,n[2]=l+o*e,!0}}}class dc{constructor(e,t,n,r,i){this.TL=e,this.TR=t,this.BR=n,this.BL=r,this.horizon=i}static fromInvProjectionMatrix(e,t,n){const r=[-1,1,1],i=[1,1,1],o=[1,-1,1],a=[-1,-1,1],s=B.vec3.transformMat4(r,r,e),l=B.vec3.transformMat4(i,i,e),c=B.vec3.transformMat4(o,o,e),u=B.vec3.transformMat4(a,a,e);return new dc(s,l,c,u,t/n)}}function pc(e,t,n){let r=1/0,i=-1/0;const o=[];for(const a of e){B.vec3.sub(o,a,t);const e=B.vec3.dot(o,n);r=Math.min(r,e),i=Math.max(i,e)}return[r,i]}function fc(e,t){let n=!0;for(let r=0;r<e.planes.length;r++){const i=e.planes[r];let o=0;for(let e=0;e<t.length;e++)o+=B.vec3.dot(i,t[e])+i[3]>=0;if(0===o)return 0;o!==t.length&&(n=!1)}return n?2:1}function mc(e,t){for(const n of e.projections){const r=pc(t,e.points[0],n.axis);if(n.projection[1]<r[0]||n.projection[0]>r[1])return 0}return 1}function gc(e,t){let n=0;const r=[0,0,0,0];for(let i=0;i<e.length;i++)r[0]=e[i][0],r[1]=e[i][1],r[2]=e[i][2],r[3]=1,B.vec4.dot(r,t)>=0&&n++;return n}class yc{constructor(e,t){this.points=e||new Array(8).fill([0,0,0]),this.planes=t||new Array(6).fill([0,0,0,0]),this.bounds=_c.fromPoints(this.points),this.projections=[],this.frustumEdges=[B.vec3.sub([],this.points[2],this.points[3]),B.vec3.sub([],this.points[0],this.points[3]),B.vec3.sub([],this.points[4],this.points[0]),B.vec3.sub([],this.points[5],this.points[1]),B.vec3.sub([],this.points[6],this.points[2]),B.vec3.sub([],this.points[7],this.points[3])];for(const n of this.frustumEdges){const e=[0,-n[2],n[1]],t=[n[2],0,-n[0]];this.projections.push({axis:e,projection:pc(this.points,this.points[0],e)}),this.projections.push({axis:t,projection:pc(this.points,this.points[0],t)})}}static fromInvProjectionMatrix(e,t,n,r){const i=Math.pow(2,n),o=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((n=>{const o=B.vec4.transformMat4([],n,e),a=1/o[3]/t*i;return B.vec4.mul(o,o,[a,a,r?1/o[3]:a,a])})),a=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map((e=>{const t=B.vec3.sub([],o[e[0]],o[e[1]]),n=B.vec3.sub([],o[e[2]],o[e[1]]),r=B.vec3.normalize([],B.vec3.cross([],t,n)),i=-B.vec3.dot(r,o[e[1]]);return r.concat(i)})),s=[];for(let l=0;l<o.length;l++)s.push([o[l][0],o[l][1],o[l][2]]);return new yc(s,a)}intersectsPrecise(e,t,n){for(let r=0;r<t.length;r++)if(!gc(e,t[r]))return 0;for(let r=0;r<this.planes.length;r++)if(!gc(e,this.planes[r]))return 0;for(const r of n)for(const t of this.frustumEdges){const n=B.vec3.cross([],r,t),i=B.vec3.length(n);if(0===i)continue;B.vec3.scale(n,n,1/i);const o=pc(this.points,this.points[0],n),a=pc(e,this.points[0],n);if(o[0]>a[1]||a[0]>o[1])return 0}return 1}containsPoint(e){for(const t of this.planes){const n=t[3];if(B.vec3.dot([t[0],t[1],t[2]],e)+n<0)return!1}return!0}}class _c{static fromPoints(e){const t=[1/0,1/0,1/0],n=[-1/0,-1/0,-1/0];for(const r of e)B.vec3.min(t,t,r),B.vec3.max(n,n,r);return new _c(t,n)}static fromTileIdAndHeight(e,t,n){const r=1<<e.canonical.z,i=e.canonical.x,o=e.canonical.y;return new _c([i/r,o/r,t],[(i+1)/r,(o+1)/r,n])}static applyTransform(e,t){const n=e.getCorners();for(let r=0;r<n.length;++r)B.vec3.transformMat4(n[r],n[r],t);return _c.fromPoints(n)}static applyTransformFast(e,t){const n=[t[12],t[13],t[14]],r=[...n];for(let i=0;i<3;i++)for(let o=0;o<3;o++){const a=t[4*o+i],s=a*e.min[o],l=a*e.max[o];n[i]+=Math.min(s,l),r[i]+=Math.max(s,l)}return new _c(n,r)}static projectAabbCorners(e,t){const n=e.getCorners();for(let r=0;r<n.length;++r)B.vec3.transformMat4(n[r],n[r],t);return n}constructor(e,t){this.min=e,this.max=t,this.center=B.vec3.scale([],B.vec3.add([],this.min,this.max),.5)}quadrant(e){const t=[e%2==0,e<2],n=B.vec3.clone(this.min),r=B.vec3.clone(this.max);for(let i=0;i<t.length;i++)n[i]=t[i]?this.min[i]:this.center[i],r[i]=t[i]?this.center[i]:this.max[i];return r[2]=this.max[2],new _c(n,r)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}distanceZ(e){return Math.max(Math.min(this.max[2],e[2]),this.min[2])-e[2]}getCorners(){const e=this.min,t=this.max;return[[e[0],e[1],e[2]],[t[0],e[1],e[2]],[t[0],t[1],e[2]],[e[0],t[1],e[2]],[e[0],e[1],t[2]],[t[0],e[1],t[2]],[t[0],t[1],t[2]],[e[0],t[1],t[2]]]}intersects(e){return this.intersectsAabb(e.bounds)?fc(e,this.getCorners()):0}intersectsFlat(e){return this.intersectsAabb(e.bounds)?fc(e,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(e,t){return t||this.intersects(e)?mc(e,this.getCorners()):0}intersectsPreciseFlat(e,t){return t||this.intersectsFlat(e)?mc(e,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(e){for(let t=0;t<3;++t)if(this.min[t]>e.max[t]||e.min[t]>this.max[t])return!1;return!0}intersectsAabbXY(e){return!(this.min[0]>e.max[0]||e.min[0]>this.max[0]||this.min[1]>e.max[1]||e.min[1]>this.max[1])}encapsulate(e){for(let t=0;t<3;t++)this.min[t]=Math.min(this.min[t],e.min[t]),this.max[t]=Math.max(this.max[t],e.max[t])}encapsulatePoint(e){for(let t=0;t<3;t++)this.min[t]=Math.min(this.min[t],e[t]),this.max[t]=Math.max(this.max[t],e[t])}closestPoint(e){return[Math.max(Math.min(this.max[0],e[0]),this.min[0]),Math.max(Math.min(this.max[1],e[1]),this.min[1]),Math.max(Math.min(this.max[2],e[2]),this.min[2])]}}function vc(e){return e*qs/nl}so(_c,"Aabb");const xc=[new _c([Qs,Qs,Qs],[$s,$s,$s]),new _c([Qs,Qs,Qs],[0,0,$s]),new _c([0,Qs,Qs],[$s,0,$s]),new _c([Qs,0,Qs],[0,$s,$s]),new _c([0,0,Qs],[$s,$s,$s])];function bc(e,t,n){let r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const i=B.vec3.scale([],e._camera.position,e.worldSize),o=[t,n,1,1];B.vec4.transformMat4(o,o,e.pixelMatrixInverse),B.vec4.scale(o,o,1/o[3]);const a=B.vec3.sub([],o,i),s=B.vec3.normalize([],a),l=e.globeMatrix,c=[l[12],l[13],l[14]],u=B.vec3.sub([],c,i),h=B.vec3.length(u),d=B.vec3.normalize([],u),p=e.worldSize/(2*Math.PI),f=B.vec3.dot(d,s),m=Math.asin(p/h);if(m<Math.acos(f)){if(!r)return null;const e=[],t=[];B.vec3.scale(e,s,h/f),B.vec3.normalize(t,B.vec3.sub(t,e,u)),B.vec3.normalize(s,B.vec3.add(s,u,B.vec3.scale(s,t,Math.tan(m)*h)))}const g=[];new hc(i,s).closestPointOnSphere(c,p,g);const y=B.vec3.normalize([],be(l,0)),_=B.vec3.normalize([],be(l,1)),v=B.vec3.normalize([],be(l,2)),x=B.vec3.dot(y,g),b=B.vec3.dot(_,g),w=B.vec3.dot(v,g),S=Y(Math.asin(-b/p));let T=Y(Math.atan2(x,w));T=e.center.lng+function(e,t){const n=(t-e+180)%360-180;return n<-180?n+360:n}(e.center.lng,T);const E=cl(T),A=ee(ul(S),0,1);return new xl(E,A)}class wc{constructor(e,t,n){this.a=B.vec3.sub([],e,n),this.b=B.vec3.sub([],t,n),this.center=n;const r=B.vec3.normalize([],this.a),i=B.vec3.normalize([],this.b);this.angle=Math.acos(B.vec3.dot(r,i))}}function Sc(e,t){if(0===e.angle)return null;let n;return n=0===e.a[t]?1/e.angle*.5*Math.PI:1/e.angle*Math.atan(e.b[t]/e.a[t]/Math.sin(e.angle)-1/Math.tan(e.angle)),n<0||n>1?null:function(e,t,n,r){const i=Math.sin(n);return e*(Math.sin((1-r)*n)/i)+t*(Math.sin(r*n)/i)}(e.a[t],e.b[t],e.angle,ee(n,0,1))+e.center[t]}function Tc(e){if(e.z<=1)return xc[e.z+2*e.y+e.x];const t=kc(Pc(e));return _c.fromPoints(t)}function Ec(e,t,n){return B.vec3.scale(e,e,1-n),B.vec3.scaleAndAdd(e,e,t,n)}function Ac(e,t,n){for(const r of e)B.vec3.transformMat4(r,r,t),B.vec3.scale(r,r,n)}function Mc(e,t,n,r){const i=t/e.worldSize,o=e.globeMatrix;if(n.z<=1){const e=Tc(n).getCorners();return Ac(e,o,i),_c.fromPoints(e)}const a=Pc(n,r),s=kc(a,qs+vc(e._tileCoverLift));Ac(s,o,i);const l=Number.MAX_VALUE,c=[-l,-l,-l],u=[l,l,l];if(a.contains(e.center)){for(const e of s)B.vec3.min(u,u,e),B.vec3.max(c,c,e);c[2]=0;const t=e.point,n=[t.x*i,t.y*i,0];return B.vec3.min(u,u,n),B.vec3.max(c,c,n),new _c(u,c)}if(e._tileCoverLift>0){for(const e of s)B.vec3.min(u,u,e),B.vec3.max(c,c,e);return new _c(u,c)}const h=[o[12]*i,o[13]*i,o[14]*i],d=a.getCenter(),p=ee(e.center.lat,-ml,ml),f=ee(d.lat,-ml,ml),m=cl(e.center.lng),g=ul(p);let y=m-cl(d.lng);const _=g-ul(f);y>.5?y-=1:y<-.5&&(y+=1);let v=0;if(Math.abs(y)>Math.abs(_))v=y>=0?1:3;else{v=_>=0?0:2;const e=[o[4]*i,o[5]*i,o[6]*i],t=-Math.sin(X(_>=0?a.getSouth():a.getNorth()))*qs;B.vec3.scaleAndAdd(h,h,e,t)}const x=s[v],b=s[(v+1)%4],w=new wc(x,b,h),S=[Sc(w,0)||x[0],Sc(w,1)||x[1],Sc(w,2)||x[2]],T=Rc(e.zoom);if(T>0){const r=function(e,t,n,r,i){let{x:o,y:a,z:s}=e;const l=1/(1<<s);let c=o*l,u=c+l,h=a*l,d=h+l,p=0;const f=(c+u)/2-r;return f>.5?p=-1:f<-.5&&(p=1),c=((c+p)*t-(r*=t))*n+r,u=((u+p)*t-r)*n+r,h=(h*t-(i*=t))*n+i,d=(d*t-i)*n+i,[[c,d,0],[u,d,0],[u,h,0],[c,h,0]]}(n,t,e._pixelsPerMercatorPixel,m,g);for(let e=0;e<s.length;e++)Ec(s[e],r[e],T);const i=B.vec3.add([],r[v],r[(v+1)%4]);B.vec3.scale(i,i,.5),Ec(S,i,T)}for(const E of s)B.vec3.min(u,u,E),B.vec3.max(c,c,E);return u[2]=Math.min(x[2],b[2]),B.vec3.min(u,u,S),B.vec3.max(c,c,S),new _c(u,c)}function Pc(e){let{x:t,y:n,z:r}=e,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const o=1/(1<<r),a=new il(dl(t*o),n===(1<<r)-1&&i?-90:pl((n+1)*o)),s=new il(dl((t+1)*o),0===n&&i?90:pl(n*o));return new ol(a,s)}function kc(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:qs;const n=X(e.getNorth()),r=X(e.getSouth()),i=Math.cos(n),o=Math.cos(r),a=Math.sin(n),s=Math.sin(r),l=e.getWest(),c=e.getEast();return[el(o,s,l,t),el(o,s,c,t),el(i,a,c,t),el(i,a,l,t)]}function Cc(e,t,n,r){const i=1<<n.z,o=(e/Jn+n.x)/i;return tl(pl((t/Jn+n.y)/i),dl(o),r)}function jc(e){let{min:t,max:n}=e;return Ys/Math.max(n[0]-t[0],n[1]-t[1],n[2]-t[2])}const Ic=new Float64Array(16);function Oc(e){const t=jc(e),n=B.mat4.fromScaling(Ic,[t,t,t]);return B.mat4.translate(n,n,B.vec3.negate([],e.min))}function Nc(e){const t=B.mat4.fromTranslation(Ic,e.min),n=1/jc(e);return B.mat4.scale(t,t,[n,n,n])}function Dc(e){const t=Jn/(2*Math.PI);return e/(2*Math.PI)/t}function Lc(e,t){return Jn/(512*Math.pow(2,e))*jc(Tc(t))}function zc(e,t,n,r,i){const o=Dc(n),a=[e,t,-n/(2*Math.PI)],s=B.mat4.identity(new Float64Array(16));return B.mat4.translate(s,s,a),B.mat4.scale(s,s,[o,o,o]),B.mat4.rotateX(s,s,X(-i)),B.mat4.rotateY(s,s,X(-r)),s}function Rc(e){return te(Ws,Xs,e)}function Fc(e,t){const n=tl(t.lat,t.lng),r=function(e){const t=tl(e._center.lat,e._center.lng),n=B.vec3.fromValues(0,1,0);let r=B.vec3.cross([],n,t);const i=B.mat4.fromRotation([],-e.angle,t);r=B.vec3.transformMat4(r,r,i),B.mat4.fromRotation(i,-e._pitch,r);const o=B.vec3.normalize([],t);return B.vec3.scale(o,o,vc(e.cameraToCenterDistance/e.pixelsPerMeter)),B.vec3.transformMat4(o,o,i),B.vec3.add([],t,o)}(e),i=B.vec3.subtract([],r,n);return B.vec3.angle(i,n)}function Bc(e,t){return Fc(e,t)>Math.PI/2*1.01}const Vc=X(85),Uc=Math.cos(Vc),Gc=Math.sin(Vc),Hc=B.mat4.create(),Zc=e=>{const t=[];return"map"===e.paint.get("circle-pitch-alignment")&&t.push("PITCH_WITH_MAP"),"map"===e.paint.get("circle-pitch-scale")&&t.push("SCALE_WITH_MAP"),t};function qc(e,t,n,r,i,o,a,s,l){if(o&&e.queryGeometry.isAboveHorizon)return!1;o&&(l*=e.pixelToTileUnitsFactor);const c=e.tileID.canonical,u=n.projection.upVectorScale(c,n.center.lat,n.worldSize).metersToTile;for(const h of t)for(const t of h){const h=t.add(s),d=i&&n.elevation?n.elevation.exaggeration()*i.getElevationAt(h.x,h.y,!0):0,p=n.projection.projectTilePoint(h.x,h.y,c);if(d>0){const e=n.projection.upVector(c,h.x,h.y);p.x+=e[0]*u*d,p.y+=e[1]*u*d,p.z+=e[2]*u*d}const f=o?h:Wc(p.x,p.y,p.z,r),m=o?e.tilespaceRays.map((e=>Kc(e,d))):e.queryGeometry.screenGeometry,g=B.vec4.transformMat4([],[p.x,p.y,p.z,1],r);if(!a&&o?l*=g[3]/n.cameraToCenterDistance:a&&!o&&(l*=n.cameraToCenterDistance/g[3]),o){const e=pl((t.y/Jn+c.y)/(1<<c.z));l/=n.projection.pixelsPerMeter(e,1)/hl(1,e)}if(Nl(m,f,l))return!0}return!1}function Wc(e,t,n,r){const i=B.vec4.transformMat4([],[e,t,n,1],r);return new H(i[0]/i[3],i[1]/i[3])}const Xc=B.vec3.fromValues(0,0,0),Yc=B.vec3.fromValues(0,0,1);function Kc(e,t){const n=B.vec3.create();return Xc[2]=t,e.intersectsPlane(Xc,Yc,n),new H(n[0],n[1])}class Jc extends Il{}let Qc,$c,eu,tu;function nu(e,t,n,r){let{width:i,height:o}=t;if(r){if(r instanceof Uint8ClampedArray)r=new Uint8Array(r.buffer);else if(r.length!==i*o*n)throw new RangeError("mismatched image size")}else r=new Uint8Array(i*o*n);return e.width=i,e.height=o,e.data=r,e}function ru(e,t,n){const{width:r,height:i}=t;r===e.width&&i===e.height||(iu(e,t,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,r),height:Math.min(e.height,i)},n,null),e.width=r,e.height=i,e.data=t.data)}function iu(e,t,n,r,i,o,a,s){if(0===i.width||0===i.height)return t;if(i.width>e.width||i.height>e.height||n.x>e.width-i.width||n.y>e.height-i.height)throw new RangeError("out of range source coordinates for image copy");if(i.width>t.width||i.height>t.height||r.x>t.width-i.width||r.y>t.height-i.height)throw new RangeError("out of range destination coordinates for image copy");const l=e.data,c=t.data,u=4===o&&s;for(let h=0;h<i.height;h++){const s=((n.y+h)*e.width+n.x)*o,d=((r.y+h)*t.width+r.x)*o;if(u)for(let e=0;e<i.width;e++){const t=s+e*o+3,n=d+e*o;c[n+0]=255,c[n+1]=255,c[n+2]=255,c[n+3]=l[t]}else if(a)for(let e=0;e<i.width;e++){const t=s+e*o,n=d+e*o,r=l[t+3],i=new Mt(l[t+0]/255*r,l[t+1]/255*r,l[t+2]/255*r,r).toRenderColor(a).toArray();c[n+0]=i[0],c[n+1]=i[1],c[n+2]=i[2],c[n+3]=i[3]}else for(let e=0;e<i.width*o;e++)c[d+e]=l[s+e]}return t}so(Jc,"HeatmapBucket",{omit:["layers"]});class ou{constructor(e,t){nu(this,e,1,t)}resize(e){ru(this,new ou(e),1)}clone(){return new ou({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,t,n,r,i){iu(e,t,n,r,i,1,null)}}class au{constructor(e,t){nu(this,e,4,t)}resize(e){ru(this,new au(e),4)}replace(e,t){t?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new au({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,t,n,r,i,o,a){iu(e,t,n,r,i,4,o,a)}}class su{constructor(e,t){this.width=e.width,this.height=e.height,this.data=t instanceof Uint8Array?new Float32Array(t.buffer):t}}function lu(e){const t={},n=e.resolution||256,r=e.clips?e.clips.length:1,i=e.image||new au({width:n,height:r}),o=(n,r,o)=>{t[e.evaluationKey]=o;const a=e.expression.evaluate(t);a&&(i.data[n+r+0]=Math.floor(255*a.r/a.a),i.data[n+r+1]=Math.floor(255*a.g/a.a),i.data[n+r+2]=Math.floor(255*a.b/a.a),i.data[n+r+3]=Math.floor(255*a.a))};if(e.clips)for(let a=0,s=0;a<r;++a,s+=4*n)for(let t=0,r=0;t<n;t++,r+=4){const i=t/(n-1),{start:l,end:c}=e.clips[a];o(s,r,l*(1-i)+c*i)}else for(let a=0,s=0;a<n;a++,s+=4)o(0,s,a/(n-1));return i}so(ou,"AlphaImage"),so(au,"RGBAImage");const cu=ya([{name:"a_pos",components:2,type:"Int16"}],4),{members:uu}=cu;function hu(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;const r=t&&t.length,i=r?t[0]*n:e.length;let o=du(e,0,i,n,!0);const a=[];if(!o||o.next===o.prev)return a;let s,l,c;if(r&&(o=function(e,t,n,r){const i=[];for(let o=0,a=t.length;o<a;o++){const n=du(e,t[o]*r,o<a-1?t[o+1]*r:e.length,r,!1);n===n.next&&(n.steiner=!0),i.push(Su(n))}i.sort(vu);for(let o=0;o<i.length;o++)n=xu(i[o],n);return n}(e,t,o,n)),e.length>80*n){s=1/0,l=1/0;let t=-1/0,r=-1/0;for(let o=n;o<i;o+=n){const n=e[o],i=e[o+1];n<s&&(s=n),i<l&&(l=i),n>t&&(t=n),i>r&&(r=i)}c=Math.max(t-s,r-l),c=0!==c?32767/c:0}return fu(o,a,n,s,l,c,0),a}function du(e,t,n,r,i){let o;if(i===function(e,t,n,r){let i=0;for(let o=t,a=n-r;o<n;o+=r)i+=(e[a]-e[o])*(e[o+1]+e[a+1]),a=o;return i}(e,t,n,r)>0)for(let a=t;a<n;a+=r)o=Ou(a/r|0,e[a],e[a+1],o);else for(let a=n-r;a>=t;a-=r)o=Ou(a/r|0,e[a],e[a+1],o);return o&&Mu(o,o.next)&&(Nu(o),o=o.next),o}function pu(e,t){if(!e)return e;t||(t=e);let n,r=e;do{if(n=!1,r.steiner||!Mu(r,r.next)&&0!==Au(r.prev,r,r.next))r=r.next;else{if(Nu(r),r=t=r.prev,r===r.next)break;n=!0}}while(n||r!==t);return t}function fu(e,t,n,r,i,o,a){if(!e)return;!a&&o&&function(e,t,n,r){let i=e;do{0===i.z&&(i.z=wu(i.x,i.y,t,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){let t,n=1;do{let r,i=e;e=null;let o=null;for(t=0;i;){t++;let a=i,s=0;for(let e=0;e<n&&(s++,a=a.nextZ,a);e++);let l=n;for(;s>0||l>0&&a;)0!==s&&(0===l||!a||i.z<=a.z)?(r=i,i=i.nextZ,s--):(r=a,a=a.nextZ,l--),o?o.nextZ=r:e=r,r.prevZ=o,o=r;i=a}o.nextZ=null,n*=2}while(t>1)}(i)}(e,r,i,o);let s=e;for(;e.prev!==e.next;){const l=e.prev,c=e.next;if(o?gu(e,r,i,o):mu(e))t.push(l.i,e.i,c.i),Nu(e),e=c.next,s=c.next;else if((e=c)===s){a?1===a?fu(e=yu(pu(e),t),t,n,r,i,o,2):2===a&&_u(e,t,n,r,i,o):fu(pu(e),t,n,r,i,o,1);break}}}function mu(e){const t=e.prev,n=e,r=e.next;if(Au(t,n,r)>=0)return!1;const i=t.x,o=n.x,a=r.x,s=t.y,l=n.y,c=r.y,u=i<o?i<a?i:a:o<a?o:a,h=s<l?s<c?s:c:l<c?l:c,d=i>o?i>a?i:a:o>a?o:a,p=s>l?s>c?s:c:l>c?l:c;let f=r.next;for(;f!==t;){if(f.x>=u&&f.x<=d&&f.y>=h&&f.y<=p&&Tu(i,s,o,l,a,c,f.x,f.y)&&Au(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function gu(e,t,n,r){const i=e.prev,o=e,a=e.next;if(Au(i,o,a)>=0)return!1;const s=i.x,l=o.x,c=a.x,u=i.y,h=o.y,d=a.y,p=s<l?s<c?s:c:l<c?l:c,f=u<h?u<d?u:d:h<d?h:d,m=s>l?s>c?s:c:l>c?l:c,g=u>h?u>d?u:d:h>d?h:d,y=wu(p,f,t,n,r),_=wu(m,g,t,n,r);let v=e.prevZ,x=e.nextZ;for(;v&&v.z>=y&&x&&x.z<=_;){if(v.x>=p&&v.x<=m&&v.y>=f&&v.y<=g&&v!==i&&v!==a&&Tu(s,u,l,h,c,d,v.x,v.y)&&Au(v.prev,v,v.next)>=0)return!1;if(v=v.prevZ,x.x>=p&&x.x<=m&&x.y>=f&&x.y<=g&&x!==i&&x!==a&&Tu(s,u,l,h,c,d,x.x,x.y)&&Au(x.prev,x,x.next)>=0)return!1;x=x.nextZ}for(;v&&v.z>=y;){if(v.x>=p&&v.x<=m&&v.y>=f&&v.y<=g&&v!==i&&v!==a&&Tu(s,u,l,h,c,d,v.x,v.y)&&Au(v.prev,v,v.next)>=0)return!1;v=v.prevZ}for(;x&&x.z<=_;){if(x.x>=p&&x.x<=m&&x.y>=f&&x.y<=g&&x!==i&&x!==a&&Tu(s,u,l,h,c,d,x.x,x.y)&&Au(x.prev,x,x.next)>=0)return!1;x=x.nextZ}return!0}function yu(e,t){let n=e;do{const r=n.prev,i=n.next.next;!Mu(r,i)&&Pu(r,n,n.next,i)&&ju(r,i)&&ju(i,r)&&(t.push(r.i,n.i,i.i),Nu(n),Nu(n.next),n=e=i),n=n.next}while(n!==e);return pu(n)}function _u(e,t,n,r,i,o){let a=e;do{let e=a.next.next;for(;e!==a.prev;){if(a.i!==e.i&&Eu(a,e)){let s=Iu(a,e);return a=pu(a,a.next),s=pu(s,s.next),fu(a,t,n,r,i,o,0),void fu(s,t,n,r,i,o,0)}e=e.next}a=a.next}while(a!==e)}function vu(e,t){return e.x-t.x}function xu(e,t){const n=function(e,t){let n=t;const r=e.x,i=e.y;let o,a=-1/0;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){const e=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(e<=r&&e>a&&(a=e,o=n.x<n.next.x?n:n.next,e===r))return o}n=n.next}while(n!==t);if(!o)return null;const s=o,l=o.x,c=o.y;let u=1/0;n=o;do{if(r>=n.x&&n.x>=l&&r!==n.x&&Tu(i<c?r:a,i,l,c,i<c?a:r,i,n.x,n.y)){const t=Math.abs(i-n.y)/(r-n.x);ju(n,e)&&(t<u||t===u&&(n.x>o.x||n.x===o.x&&bu(o,n)))&&(o=n,u=t)}n=n.next}while(n!==s);return o}(e,t);if(!n)return t;const r=Iu(n,e);return pu(r,r.next),pu(n,n.next)}function bu(e,t){return Au(e.prev,e,t.prev)<0&&Au(t.next,e,e.next)<0}function wu(e,t,n,r,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*i|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-r)*i|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Su(e){let t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function Tu(e,t,n,r,i,o,a,s){return(i-a)*(t-s)>=(e-a)*(o-s)&&(e-a)*(r-s)>=(n-a)*(t-s)&&(n-a)*(o-s)>=(i-a)*(r-s)}function Eu(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){let n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&Pu(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(ju(e,t)&&ju(t,e)&&function(e,t){let n=e,r=!1;const i=(e.x+t.x)/2,o=(e.y+t.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==e);return r}(e,t)&&(Au(e.prev,e,t.prev)||Au(e,t.prev,t))||Mu(e,t)&&Au(e.prev,e,e.next)>0&&Au(t.prev,t,t.next)>0)}function Au(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function Mu(e,t){return e.x===t.x&&e.y===t.y}function Pu(e,t,n,r){const i=Cu(Au(e,t,n)),o=Cu(Au(e,t,r)),a=Cu(Au(n,r,e)),s=Cu(Au(n,r,t));return i!==o&&a!==s||!(0!==i||!ku(e,n,t))||!(0!==o||!ku(e,r,t))||!(0!==a||!ku(n,e,r))||!(0!==s||!ku(n,t,r))}function ku(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function Cu(e){return e>0?1:e<0?-1:0}function ju(e,t){return Au(e.prev,e,e.next)<0?Au(e,t,e.next)>=0&&Au(e,e.prev,t)>=0:Au(e,t,e.prev)<0||Au(e,e.next,t)<0}function Iu(e,t){const n=Du(e.i,e.x,e.y),r=Du(t.i,t.x,t.y),i=e.next,o=t.prev;return e.next=t,t.prev=e,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function Ou(e,t,n,r){const i=Du(e,t,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function Nu(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Du(e,t,n){return{i:e,x:t,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function Lu(e,t){const n=e.length;if(n<=1)return[e];const r=[];let i,o;for(let a=0;a<n;a++){const t=ge(e[a]);0!==t&&(e[a].area=Math.abs(t),void 0===o&&(o=t<0),o===t<0?(i&&r.push(i),i=[e[a]]):i.push(e[a]))}if(i&&r.push(i),t>1)for(let a=0;a<r.length;a++)r[a].length<=t||(xn(r[a],t,1,r[a].length-1,zu),r[a]=r[a].slice(0,t));return r}function zu(e,t){return t.area-e.area}function Ru(e,t,n){const r=n.patternDependencies;let i=!1;for(const o of t){const t=o.paint.get("".concat(e,"-pattern"));t.isConstant()||(i=!0);const n=t.constantOr(null);n&&(i=!0,r[n]=!0)}return i}function Fu(e,t,n,r,i){const o=i.patternDependencies;for(const a of t){const t=a.paint.get("".concat(e,"-pattern")).value;if("constant"!==t.kind){let e=t.evaluate({zoom:r},n,{},i.availableImages);e=e&&e.name?e.name:e,o[e]=!0,n.patterns[a.id]=e}}return n}class Bu{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((e=>e.fqid)),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new va,this.indexArray=new za,this.indexArray2=new Ia,this.programConfigurations=new Bs(e.layers,{zoom:e.zoom,lut:e.lut}),this.segments=new ps,this.segments2=new ps,this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id)),this.projection=e.projection}updateFootprints(e,t){}populate(e,t,n,r){this.hasPattern=Ru("fill",this.layers,t);const i=this.layers[0].layout.get("fill-sort-key"),o=[];for(const{feature:a,id:s,index:l,sourceLayerIndex:c}of e){const e=this.layers[0]._featureFilter.needGeometry,u=kl(a,e);if(!this.layers[0]._featureFilter.filter(new No(this.zoom),u,n))continue;const h=i?i.evaluate(u,{},n,t.availableImages):void 0,d={id:s,properties:a.properties,type:a.type,sourceLayerIndex:c,index:l,geometry:e?u.geometry:Pl(a,n,r),patterns:{},sortKey:h};o.push(d)}i&&o.sort(((e,t)=>e.sortKey-t.sortKey));for(const a of o){const{geometry:r,index:i,sourceLayerIndex:o}=a;if(this.hasPattern){const e=Fu("fill",this.layers,a,this.zoom,t);this.patternFeatures.push(e)}else this.addFeature(a,r,i,n,{},t.availableImages,t.brightness);t.featureIndex.insert(e[i].feature,r,i,o,this.index)}}update(e,t,n,r,i){const o=0!==Object.keys(e).length;o&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(e,t,o?this.stateDependentLayers:this.layers,n,r,i)}addFeatures(e,t,n,r,i,o){for(const a of this.patternFeatures)this.addFeature(a,a.geometry,a.index,t,n,r,o)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,uu),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,t,n,r,i){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],a=arguments.length>6?arguments[6]:void 0;for(const s of Lu(t,500)){let e=0;for(const a of s)e+=a.length;const t=this.segments.prepareSegment(e,this.layoutVertexArray,this.indexArray),n=t.vertexLength,r=[],i=[];for(const a of s){if(0===a.length)continue;a!==s[0]&&i.push(r.length/2);const e=this.segments2.prepareSegment(a.length,this.layoutVertexArray,this.indexArray2),t=e.vertexLength;this.layoutVertexArray.emplaceBack(a[0].x,a[0].y),this.indexArray2.emplaceBack(t+a.length-1,t),r.push(a[0].x),r.push(a[0].y);for(let n=1;n<a.length;n++)this.layoutVertexArray.emplaceBack(a[n].x,a[n].y),this.indexArray2.emplaceBack(t+n-1,t+n),r.push(a[n].x),r.push(a[n].y);e.vertexLength+=a.length,e.primitiveLength+=a.length}const o=hu(r,i);for(let a=0;a<o.length;a+=3)this.indexArray.emplaceBack(n+o[a],n+o[a+1],n+o[a+2]);t.vertexLength+=e,t.primitiveLength+=o.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,n,i,o,r,a)}}let Vu,Uu,Gu,Hu;so(Bu,"FillBucket",{omit:["layers","patternFeatures"]});class Zu{constructor(e,t,n,r){if(this.triangleCount=t.length/3,this.min=new H(0,0),this.max=new H(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],0===this.triangleCount||0===e.length)return;const[i,o]=[e[0].clone(),e[0].clone()];for(let u=1;u<e.length;++u){const t=e[u];i.x=Math.min(i.x,t.x),i.y=Math.min(i.y,t.y),o.x=Math.max(o.x,t.x),o.y=Math.max(o.y,t.y)}if(r){const e=Math.ceil(Math.max(o.x-i.x,o.y-i.y)/r);n=Math.max(n,e)}if(0===n)return;this.min=i,this.max=o;const a=this.max.sub(this.min);a.x=Math.max(a.x,1),a.y=Math.max(a.y,1);const s=Math.max(a.x,a.y)/n;this.cellsX=Math.max(1,Math.ceil(a.x/s)),this.cellsY=Math.max(1,Math.ceil(a.y/s)),this.xScale=1/s,this.yScale=1/s;const l=[];for(let u=0;u<this.triangleCount;u++){const n=e[t[3*u+0]].sub(this.min),r=e[t[3*u+1]].sub(this.min),i=e[t[3*u+2]].sub(this.min),o=qu(Math.floor(Math.min(n.x,r.x,i.x)),this.xScale,this.cellsX),a=qu(Math.floor(Math.max(n.x,r.x,i.x)),this.xScale,this.cellsX),c=qu(Math.floor(Math.min(n.y,r.y,i.y)),this.yScale,this.cellsY),h=qu(Math.floor(Math.max(n.y,r.y,i.y)),this.yScale,this.cellsY),d=new H(0,0),p=new H(0,0),f=new H(0,0),m=new H(0,0);for(let e=c;e<=h;++e){d.y=p.y=e*s,f.y=m.y=(e+1)*s;for(let t=o;t<=a;++t)d.x=f.x=t*s,p.x=m.x=(t+1)*s,(ql(n,r,i,d,p,m)||ql(n,r,i,d,m,f))&&l.push({cellIdx:e*this.cellsX+t,triIdx:u})}}if(0===l.length)return;l.sort(((e,t)=>e.cellIdx-t.cellIdx||e.triIdx-t.triIdx));let c=0;for(;c<l.length;){const e=l[c].cellIdx,t={start:this.payload.length,len:0};for(;c<l.length&&l[c].cellIdx===e;)++t.len,this.payload.push(l[c++].triIdx);this.cells[e]=t}}_lazyInitLookup(){this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8))),this.lookup.fill(0)}queryPoint(e,t){if(0===this.triangleCount||0===this.cells.length)return;if(e.x>this.max.x||this.min.x>e.x||e.y>this.max.y||this.min.y>e.y)return;const n=qu(e.x-this.min.x,this.xScale,this.cellsX),r=qu(e.y-this.min.y,this.yScale,this.cellsY),i=this.cells[r*this.cellsX+n];if(i){this._lazyInitLookup();for(let e=0;e<i.len;e++){const n=this.payload[i.start+e],r=Math.floor(n/8),o=1<<n%8;if(!(this.lookup[r]&o)&&(this.lookup[r]|=o,t.push(n),t.length===this.triangleCount))return}}}query(e,t,n){if(0===this.triangleCount||0===this.cells.length)return;if(e.x>this.max.x||this.min.x>t.x)return;if(e.y>this.max.y||this.min.y>t.y)return;this._lazyInitLookup();const r=qu(e.x-this.min.x,this.xScale,this.cellsX),i=qu(t.x-this.min.x,this.xScale,this.cellsX),o=qu(e.y-this.min.y,this.yScale,this.cellsY),a=qu(t.y-this.min.y,this.yScale,this.cellsY);for(let s=o;s<=a;s++)for(let e=r;e<=i;e++){const t=this.cells[s*this.cellsX+e];if(t)for(let e=0;e<t.len;e++){const r=this.payload[t.start+e],i=Math.floor(r/8),o=1<<r%8;if(!(this.lookup[i]&o)&&(this.lookup[i]|=o,n.push(r),n.length===this.triangleCount))return}}}}function qu(e,t,n){return Math.max(0,Math.min(n-1,Math.floor(e*t)))}so(Zu,"TriangleGridIndex");class Wu{constructor(e){this.zoom=e.zoom,this.layers=e.layers,this.layerIds=this.layers.map((e=>e.fqid)),this.index=e.index,this.hasPattern=!1,this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id)),this.footprints=[]}updateFootprints(e,t){for(const n of this.footprints)t.push({footprint:n,id:e})}populate(e,t,n,r){const i=[];for(const{feature:o,id:a,index:s,sourceLayerIndex:l}of e){const e=this.layers[0]._featureFilter.needGeometry,t=kl(o,e);if(!this.layers[0]._featureFilter.filter(new No(this.zoom),t,n))continue;const c={id:a,properties:o.properties,type:o.type,sourceLayerIndex:l,index:s,geometry:e?t.geometry:Pl(o,n,r),patterns:{}};i.push(c)}for(const o of i){const{geometry:r,index:i,sourceLayerIndex:a}=o;this.addFeature(o,r,i,n,{},t.availableImages,t.brightness),t.featureIndex.insert(e[i].feature,r,i,a,this.index)}}isEmpty(){return 0===this.footprints.length}uploadPending(){return!1}upload(e){}update(e,t,n,r,i){}destroy(){}addFeature(e,t,n,r,i){for(const o of Lu(t,2)){const e=[],t=[],n=[],r=new H(1/0,1/0),i=new H(-1/0,-1/0);for(const l of o)if(0!==l.length){l!==o[0]&&n.push(t.length/2);for(let n=0;n<l.length;n++)t.push(l[n].x),t.push(l[n].y),e.push(l[n]),r.x=Math.min(r.x,l[n].x),r.y=Math.min(r.y,l[n].y),i.x=Math.max(i.x,l[n].x),i.y=Math.max(i.y,l[n].y)}const a=hu(t,n),s=new Zu(e,a,8,256);this.footprints.push({vertices:e,indices:a,grid:s,min:r,max:i})}}}so(Wu,"ClipBucket",{omit:["layers"]});const Xu=ya([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),Yu=ya([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),Ku=ya([{name:"a_centroid_pos",components:2,type:"Uint16"}]),Ju=ya([{name:"a_join_normal_inside",components:3,type:"Int16"}]),Qu=ya([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),$u=ya([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:eh}=Xu;var th,nh,rh,ih,oh,ah,sh,lh={};function ch(){if(nh)return th;nh=1;var e=G();function t(e,t,r,i,o){this.properties={},this.extent=r,this.type=0,this._pbf=e,this._geometry=-1,this._keys=i,this._values=o,e.readFields(n,this,t)}function n(e,t,n){1==e?t.id=n.readVarint():2==e?function(e,t){for(var n=e.readVarint()+e.pos;e.pos<n;){var r=t._keys[e.readVarint()],i=t._values[e.readVarint()];t.properties[r]=i}}(n,t):3==e?t.type=n.readVarint():4==e&&(t._geometry=n.pos)}function r(e){for(var t,n,r=0,i=0,o=e.length,a=o-1;i<o;a=i++)r+=((n=e[a]).x-(t=e[i]).x)*(t.y+n.y);return r}return th=t,t.types=["Unknown","Point","LineString","Polygon"],t.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var n,r=t.readVarint()+t.pos,i=1,o=0,a=0,s=0,l=[];t.pos<r;){if(o<=0){var c=t.readVarint();i=7&c,o=c>>3}if(o--,1===i||2===i)a+=t.readSVarint(),s+=t.readSVarint(),1===i&&(n&&l.push(n),n=[]),n.push(new e(a,s));else{if(7!==i)throw new Error("unknown command "+i);n&&n.push(n[0].clone())}}return n&&l.push(n),l},t.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,n=1,r=0,i=0,o=0,a=1/0,s=-1/0,l=1/0,c=-1/0;e.pos<t;){if(r<=0){var u=e.readVarint();n=7&u,r=u>>3}if(r--,1===n||2===n)(i+=e.readSVarint())<a&&(a=i),i>s&&(s=i),(o+=e.readSVarint())<l&&(l=o),o>c&&(c=o);else if(7!==n)throw new Error("unknown command "+n)}return[a,l,s,c]},t.prototype.toGeoJSON=function(e,n,i){var o,a,s=this.extent*Math.pow(2,i),l=this.extent*e,c=this.extent*n,u=this.loadGeometry(),h=t.types[this.type];function d(e){for(var t=0;t<e.length;t++){var n=e[t];e[t]=[360*(n.x+l)/s-180,360/Math.PI*Math.atan(Math.exp((180-360*(n.y+c)/s)*Math.PI/180))-90]}}switch(this.type){case 1:var p=[];for(o=0;o<u.length;o++)p[o]=u[o][0];d(u=p);break;case 2:for(o=0;o<u.length;o++)d(u[o]);break;case 3:for(u=function(e){var t=e.length;if(t<=1)return[e];for(var n,i,o=[],a=0;a<t;a++){var s=r(e[a]);0!==s&&(void 0===i&&(i=s<0),i===s<0?(n&&o.push(n),n=[e[a]]):n.push(e[a]))}return n&&o.push(n),o}(u),o=0;o<u.length;o++)for(a=0;a<u[o].length;a++)d(u[o][a])}1===u.length?u=u[0]:h="Multi"+h;var f={type:"Feature",geometry:{type:h,coordinates:u},properties:this.properties};return"id"in this&&(f.id=this.id),f},th}function uh(){if(ih)return rh;ih=1;var e=ch();function t(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(n,this,t),this.length=this._features.length}function n(e,t,n){15===e?t.version=n.readVarint():1===e?t.name=n.readString():5===e?t.extent=n.readVarint():2===e?t._features.push(n.pos):3===e?t._keys.push(n.readString()):4===e&&t._values.push(function(e){for(var t=null,n=e.readVarint()+e.pos;e.pos<n;){var r=e.readVarint()>>3;t=1===r?e.readString():2===r?e.readFloat():3===r?e.readDouble():4===r?e.readVarint64():5===r?e.readVarint():6===r?e.readSVarint():7===r?e.readBoolean():null}return t}(n))}return rh=t,t.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var n=this._pbf.readVarint()+this._pbf.pos;return new e(this._pbf,n,this.extent,this._keys,this._values)},rh}function hh(){return sh||(sh=1,lh.VectorTile=function(){if(ah)return oh;ah=1;var e=uh();function t(t,n,r){if(3===t){var i=new e(r,r.readVarint()+r.pos);i.length&&(n[i.name]=i)}}return oh=function(e,n){this.layers=e.readFields(t,{},n)},oh}(),lh.VectorTileFeature=ch(),lh.VectorTileLayer=uh()),lh}var dh=hh();class ph extends H{constructor(e,t,n){super(e,t),this.z=n}}class fh extends ph{constructor(e,t,n,r){super(e,t,n),this.w=r}}function mh(e,t,n,r){const i=[],o=0===r?(e,t,n,r,i,o)=>{e.push(new H(o,n+(o-t)/(r-t)*(i-n)))}:(e,t,n,r,i,o)=>{e.push(new H(t+(o-n)/(i-n)*(r-t),o))};for(const a of e){const e=[];for(const i of a){if(i.length<=2)continue;const a=[];for(let e=0;e<i.length-1;e++){const s=i[e].x,l=i[e].y,c=i[e+1].x,u=i[e+1].y,h=0===r?s:l,d=0===r?c:u;h<t?d>t&&o(a,s,l,c,u,t):h>n?d<n&&o(a,s,l,c,u,n):a.push(i[e]),d<t&&h>=t&&o(a,s,l,c,u,t),d>n&&h<=n&&o(a,s,l,c,u,n)}let s=i[i.length-1];const l=0===r?s.x:s.y;l>=t&&l<=n&&a.push(s),a.length&&(s=a[a.length-1],a[0].x===s.x&&a[0].y===s.y||a.push(a[0]),e.push(a))}e.length&&i.push(e)}return i}function gh(e,t,n,r){const i="x"===n?"y":"x",o=(r-e[n])/(t[n]-e[n]);e[i]=e[i]+(t[i]-e[i])*o,e[n]=r,e.hasOwnProperty("z")&&(e.z=kt(e.z,t.z,o)),e.hasOwnProperty("w")&&(e.w=kt(e.w,t.w,o))}function yh(e,t,n,r){const i=n,o=r;for(const a of["x","y"]){let n=e,r=t;n[a]>=r[a]&&(n=t,r=e),n[a]<i&&r[a]>i&&gh(n,r,a,i),n[a]<o&&r[a]>o&&gh(r,n,a,o)}}const _h=Number.MAX_SAFE_INTEGER;function vh(e,t,n,r){return e.order<t||e.order===_h||!(e.clipMask&n)||function(e,t){return 0!==t.length&&void 0===t.find((t=>t===e))}(r,e.clipScope)}function xh(e,t){return e.x-t.x||e.y-t.y}function bh(e,t){return 0===xh(e.min,t.min)&&0===xh(e.max,t.max)}function wh(e,t){return!(e.min.x>t.max.x||e.max.x<t.min.x||e.min.y>t.max.y||e.max.y<t.min.y)}function Sh(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n].sourceId!==t[n].sourceId||!bh(e[n],t[n])||e[n].order!==t[n].order||e[n].clipMask!==t[n].clipMask||!Z(e[n].clipScope,t[n].clipScope))return!1;return!0}function Th(e,t,n){const r=1/Jn,i=1/(1<<n.canonical.z),o=(t.x*r+n.canonical.x)*i+n.wrap,a=(t.y*r+n.canonical.y)*i;return{min:new H((e.x*r+n.canonical.x)*i+n.wrap,(e.y*r+n.canonical.y)*i),max:new H(o,a)}}function Eh(e,t,n){const r=1<<n.canonical.z,i=((t.x-n.wrap)*r-n.canonical.x)*Jn,o=(t.y*r-n.canonical.y)*Jn;return{min:new H(((e.x-n.wrap)*r-n.canonical.x)*Jn,(e.y*r-n.canonical.y)*Jn),max:new H(i,o)}}function Ah(e,t,n,r,i,o,a){const s=e.indices,l=e.vertices,c=[];for(let u=r;u<r+i;u+=3){const r=t[n[u+0]+o],i=t[n[u+1]+o],h=t[n[u+2]+o],d=Math.min(r.x,i.x,h.x),p=Math.max(r.x,i.x,h.x),f=Math.min(r.y,i.y,h.y),m=Math.max(r.y,i.y,h.y);c.length=0,e.grid.query(new H(d,f),new H(p,m),c);for(let e=0;e<c.length;e++){const t=c[e];if(ql(l[s[3*t+0]],l[s[3*t+1]],l[s[3*t+2]],r,i,h,a))return!0}}return!1}function Mh(e,t,n,r){if(!e||!n)return!1;let i=e.vertices;if(!t.canonical.equals(r.canonical)||t.wrap!==r.wrap){if(n.vertices.length<e.vertices.length)return Mh(n,r,e,t);const o=t.canonical,a=r.canonical,s=Math.pow(2,a.z-o.z);i=e.vertices.map((e=>new H((e.x+o.x*Jn)*s-a.x*Jn,(e.y+o.y*Jn)*s-a.y*Jn)))}return Ah(n,i,e.indices,0,e.indices.length,0,0)}function Ph(e,t,n,r){const i=Math.pow(2,r.z-n.z);return new H((e+n.x*Jn)*i-r.x*Jn,(t+n.y*Jn)*i-r.y*Jn)}function kh(e,t){const n=[];t.grid.queryPoint(e,n);const r=t.indices,i=t.vertices;for(let o=0;o<n.length;o++){const t=n[o];if(Ul([i[r[3*t+0]],i[r[3*t+1]],i[r[3*t+2]]],e))return!0}return!1}const Ch=[new H(0,0),new H(Jn,0),new H(Jn,Jn),new H(0,Jn)];function jh(e,t){const n=[];let r=[];if(!t||e.length<2)return[e];if(2===e.length)return Hl(e[0],e[1],Ch)?[e]:[];for(let i=0;i<e.length+2;i++){const t=e[i%e.length],o=e[(i+1)%e.length],a=Hl(0===i?e[e.length-1]:e[(i-1)%e.length],t,Ch),s=Hl(t,o,Ch),l=a||s;l&&r.push(t),l&&s||r.length>0&&(r.length>1&&n.push(r),r=[])}return r.length>1&&n.push(r),n}const Ih=dh.VectorTileFeature.types,Oh=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius","fill-extrusion-line-width","fill-extrusion-emissive-strength"],Nh=["fill-extrusion-flood-light-ground-radius"],Dh=Math.pow(2,13),Lh=Math.pow(2,15)-1,zh=new H(0,1),Rh=2147483648;function Fh(e,t,n,r,i,o,a,s){e.emplaceBack((t<<1)+a,(n<<1)+o,(Math.floor(r*Dh)<<1)+i,Math.round(s))}function Bh(e,t,n){e.emplaceBack(t.x*Jn,t.y*Jn,n?1:0)}function Vh(e,t,n,r,i,o){e.emplaceBack(t.x,t.y,(n.x<<1)+r,(n.y<<1)+i,o)}function Uh(e,t,n){const r=16384;e.emplaceBack(t.x,t.y,t.z,n[0]*r,n[1]*r,n[2]*r)}class Gh{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class Hh{constructor(){this.centroidXY=new H(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new H(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new H(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new H(this.max.x-this.min.x,this.max.y-this.min.y)}}class Zh{constructor(){this.acc=new H(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(e,t){e.min.x===Number.MAX_VALUE&&(e.min.x=e.max.x=t.x,e.min.y=e.max.y=t.y)}appendEdge(e,t,n){this.accCount++,this.acc._add(t);let r=!!this.borders;t.x<e.min.x?(e.min.x=t.x,r=!0):t.x>e.max.x&&(e.max.x=t.x,r=!0),t.y<e.min.y?(e.min.y=t.y,r=!0):t.y>e.max.y&&(e.max.y=t.y,r=!0),((0===t.x||t.x===Jn)&&t.x===n.x)!=((0===t.y||t.y===Jn)&&t.y===n.y)&&this.processBorderOverlap(t,n),r&&this.checkBorderIntersection(t,n)}checkBorderIntersection(e,t){t.x<0!=e.x<0&&this.addBorderIntersection(0,kt(t.y,e.y,(0-t.x)/(e.x-t.x))),t.x>Jn!=e.x>Jn&&this.addBorderIntersection(1,kt(t.y,e.y,(Jn-t.x)/(e.x-t.x))),t.y<0!=e.y<0&&this.addBorderIntersection(2,kt(t.x,e.x,(0-t.y)/(e.y-t.y))),t.y>Jn!=e.y>Jn&&this.addBorderIntersection(3,kt(t.x,e.x,(Jn-t.y)/(e.y-t.y)))}addBorderIntersection(e,t){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const n=this.borders[e];t<n[0]&&(n[0]=t),t>n[1]&&(n[1]=t)}processBorderOverlap(e,t){if(e.x===t.x){if(e.y===t.y)return;const n=0===e.x?0:1;this.addBorderIntersection(n,t.y),this.addBorderIntersection(n,e.y)}else{const n=0===e.y?2:3;this.addBorderIntersection(n,t.x),this.addBorderIntersection(n,e.x)}}centroid(){return 0===this.accCount?new H(0,0):new H(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce(((e,t)=>e+ +(t[0]!==Number.MAX_VALUE)),0):0}}function qh(e,t){const n=e.add(t)._unit(),r=ee(e.x*n.x+e.y*n.y,-1,1);var i,o,a;return a=Math.acos(r),Math.min(4,Math.max(-4,Math.tan(a)))/4*Lh*((i=e).x*(o=t).y-i.y*o.x<0?-1:1)}const Wh=[e=>e.x<0,e=>e.x>Jn,e=>e.y<0,e=>e.y>Jn];function Xh(e,t,n,r){const i=[4];if(0===r)return i;n._mult(r);const o=e.sub(n),a=t.sub(n),s=[e,t,o,a];for(let l=0;l<4;l++)for(const e of s)if(Wh[l](e)){i.push(l);break}return i}class Yh{constructor(e){this.vertexArray=new wa,this.indexArray=new za,this.programConfigurations=new Bs(e.layers,{zoom:e.zoom,lut:e.lut},(e=>Nh.includes(e))),this._segments=new ps,this.hiddenByLandmarkVertexArray=new Ja,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new ps}getDefaultSegment(){return this.regionSegments[4]}hasData(){return 0!==this.vertexArray.length}addData(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=e.length;if(i>2){let o=Math.max(0,this._segments.get().length-1);const a=this._segments._prepareSegment(4*i,this.vertexArray.length,2*this._segmentToGroundQuads[o].length);let s;o!==this._segments.get().length-1&&(o++,this._segmentToGroundQuads[o]=[],this._segmentToRegionTriCounts[o]=[0,0,0,0,0]);{const t=e[0],n=e[1];s=qh(t.sub(e[i-1])._perp()._unit(),n.sub(t)._perp()._unit())}for(let l=0;l<i;l++){const c=l===i-1?0:l+1,u=e[l],h=e[c],d=e[c===i-1?0:c+1],p=h.sub(u)._perp()._unit(),f=qh(p,d.sub(h)._perp()._unit()),m=s,g=f;if(ed(u,h,t)||r&&td(u,t)&&td(h,t)){s=f;continue}const y=a.vertexLength;Vh(this.vertexArray,u,h,1,1,m),Vh(this.vertexArray,u,h,1,0,m),Vh(this.vertexArray,u,h,0,1,g),Vh(this.vertexArray,u,h,0,0,g),a.vertexLength+=4;const _=Xh(u,h,p,n);for(const e of _)this._segmentToGroundQuads[o].push({id:y,region:e}),this._segmentToRegionTriCounts[o][e]+=2,a.primitiveLength+=2;s=f}}}prepareBorderSegments(){if(!this.hasData())return;const e=this._segments.get(),t=e.length;for(let n=0;n<t;n++)this._segmentToGroundQuads[n].sort(((e,t)=>e.region-t.region));for(let n=0;n<t;n++){const t=this._segmentToGroundQuads[n],r=e[n],i=this._segmentToRegionTriCounts[n];i.reduce(((e,t)=>e+t),0);let o=0;for(let e=0;e<=4;e++){const t=i[e];if(0!==t){let n=this.regionSegments[e];n||(n=this.regionSegments[e]=new ps);const i={vertexOffset:r.vertexOffset,primitiveOffset:r.primitiveOffset+o,vertexLength:r.vertexLength,primitiveLength:t};n.get().push(i)}o+=t}for(let e=0;e<t.length;e++){const n=t[e].id;this.indexArray.emplaceBack(n,n+1,n+3),this.indexArray.emplaceBack(n,n+3,n+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(e,t,n,r,i,o){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,e,t,n,r,i,o)}upload(e){this.hasData()&&(this.vertexBuffer=e.createVertexBuffer(this.vertexArray,Yu.members),this.indexBuffer=e.createIndexBuffer(this.indexArray))}uploadPaintProperties(e){this.hasData()&&this.programConfigurations.upload(e)}update(e,t,n,r,i,o){this.hasData()&&this.programConfigurations.updatePaintArrays(e,t,n,r,i,o)}updateHiddenByLandmark(e){if(!this.hasData())return;const t=e.groundVertexCount+e.groundVertexArrayOffset;if(0===e.groundVertexCount)return;const n=e.flags&Rh?1:0;for(let r=e.groundVertexArrayOffset;r<t;++r)this.hiddenByLandmarkVertexArray.emplace(r,n);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(e){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=e.createVertexBuffer(this.hiddenByLandmarkVertexArray,Qu.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let e=0;e<=4;e++){const t=this.regionSegments[e];t&&t.destroy()}}}}class Kh{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((e=>e.fqid)),this.index=e.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=e.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new za,this.footprintVertices=new va,this.footprintSegments=[],this.layoutVertexArray=new ba,this.centroidVertexArray=new ls,this.wallVertexArray=new us,this.indexArray=new za,this.programConfigurations=new Bs(e.layers,{zoom:e.zoom,lut:e.lut},(e=>Oh.includes(e))),this.segments=new ps,this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id)),this.groundEffect=new Yh(e),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[]}updateFootprints(e,t){}populate(e,t,n,r){this.features=[],this.hasPattern=Ru("fill-extrusion",this.layers,t),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=vl(n),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter,this.wallMode=0!==this.layers[0].paint.get("fill-extrusion-line-width").constantOr(1);for(const{feature:i,id:o,index:a,sourceLayerIndex:s}of e){const e=this.layers[0]._featureFilter.needGeometry,l=kl(i,e);if(!this.layers[0]._featureFilter.filter(new No(this.zoom),l,n))continue;const c={id:o,sourceLayerIndex:s,index:a,geometry:e?l.geometry:Pl(i,n,r),properties:i.properties,type:i.type,patterns:{}},u=this.layoutVertexArray.length,h="Polygon"===Ih[c.type];if(this.hasPattern)this.features.push(Fu("fill-extrusion",this.layers,c,this.zoom,t));else if(this.wallMode)for(const i of c.geometry)for(const e of jh(i,h))this.addFeature(c,[e],a,n,{},t.availableImages,r,t.brightness);else this.addFeature(c,c.geometry,a,n,{},t.availableImages,r,t.brightness);t.featureIndex.insert(i,c.geometry,a,s,this.index,u)}this.sortBorders(),"mercator"===this.projection.name&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(e,t,n,r,i,o){for(const a of this.features){const e="Polygon"===Ih[a.type],{geometry:s}=a;if(this.wallMode)for(const l of s)for(const s of jh(l,e))this.addFeature(a,[s],a.index,t,n,r,i,o);else this.addFeature(a,s,a.index,t,n,r,i,o)}this.sortBorders(),"mercator"===this.projection.name&&this.splitToSubtiles()}update(e,t,n,r,i){const o=0!==Object.keys(e).length;if(o&&!this.stateDependentLayers.length)return;const a=o?this.stateDependentLayers:this.layers;this.programConfigurations.updatePaintArrays(e,t,a,n,r,i),this.groundEffect.update(e,t,a,n,r,i)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,eh),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.wallVertexBuffer=e.createVertexBuffer(this.wallVertexArray,Ju.members),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=e.createVertexBuffer(this.layoutVertexExtArray,$u.members,!0)),this.groundEffect.upload(e)),this.groundEffect.uploadPaintProperties(e),this.programConfigurations.upload(e),this.uploaded=!0}uploadCentroid(e){this.groundEffect.uploadHiddenByLandmark(e),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,Ku.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,t,n,r,i,o,a,s){const l=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(e,{})/this.tileToMeter,c=[new H(0,0),new H(Jn,Jn)],u=a.projection,h="globe"===u.name,d=this.wallMode||"Polygon"===Ih[e.type],p=new Zh;p.centroidDataIndex=this.centroidData.length;const f=new Hh,m=this.layers[0].paint.get("fill-extrusion-base").evaluate(e,{},r)<=0,g=this.layers[0].paint.get("fill-extrusion-height").evaluate(e,{},r);let y;if(f.height=g,f.vertexArrayOffset=this.layoutVertexArray.length,f.groundVertexArrayOffset=this.groundEffect.vertexArray.length,h&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Pa),this.wallMode){if(h)return void fe("Non zero fill-extrusion-line-width is not yet supported on globe.");if(1!==t.length)return;y=function(e){const t=e[0].x===e[e.length-1].x&&e[0].y===e[e.length-1].y,n=function(e){let t=0;const n=e.length;for(let r=0;r<n;r++)t+=(e[(r+1)%n].x-e[r].x)*(e[(r+1)%n].y+e[r].y);return t>=0}(e);n||(e=e.reverse());const r={geometry:[],joinNormals:[],indices:[]},i=[],o=[],a=[];let s=e.length;if(s<(t?3:2))return r;for(;s>=2&&e[s-1].equals(e[s-2]);)s--;let l,c,u,h,d,p=0;for(;p<s-1&&e[p].equals(e[p+1]);)p++;t&&(l=e[s-2],d=e[p].sub(l)._unit()._perp());for(let m=p;m<s;m++){if(u=m===s-1?t?e[p+1]:void 0:e[m+1],u&&e[m].equals(u))continue;d&&(h=d),l&&(c=l),l=e[m],d=u?u.sub(l)._unit()._perp():h,h=h||d;let n=h.add(d);0===n.x&&0===n.y||n._unit();const r=n.x*d.x+n.y*d.y,f=0!==r?1/r:1/0,g=h.x*d.y-h.y*d.x>0;let y="miter";const _=2;"miter"===y&&f>_&&(y="bevel"),"bevel"===y&&(f>100&&(y="flipbevel"),f<_&&(y="miter"));const v=(e,t,n,r)=>{const s=new H(e.x,e.y),l=new H(e.x,e.y);s.x+=t.x*r,s.y+=t.y*r,l.x-=t.x*Math.max(n,1),l.y-=t.y*Math.max(n,1),a.push(t),i.push(s),o.push(l)};if("miter"===y)n._mult(f),v(l,n,0,0);else if("flipbevel"===y)n=d.mult(-1),v(l,n,0,0),v(l,n.mult(-1),0,0);else{const e=-Math.sqrt(f*f-1),t=g?e:0,n=g?0:e;c&&v(l,h,t,n),u&&v(l,d,t,n)}}r.geometry=[...i,...o.reverse(),i[0]],r.joinNormals=[...a,...a.reverse(),a[a.length-1]];const f=r.geometry.length-1;for(let m=0;m<f/2;m++)if(m+1<f/2){let e=m,t=m+1,n=f-1-m,i=f-2-m;e=0===e?f-1:e-1,t=0===t?f-1:t-1,n=0===n?f-1:n-1,i=0===i?f-1:i-1,r.indices.push(n),r.indices.push(t),r.indices.push(e),r.indices.push(n),r.indices.push(i),r.indices.push(t)}return r}(t[0]),t=[y.geometry]}const _=(e,t)=>e<(t.length-1)/2||e===t.length-1,v=this.wallMode?[t]:Lu(t,500);for(let E=v.length-1;E>=0;E--){const e=v[E];(0===e.length||(x=e[0]).every((e=>e.x<=0))||x.every((e=>e.x>=Jn))||x.every((e=>e.y<=0))||x.every((e=>e.y>=Jn)))&&v.splice(E,1)}var x;let b;if(h)b=od(v,c,r);else{b=[];for(const e of v)b.push({polygon:e,bounds:c})}const w=d?this.edgeRadius:0,S=w>0&&this.zoom<17,T=(e,t)=>{if(0===e.length)return!1;const n=e[e.length-1];return t.x===n.x&&t.y===n.y};for(const{polygon:E,bounds:A}of b){let e=0,t=0;for(const r of E)d&&!r[0].equals(r[r.length-1])&&r.push(r[0]),t+=d?r.length-1:r.length;const n=this.segments.prepareSegment((d?5:4)*t,this.layoutVertexArray,this.indexArray);f.footprintSegIdx<0&&(f.footprintSegIdx=this.footprintSegments.length),f.polygonSegIdx<0&&(f.polygonSegIdx=this.polygonSegments.length);const i={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},o=new Gh;if(o.vertexOffset=this.footprintVertices.length,o.indexOffset=3*this.footprintIndices.length,o.ringIndices=[],d){const t=[],i=[];e=n.vertexLength;for(let e=0;e<E.length;e++){const a=E[e];a.length&&0!==e&&i.push(t.length/2);const s=[];let c,d;c=a[1].sub(a[0])._perp()._unit(),o.ringIndices.push(a.length-1);for(let e=1;e<a.length;e++){const i=a[e],o=a[e===a.length-1?1:e+1],l=i.clone();if(w){d=o.sub(i)._perp()._unit();const e=c.add(d)._unit(),t=w*Math.min(4,1/(c.x*e.x+c.y*e.y));l.x+=t*e.x,l.y+=t*e.y,l.x=Math.round(l.x),l.y=Math.round(l.y),c=d}if(!m||0!==w&&!S||T(s,l)||s.push(l),Fh(this.layoutVertexArray,l.x,l.y,0,0,1,1,0),this.wallMode){const t=_(e,a);Bh(this.wallVertexArray,y.joinNormals[e],!t)}n.vertexLength++,this.footprintVertices.emplaceBack(i.x,i.y),t.push(i.x,i.y),h&&Uh(this.layoutVertexExtArray,u.projectTilePoint(l.x,l.y,r),u.upVector(r,l.x,l.y))}m&&(0===w||S)&&(0!==s.length&&T(s,s[0])&&s.pop(),this.groundEffect.addData(s,A,l))}const a=this.wallMode?y.indices:hu(t,i);for(let r=0;r<a.length;r+=3)this.footprintIndices.emplaceBack(o.vertexOffset+a[r+0],o.vertexOffset+a[r+1],o.vertexOffset+a[r+2]),this.indexArray.emplaceBack(e+a[r],e+a[r+2],e+a[r+1]),n.primitiveLength++;o.indexCount+=a.length,o.vertexCount+=this.footprintVertices.length-o.vertexOffset}for(let a=0;a<E.length;a++){const t=E[a];p.startRing(f,t[0]);let i=t.length>4&&nd(t[t.length-2],t[0],t[1]),o=w?Qh(t[t.length-2],t[0],t[1],w):0;const s=[];let c,g,v;g=t[1].sub(t[0])._perp()._unit();let x=!0;for(let a=1,l=0;a<t.length;a++){let d=t[a-1],b=t[a];const S=t[a===t.length-1?1:a+1];if(p.appendEdge(f,b,d),ed(b,d,A)){w&&(g=S.sub(b)._perp()._unit(),x=!x);continue}const E=b.sub(d)._perp(),M=E.x/(Math.abs(E.x)+Math.abs(E.y)),P=E.y>0?1:0,k=d.dist(b);if(l+k>32768&&(l=0),w){v=S.sub(b)._perp()._unit();let e=$h(d,b,S,Jh(g,v),w);isNaN(e)&&(e=0);const t=b.sub(d)._unit();d=d.add(t.mult(o))._round(),b=b.add(t.mult(-e))._round(),o=e,g=v,m&&this.zoom>=17&&(T(s,d)||s.push(d),T(s,b)||s.push(b))}const C=n.vertexLength,j=t.length>4&&nd(d,b,S);let I=rd(l,i,x);if(Fh(this.layoutVertexArray,d.x,d.y,M,P,0,0,I),Fh(this.layoutVertexArray,d.x,d.y,M,P,0,1,I),this.wallMode){const e=_(a-1,t),n=y.joinNormals[a-1];Bh(this.wallVertexArray,n,e),Bh(this.wallVertexArray,n,e)}if(l+=k,I=rd(l,j,!x),i=j,Fh(this.layoutVertexArray,b.x,b.y,M,P,0,0,I),Fh(this.layoutVertexArray,b.x,b.y,M,P,0,1,I),this.wallMode){const e=_(a,t),n=y.joinNormals[a];Bh(this.wallVertexArray,n,e),Bh(this.wallVertexArray,n,e)}if(n.vertexLength+=4,this.indexArray.emplaceBack(C+0,C+1,C+2),this.indexArray.emplaceBack(C+1,C+3,C+2),n.primitiveLength+=2,w){const r=e+(1===a?t.length-2:a-2),i=1===a?e:r+1;if(this.indexArray.emplaceBack(C+1,r,C+3),this.indexArray.emplaceBack(r,i,C+3),n.primitiveLength+=2,void 0===c&&(c=C),!ed(S,t[a],A)){const e=a===t.length-1?c:n.vertexLength;this.indexArray.emplaceBack(C+2,C+3,e),this.indexArray.emplaceBack(C+3,e+1,e),this.indexArray.emplaceBack(C+3,i,e+1),n.primitiveLength+=3}x=!x}if(h){const e=this.layoutVertexExtArray,t=u.projectTilePoint(d.x,d.y,r),n=u.projectTilePoint(b.x,b.y,r),i=u.upVector(r,d.x,d.y),o=u.upVector(r,b.x,b.y);Uh(e,t,i),Uh(e,t,i),Uh(e,n,o),Uh(e,n,o)}}d&&(e+=t.length-1),m&&w&&this.zoom>=17&&(0!==s.length&&T(s,s[0])&&s.pop(),this.groundEffect.addData(s,A,l,w>0))}this.footprintSegments.push(o),i.triangleCount=this.indexArray.length-i.triangleArrayOffset,this.polygonSegments.push(i),++f.footprintSegLen,++f.polygonSegLen}if(f.vertexCount=this.layoutVertexArray.length-f.vertexArrayOffset,f.groundVertexCount=this.groundEffect.vertexArray.length-f.groundVertexArrayOffset,0!==f.vertexCount){if(f.centroidXY=p.borders?zh:this.encodeCentroid(p,f),this.centroidData.push(f),p.borders){this.featuresOnBorder.push(p);const e=this.featuresOnBorder.length-1;for(let t=0;t<p.borders.length;t++)p.borders[t][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[t].push(e)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,n,i,o,r,s),this.groundEffect.addPaintPropertiesData(e,n,i,o,r,s),this.maxHeight=Math.max(this.maxHeight,g)}}sortBorders(){for(let e=0;e<this.borderFeatureIndices.length;e++)this.borderFeatureIndices[e].sort(((t,n)=>this.featuresOnBorder[t].borders[e][0]-this.featuresOnBorder[n].borders[e][0]))}splitToSubtiles(){const e=[];for(let a=0;a<this.centroidData.length;a++){const t=this.centroidData[a],n=+(t.min.y+t.max.y>Jn),r=2*n+(+(t.min.x+t.max.x>Jn)^n);for(let i=0;i<t.polygonSegLen;i++){const n=t.polygonSegIdx+i;e.push({centroidIdx:a,subtile:r,polygonSegmentIdx:n,triangleSegmentIdx:this.polygonSegments[n].triangleSegIdx})}}const t=new za;e.sort(((e,t)=>e.triangleSegmentIdx===t.triangleSegmentIdx?e.subtile-t.subtile:e.triangleSegmentIdx-t.triangleSegmentIdx));let n=0,r=0,i=0;for(const a of e){if(a.triangleSegmentIdx!==n)break;i++}const o=e.length;for(;r!==e.length;){n=e[r].triangleSegmentIdx;let a=0,s=r,l=r;for(let t=s;t<i&&e[t].subtile===a;t++)l++;for(;s!==i;){const r=e[s];a=r.subtile;const o=this.centroidData[r.centroidIdx].min.clone(),c=this.centroidData[r.centroidIdx].max.clone(),u={vertexOffset:this.segments.segments[n].vertexOffset,primitiveOffset:t.length,vertexLength:this.segments.segments[n].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let n=s;n<l;n++){const r=e[n],i=this.polygonSegments[r.polygonSegmentIdx],a=this.centroidData[r.centroidIdx].min,s=this.centroidData[r.centroidIdx].max,l=this.indexArray.uint16;for(let e=i.triangleArrayOffset;e<i.triangleArrayOffset+i.triangleCount;e++)t.emplaceBack(l[3*e],l[3*e+1],l[3*e+2]);u.primitiveLength+=i.triangleCount,o.x=Math.min(o.x,a.x),o.y=Math.min(o.y,a.y),c.x=Math.max(c.x,s.x),c.y=Math.max(c.y,s.y)}u.primitiveLength>0&&this.triangleSubSegments.push({segment:u,min:o,max:c}),s=l;for(let t=s;t<i&&e[t].subtile===e[s].subtile;t++)l++}r=i;for(let t=r;t<o&&e[t].triangleSegmentIdx===e[r].triangleSegmentIdx;t++)i++}t._trim(),this.indexArray=t}getVisibleSegments(e,t,n){const r=new ps;if(this.wallMode){for(const e of this.triangleSubSegments)r.segments.push(e.segment);return r}let i=0,o=0;const a=1<<e.canonical.z;if(t){const n=t.getMinMaxForTile(e);n&&(i=n.min,o=n.max)}o+=this.maxHeight;const s=e.toUnwrapped();let l;const c=[s.canonical.x/a+s.wrap,s.canonical.y/a],u=[(s.canonical.x+1)/a+s.wrap,(s.canonical.y+1)/a],h=(e,t,n)=>[e[0]*(1-n[0])+t[0]*n[0],e[1]*(1-n[1])+t[1]*n[1]],d=[],p=[];for(const f of this.triangleSubSegments){d[0]=f.min.x/Jn,d[1]=f.min.y/Jn,p[0]=f.max.x/Jn,p[1]=f.max.y/Jn;const e=h(c,u,d),t=h(c,u,p);if(0===new _c([e[0],e[1],i],[t[0],t[1],o]).intersectsPrecise(n)){l&&(r.segments.push(l),l=void 0);continue}const a=f.segment;l&&l.vertexOffset!==a.vertexOffset&&(r.segments.push(l),l=void 0),l?(l.vertexLength+=a.vertexLength,l.primitiveLength+=a.primitiveLength):l={vertexOffset:a.vertexOffset,primitiveLength:a.primitiveLength,vertexLength:a.vertexLength,primitiveOffset:a.primitiveOffset,sortKey:void 0,vaos:{}}}return l&&r.segments.push(l),r}encodeCentroid(e,t){const n=e.centroid(),r=t.span(),i=Math.min(7,Math.round(r.x*this.tileToMeter/10)),o=Math.min(7,Math.round(r.y*this.tileToMeter/10));return new H(ee(n.x,1,Jn-1)<<3|i,ee(n.y,1,Jn-1)<<3|o)}encodeBorderCentroid(e){if(!e.borders)return new H(0,0);const t=e.borders,n=Number.MAX_VALUE;if(t[0][0]!==n||t[1][0]!==n){const e=t[0][0]!==n?0:1;return new H(6|(t[0][0]!==n?0:65528),(t[e][0]+t[e][1])/2<<3|6)}{const e=t[2][0]!==n?2:3;return new H((t[e][0]+t[e][1])/2<<3|6,6|(t[2][0]!==n?0:65528))}}showCentroid(e){const t=this.centroidData[e.centroidDataIndex];t.flags&=Rh,t.centroidXY.x=0,t.centroidXY.y=0,this.writeCentroidToBuffer(t)}writeCentroidToBuffer(e){this.groundEffect.updateHiddenByLandmark(e);const t=e.vertexArrayOffset,n=e.vertexCount+e.vertexArrayOffset,r=e.flags&Rh?zh:e.centroidXY,i=this.centroidVertexArray.geta_centroid_pos0(t);if(this.centroidVertexArray.geta_centroid_pos1(t)!==r.y||i!==r.x){for(let e=t;e<n;++e)this.centroidVertexArray.emplace(e,r.x,r.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const e of this.centroidData)this.writeCentroidToBuffer(e)}updateReplacement(e,t,n){if(t.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=t.updateTime;const r=t.getReplacementRegionsForTile(e.toUnwrapped());if(Sh(this.activeReplacements,r))return;if(this.activeReplacements=r,0===this.centroidVertexArray.length)this.createCentroidsBuffer();else for(const o of this.centroidData)o.flags&=2147483647;const i=[];for(const o of this.activeReplacements){if(o.order<n)continue;const t=Math.max(1,Math.pow(2,o.footprintTileId.canonical.z-e.canonical.z));for(const n of this.centroidData)if(!(n.flags&Rh||o.min.x>n.max.x||n.min.x>o.max.x||o.min.y>n.max.y||n.min.y>o.max.y))for(let r=0;r<n.footprintSegLen;r++){const a=this.footprintSegments[n.footprintSegIdx+r];if(i.length=0,ad(this.footprintVertices,a.vertexOffset,a.vertexCount,o.footprintTileId.canonical,e.canonical,i),Ah(o.footprint,i,this.footprintIndices.uint16,a.indexOffset,a.indexCount,-a.vertexOffset,-t)){n.flags|=Rh;break}}}for(const o of this.centroidData)this.writeCentroidToBuffer(o);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(e,t,n){let r=!1;for(let i=0;i<n.footprintSegLen;i++){const o=this.footprintSegments[n.footprintSegIdx+i];let a=0;for(const n of o.ringIndices){for(let i=a,s=n+a-1;i<n+a;s=i++){const n=this.footprintVertices.int16[2*(i+o.vertexOffset)+0],a=this.footprintVertices.int16[2*(i+o.vertexOffset)+1],l=this.footprintVertices.int16[2*(s+o.vertexOffset)+1];a>t!=l>t&&e<(this.footprintVertices.int16[2*(s+o.vertexOffset)+0]-n)*(t-a)/(l-a)+n&&(r=!r)}a=n}}return r}getHeightAtTileCoord(e,t){let n=Number.NEGATIVE_INFINITY,r=!0;const i=4*(e+Jn)*Jn+(t+Jn);if(this.partLookup.hasOwnProperty(i)){const e=this.partLookup[i];return e?{height:e.height,hidden:!!(e.flags&Rh)}:void 0}for(const o of this.centroidData)e>o.max.x||o.min.x>e||t>o.max.y||o.min.y>t||this.footprintContainsPoint(e,t,o)&&o&&o.height>n&&(n=o.height,this.partLookup[i]=o,r=!!(o.flags&Rh));if(n!==Number.NEGATIVE_INFINITY)return{height:n,hidden:r};this.partLookup[i]=void 0}}function Jh(e,t){const n=e.add(t)._unit();return e.x*n.x+e.y*n.y}function Qh(e,t,n,r){const i=t.sub(e)._perp()._unit(),o=n.sub(t)._perp()._unit();return $h(e,t,n,Jh(i,o),r)}function $h(e,t,n,r,i){const o=Math.sqrt(1-r*r);return Math.min(e.dist(t)/3,t.dist(n)/3,i*o/r)}function ed(e,t,n){return e.x<n[0].x&&t.x<n[0].x||e.x>n[1].x&&t.x>n[1].x||e.y<n[0].y&&t.y<n[0].y||e.y>n[1].y&&t.y>n[1].y}function td(e,t){return e.x<t[0].x||e.x>t[1].x||e.y<t[0].y||e.y>t[1].y}function nd(e,t,n){if(e.x<0||e.x>=Jn||t.x<0||t.x>=Jn||n.x<0||n.x>=Jn)return!1;const r=n.sub(t),i=r.perp(),o=e.sub(t);return(r.x*o.x+r.y*o.y)/Math.sqrt((r.x*r.x+r.y*r.y)*(o.x*o.x+o.y*o.y))>-.866&&i.x*o.x+i.y*o.y<0}function rd(e,t,n){const r=t?2|e:-3&e;return n?1|r:-2&r}function id(){const e=Math.PI/32,t=Math.tan(e),n=nl;return n*Math.sqrt(1+2*t*t)-n}function od(e,t,n){const r=1<<n.z,i=dl(n.x/r),o=dl((n.x+1)/r),a=pl(n.y/r),s=pl((n.y+1)/r);return function(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5?arguments[5]:void 0;const a=[];if(!e.length||!n||!r)return a;const s=(e,t)=>{for(const n of e)a.push({polygon:n,bounds:t})},l=Math.ceil(Math.log2(n)),c=Math.ceil(Math.log2(r)),u=l-c,h=[];for(let f=0;f<Math.abs(u);f++)h.push(u>0?0:1);for(let f=0;f<Math.min(l,c);f++)h.push(0),h.push(1);let d=e;if(d=mh(d,t[0].y-i,t[1].y+i,1),d=mh(d,t[0].x-i,t[1].x+i,0),!d.length)return a;const p=[];for(h.length?p.push({polygons:d,bounds:t,depth:0}):s(d,t);p.length;){const e=p.pop(),t=e.depth,n=h[t],r=e.bounds[0],a=e.bounds[1],l=0===n?r.x:r.y,c=0===n?a.x:a.y,u=o?o(n,l,c):.5*(l+c),d=mh(e.polygons,l-i,u+i,n),f=mh(e.polygons,u-i,c+i,n);if(d.length){const e=[r,new H(0===n?u:a.x,1===n?u:a.y)];h.length>t+1?p.push({polygons:d,bounds:e,depth:t+1}):s(d,e)}if(f.length){const e=[new H(0===n?u:r.x,1===n?u:r.y),a];h.length>t+1?p.push({polygons:f,bounds:e,depth:t+1}):s(f,e)}}return a}(e,t,Math.ceil((o-i)/11.25),Math.ceil((a-s)/11.25),1,((e,t,i)=>{if(0===e)return.5*(t+i);{const e=pl((n.y+t/Jn)/r);return(ul(.5*(pl((n.y+i/Jn)/r)+e))*r-n.y)*Jn}}))}function ad(e,t,n,r,i,o){const a=Math.pow(2,r.z-i.z);for(let s=0;s<n;s++){let n=e.int16[2*(s+t)+0],l=e.int16[2*(s+t)+1];n=(n+i.x*Jn)*a-r.x*Jn,l=(l+i.y*Jn)*a-r.y*Jn,o.push(new H(n,l))}}let sd,ld;function cd(e,t){return e.x*t.x+e.y*t.y}function ud(e,t){if(1===e.length){let n=0;const r=t[n++];let i;for(;!i||r.equals(i);)if(i=t[n++],!i)return 1/0;for(;n<t.length;n++){const o=t[n],a=e[0],s=i.sub(r),l=o.sub(r),c=a.sub(r),u=cd(s,s),h=cd(s,l),d=cd(l,l),p=cd(c,s),f=cd(c,l),m=u*d-h*h,g=(d*p-h*f)/m,y=(u*f-h*p)/m,_=r.z*(1-g-y)+i.z*g+o.z*y;if(isFinite(_))return _}return 1/0}{let e=1/0;for(const n of t)e=Math.min(e,n.z);return e}}function hd(e,t,n,r,i,o,a,s){const l=a*i.getElevationAt(e,t,!0,!0),c=0!==o[0],u=c?0===o[1]?a*(o[0]/7-450):a*function(e,t,n){const r=Math.floor(t[0]/8),i=Math.floor(t[1]/8),o=10*(t[0]-8*r),a=10*(t[1]-8*i),s=e.getElevationAt(r,i,!0,!0),l=e.getMeterToDEM(n),c=Math.floor(.5*(o*l-1)),u=Math.floor(.5*(a*l-1)),h=e.tileCoordToPixel(r,i),d=2*c+1,p=2*u+1,f=function(e,t,n,r,i){return[e.getElevationAtPixel(t,n,!0),e.getElevationAtPixel(t+i,n,!0),e.getElevationAtPixel(t,n+i,!0),e.getElevationAtPixel(t+r,n+i,!0)]}(e,h.x-c,h.y-u,d,p),m=Math.abs(f[0]-f[1]),g=Math.abs(f[2]-f[3]),y=Math.abs(f[0]-f[2])+Math.abs(f[1]-f[3]),_=Math.min(.25,.5*l*(m+g)/d),v=Math.min(.25,.5*l*y/p);return s+Math.max(_*o,v*a)}(i,o,s):l;return{base:l+(0===n?-1:n),top:c?Math.max(u+r,l+n+2):l+r}}so(Kh,"FillExtrusionBucket",{omit:["layers","features"]}),so(Hh,"PartData"),so(Gh,"FootprintSegment"),so(Zh,"BorderCentroidData"),so(Yh,"GroundEffect");const dd=ya([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),pd=ya([{name:"a_z_offset",components:1,type:"Float32"}],4),{members:fd}=dd,md=ya([{name:"a_packed",components:4,type:"Float32"}]),{members:gd}=md,yd=ya([{name:"a_pattern_data",components:3,type:"Float32"}]),{members:_d}=yd;class vd{constructor(e,t){this.width=e,this.height=t,this.nextRow=0,this.image=new ou({width:e,height:t}),this.positions={},this.uploaded=!1}getDash(e,t){const n=this.getKey(e,t);return this.positions[n]}trim(){const e=this.width,t=this.height=se(this.nextRow);this.image.resize({width:e,height:t})}getKey(e,t){return e.join(",")+t}getDashRanges(e,t,n){const r=[];let i=e.length%2==1?-e[e.length-1]*n:0,o=e[0]*n,a=!0;r.push({left:i,right:o,isDash:a,zeroLength:0===e[0]});let s=e[0];for(let l=1;l<e.length;l++){a=!a;const t=e[l];i=s*n,s+=t,o=s*n,r.push({left:i,right:o,isDash:a,zeroLength:0===t})}return r}addRoundDash(e,t,n){const r=t/2;for(let i=-n;i<=n;i++){const t=this.width*(this.nextRow+n+i);let o=0,a=e[o];for(let s=0;s<this.width;s++){s/a.right>1&&(a=e[++o]);const l=Math.abs(s-a.left),c=Math.abs(s-a.right),u=Math.min(l,c);let h;const d=i/n*(r+1);if(a.isDash){const e=r-Math.abs(d);h=Math.sqrt(u*u+e*e)}else h=r-Math.sqrt(u*u+d*d);this.image.data[t+s]=Math.max(0,Math.min(255,h+128))}}}addRegularDash(e,t){for(let s=e.length-1;s>=0;--s){const t=e[s],n=e[s+1];t.zeroLength?e.splice(s,1):n&&n.isDash===t.isDash&&(n.left=t.left,e.splice(s,1))}const n=e[0],r=e[e.length-1];n.isDash===r.isDash&&(n.left=r.left-this.width,r.right=n.right+this.width);const i=this.width*this.nextRow;let o=0,a=e[o];for(let s=0;s<this.width;s++){s/a.right>1&&(a=e[++o]);const n=Math.abs(s-a.left),r=Math.abs(s-a.right),l=Math.min(n,r);this.image.data[i+s]=Math.max(0,Math.min(255,(a.isDash?l:-l)+t+128))}}addDash(e,t){const n=this.getKey(e,t);if(this.positions[n])return this.positions[n];const r="round"===t,i=r?7:0,o=2*i+1;if(this.nextRow+o>this.height)return fe("LineAtlas out of space"),null;0===e.length&&e.push(1);let a=0;for(let c=0;c<e.length;c++)e[c]<0&&(fe("Negative value is found in line dasharray, replacing values with 0"),e[c]=0),a+=e[c];if(0!==a){const n=this.width/a,o=this.getDashRanges(e,this.width,n);r?this.addRoundDash(o,n,i):this.addRegularDash(o,"square"===t?.5*n:0)}const s=this.nextRow+i;this.nextRow+=o;const l={tl:[s,i],br:[a,0]};return this.positions[n]=l,l}}so(vd,"LineAtlas");const xd=dh.VectorTileFeature.types,bd=Math.cos(Math.PI/180*37.5),wd=Math.cos(Math.PI/180*5);class Sd{constructor(e){this.evaluationGlobals={zoom:0,lineProgress:void 0},this.zoom=e.zoom,this.evaluationGlobals.zoom=this.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((e=>e.fqid)),this.index=e.index,this.projection=e.projection,this.hasPattern=!1,this.hasZOffset=!1,this.hasCrossSlope=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((e=>{this.gradients[e.id]={}})),this.layoutVertexArray=new Sa,this.layoutVertexArray2=new Ta,this.patternVertexArray=new Ea,this.indexArray=new za,this.programConfigurations=new Bs(e.layers,{zoom:e.zoom,lut:e.lut}),this.segments=new ps,this.maxLineLength=0,this.zOffsetVertexArray=new Ba,this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id)),this.tessellationStep=e.tessellationStep?e.tessellationStep:Jn/64}updateFootprints(e,t){}populate(e,t,n,r){this.hasPattern=Ru("line",this.layers,t);const i=this.layers[0].layout.get("line-sort-key");this.hasZOffset=!this.layers[0].isDraped();const o=this.layers[0].layout.get("line-elevation-reference");this.hasZOffset&&"none"===o&&fe("line-elevation-reference: ground is used for the layer ".concat(this.layerIds[0]," because non-zero line-z-offset value was found."));const a=this.layers[0].layout.get("line-cross-slope");this.hasCrossSlope=this.hasZOffset&&void 0!==a;const s=[];for(const{feature:h,id:d,index:p,sourceLayerIndex:f}of e){const e=this.layers[0]._featureFilter.needGeometry,t=kl(h,e);if(!this.layers[0]._featureFilter.filter(new No(this.zoom),t,n))continue;const o=i?i.evaluate(t,{},n):void 0,a={id:d,properties:h.properties,type:h.type,sourceLayerIndex:f,index:p,geometry:e?t.geometry:Pl(h,n,r),patterns:{},sortKey:o};s.push(a)}i&&s.sort(((e,t)=>e.sortKey-t.sortKey));const{lineAtlas:l,featureIndex:c}=t,u=this.addConstantDashes(l);for(const h of s){const{geometry:r,index:i,sourceLayerIndex:o}=h;if(u&&this.addFeatureDashes(h,l),this.hasPattern){const e=Fu("line",this.layers,h,this.zoom,t);this.patternFeatures.push(e)}else this.addFeature(h,r,i,n,l.positions,t.availableImages,t.brightness);c.insert(e[i].feature,r,i,o,this.index)}}addConstantDashes(e){let t=!1;for(const n of this.layers){const r=n.paint.get("line-dasharray").value,i=n.layout.get("line-cap").value;if("constant"!==r.kind||"constant"!==i.kind)t=!0;else{const t=i.value,n=r.value;if(!n)continue;e.addDash(n,t)}}return t}addFeatureDashes(e,t){const n=this.zoom;for(const r of this.layers){const i=r.paint.get("line-dasharray").value,o=r.layout.get("line-cap").value;if("constant"===i.kind&&"constant"===o.kind)continue;let a,s;if("constant"===i.kind){if(a=i.value,!a)continue}else a=i.evaluate({zoom:n},e);s="constant"===o.kind?o.value:o.evaluate({zoom:n},e),t.addDash(a,s),e.patterns[r.id]=t.getKey(a,s)}}update(e,t,n,r,i){const o=0!==Object.keys(e).length;o&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(e,t,o?this.stateDependentLayers:this.layers,n,r,i)}addFeatures(e,t,n,r,i,o){for(const a of this.patternFeatures)this.addFeature(a,a.geometry,a.index,t,n,r,o)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,gd)),0!==this.patternVertexArray.length&&(this.patternVertexBuffer=e.createVertexBuffer(this.patternVertexArray,_d)),!this.zOffsetVertexBuffer&&this.zOffsetVertexArray.length>0&&(this.zOffsetVertexBuffer=e.createVertexBuffer(this.zOffsetVertexArray,pd.members,!0)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,fd),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,t,n,r,i,o,a){const s=this.layers[0].layout,l=s.get("line-join").evaluate(e,{}),c=s.get("line-cap").evaluate(e,{}),u=s.get("line-miter-limit"),h=s.get("line-round-limit");this.lineClips=this.lineFeatureClips(e),this.lineFeature=e,this.zOffsetValue=s.get("line-z-offset").value;for(const d of t)this.addLine(d,e,r,l,c,u,h);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,n,i,o,r,a)}addLine(e,t,n,r,i,o,a){this.distance=0,this.prevDistance=0,this.scaledDistance=0,this.totalDistance=0,this.totalFeatureLength=0,this.lineSoFar=0,this.currentVertex=void 0;const s="none"===r;if(this.patternJoinNone=this.hasPattern&&s,this.segmentStart=0,this.segmentStartf32=0,this.segmentPoints=[],this.lineClips){this.lineClipsArray.push(this.lineClips);for(let t=0;t<e.length-1;t++)this.totalDistance+=e[t].dist(e[t+1]);this.totalFeatureLength=this.totalDistance/(this.lineClips.end-this.lineClips.start),this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const l="Polygon"===xd[t.type];let c=e.length;for(;c>=2&&e[c-1].equals(e[c-2]);)c--;let u=0;for(;u<c-1&&e[u].equals(e[u+1]);)u++;if(c<(l?3:2))return;"bevel"===r&&(o=1.05);const h=this.segments.prepareSegment(10*c,this.layoutVertexArray,this.indexArray);let d,p,f,m,g,y;this.e1=this.e2=-1,l&&(d=e[c-2],g=e[u].sub(d)._unit()._perp());for(let _=u;_<c;_++){if(f=_===c-1?l?e[u+1]:void 0:e[_+1],f&&e[_].equals(f))continue;g&&(m=g),d&&(p=d),d=e[_],y=this.hasZOffset?this.evaluateElevationValue(p?p.dist(d):0):null,g=f?f.sub(d)._unit()._perp():m,m=m||g;const t=p&&f;let n=t?r:l||s?"butt":i;const v=m.x*g.x+m.y*g.y;if(s){const e=function(e){if(e.patternJoinNone){const t=e.segmentPoints.length/2,n=e.lineSoFar-e.segmentStart;for(let r=0;r<t;++r){const t=e.segmentPoints[2*r+1],i=Math.round(e.segmentPoints[2*r])+.5+.25*t;e.patternVertexArray.emplaceBack(i,n,e.segmentStart),e.patternVertexArray.emplaceBack(i,n,e.segmentStart)}e.segmentPoints.length=0}e.e1=e.e2=-1};if(t&&v<wd){this.updateDistance(p,d),this.addCurrentVertex(d,m,1,1,h,y),e(this),this.addCurrentVertex(d,g,-1,-1,h,y);continue}if(p){if(!f){this.updateDistance(p,d),this.addCurrentVertex(d,m,1,1,h,y),e(this);continue}n="miter"}}let x=m.add(g);0===x.x&&0===x.y||x._unit();const b=x.x*g.x+x.y*g.y,w=0!==b?1/b:1/0,S=2*Math.sqrt(2-2*b),T=b<bd&&p&&f,E=m.x*g.y-m.y*g.x>0,A=this.overscaling<=16?15*Jn/(512*this.overscaling):0;if(t&&"round"===n)if(w<a)n="miter";else if(w<=2){const e=Td(d,-10,Jn+10);n=this.hasZOffset&&(e||this.hasCrossSlope)?"miter":"fakeround"}if("miter"===n&&w>o&&(n="bevel"),"bevel"===n&&(w>2&&(n="flipbevel"),w<o&&(n="miter")),p&&!("miter"===n&&T)&&this.updateDistance(p,d),"miter"===n)if(T){const e=d.dist(p);if(e>2*A){const t=d.sub(d.sub(p)._mult(A/e)._round());this.updateDistance(p,t),this.addCurrentVertex(t,m,0,0,h,y),p=t}this.updateDistance(p,d),x._mult(w),this.addCurrentVertex(d,x,0,0,h,y);const t=d.dist(f);if(t>2*A){const e=d.add(f.sub(d)._mult(A/t)._round());this.updateDistance(d,e),this.addCurrentVertex(e,g,0,0,h,y),d=e}}else x._mult(w),this.addCurrentVertex(d,x,0,0,h,y);else if("flipbevel"===n){if(w>100)x=g.mult(-1);else{const e=w*m.add(g).mag()/m.sub(g).mag();x._perp()._mult(e*(E?-1:1))}this.addCurrentVertex(d,x,0,0,h,y),this.addCurrentVertex(d,x.mult(-1),0,0,h,y)}else if("bevel"===n||"fakeround"===n){null!=y&&p&&this.addCurrentVertex(d,m,-1,-1,h,y);const e=d.dist(p)<=2*A&&"bevel"!==n,t=x.mult(E?1:-1);t._mult(w);const r=g.mult(E?-1:1),i=m.mult(E?-1:1),o=this.evaluateElevationValue(this.distance);if(null==y&&(this.addHalfVertex(d,t.x,t.y,!1,!E,0,h,o),e||this.addHalfVertex(d,t.x+2*i.x,t.y+2*i.y,!1,E,0,h,o)),"fakeround"===n){const e=Math.round(180*S/Math.PI/20);this.addHalfVertex(d,i.x,i.y,!1,E,0,h,o);for(let t=0;t<e;t++){let n=t/e;if(.5!==n){const e=n-.5;n+=n*e*(n-1)*((1.0904+v*(v*(3.55645-1.43519*v)-3.2452))*e*e+(.848013+v*(.215638*v-1.06021)))}const a=r.sub(i)._mult(n)._add(i)._unit();this.addHalfVertex(d,a.x,a.y,!1,E,0,h,o)}this.addHalfVertex(d,r.x,r.y,!1,E,0,h,o)}e||null!=y||this.addHalfVertex(d,t.x+2*r.x,t.y+2*r.y,!1,E,0,h,o),null!=y&&f&&this.addCurrentVertex(d,g,1,1,h,y)}else"butt"===n?this.addCurrentVertex(d,x,0,0,h,y):"square"===n?(p||this.addCurrentVertex(d,x,-1,-1,h,y),this.addCurrentVertex(d,x,0,0,h,y),p&&this.addCurrentVertex(d,x,1,1,h,y)):"round"===n&&(p&&(this.addCurrentVertex(d,m,0,0,h,y),this.addCurrentVertex(d,m,1,1,h,y,!0)),f&&(this.addCurrentVertex(d,g,-1,-1,h,y,!0),this.addCurrentVertex(d,g,0,0,h,y)))}}addVerticesTo(e,t,n,r,i,o,a,s,l,c){const u=(t.w-e.w)/this.tessellationStep|0;let h=0;const d=this.scaledDistance;if(u>1){this.lineSoFar=e.w;const d=(t.x-e.x)/u,p=(t.y-e.y)/u,f=(t.z-e.z)/u,m=(t.w-e.w)/u;for(let t=1;t<u;++t){e.x+=d,e.y+=p,e.z+=f,this.lineSoFar+=m,h+=m;const t=this.evaluateElevationValue(this.prevDistance+h);this.scaledDistance=(this.prevDistance+h)/this.totalDistance,this.addHalfVertex(e,n,r,c,!1,a,l,t),this.addHalfVertex(e,i,o,c,!0,-s,l,t)}}this.lineSoFar=t.w,this.scaledDistance=d;const p=this.evaluateElevationValue(this.distance);this.addHalfVertex(t,n,r,c,!1,a,l,p),this.addHalfVertex(t,i,o,c,!0,-s,l,p)}evaluateElevationValue(e){return this.hasZOffset?"constant"===this.zOffsetValue.kind?this.zOffsetValue.value:(this.evaluationGlobals.lineProgress=0,this.lineClips?this.evaluationGlobals.lineProgress=Math.min(1,(this.totalFeatureLength*this.lineClips.start+e)/this.totalFeatureLength):fe("line-z-offset evaluation for ".concat(this.layerIds[0]," requires enabling 'lineMetrics' for the source.")),this.zOffsetValue.evaluate(this.evaluationGlobals,this.lineFeature)||0):void 0}addCurrentVertex(e,t,n,r,i,o){let a=arguments.length>6&&void 0!==arguments[6]&&arguments[6];const s=t.x+t.y*n,l=t.y-t.x*n,c=t.y*r-t.x,u=-t.y-t.x*r;if(null!=o){const t=-10,h=Jn+10,d=o,p=new fh(e.x,e.y,d,this.lineSoFar),f=Td(e,t,h),m=this.lineSoFar,g=this.distance;if(this.currentVertex)if(f){const o=this.currentVertexIsOutside,f=this.currentVertex,m=new fh(e.x,e.y,d,this.lineSoFar);if(yh(f,m,t,h),!Td(m,t,h)){if(o){this.e1=this.e2=-1,this.distance-=f.dist(p),this.lineSoFar=f.w;const e=this.evaluateElevationValue(f.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(f,s,l,a,!1,n,i,e),this.addHalfVertex(f,c,u,a,!0,-r,i,e),this.prevDistance=this.distance}this.distance=this.prevDistance+f.dist(m),this.scaledDistance=this.distance/this.totalDistance,this.addVerticesTo(f,m,s,l,c,u,n,r,i,a),this.distance=g,this.scaledDistance=this.distance/this.totalDistance}}else{const e=this.currentVertex;if(this.currentVertexIsOutside){yh(e,p,t,h),this.e1=this.e2=-1,this.distance-=e.dist(p),this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=e.w;const o=this.evaluateElevationValue(e.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(e,s,l,a,!1,n,i,o),this.addHalfVertex(e,c,u,a,!0,-r,i,o),this.prevDistance=this.distance,this.distance=g,this.scaledDistance=this.distance/this.totalDistance}this.addVerticesTo(e,p,s,l,c,u,n,r,i,a)}else f||(this.addHalfVertex(e,s,l,a,!1,n,i,o),this.addHalfVertex(e,c,u,a,!0,-r,i,o));this.currentVertex=p,this.currentVertexIsOutside=f,this.lineSoFar=m}else this.addHalfVertex(e,s,l,a,!1,n,i,o),this.addHalfVertex(e,c,u,a,!0,-r,i,o)}addHalfVertex(e,t,n,r,i,o,a,s){let{x:l,y:c}=e;this.patternJoinNone&&(0===this.segmentPoints.length&&(this.segmentStart=this.lineSoFar,this.segmentStartf32=Math.fround(this.lineSoFar)),i||this.segmentPoints.push(this.lineSoFar-this.segmentStart,o)),this.layoutVertexArray.emplaceBack((l<<1)+(r?1:0),(c<<1)+(i?1:0),Math.round(63*t)+128,Math.round(63*n)+128,1+(0===o?0:o<0?-1:1),0,this.lineSoFar-this.segmentStartf32),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const u=a.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,u),a.primitiveLength++),i?this.e2=u:this.e1=u,null!=s&&this.zOffsetVertexArray.emplaceBack(s)}updateScaledDistance(){this.lineClips?(this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=this.totalFeatureLength*this.lineClips.start+this.distance):this.lineSoFar=this.distance}updateDistance(e,t){this.prevDistance=this.distance,this.distance+=e.dist(t),this.updateScaledDistance()}}function Td(e,t,n){return e.x<t||e.x>n||e.y<t||e.y>n}let Ed,Ad;function Md(e,t,n){return t*(Jn/(e.tileSize*Math.pow(2,n-e.tileID.overscaledZ)))}so(Sd,"LineBucket",{omit:["layers","patternFeatures","currentVertex","currentVertexIsOutside"]});const Pd=(e,t,n)=>(1-n)*e+n*t;function kd(e,t){return 1/Md(e,1,t.tileZoom)}function Cd(e,t,n,r){return e.translatePosMatrix(r||t.tileID.projMatrix,t,n.paint.get("line-translate"),n.paint.get("line-translate-anchor"))}const jd=e=>{const t=[];Id(e)&&t.push("RENDER_LINE_DASH"),e.paint.get("line-gradient")&&t.push("RENDER_LINE_GRADIENT");const n=e.paint.get("line-trim-offset");0===n[0]&&0===n[1]||t.push("RENDER_LINE_TRIM_OFFSET"),0!==e.paint.get("line-border-width").constantOr(1)&&t.push("RENDER_LINE_BORDER");const r="none"===e.layout.get("line-join").constantOr("miter"),i=!!e.paint.get("line-pattern").constantOr(1);return r&&i&&t.push("LINE_JOIN_NONE"),t};function Id(e){const t=e.paint.get("line-dasharray").value;return t.value||"constant"!==t.kind}let Od;const Nd=()=>Od||(Od={layout:Ed||(Ed=new qo({"line-cap":new Ho(Wo.layout_line["line-cap"]),"line-join":new Ho(Wo.layout_line["line-join"]),"line-miter-limit":new Go(Wo.layout_line["line-miter-limit"]),"line-round-limit":new Go(Wo.layout_line["line-round-limit"]),"line-sort-key":new Ho(Wo.layout_line["line-sort-key"]),"line-z-offset":new Ho(Wo.layout_line["line-z-offset"]),"line-elevation-reference":new Go(Wo.layout_line["line-elevation-reference"]),"line-cross-slope":new Go(Wo.layout_line["line-cross-slope"]),visibility:new Go(Wo.layout_line.visibility)})),paint:Ad||(Ad=new qo({"line-opacity":new Ho(Wo.paint_line["line-opacity"]),"line-color":new Ho(Wo.paint_line["line-color"]),"line-translate":new Go(Wo.paint_line["line-translate"]),"line-translate-anchor":new Go(Wo.paint_line["line-translate-anchor"]),"line-width":new Ho(Wo.paint_line["line-width"]),"line-gap-width":new Ho(Wo.paint_line["line-gap-width"]),"line-offset":new Ho(Wo.paint_line["line-offset"]),"line-blur":new Ho(Wo.paint_line["line-blur"]),"line-dasharray":new Ho(Wo.paint_line["line-dasharray"]),"line-pattern":new Ho(Wo.paint_line["line-pattern"]),"line-gradient":new Zo(Wo.paint_line["line-gradient"]),"line-trim-offset":new Go(Wo.paint_line["line-trim-offset"]),"line-trim-fade-range":new Go(Wo.paint_line["line-trim-fade-range"]),"line-trim-color":new Go(Wo.paint_line["line-trim-color"]),"line-emissive-strength":new Go(Wo.paint_line["line-emissive-strength"]),"line-border-width":new Ho(Wo.paint_line["line-border-width"]),"line-border-color":new Ho(Wo.paint_line["line-border-color"]),"line-occlusion-opacity":new Go(Wo.paint_line["line-occlusion-opacity"])}))},Od);class Dd extends Ho{possiblyEvaluate(e,t){return t=new No(Math.floor(t.zoom),{now:t.now,fadeDuration:t.fadeDuration,transition:t.transition}),super.possiblyEvaluate(e,t)}evaluate(e,t,n,r){return t=ie({},t,{zoom:Math.floor(t.zoom)}),super.evaluate(e,t,n,r)}}let Ld;function zd(e,t){return t>0?t+2*e:e}const Rd=ya([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Fd=ya([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),Bd=ya([{name:"a_projected_pos",components:4,type:"Float32"}],4);ya([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Vd=ya([{name:"a_auto_z_offset",components:1,type:"Float32"}],4),Ud=ya([{name:"a_texb",components:2,type:"Uint16"}]),Gd=ya([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_elevation_from_sea",components:2,type:"Float32"}]),Hd=ya([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_auto_z_offset",components:1,type:"Float32"}]);ya([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Zd=ya([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),qd=ya([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);ya([{name:"triangle",components:3,type:"Uint16"}]),ya([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),ya([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"}]),ya([{type:"Float32",name:"offsetX"}]),ya([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Wd=24;const Xd=128;function Yd(e,t){const{expression:n}=t;if("constant"===n.kind)return{kind:"constant",layoutSize:n.evaluate(new No(e+1))};if("source"===n.kind)return{kind:"source"};{const{zoomStops:t,interpolationType:r}=n;let i=0;for(;i<t.length&&t[i]<=e;)i++;i=Math.max(0,i-1);let o=i;for(;o<t.length&&t[o]<e+1;)o++;o=Math.min(t.length-1,o);const a=t[i],s=t[o];return"composite"===n.kind?{kind:"composite",minZoom:a,maxZoom:s,interpolationType:r}:{kind:"camera",minZoom:a,maxZoom:s,minSize:n.evaluate(new No(a)),maxSize:n.evaluate(new No(s)),interpolationType:r}}}function Kd(e,t,n){let{uSize:r,uSizeT:i}=t,{lowerSize:o,upperSize:a}=n;return"source"===e.kind?o/Xd:"composite"===e.kind?kt(o/Xd,a/Xd,i):r}function Jd(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=0,i=0;if("constant"===e.kind)i=e.layoutSize*n;else if("source"!==e.kind){const{interpolationType:o,minZoom:a,maxZoom:s}=e,l=o?ee(oi.interpolationFactor(o,t,a,s),0,1):0;"camera"===e.kind?i=kt(e.minSize,e.maxSize,l)*n:r=l*n}return{uSizeT:r,uSize:i}}var Qd=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:Xd,evaluateSizeForFeature:Kd,evaluateSizeForZoom:Jd,getSizeData:Yd});function $d(e,t,n){return e.sections.forEach((e=>{e.text=function(e,t,n){const r=t.layout.get("text-transform").evaluate(n,{});return"uppercase"===r?e=e.toLocaleUpperCase():"lowercase"===r&&(e=e.toLocaleLowerCase()),Oo.applyArabicShaping&&(e=Oo.applyArabicShaping(e)),e}(e.text,t,n)})),e}const ep={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42","\u2190":"\u2191","\u2192":"\u2193"};function tp(e){return"\ufe36"===e||"\ufe48"===e||"\ufe38"===e||"\ufe44"===e||"\ufe42"===e||"\ufe3e"===e||"\ufe3c"===e||"\ufe3a"===e||"\ufe18"===e||"\ufe40"===e||"\ufe10"===e||"\ufe13"===e||"\ufe14"===e||"\uff40"===e||"\uffe3"===e||"\ufe11"===e||"\ufe12"===e}function np(e){return"\ufe35"===e||"\ufe47"===e||"\ufe37"===e||"\ufe43"===e||"\ufe41"===e||"\ufe3d"===e||"\ufe3b"===e||"\ufe39"===e||"\ufe17"===e||"\ufe3f"===e}var rp,ip,op,ap={};function sp(){return rp||(rp=1,ap.read=function(e,t,n,r,i){var o,a,s=8*i-r-1,l=(1<<s)-1,c=l>>1,u=-7,h=n?i-1:0,d=n?-1:1,p=e[t+h];for(h+=d,o=p&(1<<-u)-1,p>>=-u,u+=s;u>0;o=256*o+e[t+h],h+=d,u-=8);for(a=o&(1<<-u)-1,o>>=-u,u+=r;u>0;a=256*a+e[t+h],h+=d,u-=8);if(0===o)o=1-c;else{if(o===l)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,r),o-=c}return(p?-1:1)*a*Math.pow(2,o-r)},ap.write=function(e,t,n,r,i,o){var a,s,l,c=8*o-i-1,u=(1<<c)-1,h=u>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,f=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=u):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),(t+=a+h>=1?d/l:d*Math.pow(2,1-h))*l>=2&&(a++,l/=2),a+h>=u?(s=0,a=u):a+h>=1?(s=(t*l-1)*Math.pow(2,i),a+=h):(s=t*Math.pow(2,h-1)*Math.pow(2,i),a=0));i>=8;e[n+p]=255&s,p+=f,s/=256,i-=8);for(a=a<<i|s,c+=i;c>0;e[n+p]=255&a,p+=f,a/=256,c-=8);e[n+p-f]|=128*m}),ap}function lp(){if(op)return ip;op=1,ip=t;var e=sp();function t(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}t.Varint=0,t.Fixed64=1,t.Bytes=2,t.Fixed32=5;var n=4294967296,r=1/n,i="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function o(e){return e.type===t.Bytes?e.readVarint()+e.pos:e.pos+1}function a(e,t,n){return n?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function s(e,t,n){var r=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));n.realloc(r);for(var i=n.pos-1;i>=e;i--)n.buf[i+r]=n.buf[i]}function l(e,t){for(var n=0;n<e.length;n++)t.writeVarint(e[n])}function c(e,t){for(var n=0;n<e.length;n++)t.writeSVarint(e[n])}function u(e,t){for(var n=0;n<e.length;n++)t.writeFloat(e[n])}function h(e,t){for(var n=0;n<e.length;n++)t.writeDouble(e[n])}function d(e,t){for(var n=0;n<e.length;n++)t.writeBoolean(e[n])}function p(e,t){for(var n=0;n<e.length;n++)t.writeFixed32(e[n])}function f(e,t){for(var n=0;n<e.length;n++)t.writeSFixed32(e[n])}function m(e,t){for(var n=0;n<e.length;n++)t.writeFixed64(e[n])}function g(e,t){for(var n=0;n<e.length;n++)t.writeSFixed64(e[n])}function y(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function _(e,t,n){e[n]=t,e[n+1]=t>>>8,e[n+2]=t>>>16,e[n+3]=t>>>24}function v(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}return t.prototype={destroy:function(){this.buf=null},readFields:function(e,t,n){for(n=n||this.length;this.pos<n;){var r=this.readVarint(),i=r>>3,o=this.pos;this.type=7&r,e(i,t,this),this.pos===o&&this.skip(r)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=y(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=v(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=y(this.buf,this.pos)+y(this.buf,this.pos+4)*n;return this.pos+=8,e},readSFixed64:function(){var e=y(this.buf,this.pos)+v(this.buf,this.pos+4)*n;return this.pos+=8,e},readFloat:function(){var t=e.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=e.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(e){var t,n,r=this.buf;return t=127&(n=r[this.pos++]),n<128?t:(t|=(127&(n=r[this.pos++]))<<7,n<128?t:(t|=(127&(n=r[this.pos++]))<<14,n<128?t:(t|=(127&(n=r[this.pos++]))<<21,n<128?t:function(e,t,n){var r,i,o=n.buf;if(r=(112&(i=o[n.pos++]))>>4,i<128)return a(e,r,t);if(r|=(127&(i=o[n.pos++]))<<3,i<128)return a(e,r,t);if(r|=(127&(i=o[n.pos++]))<<10,i<128)return a(e,r,t);if(r|=(127&(i=o[n.pos++]))<<17,i<128)return a(e,r,t);if(r|=(127&(i=o[n.pos++]))<<24,i<128)return a(e,r,t);if(r|=(1&(i=o[n.pos++]))<<31,i<128)return a(e,r,t);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(n=r[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=12&&i?function(e,t,n){return i.decode(e.subarray(t,n))}(this.buf,t,e):function(e,t,n){for(var r="",i=t;i<n;){var o,a,s,l=e[i],c=null,u=l>239?4:l>223?3:l>191?2:1;if(i+u>n)break;1===u?l<128&&(c=l):2===u?128==(192&(o=e[i+1]))&&(c=(31&l)<<6|63&o)<=127&&(c=null):3===u?(a=e[i+2],128==(192&(o=e[i+1]))&&128==(192&a)&&((c=(15&l)<<12|(63&o)<<6|63&a)<=2047||c>=55296&&c<=57343)&&(c=null)):4===u&&(a=e[i+2],s=e[i+3],128==(192&(o=e[i+1]))&&128==(192&a)&&128==(192&s)&&((c=(15&l)<<18|(63&o)<<12|(63&a)<<6|63&s)<=65535||c>=1114112)&&(c=null)),null===c?(c=65533,u=1):c>65535&&(c-=65536,r+=String.fromCharCode(c>>>10&1023|55296),c=56320|1023&c),r+=String.fromCharCode(c),i+=u}return r}(this.buf,t,e)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,n){if(this.type!==t.Bytes)return e.push(this.readVarint(n));var r=o(this);for(e=e||[];this.pos<r;)e.push(this.readVarint(n));return e},readPackedSVarint:function(e){if(this.type!==t.Bytes)return e.push(this.readSVarint());var n=o(this);for(e=e||[];this.pos<n;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==t.Bytes)return e.push(this.readBoolean());var n=o(this);for(e=e||[];this.pos<n;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==t.Bytes)return e.push(this.readFloat());var n=o(this);for(e=e||[];this.pos<n;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==t.Bytes)return e.push(this.readDouble());var n=o(this);for(e=e||[];this.pos<n;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==t.Bytes)return e.push(this.readFixed32());var n=o(this);for(e=e||[];this.pos<n;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==t.Bytes)return e.push(this.readSFixed32());var n=o(this);for(e=e||[];this.pos<n;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==t.Bytes)return e.push(this.readFixed64());var n=o(this);for(e=e||[];this.pos<n;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==t.Bytes)return e.push(this.readSFixed64());var n=o(this);for(e=e||[];this.pos<n;)e.push(this.readSFixed64());return e},skip:function(e){var n=7&e;if(n===t.Varint)for(;this.buf[this.pos++]>127;);else if(n===t.Bytes)this.pos=this.readVarint()+this.pos;else if(n===t.Fixed32)this.pos+=4;else{if(n!==t.Fixed64)throw new Error("Unimplemented type: "+n);this.pos+=8}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var n=new Uint8Array(t);n.set(this.buf),this.buf=n,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),_(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),_(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),_(this.buf,-1&e,this.pos),_(this.buf,Math.floor(e*r),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),_(this.buf,-1&e,this.pos),_(this.buf,Math.floor(e*r),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?function(e,t){var n,r;if(e>=0?(n=e%4294967296|0,r=e/4294967296|0):(r=~(-e/4294967296),4294967295^(n=~(-e%4294967296))?n=n+1|0:(n=0,r=r+1|0)),e>=0x10000000000000000||e<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");t.realloc(10),function(e,t,n){n.buf[n.pos++]=127&e|128,e>>>=7,n.buf[n.pos++]=127&e|128,e>>>=7,n.buf[n.pos++]=127&e|128,e>>>=7,n.buf[n.pos++]=127&e|128,n.buf[n.pos]=127&(e>>>=7)}(n,0,t),function(e,t){var n=(7&e)<<4;t.buf[t.pos++]|=n|((e>>>=3)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e)))))}(r,t)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(Boolean(e))},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var t=this.pos;this.pos=function(e,t,n){for(var r,i,o=0;o<t.length;o++){if((r=t.charCodeAt(o))>55295&&r<57344){if(!i){r>56319||o+1===t.length?(e[n++]=239,e[n++]=191,e[n++]=189):i=r;continue}if(r<56320){e[n++]=239,e[n++]=191,e[n++]=189,i=r;continue}r=i-55296<<10|r-56320|65536,i=null}else i&&(e[n++]=239,e[n++]=191,e[n++]=189,i=null);r<128?e[n++]=r:(r<2048?e[n++]=r>>6|192:(r<65536?e[n++]=r>>12|224:(e[n++]=r>>18|240,e[n++]=r>>12&63|128),e[n++]=r>>6&63|128),e[n++]=63&r|128)}return n}(this.buf,e,this.pos);var n=this.pos-t;n>=128&&s(t,n,this),this.pos=t-1,this.writeVarint(n),this.pos+=n},writeFloat:function(t){this.realloc(4),e.write(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),e.write(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var n=0;n<t;n++)this.buf[this.pos++]=e[n]},writeRawMessage:function(e,t){this.pos++;var n=this.pos;e(t,this);var r=this.pos-n;r>=128&&s(n,r,this),this.pos=n-1,this.writeVarint(r),this.pos+=r},writeMessage:function(e,n,r){this.writeTag(e,t.Bytes),this.writeRawMessage(n,r)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,l,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,c,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,d,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,u,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,h,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,p,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,f,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,m,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,g,t)},writeBytesField:function(e,n){this.writeTag(e,t.Bytes),this.writeBytes(n)},writeFixed32Field:function(e,n){this.writeTag(e,t.Fixed32),this.writeFixed32(n)},writeSFixed32Field:function(e,n){this.writeTag(e,t.Fixed32),this.writeSFixed32(n)},writeFixed64Field:function(e,n){this.writeTag(e,t.Fixed64),this.writeFixed64(n)},writeSFixed64Field:function(e,n){this.writeTag(e,t.Fixed64),this.writeSFixed64(n)},writeVarintField:function(e,n){this.writeTag(e,t.Varint),this.writeVarint(n)},writeSVarintField:function(e,n){this.writeTag(e,t.Varint),this.writeSVarint(n)},writeStringField:function(e,n){this.writeTag(e,t.Bytes),this.writeString(n)},writeFloatField:function(e,n){this.writeTag(e,t.Fixed32),this.writeFloat(n)},writeDoubleField:function(e,n){this.writeTag(e,t.Fixed64),this.writeDouble(n)},writeBooleanField:function(e,t){this.writeVarintField(e,Boolean(t))}},ip}var cp=t(lp());const up=3;function hp(e,t,n){t.glyphs=[],1===e&&n.readMessage(dp,t)}function dp(e,t,n){if(3===e){const{id:e,bitmap:r,width:i,height:o,left:a,top:s,advance:l}=n.readMessage(pp,{});t.glyphs.push({id:e,bitmap:new ou({width:i+2*up,height:o+2*up},r),metrics:{width:i,height:o,left:a,top:s,advance:l}})}else 4===e?t.ascender=n.readSVarint():5===e&&(t.descender=n.readSVarint())}function pp(e,t,n){1===e?t.id=n.readVarint():2===e?t.bitmap=n.readBytes():3===e?t.width=n.readVarint():4===e?t.height=n.readVarint():5===e?t.left=n.readSVarint():6===e?t.top=n.readSVarint():7===e&&(t.advance=n.readVarint())}const fp=up,mp={horizontal:1,vertical:2,horizontalOnly:3};class gp{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,t){const n=new gp;return n.scale=e||1,n.fontStack=t,n}static forImage(e){const t=new gp;return t.imageName=e,t}}class yp{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,t){const n=new yp;for(let r=0;r<e.sections.length;r++){const i=e.sections[r];i.image?n.addImageSection(i):n.addTextSection(i,t)}return n}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSections(){return this.sections}getSectionIndex(e){return this.sectionIndex[e]}getCodePoint(e){return this.text.codePointAt(e)}verticalizePunctuation(e){this.text=function(e,t){let n="";for(let r=0;r<e.length;r++){const i=e.charCodeAt(r+1)||null,o=e.charCodeAt(r-1)||null;n+=!t&&(i&&_o(i)&&!ep[e[r+1]]||o&&_o(o)&&!ep[e[r-1]])||!ep[e[r]]?e[r]:ep[e[r]]}return n}(this.text,e)}trim(){let e=0;for(let n=0;n<this.text.length&&vp[this.text.charCodeAt(n)];n++)e++;let t=this.text.length;for(let n=this.text.length-1;n>=0&&n>=e&&vp[this.text.charCodeAt(n)];n--)t--;this.text=this.text.substring(e,t),this.sectionIndex=this.sectionIndex.slice(e,t)}substring(e,t){const n=new yp;return n.text=this.text.substring(e,t),n.sectionIndex=this.sectionIndex.slice(e,t),n.sections=this.sections,n}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((e,t)=>Math.max(e,this.sections[t].scale)),0)}addTextSection(e,t){this.text+=e.text,this.sections.push(gp.forText(e.scale,e.fontStack||t));const n=this.sections.length-1;for(let r=0;r<e.text.length;++r)this.sectionIndex.push(n)}addImageSection(e){const t=e.image?e.image.namePrimary:"";if(0===t.length)return void fe("Can't add FormattedSection with an empty image.");const n=this.getNextImageSectionCharCode();n?(this.text+=String.fromCodePoint(n),this.sections.push(gp.forImage(t)),this.sectionIndex.push(this.sections.length-1)):fe("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function _p(e,t,n,r,i,o,a,s,l,c,u,h,d,p,f){const m=yp.fromFeature(e,i);h===mp.vertical&&m.verticalizePunctuation(d);let g=[];const y=function(e,t,n,r,i,o){if(!e)return[];const a=[],s=function(e,t,n,r,i,o){let a=0;for(let s=0;s<e.length();s++){const n=e.getSection(s);a+=bp(e.getCodePoint(s),n,r,i,t,o)}return a/Math.max(1,Math.ceil(a/n))}(e,t,n,r,i,o),l=e.text.indexOf("\u200b")>=0;let c=0;for(let h=0;h<e.length();h++){const n=e.getSection(h),d=e.getCodePoint(h);if(vp[d]||(c+=bp(d,n,r,i,t,o)),h<e.length()-1){const t=!((u=d)<11904||!(po["Bopomofo Extended"](u)||po.Bopomofo(u)||po["CJK Compatibility Forms"](u)||po["CJK Compatibility Ideographs"](u)||po["CJK Compatibility"](u)||po["CJK Radicals Supplement"](u)||po["CJK Strokes"](u)||po["CJK Symbols and Punctuation"](u)||po["CJK Unified Ideographs Extension A"](u)||po["CJK Unified Ideographs"](u)||po["Enclosed CJK Letters and Months"](u)||po["Halfwidth and Fullwidth Forms"](u)||po.Hiragana(u)||po["Ideographic Description Characters"](u)||po["Kangxi Radicals"](u)||po["Katakana Phonetic Extensions"](u)||po.Katakana(u)||po["Vertical Forms"](u)||po["Yi Radicals"](u)||po["Yi Syllables"](u)));(xp[d]||t||n.imageName)&&a.push(Tp(h+1,c,s,a,Sp(d,e.getCodePoint(h+1),t&&l),!1))}}var u;return Ep(Tp(e.length(),c,s,a,0,!0))}(m,c,o,t,r,p),{processBidirectionalText:_,processStyledBidirectionalText:v}=Oo;if(_&&1===m.sections.length){const e=_(m.toString(),y);for(const t of e){const e=new yp;e.text=t,e.sections=m.sections;for(let n=0;n<t.length;n++)e.sectionIndex.push(0);g.push(e)}}else if(v){const e=v(m.text,m.sectionIndex,y);for(const t of e){const e=new yp;e.text=t[0],e.sectionIndex=t[1],e.sections=m.sections,g.push(e)}}else g=function(e,t){const n=[],r=e.text;let i=0;for(const o of t)n.push(e.substring(i,o)),i=o;return i<r.length&&n.push(e.substring(i,r.length)),n}(m,y);const x=[],b={positionedLines:x,text:m.toString(),top:u[1],bottom:u[1],left:u[0],right:u[0],writingMode:h,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(e,t,n,r,i,o,a,s,l,c,u,h){let d=0,p=0,f=0;const m="right"===s?1:"left"===s?0:.5;let g=!1;for(const w of i){const e=w.getSections();for(const n of e){if(n.imageName)continue;const e=t[n.fontStack];if(e&&(g=void 0!==e.ascender&&void 0!==e.descender,!g))break}if(!g)break}let y=0;for(const w of i){w.trim();const i=w.getMaxScale(),a=(i-1)*Wd,s={positionedGlyphs:[],lineOffset:0};e.positionedLines[y]=s;const v=s.positionedGlyphs;let x=0;if(!w.length()){p+=o,++y;continue}let b=0,S=0;for(let o=0;o<w.length();o++){const a=w.getSection(o),s=w.getSectionIndex(o),f=w.getCodePoint(o);let m=a.scale,y=null,T=null,E=null,A=Wd,M=0;const P=!(l===mp.horizontal||!u&&!yo(f)||u&&(vp[f]||(_=f,po.Arabic(_)||po["Arabic Supplement"](_)||po["Arabic Extended-A"](_)||po["Arabic Presentation Forms-A"](_)||po["Arabic Presentation Forms-B"](_))));if(a.imageName){const t=r[a.imageName];if(!t)continue;E=a.imageName,e.iconsInText=e.iconsInText||!0,T=t.paddedRect;const n=t.displaySize;m=m*Wd/h,y={width:n[0],height:n[1],left:0,top:-fp,advance:P?n[1]:n[0],localGlyph:!1},M=g?-y.height*m:i*Wd-17-n[1]*m,A=y.advance;const o=(P?n[0]:n[1])*m-Wd*i;o>0&&o>x&&(x=o)}else{const e=n[a.fontStack];if(!e)continue;e[f]&&(T=e[f]);const r=t[a.fontStack];if(!r)continue;const o=r.glyphs[f];if(!o)continue;if(y=o.metrics,A=8203!==f?Wd:0,g){const e=void 0!==r.ascender?Math.abs(r.ascender):0,t=void 0!==r.descender?Math.abs(r.descender):0,n=(e+t)*m;b<n&&(b=n,S=(e-t)/2*m),M=-e*m}else M=(i-m)*Wd-17}P?(e.verticalizable=!0,v.push({glyph:f,imageName:E,x:d,y:p+M,vertical:P,scale:m,localGlyph:y.localGlyph,fontStack:a.fontStack,sectionIndex:s,metrics:y,rect:T}),d+=A*m+c):(v.push({glyph:f,imageName:E,x:d,y:p+M,vertical:P,scale:m,localGlyph:y.localGlyph,fontStack:a.fontStack,sectionIndex:s,metrics:y,rect:T}),d+=y.advance*m+c)}0!==v.length&&(f=Math.max(d-c,f),g?Mp(v,m,x,S,o*i/2):Mp(v,m,x,0,o/2)),d=0;const T=o*i+x;s.lineOffset=Math.max(x,a),p+=T,++y}var _;const v=p,{horizontalAlign:x,verticalAlign:b}=Ap(a);(function(e,t,n,r,i,o){const a=(t-n)*i,s=-o*r;for(const l of e)for(const e of l.positionedGlyphs)e.x+=a,e.y+=s})(e.positionedLines,m,x,b,f,v),e.top+=-b*v,e.bottom=e.top+v,e.left+=-x*f,e.right=e.left+f,e.hasBaseline=g}(b,t,n,r,g,a,s,l,h,c,d,f),!function(e){for(const t of e)if(0!==t.positionedGlyphs.length)return!1;return!0}(x)&&b}const vp={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},xp={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function bp(e,t,n,r,i,o){if(t.imageName){const e=r[t.imageName];return e?e.displaySize[0]*t.scale*Wd/o+i:0}{const r=n[t.fontStack],o=r&&r.glyphs[e];return o?o.metrics.advance*t.scale+i:0}}function wp(e,t,n,r){const i=Math.pow(e-t,2);return r?e<t?i/2:2*i:i+Math.abs(n)*n}function Sp(e,t,n){let r=0;return 10===e&&(r-=1e4),n&&(r+=150),40!==e&&65288!==e||(r+=50),41!==t&&65289!==t||(r+=50),r}function Tp(e,t,n,r,i,o){let a=null,s=wp(t,n,i,o);for(const l of r){const e=wp(t-l.x,n,i,o)+l.badness;e<=s&&(a=l,s=e)}return{index:e,x:t,priorBreak:a,badness:s}}function Ep(e){return e?Ep(e.priorBreak).concat(e.index):[]}function Ap(e){let t=.5,n=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:t,verticalAlign:n}}function Mp(e,t,n,r,i){if(!(t||n||r||i))return;const o=e.length-1,a=e[o],s=(a.x+a.metrics.advance*a.scale)*t;for(let l=0;l<=o;l++)e[l].x-=s,e[l].y+=n+r+i}function Pp(e,t,n,r){const{horizontalAlign:i,verticalAlign:o}=Ap(r),a=n[0]-e.displaySize[0]*i,s=n[1]-e.displaySize[1]*o;return{imagePrimary:e,imageSecondary:t,top:s,bottom:s+e.displaySize[1],left:a,right:a+e.displaySize[0]}}function kp(e,t,n,r,i,o){const a=e.imagePrimary;let s;if(a.content){const e=a.content,t=a.pixelRatio||1;s=[e[0]/t,e[1]/t,a.displaySize[0]-e[2]/t,a.displaySize[1]-e[3]/t]}const l=t.left*o,c=t.right*o;let u,h,d,p;"width"===n||"both"===n?(p=i[0]+l-r[3],h=i[0]+c+r[1]):(p=i[0]+(l+c-a.displaySize[0])/2,h=p+a.displaySize[0]);const f=t.top*o,m=t.bottom*o;return"height"===n||"both"===n?(u=i[1]+f-r[0],d=i[1]+m+r[2]):(u=i[1]+(f+m-a.displaySize[1])/2,d=u+a.displaySize[1]),{imagePrimary:a,imageSecondary:void 0,top:u,right:h,bottom:d,left:p,collisionPadding:s}}class Cp extends H{constructor(e,t,n,r,i){super(e,t),this.angle=r,this.z=n,void 0!==i&&(this.segment=i)}clone(){return new Cp(this.x,this.y,this.z,this.angle,this.segment)}}function jp(e,t,n,r,i){if(void 0===t.segment)return!0;let o=t,a=t.segment+1,s=0;for(;s>-n/2;){if(a--,a<0)return!1;s-=e[a].dist(o),o=e[a]}s+=e[a].dist(e[a+1]),a++;const l=[];let c=0;for(;s<n/2;){const t=e[a],n=e[a+1];if(!n)return!1;let o=e[a-1].angleTo(t)-t.angleTo(n);for(o=Math.abs((o+3*Math.PI)%(2*Math.PI)-Math.PI),l.push({distance:s,angleDelta:o}),c+=o;s-l[0].distance>r;)c-=l.shift().angleDelta;if(c>i)return!1;a++,s+=t.dist(n)}return!0}function Ip(e){let t=0;for(let n=0;n<e.length-1;n++)t+=e[n].dist(e[n+1]);return t}function Op(e,t,n){return e?.6*t*n:0}function Np(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function Dp(e,t,n,r,i,o){const a=Op(n,i,o),s=Np(n,r)*o;let l=0;const c=Ip(e)/2;for(let u=0;u<e.length-1;u++){const n=e[u],r=e[u+1],i=n.dist(r);if(l+i>c){const o=(c-l)/i,h=kt(n.x,r.x,o),d=kt(n.y,r.y,o),p=new Cp(h,d,0,r.angleTo(n),u);return!a||jp(e,p,s,a,t)?p:void 0}l+=i}}function Lp(e,t,n,r,i,o,a,s,l){const c=Op(r,o,a),u=Np(r,i),h=u*a,d=0===e[0].x||e[0].x===l||0===e[0].y||e[0].y===l;return t-h<t/4&&(t=h+t/4),zp(e,d?t/2*s%t:(u/2+2*o)*a*s%t,t,c,n,h,d,!1,l)}function zp(e,t,n,r,i,o,a,s,l){const c=o/2,u=Ip(e);let h=0,d=t-n,p=[];for(let f=0;f<e.length-1;f++){const t=e[f],a=e[f+1],s=t.dist(a),m=a.angleTo(t);for(;d+n<h+s;){d+=n;const g=(d-h)/s,y=kt(t.x,a.x,g),_=kt(t.y,a.y,g);if(y>=0&&y<l&&_>=0&&_<l&&d-c>=0&&d+c<=u){const t=new Cp(y,_,0,m,f);r&&!jp(e,t,o,r,i)||p.push(t)}}h+=s}return s||p.length||a||(p=zp(e,h/2,n,r,i,o,a,!0,l)),p}function Rp(e,t,n,r,i){const o=[];for(let a=0;a<e.length;a++){const s=e[a];let l;for(let e=0;e<s.length-1;e++){let a=s[e],c=s[e+1];a.x<t&&c.x<t||(a.x<t?a=new H(t,a.y+(t-a.x)/(c.x-a.x)*(c.y-a.y))._round():c.x<t&&(c=new H(t,a.y+(t-a.x)/(c.x-a.x)*(c.y-a.y))._round()),a.y<n&&c.y<n||(a.y<n?a=new H(a.x+(n-a.y)/(c.y-a.y)*(c.x-a.x),n)._round():c.y<n&&(c=new H(a.x+(n-a.y)/(c.y-a.y)*(c.x-a.x),n)._round()),a.x>=r&&c.x>=r||(a.x>=r?a=new H(r,a.y+(r-a.x)/(c.x-a.x)*(c.y-a.y))._round():c.x>=r&&(c=new H(r,a.y+(r-a.x)/(c.x-a.x)*(c.y-a.y))._round()),a.y>=i&&c.y>=i||(a.y>=i?a=new H(a.x+(i-a.y)/(c.y-a.y)*(c.x-a.x),i)._round():c.y>=i&&(c=new H(a.x+(i-a.y)/(c.y-a.y)*(c.x-a.x),i)._round()),l&&a.equals(l[l.length-1])||(l=[a],o.push(l)),l.push(c)))))}}return o}function Fp(e){let t=0,n=0;for(const a of e)t+=a.w*a.h,n=Math.max(n,a.w);e.sort(((e,t)=>t.h-e.h));const r=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),n),h:1/0}];let i=0,o=0;for(const a of e)for(let e=r.length-1;e>=0;e--){const t=r[e];if(!(a.w>t.w||a.h>t.h)){if(a.x=t.x,a.y=t.y,o=Math.max(o,a.y+a.h),i=Math.max(i,a.x+a.w),a.w===t.w&&a.h===t.h){const t=r.pop();e<r.length&&(r[e]=t)}else a.h===t.h?(t.x+=a.w,t.w-=a.w):a.w===t.w?(t.y+=a.h,t.h-=a.h):(r.push({x:t.x+a.w,y:t.y,w:t.w-a.w,h:a.h}),t.y+=a.h,t.h-=a.h);break}}return{w:i,h:o,fill:t/(i*o)||0}}so(Cp,"Anchor");const Bp=1;class Vp{constructor(e,t,n){let{pixelRatio:r,version:i,stretchX:o,stretchY:a,content:s}=t;this.paddedRect=e,this.pixelRatio=r,this.stretchX=o,this.stretchY=a,this.content=s,this.version=i,this.padding=n}get tl(){return[this.paddedRect.x+this.padding,this.paddedRect.y+this.padding]}get br(){return[this.paddedRect.x+this.paddedRect.w-this.padding,this.paddedRect.y+this.paddedRect.h-this.padding]}get displaySize(){return[(this.paddedRect.w-2*this.padding)/this.pixelRatio,(this.paddedRect.h-2*this.padding)/this.pixelRatio]}}class Up{constructor(e,t,n){const r={},i={};this.haveRenderCallbacks=[];const o=[];this.addImages(e,r,Bp,o),this.addImages(t,i,2,o);const{w:a,h:s}=Fp(o),l=new au({width:a||1,height:s||1});for(const c in e){const t=e[c],i=r[c].paddedRect;au.copy(t.data,l,{x:0,y:0},{x:i.x+Bp,y:i.y+Bp},t.data,n,t.sdf)}for(const c in t){const e=t[c],r=i[c].paddedRect;let o=i[c].padding;const a=r.x+o,s=r.y+o,u=e.data.width,h=e.data.height;o=o>1?o-1:o,au.copy(e.data,l,{x:0,y:0},{x:a,y:s},e.data,n),au.copy(e.data,l,{x:0,y:h-o},{x:a,y:s-o},{width:u,height:o},n),au.copy(e.data,l,{x:0,y:0},{x:a,y:s+h},{width:u,height:o},n),au.copy(e.data,l,{x:u-o,y:0},{x:a-o,y:s},{width:o,height:h},n),au.copy(e.data,l,{x:0,y:0},{x:a+u,y:s},{width:o,height:h},n),au.copy(e.data,l,{x:u-o,y:h-o},{x:a-o,y:s-o},{width:o,height:o},n),au.copy(e.data,l,{x:0,y:h-o},{x:a+u,y:s-o},{width:o,height:o},n),au.copy(e.data,l,{x:0,y:0},{x:a+u,y:s+h},{width:o,height:o},n),au.copy(e.data,l,{x:u-o,y:0},{x:a-o,y:s+h},{width:o,height:o},n)}this.image=l,this.iconPositions=r,this.patternPositions=i}addImages(e,t,n,r){for(const i in e){const o=e[i],a={x:0,y:0,w:o.data.width+2*n,h:o.data.height+2*n};r.push(a),t[i]=new Vp(a,o,n),o.hasRenderCallback&&this.haveRenderCallbacks.push(i)}}patchUpdatedImages(e,t,n){this.haveRenderCallbacks=this.haveRenderCallbacks.filter((t=>e.hasImage(t,n))),e.dispatchRenderCallbacks(this.haveRenderCallbacks,n);for(const r in e.getUpdatedImages(n))this.patchUpdatedImage(this.iconPositions[r],e.getImage(r,n),t),this.patchUpdatedImage(this.patternPositions[r],e.getImage(r,n),t)}patchUpdatedImage(e,t,n){if(!e||!t)return;if(e.version===t.version)return;e.version=t.version;const[r,i]=e.tl;n.update(t.data,{position:{x:r,y:i}})}}so(Vp,"ImagePosition"),so(Up,"ImageAtlas");const Gp=1e20;function Hp(e,t,n,r,i,o,a,s,l){for(let c=t;c<t+r;c++)Zp(e,n*o+c,o,i,a,s,l);for(let c=n;c<n+i;c++)Zp(e,c*o+t,1,r,a,s,l)}function Zp(e,t,n,r,i,o,a){o[0]=0,a[0]=-Gp,a[1]=Gp,i[0]=e[t];for(let s=1,l=0,c=0;s<r;s++){i[s]=e[t+s*n];const r=s*s;do{const e=o[l];c=(i[s]-i[e]+r-e*e)/(s-e)/2}while(c<=a[l]&&--l>-1);l++,o[l]=s,a[l]=c,a[l+1]=Gp}for(let s=0,l=0;s<r;s++){for(;a[l+1]<s;)l++;const r=o[l],c=s-r;e[t+s*n]=i[r]+c*c}}const qp=2,Wp={none:0,ideographs:1,all:2};class Xp{constructor(e,t,n){this.requestManager=e,this.localGlyphMode=t,this.localFontFamily=n,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(e,t){this.urls[t]=e}getGlyphs(e,t,n){const r=[],i=this.urls[t]||Ae.GLYPHS_URL;for(const o in e)for(const t of e[o])r.push({stack:o,id:t});re(r,((e,t)=>{let{stack:n,id:r}=e,o=this.entries[n];o||(o=this.entries[n]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let a=o.glyphs[r];if(void 0!==a)return void t(null,{stack:n,id:r,glyph:a});if(a=this._tinySDF(o,n,r),a)return o.glyphs[r]=a,void t(null,{stack:n,id:r,glyph:a});const s=Math.floor(r/256);if(256*s>65535)return fe("glyphs > 65535 not supported"),void t(null,{stack:n,id:r,glyph:a});if(o.ranges[s])return void t(null,{stack:n,id:r,glyph:a});let l=o.requests[s];l||(l=o.requests[s]=[],Xp.loadGlyphRange(n,s,i,this.requestManager,((e,t)=>{if(t){o.ascender=t.ascender,o.descender=t.descender;for(const e in t.glyphs)this._doesCharSupportLocalGlyph(+e)||(o.glyphs[+e]=t.glyphs[+e]);o.ranges[s]=!0}for(const n of l)n(e,t);delete o.requests[s]}))),l.push(((e,i)=>{e?t(e):i&&t(null,{stack:n,id:r,glyph:i.glyphs[r]||null})}))}),((e,t)=>{if(e)n(e);else if(t){const e={};for(const{stack:n,id:r,glyph:i}of t)void 0===e[n]&&(e[n]={}),void 0===e[n].glyphs&&(e[n].glyphs={}),e[n].glyphs[r]=i&&{id:i.id,bitmap:i.bitmap.clone(),metrics:i.metrics},e[n].ascender=this.entries[n].ascender,e[n].descender=this.entries[n].descender;n(null,e)}}))}_doesCharSupportLocalGlyph(e){return this.localGlyphMode!==Wp.none&&(this.localGlyphMode===Wp.all?!!this.localFontFamily:!!this.localFontFamily&&(po["CJK Unified Ideographs"](e)||po["Hangul Syllables"](e)||po.Hiragana(e)||po.Katakana(e)||po["CJK Symbols and Punctuation"](e)||po["CJK Unified Ideographs Extension A"](e)||po["CJK Unified Ideographs Extension B"](e)||po.Osage(e)))}_tinySDF(e,t,n){const r=this.localFontFamily;if(!r||!this._doesCharSupportLocalGlyph(n))return;let i=e.tinySDF;if(!i){let n="400";/bold/i.test(t)?n="900":/medium/i.test(t)?n="500":/light/i.test(t)&&(n="200"),i=e.tinySDF=new Xp.TinySDF({fontFamily:r,fontWeight:n,fontSize:24*qp,buffer:3*qp,radius:8*qp}),i.fontWeight=n}if(this.localGlyphs[i.fontWeight][n])return this.localGlyphs[i.fontWeight][n];const o=String.fromCodePoint(n),{data:a,width:s,height:l,glyphWidth:c,glyphHeight:u,glyphLeft:h,glyphTop:d,glyphAdvance:p}=i.draw(o);return this.localGlyphs[i.fontWeight][n]={id:n,bitmap:new ou({width:s,height:l},a),metrics:{width:c/qp,height:u/qp,left:h/qp,top:d/qp-27,advance:p/qp,localGlyph:!0}}}}Xp.loadGlyphRange=function(e,t,n,r,i){const o=256*t,a=o+255,s=r.transformRequest(r.normalizeGlyphsURL(n).replace("{fontstack}",e).replace("{range}","".concat(o,"-").concat(a)),tt.Glyphs);ot(s,((e,t)=>{if(e)i(e);else if(t){const e={},n=function(e){return new cp(e).readFields(hp,{})}(t);for(const t of n.glyphs)e[t.id]=t;i(null,{glyphs:e,ascender:n.ascender,descender:n.descender})}}))},Xp.TinySDF=class{constructor(){let{fontSize:e=24,buffer:t=3,radius:n=8,cutoff:r=.25,fontFamily:i="sans-serif",fontWeight:o="normal",fontStyle:a="normal"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.buffer=t,this.cutoff=r,this.radius=n;const s=this.size=e+4*t,l=this._createCanvas(s),c=this.ctx=l.getContext("2d",{willReadFrequently:!0});c.font="".concat(a," ").concat(o," ").concat(e,"px ").concat(i),c.textBaseline="alphabetic",c.textAlign="left",c.fillStyle="black",this.gridOuter=new Float64Array(s*s),this.gridInner=new Float64Array(s*s),this.f=new Float64Array(s),this.z=new Float64Array(s+1),this.v=new Uint16Array(s)}_createCanvas(e){const t=document.createElement("canvas");return t.width=t.height=e,t}draw(e){const{width:t,actualBoundingBoxAscent:n,actualBoundingBoxDescent:r,actualBoundingBoxLeft:i,actualBoundingBoxRight:o}=this.ctx.measureText(e),a=Math.ceil(n),s=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(o-i))),l=Math.min(this.size-this.buffer,a+Math.ceil(r)),c=s+2*this.buffer,u=l+2*this.buffer,h=Math.max(c*u,0),d=new Uint8ClampedArray(h),p={data:d,width:c,height:u,glyphWidth:s,glyphHeight:l,glyphTop:a,glyphLeft:0,glyphAdvance:t};if(0===s||0===l)return p;const{ctx:f,buffer:m,gridInner:g,gridOuter:y}=this;f.clearRect(m,m,s,l),f.fillText(e,m,m+a);const _=f.getImageData(m,m,s,l);y.fill(Gp,0,h),g.fill(0,0,h);for(let v=0;v<l;v++)for(let e=0;e<s;e++){const t=_.data[4*(v*s+e)+3]/255;if(0===t)continue;const n=(v+m)*c+e+m;if(1===t)y[n]=0,g[n]=Gp;else{const e=.5-t;y[n]=e>0?e*e:0,g[n]=e<0?e*e:0}}Hp(y,0,0,c,u,c,this.f,this.v,this.z),Hp(g,m,m,s,l,c,this.f,this.v,this.z);for(let v=0;v<h;v++){const e=Math.sqrt(y[v])-Math.sqrt(g[v]);d[v]=Math.round(255-255*(e/this.radius+this.cutoff))}return p}};const Yp=Bp;function Kp(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;const o=[],a=e.imagePrimary,s=a.pixelRatio,l=a.paddedRect.w-2*Yp,c=a.paddedRect.h-2*Yp,u=(e.right-e.left)*i,h=(e.bottom-e.top)*i,d=a.stretchX||[[0,l]],p=a.stretchY||[[0,c]],f=(e,t)=>e+t[1]-t[0],m=d.reduce(f,0),g=p.reduce(f,0),y=l-m,_=c-g;let v=0,x=m,b=0,w=g,S=0,T=y,E=0,A=_;if(a.content&&r){const e=a.content;v=Jp(d,0,e[0]),b=Jp(p,0,e[1]),x=Jp(d,e[0],e[2]),w=Jp(p,e[1],e[3]),S=e[0]-v,E=e[1]-b,T=e[2]-e[0]-x,A=e[3]-e[1]-w}const M=(r,o,l,c)=>{const d=$p(r.stretch-v,x,u,e.left*i),p=ef(r.fixed-S,T,r.stretch,m),f=$p(o.stretch-b,w,h,e.top*i),y=ef(o.fixed-E,A,o.stretch,g),_=$p(l.stretch-v,x,u,e.left*i),M=ef(l.fixed-S,T,l.stretch,m),P=$p(c.stretch-b,w,h,e.top*i),k=ef(c.fixed-E,A,c.stretch,g),C=new H(d,f),j=new H(_,f),I=new H(_,P),O=new H(d,P),N=new H(p/s,y/s),D=new H(M/s,k/s),L=t*Math.PI/180;if(L){const e=Math.sin(L),t=Math.cos(L),n=[t,-e,e,t];C._matMult(n),j._matMult(n),O._matMult(n),I._matMult(n)}const z=r.stretch+r.fixed,R=l.stretch+l.fixed,F=o.stretch+o.fixed,B=c.stretch+c.fixed,V=e.imageSecondary;return{tl:C,tr:j,bl:O,br:I,texPrimary:{x:a.paddedRect.x+Yp+z,y:a.paddedRect.y+Yp+F,w:R-z,h:B-F},texSecondary:V?{x:V.paddedRect.x+Yp+z,y:V.paddedRect.y+Yp+F,w:R-z,h:B-F}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:N,pixelOffsetBR:D,minFontScaleX:T/s/u,minFontScaleY:A/s/h,isSDF:n}};if(r&&(a.stretchX||a.stretchY)){const e=Qp(d,y,m),t=Qp(p,_,g);for(let n=0;n<e.length-1;n++){const r=e[n],i=e[n+1];for(let e=0;e<t.length-1;e++)o.push(M(r,t[e],i,t[e+1]))}}else o.push(M({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:l+1},{fixed:0,stretch:c+1}));return o}function Jp(e,t,n){let r=0;for(const i of e)r+=Math.max(t,Math.min(n,i[1]))-Math.max(t,Math.min(n,i[0]));return r}function Qp(e,t,n){const r=[{fixed:-Yp,stretch:0}];for(const[i,o]of e){const e=r[r.length-1];r.push({fixed:i-e.stretch,stretch:e.stretch}),r.push({fixed:i-e.stretch,stretch:e.stretch+(o-i)})}return r.push({fixed:t+Yp,stretch:n}),r}function $p(e,t,n,r){return e/t*n+r}function ef(e,t,n,r){return e-t*n/r}function tf(e,t,n,r){const i=t+e.positionedLines[r].lineOffset;return 0===r?n+i/2:n+(i+(t+e.positionedLines[r-1].lineOffset))/2}function nf(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=1/0,i=1/0,o=-1/0,a=-1/0;const s=e[0];for(let p=0;p<s.length;p++){const e=s[p];(!p||e.x<r)&&(r=e.x),(!p||e.y<i)&&(i=e.y),(!p||e.x>o)&&(o=e.x),(!p||e.y>a)&&(a=e.y)}const l=Math.min(o-r,a-i);let c=l/2;const u=new Kn([],rf);if(0===l)return new H(r,i);for(let p=r;p<o;p+=l)for(let t=i;t<a;t+=l)u.push(new of(p+c,t+c,c,e));let h=function(e){let t=0,n=0,r=0;const i=e[0];for(let o=0,a=i.length,s=a-1;o<a;s=o++){const e=i[o],a=i[s],l=e.x*a.y-a.x*e.y;n+=(e.x+a.x)*l,r+=(e.y+a.y)*l,t+=3*l}return new of(n/t,r/t,0,e)}(e),d=u.length;for(;u.length;){const r=u.pop();(r.d>h.d||!h.d)&&(h=r,n&&console.log("found best %d after %d probes",Math.round(1e4*r.d)/1e4,d)),r.max-h.d<=t||(c=r.h/2,u.push(new of(r.p.x-c,r.p.y-c,c,e)),u.push(new of(r.p.x+c,r.p.y-c,c,e)),u.push(new of(r.p.x-c,r.p.y+c,c,e)),u.push(new of(r.p.x+c,r.p.y+c,c,e)),d+=4)}return n&&(console.log("num probes: ".concat(d)),console.log("best distance: ".concat(h.d))),h.p}function rf(e,t){return t.max-e.max}class of{constructor(e,t,n,r){this.p=new H(e,t),this.h=n,this.d=function(e,t){let n=!1,r=1/0;for(let i=0;i<t.length;i++){const o=t[i];for(let t=0,i=o.length,a=i-1;t<i;a=t++){const i=o[t],s=o[a];i.y>e.y!=s.y>e.y&&e.x<(s.x-i.x)*(e.y-i.y)/(s.y-i.y)+i.x&&(n=!n),r=Math.min(r,Bl(e,i,s))}}return(n?1:-1)*Math.sqrt(r)}(this.p,r),this.max=this.d+this.h*Math.SQRT2}}const af=Number.POSITIVE_INFINITY,sf=Math.sqrt(2);function lf(e,t){let[n,r]=t,i=0,o=0;if(r===af){n<0&&(n=0);const t=n/sf;switch(e){case"top-right":case"top-left":o=t-7;break;case"bottom-right":case"bottom-left":o=7-t;break;case"bottom":o=7-n;break;case"top":o=n-7}switch(e){case"top-right":case"bottom-right":i=-t;break;case"top-left":case"bottom-left":i=t;break;case"left":i=n;break;case"right":i=-n}}else{switch(n=Math.abs(n),r=Math.abs(r),e){case"top-right":case"top-left":case"top":o=r-7;break;case"bottom-right":case"bottom-left":case"bottom":o=7-r}switch(e){case"top-right":case"bottom-right":case"right":i=-n;break;case"top-left":case"bottom-left":case"left":i=n}}return[i,o]}function cf(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function uf(e,t,n,r,i,o,a,s,l,c,u,h,d,p,f){let m=o.textMaxSize.evaluate(t,{},h);void 0===m?m=a*o.textScaleFactor:m*=o.textScaleFactor;const g=e.layers[0].layout,y=g.get("icon-offset").evaluate(t,{},h),_=ff(n.horizontal)||n.vertical,v="globe"===d.name,x=Wd,b=a*o.textScaleFactor/x,w=e.tilePixelRatio*m/x,S=(j=e.overscaling,e.zoom>18&&j>2&&(j>>=1),Math.max(Jn/(512*j),1)*g.get("symbol-spacing")),T=g.get("text-padding")*e.tilePixelRatio,E=g.get("icon-padding")*e.tilePixelRatio,A=X(g.get("text-max-angle")),M="map"===g.get("text-rotation-alignment")&&"point"!==g.get("symbol-placement"),P="map"===g.get("icon-rotation-alignment")&&"point"!==g.get("symbol-placement"),k=g.get("symbol-placement"),C=S/2;var j;const I=g.get("icon-text-fit").evaluate(t,{},h),O=g.get("icon-text-fit-padding").evaluate(t,{},h),N="none"!==I;let D;!1===e.hasAnyIconTextFit&&N&&(e.hasAnyIconTextFit=!0),r&&N&&(e.allowVerticalPlacement&&n.vertical&&(D=kp(r,n.vertical,I,O,y,b)),_&&(r=kp(r,_,I,O,y,b)));const L=(a,s,m)=>{if(s.x<0||s.x>=Jn||s.y<0||s.y>=Jn)return;let g=null;if(v){const{x:e,y:t,z:n}=d.projectTilePoint(s.x,s.y,m);g={anchor:new Cp(e,t,n,0,void 0),up:d.upVector(m,s.x,s.y)}}!function(e,t,n,r,i,o,a,s,l,c,u,h,d,p,f,m,g,y,_,v,x,b,w,S,T,E,A){const M=e.addToLineVertexArray(t,r);let P,k,C,j,I,O,N,D=0,L=0,z=0,R=0,F=-1,B=-1;const V={};let U=_t("");const G=n?n.anchor:t,H="none"!==l.layout.get("icon-text-fit").evaluate(x,{},T);let Z=0,q=0;if(void 0===l._unevaluatedLayout.getValue("text-radial-offset")?[Z,q]=l.layout.get("text-offset").evaluate(x,{},T).map((e=>e*Wd)):(Z=l.layout.get("text-radial-offset").evaluate(x,{},T)*Wd,q=af),e.allowVerticalPlacement&&i.vertical){const e=i.vertical;if(f)O=gf(e),s&&(N=gf(s));else{const n=l.layout.get("text-rotate").evaluate(x,{},T)+90;C=mf(c,G,t,u,h,d,e,p,n,m),s&&(j=mf(c,G,t,u,h,d,s,y,n))}}if(o){const r=l.layout.get("icon-rotate").evaluate(x,{},T),i=Kp(o,r,w,H,b.iconScaleFactor),a=s?Kp(s,r,w,H,b.iconScaleFactor):void 0;k=mf(c,G,t,u,h,d,o,y,r),D=4*i.length;const p=e.iconSizeData;let f=null;"source"===p.kind?(f=[Xd*l.layout.get("icon-size").evaluate(x,{},T)*b.iconScaleFactor],f[0]>df&&fe("".concat(e.layerIds[0],': Value for "icon-size" is >= ').concat(hf,'. Reduce your "icon-size".'))):"composite"===p.kind&&(f=[Xd*b.compositeIconSizes[0].evaluate(x,{},T)*b.iconScaleFactor,Xd*b.compositeIconSizes[1].evaluate(x,{},T)*b.iconScaleFactor],(f[0]>df||f[1]>df)&&fe("".concat(e.layerIds[0],': Value for "icon-size" is >= ').concat(hf,'. Reduce your "icon-size".'))),e.addSymbols(e.icon,i,f,v,_,x,!1,n,t,M.lineStartIndex,M.lineLength,-1,S,T,E,A),F=e.icon.placedSymbolArray.length-1,a&&(L=4*a.length,e.addSymbols(e.icon,a,f,v,_,x,mp.vertical,n,t,M.lineStartIndex,M.lineLength,-1,S,T,E,A),B=e.icon.placedSymbolArray.length-1)}for(const K in i.horizontal){const r=i.horizontal[K];P||(U=_t(r.text),f?I=gf(r):P=mf(c,G,t,u,h,d,r,p,l.layout.get("text-rotate").evaluate(x,{},T),m));const o=1===r.positionedLines.length;if(z+=pf(e,n,t,r,a,l,f,x,m,M,i.vertical?mp.horizontal:mp.horizontalOnly,o?Object.keys(i.horizontal):[K],V,F,b,S,T,E),o)break}i.vertical&&(R+=pf(e,n,t,i.vertical,a,l,f,x,m,M,mp.vertical,["vertical"],V,B,b,S,T,E));let W=-1;const X=(e,t)=>e?Math.max(e,t):t;W=X(I,W),W=X(O,W),W=X(N,W);const Y=W>-1?1:0;e.glyphOffsetArray.length>=65535&&fe("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==x.sortKey&&e.addToSortKeyRanges(e.symbolInstances.length,x.sortKey),e.symbolInstances.emplaceBack(t.x,t.y,G.x,G.y,G.z,V.right>=0?V.right:-1,V.center>=0?V.center:-1,V.left>=0?V.left:-1,V.vertical>=0?V.vertical:-1,F,B,U,void 0!==P?P:e.collisionBoxArray.length,void 0!==P?P+1:e.collisionBoxArray.length,void 0!==C?C:e.collisionBoxArray.length,void 0!==C?C+1:e.collisionBoxArray.length,void 0!==k?k:e.collisionBoxArray.length,void 0!==k?k+1:e.collisionBoxArray.length,j||e.collisionBoxArray.length,j?j+1:e.collisionBoxArray.length,u,z,R,D,L,Y,0,Z,q,W,0,H?1:0)}(e,s,g,a,n,r,i,D,e.layers[0],e.collisionBoxArray,t.index,t.sourceLayerIndex,e.index,T,M,l,0,E,P,y,t,o,c,u,h,p,f)};if("line"===k)for(const z of Rp(t.geometry,0,0,Jn,Jn)){const t=Lp(z,S,A,n.vertical||_,r,x,w,e.overscaling,Jn);for(const n of t)_&&yf(e,_.text,C,n)||L(z,n,h)}else if("line-center"===k){for(const z of t.geometry)if(z.length>1){const e=Dp(z,A,n.vertical||_,r,x,w);e&&L(z,e,h)}}else if("Polygon"===t.type)for(const z of Lu(t.geometry,0)){const e=nf(z,16);L(z[0],new Cp(e.x,e.y,0,0,void 0),h)}else if("LineString"===t.type)for(const z of t.geometry)L(z,new Cp(z[0].x,z[0].y,0,0,void 0),h);else if("Point"===t.type)for(const z of t.geometry)for(const e of z)L([e],new Cp(e.x,e.y,0,0,void 0),h)}const hf=255,df=hf*Xd;function pf(e,t,n,r,i,o,a,s,l,c,u,h,d,p,f,m,g,y){const _=function(e,t,n,r,i,o,a,s){const l=[];if(0===t.positionedLines.length)return l;const c=r.layout.get("text-rotate").evaluate(o,{})*Math.PI/180,u=function(e){const t=e[0],n=e[1],r=t*n;return r>0?[t,-n]:r<0?[-t,n]:0===t?[n,t]:[n,-t]}(n);let h=Math.abs(t.top-t.bottom);for(const m of t.positionedLines)h-=m.lineOffset;const d=t.positionedLines.length,p=h/d;let f=t.top-n[1];for(let m=0;m<d;++m){const e=t.positionedLines[m];f=tf(t,p,f,m);for(const r of e.positionedGlyphs){if(!r.rect)continue;const e=r.rect||{};let o=fp+1,h=!0,d=1,p=0;if(r.imageName){const e=a[r.imageName];if(!e)continue;if(e.sdf){fe("SDF images are not supported in formatted text and will be ignored.");continue}h=!1,d=e.pixelRatio,o=Bp/d}const m=(i||s)&&r.vertical,g=r.metrics.advance*r.scale/2,y=r.metrics,_=r.rect;if(null===_)continue;s&&t.verticalizable&&(p=r.imageName?g-r.metrics.width*r.scale/2:0);const v=i?[r.x+g,r.y]:[0,0];let x=[0,0],b=[0,0],w=!1;i||(m?(b=[r.x+g+u[0],r.y+u[1]-p],w=!0):x=[r.x+g+n[0],r.y+n[1]-p]);const S=_.w*r.scale/(d*(r.localGlyph?qp:1)),T=_.h*r.scale/(d*(r.localGlyph?qp:1));let E,A,M,P;if(m){const e=r.y-f,t=new H(-g,g-e),n=-Math.PI/2,i=new H(...b);E=new H(-g+x[0],x[1]),E._rotateAround(n,t)._add(i),E.x+=-e+g,E.y-=(y.left-o)*r.scale;const a=r.imageName?y.advance*r.scale:Wd*r.scale,s=String.fromCodePoint(r.glyph);tp(s)?E.x+=(1-o)*r.scale:np(s)?E.x+=a-y.height*r.scale+(-o-1)*r.scale:E.x+=r.imageName||y.width+2*o===_.w&&y.height+2*o===_.h?(a-T)/2:(a-(y.height+2*o)*r.scale)/2,A=new H(E.x,E.y-S),M=new H(E.x+T,E.y),P=new H(E.x+T,E.y-S)}else{const e=(y.left-o)*r.scale-g+x[0],t=(-y.top-o)*r.scale+x[1],n=e+S,i=t+T;E=new H(e,t),A=new H(n,t),M=new H(e,i),P=new H(n,i)}if(c){let e;e=i?new H(0,0):w?new H(u[0],u[1]):new H(n[0],n[1]),E._rotateAround(c,e),A._rotateAround(c,e),M._rotateAround(c,e),P._rotateAround(c,e)}const k=new H(0,0),C=new H(0,0);l.push({tl:E,tr:A,bl:M,br:P,texPrimary:e,texSecondary:void 0,writingMode:t.writingMode,glyphOffset:v,sectionIndex:r.sectionIndex,isSDF:h,pixelOffsetTL:k,pixelOffsetBR:C,minFontScaleX:0,minFontScaleY:0})}}return l}(0,r,l,o,a,s,i,e.allowVerticalPlacement),v=e.textSizeData;let x=null;"source"===v.kind?(x=[Xd*o.layout.get("text-size").evaluate(s,{},g)*f.textScaleFactor],x[0]>df&&fe("".concat(e.layerIds[0],': Value for "text-size" is >= ').concat(hf,'. Reduce your "text-size".'))):"composite"===v.kind&&(x=[Xd*f.compositeTextSizes[0].evaluate(s,{},g)*f.textScaleFactor,Xd*f.compositeTextSizes[1].evaluate(s,{},g)*f.textScaleFactor],(x[0]>df||x[1]>df)&&fe("".concat(e.layerIds[0],': Value for "text-size" is >= ').concat(hf,'. Reduce your "text-size".'))),e.addSymbols(e.text,_,x,l,a,s,u,t,n,c.lineStartIndex,c.lineLength,p,m,g,y,!1);for(const b of h)d[b]=e.text.placedSymbolArray.length-1;return 4*_.length}function ff(e){for(const t in e)return e[t];return null}function mf(e,t,n,r,i,o,a,s,l,c){let u=a.top,h=a.bottom,d=a.left,p=a.right;const f=a.collisionPadding;if(f&&(d-=f[0],u-=f[1],p+=f[2],h+=f[3]),l){const e=new H(d,u),t=new H(p,u),n=new H(d,h),r=new H(p,h),i=X(l);let o=new H(0,0);c&&(o=new H(c[0],c[1])),e._rotateAround(i,o),t._rotateAround(i,o),n._rotateAround(i,o),r._rotateAround(i,o),d=Math.min(e.x,t.x,n.x,r.x),p=Math.max(e.x,t.x,n.x,r.x),u=Math.min(e.y,t.y,n.y,r.y),h=Math.max(e.y,t.y,n.y,r.y)}return e.emplaceBack(t.x,t.y,t.z,n.x,n.y,d,u,p,h,s,r,i,o),e.length-1}function gf(e){e.collisionPadding&&(e.top-=e.collisionPadding[1],e.bottom+=e.collisionPadding[3]);const t=e.bottom-e.top;return t>0?Math.max(10,t):null}function yf(e,t,n,r){const i=e.compareText;if(t in i){const e=i[t];for(let t=e.length-1;t>=0;t--)if(r.dist(e[t])<n)return!0}else i[t]=[];return i[t].push(r),!1}function _f(e,t){const n=e.fovAboveCenter,r=e.elevation?e.elevation.getMinElevationBelowMSL()*t:0,i=(e._camera.position[2]*e.worldSize-r)/Math.cos(e._pitch),o=Math.sin(n)*i/Math.sin(Math.max(Math.PI/2-e._pitch-n,.01));let a=Math.sin(e._pitch)*o+i;const s=i*(1/e._horizonShift);return e.elevation&&0!==e.elevation.exaggeration()||(a*=1+Math.max(e.zoom-17,0)),Math.min(1.01*a,s)}function vf(e,t){if(!t.isReprojectedInTileSpace)return{scale:1<<e.z,x:e.x,y:e.y,x2:e.x+1,y2:e.y+1,projection:t};const n=Math.pow(2,-e.z),r=e.x*n,i=(e.x+1)*n,o=e.y*n,a=(e.y+1)*n,s=dl(r),l=dl(i),c=pl(o),u=pl(a),h=t.project(s,c),d=t.project(l,c),p=t.project(l,u),f=t.project(s,u);let m=Math.min(h.x,d.x,p.x,f.x),g=Math.min(h.y,d.y,p.y,f.y),y=Math.max(h.x,d.x,p.x,f.x),_=Math.max(h.y,d.y,p.y,f.y);const v=n/16;function x(e,n,r,i,o,a){const s=(r+o)/2,l=(i+a)/2,c=t.project(dl(s),pl(l)),u=Math.max(0,m-c.x,g-c.y,c.x-y,c.y-_);m=Math.min(m,c.x),y=Math.max(y,c.x),g=Math.min(g,c.y),_=Math.max(_,c.y),u>v&&(x(e,c,r,i,s,l),x(c,n,s,l,o,a))}x(h,d,r,o,i,o),x(d,p,i,o,i,a),x(p,f,i,a,r,a),x(f,h,r,a,r,o),m-=v,g-=v,y+=v,_+=v;const b=1/Math.max(y-m,_-g);return{scale:b,x:m*b,y:g*b,x2:y*b,y2:_*b,projection:t}}function xf(e,t){let{x:n,y:r}=t;return new H(((n-(arguments.length>2&&void 0!==arguments[2]?arguments[2]:0))*e.scale-e.x)*Jn,(r*e.scale-e.y)*Jn)}const bf=B.mat4.identity(new Float32Array(16));class wf{constructor(e){this.spec=e,this.name=e.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(e,t){return{x:0,y:0,z:0}}unproject(e,t){return new il(0,0)}projectTilePoint(e,t,n){return{x:e,y:t,z:0}}locationPoint(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return e._coordinatePoint(e.locationCoordinate(t),n)}pixelsPerMeter(e,t){return hl(1,e)*t}pixelSpaceConversion(e,t,n){return 1}farthestPixelDistance(e){return _f(e,e.pixelsPerMeter)}pointCoordinate(e,t,n,r){const i=e.horizonLineFromTop(!1),o=new H(t,Math.max(i,n));return e.rayIntersectionCoordinate(e.pointRayIntersection(o,r))}pointCoordinate3D(e,t,n){const r=new H(t,n);if(e.elevation)return e.elevation.pointCoordinate(r);{const t=this.pointCoordinate(e,r.x,r.y,0);return[t.x,t.y,t.z]}}isPointAboveHorizon(e,t){if(e.elevation&&e.elevation.visibleDemTiles.length)return!this.pointCoordinate3D(e,t.x,t.y);const n=e.horizonLineFromTop();return t.y<n}createInversionMatrix(e,t){return bf}createTileMatrix(e,t,n){let r,i,o;const a=n.canonical,s=B.mat4.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){const l=vf(a,this);r=1,i=l.x+n.wrap*l.scale,o=l.y,B.mat4.scale(s,s,[r/l.scale,r/l.scale,e.pixelsPerMeter/t])}else r=t/e.zoomScale(a.z),i=(a.x+Math.pow(2,a.z)*n.wrap)*r,o=a.y*r;return B.mat4.translate(s,s,[i,o,0]),B.mat4.scale(s,s,[r/Jn,r/Jn,1]),s}upVector(e,t,n){return[0,0,1]}upVectorScale(e,t,n){return{metersToTile:1}}}class Sf extends wf{constructor(e){super(e),this.range=[4,7],this.center=e.center||[-96,37.5];const[t,n]=this.parallels=e.parallels||[29.5,45.5],r=Math.sin(X(t));this.n=(r+Math.sin(X(n)))/2,this.c=1+r*(2*this.n-r),this.r0=Math.sqrt(this.c)/this.n}project(e,t){const{n:n,c:r,r0:i}=this,o=X(e-this.center[0]),a=X(t),s=Math.sqrt(r-2*n*Math.sin(a))/n;return{x:s*Math.sin(o*n),y:s*Math.cos(o*n)-i,z:0}}unproject(e,t){const{n:n,c:r,r0:i}=this,o=i+t;let a=Math.atan2(e,Math.abs(o))*Math.sign(o);o*n<0&&(a-=Math.PI*Math.sign(e)*Math.sign(o));const s=X(this.center[0])*n;a=ne(a,-Math.PI-s,Math.PI-s);const l=ee(Y(a/n)+this.center[0],-180,180),c=Math.asin(ee((r-(e*e+o*o)*n*n)/(2*n),-1,1)),u=ee(Y(c),-ml,ml);return new il(l,u)}}const Tf=1.340264,Ef=-.081106,Af=893e-6,Mf=.003796,Pf=Math.sqrt(3)/2;class kf extends wf{project(e,t){t=t/180*Math.PI,e=e/180*Math.PI;const n=Math.asin(Pf*Math.sin(t)),r=n*n,i=r*r*r;return{x:.5*(e*Math.cos(n)/(Pf*(Tf+3*Ef*r+i*(7*Af+9*Mf*r)))/Math.PI+.5),y:1-.5*(n*(Tf+Ef*r+i*(Af+Mf*r))/Math.PI+1),z:0}}unproject(e,t){e=(2*e-.5)*Math.PI;let n=t=(2*(1-t)-1)*Math.PI,r=n*n,i=r*r*r;for(let c,u,h,d=0;d<12&&(u=n*(Tf+Ef*r+i*(Af+Mf*r))-t,h=Tf+3*Ef*r+i*(7*Af+9*Mf*r),c=u/h,n=ee(n-c,-Math.PI/3,Math.PI/3),r=n*n,i=r*r*r,!(Math.abs(c)<1e-12));++d);const o=Pf*e*(Tf+3*Ef*r+i*(7*Af+9*Mf*r))/Math.cos(n),a=Math.asin(Math.sin(n)/Pf),s=ee(180*o/Math.PI,-180,180),l=ee(180*a/Math.PI,-ml,ml);return new il(s,l)}}class Cf extends wf{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0}project(e,t){return{x:.5+e/360,y:.5-t/360,z:0}}unproject(e,t){const n=360*(e-.5),r=ee(360*(.5-t),-ml,ml);return new il(n,r)}}const jf=Math.PI/2;function If(e){return Math.tan((jf+e)/2)}class Of extends wf{constructor(e){super(e),this.center=e.center||[0,30];const[t,n]=this.parallels=e.parallels||[30,30];let r=X(t),i=X(n);this.southernCenter=r+i<0,this.southernCenter&&(r=-r,i=-i);const o=Math.cos(r),a=If(r);this.n=r===i?Math.sin(r):Math.log(o/Math.cos(i))/Math.log(If(i)/a),this.f=o*Math.pow(If(r),this.n)/this.n}project(e,t){t=X(t),this.southernCenter&&(t=-t),e=X(e-this.center[0]);const n=1e-6,{n:r,f:i}=this;i>0?t<-jf+n&&(t=-jf+n):t>jf-n&&(t=jf-n);const o=i/Math.pow(If(t),r);let a=o*Math.sin(r*e),s=i-o*Math.cos(r*e);return a=.5*(a/Math.PI+.5),s=.5*(s/Math.PI+.5),{x:a,y:this.southernCenter?s:1-s,z:0}}unproject(e,t){e=(2*e-.5)*Math.PI,this.southernCenter&&(t=1-t),t=(2*(1-t)-.5)*Math.PI;const{n:n,f:r}=this,i=r-t,o=Math.sign(i),a=Math.sign(n)*Math.sqrt(e*e+i*i);let s=Math.atan2(e,Math.abs(i))*o;i*n<0&&(s-=Math.PI*Math.sign(e)*o);const l=ee(Y(s/n)+this.center[0],-180,180),c=ee(Y(2*Math.atan(Math.pow(r/a,1/n))-jf),-ml,ml);return new il(l,this.southernCenter?-c:c)}}class Nf extends wf{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(e,t){return{x:cl(e),y:ul(t),z:0}}unproject(e,t){const n=dl(e),r=pl(t);return new il(n,r)}}const Df=X(ml);class Lf extends wf{project(e,t){const n=(t=X(t))*t,r=n*n;return{x:.5*((e=X(e))*(.8707-.131979*n+r*(r*(.003971*n-.001529*r)-.013791))/Math.PI+.5),y:1-.5*(t*(1.007226+n*(.015085+r*(.028874*n-.044475-.005916*r)))/Math.PI+1),z:0}}unproject(e,t){e=(2*e-.5)*Math.PI;let n=t=(2*(1-t)-1)*Math.PI,r=25,i=0,o=n*n;do{o=n*n;const e=o*o;i=(n*(1.007226+o*(.015085+e*(.028874*o-.044475-.005916*e)))-t)/(1.007226+o*(.045255+e*(.259866*o-.311325-.005916*11*e))),n=ee(n-i,-Df,Df)}while(Math.abs(i)>1e-6&&--r>0);o=n*n;const a=ee(Y(e/(.8707+o*(o*(o*o*o*(.003971-.001529*o)-.013791)-.131979))),-180,180),s=Y(n);return new il(a,s)}}const zf=X(ml);class Rf extends wf{project(e,t){t=X(t),e=X(e);const n=Math.cos(t),r=2/Math.PI,i=Math.acos(n*Math.cos(e/2)),o=Math.sin(i)/i,a=.5*(e*r+2*n*Math.sin(e/2)/o)||0,s=.5*(t+Math.sin(t)/o)||0;return{x:.5*(a/Math.PI+.5),y:1-.5*(s/Math.PI+1),z:0}}unproject(e,t){let n=e=(2*e-.5)*Math.PI,r=t=(2*(1-t)-1)*Math.PI,i=25;const o=1e-6;let a=0,s=0;do{const i=Math.cos(r),o=Math.sin(r),l=2*o*i,c=o*o,u=i*i,h=Math.cos(n/2),d=Math.sin(n/2),p=2*h*d,f=d*d,m=1-u*h*h,g=m?1/m:0,y=m?Math.acos(i*h)*Math.sqrt(1/m):0,_=.5*(2*y*i*d+2*n/Math.PI)-e,v=.5*(y*o+r)-t,x=.5*g*(u*f+y*i*h*c)+1/Math.PI,b=g*(p*l/4-y*o*d),w=.125*g*(l*d-y*o*u*p),S=.5*g*(c*h+y*f*i)+.5,T=b*w-S*x;a=(v*b-_*S)/T,s=(_*w-v*x)/T,n=ee(n-a,-Math.PI,Math.PI),r=ee(r-s,-zf,zf)}while((Math.abs(a)>o||Math.abs(s)>o)&&--i>0);return new il(Y(n),Y(r))}}class Ff extends wf{constructor(e){super(e),this.center=e.center||[0,0],this.parallels=e.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(X(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(e,t){const{scale:n,cosPhi:r}=this;return{x:X(e)*r*n+.5,y:-Math.sin(X(t))/r*n+.5,z:0}}unproject(e,t){const{scale:n,cosPhi:r}=this,i=-(t-.5)/n,o=ee(Y((e-.5)/n)/r,-180,180),a=Math.asin(ee(i*r,-1,1)),s=ee(Y(a),-ml,ml);return new il(o,s)}}class Bf extends Nf{constructor(e){super(e),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(e,t,n){const r=Cc(e,t,n),i=Oc(Tc(n));return B.vec3.transformMat4(r,r,i),{x:r[0],y:r[1],z:r[2]}}locationPoint(e,t){const n=tl(t.lat,t.lng),r=B.vec3.normalize([],n),i=e.elevation?e.elevation.getAtPointOrZero(e.locationCoordinate(t),e._centerAltitude):e._centerAltitude,o=hl(1,0)*Jn*i;B.vec3.scaleAndAdd(n,n,r,o);const a=B.mat4.identity(new Float64Array(16));return B.mat4.multiply(a,e.pixelMatrix,e.globeMatrix),B.vec3.transformMat4(n,n,a),new H(n[0],n[1])}pixelsPerMeter(e,t){return hl(1,0)*t}pixelSpaceConversion(e,t,n){const r=hl(1,e)*t,i=kt(hl(1,45)*t,r,n);return this.pixelsPerMeter(e,t)/i}createTileMatrix(e,t,n){const r=Nc(Tc(n.canonical));return B.mat4.multiply(new Float64Array(16),e.globeMatrix,r)}createInversionMatrix(e,t){const{center:n}=e,r=Oc(Tc(t));return B.mat4.rotateY(r,r,X(n.lng)),B.mat4.rotateX(r,r,X(n.lat)),B.mat4.scale(r,r,[e._pixelsPerMercatorPixel,e._pixelsPerMercatorPixel,1]),Float32Array.from(r)}pointCoordinate(e,t,n,r){return bc(e,t,n,!0)||new xl(0,0)}pointCoordinate3D(e,t,n){const r=this.pointCoordinate(e,t,n,0);return[r.x,r.y,r.z]}isPointAboveHorizon(e,t){return!bc(e,t.x,t.y,!1)}farthestPixelDistance(e){const t=function(e,t){const n=e.cameraToCenterDistance,r=e._centerAltitude*t,i=e._camera,o=e._camera.forward(),a=B.vec3.add([],B.vec3.scale([],o,-n),[0,0,r]),s=e.worldSize/(2*Math.PI),l=[0,0,-s],c=e.width/e.height,u=Math.tan(e.fovAboveCenter),h=B.vec3.scale([],i.up(),u),d=B.vec3.scale([],i.right(),u*c),p=B.vec3.normalize([],B.vec3.add([],B.vec3.add([],o,h),d)),f=[];let m;if(new hc(a,p).closestPointOnSphere(l,s,f)){const t=B.vec3.add([],f,l),n=B.vec3.sub([],t,a);m=Math.cos(e.fovAboveCenter)*B.vec3.length(n)}else{const e=B.vec3.sub([],a,l),t=B.vec3.sub([],l,a);B.vec3.normalize(t,t);const n=B.vec3.length(e)-s;m=Math.sqrt(n*(n+2*s));const r=Math.acos(m/(s+n))-Math.acos(B.vec3.dot(o,t));m*=Math.cos(r)}return 1.01*m}(e,this.pixelsPerMeter(e.center.lat,e.worldSize)),n=Rc(e.zoom);if(n>0){const r=_f(e,hl(1,e.center.lat)*e.worldSize),i=e.worldSize/(2*Math.PI),o=Math.max(e.width,e.height)/e.worldSize*Math.PI;return kt(t,r+i*(1-Math.cos(o)),Math.pow(n,10))}return t}upVector(e,t,n){return Cc(t,n,e,1)}upVectorScale(e){return{metersToTile:vc(jc(Tc(e)))}}}function Vf(e){const t=e.parallels,n=!!t&&Math.abs(t[0]+t[1])<.01;switch(e.name){case"mercator":return new Nf(e);case"equirectangular":return new Cf(e);case"naturalEarth":return new Lf(e);case"equalEarth":return new kf(e);case"winkelTripel":return new Rf(e);case"albers":return n?new Ff(e):new Sf(e);case"lambertConformalConic":return n?new Ff(e):new Of(e);case"globe":return new Bf(e)}throw new Error("Invalid projection name: ".concat(e.name))}const Uf=dh.VectorTileFeature.types,Gf=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Hf(e,t,n,r,i,o,a,s,l,c,u,h,d){const p=s?Math.min(df,Math.round(s[0])):0,f=s?Math.min(df,Math.round(s[1])):0;e.emplaceBack(t,n,Math.round(32*r),Math.round(32*i),o,a,(p<<1)+(l?1:0),f,16*c,16*u,256*h,256*d)}function Zf(e,t,n){e.emplaceBack(t,n)}function qf(e,t,n,r,i,o,a){e.emplaceBack(t,n,r,i,o,a)}function Wf(e,t,n,r,i){e.emplaceBack(t,n,r,i),e.emplaceBack(t,n,r,i),e.emplaceBack(t,n,r,i),e.emplaceBack(t,n,r,i)}function Xf(e){for(const t of e.sections)if(bo(t.text))return!0;return!1}class Yf{constructor(e){this.layoutVertexArray=new ka,this.indexArray=new za,this.programConfigurations=e,this.segments=new ps,this.dynamicLayoutVertexArray=new Ta,this.opacityVertexArray=new ja,this.placedSymbolArray=new ts,this.iconTransitioningVertexArray=new Ia,this.globeExtVertexArray=new Ca,this.zOffsetVertexArray=new Ba}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length&&0===this.iconTransitioningVertexArray.length}upload(e,t,n,r,i){this.isEmpty()||(n&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Rd.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,Bd.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,Gf,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=e.createVertexBuffer(this.iconTransitioningVertexArray,Ud.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,Fd.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||i)&&(this.zOffsetVertexBuffer=e.createVertexBuffer(this.zOffsetVertexArray,Vd.members,!0)),this.opacityVertexBuffer.itemSize=1),(n||r)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}so(Yf,"SymbolBuffers");class Kf{constructor(e,t,n){this.layoutVertexArray=new e,this.layoutAttributes=t,this.indexArray=new n,this.segments=new ps,this.collisionVertexArray=new La,this.collisionVertexArrayExt=new Ta}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,Gd.members,!0),this.collisionVertexBufferExt=e.createVertexBuffer(this.collisionVertexArrayExt,Hd.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}so(Kf,"CollisionBuffers");class Jf{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.lut=e.lut,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((e=>e.fqid)),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=B.mat4.identity([]),this.placementViewportMatrix=B.mat4.identity([]);const t=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Yd(this.zoom,t["text-size"]),this.iconSizeData=Yd(this.zoom,t["icon-size"]);const n=this.layers[0].layout,r=n.get("symbol-sort-key"),i=n.get("symbol-z-order");this.canOverlap=n.get("text-allow-overlap")||n.get("icon-allow-overlap")||n.get("text-ignore-placement")||n.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==i&&void 0!==r.constantOr(1),this.sortFeaturesByY=("viewport-y"===i||"auto"===i&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=n.get("text-writing-mode").map((e=>mp[e])),this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id)),this.sourceID=e.sourceID,this.projection=e.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=n.get("symbol-z-elevate"),this.activeReplacements=[],this.replacementUpdateTime=0}createArrays(){this.text=new Yf(new Bs(this.layers,{zoom:this.zoom,lut:this.lut},(e=>e.startsWith("text")||e.startsWith("symbol")))),this.icon=new Yf(new Bs(this.layers,{zoom:this.zoom,lut:this.lut},(e=>e.startsWith("icon")||e.startsWith("symbol")))),this.glyphOffsetArray=new is,this.lineVertexArray=new os,this.symbolInstances=new rs}calculateGlyphDependencies(e,t,n,r,i){for(const o of e){const e=o.codePointAt(0);if(void 0===e)break;if(t[e]=!0,r&&i&&e<=65535){const e=ep[o];e&&(t[e.charCodeAt(0)]=!0)}}}updateFootprints(e,t){}updateReplacement(e,t){if(t.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=t.updateTime;const n=t.getReplacementRegionsForTile(e.toUnwrapped(),!0);return!Sh(this.activeReplacements,n)&&(this.activeReplacements=n,!0)}populate(e,t,n,r){const i=this.layers[0],o=i.layout,a="globe"===this.projection.name,s=o.get("text-font"),l=o.get("text-field"),c=o.get("icon-image"),u=("constant"!==l.value.kind||l.value.value instanceof $t&&!l.value.value.isEmpty()||l.value.value.toString().length>0)&&("constant"!==s.value.kind||s.value.value.length>0),h="constant"!==c.value.kind||!!c.value.value||Object.keys(c.parameters).length>0,d=o.get("symbol-sort-key");if(this.features=[],!u&&!h)return;const p=t.iconDependencies,f=t.glyphDependencies,m=t.availableImages,g=new No(this.zoom);for(const{feature:y,id:_,index:v,sourceLayerIndex:x}of e){const e=i._featureFilter.needGeometry,t=kl(y,e);if(!i._featureFilter.filter(g,t,n))continue;if(e||(t.geometry=Pl(y,n,r)),a&&1!==y.type&&n.z<=5){const e=t.geometry,r=.98078528056,i=(e,t)=>{const i=Cc(e.x,e.y,n,1),o=Cc(t.x,t.y,n,1);return B.vec3.dot(i,o)<r};for(let t=0;t<e.length;t++)e[t]=Tl(e[t],i)}let l,c;if(u){const e=i.getValueAndResolveTokens("text-field",t,n,m),r=$t.factory(e);Xf(r)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===jo()||this.hasRTLText&&Oo.isParsed())&&(l=$d(r,i,t))}if(h){const e=i.getValueAndResolveTokens("icon-image",t,n,m);c=e instanceof en?e:en.fromString(e)}if(!l&&!c)continue;const b=this.sortFeaturesByKey?d.evaluate(t,{},n):void 0;if(this.features.push({id:_,text:l,icon:c,index:v,sourceLayerIndex:x,geometry:t.geometry,properties:y.properties,type:Uf[y.type],sortKey:b}),c&&(p[c.namePrimary]=!0,c.nameSecondary&&(p[c.nameSecondary]=!0)),l){const e=s.evaluate(t,{},n).join(","),r="map"===o.get("text-rotation-alignment")&&"point"!==o.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(mp.vertical)>=0;for(const t of l.sections)if(t.image)p[t.image.namePrimary]=!0;else{const n=fo(l.toString()),i=t.fontStack||e,o=f[i]=f[i]||{};this.calculateGlyphDependencies(t.text,o,r,this.allowVerticalPlacement,n)}}}"line"===o.get("symbol-placement")&&(this.features=function(e){const t={},n={},r=[];let i=0;function o(t){r.push(e[t]),i++}function a(e,t,i){const o=n[e];return delete n[e],n[t]=o,r[o].geometry[0].pop(),r[o].geometry[0]=r[o].geometry[0].concat(i[0]),o}function s(e,n,i){const o=t[n];return delete t[n],t[e]=o,r[o].geometry[0].shift(),r[o].geometry[0]=i[0].concat(r[o].geometry[0]),o}function l(e,t,n){const r=n?t[0][t[0].length-1]:t[0][0];return"".concat(e,":").concat(r.x,":").concat(r.y)}for(let c=0;c<e.length;c++){const u=e[c],h=u.geometry,d=u.text?u.text.toString():null;if(!d){o(c);continue}const p=l(d,h),f=l(d,h,!0);if(p in n&&f in t&&n[p]!==t[f]){const e=s(p,f,h),i=a(p,f,r[e].geometry);delete t[p],delete n[f],n[l(d,r[i].geometry,!0)]=i,r[e].geometry=null}else p in n?a(p,f,h):f in t?s(p,f,h):(o(c),t[p]=i-1,n[f]=i-1)}return r.filter((e=>e.geometry))}(this.features)),this.sortFeaturesByKey&&this.features.sort(((e,t)=>e.sortKey-t.sortKey))}update(e,t,n,r,i){const o=0!==Object.keys(e).length;if(o&&!this.stateDependentLayers.length)return;const a=o?this.stateDependentLayers:this.layers;this.text.programConfigurations.updatePaintArrays(e,t,a,n,r,i),this.icon.programConfigurations.updatePaintArrays(e,t,a,n,r,i)}updateZOffset(){const e=(e,t,r)=>{n+=t,n>e.length&&e.resize(n);for(let i=-t;i<0;i++)e.emplace(i+n,r)},t=(e,t,n)=>{r+=t,r>e.length&&e.resize(r);for(let i=-t;i<0;i++)e.emplace(i+r,n)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let n=0,r=0;for(let i=0;i<this.symbolInstances.length;i++){const n=this.symbolInstances.get(i),{numHorizontalGlyphVertices:r,numVerticalGlyphVertices:o,numIconVertices:a}=n,s=n.zOffset,l=a>0;if((r>0||o>0)&&(e(this.text.zOffsetVertexArray,r,s),e(this.text.zOffsetVertexArray,o,s)),l){const{placedIconSymbolIndex:e,verticalPlacedIconSymbolIndex:r}=n;e>=0&&t(this.icon.zOffsetVertexArray,a,s),r>=0&&t(this.icon.zOffsetVertexArray,n.numVerticalIconVertices,s)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=Vf(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,t){const n=this.lineVertexArray.length;if(void 0!==e.segment)for(const{x:r,y:i}of t)this.lineVertexArray.emplaceBack(r,i);return{lineStartIndex:n,lineLength:this.lineVertexArray.length-n}}addSymbols(e,t,n,r,i,o,a,s,l,c,u,h,d,p,f,m){const g=e.indexArray,y=e.layoutVertexArray,_=e.globeExtVertexArray,v=e.segments.prepareSegment(4*t.length,y,g,this.canOverlap?o.sortKey:void 0),x=this.glyphOffsetArray.length,b=v.vertexLength,w=this.allowVerticalPlacement&&a===mp.vertical?Math.PI/2:0,S=o.text&&o.text.sections;for(let E=0;E<t.length;E++){const{tl:r,tr:i,bl:a,br:c,texPrimary:u,texSecondary:h,pixelOffsetTL:x,pixelOffsetBR:b,minFontScaleX:T,minFontScaleY:A,glyphOffset:M,isSDF:P,sectionIndex:k}=t[E],C=v.vertexLength,j=M[1];if(Hf(y,l.x,l.y,r.x,j+r.y,u.x,u.y,n,P,x.x,x.y,T,A),Hf(y,l.x,l.y,i.x,j+i.y,u.x+u.w,u.y,n,P,b.x,x.y,T,A),Hf(y,l.x,l.y,a.x,j+a.y,u.x,u.y+u.h,n,P,x.x,b.y,T,A),Hf(y,l.x,l.y,c.x,j+c.y,u.x+u.w,u.y+u.h,n,P,b.x,b.y,T,A),s){const{x:t,y:n,z:r}=s.anchor,[i,o,a]=s.up;qf(_,t,n,r,i,o,a),qf(_,t,n,r,i,o,a),qf(_,t,n,r,i,o,a),qf(_,t,n,r,i,o,a),Wf(e.dynamicLayoutVertexArray,t,n,r,w)}else Wf(e.dynamicLayoutVertexArray,l.x,l.y,l.z,w);if(m){const t=h||u;Zf(e.iconTransitioningVertexArray,t.x,t.y),Zf(e.iconTransitioningVertexArray,t.x+t.w,t.y),Zf(e.iconTransitioningVertexArray,t.x,t.y+t.h),Zf(e.iconTransitioningVertexArray,t.x+t.w,t.y+t.h)}g.emplaceBack(C,C+1,C+2),g.emplaceBack(C+1,C+2,C+3),v.vertexLength+=4,v.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(M[0]),E!==t.length-1&&k===t[E+1].sectionIndex||e.programConfigurations.populatePaintArrays(y.length,o,o.index,{},d,p,f,S&&S[k])}const T=s?s.anchor:l;e.placedSymbolArray.emplaceBack(T.x,T.y,T.z,l.x,l.y,x,this.glyphOffsetArray.length-x,b,c,u,l.segment,n?n[0]:0,n?n[1]:0,r[0],r[1],a,0,!1,0,h,0)}_commitLayoutVertex(e,t,n,r,i,o,a){e.emplaceBack(t,n,r,i,o,Math.round(a.x),Math.round(a.y))}_addCollisionDebugVertices(e,t,n,r,i,o,a){const s=n.segments.prepareSegment(4,n.layoutVertexArray,n.indexArray),l=s.vertexLength,c=a.tileAnchorX,u=a.tileAnchorY;for(let d=0;d<4;d++)n.collisionVertexArray.emplaceBack(0,0,0,0,0,0);this._commitDebugCollisionVertexUpdate(n.collisionVertexArrayExt,t,e.padding,a.zOffset),this._commitLayoutVertex(n.layoutVertexArray,r,i,o,c,u,new H(e.x1,e.y1)),this._commitLayoutVertex(n.layoutVertexArray,r,i,o,c,u,new H(e.x2,e.y1)),this._commitLayoutVertex(n.layoutVertexArray,r,i,o,c,u,new H(e.x2,e.y2)),this._commitLayoutVertex(n.layoutVertexArray,r,i,o,c,u,new H(e.x1,e.y2)),s.vertexLength+=4;const h=n.indexArray;h.emplaceBack(l,l+1),h.emplaceBack(l+1,l+2),h.emplaceBack(l+2,l+3),h.emplaceBack(l+3,l),s.primitiveLength+=4}_addTextDebugCollisionBoxes(e,t,n,r,i,o){for(let a=r;a<i;a++){const r=n.get(a),i=this.getSymbolInstanceTextSize(e,o,t,a);this._addCollisionDebugVertices(r,i,this.textCollisionBox,r.projectedAnchorX,r.projectedAnchorY,r.projectedAnchorZ,o)}}_addIconDebugCollisionBoxes(e,t,n,r,i,o){for(let a=r;a<i;a++){const r=n.get(a),i=this.getSymbolInstanceIconSize(e,t,o.placedIconSymbolIndex);this._addCollisionDebugVertices(r,i,this.iconCollisionBox,r.projectedAnchorX,r.projectedAnchorY,r.projectedAnchorZ,o)}}generateCollisionDebugBuffers(e,t,n){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Kf(Na,Zd.members,Ia),this.iconCollisionBox=new Kf(Na,Zd.members,Ia);const r=Jd(this.iconSizeData,e),i=Jd(this.textSizeData,e,n);for(let o=0;o<this.symbolInstances.length;o++){const n=this.symbolInstances.get(o);this._addTextDebugCollisionBoxes(i,e,t,n.textBoxStartIndex,n.textBoxEndIndex,n),this._addTextDebugCollisionBoxes(i,e,t,n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n),this._addIconDebugCollisionBoxes(r,e,t,n.iconBoxStartIndex,n.iconBoxEndIndex,n),this._addIconDebugCollisionBoxes(r,e,t,n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex,n)}}getSymbolInstanceTextSize(e,t,n,r){const i=this.text.placedSymbolArray.get(t.rightJustifiedTextSymbolIndex>=0?t.rightJustifiedTextSymbolIndex:t.centerJustifiedTextSymbolIndex>=0?t.centerJustifiedTextSymbolIndex:t.leftJustifiedTextSymbolIndex>=0?t.leftJustifiedTextSymbolIndex:t.verticalPlacedTextSymbolIndex>=0?t.verticalPlacedTextSymbolIndex:r),o=Kd(this.textSizeData,e,i)/Wd;return this.tilePixelRatio*o}getSymbolInstanceIconSize(e,t,n){const r=this.icon.placedSymbolArray.get(n),i=Kd(this.iconSizeData,e,r);return this.tilePixelRatio*i}_commitDebugCollisionVertexUpdate(e,t,n,r){e.emplaceBack(t,-n,-n,r),e.emplaceBack(t,n,-n,r),e.emplaceBack(t,n,n,r),e.emplaceBack(t,-n,n,r)}_updateTextDebugCollisionBoxes(e,t,n,r,i,o,a){for(let s=r;s<i;s++){const r=n.get(s),i=this.getSymbolInstanceTextSize(e,o,t,s);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,i,r.padding,o.zOffset)}}_updateIconDebugCollisionBoxes(e,t,n,r,i,o,a){for(let s=r;s<i;s++){const r=n.get(s),i=this.getSymbolInstanceIconSize(e,t,o.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,i,r.padding,o.zOffset)}}updateCollisionDebugBuffers(e,t,n,r){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const i=Jd(this.iconSizeData,e,r),o=Jd(this.textSizeData,e,n);for(let a=0;a<this.symbolInstances.length;a++){const s=this.symbolInstances.get(a);this._updateTextDebugCollisionBoxes(o,e,t,s.textBoxStartIndex,s.textBoxEndIndex,s,n),this._updateTextDebugCollisionBoxes(o,e,t,s.verticalTextBoxStartIndex,s.verticalTextBoxEndIndex,s,n),this._updateIconDebugCollisionBoxes(i,e,t,s.iconBoxStartIndex,s.iconBoxEndIndex,s,r),this._updateIconDebugCollisionBoxes(i,e,t,s.verticalIconBoxStartIndex,s.verticalIconBoxEndIndex,s,r)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(e,t,n,r,i,o,a,s,l){const c={};if(t<n){const{x1:n,y1:r,x2:i,y2:o,padding:a,projectedAnchorX:s,projectedAnchorY:l,projectedAnchorZ:u,tileAnchorX:h,tileAnchorY:d,featureIndex:p}=e.get(t);c.textBox={x1:n,y1:r,x2:i,y2:o,padding:a,projectedAnchorX:s,projectedAnchorY:l,projectedAnchorZ:u,tileAnchorX:h,tileAnchorY:d},c.textFeatureIndex=p}if(r<i){const{x1:t,y1:n,x2:i,y2:o,padding:a,projectedAnchorX:s,projectedAnchorY:l,projectedAnchorZ:u,tileAnchorX:h,tileAnchorY:d,featureIndex:p}=e.get(r);c.verticalTextBox={x1:t,y1:n,x2:i,y2:o,padding:a,projectedAnchorX:s,projectedAnchorY:l,projectedAnchorZ:u,tileAnchorX:h,tileAnchorY:d},c.verticalTextFeatureIndex=p}if(o<a){const{x1:t,y1:n,x2:r,y2:i,padding:a,projectedAnchorX:s,projectedAnchorY:l,projectedAnchorZ:u,tileAnchorX:h,tileAnchorY:d,featureIndex:p}=e.get(o);c.iconBox={x1:t,y1:n,x2:r,y2:i,padding:a,projectedAnchorX:s,projectedAnchorY:l,projectedAnchorZ:u,tileAnchorX:h,tileAnchorY:d},c.iconFeatureIndex=p}if(s<l){const{x1:t,y1:n,x2:r,y2:i,padding:o,projectedAnchorX:a,projectedAnchorY:l,projectedAnchorZ:u,tileAnchorX:h,tileAnchorY:d,featureIndex:p}=e.get(s);c.verticalIconBox={x1:t,y1:n,x2:r,y2:i,padding:o,projectedAnchorX:a,projectedAnchorY:l,projectedAnchorZ:u,tileAnchorX:h,tileAnchorY:d},c.verticalIconFeatureIndex=p}return c}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let t=0;t<this.symbolInstances.length;t++){const n=this.symbolInstances.get(t);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,n.textBoxStartIndex,n.textBoxEndIndex,n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n.iconBoxStartIndex,n.iconBoxEndIndex,n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(e,t){const n=e.placedSymbolArray.get(t),r=n.vertexStartIndex+4*n.numGlyphs;for(let i=n.vertexStartIndex;i<r;i+=4)e.indexArray.emplaceBack(i,i+1,i+2),e.indexArray.emplaceBack(i+1,i+2,i+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const t=Math.sin(e),n=Math.cos(e),r=[],i=[],o=[];for(let a=0;a<this.symbolInstances.length;++a){o.push(a);const e=this.symbolInstances.get(a);r.push(0|Math.round(t*e.tileAnchorX+n*e.tileAnchorY)),i.push(e.featureIndex)}return o.sort(((e,t)=>r[e]-r[t]||i[t]-i[e])),o}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let e=0;e<this.symbolInstances.length;++e)this.symbolInstanceIndexesSortedZOffset.push(e)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort(((e,t)=>this.symbolInstances.get(t).zOffset-this.symbolInstances.get(e).zOffset))}addToSortKeyRanges(e,t){const n=this.sortKeyRanges[this.sortKeyRanges.length-1];n&&n.sortKey===t?n.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const e of this.symbolInstanceIndexes){const t=this.symbolInstances.get(e);this.featureSortOrder.push(t.featureIndex);const{rightJustifiedTextSymbolIndex:n,centerJustifiedTextSymbolIndex:r,leftJustifiedTextSymbolIndex:i,verticalPlacedTextSymbolIndex:o,placedIconSymbolIndex:a,verticalPlacedIconSymbolIndex:s}=t;n>=0&&this.addIndicesForPlacedSymbol(this.text,n),r>=0&&r!==n&&this.addIndicesForPlacedSymbol(this.text,r),i>=0&&i!==r&&i!==n&&this.addIndicesForPlacedSymbol(this.text,i),o>=0&&this.addIndicesForPlacedSymbol(this.text,o),a>=0&&this.addIndicesForPlacedSymbol(this.icon,a),s>=0&&this.addIndicesForPlacedSymbol(this.icon,s)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let Qf,$f,em;so(Jf,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),Jf.addDynamicAttributes=Wf;class tm{constructor(e){this.type=e.property.overrides?e.property.overrides.runtimeType:Dt,this.defaultValue=e}evaluate(e){if(e.formattedSection){const t=this.defaultValue.property.overrides;if(t&&t.hasOverride(e.formattedSection))return t.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}so(tm,"FormatSectionOverride",{omit:["defaultValue"]});const nm=()=>em||(em={layout:Qf||(Qf=new qo({"symbol-placement":new Go(Wo.layout_symbol["symbol-placement"]),"symbol-spacing":new Go(Wo.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Go(Wo.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Ho(Wo.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Go(Wo.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new Go(Wo.layout_symbol["symbol-z-elevate"]),"symbol-elevation-reference":new Go(Wo.layout_symbol["symbol-elevation-reference"]),"icon-allow-overlap":new Go(Wo.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Go(Wo.layout_symbol["icon-ignore-placement"]),"icon-optional":new Go(Wo.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Go(Wo.layout_symbol["icon-rotation-alignment"]),"icon-size":new Ho(Wo.layout_symbol["icon-size"]),"icon-size-scale-range":new Go(Wo.layout_symbol["icon-size-scale-range"]),"icon-text-fit":new Ho(Wo.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Ho(Wo.layout_symbol["icon-text-fit-padding"]),"icon-image":new Ho(Wo.layout_symbol["icon-image"]),"icon-rotate":new Ho(Wo.layout_symbol["icon-rotate"]),"icon-padding":new Go(Wo.layout_symbol["icon-padding"]),"icon-keep-upright":new Go(Wo.layout_symbol["icon-keep-upright"]),"icon-offset":new Ho(Wo.layout_symbol["icon-offset"]),"icon-anchor":new Ho(Wo.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Go(Wo.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Go(Wo.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Go(Wo.layout_symbol["text-rotation-alignment"]),"text-field":new Ho(Wo.layout_symbol["text-field"]),"text-font":new Ho(Wo.layout_symbol["text-font"]),"text-size":new Ho(Wo.layout_symbol["text-size"]),"text-size-scale-range":new Go(Wo.layout_symbol["text-size-scale-range"]),"text-max-width":new Ho(Wo.layout_symbol["text-max-width"]),"text-line-height":new Ho(Wo.layout_symbol["text-line-height"]),"text-letter-spacing":new Ho(Wo.layout_symbol["text-letter-spacing"]),"text-justify":new Ho(Wo.layout_symbol["text-justify"]),"text-radial-offset":new Ho(Wo.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Go(Wo.layout_symbol["text-variable-anchor"]),"text-anchor":new Ho(Wo.layout_symbol["text-anchor"]),"text-max-angle":new Go(Wo.layout_symbol["text-max-angle"]),"text-writing-mode":new Go(Wo.layout_symbol["text-writing-mode"]),"text-rotate":new Ho(Wo.layout_symbol["text-rotate"]),"text-padding":new Go(Wo.layout_symbol["text-padding"]),"text-keep-upright":new Go(Wo.layout_symbol["text-keep-upright"]),"text-transform":new Ho(Wo.layout_symbol["text-transform"]),"text-offset":new Ho(Wo.layout_symbol["text-offset"]),"text-allow-overlap":new Go(Wo.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Go(Wo.layout_symbol["text-ignore-placement"]),"text-optional":new Go(Wo.layout_symbol["text-optional"]),visibility:new Go(Wo.layout_symbol.visibility)})),paint:$f||($f=new qo({"icon-opacity":new Ho(Wo.paint_symbol["icon-opacity"]),"icon-occlusion-opacity":new Ho(Wo.paint_symbol["icon-occlusion-opacity"]),"icon-emissive-strength":new Ho(Wo.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new Ho(Wo.paint_symbol["text-emissive-strength"]),"icon-color":new Ho(Wo.paint_symbol["icon-color"]),"icon-halo-color":new Ho(Wo.paint_symbol["icon-halo-color"]),"icon-halo-width":new Ho(Wo.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Ho(Wo.paint_symbol["icon-halo-blur"]),"icon-translate":new Go(Wo.paint_symbol["icon-translate"]),"icon-translate-anchor":new Go(Wo.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new Ho(Wo.paint_symbol["icon-image-cross-fade"]),"text-opacity":new Ho(Wo.paint_symbol["text-opacity"]),"text-occlusion-opacity":new Ho(Wo.paint_symbol["text-occlusion-opacity"]),"text-color":new Ho(Wo.paint_symbol["text-color"],{runtimeType:Ft,getOverride:e=>e.textColor,hasOverride:e=>!!e.textColor}),"text-halo-color":new Ho(Wo.paint_symbol["text-halo-color"]),"text-halo-width":new Ho(Wo.paint_symbol["text-halo-width"]),"text-halo-blur":new Ho(Wo.paint_symbol["text-halo-blur"]),"text-translate":new Go(Wo.paint_symbol["text-translate"]),"text-translate-anchor":new Go(Wo.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new Go(Wo.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new Go(Wo.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new Go(Wo.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new Go(Wo.paint_symbol["icon-color-brightness-max"]),"symbol-z-offset":new Ho(Wo.paint_symbol["symbol-z-offset"])}))},em);class rm extends pa{constructor(e,t,n,r){super(e,nm(),t,n,r),this._colorAdjustmentMatrix=B.mat4.identity([]),this.hasInitialOcclusionOpacityProperties=void 0!==e.paint&&("icon-occlusion-opacity"in e.paint||"text-occlusion-opacity"in e.paint)}recalculate(e,t){super.recalculate(e,t),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const n=this.layout.get("text-writing-mode");if(n){const e=[];for(const t of n)e.indexOf(t)<0&&e.push(t);this.layout._values["text-writing-mode"]=e}else this.layout._values["text-writing-mode"]="point"===this.layout.get("symbol-placement")?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(e,t,n,r){return this._saturation===e&&this._contrast===t&&this._brightnessMin===n&&this._brightnessMax===r||(this._colorAdjustmentMatrix=function(e,t,n,r){e=Ee(e),t=Te(t);const i=B.mat4.create(),o=e/3,a=1-2*o,s=[a,o,o,0,o,a,o,0,o,o,a,0,0,0,0,1],l=.5-.5*t,c=r-n;return B.mat4.multiply(i,[c,0,0,0,0,c,0,0,0,0,c,0,n,n,n,1],[t,0,0,0,0,t,0,0,0,0,t,0,l,l,l,1]),B.mat4.multiply(i,i,s),i}(e,t,n,r),this._saturation=e,this._contrast=t,this._brightnessMin=n,this._brightnessMax=r),this._colorAdjustmentMatrix}getValueAndResolveTokens(e,t,n,r){const i=this.layout.get(e).evaluate(t,{},n,r),o=this._unevaluatedLayout._values[e];return o.isDataDriven()||Yi(o.value)||!i?i:function(e,t){return t.replace(/{([^{}]+)}/g,((t,n)=>n in e?String(e[n]):""))}(t.properties,i)}createBucket(e){return new Jf(e)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const e of nm().paint.overridableProperties){if(!rm.hasPaintOverride(this.layout,e))continue;const t=this.paint.get(e),n=new tm(t),r=new Xi(n,t.property.specification,this.scope,this.options);let i=null;i="constant"===t.value.kind||"source"===t.value.kind?new Ji("source",r):new Qi("composite",r,t.value.zoomStops,t.value._interpolationType),this.paint._values[e]=new Vo(t.property,i,t.parameters)}}_handleOverridablePaintPropertyUpdate(e,t,n){return!(!this.layout||t.isDataDriven()||n.isDataDriven())&&rm.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,t){const n=e.get("text-field"),r=nm().paint.properties[t];let i=!1;const o=e=>{for(const t of e)if(r.overrides&&r.overrides.hasOverride(t))return void(i=!0)};if("constant"===n.value.kind&&n.value.value instanceof $t)o(n.value.value.sections);else if("source"===n.value.kind){const e=t=>{i||(t instanceof an&&rn(t.value)===Gt?o(t.value.sections):t instanceof un?o(t.sections):t.eachChild(e))},t=n.value;t._styleExpression&&e(t._styleExpression.expression)}return i}getProgramIds(){return["symbol"]}getDefaultProgramParams(e,t,n){return{config:new Fs(this,{zoom:t,lut:n}),overrideFog:!1}}}let im,om,am,sm;var lm=ya([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);function cm(e){switch(e){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.RGBA;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.DEPTH_COMPONENT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.DEPTH_STENCIL;case WebGL2RenderingContext.R8:case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.RED}}function um(e){switch(e){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.UNSIGNED_SHORT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.UNSIGNED_INT_24_8;case WebGL2RenderingContext.R8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.FLOAT}}class hm{constructor(e,t,n,r){this.context=e,this.format=n,this.useMipmap=r&&r.useMipmap,this.texture=e.gl.createTexture(),this.update(t,{premultiply:r&&r.premultiply})}update(e,t){const n=e&&e instanceof HTMLVideoElement&&0===e.width?e.videoWidth:e.width,r=e&&e instanceof HTMLVideoElement&&0===e.height?e.videoHeight:e.height,{context:i}=this,{gl:o}=i,{x:a,y:s}=t&&t.position?t.position:{x:0,y:0},l=Math.max(a+n,this.size?this.size[0]:0),c=Math.max(s+r,this.size?this.size[1]:0);!this.size||this.size[0]===l&&this.size[1]===c||(o.bindTexture(o.TEXTURE_2D,null),o.deleteTexture(this.texture),this.texture=o.createTexture(),this.size=null),o.bindTexture(o.TEXTURE_2D,this.texture),i.pixelStoreUnpackFlipY.set(!1),i.pixelStoreUnpack.set(1),i.pixelStoreUnpackPremultiplyAlpha.set(this.format===o.RGBA8&&(!t||!1!==t.premultiply));const u=e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||ImageBitmap&&e instanceof ImageBitmap;if(!this.size&&l>0&&c>0){const e=this.useMipmap?Math.floor(Math.log2(Math.max(l,c)))+1:1;o.texStorage2D(o.TEXTURE_2D,e,this.format,l,c),this.size=[l,c]}if(this.size)if(u)o.texSubImage2D(o.TEXTURE_2D,0,a,s,cm(this.format),um(this.format),e);else{const t=e.data;t&&o.texSubImage2D(o.TEXTURE_2D,0,a,s,n,r,cm(this.format),um(this.format),t)}this.useMipmap&&o.generateMipmap(o.TEXTURE_2D)}bind(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{context:r}=this,{gl:i}=r;i.bindTexture(i.TEXTURE_2D,this.texture),e!==this.minFilter&&(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,e),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,this.useMipmap&&!n?e===i.NEAREST?i.NEAREST_MIPMAP_NEAREST:i.LINEAR_MIPMAP_LINEAR:e),this.minFilter=e),t!==this.wrapS&&(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,t),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,t),this.wrapS=t)}bindExtraParam(e,t,n,r){const{context:i}=this,{gl:o}=i;o.bindTexture(o.TEXTURE_2D,this.texture),t!==this.magFilter&&(o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,t),this.magFilter=t),e!==this.minFilter&&(o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,this.useMipmap?e===o.NEAREST?o.NEAREST_MIPMAP_NEAREST:o.LINEAR_MIPMAP_LINEAR:e),this.minFilter=e),n!==this.wrapS&&(o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,n),this.wrapS=n),r!==this.wrapT&&(o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,r),this.wrapT=r)}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class dm{constructor(e,t){this.context=e,this.texture=t}bind(e,t){const{context:n}=this,{gl:r}=n;r.bindTexture(r.TEXTURE_2D,this.texture),e!==this.minFilter&&(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,e),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,e),this.minFilter=e),t!==this.wrapS&&(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,t),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,t),this.wrapS=t)}}function pm(e,t,n,r,i,o,a,s){const l=[e,t,1,n,r,1,i,o,1],c=[a,s,1],u=B.mat3.adjoint([],l),[h,d,p]=B.vec3.transformMat3(c,c,u);return B.mat3.multiply(l,l,[h,0,0,0,d,0,0,0,p])}function fm(e,t,n,r,i,o,a,s){const l=function(e,t,n,r,i,o,a,s){const l=pm(0,0,1,0,1,1,0,1),c=pm(e,t,n,r,i,o,a,s),u=B.mat3.adjoint([],l);return B.mat3.multiply(c,c,u)}(e,t,n,r,i,o,a,s);return[l[2]/l[8]/Jn,l[5]/l[8]/Jn]}function mm(e){return[e[0],Math.min(Math.max(e[1],-ml),ml)]}class gm extends St{constructor(e,t,n,r){super(),this.id=e,this.dispatcher=n,this.coordinates=t.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(r),this.options=t,this._dirty=!1}load(e,t){if(this._loaded=t||!1,this.fire(new vt("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return e&&(this.coordinates=e),this._loaded=!0,void this._finishLoading();this._imageRequest=ut(this.map._requestManager.transformRequest(this.url,tt.Image),((t,n)=>{this._imageRequest=null,this._loaded=!0,t?this.fire(new xt(t)):n&&(this.image=n instanceof HTMLImageElement?Le.getImageData(n):n,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,e&&(this.coordinates=e),this._finishLoading())}))}loaded(){return this._loaded}updateImage(e){return e.url?(this._imageRequest&&e.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=e.url,this.load(e.coordinates,this._loaded),this):this}setTexture(e){if(!(e.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new dm(this.map.painter.context,e.handle),this.width=e.dimensions[0],this.height=e.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new vt("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(e){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof dm||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(e){if(this.coordinates=e,this._boundsArray=void 0,this._unsupportedCoords=!1,!e.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let t=e[0][1],n=e[0][1];for(const i of e)i[1]>n&&(n=i[1]),i[1]<t&&(t=i[1]);const r=(n+t)/2;if(r>ml?this.onNorthPole=!0:r<-ml&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const t=e.map(xl.fromLngLat);this.tileID=function(e){let t=1/0,n=1/0,r=-1/0,i=-1/0;for(const c of e)t=Math.min(t,c.x),n=Math.min(n,c.y),r=Math.max(r,c.x),i=Math.max(i,c.y);const o=Math.max(r-t,i-n),a=Math.max(0,Math.floor(-Math.log(o)/Math.LN2)),s=Math.pow(2,a);let l=Math.floor((t+r)/2*s);return l>1&&(l-=1),new nc(a,l,Math.floor((n+i)/2*s))}(t),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new vt("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(e){for(const g in this.tiles){const e=this.tiles[g];"loaded"!==e.state&&(e.state="loaded",e.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const t=vf(new nc(0,0,0),this.map.transform.projection),n=[t.projection.project(this.coordinates[0][0],this.coordinates[0][1]),t.projection.project(this.coordinates[1][0],this.coordinates[1][1]),t.projection.project(this.coordinates[2][0],this.coordinates[2][1]),t.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(e){const t=e[1].x-e[0].x,n=e[1].y-e[0].y,r=e[2].x-e[1].x,i=e[2].y-e[1].y,o=e[3].x-e[2].x,a=e[3].y-e[2].y,s=e[0].x-e[3].x,l=e[0].y-e[3].y,c=t*i-r*n,u=r*a-o*i,h=o*l-s*a,d=s*n-t*l;return c>0&&u>0&&h>0&&d>0||c<0&&u<0&&h<0&&d<0}(n))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const r=vf(this.tileID,this.map.transform.projection),[i,o,a,s]=this.coordinates.map((e=>{const t=r.projection.project(e[0],e[1]);return xf(r,t)._round()}));this.perspectiveTransform=fm(i.x,i.y,o.x,o.y,a.x,a.y,s.x,s.y);const l=this._boundsArray=new ba;l.emplaceBack(i.x,i.y,0,0),l.emplaceBack(o.x,o.y,Jn,0),l.emplaceBack(s.x,s.y,0,Jn),l.emplaceBack(a.x,a.y,Jn,Jn),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=e.createVertexBuffer(l,lm.members),this.boundsSegments=ps.simpleSegment(0,0,4,2);const c=[],u=[mm((h=this.coordinates)[0]),mm(h[1]),mm(h[2]),mm(h[3])];var h;const[d,p,f,m]=function(e){let t=e[0][0],n=t,r=e[0][1],i=r;for(let o=1;o<e.length;o++)e[o][0]<t?t=e[o][0]:e[o][0]>n&&(n=e[o][0]),e[o][1]<r?r=e[o][1]:e[o][1]>i&&(i=e[o][1]);return[t,r,n-t,i-r]}(u);{const r=new ba,[i,o,a,s]=function(e){let t=e[0].x,n=t,r=e[0].y,i=r;for(let o=1;o<e.length;o++)e[o].x<t?t=e[o].x:e[o].x>n&&(n=e[o].x),e[o].y<r?r=e[o].y:e[o].y>i&&(i=e[o].y);return[t,r,n-t,i-r]}(n),l=e=>[(e.x-i)/a,(e.y-o)/s],[u,h,g,y]=n.map(l),_=function(e,t,n,r,i,o,a,s){const l=pm(0,0,1,0,1,1,0,1),c=pm(e,t,n,r,i,o,a,s),u=B.mat3.adjoint([],c);return B.mat3.multiply(l,l,u)}(u[0],u[1],h[0],h[1],g[0],g[1],y[0],y[1]);this.elevatedGlobePerspectiveTransform=fm(u[0],u[1],h[0],h[1],g[0],g[1],y[0],y[1]);const v=(e,t)=>{c.push(e.lng);const n=Math.round((e.lng-d)/f*Jn),i=Math.round((e.lat-p)/m*Jn),o=l(t),a=B.vec3.transformMat3([],[o[0],o[1],1],_),s=Math.round(a[0]/a[2]*Jn),u=Math.round(a[1]/a[2]*Jn);r.emplaceBack(n,i,s,u)},x=n[3].x-n[0].x,b=n[3].y-n[0].y,w=n[2].x-n[1].x,S=n[2].y-n[1].y;for(let e=0;e<65;e++){const r=e/64,i=[n[0].x+r*x,n[0].y+r*b],o=[n[1].x+r*w,n[1].y+r*S],a=o[0]-i[0],s=o[1]-i[1];for(let e=0;e<65;e++){const n=e/64,r={x:i[0]+a*n,y:i[1]+s*n,z:0};v(t.projection.unproject(r.x,r.y),r)}}this.elevatedGlobeVertexBuffer=e.createVertexBuffer(r,lm.members)}{this.maxLongitudeTriangleSize=0;let t=[],n=new za;const r=(e,r,i)=>{n.emplaceBack(e,r,i);const o=c[e],a=c[r],s=c[i],l=Math.min(Math.min(o,a),s),u=Math.max(Math.max(o,a),s)-l;u>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=u),t.push(l+u/2)};for(let e=0;e<64;e++)for(let t=0;t<64;t++){const n=65*e+t,i=n+1,o=n+65,a=o+1;r(n,o,i),r(i,o,a)}[t,n]=function(e,t){const n=Array.from({length:e.length},((e,t)=>t));n.sort(((t,n)=>e[t]-e[n]));const r=[],i=new za;for(let o=0;o<n.length;o++){const a=n[o];r.push(e[a]);const s=3*a,l=s+1;i.emplaceBack(t.uint16[s],t.uint16[l],t.uint16[l+1])}return[r,i]}(t,n),this.elevatedGlobeTrianglesCenterLongitudes=t,this.elevatedGlobeIndexBuffer=e.createIndexBuffer(n)}this.elevatedGlobeSegments=ps.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,f/Jn,0,m/Jn,0,0,p,d,0])}prepare(){const e=0!==Object.keys(this.tiles).length;if(this.tileID&&!e)return;const t=this.map.painter.context,n=t.gl;!this._dirty||this.texture instanceof dm||(this.texture?this.texture.update(this.image):(this.texture=new hm(t,this.image,n.RGBA8),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE)),this._dirty=!1),e&&this._prepareData(t)}loadTile(e,t){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={},t(null)):(e.state="errored",t(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(e){const t=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!t)return null;const n=this.elevatedGlobeTrianglesCenterLongitudes;let r=(i=e+180)+360*Math.round((n[0]-i)/360);var i;const o=new ps,a=(e,n)=>{o.segments.push({vertexOffset:0,primitiveOffset:e,vertexLength:t.segments[0].vertexLength,primitiveLength:n,sortKey:void 0,vaos:{}})},s=.51*this.maxLongitudeTriangleSize;if(Math.abs(n[0]-r)<=s){const e=Se(n,0,n.length,r+s);return e===n.length||a(e,we(n,e+1,n.length,r+360-s)-e),o}r<n[0]&&(r+=360);const l=we(n,0,n.length,r-s);if(l===n.length)return a(0,n.length),o;a(0,l-0);const c=Se(n,l+1,n.length,r+s);return c!==n.length&&a(c,n.length-c),o}}const ym=(Math.pow(256,2)-1)/16907520;class _m extends pa{constructor(e,t,n,r){super(e,{layout:am||(am=new qo({visibility:new Go(Wo.layout_raster.visibility)})),paint:sm||(sm=new qo({"raster-opacity":new Go(Wo.paint_raster["raster-opacity"]),"raster-color":new Zo(Wo.paint_raster["raster-color"]),"raster-color-mix":new Go(Wo.paint_raster["raster-color-mix"]),"raster-color-range":new Go(Wo.paint_raster["raster-color-range"]),"raster-hue-rotate":new Go(Wo.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Go(Wo.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Go(Wo.paint_raster["raster-brightness-max"]),"raster-saturation":new Go(Wo.paint_raster["raster-saturation"]),"raster-contrast":new Go(Wo.paint_raster["raster-contrast"]),"raster-resampling":new Go(Wo.paint_raster["raster-resampling"]),"raster-fade-duration":new Go(Wo.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new Go(Wo.paint_raster["raster-emissive-strength"]),"raster-array-band":new Go(Wo.paint_raster["raster-array-band"]),"raster-elevation":new Go(Wo.paint_raster["raster-elevation"])}))},t,n,r),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(e){return!(e&&e._source instanceof gm&&(e._source.onNorthPole||e._source.onSouthPole))&&0===this.paint.get("raster-elevation")}_handleSpecialPaintPropertyUpdate(e){"raster-color"!==e&&"raster-color-range"!==e||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}updateColorRamp(e){if(!this.hasColorMap())return;if(!this._curRampRange)return;const t=this._transitionablePaint._values["raster-color"].value.expression,[n,r]=e||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(n)&&isNaN(r)||n===this._curRampRange[0]&&r===this._curRampRange[1]||(this.colorRamp=lu({expression:t,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:n,end:r}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[n,r])}}let vm,xm,bm,wm,Sm;class Tm extends pa{constructor(e,t,n,r){super(e,{layout:vm||(vm=new qo({visibility:new Go(Wo["layout_raster-particle"].visibility)})),paint:xm||(xm=new qo({"raster-particle-array-band":new Go(Wo["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new Go(Wo["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new Zo(Wo["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new Go(Wo["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new Go(Wo["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new Go(Wo["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new Go(Wo["paint_raster-particle"]["raster-particle-reset-rate-factor"]),"raster-particle-elevation":new Go(Wo["paint_raster-particle"]["raster-particle-elevation"])}))},t,n,r),this._updateColorRamp(),this.lastInvalidatedAt=Le.now()}onRemove(e){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return"none"!==this.visibility}isDraped(e){return!1}_handleSpecialPaintPropertyUpdate(e){"raster-particle-color"!==e&&"raster-particle-max-speed"!==e||(this._updateColorRamp(),this._invalidateAnimationState()),"raster-particle-count"===e&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const e=this._transitionablePaint._values["raster-particle-color"].value.expression,t=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=lu({expression:e,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:t}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=Le.now()}tileCoverLift(){return this.paint.get("raster-particle-elevation")}}class Em extends pa{constructor(e,t){super(e,{},t,null),this.implementation=e,e.slot&&(this.slot=e.slot)}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}isDraped(e){return void 0!==this.implementation.renderToTile}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)}onRemove(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)}}function Am(e,t,n){const r=[0,0,1],i=B.quat.identity([]);return B.quat.rotateY(i,i,n?-X(e)+Math.PI:X(e)),B.quat.rotateX(i,i,-X(t)),B.vec3.transformQuat(r,r,i),B.vec3.normalize(r,r)}function Mm(e,t){const n=km(e.projection,e.zoom,e.width,e.height),r=function(e,t,n,r,i){const o=new il(n.lng-180*Cm,n.lat),a=new il(n.lng+180*Cm,n.lat),s=e.project(o.lng,o.lat),l=e.project(a.lng,a.lat),c=-Math.atan2(l.y-s.y,l.x-s.x),u=xl.fromLngLat(n);u.y=ee(u.y,-1+Cm,1-Cm);const h=u.toLngLat(),d=e.project(h.lng,h.lat),p=xl.fromLngLat(h);p.x+=Cm;const f=p.toLngLat(),m=e.project(f.lng,f.lat),g=Im(m.x-d.x,m.y-d.y,c),y=xl.fromLngLat(h);y.y+=Cm;const _=y.toLngLat(),v=e.project(_.lng,_.lat),x=Im(v.x-d.x,v.y-d.y,c),b=Math.abs(g.x)/Math.abs(x.y),w=B.mat4.identity([]);B.mat4.rotateZ(w,w,-c*(1-(i?0:r)));const S=B.mat4.identity([]);return B.mat4.scale(S,S,[1,1-(1-b)*r,1]),S[4]=-x.x/x.y*r,B.mat4.rotateZ(S,S,c),B.mat4.multiply(S,w,S),S}(e.projection,0,e.center,n,t),i=Pm(e);return B.mat4.scale(r,r,[i,i,1]),r}function Pm(e){const t=e.projection,n=km(e.projection,e.zoom,e.width,e.height),r=jm(t,e.center),i=jm(t,il.convert(t.center));return Math.pow(2,r*n+(1-n)*i)}function km(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1/0;const o=e.range;if(!o)return 0;const a=Math.min(i,Math.max(n,r)),s=Math.log(a/1024)/Math.LN2;return te(o[0]+s,o[1]+s,t)}const Cm=1/4e4;function jm(e,t){const n=ee(t.lat,-ml,ml),r=new il(t.lng-180*Cm,n),i=new il(t.lng+180*Cm,n),o=e.project(r.lng,n),a=e.project(i.lng,n),s=xl.fromLngLat(r),l=xl.fromLngLat(i),c=a.x-o.x,u=a.y-o.y,h=l.x-s.x,d=l.y-s.y,p=Math.sqrt((h*h+d*d)/(c*c+u*u));return Math.log(p)/Math.LN2}function Im(e,t,n){const r=Math.cos(n),i=Math.sin(n);return{x:e*r-t*i,y:e*i+t*r}}function Om(e,t,n){B.mat4.identity(e),B.mat4.rotateZ(e,e,X(t[2])),B.mat4.rotateX(e,e,X(t[0])),B.mat4.rotateY(e,e,X(t[1])),B.mat4.scale(e,e,n),B.mat4.multiply(e,e,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function Nm(e,t,n,r,i,o,a,s){const l=[n[0]-t[0],n[1]-t[1],0],c=[r[0]-t[0],r[1]-t[1],0];if(B.vec3.length(l)<1e-12||B.vec3.length(c)<1e-12)return B.quat.identity(e);const u=B.vec3.cross([],l,c);B.vec3.normalize(u,u),B.vec3.subtract(c,r,t),l[2]=(o-i)*s,c[2]=(a-i)*s;const h=l;return B.vec3.cross(h,l,c),B.vec3.normalize(h,h),B.quat.rotationTo(e,u,h)}function Dm(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=Rc(t.zoom),i=function(e,t,n){const r=t.worldSize,i=[e[12],e[13],e[14]],o=pl(i[1]/r),a=dl(i[0]/r),s=B.mat4.identity([]),l=hl(1,o)*r,c=hl(1,0)*r*yl(o,t.zoom),u=1/Dc(r);let h=c*u;if(n){const e=km(t.projection,t.zoom,t.width,t.height,1024);h=u*t.projection.pixelSpaceConversion(t.center.lat,r,e)}const d=tl(o,a);B.vec3.add(d,d,B.vec3.scale([],B.vec3.normalize([],d),l*h*i[2]));const p=function(e){const t=[e[0],e[1],e[2]];let n=[0,1,0];const r=B.vec3.cross([],n,t);return B.vec3.cross(n,t,r),0===B.vec3.squaredLength(n)&&(n=[0,1,0],B.vec3.cross(r,t,n)),B.vec3.normalize(r,r),B.vec3.normalize(n,n),B.vec3.normalize(t,t),[r[0],r[1],r[2],0,n[0],n[1],n[2],0,t[0],t[1],t[2],0,e[0],e[1],e[2],1]}(d);B.mat4.scale(s,s,[h,h,h*l]),B.mat4.translate(s,s,[-i[0],-i[1],-i[2]]);const f=B.mat4.multiply([],t.globeMatrix,p);return B.mat4.multiply(f,f,s),B.mat4.multiply(f,f,e),f}(e,t,n);if(r>0){const n=function(e,t){const n=t.worldSize,r=hl(1,0)*n*yl(t.center.lat,t.zoom)/Dc(n),i=hl(1,t.center.lat)*n,o=B.mat4.identity([]);return B.mat4.rotateY(o,o,X(t.center.lng)),B.mat4.rotateX(o,o,X(t.center.lat)),B.mat4.translate(o,o,[0,0,qs]),B.mat4.scale(o,o,[r,r,r*i]),B.mat4.translate(o,o,[t.point.x-.5*n,t.point.y-.5*n,0]),B.mat4.multiply(o,o,e),B.mat4.multiply(o,t.globeMatrix,o)}(e,t);return function(e,t,n){const r=(e,t,n)=>{const r=B.vec3.length(e),i=B.vec3.length(t),o=Ec(e,t,n);return B.vec3.scale(o,o,1/B.vec3.length(o)*kt(r,i,n))},i=r([e[0],e[1],e[2]],[t[0],t[1],t[2]],n),o=r([e[4],e[5],e[6]],[t[4],t[5],t[6]],n),a=r([e[8],e[9],e[10]],[t[8],t[9],t[10]],n),s=Ec([e[12],e[13],e[14]],[t[12],t[13],t[14]],n);return[i[0],i[1],i[2],0,o[0],o[1],o[2],0,a[0],a[1],a[2],0,s[0],s[1],s[2],1]}(i,n,r)}return i}function Lm(e,t,n,r){const i=_c.projectAabbCorners(r,n);let o=Number.MAX_VALUE,a=-1;for(let c=0;c<i.length;++c){const e=i[c];e[0]=(.5*e[0]+.5)*t.width,e[1]=(.5-.5*e[1])*t.height,e[2]<o&&(a=c,o=e[2])}const s=e=>new H(i[e][0],i[e][1]);let l;switch(a){case 0:case 6:l=[s(1),s(5),s(4),s(7),s(3),s(2),s(1)];break;case 1:case 7:l=[s(0),s(4),s(5),s(6),s(2),s(3),s(0)];break;case 3:case 5:l=[s(1),s(0),s(4),s(7),s(6),s(2),s(1)];break;default:l=[s(1),s(5),s(6),s(7),s(3),s(0),s(1)]}if(Ol(e,l))return o}const zm=ya([{name:"a_pos_3f",components:3,type:"Float32"}]),Rm=ya([{name:"a_color_3f",components:3,type:"Float32"}]),Fm=ya([{name:"a_color_4f",components:4,type:"Float32"}]),Bm=ya([{name:"a_uv_2f",components:2,type:"Float32"}]),Vm=ya([{name:"a_normal_3f",components:3,type:"Float32"}]),Um=ya([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),Gm=ya([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]),Hm={None:0,Model:1,Symbol:2,FillExtrusion:4,All:7};class Zm{constructor(e,t,n,r){this.message=(e?"".concat(e,": "):"")+n,r&&(this.identifier=r),null!=t&&t.__line__&&(this.line=t.__line__)}}function qm(e,t){const n=-1===e.indexOf("://");try{return new URL(e,n&&t?"http://example.com":void 0),!0}catch(e){return!1}}class Wm{constructor(e,t){this.feature=e,this.instancedDataOffset=t,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class Xm{constructor(){this.instancedDataArray=new Xa,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class Ym{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.layers=e.layers,this.layerIds=this.layers.map((e=>e.fqid)),this.projection=e.projection,this.index=e.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id)),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1,this.activeReplacements=[],this.replacementUpdateTime=0}updateFootprints(e,t){}populate(e,t,n,r){this.tileToMeter=vl(n);const i=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:o,id:a,index:s,sourceLayerIndex:l}of e){const e=null!=a?a:o.properties&&o.properties.hasOwnProperty("id")?o.properties.id:void 0,c=kl(o,i);if(!this.layers[0]._featureFilter.filter(new No(this.zoom),c,n))continue;const u={id:e,sourceLayerIndex:l,index:s,geometry:i?c.geometry:Pl(o,n,r),properties:o.properties,type:o.type,patterns:{}},h=this.addFeature(u,u.geometry,c);h&&t.featureIndex.insert(o,u.geometry,s,l,this.index,this.instancesPerModel[h].instancedDataArray.length,Jn/32)}this.lookup=null}update(e,t,n,r){for(const i in this.instancesPerModel){const t=this.instancesPerModel[i];for(const n in e)t.idToFeaturesIndex.hasOwnProperty(n)&&(this.evaluate(t.features[t.idToFeaturesIndex[n]],e[n],t,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let e=!1;for(const t in this.instancesPerModel){const n=this.instancesPerModel[t];for(const t of n.features){const r=this.layers[0],i=t.feature,o=this.canonical,a=r.paint.get("model-rotation").evaluate(i,{},o),s=r.paint.get("model-scale").evaluate(i,{},o),l=r.paint.get("model-translation").evaluate(i,{},o);B.vec3.exactEquals(t.rotation,a)&&B.vec3.exactEquals(t.scale,s)&&B.vec3.exactEquals(t.translation,l)||(this.evaluate(t,t.featureStates,n,!0),e=!0)}}return e}updateReplacement(e,t,n,r){if(t.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=t.updateTime;const i=t.getReplacementRegionsForTile(e.toUnwrapped(),!0);if(Sh(this.activeReplacements,i))return!1;this.activeReplacements=i;let o=!1;for(const a in this.instancesPerModel){const t=this.instancesPerModel[a],i=t.instancedDataArray;for(const a of t.features){const t=a.instancedDataOffset,s=a.instancedDataCount;for(let a=0;a<s;a++){const s=16*(a+t);let l=i.float32[s+0];const c=l>Jn;l=c?l-Jn:l;const u=Math.floor(l),h=i.float32[s+1];let d=!1;for(const t of this.activeReplacements)if(!vh(t,n,Hm.Model,r)&&!(t.min.x>u||u>t.max.x||t.min.y>h||h>t.max.y)&&(d=kh(Ph(u,h,e.canonical,t.footprintTileId.canonical),t.footprint),d))break;i.float32[s]=d?l+Jn:l,o=o||d!==c}}}return o}isEmpty(){for(const e in this.instancesPerModel)if(0!==this.instancesPerModel[e].instancedDataArray.length)return!1;return!0}uploadPending(){return!this.uploaded}upload(e){if(!this.uploaded)for(const t in this.instancesPerModel){const n=this.instancesPerModel[t];n.instancedDataArray.length<0||0===n.instancedDataArray.length||(n.instancedDataBuffer?n.instancedDataBuffer.updateData(n.instancedDataArray):n.instancedDataBuffer=e.createVertexBuffer(n.instancedDataArray,Um.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const t in this.instancesPerModel){const e=this.instancesPerModel[t];0!==e.instancedDataArray.length&&e.instancedDataBuffer&&e.instancedDataBuffer.destroy()}const e=this.layers[0].modelManager;if(e&&this.modelUris)for(const t of this.modelUris)e.removeModel(t,"")}addFeature(e,t,n){const r=this.layers[0],i=r.layout.get("model-id").evaluate(n,{},this.canonical);if(!i)return fe("modelId is not evaluated for layer ".concat(r.id," and it is not going to get rendered.")),i;qm(i,!1)&&(this.modelUris.includes(i)||this.modelUris.push(i)),this.instancesPerModel[i]||(this.instancesPerModel[i]=new Xm);const o=this.instancesPerModel[i],a=o.instancedDataArray,s=new Wm(n,a.length);for(const l of t)for(const e of l){if(e.x<0||e.x>=Jn||e.y<0||e.y>=Jn)continue;const t=(this.lookupDim-1)/Jn,n=this.lookupDim*(e.y*t|0)+e.x*t|0;if(this.lookup){if(0!==this.lookup[n])continue;this.lookup[n]=1}this.instanceCount++;const r=a.length;a.resize(r+1),o.instancesEvaluatedElevation.push(0),a.float32[16*r]=e.x,a.float32[16*r+1]=e.y}return s.instancedDataCount=o.instancedDataArray.length-s.instancedDataOffset,s.instancedDataCount>0&&(e.id&&(o.idToFeaturesIndex[e.id]=o.features.length),o.features.push(s),this.evaluate(s,{},o,!1)),i}getModelUris(){return this.modelUris}evaluate(e,t,n,r){const i=this.layers[0],o=e.feature,a=this.canonical,s=e.rotation=i.paint.get("model-rotation").evaluate(o,t,a),l=e.scale=i.paint.get("model-scale").evaluate(o,t,a),c=e.translation=i.paint.get("model-translation").evaluate(o,t,a),u=i.paint.get("model-color").evaluate(o,t,a);u.a=i.paint.get("model-color-mix-intensity").evaluate(o,t,a);const h=[];this.maxVerticalOffset<c[2]&&(this.maxVerticalOffset=c[2]),this.maxScale=Math.max(Math.max(this.maxScale,l[0]),Math.max(l[1],l[2])),Om(h,s,l);const d=Math.round(100*u.a)+u.b/1.05;for(let p=0;p<e.instancedDataCount;++p){const t=e.instancedDataOffset+p,i=16*t,o=n.instancedDataArray.float32;let s=0;r&&(s=o[i+6]-n.instancesEvaluatedElevation[t]);const l=0|o[i+1];o[i]=(0|o[i])+u.r/1.05,o[i+1]=l+u.g/1.05,o[i+2]=d,o[i+3]=1/(a.z>10?this.tileToMeter:vl(a,l)),o[i+4]=c[0],o[i+5]=c[1],o[i+6]=c[2]+s,o[i+7]=h[0],o[i+8]=h[1],o[i+9]=h[2],o[i+10]=h[4],o[i+11]=h[5],o[i+12]=h[6],o[i+13]=h[8],o[i+14]=h[9],o[i+15]=h[10],n.instancesEvaluatedElevation[t]=c[2]}}}let Km,Jm;so(Ym,"ModelBucket",{omit:["layers"]}),so(Xm,"PerModelAttributes"),so(Wm,"ModelFeature");const Qm=64,$m={CoordinateSpaceTile:1,CoordinateSpaceYUp:2,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function eg(e,t,n,r,i,o,a,s,l){let c=arguments.length>9&&void 0!==arguments[9]&&arguments[9];const u=n.zoom,h=n.project(r),d=yl(r.lat,u),p=1/d;B.mat4.identity(e),B.mat4.translate(e,e,[h.x+a[0]*p,h.y+a[1]*p,a[2]]);let f=1,m=1;const g=n.worldSize;if(c){if("mercator"===n.projection.name){let e=0;n.elevation&&(e=n.elevation.getAtPointOrZero(new xl(h.x/g,h.y/g),0));const t=B.vec4.transformMat4([],[h.x,h.y,e,1],n.projMatrix)[3]/n.cameraToCenterDistance;f=t,m=t*yl(n.center.lat,u)}else if("globe"===n.projection.name){const t=Dm(e,n),i=B.mat4.multiply([],n.projMatrix,t),o=[0,0,0,1];B.vec4.transformMat4(o,o,i);const a=o[3]/n.cameraToCenterDistance,s=Rc(u),l=n.projection.pixelsPerMeter(r.lat,g)*yl(r.lat,u),c=n.projection.pixelsPerMeter(n.center.lat,g)*yl(n.center.lat,u);f=a/kt(l,gl(n.center.lat),s),m=a*d/l,f*=c,m*=c}}else f=p;B.mat4.scale(e,e,[f,f,m]);const y=[...e],_=t.orientation,v=[];if(Om(v,[_[0]+i[0],_[1]+i[1],_[2]+i[2]],o),B.mat4.multiply(e,y,v),s&&n.elevation){let i=0;const o=[];if(l&&n.elevation){i=function(e,t,n,r,i){const o=t.elevation;if(!o)return 0;const a=_c.projectAabbCorners(n,r),s=hl(1,i.lat)*t.worldSize,l=function(e,t){const n=[0,0,1],r=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const i of r){const r=e[i.corners[0]],o=e[i.corners[1]],a=e[i.corners[2]],s=[o[0]-r[0],o[1]-r[1],t*(o[2]-r[2])],l=B.vec3.cross(s,s,[a[0]-r[0],a[1]-r[1],t*(a[2]-r[2])]);B.vec3.normalize(l,l),i.dotProductWithUp=B.vec3.dot(l,n)}return r.sort(((e,t)=>e.dotProductWithUp-t.dotProductWithUp)),r[0].corners}(a,s),c=a[l[0]],u=a[l[1]],h=a[l[2]],d=a[l[3]],p=o.getAtPointOrZero(new xl(c[0]/t.worldSize,c[1]/t.worldSize),0),f=o.getAtPointOrZero(new xl(u[0]/t.worldSize,u[1]/t.worldSize),0),m=o.getAtPointOrZero(new xl(h[0]/t.worldSize,h[1]/t.worldSize),0),g=o.getAtPointOrZero(new xl(d[0]/t.worldSize,d[1]/t.worldSize),0),y=(p+g)/2,_=(f+m)/2;return y>_?f<m?Nm(e,u,d,c,f,g,p,s):Nm(e,h,c,d,m,p,g,s):p<g?Nm(e,c,u,h,p,f,m,s):Nm(e,d,h,u,g,m,f,s),Math.max(y,_)}(o,n,t.aabb,e,r);const a=B.mat4.fromQuat([],o),s=B.mat4.multiply([],a,v);B.mat4.multiply(e,y,s)}else i=n.elevation.getAtPointOrZero(new xl(h.x/g,h.y/g),0);0!==i&&(e[14]+=i)}}function tg(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e.uploaded||(e.gfxTexture=new hm(t,e.image,n?t.gl.R8:t.gl.RGBA8,{useMipmap:e.sampler.minFilter>=t.gl.NEAREST_MIPMAP_NEAREST}),e.uploaded=!0,e.image=null)}function ng(e,t,n){e.indexBuffer=t.createIndexBuffer(e.indexArray,!1,!0),e.vertexBuffer=t.createVertexBuffer(e.vertexArray,zm.members,!1,!0),e.normalArray&&(e.normalBuffer=t.createVertexBuffer(e.normalArray,Vm.members,!1,!0)),e.texcoordArray&&(e.texcoordBuffer=t.createVertexBuffer(e.texcoordArray,Bm.members,!1,!0)),e.colorArray&&(e.colorBuffer=t.createVertexBuffer(e.colorArray,(12===e.colorArray.bytesPerElement?Rm:Fm).members,!1,!0)),e.featureArray&&(e.pbrBuffer=t.createVertexBuffer(e.featureArray,Gm.members,!0)),e.segments=ps.simpleSegment(0,0,e.vertexArray.length,e.indexArray.length);const r=e.material;r.pbrMetallicRoughness.baseColorTexture&&tg(r.pbrMetallicRoughness.baseColorTexture,t),r.pbrMetallicRoughness.metallicRoughnessTexture&&tg(r.pbrMetallicRoughness.metallicRoughnessTexture,t),r.normalTexture&&tg(r.normalTexture,t),r.occlusionTexture&&tg(r.occlusionTexture,t,n),r.emissionTexture&&tg(r.emissionTexture,t)}function rg(e,t,n){if(e.meshes)for(const r of e.meshes)ng(r,t,n);if(e.children)for(const r of e.children)rg(r,t,n)}function ig(e){if(e.meshes)for(const t of e.meshes)t.indexArray.destroy(),t.vertexArray.destroy(),t.colorArray&&t.colorArray.destroy(),t.normalArray&&t.normalArray.destroy(),t.texcoordArray&&t.texcoordArray.destroy(),t.featureArray&&t.featureArray.destroy();if(e.children)for(const t of e.children)ig(t)}function og(e){if(e.meshes)for(const n of e.meshes)n.vertexBuffer&&(n.vertexBuffer.destroy(),n.indexBuffer.destroy(),n.normalBuffer&&n.normalBuffer.destroy(),n.texcoordBuffer&&n.texcoordBuffer.destroy(),n.colorBuffer&&n.colorBuffer.destroy(),n.pbrBuffer&&n.pbrBuffer.destroy(),n.segments.destroy(),n.material&&((t=n.material).pbrMetallicRoughness.baseColorTexture&&t.pbrMetallicRoughness.baseColorTexture.gfxTexture&&t.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),t.pbrMetallicRoughness.metallicRoughnessTexture&&t.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&t.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),t.normalTexture&&t.normalTexture.gfxTexture&&t.normalTexture.gfxTexture.destroy(),t.emissionTexture&&t.emissionTexture.gfxTexture&&t.emissionTexture.gfxTexture.destroy(),t.occlusionTexture&&t.occlusionTexture.gfxTexture&&t.occlusionTexture.gfxTexture.destroy()));var t;if(e.children)for(const n of e.children)og(n)}class ag{constructor(e,t,n){this._demTile=e,this._dem=this._demTile.dem,this._scale=t,this._offset=n}static create(e,t,n){const r=n||e.findDEMTileFor(t);if(!r||!r.dem)return;const i=r.dem,o=r.tileID,a=1<<t.canonical.z-o.canonical.z;return new ag(r,i.dim/Jn/a,[(t.canonical.x/a-o.canonical.x)*i.dim,(t.canonical.y/a-o.canonical.y)*i.dim])}tileCoordToPixel(e,t){const n=t*this._scale+this._offset[1],r=Math.floor(e*this._scale+this._offset[0]),i=Math.floor(n);return new H(r,i)}getElevationAt(e,t,n,r){const i=e*this._scale+this._offset[0],o=t*this._scale+this._offset[1],a=Math.floor(i),s=Math.floor(o),l=this._dem;return r=!!r,n?kt(kt(l.get(a,s,r),l.get(a,s+1,r),o-s),kt(l.get(a+1,s,r),l.get(a+1,s+1,r),o-s),i-a):l.get(a,s,r)}getElevationAtPixel(e,t,n){return this._dem.get(e,t,!!n)}getMeterToDEM(e){return(1<<this._demTile.tileID.canonical.z)*hl(1,e)*this._dem.stride}}const sg=new Float32Array(262144),lg=new Uint8Array(262144);function cg(e){let t=0;if(e.meshes)for(const n of e.meshes)t=Math.max(t,n.aabb.max[2]);if(e.children)for(const n of e.children)t=Math.max(t,cg(n));return t}function ug(e,t,n){if(e.meshes)for(const r of e.meshes){if(r.aabb.min[0]===1/0)continue;const i=_c.applyTransform(r.aabb,e.matrix);n.insert(t,i.min[0],i.min[1],i.max[0],i.max[1])}if(e.children)for(const r of e.children)ug(r,t,n)}const hg=["","wall","door","roof","window","lamp","logo"];class dg{constructor(e){this.node=e,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.cameraCollisionOpacity=1,this.feature={type:"Point",id:e.id,geometry:[],properties:{height:cg(e)}},this.aabb=this._getLocalBounds()}_getLocalBounds(){if(!this.node.meshes)return new _c([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let e=0;const t=new _c([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const n of this.node.meshes)this.node.lightMeshIndex!==e&&(n.transformedAabb=_c.applyTransformFast(n.aabb,this.node.matrix),t.encapsulate(n.transformedAabb)),e++;this.aabb=t}return this.aabb}}class pg{constructor(e,t,n,r,i,o,a){this.id=n,this.layers=e,this.layerIds=this.layers.map((e=>e.fqid)),this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id)),this.modelTraits|=$m.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,r&&(this.modelTraits|=$m.HasMapboxMeshFeatures),i&&(this.modelTraits|=$m.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=o,this.dirty=!0,this.needsUpload=!1,this.nodesInfo=[];for(const s of t)this.nodesInfo.push(new dg(s)),ug(s,a.featureIndexArray.length,a.grid),a.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,a.bucketLayerIDs.length-1,0)}updateFootprints(e,t){for(const n of this.getNodesInfo()){const r=n.node;r.footprint&&t.push({footprint:r.footprint,id:e})}}update(e){const t=0!==Object.keys(e).length;if(t&&!this.stateDependentLayers.length)return;const n=t?this.stateDependentLayers:this.layers;for(const r of n)this.evaluate(r,e)}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(e){if(!this.needsUpload)return;const t=this.getNodesInfo();for(const n of t){const t=n.node;this.uploaded?this.updatePbrBuffer(t):rg(t,e,!0)}for(const n of t)ig(n.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(e){let t=!1;if(!e.meshes)return t;for(const n of e.meshes)n.pbrBuffer&&(n.pbrBuffer.updateData(n.featureArray),t=!0);return t}needsReEvaluation(e,t,n){const r=e.transform.projectionOptions,i=e.style.getBrightness(),o=this.brightness!==i;return!!(!this.uploaded||this.dirty||r.name!==this.projection.name||fg(n.paint.get("model-color").value,o)||fg(n.paint.get("model-color-mix-intensity").value,o)||fg(n.paint.get("model-roughness").value,o)||fg(n.paint.get("model-emissive-strength").value,o)||fg(n.paint.get("model-height-based-emissive-strength-multiplier").value,o))&&(this.projection=r,this.brightness=i,!0)}evaluateScale(e,t){if(e.transform.zoom===this.zoom)return;this.zoom=e.transform.zoom;const n=this.getNodesInfo(),r=this.id.canonical;for(const i of n){const e=i.feature;i.evaluatedScale=t.paint.get("model-scale").evaluate(e,{},r)}}evaluate(e,t){const n=this.getNodesInfo();for(const r of n){if(!r.node.meshes)continue;const n=r.feature,i=t&&t[n.id],o=r.node.meshes&&r.node.meshes[0].featureData,a=r.evaluatedColor[2],s=r.evaluatedRMEA[2],l=this.id.canonical;if(r.hasTranslucentParts=!1,o){for(let t=0;t<hg.length;t++){const o=hg[t];o.length&&(n.properties.part=o);const a=e.paint.get("model-color").evaluate(n,i,l).toRenderColor(null),s=e.paint.get("model-color-mix-intensity").evaluate(n,i,l);r.evaluatedColor[t]=[a.r,a.g,a.b,s],r.evaluatedRMEA[t][0]=e.paint.get("model-roughness").evaluate(n,i,l),r.evaluatedRMEA[t][2]=e.paint.get("model-emissive-strength").evaluate(n,i,l),r.evaluatedRMEA[t][3]=a.a,r.emissionHeightBasedParams[t]=e.paint.get("model-height-based-emissive-strength-multiplier").evaluate(n,i,l),!r.hasTranslucentParts&&a.a<1&&(r.hasTranslucentParts=!0)}delete n.properties.part,gg(r,a!==r.evaluatedColor[2]||s!==r.evaluatedRMEA[2],this.modelTraits)}else r.evaluatedRMEA[0][2]=e.paint.get("model-emissive-strength").evaluate(n,i,l);r.evaluatedScale=e.paint.get("model-scale").evaluate(n,i,l),this.updatePbrBuffer(r.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(e,t,n,r){const i=e.findDEMTileFor(n);if(i&&(i.tileID.canonical!==this.terrainTile||t!==this.terrainExaggeration)){if(i.dem&&i.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=i.tileID.overscaledZ;const t=ag.create(e,n,i);if(!t)return;this.modelTraits&$m.HasMapboxMeshFeatures&&this.updateDEM(e,t,n,r);for(const e of this.getNodesInfo()){const n=e.node;if(!n.footprint||!n.footprint.vertices||!n.footprint.vertices.length)continue;const r=n.footprint.vertices;let i=t.getElevationAt(r[0].x,r[0].y,!0,!0);for(let e=1;e<r.length;e++)i=Math.min(i,t.getElevationAt(r[e].x,r[e].y,!0,!0));n.elevation=i}}this.terrainTile=i.tileID.canonical,this.terrainExaggeration=t}}updateDEM(e,t,n,r){let i=t._dem._modifiedForSources[r];if(void 0===i&&(t._dem._modifiedForSources[r]=[],i=t._dem._modifiedForSources[r]),i.includes(n.canonical))return;const o=t._dem.dim;i.push(n.canonical);let a=!1;for(const s of this.getNodesInfo()){const e=s.node;if(!e.footprint||!e.footprint.grid)continue;const n=e.footprint.grid,r=t.tileCoordToPixel(n.min.x,n.min.y),i=t.tileCoordToPixel(n.max.x,n.max.y),l=Math.min(Math.min(o-i.y,r.x),Math.min(r.y,o-i.x));if(l<0)continue;const c=ee(l,2,5);let u=Math.max(0,r.x-c),h=Math.max(0,r.y-c),d=Math.min(i.x+c,o-1),p=Math.min(i.y+c,o-1);for(let t=h;t<=p;++t)for(let e=u;e<=d;++e)lg[t*o+e]=255;let f=0,m=0;for(let a=0;a<n.cellsY;++a)for(let e=0;e<n.cellsX;++e){if(!n.cells[a*n.cellsX+e])continue;const r=t.tileCoordToPixel(n.min.x+e/n.xScale,n.min.y+a/n.yScale),i=t.tileCoordToPixel(n.min.x+(e+1)/n.xScale,n.min.y+(a+1)/n.yScale);for(let e=r.y;e<=Math.min(i.y+1,o-1);++e)for(let n=r.x;n<=Math.min(i.x+1,o-1);++n)255===lg[e*o+n]&&(lg[e*o+n]=0,f+=t.getElevationAtPixel(n,e),m++)}const g=f/m;u=Math.max(1,r.x-c),h=Math.max(1,r.y-c),d=Math.min(i.x+c,o-2),p=Math.min(i.y+c,o-2),a=!0;for(let a=h;a<=p;++a)for(let e=u;e<=d;++e)0===lg[a*o+e]&&(sg[a*o+e]=t._dem.set(e,a,g));for(let a=1;a<c;++a){u=Math.max(1,r.x-a),h=Math.max(1,r.y-a),d=Math.min(i.x+a,o-2),p=Math.min(i.y+a,o-2);for(let e=h;e<=p;++e)for(let n=u;n<=d;++n){const r=e*o+n;if(255===lg[r]){let i=0,s=0,l=-1,u=-1;for(let t=-1;t<=1;++t)for(let r=-1;r<=1;++r){const c=(e+t)*o+n+r;if(lg[c]>=a)continue;const h=sg[c],d=Math.abs(h);d>s&&(i=h,s=d,l=r,u=t)}if(s>.1){const o=1-(a+.5*Math.abs(l*u))/c;let s=t._dem.get(n,e)+i*o;const h=t._dem.get(n+l,e+u),d=t._dem.get(n-l,e-u,!0);(s-h)*(s-d)>0&&(s=(h+d)/2),sg[r]=t._dem.set(n,e,s),lg[r]=a}}}}}a&&(t._demTile.needsDEMTextureUpload=!0,t._dem._timestamp=Le.now())}getNodesInfo(){return this.nodesInfo}destroy(){const e=this.getNodesInfo();for(const t of e)ig(t.node),og(t.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(e,t){if(t.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=t.updateTime;const n=t.getReplacementRegionsForTile(e.toUnwrapped()),r=this.getNodesInfo();for(let i=0;i<this.nodesInfo.length;i++){const e=r[i].node;r[i].hiddenByReplacement=!!e.footprint&&!n.find((t=>t.footprint===e.footprint))}}getHeightAtTileCoord(e,t){const n=this.getNodesInfo(),r=[],i=[0,0,0],o=B.mat4.identity([]);for(let a=0;a<this.nodesInfo.length;a++){const s=n[a],l=s.node.meshes[0],c=l.transformedAabb;if(e<c.min[0]||t<c.min[1]||e>c.max[0]||t>c.max[1])continue;if(!0===s.node.hidden)return{height:1/0,maxHeight:s.feature.properties.height,hidden:!1,verticalScale:s.evaluatedScale[2]};B.mat4.invert(o,s.node.matrix),i[0]=e,i[1]=t,B.vec3.transformMat4(i,i,o);const u=(i[0]-l.aabb.min[0])/(l.aabb.max[0]-l.aabb.min[0])*Qm|0,h=Math.min(63,(i[1]-l.aabb.min[1])/(l.aabb.max[1]-l.aabb.min[1])*Qm|0)*Qm+Math.min(63,u),d=l.heightmap[h];if(!(d<0&&s.node.footprint)){if(s.hiddenByReplacement)return;return{height:d,maxHeight:s.feature.properties.height,hidden:!1,verticalScale:s.evaluatedScale[2]}}if(s.node.footprint.grid.query(new H(e,t),new H(e,t),r),r.length>0)return{height:void 0,maxHeight:s.feature.properties.height,hidden:s.hiddenByReplacement,verticalScale:s.evaluatedScale[2]}}}}function fg(e,t){return!e.isLightConstant&&t}function mg(e,t,n,r,i,o,a,s){let l=(61440&t|(61440&t)>>4)>>8,c=(3840&t|(3840&t)>>4)>>4,u=240&t|(240&t)>>4;n[3]>0&&(l=kt(l,255*n[0],n[3]),c=kt(c,255*n[1],n[3]),u=kt(u,255*n[2],n[3]));const h=l<<8|c,d=u<<8|Math.floor(255*r[3]),p=function(e){const t=ee(e,0,2);return Math.min(Math.round(.5*t*255),255)}(r[2])<<8|15*r[0]<<4|15*r[1],f=ee(i[0],0,1),m=ee(i[1],0,1),g=ee(i[2],0,1),y=ee(i[3],0,1);let _,v,x,b;if(f!==m&&a!==o&&m!==f){const e=a-o;v=1/(e*(m-f)),x=-(o+e*f)/(e*(m-f));const t=ee(i[4],-1,1);b=Math.pow(10,t),_=255*g<<8|255*y}else _=65535,v=0,x=1,b=1;if(e.emplaceBack(h,d,p,_,v,x,b),s){const e=s.length;s.clear();for(let t=0;t<e;t++)s.emplaceBack(h,d,p,_,v,x,b)}}function gg(e,t,n){const r=e.node;let i=0;const o=n&$m.HasMeshoptCompression;for(const a of r.meshes){if(r.lights&&r.lightMeshIndex===i)continue;if(!a.featureData)continue;a.featureArray=new Ya,a.featureArray.reserve(a.featureData.length);let n=t;for(const t of a.featureData){const i=o?65535&t:t>>16&65535,s=o?t>>16&65535:65535&t,l=(15&s)<8?15&s:0,c=e.evaluatedRMEA[l],u=e.evaluatedColor[l],h=e.emissionHeightBasedParams[l];let d;if(n&&2===l&&r.lights&&(d=new Ya,d.resize(10*r.lights.length)),mg(a.featureArray,i,u,c,h,a.aabb.min[2],a.aabb.max[2],d),d&&n){n=!1;const e=r.meshes[r.lightMeshIndex];e.featureArray=d,e.featureArray._trim()}}a.featureArray._trim(),i++}}so(pg,"Tiled3dModelBucket",{omit:["layers"]}),so(dg,"Tiled3dModelFeature");const yg=["id","tile","layer","source","sourceLayer","state"];class _g{constructor(e,t,n,r,i){this.type="Feature",this._vectorTileFeature=e,this._z=t,this._x=n,this._y=r,this.properties=e.properties,this.id=i}clone(){const e=new _g(this._vectorTileFeature,this._z,this._x,this._y,this.id);return this.state&&(e.state=i({},this.state)),this.layer&&(e.layer=i({},this.layer)),this.namespace&&(e.namespace=this.namespace),e}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};for(const t of yg)void 0!==this[t]&&(e[t]=this[t]);return e}}function vg(e,t,n,r){const i=1<<e.z;t.lat=pl((r/Jn+e.y)/i),t.lng=dl((n/Jn+e.x)/i)}const xg={circle:class extends pa{constructor(e,t,n,r){super(e,{layout:Jl||(Jl=new qo({"circle-sort-key":new Ho(Wo.layout_circle["circle-sort-key"]),visibility:new Go(Wo.layout_circle.visibility)})),paint:Ql||(Ql=new qo({"circle-radius":new Ho(Wo.paint_circle["circle-radius"]),"circle-color":new Ho(Wo.paint_circle["circle-color"]),"circle-blur":new Ho(Wo.paint_circle["circle-blur"]),"circle-opacity":new Ho(Wo.paint_circle["circle-opacity"]),"circle-translate":new Go(Wo.paint_circle["circle-translate"]),"circle-translate-anchor":new Go(Wo.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Go(Wo.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Go(Wo.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Ho(Wo.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Ho(Wo.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Ho(Wo.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new Go(Wo.paint_circle["circle-emissive-strength"])}))},t,n,r)}createBucket(e){return new Il(e)}queryRadius(e){const t=e;return Wl("circle-radius",this,t)+Wl("circle-stroke-width",this,t)+Xl(this.paint.get("circle-translate"))}queryIntersectsFeature(e,t,n,r,i,o,a,s){const l=Kl(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),o.angle,e.pixelToTileUnitsFactor),c=this.paint.get("circle-radius").evaluate(t,n)+this.paint.get("circle-stroke-width").evaluate(t,n);return qc(e,r,o,a,s,"map"===this.paint.get("circle-pitch-alignment"),"map"===this.paint.get("circle-pitch-scale"),l,c)}getProgramIds(){return["circle"]}getDefaultProgramParams(e,t,n){const r=Zc(this);return{config:new Fs(this,{zoom:t,lut:n}),defines:r,overrideFog:!1}}},heatmap:class extends pa{createBucket(e){return new Jc(e)}constructor(e,t,n,r){super(e,{layout:Qc||(Qc=new qo({visibility:new Go(Wo.layout_heatmap.visibility)})),paint:$c||($c=new qo({"heatmap-radius":new Ho(Wo.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Ho(Wo.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Go(Wo.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Zo(Wo.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Go(Wo.paint_heatmap["heatmap-opacity"])}))},t,n,r),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(e){"heatmap-color"===e&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=lu({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(e){return Wl("heatmap-radius",this,e)}queryIntersectsFeature(e,t,n,r,i,o,a,s){const l=this.paint.get("heatmap-radius").evaluate(t,n);return qc(e,r,o,a,s,!0,!0,new H(0,0),l)}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(e,t,n){return"heatmap"===e?{config:new Fs(this,{zoom:t,lut:n}),overrideFog:!1}:{}}},hillshade:class extends pa{constructor(e,t,n,r){super(e,{layout:eu||(eu=new qo({visibility:new Go(Wo.layout_hillshade.visibility)})),paint:tu||(tu=new qo({"hillshade-illumination-direction":new Go(Wo.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Go(Wo.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Go(Wo.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Go(Wo.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Go(Wo.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Go(Wo.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new Go(Wo.paint_hillshade["hillshade-emissive-strength"])}))},t,n,r)}shouldRedrape(){return this.hasOffscreenPass()&&"viewport"===this.paint.get("hillshade-illumination-anchor")}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(e,t,n){return{overrideFog:!1}}},fill:class extends pa{constructor(e,t,n,r){super(e,{layout:Vu||(Vu=new qo({"fill-sort-key":new Ho(Wo.layout_fill["fill-sort-key"]),visibility:new Go(Wo.layout_fill.visibility),"fill-elevation-reference":new Go(Wo.layout_fill["fill-elevation-reference"])})),paint:Uu||(Uu=new qo({"fill-antialias":new Go(Wo.paint_fill["fill-antialias"]),"fill-opacity":new Ho(Wo.paint_fill["fill-opacity"]),"fill-color":new Ho(Wo.paint_fill["fill-color"]),"fill-outline-color":new Ho(Wo.paint_fill["fill-outline-color"]),"fill-translate":new Go(Wo.paint_fill["fill-translate"]),"fill-translate-anchor":new Go(Wo.paint_fill["fill-translate-anchor"]),"fill-pattern":new Ho(Wo.paint_fill["fill-pattern"]),"fill-emissive-strength":new Go(Wo.paint_fill["fill-emissive-strength"]),"fill-z-offset":new Ho(Wo.paint_fill["fill-z-offset"])}))},t,n,r)}getProgramIds(){const e=this.paint.get("fill-pattern"),t=e&&e.constantOr(1),n=[t?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&n.push(t&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),n}getDefaultProgramParams(e,t,n){return{config:new Fs(this,{zoom:t,lut:n}),overrideFog:!1}}recalculate(e,t){super.recalculate(e,t);const n=this.paint._values["fill-outline-color"];"constant"===n.value.kind&&void 0===n.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(e){return new Bu(e)}queryRadius(){return Xl(this.paint.get("fill-translate"))}queryIntersectsFeature(e,t,n,r,i,o){return!e.queryGeometry.isAboveHorizon&&Dl(Yl(e.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),o.angle,e.pixelToTileUnitsFactor),r)}isTileClipped(){return!0}is3D(){return 0!==this.paint.get("fill-z-offset").constantOr(1)}},"fill-extrusion":class extends pa{constructor(e,t,n,r){super(e,{layout:sd||(sd=new qo({visibility:new Go(Wo["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new Go(Wo["layout_fill-extrusion"]["fill-extrusion-edge-radius"])})),paint:ld||(ld=new qo({"fill-extrusion-opacity":new Go(Wo["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Ho(Wo["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Go(Wo["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Go(Wo["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Ho(Wo["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Ho(Wo["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Ho(Wo["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-height-alignment":new Go(Wo["paint_fill-extrusion"]["fill-extrusion-height-alignment"]),"fill-extrusion-base-alignment":new Go(Wo["paint_fill-extrusion"]["fill-extrusion-base-alignment"]),"fill-extrusion-vertical-gradient":new Go(Wo["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Go(Wo["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Go(Wo["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new Go(Wo["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new Go(Wo["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new Go(Wo["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new Go(Wo["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new Go(Wo["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new Ho(Wo["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new Ho(Wo["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new Go(Wo["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new Go(Wo["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new Go(Wo["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new Go(Wo["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new Ho(Wo["paint_fill-extrusion"]["fill-extrusion-emissive-strength"]),"fill-extrusion-line-width":new Ho(Wo["paint_fill-extrusion"]["fill-extrusion-line-width"]),"fill-extrusion-cast-shadows":new Go(Wo["paint_fill-extrusion"]["fill-extrusion-cast-shadows"])}))},t,n,r),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(e){return new Kh(e)}queryRadius(){return Xl(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}hasShadowPass(){return this.paint.get("fill-extrusion-cast-shadows")}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(e,t,n,r,i,o,a,s,l){const c=Kl(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),o.angle,e.pixelToTileUnitsFactor),u=this.paint.get("fill-extrusion-height").evaluate(t,n),h=this.paint.get("fill-extrusion-base").evaluate(t,n),d=[0,0],p=s&&o.elevation,f=o.elevation?o.elevation.exaggeration():1,m=e.tile.getBucket(this);if(p&&m instanceof Kh){const e=m.centroidVertexArray,t=l+1;t<e.length&&(d[0]=e.geta_centroid_pos0(t),d[1]=e.geta_centroid_pos1(t))}if(0===d[0]&&1===d[1])return!1;"globe"===o.projection.name&&(r=od([r],[new H(0,0),new H(Jn,Jn)],e.tileID.canonical).map((e=>e.polygon)).flat());const g=p?s:null,[y,_]=function(e,t,n,r,i,o,a,s,l,c,u){return"globe"===e.projection.name?function(e,t,n,r,i,o,a,s,l,c,u){const h=[],d=[],p=e.projection.upVectorScale(u,e.center.lat,e.worldSize).metersToTile,f=[0,0,0,1],m=[0,0,0,1],g=(e,t,n,r)=>{e[0]=t,e[1]=n,e[2]=r,e[3]=1},y=id();n>0&&(n+=y),r+=y;for(const _ of t){const t=[],y=[];for(const h of _){const d=h.x+i.x,_=h.y+i.y,v=e.projection.projectTilePoint(d,_,u),x=e.projection.upVector(u,h.x,h.y);let b=n,w=r;if(a){const e=hd(d,_,n,r,a,s,l,c);b+=e.base,w+=e.top}0!==n?g(f,v.x+x[0]*p*b,v.y+x[1]*p*b,v.z+x[2]*p*b):g(f,v.x,v.y,v.z),g(m,v.x+x[0]*p*w,v.y+x[1]*p*w,v.z+x[2]*p*w),B.vec3.transformMat4(f,f,o),B.vec3.transformMat4(m,m,o),t.push(new ph(f[0],f[1],f[2])),y.push(new ph(m[0],m[1],m[2]))}h.push(t),d.push(y)}return[h,d]}(e,t,n,r,i,o,a,s,l,c,u):a?function(e,t,n,r,i,o,a,s,l){const c=[],u=[],h=[0,0,0,1];for(const d of e){const e=[],p=[];for(const c of d){const u=c.x+r.x,d=c.y+r.y,f=hd(u,d,t,n,o,a,s,l);h[0]=u,h[1]=d,h[2]=f.base,h[3]=1,B.vec4.transformMat4(h,h,i),h[3]=Math.max(h[3],1e-5);const m=new ph(h[0]/h[3],h[1]/h[3],h[2]/h[3]);h[0]=u,h[1]=d,h[2]=f.top,h[3]=1,B.vec4.transformMat4(h,h,i),h[3]=Math.max(h[3],1e-5);const g=new ph(h[0]/h[3],h[1]/h[3],h[2]/h[3]);e.push(m),p.push(g)}c.push(e),u.push(p)}return[c,u]}(t,n,r,i,o,a,s,l,c):function(e,t,n,r,i){const o=[],a=[],s=i[8]*t,l=i[9]*t,c=i[10]*t,u=i[11]*t,h=i[8]*n,d=i[9]*n,p=i[10]*n,f=i[11]*n;for(const m of e){const e=[],t=[];for(const n of m){const o=n.x+r.x,a=n.y+r.y,m=i[0]*o+i[4]*a+i[12],g=i[1]*o+i[5]*a+i[13],y=i[2]*o+i[6]*a+i[14],_=i[3]*o+i[7]*a+i[15],v=m+s,x=g+l,b=y+c,w=Math.max(_+u,1e-5),S=m+h,T=g+d,E=y+p,A=Math.max(_+f,1e-5);e.push(new ph(v/w,x/w,b/w)),t.push(new ph(S/A,T/A,E/A))}o.push(e),a.push(t)}return[o,a]}(t,n,r,i,o)}(o,r,h,u,c,a,g,d,f,o.center.lat,e.tileID.canonical),v=e.queryGeometry;return function(e,t,n){let r=1/0;Dl(n,t)&&(r=ud(n,t[0]));for(let i=0;i<t.length;i++){const o=t[i],a=e[i];for(let e=0;e<o.length-1;e++){const t=o[e],i=[t,o[e+1],a[e+1],a[e],t];Ol(n,i)&&(r=Math.min(r,ud(n,i)))}}return r!==1/0&&r}(y,_,v.isPointQuery()?v.screenBounds:v.screenGeometry)}},line:class extends pa{constructor(e,t,n,r){const i=Nd();super(e,i,t,n,r),i.layout&&(this.layout=new Uo(i.layout)),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(e){if("line-gradient"===e){const e=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=e._styleExpression&&e._styleExpression.expression instanceof Br,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(e,t){super.recalculate(e,t),this.paint._values["line-floorwidth"]=(()=>{if(Ld)return Ld;const e=Nd();return Ld=new Dd(e.paint.properties["line-width"].specification),Ld.useIntegerZoom=!0,Ld})().possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)}createBucket(e){return new Sd(e)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(e,t,n){const r=jd(this);return{config:new Fs(this,{zoom:t,lut:n}),defines:r,overrideFog:!1}}queryRadius(e){const t=e,n=zd(Wl("line-width",this,t),Wl("line-gap-width",this,t)),r=Wl("line-offset",this,t);return n/2+Math.abs(r)+Xl(this.paint.get("line-translate"))}queryIntersectsFeature(e,t,n,r,i,o){if(e.queryGeometry.isAboveHorizon)return!1;const a=Yl(e.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),o.angle,e.pixelToTileUnitsFactor),s=e.pixelToTileUnitsFactor/2*zd(this.paint.get("line-width").evaluate(t,n),this.paint.get("line-gap-width").evaluate(t,n)),l=this.paint.get("line-offset").evaluate(t,n);return l&&(r=function(e,t){const n=[],r=new H(0,0);for(let i=0;i<e.length;i++){const o=e[i],a=[];for(let e=0;e<o.length;e++){const n=o[e],i=o[e+1],s=0===e?r:n.sub(o[e-1])._unit()._perp(),l=e===o.length-1?r:i.sub(n)._unit()._perp(),c=s._add(l)._unit();c._mult(1/(c.x*l.x+c.y*l.y)),a.push(c._mult(t)._add(n))}n.push(a)}return n}(r,l*e.pixelToTileUnitsFactor)),function(e,t,n){for(let r=0;r<t.length;r++){const i=t[r];if(e.length>=3)for(let t=0;t<i.length;t++)if(Ul(e,i[t]))return!0;if(Ll(e,i,n))return!0}return!1}(a,r,s)}isTileClipped(){return!0}isDraped(e){const t=this.layout.get("line-z-offset"),n=t.isConstant()&&!t.constantOr(0),r=this.layout.get("line-elevation-reference");return!("sea"===r||"ground"===r)&&(n||"none"!==r)}},symbol:rm,background:class extends pa{constructor(e,t,n,r){super(e,{layout:im||(im=new qo({visibility:new Go(Wo.layout_background.visibility)})),paint:om||(om=new qo({"background-pitch-alignment":new Go(Wo.paint_background["background-pitch-alignment"]),"background-color":new Go(Wo.paint_background["background-color"]),"background-pattern":new Go(Wo.paint_background["background-pattern"]),"background-opacity":new Go(Wo.paint_background["background-opacity"]),"background-emissive-strength":new Go(Wo.paint_background["background-emissive-strength"])}))},t,n,r)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(e,t,n){return{overrideFog:!1}}is3D(){return"viewport"===this.paint.get("background-pitch-alignment")}},raster:_m,"raster-particle":Tm,sky:class extends pa{constructor(e,t,n,r){super(e,{layout:bm||(bm=new qo({visibility:new Go(Wo.layout_sky.visibility)})),paint:wm||(wm=new qo({"sky-type":new Go(Wo.paint_sky["sky-type"]),"sky-atmosphere-sun":new Go(Wo.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Go(Wo.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Go(Wo.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Go(Wo.paint_sky["sky-gradient-radius"]),"sky-gradient":new Zo(Wo.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Go(Wo.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Go(Wo.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Go(Wo.paint_sky["sky-opacity"])}))},t,n,r),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(e){"sky-gradient"===e?this._updateColorRamp():"sky-atmosphere-sun"!==e&&"sky-atmosphere-halo-color"!==e&&"sky-atmosphere-color"!==e&&"sky-atmosphere-sun-intensity"!==e||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=lu({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(e){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const t=e.style.light.properties.get("position");return this._lightPosition.azimuthal!==t.azimuthal||this._lightPosition.polar!==t.polar}return!1}getCenter(e,t){if("atmosphere"===this.paint.get("sky-type")){const n=this.paint.get("sky-atmosphere-sun"),r=!n,i=e.style.light,o=i.properties.get("position");return r&&"viewport"===i.properties.get("anchor")&&fe("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),r?Am(o.azimuthal,90-o.polar,t):Am(n[0],90-n[1],t)}const n=this.paint.get("sky-gradient-center");return Am(n[0],90-n[1],t)}isSky(){return!0}markSkyboxValid(e){this._skyboxInvalidated=!1,this._lightPosition=e.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const e=this.paint.get("sky-type");return"atmosphere"===e?["skyboxCapture","skybox"]:"gradient"===e?["skyboxGradient"]:null}},slot:class extends pa{constructor(e,t,n,r){super(e,{paint:Sm||(Sm=new qo({}))},t,null)}},model:class extends pa{constructor(e,t,n,r){super(e,{layout:Km||(Km=new qo({visibility:new Go(Wo.layout_model.visibility),"model-id":new Ho(Wo.layout_model["model-id"])})),paint:Jm||(Jm=new qo({"model-opacity":new Go(Wo.paint_model["model-opacity"]),"model-rotation":new Ho(Wo.paint_model["model-rotation"]),"model-scale":new Ho(Wo.paint_model["model-scale"]),"model-translation":new Ho(Wo.paint_model["model-translation"]),"model-color":new Ho(Wo.paint_model["model-color"]),"model-color-mix-intensity":new Ho(Wo.paint_model["model-color-mix-intensity"]),"model-type":new Go(Wo.paint_model["model-type"]),"model-cast-shadows":new Go(Wo.paint_model["model-cast-shadows"]),"model-receive-shadows":new Go(Wo.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new Go(Wo.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new Ho(Wo.paint_model["model-emissive-strength"]),"model-roughness":new Ho(Wo.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new Ho(Wo.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new Go(Wo.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new Go(Wo.paint_model["model-front-cutoff"])}))},t,n,r),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(e){return new Ym(e)}getProgramIds(){return["model"]}is3D(){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(e){return e instanceof pg?Jn-1:0}queryIntersectsFeature(e,t,n,r,i,o){if(!this.modelManager)return!1;const a=this.modelManager,s=e.tile.getBucket(this);if(!(s&&s instanceof Ym))return!1;const l=s;for(const c in l.instancesPerModel){const n=l.instancesPerModel[c],r=void 0!==t.id?t.id:t.properties&&t.properties.hasOwnProperty("id")?t.properties.id:void 0;if(n.idToFeaturesIndex.hasOwnProperty(r)){const t=n.features[n.idToFeaturesIndex[r]],i=a.getModel(c,this.scope);if(!i)return!1;let s=B.mat4.create();const u=new il(0,0),h=l.canonical;let d=Number.MAX_VALUE;for(let r=0;r<t.instancedDataCount;++r){const a=16*(t.instancedDataOffset+r),l=n.instancedDataArray.float32,c=[l[a+4],l[a+5],l[a+6]];vg(h,u,l[a],0|l[a+1]),eg(s,i,o,u,t.rotation,t.scale,c,!1,!1,!1),"globe"===o.projection.name&&(s=Dm(s,o));const p=B.mat4.multiply([],o.projMatrix,s),f=e.queryGeometry,m=Lm(f.isPointQuery()?f.screenBounds:f.screenGeometry,o,p,i.aabb);null!=m&&(d=Math.min(m,d))}return d!==Number.MAX_VALUE&&d}}return!1}_handleOverridablePaintPropertyUpdate(e,t,n){return!(!this.layout||t.isDataDriven()||n.isDataDriven()||"model-color"!==e&&"model-color-mix-intensity"!==e&&"model-rotation"!==e&&"model-scale"!==e&&"model-translation"!==e&&"model-emissive-strength"!==e)}_isPropertyZoomDependent(e){const t=this._transitionablePaint._values[e];return null!=t&&null!=t.value&&null!=t.value.expression&&t.value.expression instanceof Qi}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}queryIntersectsMatchingFeature(e,t,n,r){const o=e.tile,a=o.getBucket(this);let s=null,l=Number.MAX_VALUE;if(!(a&&a instanceof pg))return{queryFeature:s,intersectionZ:l};const c=a.getNodesInfo()[t];if(c.hiddenByReplacement||!c.node.meshes||!n.filter(new No(o.tileID.overscaledZ),c.feature,o.tileID.canonical))return{queryFeature:s,intersectionZ:l};const u=c.node,h=r.calculatePosMatrix(o.tileID.toUnwrapped(),r.worldSize),d=c.evaluatedScale;let p=0;r.elevation&&u.elevation&&(p=u.elevation*r.elevation.exaggeration()),B.mat4.translate(h,h,[(u.anchor?u.anchor[0]:0)*(d[0]-1),(u.anchor?u.anchor[1]:0)*(d[1]-1),p]),B.mat4.scale(h,h,d);const f=e.queryGeometry,m=f.isPointQuery()?f.screenBounds:f.screenGeometry,g=function(e){const t=B.mat4.multiply([],h,e.matrix);B.mat4.multiply(t,r.expandedFarZProjMatrix,t);for(let n=0;n<e.meshes.length;++n){const i=e.meshes[n];if(n===e.lightMeshIndex)continue;const o=Lm(m,r,t,i.aabb);null!=o&&(l=Math.min(o,l))}if(e.children)for(const n of e.children)g(n)};if(g(u),l===Number.MAX_VALUE)return{queryFeature:s,intersectionZ:l};const y=new il(0,0);vg(o.tileID.canonical,y,c.node.anchor[0],c.node.anchor[1]);const{z:_,x:v,y:x}=o.tileID.canonical;return s=new _g({},_,v,x,c.feature.id),s.properties=c.feature.properties,s.geometry={type:"Point",coordinates:[y.lng,y.lat]},s.layer=i(i({},this.serialize()),{},{id:this.fqid}),s.state={},s.tile=o.tileID.canonical,{queryFeature:s,intersectionZ:l}}},clip:class extends pa{constructor(e,t,n,r){super(e,{layout:Gu||(Gu=new qo({"clip-layer-types":new Go(Wo.layout_clip["clip-layer-types"]),"clip-layer-scope":new Go(Wo.layout_clip["clip-layer-scope"])})),paint:Hu||(Hu=new qo({}))},t,n,r)}recalculate(e,t){super.recalculate(e,t)}createBucket(e){return new Wu(e)}isTileClipped(){return!0}is3D(){return!0}}};class bg{constructor(e){this._callback=e,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._callback()}),0))}remove(){this._channel=void 0,this._callback=()=>{}}}class wg{constructor(){this.tasks={},this.taskQueue=[],le(["process"],this),this.invoker=new bg(this.process),this.nextId=0}add(e,t){const n=this.nextId++,r=function(e){let{type:t,isSymbolTile:n,zoom:r}=e;return r=r||0,"message"===t?0:"maybePrepare"!==t||n?"parseTile"!==t||n?"parseTile"===t&&n?300-r:"maybePrepare"===t&&n?400-r:500:200-r:100-r}(t);if(0===r){try{e()}finally{}return null}return this.tasks[n]={fn:e,metadata:t,priority:r,id:n},this.taskQueue.push(n),this.invoker.trigger(),{cancel:()=>{delete this.tasks[n]}}}process(){try{if(this.taskQueue=this.taskQueue.filter((e=>!!this.tasks[e])),!this.taskQueue.length)return;const e=this.pick();if(null===e)return;const t=this.tasks[e];if(delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),!t)return;t.fn()}finally{}}pick(){let e=null,t=1/0;for(let r=0;r<this.taskQueue.length;r++){const n=this.tasks[this.taskQueue[r]];n.priority<t&&(t=n.priority,e=r)}if(null===e)return null;const n=this.taskQueue[e];return this.taskQueue.splice(e,1),n}remove(){this.invoker.remove()}}class Sg{constructor(e,t,n){this.target=e,this.parent=t,this.mapId=n,this.callbacks={},this.cancelCallbacks={},le(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new wg}send(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5?arguments[5]:void 0;const a=Math.round(1e18*Math.random()).toString(36).substring(0,10);n&&(n.metadata=o,this.callbacks[a]=n);const s=new Set;return this.target.postMessage({id:a,type:e,hasCallback:!!n,targetMapId:r,mustQueue:i,sourceMapId:this.mapId,data:uo(t,s)},s),{cancel:()=>{n&&delete this.callbacks[a],this.target.postMessage({id:a,type:"<cancel>",targetMapId:r,sourceMapId:this.mapId})}}}receive(e){const t=e.data,n=t.id;if(n&&(!t.targetMapId||this.mapId===t.targetMapId))if("<cancel>"===t.type){const e=this.cancelCallbacks[n];delete this.cancelCallbacks[n],e&&e.cancel()}else if(t.mustQueue||_e()){const e=this.callbacks[n],r=this.scheduler.add((()=>this.processTask(n,t)),e&&e.metadata||{type:"message"});r&&(this.cancelCallbacks[n]=r)}else this.processTask(n,t)}processTask(e,t){if(delete this.cancelCallbacks[e],"<response>"===t.type){const n=this.callbacks[e];delete this.callbacks[e],n&&(t.error?n(ho(t.error)):n(null,ho(t.data)))}else{const n=new Set,r=t.hasCallback?(t,r)=>{this.target.postMessage({id:e,type:"<response>",sourceMapId:this.mapId,error:t?uo(t):null,data:uo(r,n)},n)}:()=>{},i=ho(t.data);if(this.parent[t.type])this.parent[t.type](t.sourceMapId,i,r);else if(this.parent.getWorkerSource){const e=t.type.split(".");this.parent.getWorkerSource(t.sourceMapId,e[0],i.source,i.scope)[e[1]](i,r)}else r(new Error("Could not find function ".concat(t.type)))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}class Tg{constructor(e,t){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=ae();const n=this.workerPool.acquire(this.id);for(let r=0;r<n.length;r++){const e=new Tg.Actor(n[r],t,this.id);e.name="Worker ".concat(r),this.actors.push(e)}this.ready=!1,this.broadcast("checkIfReady",null,(()=>{this.ready=!0}))}broadcast(e,t,n){re(this.actors,((n,r)=>{n.send(e,t,r)}),n=n||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach((e=>{e.remove()})),this.actors=[],this.workerPool.release(this.id)}}Tg.Actor=Sg;class Eg{constructor(e){this.size=e,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(e,t){const n=this.toIdx(e,t);return{min:this.minimums[n],max:this.maximums[n]}}isLeaf(e,t){return this.leaves[this.toIdx(e,t)]}toIdx(e,t){return t*this.size+e}}function Ag(e,t,n,r){let i=0,o=Number.MAX_VALUE;for(let a=0;a<3;a++)if(Math.abs(r[a])<1e-15){if(n[a]<e[a]||n[a]>t[a])return null}else{const s=1/r[a];let l=(e[a]-n[a])*s,c=(t[a]-n[a])*s;if(l>c){const e=l;l=c,c=e}if(l>i&&(i=l),c<o&&(o=c),i>o)return null}return i}function Mg(e,t,n,r,i,o,a,s,l,c,u){const h=r-e,d=i-t,p=o-n,f=a-e,m=s-t,g=l-n,y=u[1]*g-u[2]*m,_=u[2]*f-u[0]*g,v=u[0]*m-u[1]*f,x=h*y+d*_+p*v;if(Math.abs(x)<1e-15)return null;const b=1/x,w=c[0]-e,S=c[1]-t,T=c[2]-n,E=(w*y+S*_+T*v)*b;if(E<0||E>1)return null;const A=S*p-T*d,M=T*h-w*p,P=w*d-S*h,k=(u[0]*A+u[1]*M+u[2]*P)*b;return k<0||E+k>1?null:(f*A+m*M+g*P)*b}function Pg(e,t,n){return(e-t)/(n-t)}function kg(e,t,n,r,i,o,a,s,l){const c=1<<n,u=o-r,h=a-i,d=(e+1)/c*u+r,p=(t+0)/c*h+i,f=(t+1)/c*h+i;s[0]=(e+0)/c*u+r,s[1]=p,l[0]=d,l[1]=f}class Cg{constructor(e){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=e,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const t=function(e){const t=Math.ceil(Math.log2(e.dim/8)),n=[];let r=Math.ceil(Math.pow(2,t));const i=1/r,o=(e,t,n,r,i)=>{const o=r?1:0,a=(e+1)*n-o,s=t*n,l=(t+1)*n-o;i[0]=e*n,i[1]=s,i[2]=a,i[3]=l};let a=new Eg(r);const s=[];for(let l=0;l<r*r;l++){o(l%r,Math.floor(l/r),i,!1,s);const t=Ig(s[0],s[1],e),n=Ig(s[2],s[1],e),c=Ig(s[2],s[3],e),u=Ig(s[0],s[3],e);a.minimums.push(Math.min(t,n,c,u)),a.maximums.push(Math.max(t,n,c,u)),a.leaves.push(1)}for(n.push(a),r/=2;r>=1;r/=2){const e=n[n.length-1];a=new Eg(r);for(let t=0;t<r*r;t++){o(t%r,Math.floor(t/r),2,!0,s);const n=e.getElevation(s[0],s[1]),i=e.getElevation(s[2],s[1]),l=e.getElevation(s[2],s[3]),c=e.getElevation(s[0],s[3]),u=e.isLeaf(s[0],s[1]),h=e.isLeaf(s[2],s[1]),d=e.isLeaf(s[2],s[3]),p=e.isLeaf(s[0],s[3]),f=Math.min(n.min,i.min,l.min,c.min),m=Math.max(n.max,i.max,l.max,c.max),g=u&&h&&d&&p;a.maximums.push(m),a.minimums.push(f),a.leaves.push(m-f<=5&&g?1:0)}n.push(a)}return n}(this.dem),n=t.length-1,r=t[n];this._addNode(r.minimums[0],r.maximums[0],r.leaves[0]),this._construct(t,0,0,n,0)}raycastRoot(e,t,n,r,i,o){let a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;return Ag([e,t,-100],[n,r,this.maximums[0]*a],i,o)}raycast(e,t,n,r,i,o){let a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;if(!this.nodeCount)return null;const s=this.raycastRoot(e,t,n,r,i,o,a);if(null==s)return null;const l=[],c=[],u=[],h=[],d=[{idx:0,t:s,nodex:0,nodey:0,depth:0}];for(;d.length>0;){const{idx:s,t:p,nodex:f,nodey:m,depth:g}=d.pop();if(this.leaves[s]){kg(f,m,g,e,t,n,r,u,h);const s=1<<g,l=(f+0)/s,c=(f+1)/s,d=(m+0)/s,y=(m+1)/s,_=Ig(l,d,this.dem)*a,v=Ig(c,d,this.dem)*a,x=Ig(c,y,this.dem)*a,b=Ig(l,y,this.dem)*a,w=Mg(u[0],u[1],_,h[0],u[1],v,h[0],h[1],x,i,o),S=Mg(h[0],h[1],x,u[0],h[1],b,u[0],u[1],_,i,o),T=Math.min(null!==w?w:Number.MAX_VALUE,null!==S?S:Number.MAX_VALUE);if(T!==Number.MAX_VALUE)return T;{const e=B.vec3.scaleAndAdd([],i,o,p);if(jg(_,v,b,x,Pg(e[0],u[0],h[0]),Pg(e[1],u[1],h[1]))>=e[2])return p}continue}let y=0;for(let d=0;d<this._siblingOffset.length;d++){kg((f<<1)+this._siblingOffset[d][0],(m<<1)+this._siblingOffset[d][1],g+1,e,t,n,r,u,h),u[2]=-100,h[2]=this.maximums[this.childOffsets[s]+d]*a;const p=Ag(u,h,i,o);if(null!=p){const e=p;l[d]=e;let t=!1;for(let n=0;n<y&&!t;n++)e>=l[c[n]]&&(c.splice(n,0,d),t=!0);t||(c[y]=d),y++}}for(let e=0;e<y;e++){const t=c[e];d.push({idx:this.childOffsets[s]+t,t:l[t],nodex:(f<<1)+this._siblingOffset[t][0],nodey:(m<<1)+this._siblingOffset[t][1],depth:g+1})}}return null}_addNode(e,t,n){return this.minimums.push(e),this.maximums.push(t),this.leaves.push(n),this.childOffsets.push(0),this.nodeCount++}_construct(e,t,n,r,i){if(1===e[r].isLeaf(t,n))return;this.childOffsets[i]||(this.childOffsets[i]=this.nodeCount);const o=r-1,a=e[o];let s=0,l=0;for(let c=0;c<this._siblingOffset.length;c++){const e=2*t+this._siblingOffset[c][0],r=2*n+this._siblingOffset[c][1],i=a.getElevation(e,r),o=a.isLeaf(e,r),u=this._addNode(i.min,i.max,o);o&&(s|=1<<c),l||(l=u)}for(let c=0;c<this._siblingOffset.length;c++)s&1<<c||this._construct(e,2*t+this._siblingOffset[c][0],2*n+this._siblingOffset[c][1],o,l+c)}}function jg(e,t,n,r,i,o){return kt(kt(e,n,o),kt(t,r,o),i)}function Ig(e,t,n){const r=n.dim,i=ee(e*r-.5,0,r-1),o=ee(t*r-.5,0,r-1),a=Math.floor(i),s=Math.floor(o),l=Math.min(a+1,r-1),c=Math.min(s+1,r-1);return jg(n.get(a,s),n.get(l,s),n.get(a,c),n.get(l,c),i-a,o-s)}const Og={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function Ng(e,t,n){return(256*e*256+256*t+n)/10-1e4}function Dg(e,t,n){return 256*e+t+n/256-32768}class Lg{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.uid=e,t.height!==t.width)throw new RangeError("DEM tiles must be square");if(n&&"mapbox"!==n&&"terrarium"!==n)return void fe('"'.concat(n,'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".'));this.stride=t.height;const i=this.dim=t.height-2,o=new Uint32Array(t.data.buffer);if(this.pixels=new Uint8Array(t.data.buffer),this.floatView=new Float32Array(t.data.buffer),this.borderReady=r,this._modifiedForSources={},!r){for(let e=0;e<i;e++)o[this._idx(-1,e)]=o[this._idx(0,e)],o[this._idx(i,e)]=o[this._idx(i-1,e)],o[this._idx(e,-1)]=o[this._idx(e,0)],o[this._idx(e,i)]=o[this._idx(e,i-1)];o[this._idx(-1,-1)]=o[this._idx(0,0)],o[this._idx(i,-1)]=o[this._idx(i-1,0)],o[this._idx(-1,i)]=o[this._idx(0,i-1)],o[this._idx(i,i)]=o[this._idx(i-1,i-1)]}const a="terrarium"===n?Dg:Ng;for(let s=0;s<o.length;++s){const e=4*s;this.floatView[s]=a(this.pixels[e],this.pixels[e+1],this.pixels[e+2])}this._timestamp=Le.now()}_buildQuadTree(){this._tree=new Cg(this)}get(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&(e=ee(e,-1,this.dim),t=ee(t,-1,this.dim));const n=this._idx(e,t);return this.floatView[n]}set(e,t,n){const r=this._idx(e,t),i=this.floatView[r];return this.floatView[r]=n,n-i}static getUnpackVector(e){return Og[e]}_idx(e,t){if(e<-1||e>=this.dim+1||t<-1||t>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(t+1)*this.stride+(e+1)}static pack(e,t){const n=[0,0,0,0],r=Lg.getUnpackVector(t);let i=Math.floor((e+r[3])/r[2]);return n[2]=i%256,i=Math.floor(i/256),n[1]=i%256,i=Math.floor(i/256),n[0]=i,n}getPixels(){return new su({width:this.stride,height:this.stride},this.pixels)}backfillBorder(e,t,n){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let r=t*this.dim,i=t*this.dim+this.dim,o=n*this.dim,a=n*this.dim+this.dim;switch(t){case-1:r=i-1;break;case 1:i=r+1}switch(n){case-1:o=a-1;break;case 1:a=o+1}const s=-t*this.dim,l=-n*this.dim;for(let c=o;c<a;c++)for(let t=r;t<i;t++){const n=4*this._idx(t,c),r=4*this._idx(t+s,c+l);this.pixels[n+0]=e.pixels[r+0],this.pixels[n+1]=e.pixels[r+1],this.pixels[n+2]=e.pixels[r+2],this.pixels[n+3]=e.pixels[r+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}function zg(e,t,n){1===e?t.headerLength=n.readFixed32():2===e?t.x=n.readVarint():3===e?t.y=n.readVarint():4===e?t.z=n.readVarint():5===e&&t.layers.push(function(e,t){return e.readFields(Ug,{version:0,name:"",units:"",tileSize:0,buffer:0,pixelFormat:0,dataIndex:[]},t)}(n,n.readVarint()+n.pos))}function Rg(e,t,n){1===e?(t.delta_filter=function(e,t){return e.readFields(Fg,{blockSize:0},t)}(n,n.readVarint()+n.pos),t.filter="delta_filter"):2===e?(n.readVarint(),t.filter="zigzag_filter"):3===e?(n.readVarint(),t.filter="bitshuffle_filter"):4===e&&(n.readVarint(),t.filter="byteshuffle_filter")}function Fg(e,t,n){1===e&&(t.blockSize=n.readVarint())}function Bg(e,t,n){1===e?(n.readVarint(),t.codec="gzip_data"):2===e?(n.readVarint(),t.codec="jpeg_image"):3===e?(n.readVarint(),t.codec="webp_image"):4===e&&(n.readVarint(),t.codec="png_image")}function Vg(e,t,n){let r=0,i=0;1===e?t.firstByte=n.readFixed64():2===e?t.lastByte=n.readFixed64():3===e?t.filters.push(function(e,t){return e.readFields(Rg,{},t)}(n,n.readVarint()+n.pos)):4===e?t.codec=function(e,t){return e.readFields(Bg,{},t)}(n,n.readVarint()+n.pos):5===e?i=n.readFloat():6===e?r=n.readFloat():7===e?t.bands.push(n.readString()):8===e?t.offset=n.readDouble():9===e&&(t.scale=n.readDouble()),0===t.offset&&(t.offset=i),0===t.scale&&(t.scale=r)}function Ug(e,t,n){1===e?t.version=n.readVarint():2===e?t.name=n.readString():3===e?t.units=n.readString():4===e?t.tileSize=n.readVarint():5===e?t.buffer=n.readVarint():6===e?t.pixelFormat=n.readVarint():7===e&&t.dataIndex.push(function(e,t){return e.readFields(Vg,{firstByte:0,lastByte:0,filters:[],codec:null,offset:0,scale:0,bands:[]},t)}(n,n.readVarint()+n.pos))}function Gg(e,t,n){if(2===e)!function(e,t,n){e.readFields(Hg,n,t)}(n,n.readVarint()+n.pos,t);else if(3===e)throw new Error("Not implemented")}function Hg(e,t,n){if(1===e){let e=0;const r=n.readVarint()+n.pos;for(;n.pos<r;)t[e++]=n.readVarint()}}so(Lg,"DEMData"),so(Cg,"DemMinMaxQuadTree",{omit:["dem"]});class Zg{constructor(e){this.capacity=e,this.cache=new Map}get(e){if(!this.cache.has(e))return;const t=this.cache.get(e);return this.cache.delete(e),this.cache.set(e,t),t}put(e,t){this.cache.has(e)?this.cache.delete(e):this.cache.size===this.capacity&&this.cache.delete(this.cache.keys().next().value),this.cache.set(e,t)}}function qg(e,t){if(4!==t.length)throw new Error("Expected data of dimension 4 but got ".concat(t.length,"."));let n=t[3];for(let r=2;r>=1;r--){const i=1===r?1:0,o=2===r?1:0;for(let r=0;r<t[0];r++){const a=t[1]*r;for(let r=i;r<t[1];r++){const i=t[2]*(r+a);for(let r=o;r<t[2];r++){const o=t[3]*(r+i);for(let r=0;r<t[3];r++){const t=o+r;e[t]+=e[t-n]}}}}n*=t[r]}return e}function Wg(e){for(let t=0,n=e.length;t<n;t++)e[t]=e[t]>>>1^-(1&e[t]);return e}function Xg(e,t){switch(t){case"uint32":return e;case"uint16":for(let t=0;t<e.length;t+=2){const n=e[t],r=e[t+1];e[t]=(240&n)>>4|(61440&n)>>8|(240&r)<<4|61440&r,e[t+1]=15&n|(3840&n)>>4|(15&r)<<8|(3840&r)<<4}return e;case"uint8":for(let t=0;t<e.length;t+=4){const n=e[t],r=e[t+1],i=e[t+2],o=e[t+3];e[t+0]=(192&n)>>6|(192&r)>>4|(192&i)>>2|192&o,e[t+1]=(48&n)>>4|(48&r)>>2|48&i|(48&o)<<2,e[t+2]=(12&n)>>2|12&r|(12&i)<<2|(12&o)<<4,e[t+3]=3&n|(3&r)<<2|(3&i)<<4|(3&o)<<6}return e;default:throw new Error('Invalid pixel format, "'.concat(t,'"'))}}var Yg=Uint8Array,Kg=Uint16Array,Jg=Int32Array,Qg=new Yg([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),$g=new Yg([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),ey=new Yg([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ty=function(e,t){for(var n=new Kg(31),r=0;r<31;++r)n[r]=t+=1<<e[r-1];var i=new Jg(n[30]);for(r=1;r<30;++r)for(var o=n[r];o<n[r+1];++o)i[o]=o-n[r]<<5|r;return{b:n,r:i}},ny=ty(Qg,2),ry=ny.b,iy=ny.r;ry[28]=258,iy[258]=28;for(var oy=ty($g,0).b,ay=new Kg(32768),sy=0;sy<32768;++sy){var ly=(43690&sy)>>1|(21845&sy)<<1;ay[sy]=((65280&(ly=(61680&(ly=(52428&ly)>>2|(13107&ly)<<2))>>4|(3855&ly)<<4))>>8|(255&ly)<<8)>>1}var cy=function(e,t,n){for(var r=e.length,i=0,o=new Kg(t);i<r;++i)e[i]&&++o[e[i]-1];var a,s=new Kg(t);for(i=1;i<t;++i)s[i]=s[i-1]+o[i-1]<<1;a=new Kg(1<<t);var l=15-t;for(i=0;i<r;++i)if(e[i])for(var c=i<<4|e[i],u=t-e[i],h=s[e[i]-1]++<<u,d=h|(1<<u)-1;h<=d;++h)a[ay[h]>>l]=c;return a},uy=new Yg(288);for(sy=0;sy<144;++sy)uy[sy]=8;for(sy=144;sy<256;++sy)uy[sy]=9;for(sy=256;sy<280;++sy)uy[sy]=7;for(sy=280;sy<288;++sy)uy[sy]=8;var hy=new Yg(32);for(sy=0;sy<32;++sy)hy[sy]=5;var dy=cy(uy,9),py=cy(hy,5),fy=function(e){for(var t=e[0],n=1;n<e.length;++n)e[n]>t&&(t=e[n]);return t},my=function(e,t,n){var r=t/8|0;return(e[r]|e[r+1]<<8)>>(7&t)&n},gy=function(e,t){var n=t/8|0;return(e[n]|e[n+1]<<8|e[n+2]<<16)>>(7&t)},yy=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],_y=function(e,t,n){var r=new Error(t||yy[e]);if(r.code=e,Error.captureStackTrace&&Error.captureStackTrace(r,_y),!n)throw r;return r},vy=new Yg(0),xy="undefined"!=typeof TextDecoder&&new TextDecoder;try{xy.decode(vy,{stream:!0})}catch(e){}const by={gzip_data:"gzip"};class wy extends Error{constructor(e){super(e),this.name="MRTError"}}const Sy={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},Ty={uint32:1,uint16:2,uint8:4},Ey={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};let Ay;class My{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=e}getLayer(e){const t=this.layers[e];if(!t)throw new wy("Layer '".concat(e,"' not found"));return t}getHeaderLength(e){const t=new Uint8Array(e),n=new DataView(e);if(13!==t[0])throw new wy("File is not a valid MRT.");return n.getUint32(1,!0)}parseHeader(e){const t=new Uint8Array(e),n=this.getHeaderLength(e);if(t.length<n)throw new wy("Expected header with length >= ".concat(n," but got buffer of length ").concat(t.length));const r=function(e){return e.readFields(zg,{headerLength:0,x:0,y:0,z:0,layers:[]},void 0)}(new Ay(t.subarray(0,n)));if(!isNaN(this.x)&&(this.x!==r.x||this.y!==r.y||this.z!==r.z))throw new wy("Invalid attempt to parse header ".concat(r.z,"/").concat(r.x,"/").concat(r.y," for tile ").concat(this.z,"/").concat(this.x,"/").concat(this.y));this.x=r.x,this.y=r.y,this.z=r.z;for(const i of r.layers)this.layers[i.name]=new Py(i,{cacheSize:this._cacheSize});return this}createDecodingTask(e){const t=[],n=this.getLayer(e.layerName);for(let r of e.blockIndices){const i=n.dataIndex[r],o=i.firstByte-e.firstByte,a=i.lastByte-e.firstByte;if(n._blocksInProgress.has(r))continue;const s={layerName:n.name,firstByte:o,lastByte:a,pixelFormat:n.pixelFormat,blockIndex:r,blockShape:[i.bands.length].concat(n.bandShape),buffer:n.buffer,codec:i.codec.codec,filters:i.filters.map((e=>e.filter))};n._blocksInProgress.add(r),t.push(s)}return new ky(t,(()=>{t.forEach((e=>n._blocksInProgress.delete(e.blockIndex)))}),((e,r)=>{if(t.forEach((e=>n._blocksInProgress.delete(e.blockIndex))),e)throw e;r.forEach((e=>{this.getLayer(e.layerName).processDecodedData(e)}))}))}}class Py{constructor(e,t){let{version:n,name:r,units:i,tileSize:o,pixelFormat:a,buffer:s,dataIndex:l}=e;if(this.version=n,1!==this.version)throw new wy("Cannot parse raster layer encoded with MRT version ".concat(n));this.name=r,this.units=i,this.tileSize=o,this.buffer=s,this.pixelFormat=Sy[a],this.dataIndex=l,this.bandShape=[o+2*s,o+2*s,Ty[this.pixelFormat]],this._decodedBlocks=new Zg(t?t.cacheSize:5),this._blocksInProgress=new Set}get dimension(){return Ty[this.pixelFormat]}get cacheSize(){return this._decodedBlocks.capacity}getBandList(){return this.dataIndex.map((e=>{let{bands:t}=e;return t})).flat()}processDecodedData(e){const t=e.blockIndex.toString();this._decodedBlocks.get(t)||this._decodedBlocks.put(t,e.data)}getBlockForBand(e){let t=0;switch(typeof e){case"string":for(const[n,r]of this.dataIndex.entries()){for(const[i,o]of r.bands.entries())if(o===e)return{bandIndex:t+i,blockIndex:n,blockBandIndex:i};t+=r.bands.length}break;case"number":for(const[n,r]of this.dataIndex.entries()){if(e>=t&&e<t+r.bands.length)return{bandIndex:e,blockIndex:n,blockBandIndex:e-t};t+=r.bands.length}break;default:throw new wy("Invalid band `".concat(JSON.stringify(e),"`. Expected string or integer."))}throw new wy("Band not found: ".concat(JSON.stringify(e)))}getDataRange(e){let t=1/0,n=-1/0;const r=[],i=new Set;for(const o of e){const{blockIndex:e}=this.getBlockForBand(o);if(e<0)throw new wy("Invalid band: ".concat(JSON.stringify(o)));const a=this.dataIndex[e];r.includes(e)||r.push(e),i.add(e),t=Math.min(t,a.firstByte),n=Math.max(n,a.lastByte)}if(i.size>this.cacheSize)throw new wy("Number of blocks to decode (".concat(i.size,") exceeds cache size (").concat(this.cacheSize,")."));return{layerName:this.name,firstByte:t,lastByte:n,blockIndices:r}}hasBand(e){const{blockIndex:t}=this.getBlockForBand(e);return t>=0}hasDataForBand(e){const{blockIndex:t}=this.getBlockForBand(e);return t>=0&&!!this._decodedBlocks.get(t.toString())}getBandView(e){const{blockIndex:t,blockBandIndex:n}=this.getBlockForBand(e),r=this._decodedBlocks.get(t.toString());if(!r)throw new wy("Data for band ".concat(JSON.stringify(e),' of layer "').concat(this.name,'" not decoded.'));const i=this.dataIndex[t],o=this.bandShape.reduce(((e,t)=>e*t),1),a=n*o,s=r.subarray(a,a+o);return{data:s,bytes:new Uint8Array(s.buffer).subarray(s.byteOffset,s.byteOffset+s.byteLength),tileSize:this.tileSize,buffer:this.buffer,pixelFormat:this.pixelFormat,dimension:this.dimension,offset:i.offset,scale:i.scale}}}My.setPbf=function(e){Ay=e};class ky{constructor(e,t,n){this.tasks=e,this._onCancel=t,this._onComplete=n,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(e,t){this._finalized||(this._onComplete(e,t),this._finalized=!0)}}My.performDecoding=function(e,t){const n=new Uint8Array(e);return Promise.all(t.tasks.map((e=>{const{layerName:t,firstByte:r,lastByte:i,pixelFormat:o,blockShape:a,blockIndex:s,filters:l,codec:c}=e,u=n.subarray(r,i+1),h=new Uint32Array(a[0]*a[1]*a[2]);let d;if("gzip_data"!==c)throw new wy("Unhandled codec: ".concat(c));return d=function(e,t){if(!globalThis.DecompressionStream&&"gzip_data"===t)return Promise.resolve(((o=function(e){31==e[0]&&139==e[1]&&8==e[2]||_y(6,"invalid gzip data");var t=e[3],n=10;4&t&&(n+=2+(e[10]|e[11]<<8));for(var r=(t>>3&1)+(t>>4&1);r>0;r-=!e[n++]);return n+(2&t)}(i=e))+8>i.length&&_y(6,"invalid gzip data"),function(e,t,n){var r=e.length;if(!r||t.f&&!t.l)return n||new Yg(0);var i=!n,o=i||2!=t.i,a=t.i;i&&(n=new Yg(3*r));var s,l,c=function(e){var t=n.length;if(e>t){var r=new Yg(Math.max(2*t,e));r.set(n),n=r}},u=t.f||0,h=t.p||0,d=t.b||0,p=t.l,f=t.d,m=t.m,g=t.n,y=8*r;do{if(!p){u=my(e,h,1);var _=my(e,h+1,3);if(h+=3,!_){var v=e[(C=4+((h+7)/8|0))-4]|e[C-3]<<8,x=C+v;if(x>r){a&&_y(0);break}o&&c(d+v),n.set(e.subarray(C,x),d),t.b=d+=v,t.p=h=8*x,t.f=u;continue}if(1==_)p=dy,f=py,m=9,g=5;else if(2==_){var b=my(e,h,31)+257,w=my(e,h+10,15)+4,S=b+my(e,h+5,31)+1;h+=14;for(var T=new Yg(S),E=new Yg(19),A=0;A<w;++A)E[ey[A]]=my(e,h+3*A,7);h+=3*w;var M=fy(E),P=(1<<M)-1,k=cy(E,M);for(A=0;A<S;){var C,j=k[my(e,h,P)];if(h+=15&j,(C=j>>4)<16)T[A++]=C;else{var I=0,O=0;for(16==C?(O=3+my(e,h,3),h+=2,I=T[A-1]):17==C?(O=3+my(e,h,7),h+=3):18==C&&(O=11+my(e,h,127),h+=7);O--;)T[A++]=I}}var N=T.subarray(0,b),D=T.subarray(b);m=fy(N),g=fy(D),p=cy(N,m),f=cy(D,g)}else _y(1);if(h>y){a&&_y(0);break}}o&&c(d+131072);for(var L=(1<<m)-1,z=(1<<g)-1,R=h;;R=h){var F=(I=p[gy(e,h)&L])>>4;if((h+=15&I)>y){a&&_y(0);break}if(I||_y(2),F<256)n[d++]=F;else{if(256==F){R=h,p=null;break}var B=F-254;F>264&&(B=my(e,h,(1<<(G=Qg[A=F-257]))-1)+ry[A],h+=G);var V=f[gy(e,h)&z],U=V>>4;if(V||_y(3),h+=15&V,D=oy[U],U>3){var G=$g[U];D+=gy(e,h)&(1<<G)-1,h+=G}if(h>y){a&&_y(0);break}o&&c(d+131072);var H=d+B;if(d<D){var Z=0-D,q=Math.min(D,H);for(Z+d<0&&_y(3);d<q;++d)n[d]=(void 0)[Z+d]}for(;d<H;++d)n[d]=n[d-D]}}t.l=p,t.p=R,t.b=d,t.f=u,p&&(u=1,t.m=m,t.d=f,t.n=g)}while(!u);return d!=n.length&&i?(s=n,(null==(l=d)||l>s.length)&&(l=s.length),new Yg(s.subarray(0,l))):n.subarray(0,d)}(i.subarray(o,-8),{i:2},new Yg(((n=i)[(r=n.length)-4]|n[r-3]<<8|n[r-2]<<16|n[r-1]<<24)>>>0))));var n,r,i,o;const a=by[t];if(!a)throw new Error("Unhandled codec: ".concat(t));const s=new globalThis.DecompressionStream(a);return new Response(new Blob([e]).stream().pipeThrough(s)).arrayBuffer().then((e=>new Uint8Array(e)))}(u,c).then((e=>(function(e,t){e.readFields(Gg,t)}(new Ay(e),h),new(0,Ey[o])(h.buffer)))),d.then((e=>{for(let t=l.length-1;t>=0;t--)switch(l[t]){case"delta_filter":qg(e,a);break;case"zigzag_filter":Wg(e);break;case"bitshuffle_filter":Xg(e,o);break;default:throw new wy('Unhandled filter "'.concat(l[t],'"'))}return{layerName:t,blockIndex:s,data:e}})).catch((e=>{throw e}))})))},so(ky,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]});var Cy={workerUrl:"",workerClass:null,workerParams:void 0};const jy="mapboxgl_preloaded_worker_pool";class Iy{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<Iy.workerCount;)this.workers.push(null!=Cy.workerClass?new Cy.workerClass:new self.Worker(Cy.workerUrl,Cy.workerParams));return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.workers&&0===this.numActive()&&(this.workers.forEach((e=>{e.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[jy]}numActive(){return Object.keys(this.active).length}}let Oy;function Ny(){return Oy||(Oy=new Iy),Oy}Iy.workerCount=2;let Dy,Ly,zy,Ry,Fy,By=null;function Vy(){return _e()&&self.worker&&self.worker.dracoUrl?self.worker.dracoUrl:Ly||Ae.DRACO_URL}function Uy(){if(_e()&&self.worker&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(Ry)return Ry;const e=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if("object"!=typeof WebAssembly)throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return Ry=WebAssembly.validate(e)?Ae.MESHOPT_SIMD_URL:Ae.MESHOPT_URL,Ry}const Gy={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},Hy={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},Zy={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function qy(e,t,n){const r=n.json.bufferViews.length,i=n.buffers.length;t.bufferView=r,n.json.bufferViews[r]={buffer:i,byteLength:e.byteLength},n.buffers[i]=e}const Wy="KHR_draco_mesh_compression";function Xy(e,t){const n=e.extensions&&e.extensions[Wy];if(!n)return;const r=new zy.Decoder,i=t_(t,n.bufferView),o=new zy.Mesh;if(!r.DecodeArrayToMesh(i,i.byteLength,o))throw new Error("Failed to decode Draco mesh");const a=t.json.accessors[e.indices],s=Gy[a.componentType],l=a.count*s.BYTES_PER_ELEMENT,c=zy._malloc(l);s===Uint16Array?r.GetTrianglesUInt16Array(o,l,c):r.GetTrianglesUInt32Array(o,l,c),qy(zy.memory.buffer.slice(c,c+l),a,t),zy._free(c);for(const u of Object.keys(n.attributes)){const i=r.GetAttributeByUniqueId(o,n.attributes[u]),a=t.json.accessors[e.attributes[u]],s=Hy[a.componentType],l=a.count*Zy[a.type]*Gy[a.componentType].BYTES_PER_ELEMENT,c=zy._malloc(l);r.GetAttributeDataArrayForAllPoints(o,i,zy[s],l,c),qy(zy.memory.buffer.slice(c,c+l),a,t),zy._free(c)}r.destroy(),o.destroy(),delete e.extensions[Wy]}const Yy="EXT_meshopt_compression";function Ky(e,t){if(!e.extensions||!e.extensions[Yy])return;const n=e.extensions[Yy],r=new Uint8Array(t.buffers[n.buffer],n.byteOffset||0,n.byteLength||0),i=new Uint8Array(n.count*n.byteStride);Fy.decodeGltfBuffer(i,n.count,n.byteStride,r,n.mode,n.filter),e.buffer=t.buffers.length,e.byteOffset=0,t.buffers[e.buffer]=i.buffer,delete e.extensions[Yy]}const Jy=1179937895,Qy=new TextDecoder("utf8");function $y(e,t){return new URL(e,t).href}function e_(e,t,n,r){return fetch($y(e.uri,r)).then((e=>e.arrayBuffer())).then((e=>{t.buffers[n]=e}))}function t_(e,t){const n=e.json.bufferViews[t];return new Uint8Array(e.buffers[n.buffer],n.byteOffset||0,n.byteLength)}function n_(e,t,n,r){if(e.uri){const i=$y(e.uri,r);return fetch(i).then((e=>e.blob())).then((e=>createImageBitmap(e))).then((e=>{t.images[n]=e}))}if(void 0!==e.bufferView){const r=t_(t,e.bufferView),i=new Blob([r],{type:e.mimeType});return createImageBitmap(i).then((e=>{t.images[n]=e}))}}function r_(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;const r={json:null,images:[],buffers:[]};if(new Uint32Array(e,t,1)[0]===Jy){const n=new Uint32Array(e,t);let i=2;const o=(n[i++]>>2)-3,a=n[i++]>>2;if(i++,r.json=JSON.parse(Qy.decode(n.subarray(i,i+a))),i+=a,i<o){const o=n[i++];i++;const a=t+(i<<2);r.buffers[0]=e.slice(a,a+o)}}else r.json=JSON.parse(Qy.decode(new Uint8Array(e,t)));const{buffers:i,images:o,meshes:a,extensionsUsed:s,bufferViews:l}=r.json;let c=Promise.resolve();if(i){const e=[];for(let t=0;t<i.length;t++){const o=i[t];o.uri?e.push(e_(o,r,t,n)):r.buffers[t]||(r.buffers[t]=null)}c=Promise.all(e)}return c.then((()=>{const e=[],t=s&&s.includes(Wy),i=s&&s.includes(Yy);if(t&&e.push(function(){if(!zy)return null!=Dy?Dy:(Dy=function(e){let t,n=null;function r(){t=new Uint8Array(n.buffer)}function i(){throw new Error("Unexpected Draco error.")}const o={a:{a:i,d:function(e,n,r){return t.copyWithin(e,n,n+r)},c:function(e){const i=t.length,o=Math.max(e>>>0,Math.ceil(1.2*i)),a=Math.ceil((o-i)/65536);try{return n.grow(a),r(),!0}catch(e){return!1}},b:i}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(e,o):e.then((e=>e.arrayBuffer())).then((e=>WebAssembly.instantiate(e,o)))).then((e=>{const{Rb:i,Qb:o,P:a,T:s,X:l,Ja:c,La:u,Qa:h,Va:d,Wa:p,eb:f,jb:m,f:g,e:y,yb:_,zb:v,Ab:x,Bb:b,Db:w,Gb:S}=e.instance.exports;n=y;const T=(()=>{let e=0,n=0,r=0,a=0;return s=>{r&&(i(a),i(e),n+=r,r=e=0),e||(n+=128,e=o(n));const l=s.length+7&-8;let c=e;l>=n&&(r=l,c=a=o(l));for(let e=0;e<s.length;e++)t[c+e]=s[e];return c}})();return r(),g(),{memory:y,_free:i,_malloc:o,Mesh:class{constructor(){this.ptr=a()}destroy(){s(this.ptr)}},Decoder:class{constructor(){this.ptr=c()}destroy(){m(this.ptr)}DecodeArrayToMesh(e,t,n){const r=T(e),i=u(this.ptr,r,t,n.ptr);return!!l(i)}GetAttributeByUniqueId(e,t){return{ptr:h(this.ptr,e.ptr,t)}}GetTrianglesUInt16Array(e,t,n){d(this.ptr,e.ptr,t,n)}GetTrianglesUInt32Array(e,t,n){p(this.ptr,e.ptr,t,n)}GetAttributeDataArrayForAllPoints(e,t,n,r,i){f(this.ptr,e.ptr,t.ptr,n,r,i)}},DT_INT8:_(),DT_UINT8:v(),DT_INT16:x(),DT_UINT16:b(),DT_UINT32:w(),DT_FLOAT32:S()}}))}(fetch(Vy())),Dy.then((e=>{zy=e,Dy=void 0})))}()),i&&e.push(function(){if(Fy)return;const e=function(e){let t;const n=WebAssembly.instantiateStreaming(e,{}).then((e=>{t=e.instance,t.exports.__wasm_call_ctors()})),r={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},i={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:n,supported:!0,decodeGltfBuffer(e,n,o,a,s,l){!function(e,t,n,r,i,o,a){const s=e.exports.sbrk,l=r+3&-4,c=s(l*i),u=s(o.length),h=new Uint8Array(e.exports.memory.buffer);h.set(o,u);const d=t(c,r,i,u,o.length);if(0===d&&a&&a(c,l,i),n.set(h.subarray(c,c+r*i)),s(c-s(0)),0!==d)throw new Error("Malformed buffer data: ".concat(d))}(t,t.exports[i[s]],e,n,o,a,t.exports[r[l]])}}}(fetch(Uy()));return e.ready.then((()=>{Fy=e}))}()),o)for(let a=0;a<o.length;a++)e.push(n_(o[a],r,a,n));return(e.length?Promise.all(e):Promise.resolve()).then((()=>{if(t&&a)for(const{primitives:e}of a)for(const t of e)Xy(t,r);if(i&&a&&l)for(const e of l)Ky(e,r);return r}))}))}function i_(e,t){const n=e.json.bufferViews[t.bufferView],r=Gy[t.componentType];return new r(e.buffers[n.buffer],(t.byteOffset||0)+(n.byteOffset||0),t.count*(n.byteStride&&n.byteStride!==Zy[t.type]*r.BYTES_PER_ELEMENT?n.byteStride/r.BYTES_PER_ELEMENT:Zy[t.type]))}function o_(e,t,n,r){const i=Gy[t.componentType],o=function(e){switch(e){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}}(i),a=e.json.bufferViews[t.bufferView],s=a.byteStride?a.byteStride/i.BYTES_PER_ELEMENT:Zy[t.type],l=n.float32,c=l.length/n.capacity;for(let u=0,h=0;u<t.count*s;u+=s,h+=c)for(let e=0;e<c;e++)l[h+e]=r[u+e]*o;n._trim()}function a_(e,t,n){const r=e.indices,i=e.attributes,o={};o.indexArray=new za;const a=t.json.accessors[r],s=a.count/3;o.indexArray.reserve(s);const l=i_(t,a);for(let d=0;d<s;d++)o.indexArray.emplaceBack(l[3*d],l[3*d+1],l[3*d+2]);o.indexArray._trim(),o.vertexArray=new Ea;const c=t.json.accessors[i.POSITION];o.vertexArray.reserve(c.count);const u=i_(t,c);for(let d=0;d<c.count;d++)o.vertexArray.emplaceBack(u[3*d],u[3*d+1],u[3*d+2]);if(o.vertexArray._trim(),o.aabb=new _c(c.min,c.max),o.centroid=function(e,t){const n=[0,0,0],r=e.length;if(r>0){for(let i=0;i<r;i++){const r=3*e[i];n[0]+=t[r],n[1]+=t[r+1],n[2]+=t[r+2]}n[0]/=r,n[1]/=r,n[2]/=r}return n}(l,u),void 0!==i.COLOR_0){const e=t.json.accessors[i.COLOR_0],n=Zy[e.type],r=i_(t,e);o.colorArray=3===n?new Ea:new Ta,o.colorArray.resize(e.count),o_(t,e,o.colorArray,r)}if(void 0!==i.NORMAL){o.normalArray=new Ea;const e=t.json.accessors[i.NORMAL];o.normalArray.resize(e.count);const n=i_(t,e);o_(t,e,o.normalArray,n)}if(void 0!==i.TEXCOORD_0&&n.length>0){o.texcoordArray=new Wa;const e=t.json.accessors[i.TEXCOORD_0];o.texcoordArray.resize(e.count);const n=i_(t,e);o_(t,e,o.texcoordArray,n)}if(void 0!==i._FEATURE_ID_RGBA4444){const e=t.json.accessors[i._FEATURE_ID_RGBA4444];t.json.extensionsUsed&&t.json.extensionsUsed.includes("EXT_meshopt_compression")&&(o.featureData=i_(t,e))}void 0!==i._FEATURE_RGBA4444&&(o.featureData=new Uint32Array(i_(t,t.json.accessors[i._FEATURE_RGBA4444]).buffer));const h=e.material;return o.material=function(e,t){const{emissiveFactor:n=[0,0,0],alphaMode:r="OPAQUE",alphaCutoff:i=.5,normalTexture:o,occlusionTexture:a,emissiveTexture:s,doubleSided:l}=e,{baseColorFactor:c=[1,1,1,1],metallicFactor:u=1,roughnessFactor:h=1,baseColorTexture:d,metallicRoughnessTexture:p}=e.pbrMetallicRoughness||{},f=a?t[a.index]:void 0;if(a&&a.extensions&&a.extensions.KHR_texture_transform&&f){const e=a.extensions.KHR_texture_transform;f.offsetScale=[e.offset[0],e.offset[1],e.scale[0],e.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new Mt(...c),metallicFactor:u,roughnessFactor:h,baseColorTexture:d?t[d.index]:void 0,metallicRoughnessTexture:p?t[p.index]:void 0},doubleSided:l,emissiveFactor:n,alphaMode:r,alphaCutoff:i,normalTexture:o?t[o.index]:void 0,occlusionTexture:f,emissionTexture:s?t[s.index]:void 0,defined:void 0===e.defined}}(void 0!==h?t.json.materials[h]:{defined:!1},n),o}function s_(e,t,n){const{matrix:r,rotation:i,translation:o,scale:a,mesh:s,extras:l,children:c}=e,u={};if(u.matrix=r||B.mat4.fromRotationTranslationScale([],i||[0,0,0,1],o||[0,0,0],a||[1,1,1]),void 0!==s){u.meshes=n[s];const e=u.anchor=[0,0];for(const t of u.meshes){const{min:n,max:r}=t.aabb;e[0]+=n[0]+r[0],e[1]+=n[1]+r[1]}e[0]=Math.floor(e[0]/u.meshes.length/2),e[1]=Math.floor(e[1]/u.meshes.length/2)}if(l&&(l.id&&(u.id=l.id),l.lights&&(u.lights=function(e){if(!e.length)return[];const t=function(e){const t=atob(e),n=new Uint8Array(t.length);for(let r=0;r<t.length;r++)n[r]=t.codePointAt(r);return n}(e),n=[],r=t.length/24,i=new Uint16Array(t.buffer),o=new Float32Array(t.buffer);for(let a=0;a<r;a++){const e=i[2*a*6]/30,t=i[2*a*6+1]/30,r=i[2*a*6+10]/100,s=o[6*a+1],l=o[6*a+2],c=o[6*a+3],u=o[6*a+4],h=c-s,d=u-l,p=Math.hypot(h,d);n.push({pos:[s+.5*h,l+.5*d,t],normal:[d/p,-h/p,0],width:p,height:e,depth:r,points:[s,l,c,u]})}return n}(l.lights))),c){const e=[];for(const r of c)e.push(s_(t.json.nodes[r],t,n));u.children=e}return u}function l_(e){if(0===e.vertices.length||0===e.indices.length)return null;const t=new Zu(e.vertices,e.indices,8,256),[n,r]=[t.min.clone(),t.max.clone()];return{vertices:e.vertices,indices:e.indices,grid:t,min:n,max:r}}function c_(e){if(!e.extras||!e.extras.ground)return null;const t=e.extras.ground;if(!t||!Array.isArray(t)||0===t.length)return null;const n=t[0];if(!n||!Array.isArray(n)||0===n.length)return null;const r=[];for(const a of n){if(!Array.isArray(a)||2!==a.length)continue;const e=a[0],t=a[1];"number"==typeof e&&"number"==typeof t&&r.push(new H(e,t))}if(r.length<3)return null;r.length>1&&r[r.length-1].equals(r[0])&&r.pop();let i=0;for(let a=0;a<r.length;a++){const e=r[a],t=r[(a+1)%r.length],n=r[(a+2)%r.length];i+=(e.x-t.x)*(n.y-t.y)-(n.x-t.x)*(e.y-t.y)}i>0&&r.reverse();const o=hu(r.flatMap((e=>[e.x,e.y])),[]);return 0===o.length?null:{vertices:r,indices:o}}function u_(e,t){const n=[],r=[];let i=0;const o=[];for(const a of e){i=n.length;const e=a.vertexArray.float32,s=a.indexArray.uint16;for(let r=0;r<a.vertexArray.length;r++)o[0]=e[3*r+0],o[1]=e[3*r+1],o[2]=e[3*r+2],B.vec3.transformMat4(o,o,t),n.push(new H(o[0],o[1]));for(let t=0;t<3*a.indexArray.length;t++)r.push(s[t]+i)}if(r.length%3!=0)return null;for(let a=0;a<r.length;a+=3){const e=n[r[a+0]],t=n[r[a+1]],i=n[r[a+2]];(e.x-t.x)*(i.y-t.y)-(i.x-t.x)*(e.y-t.y)>0&&([r[a+1],r[a+2]]=[r[a+2],r[a+1]])}return{vertices:n,indices:r}}function h_(e){const t=function(e,t){const n=[],r=WebGL2RenderingContext;if(e.json.textures)for(const i of e.json.textures){const o={magFilter:r.LINEAR,minFilter:r.NEAREST,wrapS:r.REPEAT,wrapT:r.REPEAT};void 0!==i.sampler&&Object.assign(o,e.json.samplers[i.sampler]),n.push({image:t[i.source],sampler:o,uploaded:!1})}return n}(e,e.images),n=function(e,t){const n=[];for(const r of e.json.meshes){const i=[];for(const n of r.primitives)i.push(a_(n,e,t));n.push(i)}return n}(e,t),{scenes:r,scene:i,nodes:o}=e.json,a=r?r[i||0].nodes:o,s=[];for(const l of a)s.push(s_(o[l],e,n));return function(e,t,n){const r={},i=new Set;for(let o=0;o<e.length;o++){const e=n[t[o]];if(!e.extras)continue;const a=e.extras["mapbox:footprint:version"],s=e.extras["mapbox:footprint:id"];(a||s)&&i.add(o),"1.0.0"===a&&s&&(r[s]=o)}for(let o=0;o<e.length;o++){if(i.has(o))continue;const a=e[o],s=n[t[o]];if(!s.extras)continue;let l=null;a.id in r&&(l=u_(e[r[a.id]].meshes,a.matrix)),l||(l=c_(s)),l&&(a.footprint=l_(l))}if(i.size>0){const t=Array.from(i.values()).sort(((e,t)=>e-t));for(let n=t.length-1;n>=0;n--)e.splice(t[n],1)}}(s,a,e.json.nodes),s}function d_(e){e.heightmap=new Float32Array(4096),e.heightmap.fill(-1);const t=e.vertexArray.float32,n=e.aabb.min[0]-1,r=e.aabb.min[1]-1,i=Qm/(e.aabb.max[0]-n+2),o=Qm/(e.aabb.max[1]-r+2);for(let a=0;a<t.length;a+=3){const s=t[a+2],l=(t[a+0]-n)*i|0,c=(t[a+1]-r)*o|0;s>e.heightmap[c*Qm+l]&&(e.heightmap[c*Qm+l]=s)}}function p_(e,t){const n={};n.indexArray=new za,n.indexArray.reserve(4*e.length),n.vertexArray=new Ea,n.vertexArray.reserve(10*e.length),n.colorArray=new Ta,n.vertexArray.reserve(10*e.length);let r=0;for(const a of e){const e=Math.min(10,Math.max(4,1.3*a.height))*t,i=[-a.normal[1],a.normal[0],0],o=Math.min(.29,.1*a.width/a.depth),s=a.width-2*a.depth*t*(o+.01),l=B.vec3.scaleAndAdd([],a.pos,i,s/2),c=B.vec3.scaleAndAdd([],a.pos,i,-s/2),u=[l[0],l[1],l[2]+a.height],h=[c[0],c[1],c[2]+a.height],d=B.vec3.scaleAndAdd([],a.normal,i,o);B.vec3.scale(d,d,e);const p=B.vec3.scaleAndAdd([],a.normal,i,-o);B.vec3.scale(p,p,e),B.vec3.add(d,l,d),B.vec3.add(p,c,p),l[2]+=.1,c[2]+=.1,n.vertexArray.emplaceBack(d[0],d[1],d[2]),n.vertexArray.emplaceBack(p[0],p[1],p[2]),n.vertexArray.emplaceBack(l[0],l[1],l[2]),n.vertexArray.emplaceBack(c[0],c[1],c[2]),n.vertexArray.emplaceBack(u[0],u[1],u[2]),n.vertexArray.emplaceBack(h[0],h[1],h[2]),n.vertexArray.emplaceBack(l[0],l[1],l[2]),n.vertexArray.emplaceBack(c[0],c[1],c[2]),n.vertexArray.emplaceBack(d[0],d[1],d[2]),n.vertexArray.emplaceBack(p[0],p[1],p[2]);const f=s/e/2;n.colorArray.emplaceBack(-f-o,-1,f,.8),n.colorArray.emplaceBack(f+o,-1,f,.8),n.colorArray.emplaceBack(-f,0,f,1.3),n.colorArray.emplaceBack(f,0,f,1.3),n.colorArray.emplaceBack(f+o,-.8,f,.7),n.colorArray.emplaceBack(f+o,-.8,f,.7),n.colorArray.emplaceBack(0,0,f,1.3),n.colorArray.emplaceBack(0,0,f,1.3),n.colorArray.emplaceBack(f+o,-1.2,f,.8),n.colorArray.emplaceBack(f+o,-1.2,f,.8),n.indexArray.emplaceBack(6+r,4+r,8+r),n.indexArray.emplaceBack(7+r,9+r,5+r),n.indexArray.emplaceBack(0+r,1+r,2+r),n.indexArray.emplaceBack(1+r,3+r,2+r),r+=10}const i={defined:!0,emissiveFactor:[0,0,0]},o={};return o.baseColorFactor=Mt.white,i.pbrMetallicRoughness=o,n.material=i,n.aabb=new _c([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),n}class f_{constructor(e){this._stringToNumber={},this._numberToString=[];for(let t=0;t<e.length;t++){const n=e[t];this._stringToNumber[n]=t,this._numberToString[t]=n}}encode(e){return this._stringToNumber[e]}decode(e){return this._numberToString[e]}}class m_{constructor(e,t){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new oo(Jn,16,0),this.featureIndexArray=new ss,this.promoteId=t,this.is3DTile=!1,this.serializedLayersCache=new Map}insert(e,t,n,r,i){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;const s=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(n,r,i,o);const l=this.grid;for(let c=0;c<t.length;c++){const e=t[c],n=[1/0,1/0,-1/0,-1/0];for(let t=0;t<e.length;t++){const r=e[t];n[0]=Math.min(n[0],r.x),n[1]=Math.min(n[1],r.y),n[2]=Math.max(n[2],r.x),n[3]=Math.max(n[3],r.y)}0!==a&&(n[0]-=a,n[1]-=a,n[2]+=a,n[3]+=a),n[0]<Jn&&n[1]<Jn&&n[2]>=0&&n[3]>=0&&l.insert(s,n[0],n[1],n[2],n[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new dh.VectorTile(new cp(this.rawTileData)).layers,this.sourceLayerCoder=new f_(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const e in this.vtLayers)this.vtFeatures[e]=[]}return this.vtLayers}query(e,t,n){var r=this;this.loadVTLayers(),this.serializedLayersCache.clear();const i=Jo(e.filter),o=e.tileResult,a=e.transform,s=o.bufferedTilespaceBounds,l=this.grid.query(s.min.x,s.min.y,s.max.x,s.max.y,((e,t,n,r)=>Gl(o.bufferedTilespaceGeometry,e,t,n,r)));l.sort(y_);let c=null;a.elevation&&l.length>0&&(c=ag.create(a.elevation,this.tileID));const u={};let h;for(let d=0;d<l.length;d++){const s=l[d];if(s===h)continue;h=s;const p=this.featureIndexArray.get(s);let f=null;if(this.is3DTile){const e=this.bucketLayerIDs[0][0],n=t[e];if("model"!==n.type)continue;const{queryFeature:r,intersectionZ:s}=n.queryIntersectsMatchingFeature(o,p.featureIndex,i,a);r&&this.appendToResult(u,e,p.featureIndex,r,s)}else this.loadMatchingFeature(u,p,i,e.layers,e.availableImages,t,n,(function(t,n,i){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return f||(f=Pl(t,r.tileID.canonical,e.tileTransform)),n.queryIntersectsFeature(o,t,i,f,r.z,e.transform,e.pixelPosMatrix,c,a)}))}return u}loadMatchingFeature(e,t,n,r,i,o,a,s){const{featureIndex:l,bucketIndex:c,sourceLayerIndex:u,layoutVertexArrayOffset:h}=t,d=this.bucketLayerIDs[c];if(r.length&&!function(e,t){for(let n=0;n<e.length;n++)if(t.indexOf(e[n])>=0)return!0;return!1}(r,d))return;const p=this.sourceLayerCoder.decode(u),f=this.vtLayers[p].feature(l);if(n.needGeometry){const e=kl(f,!0);if(!n.filter(new No(this.tileID.overscaledZ),e,this.tileID.canonical))return}else if(!n.filter(new No(this.tileID.overscaledZ),f))return;const m=this.getId(f,p);for(let g=0;g<d.length;g++){const t=d[g];if(r.length&&r.indexOf(t)<0)continue;const n=o[t];if(!n)continue;let c={};void 0!==m&&a&&(c=a.getState(n.sourceLayer||"_geojsonTileLayer",m));const u=!s||s(f,n,c,h);if(!u)continue;const p=new _g(f,this.z,this.x,this.y,m);let y=this.serializedLayersCache.get(t);y||(y=n.serialize(),y.id=t,this.serializedLayersCache.set(t,y)),p.layer=ie({},y),p.tile=this.tileID.canonical,p.layer.paint=g_(y.paint,n.paint,f,c,i),p.layer.layout=g_(y.layout,n.layout,f,c,i),this.appendToResult(e,t,l,p,u)}}appendToResult(e,t,n,r,i){let o=e[t];void 0===o&&(o=e[t]=[]),o.push({featureIndex:n,feature:r,intersectionZ:i})}lookupSymbolFeatures(e,t,n,r,i,o,a){const s={};this.loadVTLayers();const l=Jo(r);for(const c of e)this.loadMatchingFeature(s,{bucketIndex:t,sourceLayerIndex:n,featureIndex:c,layoutVertexArrayOffset:0},l,i,o,a);return s}loadFeature(e){const{featureIndex:t,sourceLayerIndex:n}=e;this.loadVTLayers();const r=this.sourceLayerCoder.decode(n),i=this.vtFeatures[r];if(i[t])return i[t];const o=this.vtLayers[r].feature(t);return i[t]=o,o}hasLayer(e){for(const t of this.bucketLayerIDs)for(const n of t)if(e===n)return!0;return!1}getId(e,t){let n=e.id;if(this.promoteId){const r="string"==typeof this.promoteId?this.promoteId:this.promoteId[t];null!=r&&(n=e.properties[r]),"boolean"==typeof n&&(n=Number(n))}return n}}function g_(e,t,n,r,i){return ue(e,((e,o)=>{const a=t instanceof Uo?t.get(o):null;return a&&a.evaluate?a.evaluate(n,r,i):a}))}function y_(e,t){return t-e}so(m_,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const __=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class v_{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[t,n]=new Uint8Array(e,0,2);if(219!==t)throw new Error("Data does not appear to be in a KDBush format.");const r=n>>4;if(1!==r)throw new Error("Got v".concat(r," data when expected v1."));const i=__[15&n];if(!i)throw new Error("Unrecognized array type.");const[o]=new Uint16Array(e,2,1),[a]=new Uint32Array(e,4,1);return new v_(a,o,i,e)}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:64,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Float64Array,r=arguments.length>3?arguments[3]:void 0;if(isNaN(e)||e<0)throw new Error("Unpexpected numItems value: ".concat(e,"."));this.numItems=+e,this.nodeSize=Math.min(Math.max(+t,2),65535),this.ArrayType=n,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const i=__.indexOf(this.ArrayType),o=2*e*this.ArrayType.BYTES_PER_ELEMENT,a=e*this.IndexArrayType.BYTES_PER_ELEMENT,s=(8-a%8)%8;if(i<0)throw new Error("Unexpected typed array class: ".concat(n,"."));r&&r instanceof ArrayBuffer?(this.data=r,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+a+s,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+o+a+s),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+a+s,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+i]),new Uint16Array(this.data,2,1)[0]=t,new Uint32Array(this.data,4,1)[0]=e)}add(e,t){const n=this._pos>>1;return this.ids[n]=n,this.coords[this._pos++]=e,this.coords[this._pos++]=t,n}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error("Added ".concat(e," items when expected ").concat(this.numItems,"."));return x_(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,t,n,r){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:i,coords:o,nodeSize:a}=this,s=[0,i.length-1,0],l=[];for(;s.length;){const c=s.pop()||0,u=s.pop()||0,h=s.pop()||0;if(u-h<=a){for(let a=h;a<=u;a++){const s=o[2*a],c=o[2*a+1];s>=e&&s<=n&&c>=t&&c<=r&&l.push(i[a])}continue}const d=h+u>>1,p=o[2*d],f=o[2*d+1];p>=e&&p<=n&&f>=t&&f<=r&&l.push(i[d]),(0===c?e<=p:t<=f)&&(s.push(h),s.push(d-1),s.push(1-c)),(0===c?n>=p:r>=f)&&(s.push(d+1),s.push(u),s.push(1-c))}return l}within(e,t,n){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:r,coords:i,nodeSize:o}=this,a=[0,r.length-1,0],s=[],l=n*n;for(;a.length;){const c=a.pop()||0,u=a.pop()||0,h=a.pop()||0;if(u-h<=o){for(let n=h;n<=u;n++)T_(i[2*n],i[2*n+1],e,t)<=l&&s.push(r[n]);continue}const d=h+u>>1,p=i[2*d],f=i[2*d+1];T_(p,f,e,t)<=l&&s.push(r[d]),(0===c?e-n<=p:t-n<=f)&&(a.push(h),a.push(d-1),a.push(1-c)),(0===c?e+n>=p:t+n>=f)&&(a.push(d+1),a.push(u),a.push(1-c))}return s}}function x_(e,t,n,r,i,o){if(i-r<=n)return;const a=r+i>>1;b_(e,t,a,r,i,o),x_(e,t,n,r,a-1,1-o),x_(e,t,n,a+1,i,1-o)}function b_(e,t,n,r,i,o){for(;i>r;){if(i-r>600){const a=i-r+1,s=n-r+1,l=Math.log(a),c=.5*Math.exp(2*l/3),u=.5*Math.sqrt(l*c*(a-c)/a)*(s-a/2<0?-1:1);b_(e,t,n,Math.max(r,Math.floor(n-s*c/a+u)),Math.min(i,Math.floor(n+(a-s)*c/a+u)),o)}const a=t[2*n+o];let s=r,l=i;for(w_(e,t,r,n),t[2*i+o]>a&&w_(e,t,r,i);s<l;){for(w_(e,t,s,l),s++,l--;t[2*s+o]<a;)s++;for(;t[2*l+o]>a;)l--}t[2*r+o]===a?w_(e,t,r,l):(l++,w_(e,t,l,i)),l<=n&&(r=l+1),n<=l&&(i=l-1)}}function w_(e,t,n,r){S_(e,n,r),S_(t,2*n,2*r),S_(t,2*n+1,2*r+1)}function S_(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function T_(e,t,n,r){const i=e-n,o=t-r;return i*i+o*o}e.$=zo,e.A=class extends Zm{},e.B=dn,e.C=It,e.D=Xo,e.E=St,e.F=Fi,e.G=Li,e.H=Ri,e.I=Vp,e.J=Yi,e.K=Yo,e.L=$i,e.M=Ki,e.N=Ir,e.O=Nr,e.P=H,e.Q=jr,e.R=tt,e.S=yn,e.T=hm,e.U=At,e.V=Zm,e.W=Ko,e.X=Bi,e.Y=zi,e.Z=function(e){const t=e.value;let n=[];if(!t)return n;const r=dn(t);return"string"!==r?(n=n.concat([new Zm(e.key,t,'string expected, "'.concat(r,'" found'))]),n):(qm(t,!0)||(n=n.concat([new Zm(e.key,t,'invalid url "'.concat(t,'"'))])),n)},e._=Wo,e.a=function(e){return Ae.API_CDN_URL_REGEX.test(e)},e.a$=va,e.a0=qo,e.a1=Go,e.a2=class{constructor(e){this.specification=e}possiblyEvaluate(e,t){return ye(e.expression.evaluate(t))}interpolate(e,t,n){return{x:kt(e.x,t.x,n),y:kt(e.y,t.y,n),z:kt(e.z,t.z,n),azimuthal:kt(e.azimuthal,t.azimuthal,n),polar:kt(e.polar,t.polar,n)}}},e.a3=No,e.a4=Qi,e.a5=xl,e.a6=B,e.a7=te,e.a8=Uo,e.a9=Rc,e.aA=ic,e.aB=_m,e.aC=Tm,e.aD=gm,e.aE=function(e,t){const n=document.createElement("video");n.muted=!0,n.onloadstart=function(){t(null,n)};for(let r=0;r<e.length;r++){const t=document.createElement("source");at(e[r])||(n.crossOrigin="Anonymous"),t.src=e[r],n.appendChild(t)}return{cancel:()=>{}}},e.aF=dm,e.aG=function(e){return fetch(e).then((e=>e.arrayBuffer())).then((t=>r_(t,0,e)))},e.aH=h_,e.aI=class{constructor(e,t,n,r){this.id=e,this.position=null!=t?new il(t[0],t[1]):new il(0,0),this.orientation=null!=n?n:[0,0,0],this.nodes=r,this.uploaded=!1,this.aabb=new _c([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(e,t){if(B.mat4.multiply(e.matrix,t,e.matrix),e.meshes)for(const n of e.meshes){const t=_c.applyTransformFast(n.aabb,e.matrix);this.aabb.encapsulate(t)}if(e.children)for(const n of e.children)this._applyTransformations(n,e.matrix)}computeBoundsAndApplyParent(){const e=B.mat4.identity([]);for(const t of this.nodes)this._applyTransformations(t,e)}computeModelMatrix(e,t,n,r,i,o){let a=arguments.length>6&&void 0!==arguments[6]&&arguments[6];eg(this.matrix,this,e.transform,this.position,t,n,r,i,o,a)}upload(e){if(!this.uploaded){for(const t of this.nodes)rg(t,e);for(const e of this.nodes)ig(e);this.uploaded=!0}}destroy(){for(const e of this.nodes)og(e)}},e.aJ=le,e.aK=function(e){return e.indexOf(ca)>=0},e.aL=vf,e.aM=dl,e.aN=pl,e.aO=ba,e.aP=za,e.aQ=ae,e.aR=$a,e.aS=Jf,e.aT=function(){Oo.isLoading()||Oo.isLoaded()||"deferred"!==jo()||Io()},e.aU=Jo,e.aV=kl,e.aW=_g,e.aX=ve,e.aY=Sd,e.aZ=Bu,e.a_=Pl,e.aa=kt,e.ab=Jn,e.ac=Ct,e.ad=class{constructor(e){this.specification=e}possiblyEvaluate(e,t){return function(e){let[t,n]=e;const r=ye([1,t,n]);return{x:r.x,y:r.y,z:r.z}}(e.expression.evaluate(t))}interpolate(e,t,n){return{x:kt(e.x,t.x,n),y:kt(e.y,t.y,n),z:kt(e.z,t.z,n)}}},e.ae=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const i=new H(n,n),o=e.sub(i),a=t.add(i),s=[o,new H(a.x,o.y),a,new H(o.x,a.y)];return r&&s.push(o.clone()),s},e.af=function(e,t){const n=[];for(let r=0;r<e.length;r++){const i=ne(r-1,-1,e.length-1),o=ne(r+1,-1,e.length-1),a=e[r],s=e[o],l=e[i].sub(a).unit(),c=s.sub(a).unit(),u=c.angleWithSep(l.x,l.y),h=l.add(c).unit().mult(-1*t/Math.sin(u/2));n.push(a.add(h))}return n},e.ag=xf,e.ah=Gl,e.ai=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return B.vec3.fromValues(((t.x-n)*e.scale-e.x)*Jn,(t.y*e.scale-e.y)*Jn,fl(t.z,t.y))},e.aj=hc,e.ak=Md,e.al=function(e){let t=1/0,n=1/0,r=-1/0,i=-1/0;for(const o of e)t=Math.min(t,o.x),n=Math.min(n,o.y),r=Math.max(r,o.x),i=Math.max(i,o.y);return{min:new H(t,n),max:new H(r,i)}},e.am=cl,e.an=Ul,e.ao=wl,e.ap=ee,e.aq=qs,e.ar=function(e,t){const n={};for(let r=0;r<t.length;r++){const i=t[r];i in e&&(n[i]=e[i])}return n},e.as=ol,e.at=ul,e.au=class{constructor(e){this.entries={},this.scheduler=e}request(e,t,n,r){const i=this.entries[e]=this.entries[e]||{callbacks:[]};if(i.result){const[e,n]=i.result;return this.scheduler?this.scheduler.add((()=>{r(e,n)}),t):r(e,n),()=>{}}return i.callbacks.push(r),i.cancel||(i.cancel=n(((n,r)=>{i.result=[n,r];for(const e of i.callbacks)this.scheduler?this.scheduler.add((()=>{e(n,r)}),t):e(n,r);setTimeout((()=>delete this.entries[e]),3e3)}))),()=>{i.result||(i.callbacks=i.callbacks.filter((e=>e!==r)),i.callbacks.length||(i.cancel(),delete this.entries[e]))}}},e.av=ua,e.aw=function(e,t,n){const r=JSON.stringify(e.request);return e.data&&(this.deduped.entries[r]={result:[null,e.data]}),this.deduped.request(r,{type:"parseTile",isSymbolTile:e.isSymbolTile,zoom:e.tileZoom},(t=>{const r=ot(e.request,((e,r,i,o)=>{e?t(e):r&&t(null,{vectorTile:n?void 0:new dh.VectorTile(new cp(r)),rawData:r,cacheControl:i,expires:o})}));return()=>{r.cancel(),t()}}),t)},e.ax=function(e){We++,We>Ve&&(e.getActor().send("enforceCacheSizeLimit",Be),We=0)},e.ay=De,e.az=function(e){return e<=1?1:Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},e.b=function(e){return Ae.API_FONTS_REGEX.test(e)},e.b$=dc,e.b0=qa,e.b1=uc,e.b2=ps,e.b3=hu,e.b4=lm,e.b5=function(e,t){const n=Rc(t.zoom);if(0===n)return Tc(e);const r=Pc(e),i=kc(r),o=cl(r.getWest())*t.worldSize,a=cl(r.getEast())*t.worldSize,s=ul(r.getNorth())*t.worldSize,l=ul(r.getSouth())*t.worldSize,c=[o,s,0],u=[a,s,0],h=[o,l,0],d=[a,l,0],p=B.mat4.invert([],t.globeMatrix);return B.vec3.transformMat4(c,c,p),B.vec3.transformMat4(u,u,p),B.vec3.transformMat4(h,h,p),B.vec3.transformMat4(d,d,p),i[0]=Ec(i[0],h,n),i[1]=Ec(i[1],d,n),i[2]=Ec(i[2],u,n),i[3]=Ec(i[3],c,n),_c.fromPoints(i)},e.b6=Oc,e.b7=Cc,e.b8=Ec,e.b9=xa,e.bA=Mt,e.bB=ne,e.bC=X,e.bD=be,e.bE=hl,e.bF=function(e,t,n){e[4*t+0]=n[0],e[4*t+1]=n[1],e[4*t+2]=n[2],e[4*t+3]=n[3]},e.bG=ks,e.bH=Ts,e.bI=Es,e.bJ=Ss,e.bK=ws,e.bL=il,e.bM=Vf,e.bN=rc,e.bO=yc,e.bP=Pm,e.bQ=nc,e.bR=Mc,e.bS=function(e,t,n,r,i,o,a,s,l){if("globe"===l.name)return Mc(e,t,new nc(n,r,i),!1);const c=vf({z:n,x:r,y:i},l);return new _c([(o+c.x/c.scale)*t,t*(c.y/c.scale),a],[(o+c.x2/c.scale)*t,t*(c.y2/c.scale),s])},e.bT=function(e,t,n){let r=0;for(let i=0;i<2;++i){const n=0;e[i]>n&&(r+=(e[i]-n)*(e[i]-n)),t[i]<n&&(r+=(n-t[i])*(n-t[i]))}return r},e.bU=ml,e.bV=Xs,e.bW=function(e){const t=B.mat4.identity(new Float64Array(16));B.mat4.multiply(t,e.pixelMatrix,e.globeMatrix);const n=[0,Qs,0],r=[0,$s,0];return B.vec3.transformMat4(n,n,t),B.vec3.transformMat4(r,r,t),[n[0]>0&&n[0]<=e.width&&n[1]>0&&n[1]<=e.height&&!Bc(e,new il(e.center.lat,90)),r[0]>0&&r[0]<=e.width&&r[1]>0&&r[1]<=e.height&&!Bc(e,new il(e.center.lat,-90))]},e.bX=function(e,t){const{scale:n}=e.tileTransform,r=n*Jn/(e.tileSize*Math.pow(2,t.zoom-e.tileID.overscaledZ+e.tileID.canonical.z));return B.mat2.scale(new Float32Array(4),t.inverseAdjustmentMatrix,[r,r])},e.bY=km,e.bZ=Mm,e.b_=function(e){const t=Mm(e,!0);return B.mat2.invert([],[t[0],t[1],t[4],t[5]])},e.ba=cc,e.bb=My,e.bc=cp,e.bd=ot,e.be=function(e){const t=[];for(const n in e)t.push(e[n]);return t},e.bf=function(e,t){const n=[];for(const r in e)r in t||n.push(r);return n},e.bg=re,e.bh=["type","source","source-layer","minzoom","maxzoom","filter","layout"],e.bi=Z,e.bj=function(e,t){const{x:n,y:r}=e.point,i=zc(n,r,e.worldSize/e._pixelsPerMercatorPixel,0,0);return B.mat4.multiply(i,i,Nc(Tc(t)))},e.bk=Jd,e.bl=mp,e.bm=Kd,e.bn=function(e,t,n,r,i){const o=5*t+2;e.float32[o+0]=n,e.float32[o+1]=r,e.float32[o+2]=i},e.bo=Wf,e.bp=Rp,e.bq=Ol,e.br=Wd,e.bs=vh,e.bt=Hm,e.bu=Ph,e.bv=kh,e.bw=cf,e.bx=lf,e.by=Ap,e.bz=v_,e.c=Pe,e.c$=ac,e.c0=function(e){const{x:t,y:n}=e.point,{lng:r,lat:i}=e._center;return zc(t,n,e.worldSize,r,i)},e.c1=Y,e.c2=oc,e.c3=Ws,e.c4=function(e){const t=Math.round((e+45+360)%360/90)%4;return K[t]},e.c5=45,e.c6=ll,e.c7=As,e.c8=function(e,t,n){const r=Math.sqrt(e*e+t*t+n*n),i=r>0?Math.acos(n/r)*W:0;let o=0!==e||0!==t?Math.atan2(-t,-e)*W+90:0;return o<0&&(o+=360),[r,o,i]},e.c9=vl,e.cA=function(e){const t=ml-5;e=ee(e,-t,t)/t*90;const n=Math.pow(Math.abs(Math.sin(X(e))),3);return Math.round(n*(Js.length-1))},e.cB=function(e,t,n,r){const i=t.getNorth(),o=t.getSouth(),a=t.getWest(),s=t.getEast(),l=1<<e.z,c=s-a,u=i-o,h=c/Ks,d=-u/Js[n],p=[0,h,0,d,0,0,i,a,0];if(e.z>0){const e=180/r;B.mat3.multiply(p,p,[e/c+1,0,0,0,e/u+1,0,-.5*e/h,.5*e/d,1])}return p[2]=l,p[5]=e.x,p[8]=e.y,p},e.cC=Tc,e.cD=function(e,t,n){const r=B.mat4.identity(new Float64Array(16)),i=(t/(1<<e)-.5)*Math.PI*2;return B.mat4.rotateY(r,n.globeMatrix,i),Float32Array.from(r)},e.cE=class{isDataAvailableAtPoint(e){const t=this._source();if(this.isUsingMockSource()||!t||e.y<0||e.y>1)return!1;const n=t.getSource().maxzoom,r=1<<n,i=Math.floor(e.x),o=Math.floor((e.x-i)*r),a=Math.floor(e.y*r),s=this.findDEMTileFor(new ic(n,i,n,o,a));return!(!s||!s.dem)}getAtPointOrZero(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.getAtPoint(e,t)||0}getAtPoint(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this.isUsingMockSource())return null;null==t&&(t=null);const r=this._source();if(!r)return t;if(e.y<0||e.y>1)return t;const i=r.getSource().maxzoom,o=1<<i,a=Math.floor(e.x),s=e.x-a,l=new ic(i,a,i,Math.floor(s*o),Math.floor(e.y*o)),c=this.findDEMTileFor(l);if(!c||!c.dem)return t;const u=c.dem,h=1<<c.tileID.canonical.z,d=(s*h-c.tileID.canonical.x)*u.dim,p=(e.y*h-c.tileID.canonical.y)*u.dim,f=Math.floor(d),m=Math.floor(p);return(n?this.exaggeration():1)*kt(kt(u.get(f,m),u.get(f,m+1),p-m),kt(u.get(f+1,m),u.get(f+1,m+1),p-m),d-f)}getAtTileOffset(e,t,n){const r=1<<e.canonical.z;return this.getAtPointOrZero(new xl(e.wrap+(e.canonical.x+t/Jn)/r,(e.canonical.y+n/Jn)/r))}getAtTileOffsetFunc(e,t,n,r){return i=>{const o=this.getAtTileOffset(e,i.x,i.y),a=r.upVector(e.canonical,i.x,i.y),s=r.upVectorScale(e.canonical,t,n).metersToTile;return B.vec3.scale(a,a,o*s),a}}getForTilePoints(e,t,n,r){if(this.isUsingMockSource())return!1;const i=ag.create(this,e,r);return!!i&&(t.forEach((e=>{e[2]=this.exaggeration()*i.getElevationAt(e[0],e[1],n)})),!0)}getMinMaxForTile(e){if(this.isUsingMockSource())return null;const t=this.findDEMTileFor(e);if(!t||!t.dem)return null;const n=t.dem.tree,r=t.tileID,i=1<<e.canonical.z-r.canonical.z;let o=e.canonical.x/i-r.canonical.x,a=e.canonical.y/i-r.canonical.y,s=0;for(let l=0;l<e.canonical.z-r.canonical.z&&!n.leaves[s];l++){o*=2,a*=2;const e=2*Math.floor(a)+Math.floor(o);s=n.childOffsets[s]+e,o%=1,a%=1}return{min:this.exaggeration()*n.minimums[s],max:this.exaggeration()*n.maximums[s]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(e,t,n){throw new Error("Pure virtual method called.")}pointCoordinate(e){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(e){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const e=this.visibleDemTiles;if(0===e.length)return null;let t=!1,n=Number.MAX_VALUE,r=Number.MIN_VALUE;for(const i of e){const e=this.getMinMaxForTile(i.tileID);e&&(n=Math.min(n,e.min),r=Math.max(r,e.max),t=!0)}return t?{min:n,max:r}:null}},e.cF=su,e.cG=vc,e.cH=function(e,t){return[Math.pow(e[0],2.2)*t,Math.pow(e[1],2.2)*t,Math.pow(e[2],2.2)*t]},e.cI=Lc,e.cJ=Ee,e.cK=Te,e.cL=256,e.cM=function(e,t){const n=[0,0,0],r=Oc(Tc(t.canonical));return B.vec3.transformMat4(n,n,r),B.vec3.transformMat4(n,n,e),n},e.cN=e=>({u_camera_to_center_distance:new Ss(e),u_extrude_scale:new Is(e),u_device_pixel_ratio:new Ss(e),u_matrix:new ks(e),u_inv_rot_matrix:new ks(e),u_merc_center:new Ts(e),u_tile_id:new Es(e),u_zoom_transition:new Ss(e),u_up_dir:new Es(e),u_emissive_strength:new Ss(e)}),e.cO=e=>({u_matrix:new ks(e),u_pixels_to_tile_units:new Is(e),u_device_pixel_ratio:new Ss(e),u_units_to_pixels:new Ts(e),u_dash_image:new ws(e),u_gradient_image:new ws(e),u_image_height:new Ss(e),u_texsize:new Ts(e),u_tile_units_to_pixels:new Ss(e),u_alpha_discard_threshold:new Ss(e),u_trim_offset:new Ts(e),u_trim_fade_range:new Ts(e),u_trim_color:new As(e),u_emissive_strength:new Ss(e),u_zbias_factor:new Ss(e),u_tile_to_meter:new Ss(e)}),e.cP=e=>({u_matrix:new ks(e),u_texsize:new Ts(e),u_pixels_to_tile_units:new Is(e),u_device_pixel_ratio:new Ss(e),u_image:new ws(e),u_units_to_pixels:new Ts(e),u_tile_units_to_pixels:new Ss(e),u_alpha_discard_threshold:new Ss(e),u_trim_offset:new Ts(e),u_emissive_strength:new Ss(e),u_zbias_factor:new Ss(e),u_tile_to_meter:new Ss(e)}),e.cQ=Da,e.cR=qd,e.cS=Qd,e.cT=Zc,e.cU=(e,t,n,r,i,o)=>{const a=e.transform,s="globe"===a.projection.name;let l;if("map"===o.paint.get("circle-pitch-alignment"))if(s){const e=Lc(a.zoom,t.canonical)*a._pixelsPerMercatorPixel;l=Float32Array.from([e,0,0,e])}else l=a.calculatePixelsToTileUnitsMatrix(n);else l=new Float32Array([a.pixelsToGLUnits[0],0,0,a.pixelsToGLUnits[1]]);const c={u_camera_to_center_distance:e.transform.getCameraToCenterDistance(a.projection),u_matrix:e.translatePosMatrix(t.projMatrix,n,o.paint.get("circle-translate"),o.paint.get("circle-translate-anchor")),u_device_pixel_ratio:Le.devicePixelRatio,u_extrude_scale:l,u_inv_rot_matrix:Hc,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:o.paint.get("circle-emissive-strength")};if(s){c.u_inv_rot_matrix=r,c.u_merc_center=i,c.u_tile_id=[t.canonical.x,t.canonical.y,1<<t.canonical.z],c.u_zoom_transition=Rc(a.zoom);const e=i[0]*Jn,n=i[1]*Jn;c.u_up_dir=a.projection.upVector(new nc(0,0,0),e,n)}return c},e.cV=jd,e.cW=(e,t,n,r,i,o)=>{const a=e.transform,s=a.pitch<15?Pd(.07,.7,ee((14-a.zoom)/5,0,1)):.07;return{u_matrix:Cd(e,t,n,r),u_texsize:t.imageAtlasTexture?t.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:a.calculatePixelsToTileUnitsMatrix(t),u_device_pixel_ratio:i,u_image:0,u_tile_units_to_pixels:kd(t,a),u_units_to_pixels:[1/a.pixelsToGLUnits[0],1/a.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:o,u_emissive_strength:n.paint.get("line-emissive-strength"),u_zbias_factor:s,u_tile_to_meter:vl(t.tileID.canonical,0)}},e.cX=(e,t,n,r,i,o,a)=>{const s=e.transform,l=s.calculatePixelsToTileUnitsMatrix(t),c=s.pitch<15?Pd(.07,.7,ee((14-s.zoom)/5,0,1)):.07;return{u_matrix:Cd(e,t,n,r),u_pixels_to_tile_units:l,u_device_pixel_ratio:o,u_units_to_pixels:[1/s.pixelsToGLUnits[0],1/s.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:i,u_texsize:Id(n)&&t.lineAtlasTexture?t.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:kd(t,e.transform),u_alpha_discard_threshold:0,u_trim_offset:a,u_trim_fade_range:n.paint.get("line-trim-fade-range"),u_trim_color:n.paint.get("line-trim-color").toRenderColor(n.lut).toArray01(),u_emissive_strength:n.paint.get("line-emissive-strength"),u_zbias_factor:c,u_tile_to_meter:vl(t.tileID.canonical,0)}},e.cY=se,e.cZ=lu,e.c_=id,e.ca=_c,e.cb=ye,e.cc=function(e){return[Math.pow(e[0],1/2.2),Math.pow(e[1],1/2.2),Math.pow(e[2],1/2.2)]},e.cd=function(e){return e({pluginStatus:Ao,pluginURL:Mo}),Co.on("pluginStateChange",e),e},e.ce=Tg,e.cf=Ny,e.cg=Xp,e.ch=Wp,e.ci=rt,e.cj=Po,e.ck=Re,e.cl=_t,e.cm=de,e.cn=function(e){const t=e.indexOf(ca);return t>=0?e.slice(0,t):e},e.co=function(e){const t=e.indexOf(ca);return t>=0?e.slice(t+1):""},e.cp=function(e){const t=[],n=e.id;return void 0===n&&t.push({message:"layers.".concat(n,': missing required property "id"')}),void 0===e.render&&t.push({message:"layers.".concat(n,': missing required method "render"')}),e.renderingMode&&"2d"!==e.renderingMode&&"3d"!==e.renderingMode&&t.push({message:"layers.".concat(n,': property "renderingMode" must be either "2d" or "3d"')}),t},e.cq=function(e,t,n,r){return"custom"===e.type?new Em(e,t):new xg[e.type](e,t,n,r)},e.cr=he,e.cs=Co,e.ct=it,e.cu=Ms,e.cv=class extends bs{constructor(e){super(e),this.current=Cs}set(e,t,n){if(this.fetchUniformLocation(e,t))for(let r=0;r<9;r++)if(n[r]!==this.current[r]){this.current=n,this.gl.uniformMatrix3fv(this.location,!1,n);break}}},e.cw=J,e.cx=function(e,t,n){const r=Rc(n.zoom),i=e.style.map._antialias,o=t.options.extStandardDerivativesForceOff||e.terrain&&e.terrain.exaggeration()>0;return 0===r&&!i&&!o},e.cy=function(e){const t=e.pixelsPerMeter,n=t/hl(1,e.center.lat),r=B.mat4.identity(new Float64Array(16));return B.mat4.translate(r,r,[e.point.x,e.point.y,0]),B.mat4.scale(r,r,[n,n,t]),Float32Array.from(r)},e.cz=Pc,e.d=function(e){return Ae.API_TILEJSON_REGEX.test(e)},e.d$=t,e.d0=Kh,e.d1=Rh,e.d2=450,e.d3=7,e.d4=ym,e.d5=ya,e.d6=Ka,e.d7=256,e.d8=Nc,e.d9=Ea,e.dA=Fc,e.dB=function(e){const t=[0,0,0],n=B.mat4.identity(new Float64Array(16));return B.mat4.multiply(n,e.pixelMatrix,e.globeMatrix),B.vec3.transformMat4(t,t,n),new H(t[0],t[1])},e.dC=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Ao===wo||Ao===So||Ao===To)throw new Error("setRTLTextPlugin cannot be called multiple times.");Mo=Le.resolveURL(e),Ao=wo,Eo=t,ko(),n||Io()},e.dD=jo,e.dE=function(){Ny().acquire(jy)},e.dF=function(){const e=Oy;e&&(e.isPreloaded()&&1===e.numActive()?(e.release(jy),Oy=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},e.dG=Iy,e.dH=function(e){const t=Ze();if(!t)return;const n=t.delete(Fe);e&&n.catch(e).then((()=>e()))},e.dI=Cy,e.dJ=Vy,e.dK=function(e){Ly=Le.resolveURL(e),By||(By=new Tg(Ny(),new St)),By.broadcast("setDracoUrl",Ly)},e.dL=Uy,e.dM=function(e){Ry=Le.resolveURL(e),By||(By=new Tg(Ny(),new St)),By.broadcast("setMeshoptUrl",Ry)},e.dN=so,e.dO=ou,e.dP=qp,e.dQ=f_,e.dR=m_,e.dS=vd,e.dT=ue,e.dU=Up,e.dV=function(e,t,n,r,i,o,a,s,l,c){let u=arguments.length>10&&void 0!==arguments[10]?arguments[10]:1,h=arguments.length>11?arguments[11]:void 0;e.createArrays(),e.tilePixelRatio=Jn/(512*e.overscaling),e.compareText={},e.iconsNeedLinear=!1;const d=e.layers[0].layout,p=e.layers[0]._unevaluatedLayout._values,f={};if(f.scaleFactor=u,f.textSizeScaleRange=d.get("text-size-scale-range"),f.iconSizeScaleRange=d.get("icon-size-scale-range"),f.textScaleFactor=ee(f.scaleFactor,f.textSizeScaleRange[0],f.textSizeScaleRange[1]),f.iconScaleFactor=ee(f.scaleFactor,f.iconSizeScaleRange[0],f.iconSizeScaleRange[1]),"composite"===e.textSizeData.kind){const{minZoom:t,maxZoom:n}=e.textSizeData;f.compositeTextSizes=[p["text-size"].possiblyEvaluate(new No(t),s),p["text-size"].possiblyEvaluate(new No(n),s)]}if("composite"===e.iconSizeData.kind){const{minZoom:t,maxZoom:n}=e.iconSizeData;f.compositeIconSizes=[p["icon-size"].possiblyEvaluate(new No(t),s),p["icon-size"].possiblyEvaluate(new No(n),s)]}f.layoutTextSize=p["text-size"].possiblyEvaluate(new No(l+1),s),f.layoutIconSize=p["icon-size"].possiblyEvaluate(new No(l+1),s),f.textMaxSize=p["text-size"].possiblyEvaluate(new No(18),s);const m="map"===d.get("text-rotation-alignment")&&"point"!==d.get("symbol-placement"),g=d.get("text-size");let y=!1;for(const _ of e.features)if(_.icon&&_.icon.nameSecondary){y=!0;break}for(const _ of e.features){const o=d.get("text-font").evaluate(_,{},s).join(","),l=g.evaluate(_,{},s)*f.textScaleFactor,u=f.layoutTextSize.evaluate(_,{},s)*f.textScaleFactor,p=(f.layoutIconSize.evaluate(_,{},s),{horizontal:{},vertical:void 0}),v=_.text;let x,b=[0,0];if(v){const r=v.toString(),a=d.get("text-letter-spacing").evaluate(_,{},s)*Wd,c=d.get("text-line-height").evaluate(_,{},s)*Wd,h=mo(r)?a:0,f=d.get("text-anchor").evaluate(_,{},s),g=d.get("text-variable-anchor");if(!g){const e=d.get("text-radial-offset").evaluate(_,{},s);b=e?lf(f,[e*Wd,af]):d.get("text-offset").evaluate(_,{},s).map((e=>e*Wd))}let y=m?"center":d.get("text-justify").evaluate(_,{},s);const x="point"===d.get("symbol-placement"),w=x?d.get("text-max-width").evaluate(_,{},s)*Wd:1/0,S=a=>{e.allowVerticalPlacement&&fo(r)&&(p.vertical=_p(v,t,n,i,o,w,c,f,a,h,b,mp.vertical,!0,u,l))};if(!m&&g){const e="auto"===y?g.map((e=>cf(e))):[y];let r=!1;for(let a=0;a<e.length;a++){const s=e[a];if(!p.horizontal[s])if(r)p.horizontal[s]=p.horizontal[0];else{const e=_p(v,t,n,i,o,w,c,"center",s,h,b,mp.horizontal,!1,u,l);e&&(p.horizontal[s]=e,r=1===e.positionedLines.length)}}S("left")}else{if("auto"===y&&(y=cf(f)),x||d.get("text-writing-mode").indexOf("horizontal")>=0||!fo(r)){const e=_p(v,t,n,i,o,w,c,f,y,h,b,mp.horizontal,!1,u,l);e&&(p.horizontal[y]=e)}S(x?"left":y)}}let w=!1;if(_.icon&&_.icon.namePrimary){const t=r[_.icon.namePrimary];t&&(x=Pp(i[_.icon.namePrimary],_.icon.nameSecondary?i[_.icon.nameSecondary]:void 0,d.get("icon-offset").evaluate(_,{},s),d.get("icon-anchor").evaluate(_,{},s)),w=t.sdf,void 0===e.sdfIcons?e.sdfIcons=t.sdf:e.sdfIcons!==t.sdf&&fe("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(t.pixelRatio!==e.pixelRatio||0!==d.get("icon-rotate").constantOr(1))&&(e.iconsNeedLinear=!0))}const S=ff(p.horizontal)||p.vertical;e.iconsInText||(e.iconsInText=!!S&&S.iconsInText),(S||x)&&uf(e,_,p,x,r,f,u,0,b,w,a,s,c,h,y)}o&&e.generateCollisionDebugBuffers(l,e.collisionBoxArray,f.textScaleFactor)},e.dW=dh,e.dX=Lg,e.dY=G,e.dZ=hh,e.d_=lp,e.da=Va,e.db=Ua,e.dc=function(e,t,n,r,i){return ee((e-t)/(n-t)*(i-r)+r,r,i)},e.dd=Ai,e.de=yl,e.df=class{constructor(e,t,n,r){this.context=e,this.format=r,this.size=n,this.texture=e.gl.createTexture();const[i,o,a]=this.size,{gl:s}=e;s.bindTexture(s.TEXTURE_3D,this.texture),e.pixelStoreUnpackFlipY.set(!1),e.pixelStoreUnpack.set(1),e.pixelStoreUnpackPremultiplyAlpha.set(!1),s.texImage3D(s.TEXTURE_3D,0,this.format,i,o,a,0,cm(this.format),um(this.format),t.data)}bind(e,t){const{context:n}=this,{gl:r}=n;r.bindTexture(r.TEXTURE_3D,this.texture),e!==this.minFilter&&(r.texParameteri(r.TEXTURE_3D,r.TEXTURE_MAG_FILTER,e),r.texParameteri(r.TEXTURE_3D,r.TEXTURE_MIN_FILTER,e),this.minFilter=e),t!==this.wrapS&&(r.texParameteri(r.TEXTURE_3D,r.TEXTURE_WRAP_S,t),r.texParameteri(r.TEXTURE_3D,r.TEXTURE_WRAP_T,t),this.wrapS=t)}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}},e.dg=Dm,e.dh=[1,1,1],e.di=ag,e.dj=$m,e.dk=Ia,e.dl=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[],this._globalClipBounds={min:new H(1/0,1/0),max:new H(-1/0,-1/0)}}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=Th(new H(0,0),new H(Jn,Jn),e),r=[];if(t&&!wh(n,this._globalClipBounds))return r;for(const i of this._activeRegions){if(i.hiddenByOverlap)continue;if(!wh(n,i))continue;const t=Eh(i.min,i.max,e);r.push({min:t.min,max:t.max,sourceId:this._sourceIds[i.priority],footprint:i.footprint,footprintTileId:i.tileId,order:i.order,clipMask:i.clipMask,clipScope:i.clipScope})}return r}setSources(e){this._setSources(e.map((e=>({getSourceId:()=>e.cache.id,getFootprints:()=>{const t=[];for(const n of e.cache.getVisibleCoordinates()){const r=e.cache.getTile(n).buckets[e.layer];r&&r.updateFootprints(n.toUnwrapped(),t)}return t},getOrder:()=>e.order,getClipMask:()=>e.clipMask,getClipScope:()=>e.clipScope}))))}_addSource(e){const t=e.getFootprints();if(0===t.length)return;const n=e.getOrder(),r=e.getClipMask(),i=e.getClipScope();for(const o of t){if(!o.footprint)continue;const e=Th(o.footprint.min,o.footprint.max,o.id);this._activeRegions.push({min:e.min,max:e.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:o.id,footprint:o.footprint,order:n,clipMask:r,clipScope:i})}this._sourceIds.push(e.getSourceId())}_computeReplacement(){this._activeRegions.sort(((e,t)=>e.priority-t.priority||xh(e.min,t.min)||xh(e.max,t.max)||e.order-t.order||e.clipMask-t.clipMask||function(e,t){const n=(e,t)=>e+t;return e.length-t.length||e.reduce(n,"").localeCompare(t.reduce(n,""))}(e.clipScope,t.clipScope)));let e=this._activeRegions.length!==this._prevRegions.length;if(!e){let t=0;for(;!e&&t!==this._activeRegions.length;){const n=this._activeRegions[t],r=this._prevRegions[t];e=n.priority!==r.priority||!bh(n,r)||n.order!==r.order||n.clipMask!==r.clipMask||!Z(n.clipScope,r.clipScope),++t}}if(e){++this._updateTime;for(const t of this._activeRegions)t.order!==_h&&(this._globalClipBounds.min.x=Math.min(this._globalClipBounds.min.x,t.min.x),this._globalClipBounds.min.y=Math.min(this._globalClipBounds.min.y,t.min.y),this._globalClipBounds.max.x=Math.max(this._globalClipBounds.max.x,t.max.x),this._globalClipBounds.max.y=Math.max(this._globalClipBounds.max.y,t.max.y));const e=e=>{const t=this._activeRegions;if(e>=t.length)return e;const n=t[e].priority;for(;e<t.length&&t[e].priority===n;)++e;return e};if(this._sourceIds.length>1){let t=0,n=e(t);for(;t!==n;){let r=t;const i=t;for(;r!==n;){const e=this._activeRegions[r];e.hiddenByOverlap=!1;for(let t=0;t<i;t++){const n=this._activeRegions[t];if(!n.hiddenByOverlap&&e.order===_h&&wh(e,n)&&(e.hiddenByOverlap=Mh(e.footprint,e.tileId,n.footprint,n.tileId),e.hiddenByOverlap))break}++r}t=n,n=e(t)}}}}_setSources(e){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let t=e.length-1;t>=0;t--)this._addSource(e[t]);this._computeReplacement()}},e.dm=class{constructor(e){this._createGrid(e),this._createPoles(e)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const e of this._poleSegments)e.destroy();for(const e of this._gridSegments)e.withSkirts.destroy(),e.withoutSkirts.destroy()}_fillGridMeshWithLods(e,t){const n=new va,r=new za,i=[],o=e+1+2,a=t[0]+1,s=t[0]+1+(1+t.length),l=(e,t,n)=>{let r=e===o-1?e-2:0===e?e:e-1;return r+=n?24575:0,[r,t]};for(let c=0;c<o;++c)n.emplaceBack(...l(c,0,!0));for(let c=0;c<a;++c)for(let e=0;e<o;++e)n.emplaceBack(...l(e,c,(0===e||e===o-1)&&!0));for(let c=0;c<t.length;++c){const e=t[c];for(let t=0;t<o;++t)n.emplaceBack(...l(t,e,!0))}for(let c=0;c<t.length;++c){const e=r.length,a=t[c]+1+2,l=new za;for(let n=0;n<a-1;n++){const e=n===a-2,i=e?o*(s-t.length+c-n):o;for(let t=0;t<o-1;t++){const a=n*o+t;0===n||e||0===t||t===o-2?(l.emplaceBack(a+1,a,a+i),l.emplaceBack(a+i,a+i+1,a+1)):(r.emplaceBack(a+1,a,a+i),r.emplaceBack(a+i,a+i+1,a+1))}}const u=ps.simpleSegment(0,e,n.length,r.length-e);for(let t=0;t<l.uint16.length;t+=3)r.emplaceBack(l.uint16[t],l.uint16[t+1],l.uint16[t+2]);const h=ps.simpleSegment(0,e,n.length,r.length-e);i.push({withoutSkirts:u,withSkirts:h})}return{vertices:n,indices:r,segments:i}}_createGrid(e){const t=this._fillGridMeshWithLods(Ks,Js);this._gridSegments=t.segments,this._gridBuffer=e.createVertexBuffer(t.vertices,uc.members),this._gridIndexBuffer=e.createIndexBuffer(t.indices,!0)}_createPoles(e){const t=new za;for(let a=0;a<=Ks;a++)t.emplaceBack(0,a+1,a+2);this._poleIndexBuffer=e.createIndexBuffer(t,!0);const n=new Va,r=new Va,i=new Va,o=new Va;this._poleSegments=[];for(let a=0,s=0;a<Ws;a++){const e=360/(1<<a);n.emplaceBack(0,-qs,0,.5,0),r.emplaceBack(0,-qs,0,.5,1),i.emplaceBack(0,-qs,0,.5,.5),o.emplaceBack(0,-qs,0,.5,.5);for(let t=0;t<=Ks;t++){let a=t/Ks,s=0;const l=kt(0,e,a),[c,u,h]=el(Uc,Gc,l,qs);n.emplaceBack(c,u,h,a,s),r.emplaceBack(c,u,h,a,1-s);const d=X(l);a=.5+.5*Math.sin(d),s=.5+.5*Math.cos(d),i.emplaceBack(c,u,h,a,s),o.emplaceBack(c,u,h,a,1-s)}this._poleSegments.push(ps.simpleSegment(s,0,66,64)),s+=66}this._poleNorthVertexBuffer=e.createVertexBuffer(n,lc,!1),this._poleSouthVertexBuffer=e.createVertexBuffer(r,lc,!1),this._texturedPoleNorthVertexBuffer=e.createVertexBuffer(i,lc,!1),this._texturedPoleSouthVertexBuffer=e.createVertexBuffer(o,lc,!1)}getGridBuffers(e,t){return[this._gridBuffer,this._gridIndexBuffer,t?this._gridSegments[e].withSkirts:this._gridSegments[e].withoutSkirts]}getPoleBuffers(e,t){return[t?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,t?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[e]]}},e.dn=_h,e.dp=Q,e.dq=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},e.dr=$,e.ds=_l,e.dt=tl,e.du=function(e){let[t,n,r]=e;const i=Math.hypot(t,n,r),o=Math.atan2(t,r),a=.5*Math.PI-Math.acos(-n/i);return new il(Y(o),Y(a))},e.dv=jm,e.dw=nl,e.dx=function(e){const t=e.navigator?e.navigator.userAgent:null;return!!function(e){if(null==xe){const t=e.navigator?e.navigator.userAgent:null;xe=!!e.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return xe}(e)&&t&&(t.match("Version/15.4")||t.match("Version/15.5")||t.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},e.dy=function(e,t){Be=e,Ve=t},e.dz=Bc,e.e=Ae,e.e0=function(e){let t=0;if(new Uint32Array(e,0,1)[0]!==Jy){const n=new Uint32Array(e,0,7),[,,r,i,o,a]=n;t=n.byteLength+i+o+a+o,(r!==e.byteLength||t>=e.byteLength)&&fe("Invalid b3dm header information.")}return r_(e,t)},e.e1=function(e,t){const n=h_(e);for(const r of n){for(const e of r.meshes)d_(e);r.lights&&(r.lightMeshIndex=r.meshes.length,r.meshes.push(p_(r.lights,t)))}return n},e.e2=pg,e.e3=Sg,e.e4=Oo,e.e5=function(e){qe(),null!=Ge&&Ge.then((t=>{t.keys().then((n=>{for(let r=0;r<n.length-e;r++)t.delete(n[r])}))}))},e.f=function(e){return 0===e.indexOf("mapbox:")},e.g=function(e,t){return it(ie(e,{method:"GET"}),t)},e.h=Me,e.i=function(e){return Ae.API_STYLE_REGEX.test(e)&&!Pe(e)},e.j=function(e){return decodeURIComponent(atob(e).split("").map((e=>"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2))).join(""))},e.k=function(e){return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,((e,t)=>String.fromCharCode(Number("0x"+t)))))},e.l=ie,e.m=Xe,e.n=function(e,t){return it(ie(e,{type:"json"}),t)},e.o=ut,e.p=function(e,t){return it(ie(e,{method:"POST"}),t)},e.q=Le,e.r=au,e.s=function(e){try{const t=self[e];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch(e){return!1}},e.t=xt,e.u=function(){return function e(t){return t?(t^Math.random()*(16>>t/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,e)}()},e.v=function(e){return!!e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)},e.w=fe,e.x=vt,e.y=2,e.z=Fp})),s(["./shared"],(function(e){function t(e){const t=e?e.url.toString():void 0;return t?performance.getEntriesByName(t):[]}function n(e){if("number"==typeof e||"boolean"==typeof e||"string"==typeof e||null==e)return JSON.stringify(e);if(Array.isArray(e)){let t="[";for(const r of e)t+="".concat(n(r),",");return"".concat(t,"]")}let t="{";for(const r of Object.keys(e).sort())t+="".concat(r,":").concat(n(e[r]),",");return"".concat(t,"}")}function r(t){let r="";for(const i of e.bh)r+="/".concat(n(t[i]));return r}class i{constructor(e){this.keyCache={},this._layers={},this._layerConfigs={},e&&this.replace(e)}replace(e,t){this._layerConfigs={},this._layers={},this.update(e,[],t)}update(t,n,i){this._options=i;for(const r of t)this._layerConfigs[r.id]=r,(this._layers[r.id]=e.cq(r,this.scope,null,this._options)).compileFilter(i),this.keyCache[r.id]&&delete this.keyCache[r.id];for(const e of n)delete this.keyCache[e],delete this._layerConfigs[e],delete this._layers[e];this.familiesBySource={};const o=function(e,t){const n={};for(let o=0;o<e.length;o++){const i=t&&t[e[o].id]||r(e[o]);t&&(t[e[o].id]=i);let a=n[i];a||(a=n[i]=[]),a.push(e[o])}const i=[];for(const r in n)i.push(n[r]);return i}(e.be(this._layerConfigs),this.keyCache);for(const e of o){const t=e.map((e=>this._layers[e.id])),n=t[0];if("none"===n.visibility)continue;const r=n.source||"";let i=this.familiesBySource[r];i||(i=this.familiesBySource[r]={});const o=n.sourceLayer||"_geojsonTileLayer";let a=i[o];a||(a=i[o]=[]),a.push(t)}}}const o=1*e.dP;class a{constructor(t){const n={},r=[];for(const e in t){const i=t[e],a=n[e]={};for(const e in i.glyphs){const t=i.glyphs[+e];if(!t||0===t.bitmap.width||0===t.bitmap.height)continue;const n=t.metrics.localGlyph?o:1,s={x:0,y:0,w:t.bitmap.width+2*n,h:t.bitmap.height+2*n};r.push(s),a[e]=s}}const{w:i,h:a}=e.z(r),s=new e.dO({width:i||1,height:a||1});for(const l in t){const r=t[l];for(const t in r.glyphs){const i=r.glyphs[+t];if(!i||0===i.bitmap.width||0===i.bitmap.height)continue;const a=n[l][t],c=i.metrics.localGlyph?o:1;e.dO.copy(i.bitmap,s,{x:0,y:0},{x:a.x+c,y:a.y+c},i.bitmap)}}this.image=s,this.positions=n}}e.dN(a,"GlyphAtlas");class s{constructor(t){this.tileID=new e.aA(t.tileID.overscaledZ,t.tileID.wrap,t.tileID.canonical.z,t.tileID.canonical.x,t.tileID.canonical.y),this.tileZoom=t.tileZoom,this.uid=t.uid,this.zoom=t.zoom,this.lut=t.lut,this.canonical=t.tileID.canonical,this.pixelRatio=t.pixelRatio,this.tileSize=t.tileSize,this.source=t.source,this.scope=t.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=t.showCollisionBoxes,this.collectResourceTiming=!!t.request&&t.request.collectResourceTiming,this.promoteId=t.promoteId,this.isSymbolTile=t.isSymbolTile,this.tileTransform=e.aL(t.tileID.canonical,t.projection),this.projection=t.projection,this.worldview=t.worldview,this.localizableLayerIds=t.localizableLayerIds,this.brightness=t.brightness,this.extraShadowCaster=!!t.extraShadowCaster,this.tessellationStep=t.tessellationStep,this.scaleFactor=t.scaleFactor}parse(t,n,r,i,o){this.status="parsing",this.data=t,this.collisionBoxArray=new e.aR;const s=new e.dQ(Object.keys(t.layers).sort()),c=new e.dR(this.tileID,this.promoteId);c.bucketLayerIDs=[];const u={},h=new e.dS(256,256),d={featureIndex:c,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:h,availableImages:r,brightness:this.brightness},p=n.familiesBySource[this.source];for(const a in p){const n=t.layers[a];if(!n)continue;let i=!1,o=!1,h=!1;for(const e of p[a])"symbol"===e[0].type?i=!0:o=!0,e[0].is3D()&&"model"!==e[0].type&&(h=!0);if(this.extraShadowCaster&&!h)continue;if(!0===this.isSymbolTile&&!i)continue;if(!1===this.isSymbolTile&&!o)continue;1===n.version&&e.w('Vector tile source "'.concat(this.source,'" layer "').concat(a,'" does not use vector tile spec v2 and therefore may have some rendering errors.'));const f=s.encode(a),m=[];for(let e=0,t=0;e<n.length;e++){const r=n.feature(e),i=c.getId(r,a);if(this.localizableLayerIds&&this.localizableLayerIds.has(a)){const e=r.properties?r.properties.worldview:null;if(this.worldview&&"string"==typeof e)if("all"===e)r.properties.$localized=!0;else{if(!e.split(",").includes(this.worldview))continue;r.properties.$localized=!0,r.properties.worldview=this.worldview}}m.push({feature:r,id:i,index:t,sourceLayerIndex:f}),t++}for(const t of p[a]){const n=t[0];(!this.extraShadowCaster||n.is3D()&&"model"!==n.type)&&(void 0!==this.isSymbolTile&&"symbol"===n.type!==this.isSymbolTile||n.minzoom&&this.zoom<Math.floor(n.minzoom)||n.maxzoom&&this.zoom>=n.maxzoom||"none"!==n.visibility&&(l(t,this.zoom,d.brightness,r),(u[n.id]=n.createBucket({index:c.bucketLayerIDs.length,layers:t,zoom:this.zoom,lut:this.lut,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:f,sourceID:this.source,projection:this.projection.spec,tessellationStep:this.tessellationStep})).populate(m,d,this.tileID.canonical,this.tileTransform),c.bucketLayerIDs.push(t.map((t=>e.av(t.id,t.scope))))))}}let f,m,g,y;h.trim();const _={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},v=()=>{if(f)return this.status="done",o(f);if(this.extraShadowCaster)this.status="done",o(null,{buckets:e.be(u).filter((e=>!e.isEmpty())),featureIndex:c,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:d.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(m&&g&&y){const t=new a(m),n=new e.dU(g,y,this.lut);for(const i in u){const o=u[i];o instanceof e.aS?(l(o.layers,this.zoom,d.brightness,r),e.dV(o,m,t.positions,g,n.iconPositions,this.showCollisionBoxes,r,this.tileID.canonical,this.tileZoom,this.projection,this.scaleFactor,this.brightness)):o.hasPattern&&(o instanceof e.aY||o instanceof e.aZ||o instanceof e.d0)&&(l(o.layers,this.zoom,d.brightness,r),o.addFeatures(d,this.tileID.canonical,n.patternPositions,r,this.tileTransform,this.brightness))}this.status="done",o(null,{buckets:e.be(u).filter((e=>!e.isEmpty())),featureIndex:c,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:t.image,lineAtlas:h,imageAtlas:n,brightness:d.brightness})}};if(!this.extraShadowCaster){const t=e.dT(d.glyphDependencies,(e=>Object.keys(e).map(Number)));Object.keys(t).length?i.send("getGlyphs",{uid:this.uid,stacks:t,scope:this.scope},((e,t)=>{f||(f=e,m=t,v())}),void 0,!1,_):m={};const n=Object.keys(d.iconDependencies);n.length?i.send("getImages",{icons:n,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},((e,t)=>{f||(f=e,g=t,v())}),void 0,!1,_):g={};const r=Object.keys(d.patternDependencies);r.length?i.send("getImages",{icons:r,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},((e,t)=>{f||(f=e,y=t,v())}),void 0,!1,_):y={}}v()}}function l(t,n,r,i){const o=new e.a3(n,{brightness:r});for(const e of t)e.recalculate(o,i)}class c extends e.E{constructor(t,n,r,i,o,a){super(),this.actor=t,this.layerIndex=n,this.availableImages=r,this.loadVectorData=o||e.aw,this.loading={},this.loaded={},this.deduped=new e.au(t.scheduler),this.isSpriteLoaded=i,this.scheduler=t.scheduler,this.brightness=a}loadTile(n,r){const i=n.uid,o=n&&n.request,a=o&&o.collectResourceTiming,l=this.loading[i]=new s(n);l.abort=this.loadVectorData(n,((s,c)=>{const u=!this.loading[i];if(delete this.loading[i],u||s||!c)return l.status="done",u||(this.loaded[i]=l),r(s);const h=c.rawData,d={};c.expires&&(d.expires=c.expires),c.cacheControl&&(d.cacheControl=c.cacheControl),l.vectorTile=c.vectorTile||new e.dW.VectorTile(new e.bc(h));const p=()=>{l.parse(l.vectorTile,this.layerIndex,this.availableImages,this.actor,((n,i)=>{if(n||!i)return r(n);const s={};if(a){const e=t(o);e.length>0&&(s.resourceTiming=JSON.parse(JSON.stringify(e)))}r(null,e.l({rawTileData:h.slice(0)},i,d,s))}))};this.isSpriteLoaded?p():this.once("isSpriteLoaded",(()=>{this.scheduler?this.scheduler.add(p,{type:"parseTile",isSymbolTile:n.isSymbolTile,zoom:n.tileZoom}):p()})),this.loaded=this.loaded||{},this.loaded[i]=l}))}reloadTile(t,n){const r=this.loaded,i=t.uid;if(r&&r[i]){const o=r[i];o.scaleFactor=t.scaleFactor,o.showCollisionBoxes=t.showCollisionBoxes,o.projection=t.projection,o.brightness=t.brightness,o.tileTransform=e.aL(t.tileID.canonical,t.projection),o.extraShadowCaster=t.extraShadowCaster,o.lut=t.lut;const a=(e,t)=>{const r=o.reloadCallback;r&&(delete o.reloadCallback,o.parse(o.vectorTile,this.layerIndex,this.availableImages,this.actor,r)),n(e,t)};"parsing"===o.status?o.reloadCallback=a:"done"===o.status&&(o.vectorTile?o.parse(o.vectorTile,this.layerIndex,this.availableImages,this.actor,a):a())}else n(null,void 0)}abortTile(e,t){const n=e.uid,r=this.loading[n];r&&(r.abort&&r.abort(),delete this.loading[n]),t()}removeTile(e,t){const n=this.loaded,r=e.uid;n&&n[r]&&delete n[r],t()}}class u{loadTile(t,n){const{uid:r,encoding:i,rawImageData:o,padding:a}=t,s=ImageBitmap&&o instanceof ImageBitmap?this.getImageData(o,a):o;n(null,new e.dX(r,s,i,a<1))}getImageData(e,t){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(e.width,e.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=e.width,this.offscreenCanvas.height=e.height,this.offscreenCanvasContext.drawImage(e,0,0,e.width,e.height);const n=this.offscreenCanvasContext.getImageData(-t,-t,e.width+2*t,e.height+2*t);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),n}}e.bb.setPbf(e.bc);class h{decodeRasterArray(t,n){let{task:r,buffer:i}=t;e.bb.performDecoding(i,r).then((e=>{n(null,e)}),(e=>{n(e)}))}}const d=e.dW.VectorTileFeature.prototype.toGeoJSON;class p{constructor(t){this._feature=t,this.extent=e.ab,this.type=t.type,this.properties=t.tags,"id"in t&&!isNaN(t.id)&&(this.id=parseInt(t.id,10))}loadGeometry(){if(1===this._feature.type){const t=[];for(const n of this._feature.geometry)t.push([new e.P(n[0],n[1])]);return t}{const t=[];for(const n of this._feature.geometry){const r=[];for(const t of n)r.push(new e.P(t[0],t[1]));t.push(r)}return t}}toGeoJSON(e,t,n){return d.call(this,e,t,n)}}class f{constructor(t){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=e.ab,this.length=t.length,this._features=t}feature(e){return new p(this._features[e])}}const m=64/4096,g=128;class y{constructor(){this.features=new Map}clear(){this.features.clear()}load(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;for(const n of e){const e=n.id;if(null==e)continue;let r=this.features.get(e);r&&this.updateCache(r,t),n.geometry?(r=v(n),this.updateCache(r,t),this.features.set(e,r)):this.features.delete(e),this.updateCache(r,t)}}updateCache(e,t){for(const{canonical:n,uid:r}of Object.values(t)){const{z:i,x:o,y:a}=n;_(e,Math.pow(2,i),o,a)&&delete t[r]}}getTile(e,t,n){const r=Math.pow(2,e),i=[];for(const o of this.features.values())_(o,r,t,n)&&i.push(S(o,r,t,n));return{features:i}}getFeatures(){return[...this.features.values()]}}function _(e,t,n,r){let{minX:i,minY:o,maxX:a,maxY:s}=e;return i<(n+1+m)/t&&o<(r+1+m)/t&&a>(n-m)/t&&s>(r-m)/t}function v(e){const{id:t,geometry:n,properties:r}=e;if(!n)return;if("GeometryCollection"===n.type)throw new Error("GeometryCollection not supported in dynamic mode.");const{type:i,coordinates:o}=n,a={id:t,type:1,geometry:[],tags:r,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},s=a.geometry;if("Point"===i)x(o,s,a);else if("MultiPoint"===i)for(const l of o)x(l,s,a);else if("LineString"===i)a.type=2,b(o,s,a);else if("MultiLineString"===i)a.type=2,w(o,s,a);else if("Polygon"===i)a.type=3,w(o,s,a,!0);else{if("MultiPolygon"!==i)throw new Error("Input data is not a valid GeoJSON object.");a.type=3;for(const e of o)w(e,s,a,!0)}return a}function x(t,n,r){let[i,o]=t;const a=e.am(i);let s=e.at(o);s=s<0?0:s>1?1:s,n.push(a,s),r.minX=Math.min(r.minX,a),r.minY=Math.min(r.minY,s),r.maxX=Math.max(r.maxX,a),r.maxY=Math.max(r.maxY,s)}function b(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const o=[];for(const a of e)x(a,o,n);t.push(o),r&&function(e,t){let n=0;for(let r=0,i=e.length,o=i-2;r<i;o=r,r+=2)n+=(e[r]-e[o])*(e[r+1]+e[o+1]);if(n>0===t)for(let r=0,i=e.length;r<i/2;r+=2){const t=e[r],n=e[r+1];e[r]=e[i-2-r],e[r+1]=e[i-1-r],e[i-2-r]=t,e[i-1-r]=n}}(o,i)}function w(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];for(let i=0;i<e.length;i++)b(e[i],t,n,r,0===i)}function S(t,n,r,i){const{id:o,type:a,geometry:s,tags:l}=t,c=[];if(1===a)!function(t,n,r,i,o){for(let a=0;a<t.length;a+=2){const s=Math.round(e.ab*(t[a+0]*n-r)),l=Math.round(e.ab*(t[a+1]*n-i));o.push([s,l])}}(s,n,r,i,c);else for(const e of s)T(e,n,r,i,c);return{id:o,type:a,geometry:c,tags:l}}function T(t,n,r,i,o){const a=-g,s=e.ab+g;let l;for(let c=0;c<t.length-2;c+=2){let u=Math.round(e.ab*(t[c+0]*n-r)),h=Math.round(e.ab*(t[c+1]*n-i)),d=Math.round(e.ab*(t[c+2]*n-r)),p=Math.round(e.ab*(t[c+3]*n-i));const f=d-u,m=p-h;u<a&&d<a||(u<a?(h+=Math.round(m*((a-u)/f)),u=a):d<a&&(p=h+Math.round(m*((a-u)/f)),d=a),h<a&&p<a||(h<a?(u+=Math.round(f*((a-h)/m)),h=a):p<a&&(d=u+Math.round(f*((a-h)/m)),p=a),u>=s&&d>=s||(u>=s?(h+=Math.round(m*((s-u)/f)),u=s):d>=s&&(p=h+Math.round(m*((s-u)/f)),d=s),h>=s&&p>=s||(h>=s?(u+=Math.round(f*((s-h)/m)),h=s):p>=s&&(d=u+Math.round(f*((s-h)/m)),p=s),l&&u===l[l.length-1][0]&&h===l[l.length-1][1]||(l=[[u,h]],o.push(l)),l.push([d,p])))))}}var E,A,M,P={exports:{}},k=function(){if(M)return P.exports;M=1;var t=e.d_(),n=function(){if(A)return E;A=1;var t=e.dY(),n=e.dZ().VectorTileFeature;function r(e,t){this.options=t||{},this.features=e,this.length=e.length}function i(e,t){this.id="number"==typeof e.id?e.id:void 0,this.type=e.type,this.rawGeometry=1===e.type?[e.geometry]:e.geometry,this.properties=e.tags,this.extent=t||4096}return E=r,r.prototype.feature=function(e){return new i(this.features[e],this.options.extent)},i.prototype.loadGeometry=function(){var e=this.rawGeometry;this.geometry=[];for(var n=0;n<e.length;n++){for(var r=e[n],i=[],o=0;o<r.length;o++)i.push(new t(r[o][0],r[o][1]));this.geometry.push(i)}return this.geometry},i.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var e=this.geometry,t=1/0,n=-1/0,r=1/0,i=-1/0,o=0;o<e.length;o++)for(var a=e[o],s=0;s<a.length;s++){var l=a[s];t=Math.min(t,l.x),n=Math.max(n,l.x),r=Math.min(r,l.y),i=Math.max(i,l.y)}return[t,r,n,i]},i.prototype.toGeoJSON=n.prototype.toGeoJSON,E}();function r(e){var n=new t;return function(e,t){for(var n in e.layers)t.writeMessage(3,i,e.layers[n])}(e,n),n.finish()}function i(e,t){var n;t.writeVarintField(15,e.version||1),t.writeStringField(1,e.name||""),t.writeVarintField(5,e.extent||4096);var r={keys:[],values:[],keycache:{},valuecache:{}};for(n=0;n<e.length;n++)r.feature=e.feature(n),t.writeMessage(2,o,r);var i=r.keys;for(n=0;n<i.length;n++)t.writeStringField(3,i[n]);var a=r.values;for(n=0;n<a.length;n++)t.writeMessage(4,u,a[n])}function o(e,t){var n=e.feature;void 0!==n.id&&t.writeVarintField(1,n.id),t.writeMessage(2,a,e),t.writeVarintField(3,n.type),t.writeMessage(4,c,n)}function a(e,t){var n=e.feature,r=e.keys,i=e.values,o=e.keycache,a=e.valuecache;for(var s in n.properties){var l=n.properties[s],c=o[s];if(null!==l){void 0===c&&(r.push(s),o[s]=c=r.length-1),t.writeVarint(c);var u=typeof l;"string"!==u&&"boolean"!==u&&"number"!==u&&(l=JSON.stringify(l));var h=u+":"+l,d=a[h];void 0===d&&(i.push(l),a[h]=d=i.length-1),t.writeVarint(d)}}}function s(e,t){return(t<<3)+(7&e)}function l(e){return e<<1^e>>31}function c(e,t){for(var n=e.loadGeometry(),r=e.type,i=0,o=0,a=n.length,c=0;c<a;c++){var u=n[c],h=1;1===r&&(h=u.length),t.writeVarint(s(1,h));for(var d=3===r?u.length-1:u.length,p=0;p<d;p++){1===p&&1!==r&&t.writeVarint(s(2,d-1));var f=u[p].x-i,m=u[p].y-o;t.writeVarint(l(f)),t.writeVarint(l(m)),i+=f,o+=m}3===r&&t.writeVarint(s(7,1))}}function u(e,t){var n=typeof e;"string"===n?t.writeStringField(1,e):"boolean"===n?t.writeBooleanField(7,e):"number"===n&&(e%1!=0?t.writeDoubleField(3,e):e<0?t.writeSVarintField(6,e):t.writeVarintField(5,e))}return P.exports=r,P.exports.fromVectorTileJs=r,P.exports.fromGeojsonVt=function(e,t){t=t||{};var i={};for(var o in e)i[o]=new n(e[o].features,t),i[o].name=o,i[o].version=t.version,i[o].extent=t.extent;return r({layers:i})},P.exports.GeoJSONWrapper=n,P.exports}(),C=e.d$(k);const j={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:e=>e},I=Math.fround||(O=new Float32Array(1),e=>(O[0]=+e,O[0]));var O;const N=3,D=5,L=6;class z{constructor(e){this.options=Object.assign(Object.create(j),e),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(e){const{log:t,minZoom:n,maxZoom:r}=this.options;t&&console.time("total time");const i="prepare ".concat(e.length," points");t&&console.time(i),this.points=e;const o=[];for(let s=0;s<e.length;s++){const t=e[s];if(!t.geometry)continue;const[n,r]=t.geometry.coordinates,i=I(B(n)),a=I(V(r));o.push(i,a,1/0,s,-1,1),this.options.reduce&&o.push(0)}let a=this.trees[r+1]=this._createTree(o);t&&console.timeEnd(i);for(let s=r;s>=n;s--){const e=+Date.now();a=this.trees[s]=this._createTree(this._cluster(a,s)),t&&console.log("z%d: %d clusters in %dms",s,a.numItems,+Date.now()-e)}return t&&console.timeEnd("total time"),this}getClusters(e,t){let n=((e[0]+180)%360+360)%360-180;const r=Math.max(-90,Math.min(90,e[1]));let i=180===e[2]?180:((e[2]+180)%360+360)%360-180;const o=Math.max(-90,Math.min(90,e[3]));if(e[2]-e[0]>=360)n=-180,i=180;else if(n>i){const e=this.getClusters([n,r,180,o],t),a=this.getClusters([-180,r,i,o],t);return e.concat(a)}const a=this.trees[this._limitZoom(t)],s=a.range(B(n),V(o),B(i),V(r)),l=a.data,c=[];for(const u of s){const e=this.stride*u;c.push(l[e+D]>1?R(l,e,this.clusterProps):this.points[l[e+N]])}return c}getChildren(e){const t=this._getOriginId(e),n=this._getOriginZoom(e),r="No cluster with the specified id.",i=this.trees[n];if(!i)throw new Error(r);const o=i.data;if(t*this.stride>=o.length)throw new Error(r);const a=this.options.radius/(this.options.extent*Math.pow(2,n-1)),s=i.within(o[t*this.stride],o[t*this.stride+1],a),l=[];for(const c of s){const t=c*this.stride;o[t+4]===e&&l.push(o[t+D]>1?R(o,t,this.clusterProps):this.points[o[t+N]])}if(0===l.length)throw new Error(r);return l}getLeaves(e,t,n){const r=[];return this._appendLeaves(r,e,t=t||10,n=n||0,0),r}getTile(e,t,n){const r=this.trees[this._limitZoom(e)],i=Math.pow(2,e),{extent:o,radius:a}=this.options,s=a/o,l=(n-s)/i,c=(n+1+s)/i,u={features:[]};return this._addTileFeatures(r.range((t-s)/i,l,(t+1+s)/i,c),r.data,t,n,i,u),0===t&&this._addTileFeatures(r.range(1-s/i,l,1,c),r.data,i,n,i,u),t===i-1&&this._addTileFeatures(r.range(0,l,s/i,c),r.data,-1,n,i,u),u.features.length?u:null}getClusterExpansionZoom(e){let t=this._getOriginZoom(e)-1;for(;t<=this.options.maxZoom;){const n=this.getChildren(e);if(t++,1!==n.length)break;e=n[0].properties.cluster_id}return t}_appendLeaves(e,t,n,r,i){const o=this.getChildren(t);for(const a of o){const t=a.properties;if(t&&t.cluster?i+t.point_count<=r?i+=t.point_count:i=this._appendLeaves(e,t.cluster_id,n,r,i):i<r?i++:e.push(a),e.length===n)break}return i}_createTree(t){const n=new e.bz(t.length/this.stride|0,this.options.nodeSize,Float32Array);for(let e=0;e<t.length;e+=this.stride)n.add(t[e],t[e+1]);return n.finish(),n.data=t,n}_addTileFeatures(e,t,n,r,i,o){for(const a of e){const e=a*this.stride,s=t[e+D]>1;let l,c,u;if(s)l=F(t,e,this.clusterProps),c=t[e],u=t[e+1];else{const n=this.points[t[e+N]];l=n.properties;const[r,i]=n.geometry.coordinates;c=B(r),u=V(i)}const h={type:1,geometry:[[Math.round(this.options.extent*(c*i-n)),Math.round(this.options.extent*(u*i-r))]],tags:l};let d;d=s||this.options.generateId?t[e+N]:this.points[t[e+N]].id,void 0!==d&&(h.id=d),o.features.push(h)}}_limitZoom(e){return Math.max(this.options.minZoom,Math.min(Math.floor(+e),this.options.maxZoom+1))}_cluster(e,t){const{radius:n,extent:r,reduce:i,minPoints:o}=this.options,a=n/(r*Math.pow(2,t)),s=e.data,l=[],c=this.stride;for(let u=0;u<s.length;u+=c){if(s[u+2]<=t)continue;s[u+2]=t;const n=s[u],r=s[u+1],h=e.within(s[u],s[u+1],a),d=s[u+D];let p=d;for(const e of h){const n=e*c;s[n+2]>t&&(p+=s[n+D])}if(p>d&&p>=o){let e,o=n*d,a=r*d,f=-1;const m=(u/c<<5)+(t+1)+this.points.length;for(const n of h){const r=n*c;if(s[r+2]<=t)continue;s[r+2]=t;const l=s[r+D];o+=s[r]*l,a+=s[r+1]*l,s[r+4]=m,i&&(e||(e=this._map(s,u,!0),f=this.clusterProps.length,this.clusterProps.push(e)),i(e,this._map(s,r)))}s[u+4]=m,l.push(o/p,a/p,1/0,m,-1,p),i&&l.push(f)}else{for(let e=0;e<c;e++)l.push(s[u+e]);if(p>1)for(const e of h){const n=e*c;if(!(s[n+2]<=t)){s[n+2]=t;for(let e=0;e<c;e++)l.push(s[n+e])}}}}return l}_getOriginId(e){return e-this.points.length>>5}_getOriginZoom(e){return(e-this.points.length)%32}_map(e,t,n){if(e[t+D]>1){const r=this.clusterProps[e[t+L]];return n?Object.assign({},r):r}const r=this.points[e[t+N]].properties,i=this.options.map(r);return n&&i===r?Object.assign({},i):i}}function R(e,t,n){return{type:"Feature",id:e[t+N],properties:F(e,t,n),geometry:{type:"Point",coordinates:[(r=e[t],360*(r-.5)),U(e[t+1])]}};var r}function F(e,t,n){const r=e[t+D],i=r>=1e4?"".concat(Math.round(r/1e3),"k"):r>=1e3?Math.round(r/100)/10+"k":r,o=e[t+L],a=-1===o?{}:Object.assign({},n[o]);return Object.assign(a,{cluster:!0,cluster_id:e[t+N],point_count:r,point_count_abbreviated:i})}function B(e){return e/360+.5}function V(e){const t=Math.sin(e*Math.PI/180),n=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return n<0?0:n>1?1:n}function U(e){const t=(180-360*e)*Math.PI/180;return 360*Math.atan(Math.exp(t))/Math.PI-90}function G(e,t,n,r){let i=r;const o=t+(n-t>>1);let a,s=n-t;const l=e[t],c=e[t+1],u=e[n],h=e[n+1];for(let d=t+3;d<n;d+=3){const t=H(e[d],e[d+1],l,c,u,h);if(t>i)a=d,i=t;else if(t===i){const e=Math.abs(d-o);e<s&&(a=d,s=e)}}i>r&&(a-t>3&&G(e,t,a,r),e[a+2]=i,n-a>3&&G(e,a,n,r))}function H(e,t,n,r,i,o){let a=i-n,s=o-r;if(0!==a||0!==s){const l=((e-n)*a+(t-r)*s)/(a*a+s*s);l>1?(n=i,r=o):l>0&&(n+=a*l,r+=s*l)}return a=e-n,s=t-r,a*a+s*s}function Z(e,t,n,r){const i={id:null!==e&&void 0!==e?e:null,type:t,geometry:n,tags:r,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if("Point"===t||"MultiPoint"===t||"LineString"===t)q(i,n);else if("Polygon"===t)q(i,n[0]);else if("MultiLineString"===t)for(const o of n)q(i,o);else if("MultiPolygon"===t)for(const o of n)q(i,o[0]);return i}function q(e,t){for(let n=0;n<t.length;n+=3)e.minX=Math.min(e.minX,t[n]),e.minY=Math.min(e.minY,t[n+1]),e.maxX=Math.max(e.maxX,t[n]),e.maxY=Math.max(e.maxY,t[n+1])}function W(e,t,n,r){if(!t.geometry)return;const i=t.geometry.coordinates;if(i&&0===i.length)return;const o=t.geometry.type,a=Math.pow(n.tolerance/((1<<n.maxZoom)*n.extent),2);let s=[],l=t.id;if(n.promoteId?l=t.properties[n.promoteId]:n.generateId&&(l=r||0),"Point"===o)X(i,s);else if("MultiPoint"===o)for(const c of i)X(c,s);else if("LineString"===o)Y(i,s,a,!1);else if("MultiLineString"===o){if(n.lineMetrics){for(const n of i)s=[],Y(n,s,a,!1),e.push(Z(l,"LineString",s,t.properties));return}K(i,s,a,!1)}else if("Polygon"===o)K(i,s,a,!0);else{if("MultiPolygon"!==o){if("GeometryCollection"===o){for(const i of t.geometry.geometries)W(e,{id:l,geometry:i,properties:t.properties},n,r);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const e of i){const t=[];K(e,t,a,!0),s.push(t)}}e.push(Z(l,o,s,t.properties))}function X(e,t){t.push(J(e[0]),Q(e[1]),0)}function Y(e,t,n,r){let i,o,a=0;for(let l=0;l<e.length;l++){const n=J(e[l][0]),s=Q(e[l][1]);t.push(n,s,0),l>0&&(a+=r?(i*s-n*o)/2:Math.sqrt(Math.pow(n-i,2)+Math.pow(s-o,2))),i=n,o=s}const s=t.length-3;t[2]=1,G(t,0,s,n),t[s+2]=1,t.size=Math.abs(a),t.start=0,t.end=t.size}function K(e,t,n,r){for(let i=0;i<e.length;i++){const o=[];Y(e[i],o,n,r),t.push(o)}}function J(e){return e/360+.5}function Q(e){const t=Math.sin(e*Math.PI/180),n=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return n<0?0:n>1?1:n}function $(e,t,n,r,i,o,a,s){if(r/=t,o>=(n/=t)&&a<r)return e;if(a<n||o>=r)return null;const l=[];for(const c of e){const e=c.geometry;let t=c.type;const o=0===i?c.minX:c.minY,a=0===i?c.maxX:c.maxY;if(o>=n&&a<r){l.push(c);continue}if(a<n||o>=r)continue;let u=[];if("Point"===t||"MultiPoint"===t)ee(e,u,n,r,i);else if("LineString"===t)te(e,u,n,r,i,!1,s.lineMetrics);else if("MultiLineString"===t)re(e,u,n,r,i,!1);else if("Polygon"===t)re(e,u,n,r,i,!0);else if("MultiPolygon"===t)for(const s of e){const e=[];re(s,e,n,r,i,!0),e.length&&u.push(e)}if(u.length){if(s.lineMetrics&&"LineString"===t){for(const e of u)l.push(Z(c.id,t,e,c.tags));continue}"LineString"!==t&&"MultiLineString"!==t||(1===u.length?(t="LineString",u=u[0]):t="MultiLineString"),"Point"!==t&&"MultiPoint"!==t||(t=3===u.length?"Point":"MultiPoint"),l.push(Z(c.id,t,u,c.tags))}}return l.length?l:null}function ee(e,t,n,r,i){for(let o=0;o<e.length;o+=3){const a=e[o+i];a>=n&&a<=r&&ie(t,e[o],e[o+1],e[o+2])}}function te(e,t,n,r,i,o,a){let s=ne(e);const l=0===i?oe:ae;let c,u,h=e.start;for(let g=0;g<e.length-3;g+=3){const d=e[g],p=e[g+1],f=e[g+2],m=e[g+3],y=e[g+4],_=0===i?d:p,v=0===i?m:y;let x=!1;a&&(c=Math.sqrt(Math.pow(d-m,2)+Math.pow(p-y,2))),_<n?v>n&&(u=l(s,d,p,m,y,n),a&&(s.start=h+c*u)):_>r?v<r&&(u=l(s,d,p,m,y,r),a&&(s.start=h+c*u)):ie(s,d,p,f),v<n&&_>=n&&(u=l(s,d,p,m,y,n),x=!0),v>r&&_<=r&&(u=l(s,d,p,m,y,r),x=!0),!o&&x&&(a&&(s.end=h+c*u),t.push(s),s=ne(e)),a&&(h+=c)}let d=e.length-3;const p=e[d],f=e[d+1],m=0===i?p:f;m>=n&&m<=r&&ie(s,p,f,e[d+2]),d=s.length-3,o&&d>=3&&(s[d]!==s[0]||s[d+1]!==s[1])&&ie(s,s[0],s[1],s[2]),s.length&&t.push(s)}function ne(e){const t=[];return t.size=e.size,t.start=e.start,t.end=e.end,t}function re(e,t,n,r,i,o){for(const a of e)te(a,t,n,r,i,o,!1)}function ie(e,t,n,r){e.push(t,n,r)}function oe(e,t,n,r,i,o){const a=(o-t)/(r-t);return ie(e,o,n+(i-n)*a,1),a}function ae(e,t,n,r,i,o){const a=(o-n)/(i-n);return ie(e,t+(r-t)*a,o,1),a}function se(e,t){const n=[];for(let r=0;r<e.length;r++){const i=e[r],o=i.type;let a;if("Point"===o||"MultiPoint"===o||"LineString"===o)a=le(i.geometry,t);else if("MultiLineString"===o||"Polygon"===o){a=[];for(const e of i.geometry)a.push(le(e,t))}else if("MultiPolygon"===o){a=[];for(const e of i.geometry){const n=[];for(const r of e)n.push(le(r,t));a.push(n)}}n.push(Z(i.id,o,a,i.tags))}return n}function le(e,t){const n=[];n.size=e.size,void 0!==e.start&&(n.start=e.start,n.end=e.end);for(let r=0;r<e.length;r+=3)n.push(e[r]+t,e[r+1],e[r+2]);return n}function ce(e,t){if(e.transformed)return e;const n=1<<e.z,r=e.x,i=e.y;for(const o of e.features){const e=o.geometry,a=o.type;if(o.geometry=[],1===a)for(let s=0;s<e.length;s+=2)o.geometry.push(ue(e[s],e[s+1],t,n,r,i));else for(let s=0;s<e.length;s++){const a=[];for(let o=0;o<e[s].length;o+=2)a.push(ue(e[s][o],e[s][o+1],t,n,r,i));o.geometry.push(a)}}return e.transformed=!0,e}function ue(e,t,n,r,i,o){return[Math.round(n*(e*r-i)),Math.round(n*(t*r-o))]}function he(e,t,n,r,i){const o=t===i.maxZoom?0:i.tolerance/((1<<t)*i.extent),a={features:[],numPoints:0,numSimplified:0,numFeatures:e.length,source:null,x:n,y:r,z:t,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const s of e)de(a,s,o,i);return a}function de(e,t,n,r){const i=t.geometry,o=t.type,a=[];if(e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),"Point"===o||"MultiPoint"===o)for(let s=0;s<i.length;s+=3)a.push(i[s],i[s+1]),e.numPoints++,e.numSimplified++;else if("LineString"===o)pe(a,i,e,n,!1,!1);else if("MultiLineString"===o||"Polygon"===o)for(let s=0;s<i.length;s++)pe(a,i[s],e,n,"Polygon"===o,0===s);else if("MultiPolygon"===o)for(let s=0;s<i.length;s++){const t=i[s];for(let r=0;r<t.length;r++)pe(a,t[r],e,n,!0,0===r)}if(a.length){let n=t.tags||null;if("LineString"===o&&r.lineMetrics){n={};for(const e in t.tags)n[e]=t.tags[e];n.mapbox_clip_start=i.start/i.size,n.mapbox_clip_end=i.end/i.size}const s={geometry:a,type:"Polygon"===o||"MultiPolygon"===o?3:"LineString"===o||"MultiLineString"===o?2:1,tags:n};null!==t.id&&(s.id=t.id),e.features.push(s)}}function pe(e,t,n,r,i,o){const a=r*r;if(r>0&&t.size<(i?a:r))return void(n.numPoints+=t.length/3);const s=[];for(let l=0;l<t.length;l+=3)(0===r||t[l+2]>a)&&(n.numSimplified++,s.push(t[l],t[l+1])),n.numPoints++;i&&function(e,t){let n=0;for(let r=0,i=e.length,o=i-2;r<i;o=r,r+=2)n+=(e[r]-e[o])*(e[r+1]+e[o+1]);if(n>0===t)for(let r=0,i=e.length;r<i/2;r+=2){const t=e[r],n=e[r+1];e[r]=e[i-2-r],e[r+1]=e[i-1-r],e[i-2-r]=t,e[i-1-r]=n}}(s,o),e.push(s)}const fe={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class me{constructor(e,t){const n=(t=this.options=function(e,t){for(const n in t)e[n]=t[n];return e}(Object.create(fe),t)).debug;if(n&&console.time("preprocess data"),t.maxZoom<0||t.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(t.promoteId&&t.generateId)throw new Error("promoteId and generateId cannot be used together.");let r=function(e,t){const n=[];if("FeatureCollection"===e.type)for(let r=0;r<e.features.length;r++)W(n,e.features[r],t,r);else W(n,"Feature"===e.type?e:{geometry:e},t);return n}(e,t);this.tiles={},this.tileCoords=[],n&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",t.indexMaxZoom,t.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),r=function(e,t){const n=t.buffer/t.extent;let r=e;const i=$(e,1,-1-n,n,0,-1,2,t),o=$(e,1,1-n,2+n,0,-1,2,t);return(i||o)&&(r=$(e,1,-n,1+n,0,-1,2,t)||[],i&&(r=se(i,1).concat(r)),o&&(r=r.concat(se(o,-1)))),r}(r,t),r.length&&this.splitTile(r,0,0,0),n&&(r.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(e,t,n,r,i,o,a){const s=[e,t,n,r],l=this.options,c=l.debug;for(;s.length;){r=s.pop(),n=s.pop(),t=s.pop(),e=s.pop();const u=1<<t,h=ge(t,n,r);let d=this.tiles[h];if(!d&&(c>1&&console.time("creation"),d=this.tiles[h]=he(e,t,n,r,l),this.tileCoords.push({z:t,x:n,y:r}),c)){c>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",t,n,r,d.numFeatures,d.numPoints,d.numSimplified),console.timeEnd("creation"));const e="z".concat(t);this.stats[e]=(this.stats[e]||0)+1,this.total++}if(d.source=e,null==i){if(t===l.indexMaxZoom||d.numPoints<=l.indexMaxPoints)continue}else{if(t===l.maxZoom||t===i)continue;if(null!=i){const e=i-t;if(n!==o>>e||r!==a>>e)continue}}if(d.source=null,0===e.length)continue;c>1&&console.time("clipping");const p=.5*l.buffer/l.extent,f=.5-p,m=.5+p,g=1+p;let y=null,_=null,v=null,x=null,b=$(e,u,n-p,n+m,0,d.minX,d.maxX,l),w=$(e,u,n+f,n+g,0,d.minX,d.maxX,l);e=null,b&&(y=$(b,u,r-p,r+m,1,d.minY,d.maxY,l),_=$(b,u,r+f,r+g,1,d.minY,d.maxY,l),b=null),w&&(v=$(w,u,r-p,r+m,1,d.minY,d.maxY,l),x=$(w,u,r+f,r+g,1,d.minY,d.maxY,l),w=null),c>1&&console.timeEnd("clipping"),s.push(y||[],t+1,2*n,2*r),s.push(_||[],t+1,2*n,2*r+1),s.push(v||[],t+1,2*n+1,2*r),s.push(x||[],t+1,2*n+1,2*r+1)}}getTile(e,t,n){e=+e,t=+t,n=+n;const r=this.options,{extent:i,debug:o}=r;if(e<0||e>24)return null;const a=1<<e,s=ge(e,t=t+a&a-1,n);if(this.tiles[s])return ce(this.tiles[s],i);o>1&&console.log("drilling down to z%d-%d-%d",e,t,n);let l,c=e,u=t,h=n;for(;!l&&c>0;)c--,u>>=1,h>>=1,l=this.tiles[ge(c,u,h)];return l&&l.source?(o>1&&(console.log("found parent tile z%d-%d-%d",c,u,h),console.time("drilling down")),this.splitTile(l.source,c,u,h,e,t,n),o>1&&console.timeEnd("drilling down"),this.tiles[s]?ce(this.tiles[s],i):null):null}}function ge(e,t,n){return 32*((1<<e)*n+t)+e}function ye(e,t){const n=e.tileID.canonical;if(!this._geoJSONIndex)return void t(null,null);const r=this._geoJSONIndex.getTile(n.z,n.x,n.y);if(!r)return void t(null,null);const i=new f(r.features);let o=C(i);0===o.byteOffset&&o.byteLength===o.buffer.byteLength||(o=new Uint8Array(o)),t(null,{vectorTile:i,rawData:o.buffer})}class _e extends c{constructor(e,t,n,r,i,o){super(e,t,n,r,ye,o),i&&(this.loadGeoJSON=i),this._dynamicIndex=new y}loadData(n,r){const i=n&&n.request,o=i&&i.collectResourceTiming;this.loadGeoJSON(n,((a,s)=>{if(a||!s)return r(a);if("object"!=typeof s)return r(new Error("Input data given to '".concat(n.source,"' is not a valid GeoJSON object.")));{try{if(n.filter){const t=e.M(n.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===t.result)throw new Error(t.value.map((e=>"".concat(e.key,": ").concat(e.message))).join(", "));s.features=s.features.filter((e=>t.value.evaluate({zoom:0},e)))}n.dynamic?("Feature"===s.type&&(s={type:"FeatureCollection",features:[s]}),n.append||(this._dynamicIndex.clear(),this.loaded={}),this._dynamicIndex.load(s.features,this.loaded),n.cluster&&(s.features=this._dynamicIndex.getFeatures())):this.loaded={},this._geoJSONIndex=n.cluster?new z(function(t){let{superclusterOptions:n,clusterProperties:r}=t;if(!r||!n)return n;const i={},o={},a={accumulated:null,zoom:0},s={properties:null},l=Object.keys(r);for(const c of l){const[t,n]=r[c],a=e.M(n),s=e.M("string"==typeof t?[t,["accumulated"],["get",c]]:t);i[c]=a.value,o[c]=s.value}return n.map=e=>{s.properties=e;const t={};for(const n of l)t[n]=i[n].evaluate(a,s);return t},n.reduce=(e,t)=>{s.properties=t;for(const n of l)a.accumulated=e[n],e[n]=o[n].evaluate(a,s)},n}(n)).load(s.features):n.dynamic?this._dynamicIndex:function(e,t){return new me(e,t)}(s,n.geojsonVtOptions)}catch(e){return r(e)}const a={};if(o){const e=t(i);e&&(a.resourceTiming={},a.resourceTiming[n.source]=JSON.parse(JSON.stringify(e)))}r(null,a)}}))}reloadTile(e,t){const n=this.loaded;return n&&n[e.uid]?e.partial?t(null,void 0):super.reloadTile(e,t):this.loadTile(e,t)}loadGeoJSON(t,n){if(t.request)e.n(t.request,n);else{if("string"!=typeof t.data)return n(new Error("Input data given to '".concat(t.source,"' is not a valid GeoJSON object.")));try{return n(null,JSON.parse(t.data))}catch(e){return n(new Error("Input data given to '".concat(t.source,"' is not a valid GeoJSON object.")))}}}getClusterExpansionZoom(e,t){try{t(null,this._geoJSONIndex.getClusterExpansionZoom(e.clusterId))}catch(e){t(e)}}getClusterChildren(e,t){try{t(null,this._geoJSONIndex.getChildren(e.clusterId))}catch(e){t(e)}}getClusterLeaves(e,t){try{t(null,this._geoJSONIndex.getLeaves(e.clusterId,e.limit,e.offset))}catch(e){t(e)}}}class ve{constructor(t,n){this.tileID=new e.aA(t.tileID.overscaledZ,t.tileID.wrap,t.tileID.canonical.z,t.tileID.canonical.x,t.tileID.canonical.y),this.tileZoom=t.tileZoom,this.uid=t.uid,this.zoom=t.zoom,this.canonical=t.tileID.canonical,this.pixelRatio=t.pixelRatio,this.tileSize=t.tileSize,this.source=t.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=t.projection,this.brightness=n}parse(t,n,r,i){this.status="parsing";const o=new e.aA(r.tileID.overscaledZ,r.tileID.wrap,r.tileID.canonical.z,r.tileID.canonical.x,r.tileID.canonical.y),a=[],s=n.familiesBySource[r.source],l=new e.dR(o,r.promoteId);return l.bucketLayerIDs=[],l.is3DTile=!0,e.e0(t).then((t=>{if(!t)return i(new Error("Could not parse tile"));const n=e.e1(t,1/e.c9(r.tileID.canonical)),c=t.json.extensionsUsed&&t.json.extensionsUsed.includes("MAPBOX_mesh_features")||t.json.asset.extras&&t.json.asset.extras.MAPBOX_mesh_features,u=t.json.extensionsUsed&&t.json.extensionsUsed.includes("EXT_meshopt_compression"),h=new e.a3(this.zoom,{brightness:this.brightness});for(const r in s)for(const t of s[r]){const r=t[0];l.bucketLayerIDs.push(t.map((t=>e.av(t.id,t.scope)))),r.recalculate(h,[]);const i=new e.e2(t,n,o,c,u,this.brightness,l);c||(i.needsUpload=!0),a.push(i),i.evaluate(r)}this.status="done",i(null,{buckets:a,featureIndex:l,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:null})})).catch((e=>i(new Error(e.message))))}}class xe{constructor(e,t,n,r,i,o){this.actor=e,this.layerIndex=t,this.availableImages=n,this.brightness=o,this.loading={},this.loaded={}}loadTile(t,n){const r=t.uid,i=this.loading[r]=new ve(t,this.brightness);e.bd(t.request,((e,o)=>{const a=!this.loading[r];return delete this.loading[r],a||e?(i.status="done",a||(this.loaded[r]=i),n(e)):o&&0!==o.byteLength?void i.parse(o,this.layerIndex,t,((e,t)=>{i.status="done",this.loaded=this.loaded||{},this.loaded[r]=i,e||!t?n(e):n(null,t)})):(i.status="done",this.loaded[r]=i,n())}))}reloadTile(e,t){const n=this.loaded,r=e.uid;if(n&&n[r]){const i=n[r];i.projection=e.projection,i.brightness=e.brightness;const o=(n,r)=>{i.reloadCallback&&(delete i.reloadCallback,this.loadTile(e,t)),t(n,r)};"parsing"===i.status?i.reloadCallback=o:"done"===i.status&&this.loadTile(e,t)}}abortTile(e,t){const n=e.uid;this.loading[n]&&delete this.loading[n],t()}removeTile(e,t){const n=this.loaded,r=e.uid;n&&n[r]&&delete n[r],t()}}class be{constructor(t){this.self=t,this.actor=new e.e3(t,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=e.bM({name:"mercator"}),this.workerSourceTypes={vector:c,geojson:_e,"batched-model":xe},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(e,t)=>{if(this.workerSourceTypes[e])throw new Error('Worker source with name "'.concat(e,'" already registered.'));this.workerSourceTypes[e]=t},this.self.registerRTLTextPlugin=t=>{if(e.e4.isParsed())throw new Error("RTL text plugin already registered.");e.e4.applyArabicShaping=t.applyArabicShaping,e.e4.processBidirectionalText=t.processBidirectionalText,e.e4.processStyledBidirectionalText=t.processStyledBidirectionalText}}clearCaches(e,t,n){delete this.layerIndexes[e],delete this.availableImages[e],delete this.workerSources[e],delete this.demWorkerSources[e],delete this.rasterArrayWorkerSource,n()}checkIfReady(e,t,n){n()}setReferrer(e,t){this.referrer=t}spriteLoaded(t,n){let{scope:r,isLoaded:i}=n;if(this.isSpriteLoaded[t]||(this.isSpriteLoaded[t]={}),this.isSpriteLoaded[t][r]=i,this.workerSources[t]&&this.workerSources[t][r])for(const o in this.workerSources[t][r]){const n=this.workerSources[t][r][o];for(const t in n){const r=n[t];r instanceof c&&(r.isSpriteLoaded=i,r.fire(new e.x("isSpriteLoaded")))}}}setImages(e,t,n){let{scope:r,images:i}=t;if(this.availableImages[e]||(this.availableImages[e]={}),this.availableImages[e][r]=i,this.workerSources[e]&&this.workerSources[e][r]){for(const t in this.workerSources[e][r]){const n=this.workerSources[e][r][t];for(const e in n)n[e].availableImages=i}n()}else n()}setProjection(t,n){this.projections[t]=e.bM(n)}setBrightness(e,t,n){this.brightness=t,n()}setLayers(e,t,n){this.getLayerIndex(e,t.scope).replace(t.layers,t.options),n()}updateLayers(e,t,n){this.getLayerIndex(e,t.scope).update(t.layers,t.removedIds,t.options),n()}loadTile(e,t,n){t.projection=this.projections[e]||this.defaultProjection,this.getWorkerSource(e,t.type,t.source,t.scope).loadTile(t,n)}loadDEMTile(e,t,n){this.getDEMWorkerSource(e,t.source,t.scope).loadTile(t,n)}decodeRasterArray(e,t,n){this.getRasterArrayWorkerSource().decodeRasterArray(t,n)}reloadTile(e,t,n){t.projection=this.projections[e]||this.defaultProjection,this.getWorkerSource(e,t.type,t.source,t.scope).reloadTile(t,n)}abortTile(e,t,n){this.getWorkerSource(e,t.type,t.source,t.scope).abortTile(t,n)}removeTile(e,t,n){this.getWorkerSource(e,t.type,t.source,t.scope).removeTile(t,n)}removeSource(e,t,n){if(!(this.workerSources[e]&&this.workerSources[e][t.scope]&&this.workerSources[e][t.scope][t.type]&&this.workerSources[e][t.scope][t.type][t.source]))return;const r=this.workerSources[e][t.scope][t.type][t.source];delete this.workerSources[e][t.scope][t.type][t.source],void 0!==r.removeSource?r.removeSource(t,n):n()}loadWorkerSource(e,t,n){try{this.self.importScripts(t.url),n()}catch(e){n(e.toString())}}syncRTLPluginState(t,n,r){try{e.e4.setState(n);const t=e.e4.getPluginURL();if(e.e4.isLoaded()&&!e.e4.isParsed()&&null!=t){this.self.importScripts(t);const n=e.e4.isParsed();r(n?void 0:new Error("RTL Text Plugin failed to import scripts from ".concat(t)),n)}}catch(e){r(e.toString())}}setDracoUrl(e,t){this.dracoUrl=t}getAvailableImages(e,t){this.availableImages[e]||(this.availableImages[e]={});let n=this.availableImages[e][t];return n||(n=[]),n}getLayerIndex(e,t){this.layerIndexes[e]||(this.layerIndexes[e]={});let n=this.layerIndexes[e][t];return n||(n=this.layerIndexes[e][t]=new i,n.scope=t),n}getWorkerSource(e,t,n,r){return this.workerSources[e]||(this.workerSources[e]={}),this.workerSources[e][r]||(this.workerSources[e][r]={}),this.workerSources[e][r][t]||(this.workerSources[e][r][t]={}),this.isSpriteLoaded[e]||(this.isSpriteLoaded[e]={}),this.workerSources[e][r][t][n]||(this.workerSources[e][r][t][n]=new this.workerSourceTypes[t]({send:(t,n,r,i,o,a)=>{this.actor.send(t,n,r,e,o,a)},scheduler:this.actor.scheduler},this.getLayerIndex(e,r),this.getAvailableImages(e,r),this.isSpriteLoaded[e][r],void 0,this.brightness)),this.workerSources[e][r][t][n]}getDEMWorkerSource(e,t,n){return this.demWorkerSources[e]||(this.demWorkerSources[e]={}),this.demWorkerSources[e][n]||(this.demWorkerSources[e][n]={}),this.demWorkerSources[e][n][t]||(this.demWorkerSources[e][n][t]=new u),this.demWorkerSources[e][n][t]}getRasterArrayWorkerSource(){return this.rasterArrayWorkerSource||(this.rasterArrayWorkerSource=new h),this.rasterArrayWorkerSource}enforceCacheSizeLimit(t,n){e.e5(n)}getWorkerPerformanceMetrics(e,t,n){n(void 0,void 0)}}return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope&&(self.worker=new be(self)),be})),s(["./shared"],(function(e){var t="3.8.0";const n={create:"create",load:"load",fullLoad:"fullLoad"},s={mark(e){performance.mark(e)},measure(e,t,n){performance.measure(e,t,n)}};function l(t){const n=t.name.split("?")[0];return e.a(n)&&n.includes("mapbox-gl.js")?"javascript":e.a(n)&&n.includes("mapbox-gl.css")?"css":e.b(n)?"fontRange":e.c(n)?"sprite":e.i(n)?"style":e.d(n)?"tilejson":"other"}var c,u={},h=function(){if(c)return u;function e(e){return!t(e)}function t(t){return"undefined"==typeof window||"undefined"==typeof document?"not a browser":function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var e,t,n=new Blob([""],{type:"text/javascript"}),r=URL.createObjectURL(n);try{t=new Worker(r),e=!0}catch(t){e=!1}return t&&t.terminate(),URL.revokeObjectURL(r),e}()?function(){var e=document.createElement("canvas");e.width=e.height=1;var t=e.getContext("2d");if(!t)return!1;var n=t.getImageData(0,0,1,1);return n&&n.width===e.width}()?(void 0===n[r=t&&t.failIfMajorPerformanceCaveat]&&(n[r]=function(t){var n,r=function(t){var n=document.createElement("canvas"),r=Object.create(e.webGLContextAttributes);return r.failIfMajorPerformanceCaveat=t,n.getContext("webgl2",r)}(t);if(!r)return!1;try{n=r.createShader(r.VERTEX_SHADER)}catch(e){return!1}return!(!n||r.isContextLost())&&(r.shaderSource(n,"void main() {}"),r.compileShader(n),!0===r.getShaderParameter(n,r.COMPILE_STATUS))}(r)),n[r]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var r}c=1,u.supported=e,u.notSupportedReason=t;var n={};return e.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0},u}();function d(e,t,n){const r=document.createElement(e);return null!=t&&(r.className=t),n&&n.appendChild(r),r}function p(e,t,n){const r=document.createElementNS("http://www.w3.org/2000/svg",e);for(const i of Object.keys(t))r.setAttributeNS(null,i,String(t[i]));return n&&n.appendChild(r),r}const f="undefined"!=typeof document?document.documentElement&&document.documentElement.style:null,m=f&&void 0!==f.userSelect?"userSelect":"WebkitUserSelect";let g;function y(){f&&m&&(g=f[m],f[m]="none")}function _(){f&&m&&(f[m]=g)}function v(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",v,!0)}function x(){window.addEventListener("click",v,!0),window.setTimeout((()=>{window.removeEventListener("click",v,!0)}),0)}function b(e,t){const n=e.getBoundingClientRect();return T(e,n,t)}function w(e,t){const n=e.getBoundingClientRect(),r=[];for(let i=0;i<t.length;i++)r.push(T(e,n,t[i]));return r}function S(e){return void 0!==window.InstallTrigger&&2===e.button&&e.ctrlKey&&window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:e.button}function T(t,n,r){const i=t.offsetWidth===n.width?1:t.offsetWidth/n.width;return new e.P((r.clientX-n.left)*i,(r.clientY-n.top)*i)}const E="01",A="NO_ACCESS_TOKEN";class M{constructor(e,t,n){this._transformRequestFn=e,this._customAccessToken=t,this._silenceAuthErrors=!!n,this._createSkuToken()}_createSkuToken(){const e=function(){let e="";for(let t=0;t<10;t++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",E,e].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=e.token,this._skuTokenExpiresAt=e.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(e,t){return this._transformRequestFn&&this._transformRequestFn(e,t)||{url:e}}normalizeStyleURL(n,r){if(!e.f(n))return n;const i=k(n);return i.params.push("sdk=js-".concat(t)),i.path="/styles/v1".concat(i.path),this._makeAPIURL(i,this._customAccessToken||r)}normalizeGlyphsURL(t,n){if(!e.f(t))return t;const r=k(t);return r.path="/fonts/v1".concat(r.path),this._makeAPIURL(r,this._customAccessToken||n)}normalizeModelURL(t,n){if(!e.f(t))return t;const r=k(t);return r.path="/models/v1".concat(r.path),this._makeAPIURL(r,this._customAccessToken||n)}normalizeSourceURL(t,n,r,i){if(!e.f(t))return t;const o=k(t);return o.path="/v4/".concat(o.authority,".json"),o.params.push("secure"),r&&o.params.push("language=".concat(r)),i&&o.params.push("worldview=".concat(i)),this._makeAPIURL(o,this._customAccessToken||n)}normalizeSpriteURL(t,n,r,i){const o=k(t);return e.f(t)?(o.path="/styles/v1".concat(o.path,"/sprite").concat(n).concat(r),this._makeAPIURL(o,this._customAccessToken||i)):(o.path+="".concat(n).concat(r),C(o))}normalizeTileURL(t,n,r){if(this._isSkuTokenExpired()&&this._createSkuToken(),t&&!e.f(t))return t;const i=k(t);i.path=i.path.replace(/(\.(png|jpg)\d*)(?=$)/,"".concat(n||r&&"raster"!==i.authority&&512===r?"@2x":"").concat(e.m.supported?".webp":"$1")),"raster"===i.authority?i.path="/".concat(e.e.RASTER_URL_PREFIX).concat(i.path):"rasterarrays"===i.authority?i.path="/".concat(e.e.RASTERARRAYS_URL_PREFIX).concat(i.path):"3dtiles"===i.authority?i.path="/".concat(e.e.TILES3D_URL_PREFIX).concat(i.path):(i.path=i.path.replace(/^.+\/v4\//,"/"),i.path="/".concat(e.e.TILE_URL_VERSION).concat(i.path));const o=this._customAccessToken||function(e){for(const t of e){const e=t.match(/^access_token=(.*)$/);if(e)return e[1]}return null}(i.params)||e.e.ACCESS_TOKEN;return e.e.REQUIRE_ACCESS_TOKEN&&o&&this._skuToken&&i.params.push("sku=".concat(this._skuToken)),this._makeAPIURL(i,o)}canonicalizeTileURL(t,n){const r=k(t);if(!r.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!r.path.match(/\.[\w]+$/))return t;let i="mapbox://";r.path.match(/^\/raster\/v1\//)?i+="raster/".concat(r.path.replace("/".concat(e.e.RASTER_URL_PREFIX,"/"),"")):r.path.match(/^\/rasterarrays\/v1\//)?i+="rasterarrays/".concat(r.path.replace("/".concat(e.e.RASTERARRAYS_URL_PREFIX,"/"),"")):i+="tiles/".concat(r.path.replace("/".concat(e.e.TILE_URL_VERSION,"/"),""));let o=r.params;return n&&(o=o.filter((e=>!e.match(/^access_token=/)))),o.length&&(i+="?".concat(o.join("&"))),i}canonicalizeTileset(t,n){const r=!!n&&e.f(n),i=[];for(const o of t.tiles||[])e.h(o)?i.push(this.canonicalizeTileURL(o,r)):i.push(o);return i}_makeAPIURL(t,n){const r="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",i=k(e.e.API_URL);if(t.protocol=i.protocol,t.authority=i.authority,"http"===t.protocol){const e=t.params.indexOf("secure");e>=0&&t.params.splice(e,1)}if("/"!==i.path&&(t.path="".concat(i.path).concat(t.path)),!e.e.REQUIRE_ACCESS_TOKEN)return C(t);if(n=n||e.e.ACCESS_TOKEN,!this._silenceAuthErrors){if(!n)throw new Error("An API access token is required to use Mapbox GL. ".concat(r));if("s"===n[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ".concat(r))}return t.params=t.params.filter((e=>-1===e.indexOf("access_token"))),t.params.push("access_token=".concat(n||"")),C(t)}}const P=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function k(e){const t=e.match(P);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function C(e){const t=e.params.length?"?".concat(e.params.join("&")):"";return"".concat(e.protocol,"://").concat(e.authority).concat(e.path).concat(t)}const j="mapbox.eventData";function I(t){if(!t)return null;const n=t.split(".");if(!n||3!==n.length)return null;try{return JSON.parse(e.j(n[1]))}catch(e){return null}}class O{constructor(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(t){const n=I(e.e.ACCESS_TOKEN);let r="";return r=n&&n.u?e.k(n.u):e.e.ACCESS_TOKEN||"",t?"".concat(j,".").concat(t,":").concat(r):"".concat(j,":").concat(r)}fetchEventData(){const t=e.s("localStorage"),n=this.getStorageKey(),r=this.getStorageKey("uuid");if(t)try{const e=localStorage.getItem(n);e&&(this.eventData=JSON.parse(e));const t=localStorage.getItem(r);t&&(this.anonId=t)}catch(t){e.w("Unable to read from LocalStorage")}}saveEventData(){const t=e.s("localStorage"),n=this.getStorageKey(),r=this.getStorageKey("uuid"),i=this.anonId;if(t&&i)try{localStorage.setItem(r,i),Object.keys(this.eventData).length>=1&&localStorage.setItem(n,JSON.stringify(this.eventData))}catch(t){e.w("Unable to write to LocalStorage")}}processRequests(e){}postEvent(t,n,r,i){if(!e.e.EVENTS_URL)return;const o=k(e.e.EVENTS_URL);o.params.push("access_token=".concat(i||e.e.ACCESS_TOKEN||""));const a={event:this.type,created:new Date(t).toISOString()},s=n?e.l(a,n):a,l={url:C(o),headers:{"Content-Type":"text/plain"},body:JSON.stringify([s])};this.pendingRequest=e.p(l,(e=>{this.pendingRequest=null,r(e),this.saveEventData(),this.processRequests(i)}))}queueRequest(e,t){this.queue.push(e),this.processRequests(t)}}const N=new class extends O{constructor(e){super("appUserTurnstile"),this._customAccessToken=e}postTurnstileEvent(t,n){e.e.EVENTS_URL&&e.e.ACCESS_TOKEN&&Array.isArray(t)&&t.some((t=>e.f(t)||e.h(t)))&&this.queueRequest(Date.now(),n)}processRequests(n){if(this.pendingRequest||0===this.queue.length)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const r=I(e.e.ACCESS_TOKEN),i=r?r.u:e.e.ACCESS_TOKEN;let o=i!==this.eventData.tokenU;e.v(this.anonId)||(this.anonId=e.u(),o=!0);const a=this.queue.shift();if(this.eventData.lastSuccess){const e=new Date(this.eventData.lastSuccess),t=new Date(a),n=(a-this.eventData.lastSuccess)/864e5;o=o||n>=1||n<-1||e.getDate()!==t.getDate()}else o=!0;o?this.postEvent(a,{sdkIdentifier:"mapbox-gl-js",sdkVersion:t,skuId:E,"enabled.telemetry":!1,userId:this.anonId},(e=>{e||(this.eventData.lastSuccess=a,this.eventData.tokenU=i)}),n):this.processRequests()}},D=N.postTurnstileEvent.bind(N),L=new class extends O{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(t,n,r,i){this.skuToken=n,this.errorCb=i,e.e.EVENTS_URL&&(r||e.e.ACCESS_TOKEN?this.queueRequest({id:t,timestamp:Date.now()},r):this.errorCb(new Error(A)))}processRequests(n){if(this.pendingRequest||0===this.queue.length)return;const{id:r,timestamp:i}=this.queue.shift();r&&this.success[r]||(this.anonId||this.fetchEventData(),e.v(this.anonId)||(this.anonId=e.u()),this.postEvent(i,{sdkIdentifier:"mapbox-gl-js",sdkVersion:t,skuId:E,skuToken:this.skuToken,userId:this.anonId},(e=>{e?this.errorCb(e):r&&(this.success[r]=!0)}),n))}remove(){this.errorCb=null}},z=L.postMapLoadEvent.bind(L),R=new class extends O{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(t){let n=this.mapInstanceIdMap.get(t);return n||(n=e.u(),this.mapInstanceIdMap.set(t,n)),n}getEventId(e){const t=this.eventIdPerMapInstanceMap.get(e)||0;return this.eventIdPerMapInstanceMap.set(e,t+1),t}postStyleLoadEvent(t,n){const{map:r,style:i,importedStyles:o}=n;if(!e.e.EVENTS_URL||!t&&!e.e.ACCESS_TOKEN)return;const a=this.getMapInstanceId(r),s={mapInstanceId:a,eventId:this.getEventId(a),style:i};o.length&&(s.importedStyles=o),this.queueRequest({timestamp:Date.now(),payload:s},t)}processRequests(e){if(this.pendingRequest||0===this.queue.length)return;const{timestamp:t,payload:n}=this.queue.shift();this.postEvent(t,n,(()=>{}),e)}},F=R.postStyleLoadEvent.bind(R),B=new class extends O{constructor(){super("gljs.performance")}postPerformanceEvent(t,n){e.e.EVENTS_URL&&(t||e.e.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:n},t)}processRequests(r){if(this.pendingRequest||0===this.queue.length)return;const{timestamp:i,performanceData:o}=this.queue.shift(),a=function(r){const i=performance.getEntriesByType("resource"),o=performance.getEntriesByType("mark"),a=function(e){const t={};if(e)for(const n in e)if("other"!==n)for(const r of e[n]){const e="".concat(n,"ResolveRangeMin"),i="".concat(n,"ResolveRangeMax"),o="".concat(n,"RequestCount"),a="".concat(n,"RequestCachedCount");t[e]=Math.min(t[e]||1/0,r.startTime),t[i]=Math.max(t[i]||-1/0,r.responseEnd);const s=e=>{void 0===t[e]&&(t[e]=0),++t[e]};void 0!==r.transferSize&&0===r.transferSize&&s(a),s(o)}return t}(function(e,t){const n={};if(e)for(const r of e){const e=t(r);void 0===n[e]&&(n[e]=[]),n[e].push(r)}return n}(i,l)),s=window.devicePixelRatio,c=navigator.connection||navigator.mozConnection||navigator.webkitConnection,u=c?c.effectiveType:void 0,h={counters:[],metadata:[],attributes:[]},d=(e,t,n)=>{null!=n&&e.push({name:t,value:n.toString()})};for(const e in a)d(h.counters,e,a[e]);if(r.interactionRange[0]!==1/0&&r.interactionRange[1]!==-1/0&&(d(h.counters,"interactionRangeMin",r.interactionRange[0]),d(h.counters,"interactionRangeMax",r.interactionRange[1])),o)for(const e of Object.keys(n)){const t=n[e],r=o.find((e=>e.name===t));r&&d(h.counters,t,r.startTime)}return d(h.counters,"visibilityHidden",r.visibilityHidden),d(h.attributes,"style",function(t){if(t)for(const n of t){const t=n.name.split("?")[0];if(e.i(t)){const e=t.split("/").slice(-2);if(2===e.length)return"mapbox://styles/".concat(e[0],"/").concat(e[1])}}}(i)),d(h.attributes,"terrainEnabled",r.terrainEnabled?"true":"false"),d(h.attributes,"fogEnabled",r.fogEnabled?"true":"false"),d(h.attributes,"projection",r.projection),d(h.attributes,"zoom",r.zoom),d(h.metadata,"devicePixelRatio",s),d(h.metadata,"connectionEffectiveType",u),d(h.metadata,"navigatorUserAgent",navigator.userAgent),d(h.metadata,"screenWidth",window.screen.width),d(h.metadata,"screenHeight",window.screen.height),d(h.metadata,"windowWidth",window.innerWidth),d(h.metadata,"windowHeight",window.innerHeight),d(h.metadata,"mapWidth",r.width/s),d(h.metadata,"mapHeight",r.height/s),d(h.metadata,"webglRenderer",r.renderer),d(h.metadata,"webglVendor",r.vendor),d(h.metadata,"sdkVersion",t),d(h.metadata,"sdkIdentifier","mapbox-gl-js"),h}(o);for(const e of a.metadata);for(const e of a.counters);for(const e of a.attributes);this.postEvent(i,a,(()=>{}),r)}},V=B.postPerformanceEvent.bind(B),U=new class extends O{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(t,n,r,i){if(!e.e.API_URL||!e.e.SESSION_PATH)return;const o=k(e.e.API_URL+e.e.SESSION_PATH);o.params.push("sku=".concat(n||"")),o.params.push("access_token=".concat(i||e.e.ACCESS_TOKEN||""));const a={url:C(o),headers:{"Content-Type":"text/plain"}};this.pendingRequest=e.g(a,(e=>{this.pendingRequest=null,r(e),this.saveEventData(),this.processRequests(i)}))}getSessionAPI(t,n,r,i){this.skuToken=n,this.errorCb=i,e.e.SESSION_PATH&&e.e.API_URL&&(r||e.e.ACCESS_TOKEN?this.queueRequest({id:t,timestamp:Date.now()},r):this.errorCb(new Error(A)))}processRequests(e){if(this.pendingRequest||0===this.queue.length)return;const{id:t,timestamp:n}=this.queue.shift();t&&this.success[t]||this.getSession(n,this.skuToken,(e=>{e?this.errorCb(e):t&&(this.success[t]=!0)}),e)}remove(){this.errorCb=null}},G=U.getSessionAPI.bind(U),H=new Set;function Z(e,t){t?H.add(e):H.delete(e)}class q{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages=new Set}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(e,t){this._updatedSourceCaches[e]=t,this.setDirty()}discardSourceCacheUpdate(e){delete this._updatedSourceCaches[e]}updateLayer(e){const t=e.scope;this._updatedLayers[t]=this._updatedLayers[t]||new Set,this._updatedLayers[t].add(e.id),this.setDirty()}removeLayer(e){const t=e.scope;this._removedLayers[t]=this._removedLayers[t]||{},this._updatedLayers[t]=this._updatedLayers[t]||new Set,this._removedLayers[t][e.id]=e,this._updatedLayers[t].delete(e.id),this._updatedPaintProps.delete(e.fqid),this.setDirty()}getRemovedLayer(e){return this._removedLayers[e.scope]?this._removedLayers[e.scope][e.id]:null}discardLayerRemoval(e){this._removedLayers[e.scope]&&delete this._removedLayers[e.scope][e.id]}getLayerUpdatesByScope(){const e={};for(const t in this._updatedLayers)e[t]=e[t]||{},e[t].updatedIds=Array.from(this._updatedLayers[t].values());for(const t in this._removedLayers)e[t]=e[t]||{},e[t].removedIds=Object.keys(this._removedLayers[t]);return e}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(e){this._updatedPaintProps.add(e.fqid),this.setDirty()}getUpdatedImages(){return Array.from(this._updatedImages.values())}updateImage(e){this._updatedImages.add(e),this.setDirty()}resetUpdatedImages(){this._updatedImages.clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages.clear()}}function W(e){const{userImage:t}=e;return!!(t&&t.render&&t.render())&&(e.data.replace(new Uint8Array(t.data.buffer)),!0)}class X extends e.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded={},this.requestors=[],this.patterns={},this.atlasImage={},this.atlasTexture={},this.dirty=!0}createScope(t){this.images[t]={},this.loaded[t]=!1,this.updatedImages[t]={},this.patterns[t]={},this.callbackDispatchedThisFrame[t]={},this.atlasImage[t]=new e.r({width:1,height:1})}isLoaded(){for(const e in this.loaded)if(!this.loaded[e])return!1;return!0}setLoaded(e,t){if(this.loaded[t]!==e&&(this.loaded[t]=e,e)){for(const{ids:e,callback:n}of this.requestors)this._notify(e,t,n);this.requestors=[]}}hasImage(e,t){return!!this.getImage(e,t)}getImage(e,t){return this.images[t][e]}addImage(e,t,n){this._validate(e,n)&&(this.images[t][e]=n)}_validate(t,n){let r=!0;return this._validateStretch(n.stretchX,n.data&&n.data.width)||(this.fire(new e.t(new Error('Image "'.concat(t,'" has invalid "stretchX" value')))),r=!1),this._validateStretch(n.stretchY,n.data&&n.data.height)||(this.fire(new e.t(new Error('Image "'.concat(t,'" has invalid "stretchY" value')))),r=!1),this._validateContent(n.content,n)||(this.fire(new e.t(new Error('Image "'.concat(t,'" has invalid "content" value')))),r=!1),r}_validateStretch(e,t){if(!e)return!0;let n=0;for(const r of e){if(r[0]<n||r[1]<r[0]||t<r[1])return!1;n=r[1]}return!0}_validateContent(e,t){return!(e&&(4!==e.length||e[0]<0||t.data.width<e[0]||e[1]<0||t.data.height<e[1]||e[2]<0||t.data.width<e[2]||e[3]<0||t.data.height<e[3]||e[2]<e[0]||e[3]<e[1]))}updateImage(e,t,n){n.version=this.images[t][e].version+1,this.images[t][e]=n,this.updatedImages[t][e]=!0}removeImage(e,t){const n=this.images[t][e];delete this.images[t][e],delete this.patterns[t][e],n.userImage&&n.userImage.onRemove&&n.userImage.onRemove()}listImages(e){return Object.keys(this.images[e])}getImages(e,t,n){let r=!0;const i=!!this.loaded[t];if(!i)for(const o of e)this.images[t][o]||(r=!1);i||r?this._notify(e,t,n):this.requestors.push({ids:e,scope:t,callback:n})}getUpdatedImages(e){return this.updatedImages[e]}_notify(t,n,r){const i={};for(const o of t){this.images[n][o]||this.fire(new e.x("styleimagemissing",{id:o}));const t=this.images[n][o];t?i[o]={data:t.data.clone(),pixelRatio:t.pixelRatio,sdf:t.sdf,version:t.version,stretchX:t.stretchX,stretchY:t.stretchY,content:t.content,hasRenderCallback:Boolean(t.userImage&&t.userImage.render)}:e.w('Image "'.concat(o,'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.'))}r(null,i)}getPixelSize(e){const{width:t,height:n}=this.atlasImage[e];return{width:t,height:n}}getPattern(t,n,r){const i=this.patterns[n][t],o=this.getImage(t,n);if(!o)return null;if(i&&i.position.version===o.version)return i.position;if(i)i.position.version=o.version;else{const r={w:o.data.width+2*e.y,h:o.data.height+2*e.y,x:0,y:0},i=new e.I(r,o,e.y);this.patterns[n][t]={bin:r,position:i}}return this._updatePatternAtlas(n,r),this.patterns[n][t].position}bind(t,n){const r=t.gl;let i=this.atlasTexture[n];i?this.dirty&&(i.update(this.atlasImage[n]),this.dirty=!1):(i=new e.T(t,this.atlasImage[n],r.RGBA8),this.atlasTexture[n]=i),i.bind(r.LINEAR,r.CLAMP_TO_EDGE)}_updatePatternAtlas(t,n){const r=[];for(const e in this.patterns[t])r.push(this.patterns[t][e].bin);const{w:i,h:o}=e.z(r),a=this.atlasImage[t];a.resize({width:i||1,height:o||1});for(const s in this.patterns[t]){const{bin:r,position:i}=this.patterns[t][s];let o=i.padding;const l=r.x+o,c=r.y+o,u=this.images[t][s].data,h=u.width,d=u.height;o=o>1?o-1:o,e.r.copy(u,a,{x:0,y:0},{x:l,y:c},{width:h,height:d},n),e.r.copy(u,a,{x:0,y:d-o},{x:l,y:c-o},{width:h,height:o},n),e.r.copy(u,a,{x:0,y:0},{x:l,y:c+d},{width:h,height:o},n),e.r.copy(u,a,{x:h-o,y:0},{x:l-o,y:c},{width:o,height:d},n),e.r.copy(u,a,{x:0,y:0},{x:l+h,y:c},{width:o,height:d},n),e.r.copy(u,a,{x:h-o,y:d-o},{x:l-o,y:c-o},{width:o,height:o},n),e.r.copy(u,a,{x:0,y:d-o},{x:l+h,y:c-o},{width:o,height:o},n),e.r.copy(u,a,{x:0,y:0},{x:l+h,y:c+d},{width:o,height:o},n),e.r.copy(u,a,{x:h-o,y:0},{x:l-o,y:c+d},{width:o,height:o},n)}this.dirty=!0}beginFrame(){for(const e in this.images)this.callbackDispatchedThisFrame[e]={}}dispatchRenderCallbacks(e,t){for(const n of e){if(this.callbackDispatchedThisFrame[t][n])continue;this.callbackDispatchedThisFrame[t][n]=!0;const e=this.images[t][n];W(e)&&this.updateImage(n,t,e)}}}function Y(t){const n=t.key,r=t.value,i=t.valueSpec||{},o=t.objectElementValidators||{},a=t.style,s=t.styleSpec;let l=[];const c=e.B(r);if("object"!==c)return[new e.V(n,r,"object expected, ".concat(c," found"))];for(const u in r){const t=u.split(".")[0];let c;o[t]?c=o[t]:i[t]?c=ye:o["*"]?c=o["*"]:i["*"]&&(c=ye),c?l=l.concat(c({key:(n?"".concat(n,"."):n)+u,value:r[u],valueSpec:i[t]||i["*"],style:a,styleSpec:s,object:r,objectKey:u},r)):l.push(new e.A(n,r[u],'unknown property "'.concat(u,'"')))}for(const u in i)o[u]||i[u].required&&void 0===i[u].default&&void 0===r[u]&&l.push(new e.V(n,r,'missing required property "'.concat(u,'"')));return l}function K(t){const n=t.value,r=t.valueSpec,i=t.style,o=t.styleSpec,a=t.key,s=t.arrayElementValidator||ye;if("array"!==e.B(n))return[new e.V(a,n,"array expected, ".concat(e.B(n)," found"))];if(r.length&&n.length!==r.length)return[new e.V(a,n,"array length ".concat(r.length," expected, length ").concat(n.length," found"))];if(r["min-length"]&&n.length<r["min-length"])return[new e.V(a,n,"array length at least ".concat(r["min-length"]," expected, length ").concat(n.length," found"))];let l={type:r.value,values:r.values,minimum:r.minimum,maximum:r.maximum,function:void 0};o.$version<7&&(l.function=r.function),"object"===e.B(r.value)&&(l=r.value);let c=[];for(let e=0;e<n.length;e++)c=c.concat(s({array:n,arrayIndex:e,value:n[e],valueSpec:l,style:i,styleSpec:o,key:"".concat(a,"[").concat(e,"]")},!0));return c}function J(t){const n=t.key,r=t.value,i=t.valueSpec;let o=e.B(r);if("number"===o&&r!=r&&(o="NaN"),"number"!==o)return[new e.V(n,r,"number expected, ".concat(o," found"))];if("minimum"in i){let o=i.minimum;if("array"===e.B(i.minimum)&&(o=i.minimum[t.arrayIndex]),r<o)return[new e.V(n,r,"".concat(r," is less than the minimum value ").concat(o))]}if("maximum"in i){let o=i.maximum;if("array"===e.B(i.maximum)&&(o=i.maximum[t.arrayIndex]),r>o)return[new e.V(n,r,"".concat(r," is greater than the maximum value ").concat(o))]}return[]}function Q(t){const n=t.valueSpec,r=e.D(t.value.type);let i,o,a,s={};const l="categorical"!==r&&void 0===t.value.property,c=!l,u="array"===e.B(t.value.stops)&&"array"===e.B(t.value.stops[0])&&"object"===e.B(t.value.stops[0][0]),h=Y({key:t.key,value:t.value,valueSpec:t.styleSpec.function,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(t){if("identity"===r)return[new e.V(t.key,t.value,'identity function may not have a "stops" property')];let n=[];const i=t.value;return n=n.concat(K({key:t.key,value:i,valueSpec:t.valueSpec,style:t.style,styleSpec:t.styleSpec,arrayElementValidator:d})),"array"===e.B(i)&&0===i.length&&n.push(new e.V(t.key,i,"array must have at least one stop")),n},default:function(e){return ye({key:e.key,value:e.value,valueSpec:n,style:e.style,styleSpec:e.styleSpec})}}});return"identity"===r&&l&&h.push(new e.V(t.key,t.value,'missing required property "property"')),"identity"===r||t.value.stops||h.push(new e.V(t.key,t.value,'missing required property "stops"')),"exponential"===r&&t.valueSpec.expression&&!e.F(t.valueSpec)&&h.push(new e.V(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(c&&!e.G(t.valueSpec)?h.push(new e.V(t.key,t.value,"property functions not supported")):l&&!e.H(t.valueSpec)&&h.push(new e.V(t.key,t.value,"zoom functions not supported"))),"categorical"!==r&&!u||void 0!==t.value.property||h.push(new e.V(t.key,t.value,'"property" property is required')),h;function d(t){let r=[];const i=t.value,l=t.key;if("array"!==e.B(i))return[new e.V(l,i,"array expected, ".concat(e.B(i)," found"))];if(2!==i.length)return[new e.V(l,i,"array length 2 expected, length ".concat(i.length," found"))];if(u){if("object"!==e.B(i[0]))return[new e.V(l,i,"object expected, ".concat(e.B(i[0])," found"))];if(void 0===i[0].zoom)return[new e.V(l,i,"object stop key must have zoom")];if(void 0===i[0].value)return[new e.V(l,i,"object stop key must have value")];const n=e.D(i[0].zoom);if("number"!=typeof n)return[new e.V(l,i[0].zoom,"stop zoom values must be numbers")];if(a&&a>n)return[new e.V(l,i[0].zoom,"stop zoom values must appear in ascending order")];n!==a&&(a=n,o=void 0,s={}),r=r.concat(Y({key:"".concat(l,"[0]"),value:i[0],valueSpec:{zoom:{}},style:t.style,styleSpec:t.styleSpec,objectElementValidators:{zoom:J,value:p}}))}else r=r.concat(p({key:"".concat(l,"[0]"),value:i[0],valueSpec:{},style:t.style,styleSpec:t.styleSpec},i));return e.J(e.K(i[1]))?r.concat([new e.V("".concat(l,"[1]"),i[1],"expressions are not allowed in function stops.")]):r.concat(ye({key:"".concat(l,"[1]"),value:i[1],valueSpec:n,style:t.style,styleSpec:t.styleSpec}))}function p(t,a){const l=e.B(t.value),c=e.D(t.value),u=null!==t.value?t.value:a;if(i){if(l!==i)return[new e.V(t.key,u,"".concat(l," stop domain type must match previous stop domain type ").concat(i))]}else i=l;if("number"!==l&&"string"!==l&&"boolean"!==l&&"number"!=typeof c&&"string"!=typeof c&&"boolean"!=typeof c)return[new e.V(t.key,u,"stop domain value must be a number, string, or boolean")];if("number"!==l&&"categorical"!==r){let i="number expected, ".concat(l," found");return e.G(n)&&void 0===r&&(i+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new e.V(t.key,u,i)]}return"categorical"!==r||"number"!==l||"number"==typeof c&&isFinite(c)&&Math.floor(c)===c?"categorical"!==r&&"number"===l&&"number"==typeof c&&"number"==typeof o&&void 0!==o&&c<o?[new e.V(t.key,u,"stop domain values must appear in ascending order")]:(o=c,"categorical"===r&&c in s?[new e.V(t.key,u,"stop domain values must be unique")]:(s[c]=!0,[])):[new e.V(t.key,u,"integer expected, found ".concat(String(c)))]}}function $(t){const n=("property"===t.expressionContext?e.L:e.M)(e.K(t.value),t.valueSpec);if("error"===n.result)return n.value.map((n=>new e.V("".concat(t.key).concat(n.key),t.value,n.message)));const r=n.value.expression||n.value._styleExpression.expression;if("property"===t.expressionContext&&"text-font"===t.propertyKey&&!r.outputDefined())return[new e.V(t.key,t.value,'Invalid data expression for "'.concat(t.propertyKey,'". Output values must be contained as literals within the expression.'))];if("property"===t.expressionContext&&"layout"===t.propertyType&&!e.N(r))return[new e.V(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===t.expressionContext)return ee(r,t);if(t.expressionContext&&0===t.expressionContext.indexOf("cluster")){if(!e.O(r,["zoom","feature-state"]))return[new e.V(t.key,t.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===t.expressionContext&&!e.Q(r))return[new e.V(t.key,t.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ee(t,n){const r=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(n.valueSpec&&n.valueSpec.expression)for(const e of n.valueSpec.expression.parameters)r.delete(e);if(0===r.size)return[];const i=[];return t instanceof e.S&&r.has(t.name)?[new e.V(n.key,n.value,'["'.concat(t.name,'"] expression is not supported in a filter for a ').concat(n.object.type," layer with id: ").concat(n.object.id))]:(t.eachChild((e=>{i.push(...ee(e,n))})),i)}function te(t){const n=t.key,r=t.value,i=t.valueSpec,o=[];return Array.isArray(i.values)?-1===i.values.indexOf(e.D(r))&&o.push(new e.V(n,r,"expected one of [".concat(i.values.join(", "),"], ").concat(JSON.stringify(r)," found"))):-1===Object.keys(i.values).indexOf(e.D(r))&&o.push(new e.V(n,r,"expected one of [".concat(Object.keys(i.values).join(", "),"], ").concat(JSON.stringify(r)," found"))),o}function ne(t){return e.W(e.K(t.value))?$(e.C({},t,{expressionContext:"filter",valueSpec:t.styleSpec["filter_".concat(t.layerType||"fill")]})):re(t)}function re(t){const n=t.value,r=t.key;if("array"!==e.B(n))return[new e.V(r,n,"array expected, ".concat(e.B(n)," found"))];const i=t.styleSpec;let o,a=[];if(n.length<1)return[new e.V(r,n,"filter array must have at least 1 element")];switch(a=a.concat(te({key:"".concat(r,"[0]"),value:n[0],valueSpec:i.filter_operator,style:t.style,styleSpec:t.styleSpec})),e.D(n[0])){case"<":case"<=":case">":case">=":n.length>=2&&"$type"===e.D(n[1])&&a.push(new e.V(r,n,'"$type" cannot be use with operator "'.concat(n[0],'"')));case"==":case"!=":3!==n.length&&a.push(new e.V(r,n,'filter array for operator "'.concat(n[0],'" must have 3 elements')));case"in":case"!in":n.length>=2&&(o=e.B(n[1]),"string"!==o&&a.push(new e.V("".concat(r,"[1]"),n[1],"string expected, ".concat(o," found"))));for(let s=2;s<n.length;s++)o=e.B(n[s]),"$type"===e.D(n[1])?a=a.concat(te({key:"".concat(r,"[").concat(s,"]"),value:n[s],valueSpec:i.geometry_type,style:t.style,styleSpec:t.styleSpec})):"string"!==o&&"number"!==o&&"boolean"!==o&&a.push(new e.V("".concat(r,"[").concat(s,"]"),n[s],"string, number, or boolean expected, ".concat(o," found")));break;case"any":case"all":case"none":for(let e=1;e<n.length;e++)a=a.concat(re({key:"".concat(r,"[").concat(e,"]"),value:n[e],style:t.style,styleSpec:t.styleSpec}));break;case"has":case"!has":o=e.B(n[1]),2!==n.length?a.push(new e.V(r,n,'filter array for "'.concat(n[0],'" operator must have 2 elements'))):"string"!==o&&a.push(new e.V("".concat(r,"[1]"),n[1],"string expected, ".concat(o," found")))}return a}function ie(t,n){const r=t.key,i=t.style,o=t.layer,a=t.styleSpec,s=t.value,l=t.objectKey,c=a["".concat(n,"_").concat(t.layerType)];if(!c)return[];const u=l.match(/^(.*)-transition$/);if("paint"===n&&u&&c[u[1]]&&c[u[1]].transition)return ye({key:r,value:s,valueSpec:a.transition,style:i,styleSpec:a});const h=t.valueSpec||c[l];if(!h)return[new e.A(r,s,'unknown property "'.concat(l,'"'))];let d;if("string"===e.B(s)&&e.G(h)&&!h.tokens&&(d=/^{([^}]+)}$/.exec(s))){const t='`{ "type": "identity", "property": '.concat(d?JSON.stringify(d[1]):'"_"'," }`");return[new e.V(r,s,'"'.concat(l,'" does not support interpolation syntax\nUse an identity property function instead: ').concat(t,"."))]}const p=[];if("symbol"===t.layerType)"text-field"!==l||!i||i.glyphs||i.imports||p.push(new e.V(r,s,'use of "text-field" requires a style "glyphs" property')),"text-font"===l&&e.X(e.K(s))&&"identity"===e.D(s.type)&&p.push(new e.V(r,s,'"text-font" does not support identity functions'));else if("model"===t.layerType&&"paint"===n&&o&&o.layout&&o.layout.hasOwnProperty("model-id")&&e.G(h)&&(e.Y(h)||e.H(h))){const t=e.L(e.K(s),h),n=t.value.expression||t.value._styleExpression.expression;n&&!e.O(n,["measure-light"])&&("model-emissive-strength"===l&&e.Q(n)&&e.N(n)||p.push(new e.V(r,s,"".concat(l," does not support measure-light expressions when the model layer source is vector tile or GeoJSON."))))}return p.concat(ye({key:t.key,value:s,valueSpec:h,style:i,styleSpec:a,expressionContext:"property",propertyType:n,propertyKey:l}))}function oe(e){return ie(e,"paint")}function ae(e){return ie(e,"layout")}function se(t){let n=[];const r=t.value,i=t.key,o=t.style,a=t.styleSpec;r.type||r.ref||n.push(new e.V(i,r,'either "type" or "ref" is required'));let s=e.D(r.type);const l=e.D(r.ref);if(r.id){const a=e.D(r.id);for(let s=0;s<t.arrayIndex;s++){const t=o.layers[s];e.D(t.id)===a&&n.push(new e.V(i,r.id,'duplicate layer id "'.concat(r.id,'", previously used at line ').concat(t.id.__line__)))}}if("ref"in r){let t;["type","source","source-layer","filter","layout"].forEach((t=>{t in r&&n.push(new e.V(i,r[t],'"'.concat(t,'" is prohibited for ref layers')))})),o.layers.forEach((n=>{e.D(n.id)===l&&(t=n)})),t?t.ref?n.push(new e.V(i,r.ref,"ref cannot reference another ref layer")):s=e.D(t.type):"string"==typeof l&&n.push(new e.V(i,r.ref,'ref layer "'.concat(l,'" not found')))}else if("background"!==s&&"sky"!==s&&"slot"!==s)if(r.source){const t=o.sources&&o.sources[r.source],a=t&&e.D(t.type);t?"vector"===a&&"raster"===s?n.push(new e.V(i,r.source,'layer "'.concat(r.id,'" requires a raster source'))):"raster"===a&&"raster"!==s?n.push(new e.V(i,r.source,'layer "'.concat(r.id,'" requires a vector source'))):"vector"!==a||r["source-layer"]?"raster-dem"===a&&"hillshade"!==s?n.push(new e.V(i,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):"raster-array"!==a||["raster","raster-particle"].includes(s)?"line"!==s||!r.paint||!r.paint["line-gradient"]&&!r.paint["line-trim-offset"]||"geojson"===a&&t.lineMetrics?"raster-particle"===s&&"raster-array"!==a&&n.push(new e.V(i,r.source,'layer "'.concat(r.id,"\" requires a 'raster-array' source."))):n.push(new e.V(i,r,'layer "'.concat(r.id,'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.'))):n.push(new e.V(i,r.source,"raster-array source can only be used with layer type 'raster'.")):n.push(new e.V(i,r,'layer "'.concat(r.id,'" must specify a "source-layer"'))):n.push(new e.V(i,r.source,'source "'.concat(r.source,'" not found')))}else n.push(new e.V(i,r,'missing required property "source"'));return n=n.concat(Y({key:i,value:r,valueSpec:a.layer,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":()=>[],type:()=>ye({key:"".concat(i,".type"),value:r.type,valueSpec:a.layer.type,style:t.style,styleSpec:t.styleSpec,object:r,objectKey:"type"}),filter:t=>ne(e.C({layerType:s},t)),layout:t=>Y({layer:r,key:t.key,value:t.value,valueSpec:{},style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":t=>ae(e.C({layerType:s},t))}}),paint:t=>Y({layer:r,key:t.key,value:t.value,valueSpec:{},style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":t=>oe(e.C({layerType:s,layer:r},t))}})}})),n}function le(t){const n=t.value,r=t.key,i=e.B(n);return"string"!==i?[new e.V(r,n,"string expected, ".concat(i," found"))]:[]}const ce={promoteId:function(t){let{key:n,value:r}=t;if("string"===e.B(r))return le({key:n,value:r});{const e=[];for(const t in r)e.push(...le({key:"".concat(n,".").concat(t),value:r[t]}));return e}}};function ue(t){const n=t.value,r=t.key,i=t.styleSpec,o=t.style;if(!n.type)return[new e.V(r,n,'"type" is required')];const a=e.D(n.type);let s=[];switch(["vector","raster","raster-dem","raster-array"].includes(a)&&(n.url||n.tiles||s.push(new e.A(r,n,'Either "url" or "tiles" is required.'))),a){case"vector":case"raster":case"raster-dem":case"raster-array":return s=s.concat(Y({key:r,value:n,valueSpec:i["source_".concat(a.replace("-","_"))],style:t.style,styleSpec:i,objectElementValidators:ce})),s;case"geojson":if(s=Y({key:r,value:n,valueSpec:i.source_geojson,style:o,styleSpec:i,objectElementValidators:ce}),n.cluster)for(const e in n.clusterProperties){const[t,i]=n.clusterProperties[e],o="string"==typeof t?[t,["accumulated"],["get",e]]:t;s.push(...$({key:"".concat(r,".").concat(e,".map"),value:i,expressionContext:"cluster-map"})),s.push(...$({key:"".concat(r,".").concat(e,".reduce"),value:o,expressionContext:"cluster-reduce"}))}return s;case"video":return Y({key:r,value:n,valueSpec:i.source_video,style:o,styleSpec:i});case"image":return Y({key:r,value:n,valueSpec:i.source_image,style:o,styleSpec:i});case"canvas":return[new e.V(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return te({key:"".concat(r,".type"),value:n.type,valueSpec:{values:he(i)},style:o,styleSpec:i})}}function he(e){return e.source.reduce(((t,n)=>{const r=e[n];return"enum"===r.type.type&&(t=t.concat(Object.keys(r.type.values))),t}),[])}function de(t){const n=t.value,r=t.styleSpec,i=r.light,o=t.style;let a=[];const s=e.B(n);if(void 0===n)return a;if("object"!==s)return a=a.concat([new e.V("light",n,"object expected, ".concat(s," found"))]),a;for(const l in n){const t=l.match(/^(.*)-transition$/);a=a.concat(t&&i[t[1]]&&i[t[1]].transition?ye({key:l,value:n[l],valueSpec:r.transition,style:o,styleSpec:r}):i[l]?ye({key:l,value:n[l],valueSpec:i[l],style:o,styleSpec:r}):[new e.V(l,n[l],'unknown property "'.concat(l,'"'))])}return a}function pe(t){const n=t.value;let r=[];if(!n)return r;const i=e.B(n);if("object"!==i)return r=r.concat([new e.V("light-3d",n,"object expected, ".concat(i," found"))]),r;const o=t.styleSpec,a=o["light-3d"],s=t.key,l=t.style,c=t.style.lights;for(const d of["type","id"])if(!(d in n))return r=r.concat([new e.V("light-3d",n,"missing property ".concat(d," on light"))]),r;if(n.type&&c)for(let d=0;d<t.arrayIndex;d++){const t=e.D(n.type),i=c[d];e.D(i.type)===t&&r.push(new e.V(s,n.id,'duplicate light type "'.concat(n.type,'", previously defined at line ').concat(i.id.__line__)))}const u="properties_light_".concat(n.type);if(!(u in o))return r=r.concat([new e.V("light-3d",n,"Invalid light type ".concat(n.type))]),r;const h=o[u];for(const d in n)if("properties"===d){const i=n[d],a=e.B(i);if("object"!==a)return r=r.concat([new e.V("properties",i,"object expected, ".concat(a," found"))]),r;for(const n in i)r=r.concat(h[n]?ye({key:n,value:i[n],valueSpec:h[n],style:l,styleSpec:o}):[new e.A(t.key,i[n],'unknown property "'.concat(n,'"'))])}else{const t=d.match(/^(.*)-transition$/);r=r.concat(t&&a[t[1]]&&a[t[1]].transition?ye({key:d,value:n[d],valueSpec:o.transition,style:l,styleSpec:o}):a[d]?ye({key:d,value:n[d],valueSpec:a[d],style:l,styleSpec:o}):[new e.A(d,n[d],'unknown property "'.concat(d,'"'))])}return r}function fe(t){const n=t.value,r=t.key,i=t.style,o=t.styleSpec,a=o.terrain;let s=[];const l=e.B(n);if(void 0===n)return s;if("null"===l)return s;if("object"!==l)return s=s.concat([new e.V("terrain",n,"object expected, ".concat(l," found"))]),s;for(const c in n){const t=c.match(/^(.*)-transition$/);s=s.concat(t&&a[t[1]]&&a[t[1]].transition?ye({key:c,value:n[c],valueSpec:o.transition,style:i,styleSpec:o}):a[c]?ye({key:c,value:n[c],valueSpec:a[c],style:i,styleSpec:o}):[new e.A(c,n[c],'unknown property "'.concat(c,'"'))])}if(n.source){const t=i.sources&&i.sources[n.source],o=t&&e.D(t.type);t?"raster-dem"!==o&&s.push(new e.V(r,n.source,"terrain cannot be used with a source of type ".concat(String(o),', it only be used with a "raster-dem" source type'))):s.push(new e.V(r,n.source,'source "'.concat(n.source,'" not found')))}else s.push(new e.V(r,n,'terrain is missing required property "source"'));return s}function me(t){const n=t.value,r=t.style,i=t.styleSpec,o=i.fog;let a=[];const s=e.B(n);if(void 0===n)return a;if("object"!==s)return a=a.concat([new e.V("fog",n,"object expected, ".concat(s," found"))]),a;for(const l in n){const t=l.match(/^(.*)-transition$/);a=a.concat(t&&o[t[1]]&&o[t[1]].transition?ye({key:l,value:n[l],valueSpec:i.transition,style:r,styleSpec:i}):o[l]?ye({key:l,value:n[l],valueSpec:o[l],style:r,styleSpec:i}):[new e.A(l,n[l],'unknown property "'.concat(l,'"'))])}return a}const ge={"*":()=>[],array:K,boolean:function(t){const n=t.value,r=t.key,i=e.B(n);return"boolean"!==i?[new e.V(r,n,"boolean expected, ".concat(i," found"))]:[]},number:J,color:function(t){const n=t.key,r=t.value,i=e.B(r);return"string"!==i?[new e.V(n,r,"color expected, ".concat(i," found"))]:null===e.U.parseCSSColor(r)?[new e.V(n,r,'color expected, "'.concat(r,'" found'))]:[]},enum:te,filter:ne,function:Q,layer:se,object:Y,source:ue,model:e.Z,light:de,"light-3d":pe,terrain:fe,fog:me,string:le,formatted:function(e){return 0===le(e).length?[]:$(e)},resolvedImage:function(e){return 0===le(e).length?[]:$(e)},projection:function(t){const n=t.value,r=t.styleSpec,i=r.projection,o=t.style;let a=[];const s=e.B(n);if("object"===s)for(const e in n)a=a.concat(ye({key:e,value:n[e],valueSpec:i[e],style:o,styleSpec:r}));else"string"!==s&&(a=a.concat([new e.V("projection",n,"object or string expected, ".concat(s," found"))]));return a},import:function(t){const{value:n,styleSpec:i}=t,{data:a}=n,s=r(n,o);Object.defineProperty(s,"__line__",{value:n.__line__,enumerable:!1});let l=Y(e.C({},t,{value:s,valueSpec:i.import}));return""===e.D(s.id)&&l.push(new e.V("".concat(t.key,".id"),s,"import id can't be an empty string")),a&&(l=l.concat(ve(a,i,{key:"".concat(t.key,".data")}))),l}};function ye(t){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=t.value,i=t.valueSpec,o=t.styleSpec;if(i.expression&&e.X(e.D(r)))return Q(t);if(i.expression&&e.J(e.K(r)))return $(t);if(i.type&&ge[i.type]){const r=ge[i.type](t);return!0===n&&r.length>0&&"array"===e.B(t.value)?$(t):r}return Y(e.C({},t,{valueSpec:i.type?o[i.type]:i}))}function _e(t){const n=t.value,r=t.key,i=le(t);return i.length||(-1===n.indexOf("{fontstack}")&&i.push(new e.V(r,n,'"glyphs" url must include a "{fontstack}" token')),-1===n.indexOf("{range}")&&i.push(new e.V(r,n,'"glyphs" url must include a "{range}" token'))),i}function ve(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e._;return ye({key:(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).key||"",value:t,valueSpec:n.$root,styleSpec:n,style:t,objectElementValidators:{glyphs:_e,"*":()=>[]}})}function xe(t){return je(ve(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:e._))}const be=e=>je(ue(e)),we=e=>je(de(e)),Se=e=>je(pe(e)),Te=e=>je(fe(e)),Ee=e=>je(me(e)),Ae=e=>je(se(e)),Me=e=>je(ne(e)),Pe=e=>je(oe(e)),ke=e=>je(ae(e)),Ce=t=>je(e.Z(t));function je(e){return e.slice().sort(((e,t)=>e.line&&t.line?e.line-t.line:0))}function Ie(t,n){let r=!1;if(n&&n.length)for(const i of n)i instanceof e.A?e.w(i.message):(t.fire(new e.t(new Error(i.message))),r=!0);return r}let Oe;class Ne extends e.E{constructor(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"flat";super(),this._transitionable=new e.$(Oe||(Oe=new e.a0({anchor:new e.a1(e._.light.anchor),position:new e.a2(e._.light.position),color:new e.a1(e._.light.color),intensity:new e.a1(e._.light.intensity)}))),this.setLight(t,n),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._validate(we,e,n)||(this._transitionable.setTransitionOrValue(e),this.id=t)}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(t,n,r){return(!r||!1!==r.validate)&&Ie(this,t.call(xe,e.l({value:n,style:{glyphs:!0,sprite:!0},styleSpec:e._})))}}let De=class extends e.E{constructor(t,n,r,i){super(),this.scope=r,this._transitionable=new e.$(new e.a0({source:new e.a1(e._.terrain.source),exaggeration:new e.a1(e._.terrain.exaggeration)}),r,i),this._transitionable.setTransitionOrValue(t,i),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=n}get(){return this._transitionable.serialize()}set(e,t){this._transitionable.setTransitionOrValue(e,t)}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}getExaggeration(t){return this._transitioning.possiblyEvaluate(new e.a3(t)).get("exaggeration")}getAttenuationRange(){if(!this.isZoomDependent())return null;const t=this._transitionable._values.exaggeration;if(!t)return null;const n=t.value.expression;if(!n)return null;let r=-1,i=-1,o=1;for(const a of n.zoomStops)o=n.evaluate(new e.a3(a)),o>.01?(r=a,i=-1):i=a;return o<.01&&r>0&&i>r?[r,i]:null}isZoomDependent(){const t=this._transitionable._values.exaggeration;return null!=t&&null!=t.value&&null!=t.value.expression&&t.value.expression instanceof e.a4}};const Le=45,ze=65,Re=.05;function Fe(t,n,r,i){const o=e.a7(Le,ze,r),[a,s]=Be(t,i);let l=1-Math.min(1,Math.exp((n-a)/(s-a)*-6));return l*=l*l,l=Math.min(1,1.00747*l),l*o*t.alpha}function Be(e,t){const n=.5/Math.tan(.5*t);return[e.range[0]+n,e.range[1]+n]}function Ve(t,n,r,i,o){const a=e.a6.vec3.transformMat4([],[n,r,i],o.mercatorFogMatrix);return Fe(t,e.a6.vec3.length(a),o.pitch,o._fov)}function Ue(t,n,r,i,o,a,s){const l=[[r,i,0],[o,i,0],[o,a,0],[r,a,0]];let c=Number.MAX_VALUE,u=-Number.MAX_VALUE;for(const h of l){const t=e.a6.vec3.transformMat4([],h,n),r=e.a6.vec3.length(t);c=Math.min(c,r),u=Math.max(u,r)}return[Fe(t,c,s.pitch,s._fov),Fe(t,u,s.pitch,s._fov)]}class Ge extends e.E{constructor(t,n,r,i){super();const o=new e.a0({range:new e.a1(e._.fog.range),color:new e.a1(e._.fog.color),"high-color":new e.a1(e._.fog["high-color"]),"space-color":new e.a1(e._.fog["space-color"]),"horizon-blend":new e.a1(e._.fog["horizon-blend"]),"star-intensity":new e.a1(e._.fog["star-intensity"]),"vertical-range":new e.a1(e._.fog["vertical-range"])});this._transitionable=new e.$(o,r,new Map(i)),this.set(t,i),this._transitioning=this._transitionable.untransitioned(),this._transform=n,this.properties=new e.a8(o),this.scope=r}get state(){const t=this._transform,n="globe"===t.projection.name,r=e.a9(t.zoom),i=this.properties.get("range"),o=[.5,3];return{range:n?[e.aa(o[0],i[0],r),e.aa(o[1],i[1],r)]:i,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this._validate(Ee,t,r))return;const i=e.l({},t);for(const o of Object.keys(e._.fog))void 0===i[o]&&(i[o]=e._.fog[o].default);this._options=i,this._transitionable.setTransitionOrValue(this._options,n)}getOpacity(t){if(!this._transform.projection.supportsFog)return 0;const n=this.properties&&this.properties.get("color")||1;return("globe"===this._transform.projection.name?1:e.a7(Le,ze,t))*n.a}getOpacityAtLatLng(t,n){return this._transform.projection.supportsFog?function(t,n,r){const i=e.a5.fromLngLat(n),o=r.elevation?r.elevation.getAtPointOrZero(i):0;return Ve(t,i.x,i.y,o,r)}(this.state,t,n):0}getOpacityForTile(t){if(!this._transform.projection.supportsFog)return[1,1];const n=this._transform.calculateFogTileMatrix(t.toUnwrapped());return Ue(this.state,n,0,0,e.ab,e.ab,this._transform)}getOpacityForBounds(e,t,n,r,i){return this._transform.projection.supportsFog?Ue(this.state,e,t,n,r,i,this._transform):[1,1]}getFovAdjustedRange(e){return this._transform.projection.supportsFog?Be(this.state,e):[0,1]}isVisibleOnFrustum(t){if(!this._transform.projection.supportsFog)return!1;const n=[4,5,6,7];for(const r of n){const n=t.points[r];let i;if(n[2]>=0)i=n;else{const o=t.points[r-4];i=e.ac(o,n,o[2]/(o[2]-n[2]))}if(Ve(this.state,i[0],i[1],0,this._transform)>=Re)return!0}return!1}updateConfig(e){this._transitionable.setTransitionOrValue(this._options,new Map(e))}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(t,n,r){return(!r||!1!==r.validate)&&Ie(this,t.call(xe,e.l({value:n,style:{glyphs:!0,sprite:!0},styleSpec:e._})))}}class He extends e.E{constructor(t,n,r,i){super(),this.scope=r,this._options=t,this.properties=new e.a8(n),this._transitionable=new e.$(n,r,new Map(i)),this._transitionable.setTransitionOrValue(t.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(e){this._transitionable.setTransitionOrValue(this._options.properties,new Map(e))}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(e,t){this._options=e,this._transitionable.setTransitionOrValue(e.properties,t)}shadowsEnabled(){return!!this.properties&&!0===this.properties.get("cast-shadows")}}let Ze,qe;class We{constructor(e,t,n,r){this.screenBounds=e,this.cameraPoint=t,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=n,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,r)}static createFromScreenPoints(t,n){let r,i;if(t instanceof e.P||"number"==typeof t[0]){const o=e.P.convert(t);r=[o],i=n.isPointAboveHorizon(o)}else{const o=e.P.convert(t[0]),a=e.P.convert(t[1]);r=[o,a],i=e.ae(o,a).every((e=>n.isPointAboveHorizon(e)))}return new We(r,n.getCameraPoint(),i,n)}isPointQuery(){return 1===this.screenBounds.length}bufferedScreenGeometry(t){return e.ae(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],t)}bufferedCameraGeometry(t){const n=this.screenBounds[0],r=1===this.screenBounds.length?this.screenBounds[0].add(new e.P(1,1)):this.screenBounds[1],i=e.ae(n,r,0,!1);return this.cameraPoint.y>r.y&&(this.cameraPoint.x>n.x&&this.cameraPoint.x<r.x?i.splice(3,0,this.cameraPoint):this.cameraPoint.x>=r.x?i[2]=this.cameraPoint:this.cameraPoint.x<=n.x&&(i[3]=this.cameraPoint)),e.af(i,t)}bufferedCameraGeometryGlobe(t){const n=this.screenBounds[0],r=1===this.screenBounds.length?this.screenBounds[0].add(new e.P(1,1)):this.screenBounds[1],i=e.ae(n,r,t),o=this.cameraPoint.clone();switch(3*((o.y>n.y)+(o.y>r.y))+((o.x>n.x)+(o.x>r.x))){case 0:i[0]=o,i[4]=o.clone();break;case 1:i.splice(1,0,o);break;case 2:i[1]=o;break;case 3:i.splice(4,0,o);break;case 5:i.splice(2,0,o);break;case 6:i[3]=o;break;case 7:i.splice(3,0,o);break;case 8:i[2]=o}return i}containsTile(t,n,r){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const o=t.queryPadding/n._pixelsPerMercatorPixel+1,a=r?this._bufferedCameraMercator(o,n):this._bufferedScreenMercator(o,n);let s=t.tileID.wrap+(a.unwrapped?i:0);const l=a.polygon.map((n=>e.ag(t.tileTransform,n,s)));if(!e.ah(l,0,0,e.ab,e.ab))return;s=t.tileID.wrap+(this.screenGeometryMercator.unwrapped?i:0);const c=this.screenGeometryMercator.polygon.map((n=>e.ai(t.tileTransform,n,s))),u=c.map((t=>new e.P(t[0],t[1]))),h=n.getFreeCameraOptions().position||new e.a5(0,0,0),d=e.ai(t.tileTransform,h,s),p=c.map((t=>{const n=e.a6.vec3.sub(t,t,d);return e.a6.vec3.normalize(n,n),new e.aj(d,n)})),f=e.ak(t,1,n.zoom)*n._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:u,tilespaceRays:p,bufferedTilespaceGeometry:l,bufferedTilespaceBounds:(m=e.al(l),m.min.x=e.ap(m.min.x,0,e.ab),m.min.y=e.ap(m.min.y,0,e.ab),m.max.x=e.ap(m.max.x,0,e.ab),m.max.y=e.ap(m.max.y,0,e.ab),m),tile:t,tileID:t.tileID,pixelToTileUnitsFactor:f};var m}_bufferedScreenMercator(e,t){const n=Ke(e);if(this._screenRaycastCache[n])return this._screenRaycastCache[n];{let r;return r="globe"===t.projection.name?this._projectAndResample(this.bufferedScreenGeometry(e),t):{polygon:this.bufferedScreenGeometry(e).map((e=>t.pointCoordinate3D(e))),unwrapped:!0},this._screenRaycastCache[n]=r,r}}_bufferedCameraMercator(e,t){const n=Ke(e);if(this._cameraRaycastCache[n])return this._cameraRaycastCache[n];{let r;return r="globe"===t.projection.name?this._projectAndResample(this.bufferedCameraGeometryGlobe(e),t):{polygon:this.bufferedCameraGeometry(e).map((e=>t.pointCoordinate3D(e))),unwrapped:!0},this._cameraRaycastCache[n]=r,r}}_projectAndResample(t,n){const r=function(t,n){const r=e.a6.mat4.multiply([],n.pixelMatrix,n.globeMatrix),i=[0,-e.aq,0,1],o=[0,e.aq,0,1],a=[0,0,0,1];e.a6.vec4.transformMat4(i,i,r),e.a6.vec4.transformMat4(o,o,r),e.a6.vec4.transformMat4(a,a,r);const s=new e.P(i[0]/i[3],i[1]/i[3]),l=new e.P(o[0]/o[3],o[1]/o[3]),c=e.an(t,s)&&i[3]<a[3],u=e.an(t,l)&&o[3]<a[3];if(!c&&!u)return null;const h=function(e,t,n){for(let r=1;r<e.length;r++){const i=Ye(t.pointCoordinate3D(e[r-1]).x),o=Ye(t.pointCoordinate3D(e[r]).x);if(n<0){if(i<o)return{idx:r,t:-i/(o-1-i)}}else if(o<i)return{idx:r,t:(1-i)/(o+1-i)}}return null}(t,n,c?-1:1);if(!h)return null;const{idx:d,t:p}=h;let f=d>1?Xe(t.slice(0,d),n):[],m=d<t.length?Xe(t.slice(d),n):[];f=f.map((t=>new e.P(Ye(t.x),t.y))),m=m.map((t=>new e.P(Ye(t.x),t.y)));const g=[...f];0===g.length&&g.push(m[m.length-1]);const y=e.aa(g[g.length-1].y,(0===m.length?f[0]:m[0]).y,p);let _;return _=c?[new e.P(0,y),new e.P(0,0),new e.P(1,0),new e.P(1,y)]:[new e.P(1,y),new e.P(1,1),new e.P(0,1),new e.P(0,y)],g.push(..._),0===m.length?g.push(f[0]):g.push(...m),{polygon:g.map((t=>new e.a5(t.x,t.y))),unwrapped:!1}}(t,n);if(r)return r;const i=function(t,n){let r=!1,i=-1/0,o=0;for(let e=0;e<t.length-1;e++)t[e].x>i&&(i=t[e].x,o=e);for(let e=0;e<t.length-1;e++){const n=(o+e)%(t.length-1),i=t[n],a=t[n+1];Math.abs(i.x-a.x)>.5&&(i.x<a.x?(i.x+=1,0===n&&(t[t.length-1].x+=1)):(a.x+=1,n+1===t.length-1&&(t[0].x+=1)),r=!0)}const a=e.am(n.center.lng);return r&&a<Math.abs(a-1)&&t.forEach((e=>{e.x-=1})),{polygon:t,unwrapped:r}}(Xe(t,n).map((t=>new e.P(Ye(t.x),t.y))),n);return{polygon:i.polygon.map((t=>new e.a5(t.x,t.y))),unwrapped:i.unwrapped}}}function Xe(t,n){return e.ao(t,(e=>{const t=n.pointCoordinate3D(e);e.x=t.x,e.y=t.y}),1/256)}function Ye(e){return e<0?1+e%1:e%1}function Ke(e){return 100*e|0}function Je(t,n,i,o,s){const l=function(r,i){if(r)return s(r);if(i){if(t.url&&i.tiles&&t.tiles&&delete t.tiles,i.variants){if(!Array.isArray(i.variants))return s(new Error("variants must be an array"));for(const t of i.variants){if(null==t||"object"!=typeof t||t.constructor!==Object)return s(new Error("variant must be an object"));if(!Array.isArray(t.capabilities))return s(new Error("capabilities must be an array"));if(1===t.capabilities.length&&"meshopt"===t.capabilities[0]){i=e.l(i,t);break}}}const r=e.ar(e.l({},i,t),["tilejson","tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding","vector_layers","raster_layers","worldview_options","worldview_default","worldview"]);r.tiles=n.canonicalizeTileset(r,t.url),s(null,r)}},c=function(e,t,n){if(!e)return null;if(!t&&!n)return e;n=n||e.worldview_default;const r=Object.values(e.language||{});if(0===r.length)return null;const i=Object.values(e.worldview||{});if(0===i.length)return null;const o=r.every((e=>e===t)),a=i.every((e=>e===n));return o&&a?e:t in(e.language_options||{})||n in(e.worldview_options||{})?null:e.language_options&&e.worldview_options?e:null}(t.data,i,o);return c?e.q.frame((()=>l(null,c))):t.url?e.n(n.transformRequest(n.normalizeSourceURL(t.url,null,i,o),e.R.Source),l):e.q.frame((()=>{const{data:e}=t,n=r(t,a);l(null,n)}))}class Qe{constructor(t,n,r){this.bounds=e.as.convert(this.validateBounds(t)),this.minzoom=n||0,this.maxzoom=r||24}validateBounds(e){return Array.isArray(e)&&4===e.length?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}contains(t){const n=Math.pow(2,t.z),r=Math.floor(e.am(this.bounds.getWest())*n),i=Math.floor(e.at(this.bounds.getNorth())*n),o=Math.ceil(e.am(this.bounds.getEast())*n),a=Math.ceil(e.at(this.bounds.getSouth())*n);return t.x>=r&&t.x<o&&t.y>=i&&t.y<a}}class $e extends e.E{constructor(t,n,r,i){if(super(),this.id=t,this.dispatcher=r,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,e.l(this,e.ar(n,["url","scheme","tileSize","promoteId"])),this._options=e.l({type:"vector"},n),this._collectResourceTiming=!!n.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(i),this._tileWorkers={},this._deduped=new e.au}load(t){this._loaded=!1,this.fire(new e.x("dataloading",{dataType:"source"}));const n=Array.isArray(this.map._language)?this.map._language.join():this.map._language,r=this.map.getWorldview();this._tileJSONRequest=Je(this._options,this.map._requestManager,n,r,((i,o)=>{if(this._tileJSONRequest=null,this._loaded=!0,i)n&&console.warn("Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ".concat(n)),r&&console.warn("Requested worldview strings must be a valid ISO alpha-2 code. Found: ".concat(r)),this.fire(new e.t(i));else if(o){if(e.l(this,o),this.hasWorldviews=!!o.worldview_options,o.worldview_default&&(this.worldviewDefault=o.worldview_default),o.vector_layers){this.vectorLayers=o.vector_layers,this.vectorLayerIds=[],this.localizableLayerIds=new Set;for(const e of o.vector_layers)this.vectorLayerIds.push(e.id),o.worldview&&o.worldview[e.source]&&this.localizableLayerIds.add(e.id)}o.bounds&&(this.tileBounds=new Qe(o.bounds,this.minzoom,this.maxzoom)),D(o.tiles,this.map._requestManager._customAccessToken),this.fire(new e.x("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new e.x("data",{dataType:"source",sourceDataType:"content"}))}t&&t(i)}))}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}reload(){this.cancelTileJSONRequest();const t=e.av(this.id,this.scope);this.load((()=>this.map.style.clearSource(t)))}setTiles(e){return this._options.tiles=e,this.reload(),this}setUrl(e){return this.url=e,this._options.url=e,this.reload(),this}onRemove(e){this.cancelTileJSONRequest()}serialize(){return e.l({},this._options)}loadTile(t,n){const r=t.tileID.canonical.url(this.tiles,this.scheme),i=this.map._requestManager.normalizeTileURL(r),o=this.map._requestManager.transformRequest(i,e.R.Tile),a=this.map.style?this.map.style.getLut(this.scope):null,s=a?{image:a.image.clone()}:null,l={request:o,data:void 0,uid:t.uid,tileID:t.tileID,tileZoom:t.tileZoom,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,lut:s,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:e.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:t.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:t.isExtraShadowCaster,tessellationStep:this.map._tessellationStep,scaleFactor:this.map.getScaleFactor()};if(this.hasWorldviews&&e.f(r)&&(l.worldview=this.map.getWorldview()||this.worldviewDefault,l.localizableLayerIds=this.localizableLayerIds),l.request.collectResourceTiming=this._collectResourceTiming,t.actor&&"expired"!==t.state)"loading"===t.state?t.reloadCallback=n:t.request=t.actor.send("reloadTile",l,c.bind(this));else if(t.actor=this._tileWorkers[i]=this._tileWorkers[i]||this.dispatcher.getActor(),this.dispatcher.ready)t.request=t.actor.send("loadTile",l,c.bind(this),void 0,!0);else{const n=e.aw.call({deduped:this._deduped},l,((e,n)=>{e||!n?c.call(this,e):(l.data={cacheControl:n.cacheControl,expires:n.expires,rawData:n.rawData.slice(0)},t.actor&&t.actor.send("loadTile",l,c.bind(this),void 0,!0))}),!0);t.request={cancel:n}}function c(r,i){return delete t.request,t.aborted?n(null):r&&404!==r.status?n(r):(i&&i.resourceTiming&&(t.resourceTiming=i.resourceTiming),this.map._refreshExpiredTiles&&i&&t.setExpiryData(i),t.loadVectorData(i,this.map.painter),e.ax(this.dispatcher),n(null),void(t.reloadCallback&&(this.loadTile(t,t.reloadCallback),t.reloadCallback=null)))}}abortTile(e){e.request&&(e.request.cancel(),delete e.request),e.actor&&e.actor.send("abortTile",{uid:e.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(e,t){e.actor&&e.actor.send("removeTile",{uid:e.uid,type:this.type,source:this.id,scope:this.scope}),e.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class et extends e.E{constructor(t,n,r,i){super(),this.id=t,this.dispatcher=r,this.setEventedParent(i),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=e.l({type:"raster"},n),e.l(this,e.ar(n,["url","scheme","tileSize"]))}load(t){this._loaded=!1,this.fire(new e.x("dataloading",{dataType:"source"})),this._tileJSONRequest=Je(this._options,this.map._requestManager,null,null,((n,r)=>{this._tileJSONRequest=null,this._loaded=!0,n?this.fire(new e.t(n)):r&&(e.l(this,r),r.raster_layers&&(this.rasterLayers=r.raster_layers,this.rasterLayerIds=this.rasterLayers.map((e=>e.id))),r.bounds&&(this.tileBounds=new Qe(r.bounds,this.minzoom,this.maxzoom)),D(r.tiles),this.fire(new e.x("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new e.x("data",{dataType:"source",sourceDataType:"content"}))),t&&t(n)}))}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}reload(){this.cancelTileJSONRequest();const t=e.av(this.id,this.scope);this.load((()=>this.map.style.clearSource(t)))}setTiles(e){return this._options.tiles=e,this.reload(),this}setUrl(e){return this.url=e,this._options.url=e,this.reload(),this}onRemove(e){this.cancelTileJSONRequest()}serialize(){return e.l({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(t,n){const r=e.q.devicePixelRatio>=2,i=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme),r,this.tileSize);t.request=e.o(this.map._requestManager.transformRequest(i,e.R.Tile),((r,i,o,a)=>(delete t.request,t.aborted?(t.state="unloaded",n(null)):r?(t.state="errored",n(r)):i?(this.map._refreshExpiredTiles&&t.setExpiryData({cacheControl:o,expires:a}),t.setTexture(i,this.map.painter),t.state="loaded",e.ax(this.dispatcher),void n(null)):n(null))))}abortTile(e,t){e.request&&(e.request.cancel(),delete e.request),t&&t()}unloadTile(t,n){t.texture&&t.texture instanceof e.T?(t.destroy(!0),t.texture&&t.texture instanceof e.T&&this.map.painter.saveTileTexture(t.texture)):t.destroy(),n&&n()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class tt extends et{constructor(t,n,r,i){super(t,n,r,i),this.type="raster-array",this.maxzoom=22,this._options=e.l({type:"raster-array"},n)}triggerRepaint(e){const t=this.map.painter._terrain,n=this.map.style.getSourceCache(this.id);t&&t.enabled&&n&&t._clearRenderCacheForTile(n.id,e.tileID),this.map.triggerRepaint()}loadTile(t,n){const r=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),i=this.map._requestManager.transformRequest(r,e.R.Tile);t.requestParams=i,t.actor||(t.actor=this.dispatcher.getActor()),t.request=t.fetchHeader(void 0,((e,r,i,o)=>{if(delete t.request,t.aborted)return t.state="unloaded",n(null);if(e){if(20===e.code)return;return t.state="errored",n(e)}this.map._refreshExpiredTiles&&t.setExpiryData({cacheControl:i,expires:o}),t.state="empty",n(null)}))}unloadTile(t,n){const r=t.texture;r&&r instanceof e.T?(t.destroy(!0),this.map.painter.saveTileTexture(r)):(t.destroy(),t.flushQueues(),t._isHeaderLoaded=!1,delete t._mrt,delete t.textureDescriptor),t.fbo&&(t.fbo.destroy(),delete t.fbo),delete t.request,delete t.requestParams,delete t.neighboringTiles,t.state="unloaded"}prepareTile(t,n,r){t._isHeaderLoaded&&("empty"!==t.state&&(t.state="reloading"),t.fetchBand(n,r,((n,r)=>{if(n)return t.state="errored",this.fire(new e.t(n)),void this.triggerRepaint(t);r&&(t.setTexture(r,this.map.painter),t.state="loaded",this.triggerRepaint(t))})))}getInitialBand(e){if(!this.rasterLayers)return 0;const t=this.rasterLayers.find((t=>{let{id:n}=t;return n===e})),n=t&&t.fields,r=n&&n.bands&&n.bands;return r?r[0]:0}getTextureDescriptor(t,n,r){if(!t)return;const i=n.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!i)return;let o=null;n instanceof e.aB?o=n.paint.get("raster-array-band"):n instanceof e.aC&&(o=n.paint.get("raster-particle-array-band"));const a=o||this.getInitialBand(i);if(null!=a)if(t.textureDescriptor){if(!t.updateNeeded(i,a)||r)return Object.assign({},t.textureDescriptor,{texture:t.texture})}else this.prepareTile(t,i,a)}}const nt={vector:$e,raster:et,"raster-dem":class extends et{constructor(t,n,r,i){super(t,n,r,i),this.type="raster-dem",this.maxzoom=22,this._options=e.l({type:"raster-dem"},n),this.encoding=n.encoding||"mapbox"}loadTile(t,n){const r=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function i(e,r){e&&(t.state="errored",n(e)),r&&(t.dem=r,t.dem.onDeserialize(),t.needsHillshadePrepare=!0,t.needsDEMTextureUpload=!0,t.state="loaded",n(null))}t.request=e.o(this.map._requestManager.transformRequest(r,e.R.Tile),function(r,o,a,s){if(delete t.request,t.aborted)t.state="unloaded",n(null);else if(r)t.state="errored",n(r);else if(o){this.map._refreshExpiredTiles&&t.setExpiryData({cacheControl:a,expires:s});const n=ImageBitmap&&o instanceof ImageBitmap&&e.ay(),r=1-(o.width-e.az(o.width))/2;r<1||t.neighboringTiles||(t.neighboringTiles=this._getNeighboringTiles(t.tileID));const l=n?o:e.q.getImageData(o,r),c={uid:t.uid,coord:t.tileID,source:this.id,scope:this.scope,rawImageData:l,encoding:this.encoding,padding:r};t.actor&&"expired"!==t.state||(t.actor=this.dispatcher.getActor(),t.actor.send("loadDEMTile",c,i.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(t){const n=t.canonical,r=Math.pow(2,n.z),i=(n.x-1+r)%r,o=0===n.x?t.wrap-1:t.wrap,a=(n.x+1+r)%r,s=n.x+1===r?t.wrap+1:t.wrap,l={};return l[new e.aA(t.overscaledZ,o,n.z,i,n.y).key]={backfilled:!1},l[new e.aA(t.overscaledZ,s,n.z,a,n.y).key]={backfilled:!1},n.y>0&&(l[new e.aA(t.overscaledZ,o,n.z,i,n.y-1).key]={backfilled:!1},l[new e.aA(t.overscaledZ,t.wrap,n.z,n.x,n.y-1).key]={backfilled:!1},l[new e.aA(t.overscaledZ,s,n.z,a,n.y-1).key]={backfilled:!1}),n.y+1<r&&(l[new e.aA(t.overscaledZ,o,n.z,i,n.y+1).key]={backfilled:!1},l[new e.aA(t.overscaledZ,t.wrap,n.z,n.x,n.y+1).key]={backfilled:!1},l[new e.aA(t.overscaledZ,s,n.z,a,n.y+1).key]={backfilled:!1}),l}},"raster-array":tt,geojson:class extends e.E{constructor(t,n,r,i){super(),this.id=t,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=r.getActor(),this.setEventedParent(i),this._data=n.data,this._options=e.l({},n),this._collectResourceTiming=n.collectResourceTiming,void 0!==n.maxzoom&&(this.maxzoom=n.maxzoom),void 0!==n.minzoom&&(this.minzoom=n.minzoom),n.type&&(this.type=n.type),n.attribution&&(this.attribution=n.attribution),this.promoteId=n.promoteId;const o=e.ab/this.tileSize;this.workerOptions=e.l({source:this.id,scope:this.scope,cluster:n.cluster||!1,geojsonVtOptions:{buffer:(void 0!==n.buffer?n.buffer:128)*o,tolerance:(void 0!==n.tolerance?n.tolerance:.375)*o,extent:e.ab,maxZoom:this.maxzoom,lineMetrics:n.lineMetrics||!1,generateId:n.generateId||!1},superclusterOptions:{maxZoom:void 0!==n.clusterMaxZoom?n.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,n.clusterMinPoints||2),extent:e.ab,radius:(void 0!==n.clusterRadius?n.clusterRadius:50)*o,log:!1,generateId:n.generateId||!1},clusterProperties:n.clusterProperties,filter:n.filter,dynamic:n.dynamic},n.workerOptions)}onAdd(e){this.map=e,this.setData(this._data)}setData(e){return this._data=e,this._updateWorkerData(),this}updateData(t){if(!this._options.dynamic)return this.fire(new e.t(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")));if("string"!=typeof t&&("Feature"===t.type&&(t={type:"FeatureCollection",features:[t]}),"FeatureCollection"!==t.type))return this.fire(new e.t(new Error("Data to update should be a feature or a feature collection.")));if(this._coalesce&&"string"!=typeof t&&"string"!=typeof this._data&&"FeatureCollection"===this._data.type){const e=new Map;for(const t of this._data.features)e.set(t.id,t);for(const n of t.features)e.set(n.id,n);this._data.features=[...e.values()]}else this._data=t;return this._updateWorkerData(!0),this}getClusterExpansionZoom(e,t){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:e,source:this.id,scope:this.scope},t),this}getClusterChildren(e,t){return this.actor.send("geojson.getClusterChildren",{clusterId:e,source:this.id,scope:this.scope},t),this}getClusterLeaves(e,t,n,r){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:e,limit:t,offset:n},r),this}_updateWorkerData(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new e.x("dataloading",{dataType:"source"})),this._loaded=!1;const n=e.l({append:t},this.workerOptions);n.scope=this.scope;const r=this._data;"string"==typeof r?(n.request=this.map._requestManager.transformRequest(e.q.resolveURL(r),e.R.Source),n.request.collectResourceTiming=this._collectResourceTiming):n.data=JSON.stringify(r),this._pendingLoad=this.actor.send("".concat(this.type,".loadData"),n,((n,r)=>{if(this._loaded=!0,this._pendingLoad=null,n)this.fire(new e.t(n));else{const n={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&r&&r.resourceTiming&&r.resourceTiming[this.id]&&(n.resourceTiming=r.resourceTiming[this.id]),t&&(this._partialReload=!0),this.fire(new e.x("data",n)),this._partialReload=!1,this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(t),this._coalesce=!1)}))}loaded(){return this._loaded}loadTile(t,n){const r=t.actor?"reloadTile":"loadTile";t.actor=this.actor;const i=this.map.style?this.map.style.getLut(this.scope):null,o=i?{image:i.image.clone()}:null,a=this._partialReload,s={type:this.type,uid:t.uid,tileID:t.tileID,tileZoom:t.tileZoom,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,lut:o,scope:this.scope,pixelRatio:e.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0,scaleFactor:this.map.getScaleFactor(),partial:a};t.request=this.actor.send(r,s,((e,i)=>a&&!i?(t.state="loaded",n(null)):(delete t.request,t.destroy(),t.aborted?n(null):e?n(e):(t.loadVectorData(i,this.map.painter,"reloadTile"===r),n(null)))),void 0,"loadTile"===r)}abortTile(e){e.request&&(e.request.cancel(),delete e.request),e.aborted=!0}unloadTile(e,t){this.actor.send("removeTile",{uid:e.uid,type:this.type,source:this.id,scope:this.scope}),e.destroy()}onRemove(e){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return e.l({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends e.aD{constructor(e,t,n,r){super(e,t,n,r),this.roundZoom=!0,this.type="video",this.options=t}load(){this._loaded=!1;const t=this.options;this.urls=[];for(const n of t.urls)this.urls.push(this.map._requestManager.transformRequest(n,e.R.Source).url);e.aE(this.urls,((t,n)=>{this._loaded=!0,t?this.fire(new e.t(t)):n&&(this.video=n,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading())}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(t){if(this.video){const n=this.video.seekable;t<n.start(0)||t>n.end(0)?this.fire(new e.t(new e.V("sources.".concat(this.id),null,"Playback for this video can be set only between the ".concat(n.start(0)," and ").concat(n.end(0),"-second mark.")))):this.video.currentTime=t}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const t=this.map.painter.context,n=t.gl;this.texture?this.video.paused||(this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.video)):(this.texture=new e.T(t,this.video,n.RGBA8),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(t)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:e.aD,model:class extends e.E{constructor(e,t,n,r){super(),this.id=e,this.type="model",this.models=[],this._loaded=!1,this._options=t}load(){const t=[];for(const n in this._options.models){const r=this._options.models[n],i=e.aG(this.map._requestManager.transformRequest(r.uri,e.R.Model).url).then((t=>{if(!t)return;const i=e.aH(t),o=new e.aI(n,r.position,r.orientation,i);o.computeBoundsAndApplyParent(),this.models.push(o)})).catch((t=>{this.fire(new e.t(new Error("Could not load model ".concat(n," from ").concat(r.uri,": ").concat(t.message))))}));t.push(i)}return Promise.allSettled(t).then((()=>{this._loaded=!0,this.fire(new e.x("data",{dataType:"source",sourceDataType:"metadata"}))})).catch((t=>{this.fire(new e.t(new Error("Could not load models: ".concat(t.message))))}))}onAdd(e){this.map=e,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(e,t){}serialize(){return{type:"model"}}},"batched-model":class extends e.E{constructor(e,t,n,r){super(),this.type="batched-model",this.id=e,this.tileSize=512,this._options=t,this.tiles=this._options.tiles,this.maxzoom=t.maxzoom||19,this.minzoom=t.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=n,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(r)}onAdd(e){this.map=e,this.load()}load(t){this._loaded=!1,this.fire(new e.x("dataloading",{dataType:"source"}));const n=Array.isArray(this.map._language)?this.map._language.join():this.map._language,r=this.map.getWorldview();this._tileJSONRequest=Je(this._options,this.map._requestManager,n,r,((i,o)=>{this._tileJSONRequest=null,this._loaded=!0,i?(n&&console.warn("Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ".concat(n)),r&&2!==r.length&&console.warn("Requested worldview strings must be a valid ISO alpha-2 code. Found: ".concat(r)),this.fire(new e.t(i))):o&&(e.l(this,o),o.bounds&&(this.tileBounds=new Qe(o.bounds,this.minzoom,this.maxzoom)),D(o.tiles,this.map._requestManager._customAccessToken),this.fire(new e.x("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new e.x("data",{dataType:"source",sourceDataType:"content"}))),t&&t(i)}))}hasTransition(){return!1}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loaded(){return this._loaded}loadTile(t,n){const r=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme)),i={request:this.map._requestManager.transformRequest(r,e.R.Tile),data:void 0,uid:t.uid,tileID:t.tileID,tileZoom:t.tileZoom,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:t.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,lut:null,maxZoom:null,promoteId:null,pixelRatio:null,scaleFactor:null};if(t.actor&&"expired"!==t.state)if("loading"===t.state)t.reloadCallback=n;else{if(t.buckets){const e=Object.values(t.buckets);for(const t of e)t.dirty=!0;return void(t.state="loaded")}t.request=t.actor.send("reloadTile",i,o.bind(this))}else t.actor=this.dispatcher.getActor(),t.request=t.actor.send("loadTile",i,o.bind(this),void 0,!0);function o(e,r){return t.aborted?n(null):e&&404!==e.status?n(e):(this.map._refreshExpiredTiles&&r&&t.setExpiryData(r),t.loadModelData(r,this.map.painter),t.state="loaded",void n(null))}}serialize(){return e.l({},this._options)}},canvas:class extends e.aD{constructor(t,n,r,i){super(t,n,r,i),n.coordinates?Array.isArray(n.coordinates)&&4===n.coordinates.length&&!n.coordinates.some((e=>!Array.isArray(e)||2!==e.length||e.some((e=>"number"!=typeof e))))||this.fire(new e.t(new e.V("sources.".concat(t),null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new e.t(new e.V("sources.".concat(t),null,'missing required property "coordinates"'))),n.animate&&"boolean"!=typeof n.animate&&this.fire(new e.t(new e.V("sources.".concat(t),null,'optional "animate" property must be a boolean value'))),n.canvas?"string"==typeof n.canvas||n.canvas instanceof HTMLCanvasElement||this.fire(new e.t(new e.V("sources.".concat(t),null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new e.t(new e.V("sources.".concat(t),null,'missing required property "canvas"'))),this.options=n,this.animate=void 0===n.animate||n.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new e.t(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(e){this.pause()}prepare(){let t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),this._hasInvalidDimensions())return;if(0===Object.keys(this.tiles).length)return;const n=this.map.painter.context;this.texture?!t&&!this._playing||this.texture instanceof e.aF||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new e.T(n,this.canvas,n.gl.RGBA8,{premultiply:!0}),this._prepareData(n)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}},custom:class extends e.E{constructor(t,n,r,i){super(),this.id=t,this.type="custom",this._dataType="raster",this._dispatcher=r,this._implementation=n,this.setEventedParent(i),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new e.t(new Error("Missing implementation for ".concat(this.id," custom source")))),this._implementation.loadTile||this.fire(new e.t(new Error("Missing loadTile implementation for ".concat(this.id," custom source")))),this._implementation.bounds&&(this.tileBounds=new Qe(this._implementation.bounds,this.minzoom,this.maxzoom)),n.update=this._update.bind(this),n.clearTiles=this._clearTiles.bind(this),n.coveringTiles=this._coveringTiles.bind(this),e.l(this,e.ar(n,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return e.ar(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new e.x("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new e.x("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(t){this.map=t,this._loaded=!1,this.fire(new e.x("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(t),this.load()}onRemove(e){this._implementation.onRemove&&this._implementation.onRemove(e)}hasTile(e){if(this._implementation.hasTile){const{x:t,y:n,z:r}=e.canonical;return this._implementation.hasTile({x:t,y:n,z:r})}return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(e,t){const{x:n,y:r,z:i}=e.tileID.canonical,o=new AbortController;e.request=Promise.resolve(this._implementation.loadTile({x:n,y:r,z:i},{signal:o.signal})).then(function(n){return delete e.request,e.aborted?(e.state="unloaded",t(null)):void 0===n?(e.state="errored",t(null)):null===n?(this.loadTileData(e,{width:this.tileSize,height:this.tileSize,data:null}),e.state="loaded",t(null)):function(e){return e instanceof ImageData||e instanceof HTMLCanvasElement||e instanceof ImageBitmap||e instanceof HTMLImageElement}(n)?(this.loadTileData(e,n),e.state="loaded",void t(null)):(e.state="errored",t(new Error("Can't infer data type for ".concat(this.id,", only raster data supported at the moment"))))}.bind(this)).catch((n=>{20!==n.code&&(e.state="errored",t(n))})),e.request.cancel=()=>o.abort()}loadTileData(e,t){e.setTexture(t,this.map.painter)}unloadTile(t,n){if(t.texture&&t.texture instanceof e.T?(t.destroy(!0),t.texture&&t.texture instanceof e.T&&this.map.painter.saveTileTexture(t.texture)):t.destroy(),this._implementation.unloadTile){const{x:e,y:n,z:r}=t.tileID.canonical;this._implementation.unloadTile({x:e,y:n,z:r})}n&&n()}abortTile(e,t){e.request&&e.request.cancel&&(e.request.cancel(),delete e.request),t&&t()}hasTransition(){return!1}_coveringTiles(){return this.map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map((e=>({x:e.canonical.x,y:e.canonical.y,z:e.canonical.z})))}_clearTiles(){const t=e.av(this.id,this.scope);this.map.style.clearSource(t)}_update(){this.fire(new e.x("data",{dataType:"source",sourceDataType:"content"}))}}},rt=function(t,n,r,i){const o=new nt[n.type](t,n,r,i);if(o.id!==t)throw new Error("Expected Source id to be ".concat(t," instead of ").concat(o.id));return e.aJ(["load","abort","unload","serialize","prepare"],o),o};function it(t,n){const r=e.a6.mat4.identity([]);return e.a6.mat4.scale(r,r,[.5*t.width,.5*-t.height,1]),e.a6.mat4.translate(r,r,[1,-1,0]),e.a6.mat4.multiply(r,r,t.calculateProjMatrix(n.toUnwrapped())),Float32Array.from(r)}function ot(t,n,r,i,o,a,s,l){let c=arguments.length>8&&void 0!==arguments[8]&&arguments[8];const u=t.tilesIn(r,l,c);u.sort(st);const h=[];for(const e of u)h.push({wrappedTileID:e.tile.tileID.wrapped().key,queryResults:e.tile.queryRenderedFeatures(n,t._state,e,i,o,a,s,it(t.transform,e.tile.tileID),c)});const d=function(e){const t={},n={};for(const r of e){const e=r.queryResults,i=r.wrappedTileID,o=n[i]=n[i]||{};for(const n in e){const r=e[n],i=o[n]=o[n]||{},a=t[n]=t[n]||[];for(const e of r)i[e.featureIndex]||(i[e.featureIndex]=!0,a.push(e))}}return t}(h);for(const p in d)d[p].forEach((n=>{const r=n.feature,i=r.layer;i&&"background"!==i.type&&"sky"!==i.type&&"slot"!==i.type&&(e.aK(p)||(r.source=i.source,i["source-layer"]&&(r.sourceLayer=i["source-layer"])),r.state=void 0!==r.id?t.getFeatureState(i["source-layer"],r.id):{})}));return d}function at(e,t){const n=e.getRenderableIds().map((t=>e.getTileByID(t))),r=[],i={};for(let o=0;o<n.length;o++){const e=n[o],a=e.tileID.canonical.key;i[a]||(i[a]=!0,e.querySourceFeatures(r,t))}return r}function st(e,t){const n=e.tileID,r=t.tileID;return n.overscaledZ-r.overscaledZ||n.canonical.y-r.canonical.y||n.wrap-r.wrap||n.canonical.x-r.canonical.x}function lt(e,t){const n={};if(!t)return n;for(const r of e){const e=r.layerIds.map((e=>t.getLayer(e))).filter(Boolean);if(0!==e.length){r.layers=e,r.stateDependentLayerIds&&(r.stateDependentLayers=r.stateDependentLayerIds.map((t=>e.filter((e=>e.id===t))[0])));for(const t of e)n[t.fqid]=r}}return n}const ct=32,ut=33,ht=new Uint16Array(8184);for(let r=0;r<2046;r++){let e=r+2,t=0,n=0,i=0,o=0,a=0,s=0;for(1&e?i=o=a=ct:t=n=s=ct;(e>>=1)>1;){const r=t+i>>1,l=n+o>>1;1&e?(i=t,o=n,t=a,n=s):(t=i,n=o,i=a,o=s),a=r,s=l}const l=4*r;ht[l+0]=t,ht[l+1]=n,ht[l+2]=i,ht[l+3]=o}const dt=new Uint16Array(2178),pt=new Uint8Array(1089),ft=new Uint16Array(1089);function mt(e){return 0===e?-.03125:32===e?.03125:0}const gt={type:2,extent:e.ab,loadGeometry:()=>[[new e.P(0,0),new e.P(e.ab+1,0),new e.P(e.ab+1,e.ab+1),new e.P(0,e.ab+1),new e.P(0,0)]]};class yt{constructor(t,n,r,i,o){this.tileID=t,this.uid=e.aQ(),this.uses=0,this.tileSize=n,this.tileZoom=r,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=o,i&&i.style&&(this._lastUpdatedBrightness=i.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",i&&i.transform&&(this.projection=i.transform.projection)}registerFadeDuration(t){const n=t+this.timeAdded;n<e.q.now()||this.fadeEndTime&&n<this.fadeEndTime||(this.fadeEndTime=n)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}get tileTransform(){return this._tileTransform||(this._tileTransform=e.aL(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(t,n,r){if(this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=lt(t.buckets,n.style),this.hasSymbolBuckets=!1;for(const t in this.buckets){const n=this.buckets[t];if(n instanceof e.aS){if(this.hasSymbolBuckets=!0,!r)break;n.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const t in this.buckets){const n=this.buckets[t];if(n instanceof e.aS&&n.hasRTLText){this.hasRTLText=!0,e.aT();break}}this.queryPadding=0;for(const e in this.buckets){const t=this.buckets[e],r=n.style.getOwnLayer(e);if(!r)continue;const i=r.queryRadius(t);this.queryPadding=Math.max(this.queryPadding,i)}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage),t.lineAtlas&&(this.lineAtlas=t.lineAtlas),this._lastUpdatedBrightness=t.brightness}else this.collisionBoxArray=new e.aR}unloadVectorData(){if(this.hasData()){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}loadModelData(e,t,n){e&&(e.resourceTiming&&(this.resourceTiming=e.resourceTiming),this.buckets=i(i({},this.buckets),lt(e.buckets,t.style)),e.featureIndex&&(this.latestFeatureIndex=e.featureIndex))}getBucket(e){return this.buckets[e.fqid]}upload(t){for(const e in this.buckets){const n=this.buckets[e];n.uploadPending()&&n.upload(t)}const n=t.gl,r=this.imageAtlas;if(r&&!r.uploaded){const i=!!Object.keys(r.patternPositions).length;this.imageAtlasTexture=new e.T(t,r.image,n.RGBA8,{useMipmap:i}),this.imageAtlas.uploaded=!0}this.glyphAtlasImage&&(this.glyphAtlasTexture=new e.T(t,this.glyphAtlasImage,n.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new e.T(t,this.lineAtlas.image,n.R8),this.lineAtlas.uploaded=!0)}prepare(e,t,n){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture,n),!t||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const r=t.style.getBrightness();(this._lastUpdatedBrightness||r)&&(this._lastUpdatedBrightness&&r&&Math.abs(this._lastUpdatedBrightness-r)<.001||(this._lastUpdatedBrightness=r,this.updateBuckets(t)))}queryRenderedFeatures(e,t,n,r,i,o,a,s,l){return this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)?this.latestFeatureIndex.query({tileResult:n,pixelPosMatrix:s,transform:a,filter:r,layers:i,availableImages:o,tileTransform:this.tileTransform},e,t):{}}querySourceFeatures(t,n){const r=this.latestFeatureIndex;if(!r||!r.rawTileData)return;const i=r.loadVTLayers(),o=n?n.sourceLayer:"",a=i._geojsonTileLayer||i[o];if(!a)return;const s=e.aU(n&&n.filter),{z:l,x:c,y:u}=this.tileID.canonical,h={z:l,x:c,y:u};for(let d=0;d<a.length;d++){const n=a.feature(d);if(s.needGeometry){const t=e.aV(n,!0);if(!s.filter(new e.a3(this.tileID.overscaledZ),t,this.tileID.canonical))continue}else if(!s.filter(new e.a3(this.tileID.overscaledZ),n))continue;const i=r.getId(n,o),p=new e.aW(n,l,c,u,i);p.tile=h,t.push(p)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const n=this.expirationTime;if(t.cacheControl){const n=e.aX(t.cacheControl);n["max-age"]&&(this.expirationTime=Date.now()+1e3*n["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const e=Date.now();let t=!1;if(this.expirationTime>e)t=!1;else if(n)if(this.expirationTime<n)t=!0;else{const r=this.expirationTime-n;r?this.expirationTime=e+Math.max(r,3e4):t=!0}else t=!0;t?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}refreshFeatureState(e){this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)&&e&&this.updateBuckets(e)}updateBuckets(t){if(!this.latestFeatureIndex)return;const n=this.latestFeatureIndex.loadVTLayers(),r=t.style.listImages(),i=t.style.getBrightness();for(const o in this.buckets){if(!t.style.hasLayer(o))continue;const a=this.buckets[o],s=a.layers[0],l=s.sourceLayer||"_geojsonTileLayer",c=n[l],u=t.style.getSourceCache(s.source,s.scope);let h={};u&&(h=u._state.getState(l,void 0)),a.update(h,c,r,this.imageAtlas&&this.imageAtlas.patternPositions||{},i),(a instanceof e.aY||a instanceof e.aZ)&&t._terrain&&t._terrain.enabled&&u&&a.programConfigurations.needsUpload&&t._terrain._clearRenderCacheForTile(u.id,this.tileID);const d=t&&t.style&&t.style.getOwnLayer(o);d&&(this.queryPadding=Math.max(this.queryPadding,d.queryRadius(a)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<e.q.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(t){this.symbolFadeHoldUntil=e.q.now()+t}setTexture(t,n){const r=n.context,i=r.gl;this.texture=this.texture||n.getTileTexture(t.width),this.texture&&this.texture instanceof e.T?this.texture.update(t):(this.texture=new e.T(r,t,i.RGBA8,{useMipmap:!0}),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE))}setDependencies(e,t){const n={};for(const r of t)n[r]=!0;this.dependencies[e]=n}hasDependency(e,t){for(const n of e){const e=this.dependencies[n];if(e)for(const n of t)if(e[n])return!0}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(t,n){if(!n||"mercator"===n.name||this._tileDebugBuffer)return;const r=e.a_(gt,this.tileID.canonical,this.tileTransform)[0],i=new e.a$,o=new e.b0;for(let e=0;e<r.length;e++){const{x:t,y:n}=r[e];i.emplaceBack(t,n),o.emplaceBack(e)}o.emplaceBack(0),this._tileDebugIndexBuffer=t.createIndexBuffer(o),this._tileDebugBuffer=t.createVertexBuffer(i,e.b1.members),this._tileDebugSegments=e.b2.simpleSegment(0,0,i.length,o.length)}_makeTileBoundsBuffers(t,n){if(this._tileBoundsBuffer||!n||"mercator"===n.name)return;const r=e.a_(gt,this.tileID.canonical,this.tileTransform)[0];let i,o;if(this.isRaster){const t=function(t,n){const r=e.aL(t,n),i=Math.pow(2,t.z);for(let u=0;u<ut;u++)for(let o=0;o<ut;o++){const a=e.aM((t.x+(o+mt(o))/ct)/i),s=e.aN((t.y+(u+mt(u))/ct)/i),l=n.project(a,s),c=u*ut+o;dt[2*c+0]=Math.round((l.x*r.scale-r.x)*e.ab),dt[2*c+1]=Math.round((l.y*r.scale-r.y)*e.ab)}pt.fill(0),ft.fill(0);for(let e=2045;e>=0;e--){const t=4*e,n=ht[t+0],r=ht[t+1],i=ht[t+2],o=ht[t+3],a=n+i>>1,s=r+o>>1,l=a+s-r,c=s+n-a,u=r*ut+n,h=o*ut+i,d=s*ut+a,p=Math.hypot((dt[2*u+0]+dt[2*h+0])/2-dt[2*d+0],(dt[2*u+1]+dt[2*h+1])/2-dt[2*d+1])>=16;pt[d]=pt[d]||(p?1:0),e<1022&&(pt[d]=pt[d]||pt[(r+c>>1)*ut+(n+l>>1)]||pt[(o+c>>1)*ut+(i+l>>1)])}const o=new e.aO,a=new e.aP;let s=0;function l(t,n){const r=n*ut+t;return 0===ft[r]&&(o.emplaceBack(dt[2*r+0],dt[2*r+1],t*e.ab/ct,n*e.ab/ct),ft[r]=++s),ft[r]-1}function c(e,t,n,r,i,o){const s=e+n>>1,u=t+r>>1;if(Math.abs(e-i)+Math.abs(t-o)>1&&pt[u*ut+s])c(i,o,e,t,s,u),c(n,r,i,o,s,u);else{const s=l(e,t),c=l(n,r),u=l(i,o);a.emplaceBack(s,c,u)}}return c(0,0,ct,ct,ct,0),c(ct,ct,0,0,0,ct),{vertices:o,indices:a}}(this.tileID.canonical,n);i=t.vertices,o=t.indices}else{i=new e.aO,o=new e.aP;for(const{x:e,y:n}of r)i.emplaceBack(e,n,0,0);const t=e.b3(i.int16,void 0,4);for(let e=0;e<t.length;e+=3)o.emplaceBack(t[e],t[e+1],t[e+2])}this._tileBoundsBuffer=t.createVertexBuffer(i,e.b4.members),this._tileBoundsIndexBuffer=t.createIndexBuffer(o),this._tileBoundsSegments=e.b2.simpleSegment(0,0,i.length,o.length)}_makeGlobeTileDebugBuffers(t,n){const r=n.projection;if(!r||"globe"!==r.name||n.freezeTileCoverage)return;const i=this.tileID.canonical,o=e.b5(i,n),a=e.b6(o),s=e.a9(n.zoom);let l;s>0&&(l=e.a6.mat4.invert(new Float64Array(16),n.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(t,i,n,a,l,s),this._makeGlobeTileDebugTextBuffer(t,i,n,a,l,s)}_globePoint(t,n,r,i,o,a,s){let l=e.b7(t,n,r);if(a){const o=1<<r.z,c=e.am(i.center.lng),u=e.at(i.center.lat),h=(r.x+.5)/o-c;let d=0;h>.5?d=-1:h<-.5&&(d=1);let p=(t/e.ab+r.x)/o+d,f=(n/e.ab+r.y)/o;p=(p-c)*i._pixelsPerMercatorPixel+c,f=(f-u)*i._pixelsPerMercatorPixel+u;const m=[p*i.worldSize,f*i.worldSize,0];e.a6.vec3.transformMat4(m,m,a),l=e.b8(l,m,s)}return e.a6.vec3.transformMat4(l,l,o)}_makeGlobeTileDebugBorderBuffer(t,n,r,i,o,a){const s=new e.a$,l=new e.b0,c=new e.b9,u=(e,t,u,h,d)=>{const p=(u-e)/(d-1),f=(h-t)/(d-1),m=s.length;for(let g=0;g<d;g++){const u=e+g*p,h=t+g*f;s.emplaceBack(u,h);const d=this._globePoint(u,h,n,r,i,o,a);c.emplaceBack(d[0],d[1],d[2]),l.emplaceBack(m+g)}},h=e.ab;u(0,0,h,0,16),u(h,0,h,h,16),u(h,h,0,h,16),u(0,h,0,0,16),this._tileDebugIndexBuffer=t.createIndexBuffer(l),this._tileDebugBuffer=t.createVertexBuffer(s,e.b1.members),this._globeTileDebugBorderBuffer=t.createVertexBuffer(c,e.ba.members),this._tileDebugSegments=e.b2.simpleSegment(0,0,s.length,l.length)}_makeGlobeTileDebugTextBuffer(t,n,r,i,o,a){const s=e.ab/4,l=new e.a$,c=new e.aP,u=new e.b9,h=25;c.reserve(32),l.reserve(h),u.reserve(h);const d=(e,t)=>h*e+t;for(let e=0;e<h;e++){const t=e*s;for(let e=0;e<h;e++){const c=e*s;l.emplaceBack(c,t);const h=this._globePoint(c,t,n,r,i,o,a);u.emplaceBack(h[0],h[1],h[2])}}for(let e=0;e<4;e++)for(let t=0;t<4;t++){const n=d(e,t),r=d(e,t+1),i=d(e+1,t),o=d(e+1,t+1);c.emplaceBack(n,r,i),c.emplaceBack(i,r,o)}this._tileDebugTextIndexBuffer=t.createIndexBuffer(c),this._tileDebugTextBuffer=t.createVertexBuffer(l,e.b1.members),this._globeTileDebugTextBuffer=t.createVertexBuffer(u,e.ba.members),this._tileDebugTextSegments=e.b2.simpleSegment(0,0,h,32)}destroy(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!t&&this.texture&&this.texture instanceof e.T&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}e.bb.setPbf(e.bc);class _t extends yt{constructor(e,t,n,r,i){super(e,t,n,r,i),this._workQueue=[],this._fetchQueue=[],this._isHeaderLoaded=!1}setTexture(t,n){const r=n.context,i=r.gl;this.texture=this.texture||n.getTileTexture(t.width),this.texture&&this.texture instanceof e.T?this.texture.update(t,{premultiply:!1}):this.texture=new e.T(r,t,i.RGBA8,{premultiply:!1})}flushQueues(){for(;this._workQueue.length;)this._workQueue.pop()();for(;this._fetchQueue.length;)this._fetchQueue.pop()()}fetchHeader(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16384,n=arguments.length>1?arguments[1]:void 0;const r=this._mrt=new e.bb(30),i=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(t-1)}});return this.entireBuffer=null,this.request=e.bd(i,((e,i,o,a)=>{if(e)n(e);else try{const e=r.getHeaderLength(i);if(e>t)return void(this.request=this.fetchHeader(e,n));r.parseHeader(i),this._isHeaderLoaded=!0;let s=0;for(const t of Object.values(r.layers))s=Math.max(s,t.dataIndex[t.dataIndex.length-1].last_byte);i.byteLength>=s&&(this.entireBuffer=i),n(null,this.entireBuffer||i,o,a)}catch(e){n(e)}})),this.request}fetchBand(t,n,r){const i=this._mrt;if(!this._isHeaderLoaded||!i)return void r(new Error("Tile header is not ready"));const o=this.actor;if(!o)return void r(new Error("Can't fetch tile band without an actor"));let a;const s=(e,i)=>{a.complete(e,i),e?r(e):(this.updateTextureDescriptor(t,n),r(null,this.textureDescriptor&&this.textureDescriptor.img))},l=(e,t)=>{if(e)return r(e);const n=o.send("decodeRasterArray",{buffer:t,task:a},s,void 0,!0);this._workQueue.push((()=>{n&&n.cancel(),a.cancel()}))},c=i.getLayer(t);if(!c)return void r(new Error('Unknown sourceLayer "'.concat(t,'"')));if(c.hasDataForBand(n))return this.updateTextureDescriptor(t,n),void r(null,this.textureDescriptor?this.textureDescriptor.img:null);const u=c.getDataRange([n]);if(a=i.createDecodingTask(u),!a||a.tasks.length)if(this.flushQueues(),this.entireBuffer)l(null,this.entireBuffer.slice(u.firstByte,u.lastByte+1));else{const t=Object.assign({},this.requestParams,{headers:{Range:"bytes=".concat(u.firstByte,"-").concat(u.lastByte)}}),n=e.bd(t,l);this._fetchQueue.push((()=>{n.cancel(),a.cancel()}))}else r(null)}updateNeeded(e,t){return(!this.textureDescriptor||this.textureDescriptor.band!==t||this.textureDescriptor.layer!==e)&&"errored"!==this.state}updateTextureDescriptor(t,n){if(!this._mrt)return;const r=this._mrt.getLayer(t);if(!r||!r.hasBand(n)||!r.hasDataForBand(n))return;const{bytes:i,tileSize:o,buffer:a,offset:s,scale:l}=r.getBandView(n),c=o+2*a,u={data:i,width:c,height:c},h=this.texture;h&&h instanceof e.T&&h.update(u,{premultiply:!1}),this.textureDescriptor={layer:t,band:n,img:u,buffer:a,offset:s,tileSize:o,format:r.pixelFormat,mix:[l,256*l,65536*l,16777216*l]}}}class vt{constructor(e,t){this.max=e,this.onRemove=t,this.reset()}reset(){for(const e in this.data)for(const t of this.data[e])t.timeout&&clearTimeout(t.timeout),this.onRemove(t.value);return this.data={},this.order=[],this}add(e,t,n){const r=e.wrapped().key;void 0===this.data[r]&&(this.data[r]=[]);const i={value:t,timeout:void 0};if(void 0!==n&&(i.timeout=setTimeout((()=>{this.remove(e,i)}),n)),this.data[r].push(i),this.order.push(r),this.order.length>this.max){const e=this._getAndRemoveByKey(this.order[0]);e&&this.onRemove(e)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const t=this.data[e].shift();return t.timeout&&clearTimeout(t.timeout),0===this.data[e].length&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),t.value}getByKey(e){const t=this.data[e];return t?t[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,t){if(!this.has(e))return this;const n=e.wrapped().key,r=void 0===t?0:this.data[n].indexOf(t),i=this.data[n][r];return this.data[n].splice(r,1),i.timeout&&clearTimeout(i.timeout),0===this.data[n].length&&delete this.data[n],this.onRemove(i.value),this.order.splice(this.order.indexOf(n),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const e=this._getAndRemoveByKey(this.order[0]);e&&this.onRemove(e)}return this}filter(e){const t=[];for(const n in this.data)for(const r of this.data[n])e(r.value)||t.push(r);for(const n of t)this.remove(n.value.tileID,n)}}class xt{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,n,r){const i=String(n);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][i]=this.stateChanges[t][i]||{},e.l(this.stateChanges[t][i],r),null===this.deletedStates[t]){this.deletedStates[t]={};for(const e in this.state[t])e!==i&&(this.deletedStates[t][e]=null)}else if(this.deletedStates[t]&&null===this.deletedStates[t][i]){this.deletedStates[t][i]={};for(const e in this.state[t][i])r[e]||(this.deletedStates[t][i][e]=null)}else for(const e in r)this.deletedStates[t]&&this.deletedStates[t][i]&&null===this.deletedStates[t][i][e]&&delete this.deletedStates[t][i][e]}removeFeatureState(e,t,n){if(null===this.deletedStates[e])return;const r=String(t);if(this.deletedStates[e]=this.deletedStates[e]||{},n&&void 0!==t)null!==this.deletedStates[e][r]&&(this.deletedStates[e][r]=this.deletedStates[e][r]||{},this.deletedStates[e][r][n]=null);else if(void 0!==t)if(this.stateChanges[e]&&this.stateChanges[e][r])for(n in this.deletedStates[e][r]={},this.stateChanges[e][r])this.deletedStates[e][r][n]=null;else this.deletedStates[e][r]=null;else this.deletedStates[e]=null}getState(t,n){const r=this.state[t]||{},i=this.stateChanges[t]||{},o=this.deletedStates[t];if(null===o)return{};if(void 0!==n){const t=String(n),a=e.l({},r[t],i[t]);if(o){const e=o[n];if(null===e)return{};for(const t in e)delete a[t]}return a}const a=e.l({},r,i);if(o)for(const e in o)delete a[e];return a}initializeTileState(e,t){e.refreshFeatureState(t)}coalesceChanges(t,n){const r={};for(const i in this.stateChanges){this.state[i]=this.state[i]||{};const t={};for(const n in this.stateChanges[i])this.state[i][n]||(this.state[i][n]={}),e.l(this.state[i][n],this.stateChanges[i][n]),t[n]=this.state[i][n];r[i]=t}for(const i in this.deletedStates){this.state[i]=this.state[i]||{};const t={};if(null===this.deletedStates[i])for(const e in this.state[i])t[e]={},this.state[i][e]={};else for(const e in this.deletedStates[i]){if(null===this.deletedStates[i][e])this.state[i][e]={};else if(this.state[i][e])for(const t of Object.keys(this.deletedStates[i][e]))delete this.state[i][e][t];t[e]=this.state[i][e]}r[i]=r[i]||{},e.l(r[i],t)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(r).length)for(const e in t)t[e].refreshFeatureState(n)}}class bt extends e.E{constructor(e,t,n){super(),this.id=e,this._onlySymbols=n,t.on("data",(e=>{"source"===e.dataType&&"metadata"===e.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===e.dataType&&"content"===e.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))})),t.on("error",(()=>{this._sourceErrored=!0})),this._source=t,this._tiles={},this._cache=new vt(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=t.minTileCacheSize,this._maxTileCacheSize=t.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new xt,this._isRaster="raster"===this._source.type||"raster-dem"===this._source.type||"raster-array"===this._source.type||"custom"===this._source.type&&"raster"===this._source._dataType}onAdd(e){this.map=e,this._minTileCacheSize=void 0===this._minTileCacheSize&&e?e._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=void 0===this._maxTileCacheSize&&e?e._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;if(!this._source.loaded())return!1;for(const e in this._tiles){const t=this._tiles[e];if("loaded"!==t.state&&"errored"!==t.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(e,t){return e.isSymbolTile=this._onlySymbols,e.isExtraShadowCaster=this._shadowCasterTiles[e.tileID.key],this._source.loadTile(e,t)}_unloadTile(e){if(this._source.unloadTile)return this._source.unloadTile(e)}_abortTile(e){if(this._source.abortTile)return this._source.abortTile(e)}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const t in this._tiles){const n=this._tiles[t];n.upload(e),n.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return e.be(this._tiles).map((e=>e.tileID)).sort(wt).map((e=>e.key))}getRenderableIds(t,n){const r=[];for(const e in this._tiles)this._isIdRenderable(+e,t,n)&&r.push(this._tiles[e]);return t?r.sort(((t,n)=>{const r=t.tileID,i=n.tileID,o=new e.P(r.canonical.x,r.canonical.y)._rotate(this.transform.angle),a=new e.P(i.canonical.x,i.canonical.y)._rotate(this.transform.angle);return r.overscaledZ-i.overscaledZ||a.y-o.y||a.x-o.x})).map((e=>e.tileID.key)):r.map((e=>e.tileID)).sort(wt).map((e=>e.key))}hasRenderableParent(e){const t=this.findLoadedParent(e,0);return!!t&&this._isIdRenderable(t.tileID.key)}_isIdRenderable(e,t,n){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(t||!this._tiles[e].holdingForFade())&&(n||!this._shadowCasterTiles[e])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const e in this._tiles)"errored"!==this._tiles[e].state&&this._reloadTile(+e,"reloading")}}_reloadTile(e,t){const n=this._tiles[e];n&&("loading"!==n.state&&(n.state=t),this._loadTile(n,this._tileLoaded.bind(this,n,e,t)))}_tileLoaded(t,n,r,i){if(i)if(t.state="errored",404!==i.status)this._source.fire(new e.t(i,{tile:t}));else{if(this._source.fire(new e.x("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id,tile:t})),!(t.tileID.key in this._loadedParentTiles))return;if("raster-dem"===this._source.type&&this.usedForTerrain&&this.map.painter.terrain){const e=this.map.painter.terrain;this.update(this.transform,e.getScaledDemTileSize(),!0),e.resetTileLookupCache(this.id)}else this.update(this.transform)}else t.timeAdded=e.q.now(),"expired"===r&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(n,t),"raster-dem"===this._source.type&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),this._source.fire(new e.x("data",{dataType:"source",tile:t,coord:t.tileID,sourceCacheId:this.id}))}_backfillDEM(e){const t=this.getRenderableIds();for(let r=0;r<t.length;r++){const i=t[r];if(e.neighboringTiles&&e.neighboringTiles[i]){const t=this.getTileByID(i);n(e,t),n(t,e)}}function n(e,t){if(!e.dem||e.dem.borderReady)return;e.needsHillshadePrepare=!0,e.needsDEMTextureUpload=!0;let n=t.tileID.canonical.x-e.tileID.canonical.x;const r=t.tileID.canonical.y-e.tileID.canonical.y,i=Math.pow(2,e.tileID.canonical.z),o=t.tileID.key;0===n&&0===r||Math.abs(r)>1||(Math.abs(n)>1&&(1===Math.abs(n+i)?n+=i:1===Math.abs(n-i)&&(n-=i)),t.dem&&e.dem&&(e.dem.backfillBorder(t.dem,n,r),e.neighboringTiles&&e.neighboringTiles[o]&&(e.neighboringTiles[o].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,t,n,r){for(const i in this._tiles){let o=this._tiles[i];if(r[i]||!o.hasData()||o.tileID.overscaledZ<=t||o.tileID.overscaledZ>n)continue;let a=o.tileID;for(;o&&o.tileID.overscaledZ>t+1;){const e=o.tileID.scaledTo(o.tileID.overscaledZ-1);o=this._tiles[e.key],o&&o.hasData()&&(a=e)}let s=a;for(;s.overscaledZ>t;)if(s=s.scaledTo(s.overscaledZ-1),e[s.key]){r[a.key]=a;break}}}findLoadedParent(e,t){if(e.key in this._loadedParentTiles){const n=this._loadedParentTiles[e.key];return n&&n.tileID.overscaledZ>=t?n:null}for(let n=e.overscaledZ-1;n>=t;n--){const t=e.scaledTo(n),r=this._getLoadedTile(t);if(r)return r}}_getLoadedTile(e){const t=this._tiles[e.key];return t&&t.hasData()?t:this._cache.getByKey(this._source.reparseOverscaled?e.wrapped().key:e.canonical.key)}updateCacheSize(e,t){t=t||this._source.tileSize;const n=Math.ceil(e.width/t)+1,r=Math.ceil(e.height/t)+1,i=Math.floor(n*r*5),o="number"==typeof this._minTileCacheSize?Math.max(this._minTileCacheSize,i):i,a="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,o):o;this._cache.setMaxSize(a)}handleWrapJump(e){const t=Math.round((e-(void 0===this._prevLng?e:this._prevLng))/360);if(this._prevLng=e,t){const e={};for(const n in this._tiles){const r=this._tiles[n];r.tileID=r.tileID.unwrapTo(r.tileID.wrap+t),e[r.tileID.key]=r}this._tiles=e;for(const t in this._timers)clearTimeout(this._timers[t]),delete this._timers[t];for(const t in this._tiles)this._setTileReloadTimer(+t,this._tiles[t])}}update(t,n,r,i){if(this.transform=t,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage)return;if(this.usedForTerrain&&!r)return;this.updateCacheSize(t,n),"globe"!==this.transform.projection.name&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={};const o="batched-model"===this._source.type;let a,s=this._source.maxzoom;const l=this.map&&this.map.painter?this.map.painter._terrain:null;if(l&&l.sourceCache===this&&l.attenuationRange()){const e=l.attenuationRange()[0],t=Math.floor(e)-Math.log2(l.getDemUpscale());s>t&&(s=t)}if(this.used||this.usedForTerrain){if(this._source.tileID)a=t.getVisibleUnwrappedCoordinates(this._source.tileID).map((t=>new e.aA(t.canonical.z,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y)));else if(0!==this.tileCoverLift){const i=t.clone();i.tileCoverLift=this.tileCoverLift,a=i.coveringTiles({tileSize:n||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:s,roundZoom:this._source.roundZoom&&!r,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:o}),this._source.minzoom<=1&&"globe"===t.projection.name&&(a.push(new e.aA(1,0,1,0,0)),a.push(new e.aA(1,0,1,1,0)),a.push(new e.aA(1,0,1,0,1)),a.push(new e.aA(1,0,1,1,1)))}else if(a=t.coveringTiles({tileSize:n||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:s,roundZoom:this._source.roundZoom&&!r,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:o}),this._source.hasTile){const e=this._source.hasTile.bind(this._source);a=a.filter((t=>e(t)))}}else a=[];if(a.length>0&&this.castsShadows&&i&&"globe"!==this.transform.projection.name&&!this.usedForTerrain&&!St(this._source.type)){const e=t.coveringZoomLevel({tileSize:n||this._source.tileSize,roundZoom:this._source.roundZoom&&!r}),s=Math.min(e,this._source.maxzoom);if(o){const e=t.extendTileCover(a,s);for(const t of e)a.push(t)}else{const e=t.extendTileCover(a,s,i);for(const t of e)this._shadowCasterTiles[t.key]=!0,a.push(t)}}const c=this._updateRetainedTiles(a);if(St(this._source.type)&&0!==a.length){const t={},n={},r=Object.keys(c);for(const o of r){const r=c[o],i=this._tiles[o];if(!i||i.fadeEndTime&&i.fadeEndTime<=e.q.now())continue;const a=this.findLoadedParent(r,Math.max(r.overscaledZ-bt.maxOverzooming,this._source.minzoom));a&&(this._addTile(a.tileID),t[a.tileID.key]=a.tileID),n[o]=r}const i=a[a.length-1].overscaledZ;for(const e in this._tiles){const t=this._tiles[e];if(c[e]||!t.hasData())continue;let r=t.tileID;for(;r.overscaledZ>i;){r=r.scaledTo(r.overscaledZ-1);const i=this._tiles[r.key];if(i&&i.hasData()&&n[r.key]){c[e]=t.tileID;break}}}for(const e in t)c[e]||(this._coveredTiles[e]=!0,c[e]=t[e])}for(const e in c)this._tiles[e].clearFadeHold();const u=e.bf(this._tiles,c);for(const e of u){const t=this._tiles[e];t.hasSymbolBuckets&&!t.holdingForFade()?t.setHoldDuration(this.map._fadeDuration):t.hasSymbolBuckets&&!t.symbolFadeFinished()||this._removeTile(+e)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(+e)}_updateRetainedTiles(e){const t={};if(0===e.length)return t;const n={},r=e.reduce(((e,t)=>Math.min(e,t.overscaledZ)),1/0),i=e[0].overscaledZ,o=Math.max(i-bt.maxOverzooming,this._source.minzoom),a=Math.max(i+bt.maxUnderzooming,this._source.minzoom),s={};for(const l of e){const e=this._addTile(l);t[l.key]=l,e.hasData()||r<this._source.maxzoom&&(s[l.key]=l)}this._retainLoadedChildren(s,r,a,t);for(const l of e){let e=this._tiles[l.key];if(e.hasData())continue;if(l.canonical.z>=this._source.maxzoom){const e=l.children(this._source.maxzoom)[0],n=this.getTile(e);if(n&&n.hasData()){t[e.key]=e;continue}}else{const e=l.children(this._source.maxzoom);if(t[e[0].key]&&t[e[1].key]&&t[e[2].key]&&t[e[3].key])continue}let r=e.wasRequested();for(let i=l.overscaledZ-1;i>=o;--i){const o=l.scaledTo(i);if(n[o.key])break;if(n[o.key]=!0,e=this.getTile(o),!e&&r&&(e=this._addTile(o)),e&&(t[o.key]=o,r=e.wasRequested(),e.hasData()))break}}return t}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const t=[];let n,r=this._tiles[e].tileID;for(;r.overscaledZ>0;){if(r.key in this._loadedParentTiles){n=this._loadedParentTiles[r.key];break}t.push(r.key);const e=r.scaledTo(r.overscaledZ-1);if(n=this._getLoadedTile(e),n)break;r=e}for(const e of t)this._loadedParentTiles[e]=n}}_addTile(t){let n=this._tiles[t.key];if(n)return!0!==n.isExtraShadowCaster||!!this._shadowCasterTiles[t.key]||this._reloadTile(t.key,"reloading"),n;n=this._cache.getAndRemove(t),n&&(this._setTileReloadTimer(t.key,n),n.tileID=t,this._state.initializeTileState(n,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,n)));const r=Boolean(n);if(!r){const e=this.map?this.map.painter:null,r=this._source.tileSize*t.overscaleFactor();n="raster-array"===this._source.type?new _t(t,r,this.transform.tileZoom,e,this._isRaster):new yt(t,r,this.transform.tileZoom,e,this._isRaster),this._loadTile(n,this._tileLoaded.bind(this,n,t.key,n.state))}return n?(n.uses++,this._tiles[t.key]=n,r||this._source.fire(new e.x("dataloading",{tile:n,coord:n.tileID,dataType:"source"})),n):null}_setTileReloadTimer(e,t){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const n=t.getExpiryTimeout();n&&(this._timers[e]=setTimeout((()=>{this._reloadTile(e,"expired"),delete this._timers[e]}),n))}_removeTile(e){const t=this._tiles[e];t&&(t.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),t.uses>0||(t.hasData()&&"reloading"!==t.state||"empty"===t.state?this._cache.add(t.tileID,t,t.getExpiryTimeout()):(t.aborted=!0,this._abortTile(t),this._unloadTile(t))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(+e);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(t,n,r){const i=[],o=this.transform;if(!o)return i;const a="globe"===o.projection.name,s=e.am(o.center.lng);for(const l in this._tiles){const c=this._tiles[l];if(r&&c.clearQueryDebugViz(),c.holdingForFade())continue;let u;if(a){const t=c.tileID.canonical;if(0===t.z){const n=[Math.abs(e.ap(s,...Tt(t,-1))-s),Math.abs(e.ap(s,...Tt(t,1))-s)];u=[0,2*n.indexOf(Math.min(...n))-1]}else{const n=[Math.abs(e.ap(s,...Tt(t,-1))-s),Math.abs(e.ap(s,...Tt(t,0))-s),Math.abs(e.ap(s,...Tt(t,1))-s)];u=[n.indexOf(Math.min(...n))-1]}}else u=[0];for(const e of u){const r=t.containsTile(c,o,n,e);r&&i.push(r)}}return i}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(e){return this._getRenderableCoordinates(e)}_getRenderableCoordinates(e,t){const n=this.getRenderableIds(e,t).map((e=>this._tiles[e].tileID)),r="globe"===this.transform.projection.name;for(const i of n)i.projMatrix=this.transform.calculateProjMatrix(i.toUnwrapped()),i.expandedProjMatrix=r?this.transform.calculateProjMatrix(i.toUnwrapped(),!1,!0):i.projMatrix;return n}sortCoordinatesByDistance(e){const t=e.slice(),n=this.transform._camera.position,r=this.transform._camera.forward(),i={};for(const o of t){const e=1/(1<<o.canonical.z);i[o.key]=((o.canonical.x+.5)*e+o.wrap-n[0])*r[0]+((o.canonical.y+.5)*e-n[1])*r[1]-n[2]*r[2]}return t.sort(((e,t)=>i[e.key]-i[t.key])),t}hasTransition(){if(this._source.hasTransition())return!0;if(St(this._source.type))for(const t in this._tiles){const n=this._tiles[t];if(void 0!==n.fadeEndTime&&n.fadeEndTime>=e.q.now())return!0}return!1}setFeatureState(e,t,n){this._state.updateState(e=e||"_geojsonTileLayer",t,n)}removeFeatureState(e,t,n){this._state.removeFeatureState(e=e||"_geojsonTileLayer",t,n)}getFeatureState(e,t){return this._state.getState(e=e||"_geojsonTileLayer",t)}setDependencies(e,t,n){const r=this._tiles[e];r&&r.setDependencies(t,n)}reloadTilesForDependencies(e,t){for(const n in this._tiles)this._tiles[n].hasDependency(e,t)&&this._reloadTile(+n,"reloading");this._cache.filter((n=>!n.hasDependency(e,t)))}_preloadTiles(t,n){if(!this._sourceLoaded){const e=()=>{this._sourceLoaded&&(this._source.off("data",e),this._preloadTiles(t,n))};return void this._source.on("data",e)}const r=new Map,i=Array.isArray(t)?t:[t],o=this.map.painter.terrain,a=this.usedForTerrain&&o?o.getScaledDemTileSize():this._source.tileSize;for(const e of i){const t=e.coveringTiles({tileSize:a,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const e of t)r.set(e.key,e);this.usedForTerrain&&e.updateElevation(!1)}const s=Array.from(r.values());e.bg(s,((e,t)=>{const n=new yt(e,this._source.tileSize*e.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(n,(e=>{"raster-dem"===this._source.type&&n.dem&&this._backfillDEM(n),t(e,n)}))}),n)}}function wt(e,t){const n=Math.abs(2*e.wrap)-+(e.wrap<0),r=Math.abs(2*t.wrap)-+(t.wrap<0);return e.overscaledZ-t.overscaledZ||r-n||t.canonical.y-e.canonical.y||t.canonical.x-e.canonical.x}function St(e){return"raster"===e||"image"===e||"video"===e||"custom"===e}function Tt(e,t){const n=1<<e.z;return[e.x/n+t,(e.x+1)/n+t]}bt.maxOverzooming=10,bt.maxUnderzooming=3;class Et{constructor(e){this.style=e,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const e=!1,t=!1;for(const n in this.style._mergedLayers){const r=this.style._mergedLayers[n];if("fill-extrusion"===r.type)this.layers.push({layer:r,visible:e,visibilityChanged:t});else if("model"===r.type){const n=this.style.getLayerSource(r);n&&"batched-model"===n.type&&this.layers.push({layer:r,visible:e,visibilityChanged:t})}}}onNewFrame(e){this.layersGotHidden=!1;for(const t of this.layers){const n=t.layer;let r=!1;"fill-extrusion"===n.type?r=!n.isHidden(e)&&n.paint.get("fill-extrusion-opacity")>0:"model"===n.type&&(r=!n.isHidden(e)&&n.paint.get("model-opacity")>0),this.layersGotHidden=this.layersGotHidden||!r&&t.visible,t.visible=r}}updateZOffset(e,t){this.currentBuildingBuckets=[];for(const r of this.layers){const e=r.layer,n=this.style.getLayerSourceCache(e);let i=1;"fill-extrusion"===e.type&&(i=r.visible?e.paint.get("fill-extrusion-vertical-scale"):0);let o=n?n.getTile(t):null;if(!o&&n&&t.canonical.z>n.getSource().minzoom){let e=t.scaledTo(Math.min(n.getSource().maxzoom,t.overscaledZ-1));for(;e.overscaledZ>=n.getSource().minzoom&&(o=n.getTile(e),!o&&0!==e.overscaledZ);)e=e.scaledTo(e.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:o?o.getBucket(e):null,tileID:o?o.tileID:t,verticalScale:i})}e.hasAnyZOffset=!1;let n=!1;for(let r=0;r<e.symbolInstances.length;r++){const i=e.symbolInstances.get(r),o=i.zOffset,a=this._getHeightAtTileOffset(t,i.tileAnchorX,i.tileAnchorY);i.zOffset=a!==Number.NEGATIVE_INFINITY?a:o,n||o===i.zOffset||(n=!0),e.hasAnyZOffset||0===i.zOffset||(e.hasAnyZOffset=!0)}n&&(e.zOffsetBuffersNeedUpload=!0,e.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(t,n,r,i){let o=n,a=r;if(t.canonical.z!==i.canonical.z){const s=i.canonical,l=1/(1<<t.canonical.z-s.z);o=(n+t.canonical.x*e.ab)*l-s.x*e.ab|0,a=(r+t.canonical.y*e.ab)*l-s.y*e.ab|0}return{tileX:o,tileY:a}}_getHeightAtTileOffset(e,t,n){let r,i;for(let o=0;o<this.layers.length;++o){if("fill-extrusion"!==this.layers[o].layer.type)continue;const{bucket:a,tileID:s,verticalScale:l}=this.currentBuildingBuckets[o];if(!a)continue;const{tileX:c,tileY:u}=this._mapCoordToOverlappingTile(e,t,n,s),h=a.getHeightAtTileCoord(c,u);h&&void 0!==h.height&&(h.hidden?r=h.height:i=Math.max(h.height*l,i||0))}if(void 0!==i)return i;for(let o=0;o<this.layers.length;++o){const i=this.layers[o];if("model"!==i.layer.type||!i.visible)continue;const{bucket:a,tileID:s}=this.currentBuildingBuckets[o];if(!a)continue;const{tileX:l,tileY:c}=this._mapCoordToOverlappingTile(e,t,n,s),u=a.getHeightAtTileCoord(l,c);if(u&&!u.hidden)return void 0===u.height&&void 0!==r?Math.min(u.maxHeight,r)*u.verticalScale:u.height?u.height*u.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function At(t,n){const r={};for(const e in t)"ref"!==e&&(r[e]=t[e]);return e.bh.forEach((e=>{e in n&&(r[e]=n[e])})),r}function Mt(e){e=e.slice();const t=Object.create(null);for(let n=0;n<e.length;n++)t[e[n].id]=e[n];for(let n=0;n<e.length;n++)"ref"in e[n]&&(e[n]=At(e[n],t[e[n].ref]));return e}const Pt={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport"};function kt(e,t,n){n.push({command:Pt.addSource,args:[e,t[e]]})}function Ct(e,t,n){t.push({command:Pt.removeSource,args:[e]}),n[e]=!0}function jt(e,t,n,r){Ct(e,n,r),kt(e,t,n)}function It(t,n,r){let i;for(i in t[r])if(t[r].hasOwnProperty(i)&&"data"!==i&&!e.bi(t[r][i],n[r][i]))return!1;for(i in n[r])if(n[r].hasOwnProperty(i)&&"data"!==i&&!e.bi(t[r][i],n[r][i]))return!1;return!0}function Ot(t,n,r,i,o,a){let s;for(s in n=n||{},t=t||{})t.hasOwnProperty(s)&&(e.bi(t[s],n[s])||r.push({command:a,args:[i,s,n[s],o]}));for(s in n)n.hasOwnProperty(s)&&!t.hasOwnProperty(s)&&(e.bi(t[s],n[s])||r.push({command:a,args:[i,s,n[s],o]}))}function Nt(e){return e.id}function Dt(e,t){return e[t.id]=t,e}class Lt{constructor(e,t){this.reset(e,t)}reset(e,t){this.points=e||[],this._distances=[0];for(let n=1;n<this.points.length;n++)this._distances[n]=this._distances[n-1]+this.points[n].dist(this.points[n-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(t||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(1===this.points.length)return this.points[0];t=e.ap(t,0,1);let n=1,r=this._distances[n];const i=t*this.paddedLength+this.padding;for(;r<i&&n<this._distances.length;)r=this._distances[++n];const o=n-1,a=this._distances[o],s=r-a,l=s>0?(i-a)/s:0;return this.points[o].mult(1-l).add(this.points[n].mult(l))}}class zt{constructor(e,t,n){const r=this.boxCells=[],i=this.circleCells=[];this.xCellCount=Math.ceil(e/n),this.yCellCount=Math.ceil(t/n);for(let o=0;o<this.xCellCount*this.yCellCount;o++)r.push([]),i.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=t,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/t,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,t,n,r,i){this._forEachCell(t,n,r,i,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(t),this.bboxes.push(n),this.bboxes.push(r),this.bboxes.push(i)}insertCircle(e,t,n,r){this._forEachCell(t-r,n-r,t+r,n+r,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(t),this.circles.push(n),this.circles.push(r)}_insertBoxCell(e,t,n,r,i,o){this.boxCells[i].push(o)}_insertCircleCell(e,t,n,r,i,o){this.circleCells[i].push(o)}_query(e,t,n,r,i,o){if(n<0||e>this.width||r<0||t>this.height)return!i&&[];const a=[];if(e<=0&&t<=0&&this.width<=n&&this.height<=r){if(i)return!0;for(let e=0;e<this.boxKeys.length;e++)a.push({key:this.boxKeys[e],x1:this.bboxes[4*e],y1:this.bboxes[4*e+1],x2:this.bboxes[4*e+2],y2:this.bboxes[4*e+3]});for(let e=0;e<this.circleKeys.length;e++){const t=this.circles[3*e],n=this.circles[3*e+1],r=this.circles[3*e+2];a.push({key:this.circleKeys[e],x1:t-r,y1:n-r,x2:t+r,y2:n+r})}return o?a.filter(o):a}return this._forEachCell(e,t,n,r,this._queryCell,a,{hitTest:i,seenUids:{box:{},circle:{}}},o),i?a.length>0:a}_queryCircle(e,t,n,r,i){const o=e-n,a=e+n,s=t-n,l=t+n;if(a<0||o>this.width||l<0||s>this.height)return!r&&[];const c=[];return this._forEachCell(o,s,a,l,this._queryCellCircle,c,{hitTest:r,circle:{x:e,y:t,radius:n},seenUids:{box:{},circle:{}}},i),r?c.length>0:c}query(e,t,n,r,i){return this._query(e,t,n,r,!1,i)}hitTest(e,t,n,r,i){return this._query(e,t,n,r,!0,i)}hitTestCircle(e,t,n,r){return this._queryCircle(e,t,n,!0,r)}_queryCell(e,t,n,r,i,o,a,s){const l=a.seenUids,c=this.boxCells[i];if(null!==c){const i=this.bboxes;for(const u of c)if(!l.box[u]){l.box[u]=!0;const c=4*u;if(e<=i[c+2]&&t<=i[c+3]&&n>=i[c+0]&&r>=i[c+1]&&(!s||s(this.boxKeys[u]))){if(a.hitTest)return o.push(!0),!0;o.push({key:this.boxKeys[u],x1:i[c],y1:i[c+1],x2:i[c+2],y2:i[c+3]})}}}const u=this.circleCells[i];if(null!==u){const i=this.circles;for(const c of u)if(!l.circle[c]){l.circle[c]=!0;const u=3*c;if(this._circleAndRectCollide(i[u],i[u+1],i[u+2],e,t,n,r)&&(!s||s(this.circleKeys[c]))){if(a.hitTest)return o.push(!0),!0;{const e=i[u],t=i[u+1],n=i[u+2];o.push({key:this.circleKeys[c],x1:e-n,y1:t-n,x2:e+n,y2:t+n})}}}}}_queryCellCircle(e,t,n,r,i,o,a,s){const l=a.circle,c=a.seenUids,u=this.boxCells[i];if(null!==u){const e=this.bboxes;for(const t of u)if(!c.box[t]){c.box[t]=!0;const n=4*t;if(this._circleAndRectCollide(l.x,l.y,l.radius,e[n+0],e[n+1],e[n+2],e[n+3])&&(!s||s(this.boxKeys[t])))return o.push(!0),!0}}const h=this.circleCells[i];if(null!==h){const e=this.circles;for(const t of h)if(!c.circle[t]){c.circle[t]=!0;const n=3*t;if(this._circlesCollide(e[n],e[n+1],e[n+2],l.x,l.y,l.radius)&&(!s||s(this.circleKeys[t])))return o.push(!0),!0}}}_forEachCell(e,t,n,r,i,o,a,s){const l=this._convertToXCellCoord(e),c=this._convertToYCellCoord(t),u=this._convertToXCellCoord(n),h=this._convertToYCellCoord(r);for(let d=l;d<=u;d++)for(let l=c;l<=h;l++)if(i.call(this,e,t,n,r,this.xCellCount*l+d,o,a,s))return}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,t,n,r,i,o){const a=r-e,s=i-t,l=n+o;return l*l>a*a+s*s}_circleAndRectCollide(e,t,n,r,i,o,a){const s=(o-r)/2,l=Math.abs(e-(r+s));if(l>s+n)return!1;const c=(a-i)/2,u=Math.abs(t-(i+c));if(u>c+n)return!1;if(l<=s||u<=c)return!0;const h=l-s,d=u-c;return h*h+d*d<=n*n}}const Rt={unknown:0,flipRequired:1,flipNotRequired:2},Ft=Math.tan(85*Math.PI/180);function Bt(t,n,r,i,o,a,s){const l=e.a6.mat4.create();if(r)if("globe"===a.name){const t=e.bj(o,n);e.a6.mat4.multiply(l,l,t)}else{const t=e.a6.mat2.invert([],s);l[0]=t[0],l[1]=t[1],l[4]=t[2],l[5]=t[3],i||e.a6.mat4.rotateZ(l,l,o.angle)}else e.a6.mat4.multiply(l,o.labelPlaneMatrix,t);return l}function Vt(e,t,n,r,i,o,a){const s=Bt(e,t,n,r,i,o,a);return"globe"===o.name&&n||(s[2]=s[6]=s[10]=s[14]=0),s}function Ut(t,n,r,i,o,a,s){if(r){if("globe"===a.name){const l=Bt(t,n,r,i,o,a,s);return e.a6.mat4.invert(l,l),e.a6.mat4.multiply(l,t,l),l}{const n=e.a6.mat4.clone(t),r=e.a6.mat4.identity([]);return r[0]=s[0],r[1]=s[1],r[4]=s[2],r[5]=s[3],e.a6.mat4.multiply(n,n,r),i||e.a6.mat4.rotateZ(n,n,-o.angle),n}}return o.glCoordMatrix}function Gt(t,n,r,i){const o=[t,n,r,1];r?e.a6.vec4.transformMat4(o,o,i):en(o,o,i);const a=o[3];return o[0]/=a,o[1]/=a,o[2]/=a,o}function Ht(e,t){return Math.min(.5+e/t*.5,1.5)}function Zt(e,t){const n=e[0]/e[3],r=e[1]/e[3];return n>=-t[0]&&n<=t[0]&&r>=-t[1]&&r<=t[1]}function qt(t,n,r,i,o,a,s,l,c,u){const h=r.transform,d=i?t.textSizeData:t.iconSizeData,p=e.bk(d,r.transform.zoom),f="globe"===h.projection.name,m=[256/r.width*2+1,256/r.height*2+1],g=i?t.text.dynamicLayoutVertexArray:t.icon.dynamicLayoutVertexArray;g.clear();let y=null;f&&(y=i?t.text.globeExtVertexArray:t.icon.globeExtVertexArray);const _=t.lineVertexArray,v=i?t.text.placedSymbolArray:t.icon.placedSymbolArray,x=r.transform.width/r.transform.height;let b,w=!1;for(let S=0;S<v.length;S++){const i=v.get(S),{numGlyphs:f,writingMode:T}=i;if(T!==e.bl.vertical||w||b===e.bl.horizontal||(w=!0),b=T,(i.hidden||T===e.bl.vertical)&&!w){$t(f,g);continue}w=!1;const E=new e.P(i.tileAnchorX,i.tileAnchorY);let{x:A,y:M,z:P}=h.projection.projectTilePoint(E.x,E.y,u.canonical);if(c){const[e,t,n]=c(E);A+=e,M+=t,P+=n}const k=[A,M,P,1];if(e.a6.vec4.transformMat4(k,k,n),!Zt(k,m)){$t(f,g);continue}const C=k[3],j=Ht(r.transform.getCameraToCenterDistance(h.projection),C),I=e.bm(d,p,i),O=s?I/j:I*j,N=Gt(A,M,P,o);if(N[3]<=0){$t(f,g);continue}let D={};const L=s?null:c,z=Yt(i,O,!1,l,n,o,a,t.glyphOffsetArray,_,g,y,N,E,D,x,L,h.projection,u,s);w=z.useVertical,L&&z.needsFlipping&&(D={}),(z.notEnoughRoom||w||z.needsFlipping&&Yt(i,O,!0,l,n,o,a,t.glyphOffsetArray,_,g,y,N,E,D,x,L,h.projection,u,s).notEnoughRoom)&&$t(f,g)}i?(t.text.dynamicLayoutVertexBuffer.updateData(g),y&&t.text.globeExtVertexBuffer&&t.text.globeExtVertexBuffer.updateData(y)):(t.icon.dynamicLayoutVertexBuffer.updateData(g),y&&t.icon.globeExtVertexBuffer&&t.icon.globeExtVertexBuffer.updateData(y))}function Wt(e,t,n,r,i,o,a,s,l,c,u,h,d,p,f,m){const{lineStartIndex:g,glyphStartIndex:y,segment:_}=s,v=y+s.numGlyphs,x=g+s.lineLength,b=t.getoffsetX(y),w=t.getoffsetX(v-1),S=Qt(e*b,n,r,i,o,a,_,g,x,l,c,u,h,d,!0,p,f,m);if(!S)return null;const T=Qt(e*w,n,r,i,o,a,_,g,x,l,c,u,h,d,!0,p,f,m);return T?{first:S,last:T}:null}function Xt(t,n,r,i){return t===e.bl.horizontal&&Math.abs(i)>Math.abs(r)?{useVertical:!0}:t===e.bl.vertical?i>0?{needsFlipping:!0}:null:n!==Rt.unknown&&function(e,t){return 0===e||Math.abs(t/e)>Ft}(r,i)?n===Rt.flipRequired?{needsFlipping:!0}:null:r<0?{needsFlipping:!0}:null}function Yt(t,n,r,i,o,a,s,l,c,u,h,d,p,f,m,g,y,_,v){const x=n/24,b=t.lineOffsetX*x,w=t.lineOffsetY*x,{lineStartIndex:S,glyphStartIndex:T,numGlyphs:E,segment:A,writingMode:M,flipState:P}=t,k=S+t.lineLength,C=t=>{if(h){const[n,r,i]=t.up,o=u.length;e.bn(h,o+0,n,r,i),e.bn(h,o+1,n,r,i),e.bn(h,o+2,n,r,i),e.bn(h,o+3,n,r,i)}const[n,r,i]=t.point;e.bo(u,n,r,i,t.angle)};if(E>1){const e=Wt(x,l,b,w,r,d,p,t,c,a,f,g,!1,y,_,v);if(!e)return{notEnoughRoom:!0};if(i&&!r){let[n,r,i]=e.first.point,[o,a,l]=e.last.point;[n,r]=Gt(n,r,i,s),[o,a]=Gt(o,a,l,s);const c=Xt(M,P,(o-n)*m,a-r);if(t.flipState=c&&c.needsFlipping?Rt.flipRequired:Rt.flipNotRequired,c)return c}C(e.first);for(let t=T+1;t<T+E-1;t++){const e=Qt(x*l.getoffsetX(t),b,w,r,d,p,A,S,k,c,a,f,g,!1,!1,y,_,v);if(!e)return u.length-=4*(t-T),{notEnoughRoom:!0};C(e)}C(e.last)}else{if(i&&!r){const n=Gt(p.x,p.y,0,o),r=S+A+1,i=new e.P(c.getx(r),c.gety(r)),a=Gt(i.x,i.y,0,o),s=a[3]>0?a:Jt(p,i,n,1,o,void 0,y,_.canonical),l=Xt(M,P,(s[0]-n[0])*m,s[1]-n[1]);if(t.flipState=l&&l.needsFlipping?Rt.flipRequired:Rt.flipNotRequired,l)return l}const n=Qt(x*l.getoffsetX(T),b,w,r,d,p,A,S,k,c,a,f,g,!1,!1,y,_,v);if(!n)return{notEnoughRoom:!0};C(n)}return{}}function Kt(e,t,n,r,i){const{x:o,y:a,z:s}=r.projectTilePoint(e.x,e.y,t);if(!i)return Gt(o,a,s,n);const[l,c,u]=i(e);return Gt(o+l,a+c,s+u,n)}function Jt(t,n,r,i,o,a,s,l){const c=Kt(t.sub(n)._unit()._add(t),l,o,s,a);return e.a6.vec3.sub(c,r,c),e.a6.vec3.normalize(c,c),e.a6.vec3.scaleAndAdd(c,r,c,i)}function Qt(t,n,r,i,o,a,s,l,c,u,h,d,p,f,m,g,y,_){const v=i?t-n:t+n;let x=v>0?1:-1,b=0;i&&(x*=-1,b=Math.PI),x<0&&(b+=Math.PI);let w=l+s+(x>0?0:1)|0,S=o,T=o,E=0,A=0;const M=Math.abs(v),P=[],k=[];let C=a,j=C;const I=()=>Jt(j,C,T,M-E+1,h,p,g,y.canonical);for(;E+A<=M;){if(w+=x,w<l||w>=c)return null;if(T=S,j=C,P.push(T),f&&k.push(j),C=new e.P(u.getx(w),u.gety(w)),S=d[w],!S){const e=Kt(C,y.canonical,h,g,p);S=e[3]>0?d[w]=e:I()}E+=A,A=e.a6.vec3.distance(T,S)}m&&p&&(d[w]&&(S=I(),A=e.a6.vec3.distance(T,S)),d[w]=S);const O=(M-E)/A,N=C.sub(j)._mult(O)._add(j),D=e.a6.vec3.sub([],S,T),L=e.a6.vec3.scaleAndAdd([],T,D,O);let z=[0,0,1],R=D[0],F=D[1];if(_&&(z=g.upVector(y.canonical,N.x,N.y),0!==z[0]||0!==z[1]||1!==z[2])){const t=[z[2],0,-z[0]],n=e.a6.vec3.cross([],z,t);e.a6.vec3.normalize(t,t),e.a6.vec3.normalize(n,n),R=e.a6.vec3.dot(D,t),F=e.a6.vec3.dot(D,n)}if(r){const t=e.a6.vec3.cross([],z,D);e.a6.vec3.normalize(t,t),e.a6.vec3.scaleAndAdd(L,L,t,r*x)}const B=b+Math.atan2(F,R);return P.push(L),f&&k.push(N),{point:L,angle:B,path:P,tilePath:k,up:z}}function $t(e,t){const n=t.length,r=n+4*e;t.resize(r),t.float32.fill(-1/0,4*n,4*r)}function en(e,t,n){const r=t[0],i=t[1];return e[0]=n[0]*r+n[4]*i+n[12],e[1]=n[1]*r+n[5]*i+n[13],e[3]=n[3]*r+n[7]*i+n[15],e}const tn=100;class nn{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new zt(e.width+200,e.height+200,25),r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new zt(e.width+200,e.height+200,25);this.transform=e,this.grid=n,this.ignoredGrid=r,this.pitchfactor=Math.cos(e._pitch)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+tn,this.screenBottomBoundary=e.height+tn,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.fogState=t}placeCollisionBox(e,t,n,r,i,o,a,s){let l=n.projectedAnchorX,c=n.projectedAnchorY,u=n.projectedAnchorZ;const h=n.elevation,d=n.tileID,p=e.getProjection();if(h&&d){const[e,t,r]=p.upVector(d.canonical,n.tileAnchorX,n.tileAnchorY),i=p.upVectorScale(d.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;l+=e*h*i,c+=t*h*i,u+=r*h*i}const f=this.projectAndGetPerspectiveRatio(a,l,c,u,n.tileID,"globe"===p.name||!!h||this.transform.pitch>0,p),m=o*f.perspectiveRatio,g=(n.x1*t+r.x-n.padding)*m+f.point.x,y=(n.y1*t+r.y-n.padding)*m+f.point.y,_=(n.x2*t+r.x+n.padding)*m+f.point.x,v=(n.y2*t+r.y+n.padding)*m+f.point.y,x=f.perspectiveRatio<=.55||f.occluded;return!this.isInsideGrid(g,y,_,v)||!i&&this.grid.hitTest(g,y,_,v,s)||x?{box:[],offscreen:!1,occluded:f.occluded}:{box:[g,y,_,v],offscreen:this.isOffscreen(g,y,_,v),occluded:!1}}placeCollisionCircles(t,n,r,i,o,a,s,l,c,u,h,d,p,f,m){const g=[],y=this.transform.elevation,_=t.getProjection(),v=y?y.getAtTileOffsetFunc(m,this.transform.center.lat,this.transform.worldSize,_):null,x=new e.P(r.tileAnchorX,r.tileAnchorY);let{x:b,y:w,z:S}=_.projectTilePoint(x.x,x.y,m.canonical);if(v){const[e,t,n]=v(x);b+=e,w+=t,S+=n}const T="globe"===_.name,E=this.projectAndGetPerspectiveRatio(s,b,w,S,m,T||!!y||this.transform.pitch>0,_),{perspectiveRatio:A}=E,M=(h?a/A:a*A)/e.br,P=Gt(b,w,S,l),k=E.signedDistanceFromCamera>0?Wt(M,o,r.lineOffsetX*M,r.lineOffsetY*M,!1,P,x,r,i,l,{},y&&!h?v:null,h&&!!y,_,m,h):null;let C=!1,j=!1,I=!0;if(k&&!E.occluded){const t=.5*p*A+f,r=new e.P(-100,-100),i=new e.P(this.screenRightBoundary,this.screenBottomBoundary),o=new Lt,{first:a,last:s}=k,l=a.path.length;let h=[];for(let e=l-1;e>=1;e--)h.push(a.path[e]);for(let e=1;e<s.path.length;e++)h.push(s.path[e]);const m=2.5*t;c&&(h=h.map(((e,t)=>{let[n,r,i]=e;return v&&!T&&(i=v(t<l-1?a.tilePath[l-1-t]:s.tilePath[t-l+2])[2]),Gt(n,r,i,c)})),h.some((e=>e[3]<=0))&&(h=[]));let y=[];if(h.length>0){let t=1/0,n=-1/0,o=1/0,a=-1/0;for(const e of h)t=Math.min(t,e[0]),o=Math.min(o,e[1]),n=Math.max(n,e[0]),a=Math.max(a,e[1]);n>=r.x&&t<=i.x&&a>=r.y&&o<=i.y&&(y=[h.map((t=>new e.P(t[0],t[1])))],(t<r.x||n>i.x||o<r.y||a>i.y)&&(y=e.bp(y,r.x,r.y,i.x,i.y)))}for(const e of y){o.reset(e,.25*t);let r=0;r=o.length<=.5*t?1:Math.ceil(o.paddedLength/m)+1;for(let e=0;e<r;e++){const i=e/Math.max(r-1,1),a=o.lerp(i),s=a.x+tn,l=a.y+tn;g.push(s,l,t,0);const c=s-t,h=l-t,p=s+t,f=l+t;if(I=I&&this.isOffscreen(c,h,p,f),j=j||this.isInsideGrid(c,h,p,f),!n&&this.grid.hitTestCircle(s,l,t,d)&&(C=!0,!u))return{circles:[],offscreen:!1,collisionDetected:C,occluded:!1}}}}return{circles:!u&&C||!j?[]:g,offscreen:I,collisionDetected:C,occluded:E.occluded}}queryRenderedSymbols(t){if(0===t.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const n=[];let r=1/0,i=1/0,o=-1/0,a=-1/0;for(const u of t){const t=new e.P(u.x+tn,u.y+tn);r=Math.min(r,t.x),i=Math.min(i,t.y),o=Math.max(o,t.x),a=Math.max(a,t.y),n.push(t)}const s=this.grid.query(r,i,o,a).concat(this.ignoredGrid.query(r,i,o,a)),l={},c={};for(const u of s){const t=u.key;if(void 0===l[t.bucketInstanceId]&&(l[t.bucketInstanceId]={}),l[t.bucketInstanceId][t.featureIndex])continue;const r=[new e.P(u.x1,u.y1),new e.P(u.x2,u.y1),new e.P(u.x2,u.y2),new e.P(u.x1,u.y2)];e.bq(n,r)&&(l[t.bucketInstanceId][t.featureIndex]=!0,void 0===c[t.bucketInstanceId]&&(c[t.bucketInstanceId]=[]),c[t.bucketInstanceId].push(t.featureIndex))}return c}insertCollisionBox(e,t,n,r,i){(t?this.ignoredGrid:this.grid).insert({bucketInstanceId:n,featureIndex:r,collisionGroupID:i},e[0],e[1],e[2],e[3])}insertCollisionCircles(e,t,n,r,i){const o=t?this.ignoredGrid:this.grid,a={bucketInstanceId:n,featureIndex:r,collisionGroupID:i};for(let s=0;s<e.length;s+=4)o.insertCircle(a,e[s],e[s+1],e[s+2])}projectAndGetPerspectiveRatio(t,n,r,i,o,a,s){const l=[n,r,i,1];let c=!1;if(i||this.transform.pitch>0){if(e.a6.vec4.transformMat4(l,l,t),this.fogState&&o&&"globe"!==s.name){const t=function(t,n,r,i,o,a){const s=a.calculateFogTileMatrix(o),l=[n,r,i];return e.a6.vec3.transformMat4(l,l,s),Fe(t,e.a6.vec3.length(l),a.pitch,a._fov)}(this.fogState,n,r,i,o.toUnwrapped(),this.transform);c=t>.9}}else en(l,l,t);const u=l[3];return{point:new e.P((l[0]/u+1)/2*this.transform.width+tn,(-l[1]/u+1)/2*this.transform.height+tn),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(s)/u*.5,1.5),signedDistanceFromCamera:u,occluded:a&&l[2]>u||c}}isOffscreen(e,t,n,r){return n<tn||e>=this.screenRightBoundary||r<tn||t>this.screenBottomBoundary}isInsideGrid(e,t,n,r){return n>=0&&e<this.gridRightBoundary&&r>=0&&t<this.gridBottomBoundary}getViewportMatrix(){const t=e.a6.mat4.identity([]);return e.a6.mat4.translate(t,t,[-100,-100,0]),t}}function rn(t,n,r){const i=n.createTileMatrix(t,t.worldSize,r.toUnwrapped());return e.a6.mat4.multiply(new Float32Array(16),t.projMatrix,i)}function on(e,t,n){if(t.projection.name===n.projection.name)return e.projMatrix;const r=n.clone();return r.setProjection(t.projection),rn(r,t.getProjection(),e)}function an(e,t,n){return t.name===n.projection.name?e.projMatrix:rn(n,t,e)}class sn{constructor(e,t,n,r){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?t:-t))):r&&n?1:0,this.placed=n}isHidden(){return 0===this.opacity&&!this.placed}}class ln{constructor(e,t,n,r,i){let o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];this.text=new sn(e?e.text:null,t,n,i),this.icon=new sn(e?e.icon:null,t,r,i),this.clipped=o}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class cn{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.text=e,this.icon=t,this.skipFade=n,this.clipped=r}}class un{constructor(){this.invProjMatrix=e.a6.mat4.create(),this.viewportMatrix=e.a6.mat4.create(),this.circles=[]}}class hn{constructor(e,t,n,r,i){this.bucketInstanceId=e,this.featureIndex=t,this.sourceLayerIndex=n,this.bucketIndex=r,this.tileID=i}}class dn{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){const t=++this.maxGroupID;this.collisionGroups[e]={ID:t,predicate:e=>e.collisionGroupID===t}}return this.collisionGroups[e]}}function pn(t,n,r,i,o){const{horizontalAlign:a,verticalAlign:s}=e.by(t),l=-(a-.5)*n,c=-(s-.5)*r,u=e.bx(t,i);return new e.P(l+u[0]*o,c+u[1]*o)}function fn(t,n,r,i,o){const a=new e.P(t,n);return r&&a._rotate(i?o:-o),a}class mn{constructor(e,t,n,r,i,o){this.transform=e.clone(),this.projection=e.projection.name,this.collisionIndex=new nn(this.transform,i),this.buildingIndex=o,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=t,this.retainedQueryData={},this.collisionGroups=new dn(n),this.collisionCircleArrays={},this.prevPlacement=r,r&&(r.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(t,n,r,i){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;const a=r.getBucket(n),s=r.latestFeatureIndex;if(!a||!s||n.fqid!==a.layerIds[0])return;const l=a.layers[0].layout,c=a.layers[0].paint,u=r.collisionBoxArray,h=Math.pow(2,this.transform.zoom-r.tileID.overscaledZ),d=r.tileSize/e.ab,p=r.tileID.toUnwrapped();this.transform.setProjection(a.projection);const f=(m=r.tileID,g=a.getProjection(),y=this.transform,g.name===this.projection?y.calculateProjMatrix(m.toUnwrapped()):rn(y,g,m));var m,g,y;const _="map"===l.get("text-pitch-alignment"),v="map"===l.get("text-rotation-alignment");n.compileFilter(n.options);const x=n.dynamicFilter(),b=n.dynamicFilterNeedsFeature(),w=this.transform.calculatePixelsToTileUnitsMatrix(r),S=Vt(f,r.tileID.canonical,_,v,this.transform,a.getProjection(),w);let T=null;if(_){const t=Ut(f,r.tileID.canonical,_,v,this.transform,a.getProjection(),w);T=e.a6.mat4.multiply([],this.transform.labelPlaneMatrix,t)}let E=null;x&&r.latestFeatureIndex&&(E={unwrappedTileID:p,dynamicFilter:x,dynamicFilterNeedsFeature:b}),this.retainedQueryData[a.bucketInstanceId]=new hn(a.bucketInstanceId,s,a.sourceLayerIndex,a.index,r.tileID);const A=a.layers[0].layout.get("text-size-scale-range"),M=e.ap(o,A[0],A[1]),P=a.layers[0].layout.get("icon-size-scale-range"),k=e.ap(o,P[0],P[1]),C={bucket:a,layout:l,paint:c,posMatrix:f,textLabelPlaneMatrix:S,labelToScreenMatrix:T,clippingData:E,scale:h,textPixelRatio:d,holdingForFade:r.holdingForFade(),collisionBoxArray:u,partiallyEvaluatedTextSize:e.bk(a.textSizeData,this.transform.zoom,M),partiallyEvaluatedIconSize:e.bk(a.iconSizeData,this.transform.zoom,k),collisionGroup:this.collisionGroups.get(a.sourceID),latestFeatureIndex:r.latestFeatureIndex};if(i)for(const e of a.sortKeyRanges){const{sortKey:n,symbolInstanceStart:r,symbolInstanceEnd:i}=e;t.push({sortKey:n,symbolInstanceStart:r,symbolInstanceEnd:i,parameters:C})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:a.symbolInstances.length,parameters:C})}attemptAnchorPlacement(e,t,n,r,i,o,a,s,l,c,u,h,d,p,f,m,g,y){const{textOffset0:_,textOffset1:v,crossTileID:x}=h,b=[_,v],w=pn(e,n,r,b,i),S=this.collisionIndex.placeCollisionBox(p,i,t,fn(w.x,w.y,o,a,this.transform.angle),u,s,l,c.predicate);if(m){const e=p.getSymbolInstanceIconSize(y,this.transform.zoom,h.placedIconSymbolIndex);if(0===this.collisionIndex.placeCollisionBox(p,e,m,fn(w.x,w.y,o,a,this.transform.angle),u,s,l,c.predicate).box.length)return}if(S.box.length>0){let t;return this.prevPlacement&&this.prevPlacement.variableOffsets[x]&&this.prevPlacement.placements[x]&&this.prevPlacement.placements[x].text&&(t=this.prevPlacement.variableOffsets[x].anchor),this.variableOffsets[x]={textOffset:b,width:n,height:r,anchor:e,textScale:i,prevAnchor:t},this.markUsedJustification(p,e,h,f),p.allowVerticalPlacement&&(this.markUsedOrientation(p,f,h),this.placedOrientations[x]=f),{shift:w,placedGlyphBoxes:S}}}placeLayerBucketPart(t,n,r,i){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;const{bucket:a,layout:s,paint:l,posMatrix:c,textLabelPlaneMatrix:u,labelToScreenMatrix:h,clippingData:d,textPixelRatio:p,holdingForFade:f,collisionBoxArray:m,partiallyEvaluatedTextSize:g,partiallyEvaluatedIconSize:y,collisionGroup:_,latestFeatureIndex:v}=t.parameters,x=s.get("text-optional"),b=s.get("icon-optional"),w=s.get("text-allow-overlap"),S=s.get("icon-allow-overlap"),T="map"===s.get("text-rotation-alignment"),E="map"===s.get("text-pitch-alignment"),A=s.get("symbol-z-elevate"),M=l.get("symbol-z-offset"),P="sea"===s.get("symbol-elevation-reference"),k=s.get("text-size-scale-range"),C=s.get("icon-size-scale-range"),j=e.ap(o,k[0],k[1]),I=e.ap(o,C[0],C[1]);this.transform.setProjection(a.projection);let O=w&&(S||!a.hasIconData()||b),N=S&&(w||!a.hasTextData()||x);const D=!M.isConstant();!a.collisionArrays&&m&&a.deserializeCollisionBoxes(m),r&&i&&a.updateCollisionDebugBuffers(this.transform.zoom,m,j,I);const L=(t,i,l)=>{const{crossTileID:m,numVerticalGlyphVertices:A}=t;let k=null;if(d&&d.dynamicFilterNeedsFeature||D){const e=this.retainedQueryData[a.bucketInstanceId];k=v.loadFeature({featureIndex:t.featureIndex,bucketIndex:e.bucketIndex,sourceLayerIndex:e.sourceLayerIndex,layoutVertexArrayOffset:0})}if(d&&!(0,d.dynamicFilter)({zoom:this.transform.zoom,pitch:this.transform.pitch},k,this.retainedQueryData[a.bucketInstanceId].tileID.canonical,new e.P(t.tileAnchorX,t.tileAnchorY),this.transform.calculateDistanceTileData(d.unwrappedTileID)))return this.placements[m]=new cn(!1,!1,!1,!0),void n.add(m);const C=M.evaluate(k,{});if(n.has(m))return;if(f)return void(this.placements[m]=new cn(!1,!1,!1));let j=!1,I=!1,L=!0,z=!1,R=!1,F=null,B={box:null,offscreen:null,occluded:null},V={box:null,offscreen:null,occluded:null},U=null,G=null,H=null,Z=0,q=0,W=0;l.textFeatureIndex?Z=l.textFeatureIndex:t.useRuntimeCollisionCircles&&(Z=t.featureIndex),l.verticalTextFeatureIndex&&(q=l.verticalTextFeatureIndex);const X=e=>{e.tileID=this.retainedQueryData[a.bucketInstanceId].tileID;const n=this.transform.elevation;e.elevation=P?C:C+(n?n.getAtTileOffset(e.tileID,e.tileAnchorX,e.tileAnchorY):0),e.elevation+=t.zOffset},Y=l.textBox;if(Y){X(Y);const n=n=>{let r=e.bl.horizontal;if(a.allowVerticalPlacement&&!n&&this.prevPlacement){const e=this.prevPlacement.placedOrientations[m];e&&(this.placedOrientations[m]=e,r=e,this.markUsedOrientation(a,r,t))}return r},r=(t,n)=>{if(a.allowVerticalPlacement&&A>0&&l.verticalTextBox){for(const r of a.writingModes)if(r===e.bl.vertical?(B=n(),V=B):B=t(),B&&B.box&&B.box.length)break}else B=t()};if(s.get("text-variable-anchor")){let o=s.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[m]){const e=this.prevPlacement.variableOffsets[m];o.indexOf(e.anchor)>0&&(o=o.filter((t=>t!==e.anchor)),o.unshift(e.anchor))}const u=(e,n,r)=>{const s=a.getSymbolInstanceTextSize(g,t,this.transform.zoom,i),l=(e.x2-e.x1)*s+2*e.padding,u=(e.y2-e.y1)*s+2*e.padding,h=t.hasIconTextFit&&!S?n:null;h&&X(h);let d={box:[],offscreen:!1,occluded:!1};const f=w?2*o.length:o.length;for(let m=0;m<f;++m){const n=this.attemptAnchorPlacement(o[m%o.length],e,l,u,s,T,E,p,c,_,m>=o.length,t,i,a,r,h,g,y);if(n&&(d=n.placedGlyphBoxes,d&&d.box&&d.box.length)){j=!0,F=n.shift;break}}return d};r((()=>u(Y,l.iconBox,e.bl.horizontal)),(()=>{const t=l.verticalTextBox;return t&&X(t),a.allowVerticalPlacement&&!(B&&B.box&&B.box.length)&&A>0&&t?u(t,l.verticalIconBox,e.bl.vertical):{box:null,offscreen:null,occluded:null}})),B&&(j=B.box,L=B.offscreen,z=B.occluded);const h=n(!(!B||!B.box));if(!j&&this.prevPlacement){const e=this.prevPlacement.variableOffsets[m];e&&(this.variableOffsets[m]=e,this.markUsedJustification(a,e.anchor,t,h))}}else{const s=(n,r)=>{const s=a.getSymbolInstanceTextSize(g,t,this.transform.zoom,i,o),l=this.collisionIndex.placeCollisionBox(a,s,n,new e.P(0,0),w,p,c,_.predicate);return l&&l.box&&l.box.length&&(this.markUsedOrientation(a,r,t),this.placedOrientations[m]=r),l};r((()=>s(Y,e.bl.horizontal)),(()=>{const t=l.verticalTextBox;return a.allowVerticalPlacement&&A>0&&t?(X(t),s(t,e.bl.vertical)):{box:null,offscreen:null,occluded:null}})),n(!!(B&&B.box&&B.box.length))}}if(U=B,j=U&&U.box&&U.box.length>0,L=U&&U.offscreen,z=U&&U.occluded,t.useRuntimeCollisionCircles){const n=a.text.placedSymbolArray.get(t.centerJustifiedTextSymbolIndex>=0?t.centerJustifiedTextSymbolIndex:t.verticalPlacedTextSymbolIndex),i=e.bm(a.textSizeData,g,n),o=s.get("text-padding");G=this.collisionIndex.placeCollisionCircles(a,w,n,a.lineVertexArray,a.glyphOffsetArray,i,c,u,h,r,E,_.predicate,t.collisionCircleDiameter*i/e.br,o,this.retainedQueryData[a.bucketInstanceId].tileID),j=w||G.circles.length>0&&!G.collisionDetected,L=L&&G.offscreen,z=G.occluded}if(l.iconFeatureIndex&&(W=l.iconFeatureIndex),l.iconBox){const n=n=>{X(n);const r=t.hasIconTextFit&&F?fn(F.x,F.y,T,E,this.transform.angle):new e.P(0,0),i=a.getSymbolInstanceIconSize(y,this.transform.zoom,t.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(a,i,n,r,S,p,c,_.predicate)};V&&V.box&&V.box.length&&l.verticalIconBox?(H=n(l.verticalIconBox),I=H.box.length>0):(H=n(l.iconBox),I=H.box.length>0),L=L&&H.offscreen,R=H.occluded}const K=x||0===t.numHorizontalGlyphVertices&&0===A,J=b||0===t.numIconVertices;if(K||J?J?K||(I=I&&j):j=I&&j:I=j=I&&j,j&&U&&U.box&&this.collisionIndex.insertCollisionBox(U.box,s.get("text-ignore-placement"),a.bucketInstanceId,V&&V.box&&q?q:Z,_.ID),I&&H&&this.collisionIndex.insertCollisionBox(H.box,s.get("icon-ignore-placement"),a.bucketInstanceId,W,_.ID),G&&(j&&this.collisionIndex.insertCollisionCircles(G.circles,s.get("text-ignore-placement"),a.bucketInstanceId,Z,_.ID),r)){const e=a.bucketInstanceId;let t=this.collisionCircleArrays[e];void 0===t&&(t=this.collisionCircleArrays[e]=new un);for(let n=0;n<G.circles.length;n+=4)t.circles.push(G.circles[n+0]),t.circles.push(G.circles[n+1]),t.circles.push(G.circles[n+2]),t.circles.push(G.collisionDetected?1:0)}const Q="globe"!==a.projection.name;O=O&&(Q||!z),N=N&&(Q||!R),this.placements[m]=new cn(j||O,I||N,L||a.justReloaded),n.add(m)};if(A&&this.buildingIndex&&(this.buildingIndex.updateZOffset(a,this.retainedQueryData[a.bucketInstanceId].tileID),a.updateZOffset()),a.sortFeaturesByY){const t=a.getSortedSymbolIndexes(this.transform.angle);for(let e=t.length-1;e>=0;--e){const n=t[e];L(a.symbolInstances.get(n),n,a.collisionArrays[n])}a.hasAnyZOffset&&e.w("".concat(a.layerIds[0]," layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y"))}else if(a.hasAnyZOffset){const e=a.getSortedIndexesByZOffset();for(let t=0;t<e.length;++t){const n=e[t];L(a.symbolInstances.get(n),n,a.collisionArrays[n])}}else for(let e=t.symbolInstanceStart;e<t.symbolInstanceEnd;e++)L(a.symbolInstances.get(e),e,a.collisionArrays[e]);if(r&&a.bucketInstanceId in this.collisionCircleArrays){const t=this.collisionCircleArrays[a.bucketInstanceId];e.a6.mat4.invert(t.invProjMatrix,c),t.viewportMatrix=this.collisionIndex.getViewportMatrix()}a.justReloaded=!1}markUsedJustification(t,n,r,i){const{leftJustifiedTextSymbolIndex:o,centerJustifiedTextSymbolIndex:a,rightJustifiedTextSymbolIndex:s,verticalPlacedTextSymbolIndex:l,crossTileID:c}=r,u=e.bw(n),h=i===e.bl.vertical?l:"left"===u?o:"center"===u?a:"right"===u?s:-1;o>=0&&(t.text.placedSymbolArray.get(o).crossTileID=h>=0&&o!==h?0:c),a>=0&&(t.text.placedSymbolArray.get(a).crossTileID=h>=0&&a!==h?0:c),s>=0&&(t.text.placedSymbolArray.get(s).crossTileID=h>=0&&s!==h?0:c),l>=0&&(t.text.placedSymbolArray.get(l).crossTileID=h>=0&&l!==h?0:c)}markUsedOrientation(t,n,r){const i=n===e.bl.horizontal||n===e.bl.horizontalOnly?n:0,o=n===e.bl.vertical?n:0,{leftJustifiedTextSymbolIndex:a,centerJustifiedTextSymbolIndex:s,rightJustifiedTextSymbolIndex:l,verticalPlacedTextSymbolIndex:c}=r,u=t.text.placedSymbolArray;a>=0&&(u.get(a).placedOrientation=i),s>=0&&(u.get(s).placedOrientation=i),l>=0&&(u.get(l).placedOrientation=i),c>=0&&(u.get(c).placedOrientation=o)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;const t=this.prevPlacement;let n=!1;this.prevZoomAdjustment=t?t.zoomAdjustment(this.transform.zoom):0;const r=t?t.symbolFadeChange(e):1,i=t?t.opacities:{},o=t?t.variableOffsets:{},a=t?t.placedOrientations:{};for(const s in this.placements){const e=this.placements[s],t=i[s];t?(this.opacities[s]=new ln(t,r,e.text,e.icon,null,e.clipped),n=n||e.text!==t.text.placed||e.icon!==t.icon.placed):(this.opacities[s]=new ln(null,r,e.text,e.icon,e.skipFade,e.clipped),n=n||e.text||e.icon)}for(const s in i){const e=i[s];if(!this.opacities[s]){const t=new ln(e,r,!1,!1);t.isHidden()||(this.opacities[s]=t,n=n||e.text.placed||e.icon.placed)}}for(const s in o)this.variableOffsets[s]||!this.opacities[s]||this.opacities[s].isHidden()||(this.variableOffsets[s]=o[s]);for(const s in a)this.placedOrientations[s]||!this.opacities[s]||this.opacities[s].isHidden()||(this.placedOrientations[s]=a[s]);n?this.lastPlacementChangeTime=e:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=t?t.lastPlacementChangeTime:e)}updateLayerOpacities(e,t,n,r){const i=new Set;for(const o of t){const t=o.getBucket(e);t&&o.latestFeatureIndex&&e.fqid===t.layerIds[0]&&(this.updateBucketOpacities(t,i,o,o.collisionBoxArray,n,r,o.tileID,e.scope),t.layers[0].layout.get("symbol-z-elevate")&&this.buildingIndex&&(this.buildingIndex.updateZOffset(t,o.tileID),t.updateZOffset()))}}updateBucketOpacities(t,n,r,i,o,a,s,l){t.hasTextData()&&t.text.opacityVertexArray.clear(),t.hasIconData()&&t.icon.opacityVertexArray.clear(),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const c=t.layers[0].layout,u=t.layers[0].paint,h=!!t.layers[0].dynamicFilter(),d=new ln(null,0,!1,!1,!0),p=c.get("text-allow-overlap"),f=c.get("icon-allow-overlap"),m=c.get("text-variable-anchor"),g="map"===c.get("text-rotation-alignment"),y="map"===c.get("text-pitch-alignment"),_=u.get("symbol-z-offset"),v="sea"===c.get("symbol-elevation-reference"),x=!_.isConstant(),b=new ln(null,0,p&&(f||!t.hasIconData()||c.get("icon-optional")),f&&(p||!t.hasTextData()||c.get("text-optional")),!0);!t.collisionArrays&&i&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(i);const w=(e,t,n)=>{for(let r=0;r<t/4;r++)e.opacityVertexArray.emplaceBack(n)};let S=0;a&&t.updateReplacement(s,a);for(let T=0;T<t.symbolInstances.length;T++){const i=t.symbolInstances.get(T),{numHorizontalGlyphVertices:c,numVerticalGlyphVertices:u,crossTileID:p,numIconVertices:f,tileAnchorX:E,tileAnchorY:A}=i;let M=null;const P=this.retainedQueryData[t.bucketInstanceId];x&&i&&P&&(M=r.latestFeatureIndex.loadFeature({featureIndex:i.featureIndex,bucketIndex:P.bucketIndex,sourceLayerIndex:P.sourceLayerIndex,layoutVertexArrayOffset:0}));const k=_.evaluate(M,{}),C=n.has(p);let j=this.opacities[p];C?j=d:j||(j=b,this.opacities[p]=j),n.add(p);const I=c>0||u>0,O=f>0,N=this.placedOrientations[p],D=N===e.bl.vertical,L=N===e.bl.horizontal||N===e.bl.horizontalOnly;!I&&!O||j.isHidden()||S++;let z=!1;if((I||O)&&a)for(const n of t.activeReplacements){if(e.bs(n,o,e.bt.Symbol,l))continue;if(n.min.x>E||E>n.max.x||n.min.y>A||A>n.max.y)continue;const t=e.bu(E,A,s.canonical,n.footprintTileId.canonical);if(z=e.bv(t,n.footprint),z)break}if(I){const e=z?En:Tn(j.text);w(t.text,c,D?En:e),w(t.text,u,L?En:e);const n=j.text.isHidden(),{leftJustifiedTextSymbolIndex:r,centerJustifiedTextSymbolIndex:o,rightJustifiedTextSymbolIndex:a,verticalPlacedTextSymbolIndex:s}=i,l=t.text.placedSymbolArray,h=n||D?1:0;r>=0&&(l.get(r).hidden=h),o>=0&&(l.get(o).hidden=h),a>=0&&(l.get(a).hidden=h),s>=0&&(l.get(s).hidden=n||L?1:0);const d=this.variableOffsets[p];d&&this.markUsedJustification(t,d.anchor,i,N);const f=this.placedOrientations[p];f&&(this.markUsedJustification(t,"left",i,f),this.markUsedOrientation(t,f,i))}if(O){const e=z?En:Tn(j.icon),{placedIconSymbolIndex:n,verticalPlacedIconSymbolIndex:r}=i,o=t.icon.placedSymbolArray,a=j.icon.isHidden()?1:0;n>=0&&(w(t.icon,f,D?En:e),o.get(n).hidden=a),r>=0&&(w(t.icon,i.numVerticalIconVertices,L?En:e),o.get(r).hidden=a)}if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const n=t.collisionArrays[T];if(n){let r=new e.P(0,0),o=!0;if(n.textBox||n.verticalTextBox){if(m){const e=this.variableOffsets[p];e?(r=pn(e.anchor,e.width,e.height,e.textOffset,e.textScale),g&&r._rotate(y?this.transform.angle:-this.transform.angle)):o=!1}h&&(o=!j.clipped),n.textBox&&gn(t.textCollisionBox.collisionVertexArray,j.text.placed,!o||D,k,v,r.x,r.y),n.verticalTextBox&&gn(t.textCollisionBox.collisionVertexArray,j.text.placed,!o||L,k,v,r.x,r.y)}const a=o&&Boolean(!L&&n.verticalIconBox);n.iconBox&&gn(t.iconCollisionBox.collisionVertexArray,j.icon.placed,a,k,v,i.hasIconTextFit?r.x:0,i.hasIconTextFit?r.y:0),n.verticalIconBox&&gn(t.iconCollisionBox.collisionVertexArray,j.icon.placed,!a,k,v,i.hasIconTextFit?r.x:0,i.hasIconTextFit?r.y:0)}}}if(t.fullyClipped=0===S,t.sortFeatures(this.transform.angle),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.bucketInstanceId in this.collisionCircleArrays){const e=this.collisionCircleArrays[t.bucketInstanceId];t.placementInvProjMatrix=e.invProjMatrix,t.placementViewportMatrix=e.viewportMatrix,t.collisionCircleArray=e.circles,delete this.collisionCircleArrays[t.bucketInstanceId]}}symbolFadeChange(e){return 0===this.fadeDuration?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,t){const n=this.zoomAtLastRecencyCheck===t?1-this.zoomAdjustment(t):1;return this.zoomAtLastRecencyCheck=t,this.commitTime+this.fadeDuration*n>e}setStale(){this.stale=!0}}function gn(e,t,n,r,i,o,a){e.emplaceBack(t?1:0,n?1:0,o||0,a||0,r,i?1:0),e.emplaceBack(t?1:0,n?1:0,o||0,a||0,r,i?1:0),e.emplaceBack(t?1:0,n?1:0,o||0,a||0,r,i?1:0),e.emplaceBack(t?1:0,n?1:0,o||0,a||0,r,i?1:0)}const yn=Math.pow(2,25),_n=Math.pow(2,24),vn=Math.pow(2,17),xn=Math.pow(2,16),bn=Math.pow(2,9),wn=Math.pow(2,8),Sn=Math.pow(2,1);function Tn(e){if(0===e.opacity&&!e.placed)return 0;if(1===e.opacity&&e.placed)return 4294967295;const t=e.placed?1:0,n=Math.floor(127*e.opacity);return n*yn+t*_n+n*vn+t*xn+n*bn+t*wn+n*Sn+t}const En=0;class An{constructor(e){this._sortAcrossTiles="viewport-y"!==e.layout.get("symbol-z-order")&&void 0!==e.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(e,t,n,r,i,o){const a=this._bucketParts;for(;this._currentTileIndex<e.length;)if(t.getBucketParts(a,r,e[this._currentTileIndex],this._sortAcrossTiles,o),this._currentTileIndex++,i())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,a.sort(((e,t)=>e.sortKey-t.sortKey)));this._currentPartIndex<a.length;){const e=a[this._currentPartIndex];if(t.placeLayerBucketPart(e,this._seenCrossTileIDs,n,0===e.symbolInstanceStart,o),this._currentPartIndex++,i())return!0}return!1}}class Mn{constructor(e,t,n,r,i,o,a,s,l){this.placement=new mn(e,i,o,a,s,l),this._currentPlacementIndex=t.length-1,this._forceFullPlacement=n,this._showCollisionBoxes=r,this._done=!1}isDone(){return this._done}continuePlacement(t,n,r,i,o){const a=e.q.now(),s=()=>{const t=e.q.now()-a;return!this._forceFullPlacement&&t>2};for(;this._currentPlacementIndex>=0;){const a=n[t[this._currentPlacementIndex]],l=this.placement.collisionIndex.transform.zoom;if("symbol"===a.type&&(!a.minzoom||a.minzoom<=l)&&(!a.maxzoom||a.maxzoom>l)){const t=a,n=t.layout.get("symbol-z-elevate"),l=void 0!==t.layout.get("symbol-sort-key").constantOr(1),c=t.layout.get("symbol-z-order"),u="viewport-y"===c||"auto"===c&&!("viewport-y"!==c&&l),h=t.layout.get("text-allow-overlap")||t.layout.get("icon-allow-overlap")||t.layout.get("text-ignore-placement")||t.layout.get("icon-ignore-placement"),d=u&&h,p=this._inProgressLayer=this._inProgressLayer||new An(t),f=e.av(a.source,a.scope);if(p.continuePlacement(n||d?i[f]:r[f],this.placement,this._showCollisionBoxes,a,s,o))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}}const Pn=512/e.ab/2;class kn{constructor(t,n,r){this.tileID=t,this.bucketInstanceId=r,this.index=new e.bz(n.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const i=t.canonical.x*e.ab,o=t.canonical.y*e.ab;for(let e=0;e<n.length;e++){const{key:t,crossTileID:r,tileAnchorX:a,tileAnchorY:s}=n.get(e),l=Math.floor((i+a)*Pn),c=Math.floor((o+s)*Pn);this.index.add(l,c),this.keys.push(t),this.crossTileIDs.push(r)}this.index.finish()}findMatches(t,n,r){const i=this.tileID.canonical.z<n.canonical.z?1:Math.pow(2,this.tileID.canonical.z-n.canonical.z),o=Pn/Math.pow(2,n.canonical.z-this.tileID.canonical.z),a=n.canonical.x*e.ab,s=n.canonical.y*e.ab;for(let e=0;e<t.length;e++){const n=t.get(e);if(n.crossTileID)continue;const{key:l,tileAnchorX:c,tileAnchorY:u}=n,h=Math.floor((a+c)*o),d=Math.floor((s+u)*o),p=this.index.range(h-i,d-i,h+i,d+i);for(const e of p){const t=this.crossTileIDs[e];if(this.keys[e]===l&&!r.has(t)){r.add(t),n.crossTileID=t;break}}}}}class Cn{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class jn{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){const t=Math.round((e-this.lng)/360);if(0!==t)for(const n in this.indexes){const e=this.indexes[n],r={};for(const n in e){const i=e[n];i.tileID=i.tileID.unwrapTo(i.tileID.wrap+t),r[i.tileID.key]=i}this.indexes[n]=r}this.lng=e}addBucket(e,t,n){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===t.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let i=0;i<t.symbolInstances.length;i++)t.symbolInstances.get(i).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]=new Set);const r=this.usedCrossTileIDs[e.overscaledZ];for(const i in this.indexes){const n=this.indexes[i];if(Number(i)>e.overscaledZ)for(const i in n){const o=n[i];o.tileID.isChildOf(e)&&o.findMatches(t.symbolInstances,e,r)}else{const o=n[e.scaledTo(Number(i)).key];o&&o.findMatches(t.symbolInstances,e,r)}}for(let i=0;i<t.symbolInstances.length;i++){const e=t.symbolInstances.get(i);e.crossTileID||(e.crossTileID=n.generate(),r.add(e.crossTileID))}return void 0===this.indexes[e.overscaledZ]&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new kn(e,t.symbolInstances,t.bucketInstanceId),!0}removeBucketCrossTileIDs(e,t){for(const n of t.crossTileIDs)this.usedCrossTileIDs[e].delete(n)}removeStaleBuckets(e){let t=!1;for(const n in this.indexes){const r=this.indexes[n];for(const i in r)e[r[i].bucketInstanceId]||(this.removeBucketCrossTileIDs(n,r[i]),delete r[i],t=!0)}return t}}class In{constructor(){this.layerIndexes={},this.crossTileIDs=new Cn,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,t,n,r){let i=this.layerIndexes[e.fqid];void 0===i&&(i=this.layerIndexes[e.fqid]=new jn);let o=!1;const a={};"globe"!==r.name&&i.handleWrapJump(n);for(const s of t){const t=s.getBucket(e);t&&e.fqid===t.layerIds[0]&&(t.bucketInstanceId||(t.bucketInstanceId=++this.maxBucketInstanceId),i.addBucket(s.tileID,t,this.crossTileIDs)&&(o=!0),a[t.bucketInstanceId]=!0)}return i.removeStaleBuckets(a)&&(o=!0),o}pruneUnusedLayers(e){const t={};e.forEach((e=>{t[e]=!0}));for(const n in this.layerIndexes)t[n]||delete this.layerIndexes[n]}}const On=771;class Nn{constructor(e,t,n,r){this.blendFunction=e,this.blendColor=t,this.mask=n,this.blendEquation=r}}Nn.Replace=[1,0,1,0],Nn.disabled=new Nn(Nn.Replace,e.bA.transparent,[!1,!1,!1,!1]),Nn.unblended=new Nn(Nn.Replace,e.bA.transparent,[!0,!0,!0,!0]),Nn.alphaBlended=new Nn([1,On,1,On],e.bA.transparent,[!0,!0,!0,!0]),Nn.alphaBlendedNonPremultiplied=new Nn([770,On,770,On],e.bA.transparent,[!0,!0,!0,!0]),Nn.multiply=new Nn([774,0,774,0],e.bA.transparent,[!0,!0,!0,!0]);class Dn{constructor(e,t,n){this.func=e,this.mask=t,this.range=n}}Dn.ReadOnly=!1,Dn.ReadWrite=!0,Dn.disabled=new Dn(519,Dn.ReadOnly,[0,1]);const Ln=7680;class zn{constructor(e,t,n,r,i,o){this.test=e,this.ref=t,this.mask=n,this.fail=r,this.depthFail=i,this.pass=o}}zn.disabled=new zn({func:519,mask:0},0,0,Ln,Ln,Ln);const Rn=1029,Fn=2305;class Bn{constructor(e,t,n){this.enable=e,this.mode=t,this.frontFace=n}}function Vn(t,n){const r=e.bD(t,3);e.a6.mat4.fromQuat(t,n),e.bF(t,3,r)}function Un(t,n){const r=e.a6.quat.identity([]);return e.a6.quat.rotateZ(r,r,-n),e.a6.quat.rotateX(r,r,-t),r}function Gn(t,n){const r=[t[0],t[1],0],i=[n[0],n[1],0];if(e.a6.vec3.length(r)>=1e-15){const t=e.a6.vec3.normalize([],r);e.a6.vec3.scale(i,t,e.a6.vec3.dot(i,t)),n[0]=i[0],n[1]=i[1]}const o=e.a6.vec3.cross([],n,t);if(e.a6.vec3.len(o)<1e-15)return null;const a=Math.atan2(-o[1],o[0]);return Un(Math.atan2(Math.sqrt(t[0]*t[0]+t[1]*t[1]),-t[2]),a)}Bn.disabled=new Bn(!1,Rn,Fn),Bn.backCCW=new Bn(!0,Rn,Fn),Bn.backCW=new Bn(!0,Rn,2304),Bn.frontCW=new Bn(!0,1028,2304),Bn.frontCCW=new Bn(!0,1028,Fn);class Hn{constructor(e,t){this.position=e,this.orientation=t}get position(){return this._position}set position(t){if(t){const n=t instanceof e.a5?t:new e.a5(t[0],t[1],t[2]);this._renderWorldCopies&&(n.x=e.bB(n.x,0,1)),this._position=n}else this._position=null}lookAtPoint(t,n){if(this.orientation=null,!this.position)return;const r=this.position,i=this._elevation?this._elevation.getAtPointOrZero(e.a5.fromLngLat(t)):0,o=e.a5.fromLngLat(t,i),a=[o.x-r.x,o.y-r.y,o.z-r.z];n||(n=[0,0,1]),n[2]=Math.abs(n[2]),this.orientation=Gn(a,n)}setPitchBearing(t,n){this.orientation=Un(e.bC(t),e.bC(-n))}}class Zn{constructor(t,n){this._transform=e.a6.mat4.identity([]),this.orientation=n,this.position=t}get mercatorPosition(){const t=this.position;return new e.a5(t[0],t[1],t[2])}get position(){const t=e.bD(this._transform,3);return[t[0],t[1],t[2]]}set position(t){var n;t&&e.bF(this._transform,3,[(n=t)[0],n[1],n[2],1])}get orientation(){return this._orientation}set orientation(t){this._orientation=t||e.a6.quat.identity([]),t&&Vn(this._transform,this._orientation)}getPitchBearing(){const e=this.forward(),t=this.right();return{bearing:Math.atan2(-t[1],t[0]),pitch:Math.atan2(Math.sqrt(e[0]*e[0]+e[1]*e[1]),-e[2])}}setPitchBearing(e,t){this._orientation=Un(e,t),Vn(this._transform,this._orientation)}forward(){const t=e.bD(this._transform,2);return[-t[0],-t[1],-t[2]]}up(){const t=e.bD(this._transform,1);return[-t[0],-t[1],-t[2]]}right(){const t=e.bD(this._transform,0);return[t[0],t[1],t[2]]}getCameraToWorld(t,n){const r=new Float64Array(16);return e.a6.mat4.invert(r,this.getWorldToCamera(t,n)),r}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(t,n,r){const i=this.position;e.a6.vec3.scale(i,i,-t);const o=new Float64Array(16);return e.a6.mat4.fromScaling(o,[r,r,r]),e.a6.mat4.translate(o,o,i),o[10]*=n,o}getWorldToCamera(t,n){const r=new Float64Array(16),i=new Float64Array(4),o=this.position;return e.a6.quat.conjugate(i,this._orientation),e.a6.vec3.scale(o,o,-t),e.a6.mat4.fromQuat(r,i),e.a6.mat4.translate(r,r,o),r[1]*=-1,r[5]*=-1,r[9]*=-1,r[13]*=-1,r[8]*=n,r[9]*=n,r[10]*=n,r[11]*=n,r}getCameraToClipPerspective(t,n,r,i){const o=new Float64Array(16);return e.a6.mat4.perspective(o,t,n,r,i),o}getCameraToClipOrthographic(t,n,r,i,o,a){const s=new Float64Array(16);return e.a6.mat4.ortho(s,t,n,r,i,o,a),s}getDistanceToElevation(t){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=0===t?0:e.bE(t,n?e.aN(this.position[1]):this.position[1]),i=this.forward();return(r-this.position[2])/i[2]}clone(){return new Zn([...this.position],[...this.orientation])}}const qn={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,LUT:10,ShadowMap0:11};class Wn{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(isNaN(e)||e<0||isNaN(t)||t<0||isNaN(n)||n<0||isNaN(r)||r<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=t,this.left=n,this.right=r}interpolate(t,n,r){return null!=n.top&&null!=t.top&&(this.top=e.aa(t.top,n.top,r)),null!=n.bottom&&null!=t.bottom&&(this.bottom=e.aa(t.bottom,n.bottom,r)),null!=n.left&&null!=t.left&&(this.left=e.aa(t.left,n.left,r)),null!=n.right&&null!=t.right&&(this.right=e.aa(t.right,n.right,r)),this}getCenter(t,n){const r=e.ap((this.left+t-this.right)/2,0,t),i=e.ap((this.top+n-this.bottom)/2,0,n);return new e.P(r,i)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new Wn(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const Xn=(e,t,n)=>(1-n)*e+n*t,Yn=e=>e*e*e*e*e;class Kn{constructor(t,n,r,i,o,a,s){this.tileSize=512,this._renderWorldCopies=void 0===o||o,this._minZoom=t||0,this._maxZoom=n||22,this._minPitch=null!==r&&void 0!==r?r:0,this._maxPitch=null!==i&&void 0!==i?i:60,this.setProjection(a),this.setMaxBounds(s),this.width=0,this.height=0,this._center=new e.bL(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Wn,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new Zn,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1}clone(){const e=new Kn(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return e._elevation=this._elevation,e._centerAltitude=this._centerAltitude,e._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,e.tileSize=this.tileSize,e.mercatorFromTransition=this.mercatorFromTransition,e.width=this.width,e.height=this.height,e.cameraElevationReference=this.cameraElevationReference,e._center=this._center,e._setZoom(this.zoom),e._seaLevelZoom=this._seaLevelZoom,e.angle=this.angle,e._fov=this._fov,e._pitch=this._pitch,e._nearZ=this._nearZ,e._farZ=this._farZ,e._averageElevation=this._averageElevation,e._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,e._unmodified=this._unmodified,e._edgeInsets=this._edgeInsets.clone(),e._camera=this._camera.clone(),e._calcMatrices(),e.freezeTileCoverage=this.freezeTileCoverage,e.frustumCorners=this.frustumCorners,e}get isOrthographic(){return"globe"!==this.projection.name&&this._orthographicProjectionAtLowPitch&&this.pitch<15}get elevation(){return this._elevation}set elevation(e){this._elevation!==e&&(this._elevation=e,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return"globe"!==this.projection.name&&!this.isOrthographic}updateElevation(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(null==this._seaLevelZoom||n)&&this._updateCameraOnTerrain(),(e||n)&&this._constrainCamera(t),this._calcMatrices()}getProjection(){return e.ar(this.projection,["name","center","parallels"])}setProjection(t){this.projectionOptions=t||{name:"mercator"};const n=this.projection?this.getProjection():void 0;this.projection=e.bM(this.projectionOptions);const r=this.getProjection(),i=!e.bi(n,r);return i&&this._calcMatrices(),this.mercatorFromTransition=!1,i}setOrthographicProjectionAtLowPitch(e){return this._orthographicProjectionAtLowPitch!==e&&(this._orthographicProjectionAtLowPitch=e,this._calcMatrices(),!0)}setMercatorFromTransition(){const t=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=e.bM({name:"mercator"});const n=t!==this.projection.name;return n&&this._calcMatrices(),n}get minZoom(){return this._minZoom}set minZoom(e){this._minZoom!==e&&(this._minZoom=e,this.zoom=Math.max(this.zoom,e))}get maxZoom(){return this._maxZoom}set maxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.zoom=Math.min(this.zoom,e))}get minPitch(){return this._minPitch}set minPitch(e){this._minPitch!==e&&(this._minPitch=e,this.pitch=Math.max(this.pitch,e))}get maxPitch(){return this._maxPitch}set maxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.pitch=Math.min(this.pitch,e))}get renderWorldCopies(){return this._renderWorldCopies&&!0===this.projection.supportsWorldCopies}set renderWorldCopies(e){void 0===e?e=!0:null===e&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const e=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(e))}get cameraWorldSize(){const e=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(e))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return e.bE(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new e.P(this.width,this.height)}get bearing(){return e.bB(this.rotation,-180,180)}set bearing(e){this.rotation=e}get rotation(){return-this.angle/Math.PI*180}set rotation(t){const n=-t*Math.PI/180;this.angle!==n&&(this._unmodified=!1,this.angle=n,this._calcMatrices(),this.rotationMatrix=e.a6.mat2.create(),e.a6.mat2.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(t){const n=e.ap(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==n&&(this._unmodified=!1,this._pitch=n,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const e=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/e)}set fov(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=e.bC(t),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(e){this._averageElevation=e,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(e){const t=Math.min(Math.max(e,this.minZoom),this.maxZoom);this._zoom!==t&&(this._unmodified=!1,this._setZoom(t),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(e){this._zoom=e,this.scale=this.zoomScale(e),this.tileZoom=Math.floor(e),this.zoomFraction=e-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(e){this._tileCoverLift!==e&&(this._tileCoverLift=e)}_updateCameraOnTerrain(){const e=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,t=this.elevation&&e===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||e===Number.NEGATIVE_INFINITY&&(!t||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const n=this._elevation;t||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&n.exaggeration()&&this._centerAltitudeValidForExaggeration!==n.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*n.exaggeration(),this._centerAltitudeValidForExaggeration=n.exaggeration()):(this._centerAltitude=e||0,this._centerAltitudeValidForExaggeration=n.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){void 0!==this._centerAltitudeValidForExaggeration&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const t=this._elevation,n=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],r=this.horizonLineFromTop();let i=0,o=0;for(let a=0;a<n.length;a++){const s=new e.P(n[a][0]*this.width,r+n[a][1]*(this.height-r)),l=t.pointCoordinate(s);if(!l)continue;const c=1/Math.hypot(l[0]-this._camera.position[0],l[1]-this._camera.position[1]);i+=l[3]*c,o+=c}return 0===o?NaN:i/o}get center(){return this._center}set center(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(null==this._seaLevelZoom||!this._elevation)return;const e=this._seaLevelZoom,t=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),n=this.pixelsPerMeter/this.worldSize*t,r=this._mercatorZfromZoom(e),i=this._mercatorZfromZoom(this._maxZoom),o=Math.max(r-n,i);this._setZoom(this._zoomFromMercatorZ(o))}get padding(){return this._edgeInsets.toJSON()}set padding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}computeZoomRelativeTo(t){const n=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,t.toAltitude()));let r;r=t.z<this._camera.position[2]?[n.x,n.y,n.z]:[t.x,t.y,t.z];const i=e.a6.vec3.length(e.a6.vec3.sub([],this._camera.position,r));return e.ap(this._zoomFromMercatorZ(i),this._minZoom,this._maxZoom)}setFreeCameraOptions(t){if(!this.height)return;if(!t.position&&!t.orientation)return;this._updateCameraState();let n=!1;if(t.orientation&&!e.a6.quat.exactEquals(t.orientation,this._camera.orientation)&&(n=this._setCameraOrientation(t.orientation)),t.position){const r=[t.position.x,t.position.y,t.position.z];e.a6.vec3.exactEquals(r,this._camera.position)||(this._setCameraPosition(r),n=!0)}n&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const t=this._camera.position,n=new Hn;return n.position=new e.a5(t[0],t[1],t[2]),n.orientation=this._camera.orientation,n._elevation=this.elevation,n._renderWorldCopies=this.renderWorldCopies,n}_setCameraOrientation(t){if(!e.a6.quat.length(t))return!1;e.a6.quat.normalize(t,t);const n=e.a6.vec3.transformQuat([],[0,0,-1],t),r=e.a6.vec3.transformQuat([],[0,-1,0],t);if(r[2]<0)return!1;const i=Gn(n,r);return!!i&&(this._camera.orientation=i,!0)}_setCameraPosition(t){const n=this.zoomScale(this.minZoom)*this.tileSize,r=this.zoomScale(this.maxZoom)*this.tileSize,i=this.cameraToCenterDistance;t[2]=e.ap(t[2],i/r,i/n),this._camera.position=t}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,t,n){this._unmodified=!1,this._edgeInsets.interpolate(e,t,n),this._constrain(),this._calcMatrices()}coveringZoomLevel(e){const t=(e.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/e.tileSize));return Math.max(0,t)}getVisibleUnwrappedCoordinates(t){const n=[new e.bN(0,t)];if(this.renderWorldCopies){const r=this.pointCoordinate(new e.P(0,0)),i=this.pointCoordinate(new e.P(this.width,0)),o=this.pointCoordinate(new e.P(this.width,this.height)),a=this.pointCoordinate(new e.P(0,this.height)),s=Math.floor(Math.min(r.x,i.x,o.x,a.x)),l=Math.floor(Math.max(r.x,i.x,o.x,a.x)),c=1;for(let u=s-c;u<=l+c;u++)0!==u&&n.push(new e.bN(u,t))}return n}isLODDisabled(e){return(!e||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCover(t,n,r){let i=[];const o=void 0!==r,a=!o;if(a&&this.zoom<n)return i;if(o&&0===r[0]&&0===r[1])return i;const s=new Set,l=(t,n,r,o,a)=>{const l=e.c2(n,t,r,o,a);s.has(l)||(i.push(new e.aA(t,n,r,o,a)),s.add(l))};for(let e=0;e<t.length;e++){const i=t[e];if(a&&i.canonical.z!==n)continue;const s=i.canonical,c=i.overscaledZ,u=i.wrap,h=1<<s.z,d=s.x+1<h,p=s.x>0,f=s.y+1<h,m=s.y>0,g=i.wrap-(p?0:1),y=i.wrap+(d?0:1),_=p?s.x-1:h-1,v=d?s.x+1:0;if(o)r[0]<0?(l(c,y,s.z,v,s.y),r[1]<0&&f&&(l(c,u,s.z,s.x,s.y+1),l(c,y,s.z,v,s.y+1)),r[1]>0&&m&&(l(c,u,s.z,s.x,s.y-1),l(c,y,s.z,v,s.y-1))):r[0]>0?(l(c,g,s.z,_,s.y),r[1]<0&&f&&(l(c,u,s.z,s.x,s.y+1),l(c,g,s.z,_,s.y+1)),r[1]>0&&m&&(l(c,u,s.z,s.x,s.y-1),l(c,g,s.z,_,s.y-1))):r[1]<0&&f?l(c,u,s.z,s.x,s.y+1):m&&l(c,u,s.z,s.x,s.y-1);else{const e=i.visibleQuadrants;1&e&&(l(c,g,s.z,_,s.y),m&&(l(c,u,s.z,s.x,s.y-1),l(c,g,s.z,_,s.y-1))),2&e&&(l(c,y,s.z,v,s.y),m&&(l(c,u,s.z,s.x,s.y-1),l(c,y,s.z,v,s.y-1))),4&e&&(l(c,g,s.z,_,s.y),f&&(l(c,u,s.z,s.x,s.y+1),l(c,g,s.z,_,s.y+1))),8&e&&(l(c,y,s.z,v,s.y),f&&(l(c,u,s.z,s.x,s.y+1),l(c,y,s.z,v,s.y+1)))}}const c=[];for(const e of i)i.some((t=>e.isChildOf(t)))||c.push(e);if(i=c.filter((e=>!t.some((t=>!!(e.overscaledZ<n&&t.isChildOf(e))||e.equals(t)||e.isChildOf(t))))),a){const e=1<<n,t="globe"===this.projection.name?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),r=[e*t.x,e*t.y],o=4,a=o*o;i=i.filter((e=>{const t=e.canonical.x+.5-r[0],n=e.canonical.y+.5-r[1];return t*t+n*n<a}))}return i}coveringTiles(t){let n=this.coveringZoomLevel(t);const r=n,i=this.elevation&&this.elevation.exaggeration(),o=i&&!t.isTerrainDEM,a="mercator"===this.projection.name;if(void 0!==t.minzoom&&n<t.minzoom)return[];void 0!==t.maxzoom&&n>t.maxzoom&&(n=t.maxzoom);const s=this.locationCoordinate(this.center),l=this.center.lat,c=1<<n,u=[c*s.x,c*s.y,0],h="globe"===this.projection.name,d=!h,p=e.bO.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,n,d),f=h?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),m=c*e.bE(1,this.center.lat),g=this._camera.position[2]/e.bE(1,this.center.lat),y=[c*f.x,c*f.y,g*(d?1:m)],_=h||i,v=this.cameraToCenterDistance/t.tileSize*(t.roundZoom?1:.502),x=this.isLODDisabled(!0)?n:0;let b;if(this._elevation&&t.isTerrainDEM)b=1e4*this._elevation.exaggeration();else if(this._elevation){const e=this._elevation.getMinMaxForVisibleTiles();b=e?e.max:this._centerAltitude}else b=this._centerAltitude;const w=t.isTerrainDEM?-b:this._elevation?this._elevation.getMinElevationBelowMSL():0,S=this.projection.isReprojectedInTileSpace?e.bP(this):1,T=t=>{const n=1/4e4,r=new e.a5(t.x+n,t.y,t.z),i=new e.a5(t.x,t.y+n,t.z),o=t.toLngLat(),a=r.toLngLat(),s=i.toLngLat(),l=this.locationCoordinate(o),c=this.locationCoordinate(a),u=this.locationCoordinate(s),h=Math.hypot(c.x-l.x,c.y-l.y),d=Math.hypot(u.x-l.x,u.y-l.y);return Math.sqrt(h*d)*S/n},E=t=>{const n=b,r=w;return{aabb:e.bS(this,c,0,0,0,t,r,n,this.projection),zoom:0,x:0,y:0,minZ:r,maxZ:n,wrap:t,fullyVisible:!1}},A=[];let M=[];const P=n,k=t.reparseOverscaled?r:n,C=(g-this._centerAltitude)*m,j=e=>{if(!this._elevation||!e.tileID||!a)return;const t=this._elevation.getMinMaxForTile(e.tileID),n=e.aabb;t?(n.min[2]=t.min,n.max[2]=t.max,n.center[2]=(n.min[2]+n.max[2])/2):(e.shouldSplit=O(e),e.shouldSplit||(n.min[2]=n.max[2]=n.center[2]=this._centerAltitude))},I=(e,t)=>{if(.707*t<e)return 1;const n=t/e;return n/(1.4144271570014144+(Math.pow(1.1,n-1.4144271570014144+1)-1)/(1.1-1)-1)},O=t=>{if(t.zoom<x)return!0;if(t.zoom===P)return!1;if(null!=t.shouldSplit)return t.shouldSplit;const n=t.aabb.distanceX(y),i=t.aabb.distanceY(y);let s=C,c=1;if(h){s=t.aabb.distanceZ(y);const n=Math.pow(2,t.zoom),r=e.aN((t.y+1)/n),i=e.aN(t.y/n),o=Math.min(Math.max(l,r),i),a=e.c6(o)/e.c6(l);if(c=o===l?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,a/this._mercatorScaleRatio),this.zoom<=e.c3&&t.zoom===P-1&&a>=.9)return!0}else if(o&&(s=t.aabb.distanceZ(y)*m),this.projection.isReprojectedInTileSpace&&r<=5){const n=Math.pow(2,t.zoom),r=T(new e.a5((t.x+.5)/n,(t.y+.5)/n));c=r>.85?1:r}if(!a){const e=Math.sqrt(n*n+i*i+s*s);let r=(1<<P-t.zoom)*v*c;return r*=I(Math.max(s,C),e),e<r}let d=Number.MAX_VALUE,p=0;const f=t.aabb.getCorners(),g=[];for(const r of f){e.a6.vec3.sub(g,r,y),h||(o?g[2]*=m:g[2]=C);const t=e.a6.vec3.dot(g,this._camera.forward());t<d&&(d=t,p=Math.abs(g[2]))}let _=(1<<P-t.zoom)*v*c;if(_*=I(Math.max(p,C),d),d<_)return!0;const b=t.aabb.closestPoint(u);return b[0]===u[0]&&b[1]===u[1]};if(this.renderWorldCopies)for(let e=1;e<=3;e++)A.push(E(-e)),A.push(E(e));for(A.push(E(0));A.length>0;){const r=A.pop(),i=r.x,s=r.y;let l=r.fullyVisible;const d=()=>"globe"===this.projection.name&&(0===r.y||r.y===(1<<r.zoom)-1);if(!l){let t=_?r.aabb.intersects(p):r.aabb.intersectsFlat(p);if(0===t&&d()){const n=new e.bQ(r.zoom,i,s);t=e.bR(this,c,n,!0).intersects(p)}if(0===t)continue;l=2===t}if(r.zoom!==P&&O(r))for(let t=0;t<4;t++){const n=(i<<1)+t%2,u=(s<<1)+(t>>1),d={aabb:a?r.aabb.quadrant(t):e.bS(this,c,r.zoom+1,n,u,r.wrap,r.minZ,r.maxZ,this.projection),zoom:r.zoom+1,x:n,y:u,wrap:r.wrap,fullyVisible:l,tileID:void 0,shouldSplit:void 0,minZ:r.minZ,maxZ:r.maxZ};o&&!h&&(d.tileID=new e.aA(r.zoom+1===P?k:r.zoom+1,r.wrap,r.zoom+1,n,u),j(d)),A.push(d)}else{const o=r.zoom===P?k:r.zoom;if(t.minzoom&&t.minzoom>o)continue;let a=0;if(!l){let n=_?r.aabb.intersectsPrecise(p):r.aabb.intersectsPreciseFlat(p);if(0===n&&d()){const t=new e.bQ(r.zoom,i,s);n=e.bR(this,c,t,!0).intersectsPrecise(p)}if(0===n)continue;if(t.calculateQuadrantVisibility)if(p.containsPoint(r.aabb.center))a=15;else for(let e=0;e<4;e++)0!==r.aabb.quadrant(e).intersects(p)&&(a|=1<<e)}const h=u[0]-(.5+i+(r.wrap<<r.zoom))*(1<<n-r.zoom),f=u[1]-.5-s,m=r.tileID?r.tileID:new e.aA(o,r.wrap,r.zoom,i,s);t.calculateQuadrantVisibility&&(m.visibleQuadrants=a),M.push({tileID:m,distanceSq:h*h+f*f})}}if(this.fogCullDistSq){const n=this.fogCullDistSq,r=this.horizonLineFromTop();M=M.filter((i=>{const o=[0,0,0,1],a=[e.ab,e.ab,0,1],s=this.calculateFogTileMatrix(i.tileID.toUnwrapped());e.a6.vec4.transformMat4(o,o,s),e.a6.vec4.transformMat4(a,a,s);const l=e.a6.vec4.min([],o,a),c=e.a6.vec4.max([],o,a),u=e.bT(l,c);if(0===u)return!0;let h=!1;const d=this._elevation;if(d&&u>n&&0!==r){const n=this.calculateProjMatrix(i.tileID.toUnwrapped());let o;t.isTerrainDEM||(o=d.getMinMaxForTile(i.tileID)),o||(o={min:w,max:b});const a=e.c4(this.rotation),s=[a[0]*e.ab,a[1]*e.ab,o.max];e.a6.vec3.transformMat4(s,s,n),h=(1-s[1])*this.height*.5<r}return u<n||h}))}return M.sort(((e,t)=>e.distanceSq-t.distanceSq)).map((e=>e.tileID))}resize(e,t){this.width=e,this.height=t,this.pixelsToGLUnits=[2/e,-2/t],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(e){return Math.pow(2,e)}scaleZoom(e){return Math.log(e)/Math.LN2}project(t){const n=e.ap(t.lat,-e.bU,e.bU),r=this.projection.project(t.lng,n);return new e.P(r.x*this.worldSize,r.y*this.worldSize)}unproject(e){return this.projection.unproject(e.x/this.worldSize,e.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/e.bE(1,this.center.lat)/this.worldSize}setLocationAtPoint(t,n){let r,i;const o=this.centerPoint;if("globe"===this.projection.name){const e=this.worldSize;r=(n.x-o.x)/e,i=(n.y-o.y)/e}else{const e=this.pointCoordinate(n),t=this.pointCoordinate(o);r=e.x-t.x,i=e.y-t.y}const a=this.locationCoordinate(t);this.setLocation(new e.a5(a.x-r,a.y-i))}setLocation(e){this.center=this.coordinateLocation(e),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(e){return this.projection.locationPoint(this,e)}locationPoint3D(e){return this.projection.locationPoint(this,e,!0)}pointLocation(e){return this.coordinateLocation(this.pointCoordinate(e))}pointLocation3D(e){return this.coordinateLocation(this.pointCoordinate3D(e))}locationCoordinate(t,n){const r=n?e.bE(n,t.lat):void 0,i=this.projection.project(t.lng,t.lat);return new e.a5(i.x,i.y,r)}coordinateLocation(e){return this.projection.unproject(e.x,e.y)}pointRayIntersection(t,n){const r=null!=n?n:this._centerAltitude,i=[t.x,t.y,0,1],o=[t.x,t.y,1,1];e.a6.vec4.transformMat4(i,i,this.pixelMatrixInverse),e.a6.vec4.transformMat4(o,o,this.pixelMatrixInverse);const a=o[3];e.a6.vec4.scale(i,i,1/i[3]),e.a6.vec4.scale(o,o,1/a);const s=i[2],l=o[2];return{p0:i,p1:o,t:s===l?0:(r-s)/(l-s)}}screenPointToMercatorRay(t){const n=[t.x,t.y,0,1],r=[t.x,t.y,1,1];return e.a6.vec4.transformMat4(n,n,this.pixelMatrixInverse),e.a6.vec4.transformMat4(r,r,this.pixelMatrixInverse),e.a6.vec4.scale(n,n,1/n[3]),e.a6.vec4.scale(r,r,1/r[3]),n[2]=e.bE(n[2],this._center.lat)*this.worldSize,r[2]=e.bE(r[2],this._center.lat)*this.worldSize,e.a6.vec4.scale(n,n,1/this.worldSize),e.a6.vec4.scale(r,r,1/this.worldSize),new e.aj([n[0],n[1],n[2]],e.a6.vec3.normalize([],e.a6.vec3.sub([],r,n)))}rayIntersectionCoordinate(t){const{p0:n,p1:r,t:i}=t,o=e.bE(n[2],this._center.lat),a=e.bE(r[2],this._center.lat);return new e.a5(e.aa(n[0],r[0],i)/this.worldSize,e.aa(n[1],r[1],i)/this.worldSize,e.aa(o,a,i))}pointCoordinate(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._centerAltitude;return this.projection.pointCoordinate(this,e.x,e.y,t)}pointCoordinate3D(t){if(!this.elevation)return this.pointCoordinate(t);let n=this.projection.pointCoordinate3D(this,t.x,t.y);if(n)return new e.a5(n[0],n[1],n[2]);let r=0,i=this.horizonLineFromTop();if(t.y>i)return this.pointCoordinate(t);const o=.02*i,a=t.clone();for(let s=0;s<10&&i-r>o;s++){a.y=e.aa(r,i,.66);const t=this.projection.pointCoordinate3D(this,a.x,a.y);t?(i=a.y,n=t):r=a.y}return n?new e.a5(n[0],n[1],n[2]):this.pointCoordinate(t)}isPointAboveHorizon(e){return this.projection.isPointAboveHorizon(this,e)}isPointOnSurface(t){if(t.y<0||t.y>this.height||t.x<0||t.x>this.width)return!1;if(this.elevation||this.zoom>=e.bV)return!this.isPointAboveHorizon(t);const n=this.pointCoordinate(t);return n.y>=0&&n.y<=1}_coordinatePoint(t,n){const r=n&&this.elevation?this.elevation.getAtPointOrZero(t,this._centerAltitude):this._centerAltitude,i=[t.x*this.worldSize,t.y*this.worldSize,r+t.toAltitude(),1];return e.a6.vec4.transformMat4(i,i,this.pixelMatrix),i[3]>0?new e.P(i[0]/i[3],i[1]/i[3]):new e.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:t,left:n}=this._edgeInsets,r=this.height-this._edgeInsets.bottom,i=this.width-this._edgeInsets.right,o=this.pointLocation3D(new e.P(n,t)),a=this.pointLocation3D(new e.P(i,t)),s=this.pointLocation3D(new e.P(i,r)),l=this.pointLocation3D(new e.P(n,r));let c=Math.min(o.lng,a.lng,s.lng,l.lng),u=Math.max(o.lng,a.lng,s.lng,l.lng),h=Math.min(o.lat,a.lat,s.lat,l.lat),d=Math.max(o.lat,a.lat,s.lat,l.lat);const p=Math.pow(2,-this.zoom)/16*270,f="globe"===this.projection.name?1:4,m=(t,n,r,i,o)=>{const a=(t+r)/2,s=(n+i)/2,l=new e.P(a,s),{lng:g,lat:y}=this.pointLocation3D(l),_=Math.max(0,c-g,h-y,g-u,y-d);c=Math.min(c,g),u=Math.max(u,g),h=Math.min(h,y),d=Math.max(d,y),(o<f||_>p)&&(m(t,n,a,s,o+1),m(a,s,r,i,o+1))};if(m(n,t,i,t,1),m(i,t,i,r,1),m(i,r,n,r,1),m(n,r,n,t,1),"globe"===this.projection.name){const[t,n]=e.bW(this);t?(d=90,u=180,c=-180):n&&(h=-90,u=180,c=-180)}return new e.as(new e.bL(c,h),new e.bL(u,d))}_getBoundsRectangular(t,n){const{top:r,left:i}=this._edgeInsets,o=this.height-this._edgeInsets.bottom,a=this.width-this._edgeInsets.right,s=new e.P(i,r),l=new e.P(a,r),c=new e.P(a,o),u=new e.P(i,o);let h=this.pointCoordinate(s,t),d=this.pointCoordinate(l,t);const p=this.pointCoordinate(c,n),f=this.pointCoordinate(u,n),m=(e,t)=>(t.y-e.y)/(t.x-e.x);return h.y>1&&d.y>=0?h=new e.a5((1-f.y)/m(f,h)+f.x,1):h.y<0&&d.y<=1&&(h=new e.a5(-f.y/m(f,h)+f.x,0)),d.y>1&&h.y>=0?d=new e.a5((1-p.y)/m(p,d)+p.x,1):d.y<0&&h.y<=1&&(d=new e.a5(-p.y/m(p,d)+p.x,0)),(new e.as).extend(this.coordinateLocation(h)).extend(this.coordinateLocation(d)).extend(this.coordinateLocation(f)).extend(this.coordinateLocation(p))}_getBoundsRectangularTerrain(){const e=this.elevation;if(!e.visibleDemTiles.length||e.isUsingMockSource())return this._getBoundsRectangular(0,0);const t=e.visibleDemTiles.reduce(((e,t)=>{if(t.dem){const n=t.dem.tree;e.min=Math.min(e.min,n.minimums[0]),e.max=Math.max(e.max,n.maximums[0])}return e}),{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(t.min*e.exaggeration(),t.max*e.exaggeration())}getBounds(){return"mercator"===this.projection.name||"equirectangular"===this.projection.name?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const t=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,n=this.height/2-t*(1-this._horizonShift);return e?Math.max(0,n):n}getMaxBounds(){return this.maxBounds}setMaxBounds(t){this.maxBounds=t,this.minLat=-e.bU,this.maxLat=e.bU,this.minLng=-180,this.maxLng=180,t&&(this.minLat=t.getSouth(),this.maxLat=t.getNorth(),this.minLng=t.getWest(),this.maxLng=t.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=e.am(this.minLng)*this.tileSize,this.worldMaxX=e.am(this.maxLng)*this.tileSize,this.worldMinY=e.at(this.maxLat)*this.tileSize,this.worldMaxY=e.at(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(e,t){return this.projection.createTileMatrix(this,t,e)}calculateDistanceTileData(t){const n=t.key,r=this._distanceTileDataCache;if(r[n])return r[n];const i=t.canonical,o=1/this.height,a=this.cameraWorldSize,s=a/this.zoomScale(i.z),l=(i.x+Math.pow(2,i.z)*t.wrap)*s,c=i.y*s,u=this.point;u.x*=a/this.worldSize,u.y*=a/this.worldSize;const h=this.angle,d=Math.sin(-h),p=-Math.cos(-h);return r[n]={bearing:[d,p],center:[(u.x-l)*o,(u.y-c)*o],scale:s/e.ab*o},r[n]}calculateFogTileMatrix(t){const n=t.key,r=this._fogTileMatrixCache;if(r[n])return r[n];const i=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,t);return e.a6.mat4.multiply(i,this.worldToFogMatrix,i),r[n]=new Float32Array(i),r[n]}calculateProjMatrix(t){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=t.key;let o;if(o=r?this._expandedProjMatrixCache:n?this._alignedProjMatrixCache:this._projMatrixCache,o[i])return o[i];const a=this.calculatePosMatrix(t,this.worldSize);let s;return s=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:r?this.expandedFarZProjMatrix:n?this.alignedProjMatrix:this.projMatrix,e.a6.mat4.multiply(a,s,a),o[i]=new Float32Array(a),o[i]}calculatePixelsToTileUnitsMatrix(t){const n=t.tileID.key,r=this._pixelsToTileUnitsCache;if(r[n])return r[n];const i=e.bX(t,this);return r[n]=i,r[n]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if("globe"===this.projection.name){const t=1/this.worldSize,n=e.a6.mat4.fromScaling([],[t,t,t]);return e.a6.mat4.multiply(n,n,this.globeMatrix),n}}recenterOnTerrain(){if(!this._elevation||"globe"===this.projection.name)return;const t=this._elevation;this._updateCameraState();const n=e.bE(1,this._center.lat)*this.worldSize,r=this._computeCameraPosition(n),i=this._camera.forward(),o=e.bE(1,this._center.lat);r[2]/=o,i[2]/=o,e.a6.vec3.normalize(i,i);const a=t.raycast(r,i,t.exaggeration());if(a){const t=e.a6.vec3.scaleAndAdd([],r,i,a),n=new e.a5(t[0],t[1],e.bE(t[2],e.aN(t[1]))),s=(n.z+e.a6.vec3.length([n.x-r[0],n.y-r[1],n.z-r[2]*o]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(s),this._centerAltitude=n.toAltitude(),this._center=this.coordinateLocation(n),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this._elevation)return;const n=this._elevation,r=e.bE(1,this._center.lat)*this.worldSize,i=this._computeCameraPosition(r),o=n.getAtPointOrZero(new e.a5(...i)),a=this.pixelsPerMeter/this.worldSize*o,s=this._minimumHeightOverTerrain(),l=i[2]-a;if(l<=s)if(l<0||t){const t=this.locationCoordinate(this._center,this._centerAltitude),n=[i[0],i[1],t.z-i[2]],r=e.a6.vec3.length(n);n[2]-=(s-l)/this._pixelsPerMercatorPixel;const o=e.a6.vec3.length(n);if(0===o)return;e.a6.vec3.scale(n,n,r/o*this._pixelsPerMercatorPixel),this._camera.position=[i[0],i[1],t.z*this._pixelsPerMercatorPixel-n[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const t="globe"===this.projection.name||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||t){const n=this.center;return n.lat=e.ap(n.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!t)&&(n.lng=e.ap(n.lng,this.minLng,this.maxLng)),this.center=n,void(this._constraining=!1)}const n=this._unmodified,{x:r,y:i}=this.point;let o=0,a=r,s=i;const l=this.width/2,c=this.height/2,u=this.worldMinY*this.scale,h=this.worldMaxY*this.scale;if(i-c<u&&(s=u+c),i+c>h&&(s=h-c),h-u<this.height&&(o=Math.max(o,this.height/(h-u)),s=(h+u)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const e=this.worldMinX*this.scale,t=this.worldMaxX*this.scale,n=this.worldSize/2-(e+t)/2;a=(r+n+this.worldSize)%this.worldSize-n,a-l<e&&(a=e+l),a+l>t&&(a=t-l),t-e<this.width&&(o=Math.max(o,this.width/(t-e)),a=(t+e)/2)}a===r&&s===i||(this.center=this.unproject(new e.P(a,s))),o&&(this.zoom+=this.scaleZoom(o)),this._constrainCamera(),this._unmodified=n,this._constraining=!1}_minZoomForBounds(){let e=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(e=Math.max(e,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),e}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const t=this.centerOffset,n="globe"===this.projection.name,r=this.pixelsPerMeter;"globe"===this.projection.name&&(this._mercatorScaleRatio=e.bE(1,this.center.lat)/e.bE(1,e.c5));const i=e.bY(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,i),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const o="meters"===this.projection.zAxisUnit?r:1,a=this._camera.getWorldToCamera(this.worldSize,o);let s;const l=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(l[8]=2*-t.x/this.width,l[9]=2*t.y/this.height,this.isOrthographic){let e=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),n=e*this.aspect,r=-n,i=-e;n-=t.x,r-=t.x,e+=t.y,i+=t.y,s=this._camera.getCameraToClipOrthographic(r,n,i,e,this._nearZ,this._farZ),((e,t,n,r)=>{for(let i=0;i<16;i++)e[i]=Xn(t[i],n[i],r)})(s,s,l,Yn(this.pitch>=15?1:this.pitch/15))}else s=l;const c=e.a6.mat4.mul([],l,a);let u=e.a6.mat4.mul([],s,a);if(this.projection.isReprojectedInTileSpace){const t=this.locationCoordinate(this.center),n=e.a6.mat4.identity([]);e.a6.mat4.translate(n,n,[t.x*this.worldSize,t.y*this.worldSize,0]),e.a6.mat4.multiply(n,n,e.bZ(this)),e.a6.mat4.translate(n,n,[-t.x*this.worldSize,-t.y*this.worldSize,0]),e.a6.mat4.multiply(u,u,n),e.a6.mat4.multiply(c,c,n),this.inverseAdjustmentMatrix=e.b_(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=e.a6.mat4.scale([],u,[this.worldSize,this.worldSize,this.worldSize/o,1]),this.projMatrix=u,this.invProjMatrix=e.a6.mat4.invert(new Float64Array(16),this.projMatrix),n){const n=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);n[8]=2*-t.x/this.width,n[9]=2*t.y/this.height,this.expandedFarZProjMatrix=e.a6.mat4.mul([],n,a)}else this.expandedFarZProjMatrix=this.projMatrix;const h=e.a6.mat4.invert([],s);this.frustumCorners=e.b$.fromInvProjectionMatrix(h,this.horizonLineFromTop(),this.height),this.cameraFrustum=e.bO.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!n);const d=new Float32Array(16);e.a6.mat4.identity(d),e.a6.mat4.scale(d,d,[1,-1,1]),e.a6.mat4.rotateX(d,d,this._pitch),e.a6.mat4.rotateZ(d,d,this.angle);const p=e.a6.mat4.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=e.a6.mat4.clone(p);const f=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;p[8]=2*-t.x/this.width,p[9]=2*(t.y+f)/this.height,this.skyboxMatrix=e.a6.mat4.multiply(d,p,d);const m=this.point,g=m.x,y=m.y,_=this.width%2/2,v=this.height%2/2,x=Math.cos(this.angle),b=Math.sin(this.angle),w=g-Math.round(g)+x*_+b*v,S=y-Math.round(y)+x*v+b*_,T=new Float64Array(u);if(e.a6.mat4.translate(T,T,[w>.5?w-1:w,S>.5?S-1:S,0]),this.alignedProjMatrix=T,u=e.a6.mat4.create(),e.a6.mat4.scale(u,u,[this.width/2,-this.height/2,1]),e.a6.mat4.translate(u,u,[1,-1,0]),this.labelPlaneMatrix=u,u=e.a6.mat4.create(),e.a6.mat4.scale(u,u,[1,-1,1]),e.a6.mat4.translate(u,u,[-1,-1,0]),e.a6.mat4.scale(u,u,[2/this.width,2/this.height,1]),this.glCoordMatrix=u,this.pixelMatrix=e.a6.mat4.multiply(new Float64Array(16),this.labelPlaneMatrix,c),this._calcFogMatrices(),this._distanceTileDataCache={},u=e.a6.mat4.invert(new Float64Array(16),this.pixelMatrix),!u)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=u,"globe"===this.projection.name||this.mercatorFromTransition){this.globeMatrix=e.c0(this);const t=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=e.a6.vec3.transformMat4(t,t,a),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=u;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const t=this.cameraWorldSizeForFog,n=this.cameraPixelsPerMeter,r=this._camera.position,i=1/this.height/this._pixelsPerMercatorPixel,o=[t,t,n];e.a6.vec3.scale(o,o,i),e.a6.vec3.scale(r,r,-1),e.a6.vec3.multiply(r,r,o);const a=e.a6.mat4.create();e.a6.mat4.translate(a,a,r),e.a6.mat4.scale(a,a,o),this.mercatorFogMatrix=a,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(t,n,i)}_computeCameraPosition(e){const t=(e=e||this.pixelsPerMeter)/this.pixelsPerMeter,n=this._camera.forward(),r=this.point,i=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*t-e/this.worldSize*this._centerAltitude;return[r.x/this.worldSize-n[0]*i,r.y/this.worldSize-n[1]*i,e/this.worldSize*this._centerAltitude-n[2]*i]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(t){const n=this._maxCameraBoundsDistance()*Math.cos(this._pitch),r=this._camera.position[2],i=t[2];let o=1;this.projection.wrap&&(this.center=this.center.wrap()),i>0&&(o=Math.min((n-r)/i,1)),this._camera.position=e.a6.vec3.scaleAndAdd([],this._camera.position,t,o),this._updateStateFromCamera()}_updateStateFromCamera(){const t=this._camera.position,n=this._camera.forward(),{pitch:r,bearing:i}=this._camera.getPitchBearing(),o=e.bE(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,a=this._mercatorZfromZoom(this._maxZoom)*Math.cos(e.bC(this._maxPitch)),s=Math.max((t[2]-o)/Math.cos(r),a),l=this._zoomFromMercatorZ(s);e.a6.vec3.scaleAndAdd(t,t,n,s),this._pitch=e.ap(r,e.bC(this.minPitch),e.bC(this.maxPitch)),this.angle=e.bB(i,-Math.PI,Math.PI),this._setZoom(e.ap(l,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new e.a5(t[0],t[1],t[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(e){return Math.pow(2,e)*this.tileSize}_mercatorZfromZoom(e){return this.cameraToCenterDistance/this._worldSizeFromZoom(e)}_minimumHeightOverTerrain(){const e=Math.min(null!=this._seaLevelZoom?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(e)}_zoomFromMercatorZ(e){return this.scaleZoom(this.cameraToCenterDistance/(e*this.tileSize))}zoomFromMercatorZAdjusted(t){let n=0,r=e.bV,i=0,o=1/0;for(;r-n>1e-6&&r>n;){const e=n+.5*(r-n),a=this.tileSize*Math.pow(2,e),s=this.getCameraToCenterDistance(this.projection,e,a),l=this.scaleZoom(s/(t*this.tileSize)),c=Math.abs(e-l);c<o&&(o=c,i=e),e<l?n=e:r=e}return i}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(e.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(t,n){const r=Math.min(t.x,n.x),i=Math.max(t.x,n.x),o=Math.min(t.y,n.y),a=Math.max(t.y,n.y);if(o<this.horizonLineFromTop(!1))return!0;if("mercator"!==this.projection.name)return!1;const s=[new e.P(r,o),new e.P(i,a),new e.P(r,a),new e.P(i,o)],l=this.renderWorldCopies?-3:0,c=this.renderWorldCopies?4:1;for(const e of s){const t=this.pointRayIntersection(e);if(t.t<0)return!0;const n=this.rayIntersectionCoordinate(t);if(n.x<l||n.y<0||n.x>c||n.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+e.c1(this.fovAboveCenter)>88||this.anyCornerOffEdge(new e.P(0,0),new e.P(this.width,this.height))}zoomDeltaToMovement(t,n){const r=e.a6.vec3.length(e.a6.vec3.sub([],this._camera.position,t)),i=this._zoomFromMercatorZ(r)+n;return r-this._mercatorZfromZoom(i)}getCameraPoint(){if("globe"===this.projection.name){const t=function(t,n){let[r,i,o]=t;const a=[r,i,o,1];e.a6.vec4.transformMat4(a,a,n);const s=a[3]=Math.max(a[3],1e-6);return a[0]/=s,a[1]/=s,a[2]/=s,a}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new e.P(t[0],t[1])}{const t=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new e.P(0,t))}}getCameraToCenterDistance(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.zoom,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.worldSize;const i=e.bY(t,n,this.width,this.height,1024),o=t.pixelSpaceConversion(this.center.lat,r,i);let a=.5/Math.tan(.5*this._fov)*this.height*o;return this.isOrthographic&&(a=Xn(1,a,Yn(this.pitch>=15?1:this.pitch/15))),a}getWorldToCameraMatrix(){const t=this._camera.getWorldToCamera(this.worldSize,"meters"===this.projection.zAxisUnit?this.pixelsPerMeter:1);return"globe"===this.projection.name&&e.a6.mat4.multiply(t,t,this.globeMatrix),t}getFrustum(t){return e.bO.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,t,"meters"===this.projection.zAxisUnit)}}const Jn=(t,n)=>{if(n>0&&t.terrain&&e.w("Cutoff is currently disabled on terrain"),n<=0||t.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const r=t.transform,i=Math.max(Math.abs(r._zoom-(t.minCutoffZoom-1)),1),o=r.isLODDisabled(!1)?e.a7(60,45,r.pitch):e.a7(30,15,r.pitch),a=r._farZ-r._nearZ,s=n*r.height,l=((1-(c=o))*r.cameraToCenterDistance+c*(r._farZ+s))*i;var c;return{shouldRenderCutoff:o<1,uniformValues:{u_cutoff_params:[r._nearZ,r._farZ,(l-r._nearZ)/a,(l-s-r._nearZ)/a]}}},Qn={cascadeCount:2,normalOffset:3,shadowMapResolution:2048};class $n{constructor(e,t){this.aabb=e,this.lastCascade=t}}class er{add(e,t){const n=this.receivers[e.key];void 0!==n?(n.aabb.min[0]=Math.min(n.aabb.min[0],t.min[0]),n.aabb.min[1]=Math.min(n.aabb.min[1],t.min[1]),n.aabb.min[2]=Math.min(n.aabb.min[2],t.min[2]),n.aabb.max[0]=Math.max(n.aabb.max[0],t.max[0]),n.aabb.max[1]=Math.max(n.aabb.max[1],t.max[1]),n.aabb.max[2]=Math.max(n.aabb.max[2],t.max[2])):this.receivers[e.key]=new $n(t,null)}clear(){this.receivers={}}get(e){return this.receivers[e.key]}computeRequiredCascades(t,n,r){const i=e.ca.fromPoints(t.points);let o=0;for(const a in this.receivers){const t=this.receivers[a];if(!t)continue;if(!i.intersectsAabb(t.aabb))continue;t.aabb.min=i.closestPoint(t.aabb.min),t.aabb.max=i.closestPoint(t.aabb.max);const s=t.aabb.getCorners();for(let i=0;i<r.length;i++){let a=!0;for(const t of s){const o=[t[0]*n,t[1]*n,t[2]];if(e.a6.vec3.transformMat4(o,o,r[i].matrix),o[0]<-1||o[0]>1||o[1]<-1||o[1]>1){a=!1;break}}if(t.lastCascade=i,o=Math.max(o,i),a)break}}return o+1}}class tr{constructor(e){this.painter=e,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new er,this._depthMode=new Dn(e.context.gl.LEQUAL,Dn.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1,e.tp.registerParameter(this,["Shadows"],"_forceDisable",{label:"forceDisable"},(()=>{this.painter.style.map.triggerRepaint()})),e.tp.registerParameter(Qn,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),e.tp.registerParameter(Qn,["Shadows"],"normalOffset",{min:0,max:10,step:.05}),e.tp.registerParameter(Qn,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32}),e.tp.registerBinding(this,["Shadows"],"_numCascadesToRender",{readonly:!0,label:"numCascadesToRender"})}destroy(){for(const e of this._cascades)e.texture.destroy(),e.framebuffer.destroy();this._cascades=[]}updateShadowParameters(t,n){const r=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!n||!n.properties)return;const i=n.properties.get("shadow-intensity");if(!n.shadowsEnabled()||i<=0)return;if(this._shadowLayerCount=r.style.order.reduce(((e,n)=>{const i=r.style._mergedLayers[n];return e+(i.hasShadowPass()&&!i.isHidden(t.zoom)?1:0)}),0),this._enabled=this._shadowLayerCount>0,!this.enabled)return;const o=r.context,a=Qn.shadowMapResolution,s=Qn.shadowMapResolution;if(0===this._cascades.length||Qn.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let t=0;t<Qn.cascadeCount;++t){const t=r._shadowMapDebug,n=o.gl,i=o.createFramebuffer(a,s,t,"texture"),l=new e.T(o,{width:a,height:s,data:null},n.DEPTH_COMPONENT16);if(i.depthAttachment.set(l.texture),t){const t=new e.T(o,{width:a,height:s,data:null},n.RGBA8);i.colorAttachment.set(t.texture)}this._cascades.push({framebuffer:i,texture:l,matrix:[],far:0,boundingSphereRadius:0,frustum:new e.bO,scale:0})}}this.shadowDirection=rr(n);let l=0;if(t.elevation){const e=t.elevation,n=[1e4,-1e4];e.visibleDemTiles.filter((e=>e.dem)).forEach((e=>{const t=e.dem.tree;n[0]=Math.min(n[0],t.minimums[0]),n[1]=Math.max(n[1],t.maximums[0])})),1e4!==n[0]&&(l=(n[1]-n[0])*e.exaggeration())}const c=1.5*t.cameraToCenterDistance,u=3*c,h=new Float64Array(16);for(let f=0;f<this._cascades.length;++f){const n=this._cascades[f];let r=t.height/50,i=1;1===Qn.cascadeCount?i=u:0===f?i=c:(r=c,i=u);const[o,a]=or(t,this.shadowDirection,r,i,Qn.shadowMapResolution,l);n.scale=t.scale,n.matrix=o,n.boundingSphereRadius=a,e.a6.mat4.invert(h,n.matrix),n.frustum=e.bO.fromInvProjectionMatrix(h,1,0,!0),n.far=i}const d=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[d].far,this._cascades[d].far],this._uniformValues.u_shadow_intensity=i,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/Qn.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=Qn.shadowMapResolution,this._uniformValues.u_shadowmap_0=qn.ShadowMap0,this._uniformValues.u_shadowmap_1=qn.ShadowMap0+1,this._groundShadowTiles=r.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const p=r.transform.elevation;for(const e of this._groundShadowTiles){let t={min:0,max:0};if(p){const n=p.getMinMaxForTile(e);n&&(t=n)}this.addShadowReceiver(e.toUnwrapped(),t.min,t.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(e){this._enabled=e}drawShadowPass(t,n){if(!this.enabled)return;const r=this.painter,i=r.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(r.transform.getFrustum(0),r.transform.worldSize,this._cascades),i.viewport.set([0,0,Qn.shadowMapResolution,Qn.shadowMapResolution]);for(let o=0;o<this._numCascadesToRender;++o){r.currentShadowCascade=o,i.bindFramebuffer.set(this._cascades[o].framebuffer.framebuffer),i.clear({color:e.bA.white,depth:1});for(const e of t.order){const i=t._mergedLayers[e];if(!i.hasShadowPass()||i.isHidden(r.transform.zoom))continue;const o=t.getLayerSourceCache(i),a=o?n[o.id]:void 0;("model"===i.type||a&&a.length)&&r.renderLayer(r,o,i,a)}}r.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;const e=this.painter,t=e.style,n=e.context,r=t.directionalLight,i=t.ambientLight;if(!r||!i)return;const o=[],a=Jn(e,e.longestCutoffRange);a.shouldRenderCutoff&&o.push("RENDER_CUTOFF"),o.push("RENDER_SHADOWS","DEPTH_TEXTURE"),this.useNormalOffset&&o.push("NORMAL_OFFSET");const s=ir(t,r,i),l=new Dn(n.gl.LEQUAL,Dn.ReadOnly,e.depthRangeFor3D);for(const c of this._groundShadowTiles){const t=c.toUnwrapped(),r=e.isTileAffectedByFog(c),i=e.getOrCreateProgram("groundShadow",{defines:o,overrideFog:r});this.setupShadows(t,i),e.uploadCommonUniforms(n,i,t,null,a);const u={u_matrix:e.transform.calculateProjMatrix(t),u_ground_shadow_factor:s};i.draw(e,n.gl.TRIANGLES,l,zn.disabled,Nn.multiply,Bn.disabled,u,"ground_shadow",e.tileExtentBuffer,e.quadTriangleIndexBuffer,e.tileExtentSegments,{},e.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?Nn.unblended:Nn.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(t){const n=this.painter.transform,r=n.calculatePosMatrix(t,n.worldSize);return e.a6.mat4.multiply(r,this._cascades[this.painter.currentShadowCascade].matrix,r),Float32Array.from(r)}calculateShadowPassMatrixFromMatrix(t){return e.a6.mat4.multiply(t,this._cascades[this.painter.currentShadowCascade].matrix,t),Float32Array.from(t)}setupShadows(t,n,r){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(!this.enabled)return;const o=this.painter.transform,a=this.painter.context,s=a.gl,l=this._uniformValues,c=new Float64Array(16),u=o.calculatePosMatrix(t,o.worldSize);for(let h=0;h<this._cascades.length;h++)e.a6.mat4.multiply(c,this._cascades[h].matrix,u),l[0===h?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(c),a.activeTexture.set(s.TEXTURE0+qn.ShadowMap0+h),this._cascades[h].texture.bind(s.NEAREST,s.CLAMP_TO_EDGE);if(this.useNormalOffset=!!r,this.useNormalOffset){const n=e.c9(t.canonical),a=2/o.tileSize*e.ab/Qn.shadowMapResolution,s=a*this._cascades[0].boundingSphereRadius,c=a*this._cascades[this._cascades.length-1].boundingSphereRadius,u=("vector-tile"===r?1:3)/Math.pow(2,i-t.canonical.z-(1-o.zoom+Math.floor(o.zoom)));l.u_shadow_normal_offset=[n,s*u,c*u],l.u_shadow_bias=[6e-5,.0012,.012]}else l.u_shadow_bias=[36e-5,.0012,.012];n.setShadowUniformValues(a,l)}setupShadowsFromMatrix(t,n){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this.enabled)return;const i=this.painter.context,o=i.gl,a=this._uniformValues,s=new Float64Array(16);for(let l=0;l<Qn.cascadeCount;l++)e.a6.mat4.multiply(s,this._cascades[l].matrix,t),a[0===l?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(s),i.activeTexture.set(o.TEXTURE0+qn.ShadowMap0+l),this._cascades[l].texture.bind(o.NEAREST,o.CLAMP_TO_EDGE);if(this.useNormalOffset=r,r){const e=Qn.normalOffset;a.u_shadow_normal_offset=[1,e,e],a.u_shadow_bias=[6e-5,.0012,.012]}else a.u_shadow_bias=[36e-5,.0012,.012];n.setShadowUniformValues(i,a)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(t,n,r,i){if(i[2]>=0)return{};const o=function(t,n,r){const i=r/(1<<t.canonical.z);return new e.ca([t.canonical.x*i+t.wrap*r,t.canonical.y*i+t.wrap*r,0],[(t.canonical.x+1)*i+t.wrap*r,(t.canonical.y+1)*i+t.wrap*r,n])}(t,n,r).getCorners(),a=n/-i[2];i[0]<0?(e.a6.vec3.add(o[0],o[0],[i[0]*a,0,0]),e.a6.vec3.add(o[3],o[3],[i[0]*a,0,0])):i[0]>0&&(e.a6.vec3.add(o[1],o[1],[i[0]*a,0,0]),e.a6.vec3.add(o[2],o[2],[i[0]*a,0,0])),i[1]<0?(e.a6.vec3.add(o[0],o[0],[0,i[1]*a,0]),e.a6.vec3.add(o[1],o[1],[0,i[1]*a,0])):i[1]>0&&(e.a6.vec3.add(o[2],o[2],[0,i[1]*a,0]),e.a6.vec3.add(o[3],o[3],[0,i[1]*a,0]));const s={};return s.vertices=o,s.planes=[nr(o[1],o[0],o[4]),nr(o[2],o[1],o[5]),nr(o[3],o[2],o[6]),nr(o[0],o[3],o[7])],s}addShadowReceiver(t,n,r){this._receivers.add(t,e.ca.fromTileIdAndHeight(t,n,r))}getMaxCascadeForTile(e){const t=this._receivers.get(e);return t&&t.lastCascade?t.lastCascade:0}}function nr(t,n,r){const i=e.a6.vec3.sub([],r,n),o=e.a6.vec3.sub([],t,n),a=e.a6.vec3.cross([],i,o),s=e.a6.vec3.length(a);return 0===s?[0,0,1,0]:(e.a6.vec3.scale(a,a,1/s),[a[0],a[1],a[2],-e.a6.vec3.dot(a,n)])}function rr(t){const n=t.properties.get("direction"),r=e.c8(n.x,n.y,n.z);r[2]=e.ap(r[2],0,75);const i=e.cb([r[0],r[1],r[2]]);return e.a6.vec3.fromValues(i.x,i.y,i.z)}function ir(t,n,r){const i=n.properties.get("color"),o=n.properties.get("intensity"),a=n.properties.get("direction"),s=[a.x,a.y,a.z],l=r.properties.get("color"),c=r.properties.get("intensity"),u=Math.max(e.a6.vec3.dot([0,0,1],s),0),h=[0,0,0];e.a6.vec3.scale(h,l.toRenderColor(t.getLut(n.scope)).toArray01Linear().slice(0,3),c);const d=[0,0,0];return e.a6.vec3.scale(d,i.toRenderColor(t.getLut(r.scope)).toArray01Linear().slice(0,3),u*o),e.cc([h[0]>0?h[0]/(h[0]+d[0]):0,h[1]>0?h[1]/(h[1]+d[1]):0,h[2]>0?h[2]/(h[2]+d[2]):0])}function or(t,n,r,i,o,a){const s=t.zoom,l=t.scale,c=t.worldSize,u=1/c,h=t.aspect,d=Math.sqrt(1+h*h)*Math.tan(.5*t.fovX),p=d*d,f=i-r,m=i+r;let g,y;p>f/m?(g=i,y=i*d):(g=.5*m*(1+p),y=.5*Math.sqrt(f*f+2*(i*i+r*r)*p+m*m*p*p));const _=t.projection.pixelsPerMeter(t.center.lat,c),v=t._camera.getCameraToWorldMercator(),x=[0,0,-g*u];e.a6.vec3.transformMat4(x,x,v);let b=y*u;const w=t._edgeInsets;if(!(0===w.left&&0===w.top&&0===w.right&&0===w.bottom||w.left===w.right&&w.top===w.bottom)){const n=t._camera.getWorldToCamera(t.worldSize,"meters"===t.projection.zAxisUnit?_:1),o=t._camera.getCameraToClipPerspective(t._fov,t.width/t.height,r,i);o[8]=2*-t.centerOffset.x/t.width,o[9]=2*t.centerOffset.y/t.height;const a=new Float64Array(16);e.a6.mat4.mul(a,o,n);const u=new Float64Array(16);e.a6.mat4.invert(u,a);const h=e.bO.fromInvProjectionMatrix(u,c,s,!0);for(const r of h.points){const n=((S=r)[0]/=l,S[1]/=l,S[2]=e.bE(S[2],t._center.lat),S);b=Math.max(b,e.a6.vec3.len(e.a6.vec3.subtract([],x,n)))}}var S;b*=o/(o-1);const T=Math.acos(n[2]),E=Math.atan2(-n[0],-n[1]),A=new Zn;A.position=x,A.setPitchBearing(T,E);const M=A.getWorldToCamera(c,_),P=b*c,k=Math.min(t._mercatorZfromZoom(17)*c*-2,-2*P),C=A.getCameraToClipOrthographic(-P,P,-P,P,k,(P+a*_)/n[2]),j=new Float64Array(16);e.a6.mat4.multiply(j,C,M);const I=e.a6.vec3.fromValues(Math.floor(1e6*x[0])/1e6*c,Math.floor(1e6*x[1])/1e6*c,0),O=.5*o,N=[0,0,0];e.a6.vec3.transformMat4(N,I,j),e.a6.vec3.scale(N,N,O);const D=[Math.floor(N[0]),Math.floor(N[1]),Math.floor(N[2])],L=[0,0,0];e.a6.vec3.sub(L,N,D),e.a6.vec3.scale(L,L,-1/O);const z=new Float64Array(16);return e.a6.mat4.identity(z),e.a6.mat4.translate(z,z,L),e.a6.mat4.multiply(j,z,j),[j,P]}class ar extends e.E{constructor(e){super(),this.requestManager=e,this.models={"":{}},this.numModelsLoading={}}loadModel(t,n){return e.aG(this.requestManager.transformRequest(n,e.R.Model).url).then((n=>{if(!n)return;const r=e.aH(n),i=new e.aI(t,void 0,void 0,r);return i.computeBoundsAndApplyParent(),i})).catch((r=>{if(r&&404===r.status)return null;this.fire(new e.t(new Error("Could not load model ".concat(t," from ").concat(n,": ").concat(r.message))))}))}load(t,n){this.models[n]||(this.models[n]={});const r=Object.keys(t);this.numModelsLoading[n]=(this.numModelsLoading[n]||0)+r.length;const i=[];for(const e of r)i.push(this.loadModel(e,t[e]));Promise.allSettled(i).then((t=>{for(let e=0;e<t.length;e++){const{status:i,value:o}=t[e];"fulfilled"===i&&o&&(this.models[n][r[e]]={model:o,numReferences:1})}this.numModelsLoading[n]-=r.length,this.fire(new e.x("data",{dataType:"style"}))})).catch((t=>{this.fire(new e.t(new Error("Could not load models: ".concat(t.message))))}))}isLoaded(){for(const e in this.numModelsLoading)if(this.numModelsLoading[e]>0)return!1;return!0}hasModel(e,t){return!!this.getModel(e,t)}getModel(e,t){return this.models[t]||(this.models[t]={}),this.models[t][e]?this.models[t][e].model:void 0}addModel(e,t,n){this.models[n]||(this.models[n]={}),this.hasModel(e,n)&&this.models[n][e].numReferences++,this.load({[e]:this.requestManager.normalizeModelURL(t)},n)}addModels(e,t){this.models[t]||(this.models[t]={});const n={};for(const r in e)this.models[t][r]={},n[r]=this.requestManager.normalizeModelURL(e[r]);this.load(n,t)}addModelsFromBucket(e,t){this.models[t]||(this.models[t]={});const n={};for(const r of e)this.hasModel(r,t)?this.models[t][r].numReferences++:n[r]=this.requestManager.normalizeModelURL(r);this.load(n,t)}removeModel(e,t){if(this.models[t]&&this.models[t][e]&&(this.models[t][e].numReferences--,0===this.models[t][e].numReferences)){const n=this.models[t][e].model;delete this.models[t][e],n.destroy()}}listModels(e){return this.models[e]||(this.models[e]={}),Object.keys(this.models[e])}upload(e,t){this.models[t]||(this.models[t]={});for(const n in this.models[t])this.models[t][n].model&&this.models[t][n].model.upload(e.context)}}const sr=new e.a0({data:new e.a1(e._.colorTheme.data)}),lr=(e,t)=>Ie(e,t&&t.filter((e=>"source.canvas"!==e.identifier))),cr=e.ar(Pt,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection","setCamera","addImport","removeImport","updateImport"]),ur=e.ar(Pt,["setCenter","setZoom","setBearing","setPitch"]),hr={version:8,layers:[],sources:{}},dr={duration:300,delay:0};class pr extends e.E{constructor(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),this.map=t,this.scope=n.scope||"",this.globalId=null,this.fragments=[],this.importDepth=n.importDepth||0,this.importsCache=n.importsCache||new Map,this.resolvedImports=n.resolvedImports||new Set,this.transition=e.l({},dr),this._buildingIndex=new Et(this),this.crossTileSymbolIndex=new In,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._mergedLayerSelectors=new Map,this._clipLayerPresent=!1,this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=n.styleChanges||new q,this.dispatcher=n.dispatcher?n.dispatcher:new e.ce(e.cf(),this),n.imageManager?this.imageManager=n.imageManager:(this.imageManager=new X,this.imageManager.setEventedParent(this)),this.imageManager.createScope(this.scope),this.glyphManager=n.glyphManager?n.glyphManager:new e.cg(t._requestManager,n.localFontFamily?e.ch.all:n.localIdeographFontFamily?e.ch.ideographs:e.ch.none,n.localFontFamily||n.localIdeographFontFamily),n.modelManager?this.modelManager=n.modelManager:(this.modelManager=new ar(t._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._order=[],this._markersNeedUpdate=!1,this._styleColorTheme={lut:null,lutLoading:!1,lutLoadingCorrelationID:0,colorTheme:null},this._styleColorThemeForScope={},this.options=n.configOptions?n.configOptions:new Map,this._configDependentLayers=n.configDependentLayers?n.configDependentLayers:new Set,this._config=n.config,this._initialConfig=n.initialConfig,this.dispatcher.broadcast("setReferrer",e.ci());const r=this;this._rtlTextPluginCallback=pr.registerForPluginStateChange((t=>{r.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:t.pluginStatus,pluginURL:t.pluginURL},((t,n)=>{if(e.cj(t),n&&n.every((e=>e)))for(const e in r._sourceCaches){const t=r._sourceCaches[e],n=t.getSource().type;"vector"!==n&&"geojson"!==n||t.reload()}}))})),this.on("data",(e=>{if("source"!==e.dataType||"metadata"!==e.sourceDataType)return;const t=this.getOwnSource(e.sourceId);if(t&&t.vectorLayerIds)for(const n in this._layers){const e=this._layers[n];e.source===t.id&&this._validateLayer(e)}}))}load(e){return e?("string"==typeof e?this.loadURL(e):this.loadJSON(e),this):this}_getGlobalId(t){if(!t)return null;if("string"==typeof t){if(e.f(t))return t;const n=e.ck(t);if(!n.startsWith("http"))try{return new URL(n,location.href).toString()}catch(e){return n}return n}return"json://".concat(e.cl(JSON.stringify(t)))}_diffStyle(t,n,r){this.globalId=this._getGlobalId(t);const i=(e,t)=>{try{t(null,this.setState(e,r))}catch(e){t(e,!1)}};if("string"==typeof t){const r=this.map._requestManager.normalizeStyleURL(t),o=this.map._requestManager.transformRequest(r,e.R.Style);e.n(o,((t,r)=>{t?this.fire(new e.t(t)):r&&i(r,n)}))}else"object"==typeof t&&i(t,n)}loadURL(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.fire(new e.x("dataloading",{dataType:"style"}));const r="boolean"==typeof n.validate?n.validate:!e.f(t);this.globalId=this._getGlobalId(t),t=this.map._requestManager.normalizeStyleURL(t,n.accessToken),this.resolvedImports.add(t);const i=this.importsCache.get(t);if(i)return this._load(i,r);const o=this.map._requestManager.transformRequest(t,e.R.Style);this._request=e.n(o,((n,i)=>{if(this._request=null,n)this.fire(new e.t(n));else if(i)return this.importsCache.set(t,i),this._load(i,r)}))}loadJSON(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.fire(new e.x("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(t),this._request=e.q.frame((()=>{this._request=null,this._load(t,!1!==n.validate)}))}loadEmpty(){this.fire(new e.x("dataloading",{dataType:"style"})),this._load(hr,!1)}_loadImports(t,n,r){if(this.importDepth>=4)return e.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const i=[];for(const e of t){const t=this._createFragmentStyle(e),o=new Promise((e=>{t.once("style.import.load",e),t.once("error",e)})).then((()=>this.mergeAll()));if(i.push(o),this.resolvedImports.has(e.url)){t.loadEmpty();continue}const a=e.data||this.importsCache.get(e.url);a?(t.loadJSON(a,{validate:n}),this._isInternalStyle(a)&&(t.globalId=null)):e.url?t.loadURL(e.url,{validate:n}):t.loadEmpty();const s={style:t,id:e.id,config:e.config};if(r){const e=this.fragments.findIndex((e=>{let{id:t}=e;return t===r}));this.fragments=this.fragments.slice(0,e).concat(s).concat(this.fragments.slice(e))}else this.fragments.push(s)}return Promise.allSettled(i)}getImportGlobalIds(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Set;for(const n of e.fragments)n.style.globalId&&t.add(n.style.globalId),this.getImportGlobalIds(n.style,t);return[...t.values()]}_createFragmentStyle(t){const n=this.scope?e.av(t.id,this.scope):t.id;let r;const i=this._initialConfig&&this._initialConfig[n];(t.config||i)&&(r=e.l({},t.config,i));const o=new pr(this.map,{scope:n,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:r,configOptions:this.options,configDependentLayers:this._configDependentLayers});return o.setEventedParent(this.map,{style:o}),o}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.map._precompilePrograms&&this.isRootStyle()}_isInternalStyle(e){return this.isRootStyle()&&(e.fragment||!!e.schema&&!1!==e.fragment)}_load(t,n){const r=t.schema;if(this._isInternalStyle(t)){const r=e.l({},hr,{imports:[{id:"basemap",data:t,url:""}]});return void this._load(r,n)}if(this.updateConfig(this._config,r),n&&lr(this,xe(t)))return;this._loaded=!0,this.stylesheet=e.cm(t);const i=()=>{for(const e in t.sources)this.addSource(e,t.sources[e],{validate:!1,isInitialLoad:!0});t.sprite?this._loadSprite(t.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.glyphManager.setURL(t.glyphs,this.scope);const r=Mt(this.stylesheet.layers);if(this._order=r.map((e=>e.id)),this.stylesheet.light&&e.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(1===this.stylesheet.lights.length&&"flat"===this.stylesheet.lights[0].type){const e=this.stylesheet.lights[0];this.light=new Ne(e.properties,e.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new Ne(this.stylesheet.light)),this._layers={};for(const t of r){const n=e.cq(t,this.scope,this._styleColorTheme.lut,this.options);0!==n.configDependencies.size&&this._configDependentLayers.add(n.fqid),n.setEventedParent(this,{layer:{id:n.id}}),this._layers[n.id]=n;const r=this.getOwnLayerSourceCache(n),i=!!this.directionalLight&&this.directionalLight.shadowsEnabled();r&&n.canCastShadows()&&i&&(r.castsShadows=!0)}this.stylesheet.models&&this.modelManager.addModels(this.stylesheet.models,this.scope);const i=this.stylesheet.terrain;i&&(this.checkCanvasFingerprintNoise(),this.disableElevatedTerrain||this.terrainSetForDrapingOnly()||this._createTerrain(i,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new e.x("data",{dataType:"style"}));const o=this.isRootStyle();t.imports?this._loadImports(t.imports,n).then((()=>{this._reloadImports(),this.fire(new e.x(o?"style.load":"style.import.load"))})):(this._reloadImports(),this.fire(new e.x(o?"style.load":"style.import.load")))},o=this.stylesheet["color-theme"];if(this._styleColorTheme.colorTheme=o,o){const t=this._evaluateColorThemeData(o);this._loadColorTheme(t).then((()=>{i()})).catch((t=>{e.w("Couldn't load color theme from the stylesheet: ".concat(t)),i()}))}else this._styleColorTheme.lut=null,i()}isRootStyle(){return 0===this.importDepth}mergeAll(){let t,n,r,i,o,a,s,l;const c={};this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle((e=>{if(e.stylesheet){if(null!=e.light&&(t=e.light),e.stylesheet.lights)for(const t of e.stylesheet.lights)"ambient"===t.type&&null!=e.ambientLight&&(n=e.ambientLight),"directional"===t.type&&null!=e.directionalLight&&(r=e.directionalLight);i=this._prioritizeTerrain(i,e.terrain,e.stylesheet.terrain),e.stylesheet.fog&&null!=e.fog&&(o=e.fog),null!=e.stylesheet.camera&&(l=e.stylesheet.camera),null!=e.stylesheet.projection&&(a=e.stylesheet.projection),null!=e.stylesheet.transition&&(s=e.stylesheet.transition),c[e.scope]=e._styleColorTheme}})),this.light=t,this.ambientLight=n,this.directionalLight=r,this.fog=o,this._styleColorThemeForScope=c,null===i?delete this.terrain:this.terrain=i,this.camera=l||{"camera-projection":"perspective"},this.projection=a||{name:"mercator"},this.transition=e.l({},dr,s),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(e){const t=n=>{for(const e of n.fragments)t(e.style);e(n)};t(this)}_prioritizeTerrain(e,t,n){const r=e&&0===e.drapeRenderMode;return null===n?t&&0===t.drapeRenderMode?t:r?e:null:null!=t&&(!e||r||t&&1===t.drapeRenderMode)?t:e}mergeTerrain(){let e;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle((t=>{e=this._prioritizeTerrain(e,t.terrain,t.stylesheet.terrain)})),null===e?delete this.terrain:this.terrain=e}mergeProjection(){let e;this.forEachFragmentStyle((t=>{null!=t.stylesheet.projection&&(e=t.stylesheet.projection)})),this.projection=e||{name:"mercator"}}mergeSources(){const t={},n={},r={};this.forEachFragmentStyle((i=>{for(const n in i._sourceCaches){const r=e.av(n,i.scope);t[r]=i._sourceCaches[n]}for(const t in i._otherSourceCaches){const r=e.av(t,i.scope);n[r]=i._otherSourceCaches[t]}for(const t in i._symbolSourceCaches){const n=e.av(t,i.scope);r[n]=i._symbolSourceCaches[t]}})),this._mergedSourceCaches=t,this._mergedOtherSourceCaches=n,this._mergedSymbolSourceCaches=r}mergeLayers(){var t=this;const n={},r=[],i={};this._mergedSlots=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._mergedLayerSelectors.clear(),this.forEachFragmentStyle((t=>{for(const o of t._order){const i=t._layers[o];if("slot"===i.type){const t=e.cn(o);if(n[t])continue;n[t]=[]}i.slot&&n[i.slot]?n[i.slot].push(i):r.push(i)}const{featuresets:i}=t.stylesheet||{};if(i)for(const n in i){const{selectors:r}=i[n];for(const i of r){const r=t._layers[i.layer],o=this._mergedLayerSelectors.get(r.fqid)||[];let a;if(i.properties)for(const t in i.properties){const n=e.M(i.properties[t]);"success"===n.result&&(a=a||{},a[t]=n.value)}o.push({featuresetId:n,featureNamespace:i.featureNamespace,properties:a}),this._mergedLayerSelectors.set(r.fqid,o)}}})),this._mergedOrder=[];const o=function(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];for(const a of r)if("slot"===a.type){const r=e.cn(a.id);n[r]&&o(n[r]),t._mergedSlots.push(r)}else{const n=e.av(a.id,a.scope);t._mergedOrder.push(n),i[n]=a,a.is3D()&&(t._has3DLayers=!0),"circle"===a.type&&(t._hasCircleLayers=!0),"symbol"===a.type&&(t._hasSymbolLayers=!0),"clip"===a.type&&(t._clipLayerPresent=!0)}};o(r),this._mergedOrder.sort(((e,t)=>{const n=i[e],r=i[t];return n.hasInitialOcclusionOpacityProperties?r.is3D()?1:0:n.is3D()&&r.hasInitialOcclusionOpacityProperties?-1:0})),this._mergedLayers=i,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&0===this.terrain.drapeRenderMode}getCamera(){return this.stylesheet.camera}setCamera(t){return this.stylesheet.camera=e.l({},this.stylesheet.camera,t),this.camera=this.stylesheet.camera,this}_evaluateColorThemeData(t){return t.data?function(t,n,r){const i=e.l({},n);for(const a of Object.keys(e._.colorTheme))void 0===i[a]&&(i[a]=e._.colorTheme[a].default);const o=new e.$(sr,t,new Map(r));return o.setTransitionOrValue(i,r),o.untransitioned().possiblyEvaluate(new e.a3(0))}(this.scope,t,this.options).get("data"):null}_loadColorTheme(t){this._styleColorTheme.lutLoading=!0,this._styleColorTheme.lutLoadingCorrelationID+=1;const n=this._styleColorTheme.lutLoadingCorrelationID;return new Promise(((r,i)=>{const o="data:image/png;base64,";if(!t||0===t.length)return this._styleColorTheme.lut=null,this._styleColorTheme.lutLoading=!1,void r();let a=t;a.startsWith(o)||(a=o+a);const s="mapbox-reserved-lut",l=new Image;l.src=a,l.onerror=()=>{this._styleColorTheme.lutLoading=!1,i(new Error("Failed to load image data"))},l.onload=()=>{if(this._styleColorTheme.lutLoadingCorrelationID!==n)return void r();this._styleColorTheme.lutLoading=!1;const{width:o,height:a,data:c}=e.q.getImageData(l);if(a>32)return void i(new Error("The height of the image must be less than or equal to 32 pixels."));if(o!==a*a)return void i(new Error("The width of the image must be equal to the height squared."));this.getImage(s)&&this.removeImage(s),this.addImage(s,{data:new e.r({width:o,height:a},c),pixelRatio:1,sdf:!1,version:0});const u=this.imageManager.getImage(s,this.scope);u?(this._styleColorTheme.lut={image:u.data,data:t},r()):i(new Error("Missing LUT image."))}}))}getLut(e){const t=this._styleColorThemeForScope[e];return t?t.lut:null}setProjection(e){e?this.stylesheet.projection=e:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(t){this._spriteRequest=function(t,n,r){let i,o,a;const s=e.q.devicePixelRatio>1?"@2x":"";let l=e.n(n.transformRequest(n.normalizeSpriteURL(t,s,".json"),e.R.SpriteJSON),((e,t)=>{l=null,a||(a=e,i=t,u())})),c=e.o(n.transformRequest(n.normalizeSpriteURL(t,s,".png"),e.R.SpriteImage),((e,t)=>{c=null,a||(a=e,o=t,u())}));function u(){if(a)r(a);else if(i&&o){const t=e.q.getImageData(o),n={};for(const r in i){const{width:o,height:a,x:s,y:l,sdf:c,pixelRatio:u,stretchX:h,stretchY:d,content:p}=i[r],f=new e.r({width:o,height:a});e.r.copy(t,f,{x:s,y:l},{x:0,y:0},{width:o,height:a},null),n[r]={data:f,pixelRatio:u,sdf:c,stretchX:h,stretchY:d,content:p}}r(null,n)}}return{cancel(){l&&(l.cancel(),l=null),c&&(c.cancel(),c=null)}}}(t,this.map._requestManager,((t,n)=>{if(this._spriteRequest=null,t)this.fire(new e.t(t));else if(n)for(const e in n)this.imageManager.addImage(e,this.scope,n[e]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new e.x("data",{dataType:"style"}))}))}_validateLayer(t){const n=this.getOwnSource(t.source);if(!n)return;const r=t.sourceLayer;r&&("geojson"===n.type||n.vectorLayerIds&&-1===n.vectorLayerIds.indexOf(r))&&this.fire(new e.t(new Error('Source layer "'.concat(r,'" does not exist on source "').concat(n.id,'" as specified by style layer "').concat(t.id,'"'))))}loaded(){if(!this._loaded)return!1;if(Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const e in this._sourceCaches)if(!this._sourceCaches[e].loaded())return!1;if(!this.imageManager.isLoaded())return!1;if(!this.modelManager.isLoaded())return!1;if(this._styleColorTheme.lutLoading)return!1;for(const{style:e}of this.fragments)if(!e.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map(((e,t)=>{const n=this.fragments[t];return n&&n.style&&(e.data=n.style.serialize()),e}))}_serializeSources(){const e={};for(const t in this._sourceCaches){const n=this._sourceCaches[t].getSource();e[n.id]||(e[n.id]=n.serialize())}return e}_serializeLayers(e){const t=[];for(const n of e){const e=this._layers[n];e&&"custom"!==e.type&&t.push(e.serialize())}return t}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasTransitions(){if(this.hasLightTransitions())return!0;if(this.hasFogTransition())return!0;for(const e in this._sourceCaches)if(this._sourceCaches[e].hasTransition())return!0;for(const e in this._layers)if(this._layers[e].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}_getOrder(e){return e?this.order:this._mergedOrder}isLayerDraped(e){return!!this.terrain&&e.isDraped(this.getLayerSourceCache(e))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(t){const n=this.getOwnLayer(t);if(n)return n;this.fire(new e.t(new Error("The layer '".concat(t,"' does not exist in the map's style."))))}_checkSource(t){const n=this.getOwnSource(t);if(n)return n;this.fire(new e.t(new Error("The source '".concat(t,"' does not exist in the map's style."))))}precompilePrograms(e,t){const n=this.map.painter;if(n)for(let r=e.minzoom||0;r<(e.maxzoom||25.5);r++){const r=e.getProgramIds();if(r)for(const i of r){const r=e.getDefaultProgramParams(i,t.zoom,this._styleColorTheme.lut);r&&(n.style=this,this.fog&&(n._fogVisible=!0,r.overrideFog=!0,n.getOrCreateProgram(i,r)),n._fogVisible=!1,r.overrideFog=!1,n.getOrCreateProgram(i,r),(this.stylesheet.terrain||this.stylesheet.projection&&"globe"===this.stylesheet.projection.name)&&(r.overrideRtt=!0,n.getOrCreateProgram(i,r)))}}}update(t){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(t),this.directionalLight&&this.directionalLight.recalculate(t);const n=this.calculateLightsBrightness();t.brightness=n||0,n!==this._brightness&&(this._brightness=n,this.dispatcher.broadcast("setBrightness",n));const r=this._changes.isDirty();let i=!1;if(this._changes.isDirty()){const e=this._changes.getLayerUpdatesByScope();for(const t in e){const{updatedIds:n,removedIds:r}=e[t];(n||r)&&(this._updateWorkerLayers(t,n,r),i=!0)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(t),this.light&&this.light.updateTransitions(t),this.ambientLight&&this.ambientLight.updateTransitions(t),this.directionalLight&&this.directionalLight.updateTransitions(t),this.fog&&this.fog.updateTransitions(t),this._changes.reset()}const o={};for(const e in this._mergedSourceCaches){const t=this._mergedSourceCaches[e];o[e]=t.used,t.used=!1,t.tileCoverLift=0}for(const e of this._mergedOrder){const n=this._mergedLayers[e];if(n.recalculate(t,this._availableImages),!n.isHidden(t.zoom)){const e=this.getLayerSourceCache(n);e&&(e.used=!0,e.tileCoverLift=Math.max(e.tileCoverLift,n.tileCoverLift()))}!this._precompileDone&&this._shouldPrecompile&&("requestIdleCallback"in window?requestIdleCallback((()=>{this.precompilePrograms(n,t)})):this.precompilePrograms(n,t))}this._shouldPrecompile&&(this._precompileDone=!0),this.terrain&&i&&this.mergeLayers();for(const a in o){const t=this._mergedSourceCaches[a];o[a]!==t.used&&t.getSource().fire(new e.x("data",{sourceDataType:"visibility",dataType:"source",sourceId:t.getSource().id}))}this.light&&this.light.recalculate(t),this.terrain&&this.terrain.recalculate(t),this.fog&&this.fog.recalculate(t),this.z=t.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),r&&this.fire(new e.x("data",{dataType:"style"}))}_updateTilesForChangedImages(){const e=this._changes.getUpdatedImages();if(e.length){for(const t in this._sourceCaches)this._sourceCaches[t].reloadTilesForDependencies(["icons","patterns"],e);this._changes.resetUpdatedImages()}}_updateWorkerLayers(e,t,n){const r=this.getFragmentStyle(e);r&&this.dispatcher.broadcast("updateLayers",{layers:t?r._serializeLayers(t):[],scope:e,removedIds:n||[],options:r.options})}setState(t,n){if(this._checkLoaded(),lr(this,xe(t)))return!1;(t=e.cm(t)).layers=Mt(t.layers);const r=function(t,n){if(!t)return[{command:Pt.setStyle,args:[n]}];let r=[];try{if(!e.bi(t.version,n.version))return[{command:Pt.setStyle,args:[n]}];if(e.bi(t.center,n.center)||r.push({command:Pt.setCenter,args:[n.center]}),e.bi(t.zoom,n.zoom)||r.push({command:Pt.setZoom,args:[n.zoom]}),e.bi(t.bearing,n.bearing)||r.push({command:Pt.setBearing,args:[n.bearing]}),e.bi(t.pitch,n.pitch)||r.push({command:Pt.setPitch,args:[n.pitch]}),e.bi(t.sprite,n.sprite)||r.push({command:Pt.setSprite,args:[n.sprite]}),e.bi(t.glyphs,n.glyphs)||r.push({command:Pt.setGlyphs,args:[n.glyphs]}),e.bi(t.imports,n.imports)||function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;n=n||[];const i=(t=t||[]).map(Nt),o=n.map(Nt),a=t.reduce(Dt,{}),s=n.reduce(Dt,{}),l=i.slice();let c,u,h,d;for(c=0,u=0;c<i.length;c++)h=i[c],s.hasOwnProperty(h)?u++:(r.push({command:Pt.removeImport,args:[h]}),l.splice(l.indexOf(h,u),1));for(c=0,u=0;c<o.length;c++)h=o[o.length-1-c],l[l.length-1-c]!==h&&(a.hasOwnProperty(h)?(r.push({command:Pt.removeImport,args:[h]}),l.splice(l.lastIndexOf(h,l.length-u),1)):u++,d=l[l.length-c],r.push({command:Pt.addImport,args:[s[h],d]}),l.splice(l.length-c,0,h));for(const p of n){const t=a[p.id];t&&!e.bi(t,p)&&r.push({command:Pt.updateImport,args:[p.id,p]})}}(t.imports,n.imports,r),e.bi(t.transition,n.transition)||r.push({command:Pt.setTransition,args:[n.transition]}),e.bi(t.light,n.light)||r.push({command:Pt.setLight,args:[n.light]}),e.bi(t.fog,n.fog)||r.push({command:Pt.setFog,args:[n.fog]}),e.bi(t.projection,n.projection)||r.push({command:Pt.setProjection,args:[n.projection]}),e.bi(t.lights,n.lights)||r.push({command:Pt.setLights,args:[n.lights]}),e.bi(t.camera,n.camera)||r.push({command:Pt.setCamera,args:[n.camera]}),!e.bi(t["color-theme"],n["color-theme"]))return[{command:Pt.setStyle,args:[n]}];const i={},o=[];!function(t,n,r,i){let o;for(o in n=n||{},t=t||{})t.hasOwnProperty(o)&&(n.hasOwnProperty(o)||Ct(o,r,i));for(o in n){if(!n.hasOwnProperty(o))continue;const a=n[o];t.hasOwnProperty(o)?e.bi(t[o],a)||("geojson"===t[o].type&&"geojson"===a.type&&It(t,n,o)?r.push({command:Pt.setGeoJSONSourceData,args:[o,a.data]}):jt(o,n,r,i)):kt(o,n,r)}}(t.sources,n.sources,o,i);const a=[];t.layers&&t.layers.forEach((e=>{e.source&&i[e.source]?r.push({command:Pt.removeLayer,args:[e.id]}):a.push(e)}));let s=t.terrain;s&&i[s.source]&&(r.push({command:Pt.setTerrain,args:[void 0]}),s=void 0),r=r.concat(o),e.bi(s,n.terrain)||r.push({command:Pt.setTerrain,args:[n.terrain]}),function(t,n,r){n=n||[];const i=(t=t||[]).map(Nt),o=n.map(Nt),a=t.reduce(Dt,{}),s=n.reduce(Dt,{}),l=i.slice(),c=Object.create(null);let u,h,d,p,f,m,g;for(u=0,h=0;u<i.length;u++)d=i[u],s.hasOwnProperty(d)?h++:(r.push({command:Pt.removeLayer,args:[d]}),l.splice(l.indexOf(d,h),1));for(u=0,h=0;u<o.length;u++)d=o[o.length-1-u],l[l.length-1-u]!==d&&(a.hasOwnProperty(d)?(r.push({command:Pt.removeLayer,args:[d]}),l.splice(l.lastIndexOf(d,l.length-h),1)):h++,m=l[l.length-u],r.push({command:Pt.addLayer,args:[s[d],m]}),l.splice(l.length-u,0,d),c[d]=!0);for(u=0;u<o.length;u++)if(d=o[u],p=a[d],f=s[d],!c[d]&&!e.bi(p,f))if(e.bi(p.source,f.source)&&e.bi(p["source-layer"],f["source-layer"])&&e.bi(p.type,f.type)){for(g in Ot(p.layout,f.layout,r,d,null,Pt.setLayoutProperty),Ot(p.paint,f.paint,r,d,null,Pt.setPaintProperty),e.bi(p.slot,f.slot)||r.push({command:Pt.setSlot,args:[d,f.slot]}),e.bi(p.filter,f.filter)||r.push({command:Pt.setFilter,args:[d,f.filter]}),e.bi(p.minzoom,f.minzoom)&&e.bi(p.maxzoom,f.maxzoom)||r.push({command:Pt.setLayerZoomRange,args:[d,f.minzoom,f.maxzoom]}),p)p.hasOwnProperty(g)&&"layout"!==g&&"paint"!==g&&"filter"!==g&&"metadata"!==g&&"minzoom"!==g&&"maxzoom"!==g&&"slot"!==g&&(0===g.indexOf("paint.")?Ot(p[g],f[g],r,d,g.slice(6),Pt.setPaintProperty):e.bi(p[g],f[g])||r.push({command:Pt.setLayerProperty,args:[d,g,f[g]]}));for(g in f)f.hasOwnProperty(g)&&!p.hasOwnProperty(g)&&"layout"!==g&&"paint"!==g&&"filter"!==g&&"metadata"!==g&&"minzoom"!==g&&"maxzoom"!==g&&"slot"!==g&&(0===g.indexOf("paint.")?Ot(p[g],f[g],r,d,g.slice(6),Pt.setPaintProperty):e.bi(p[g],f[g])||r.push({command:Pt.setLayerProperty,args:[d,g,f[g]]}))}else r.push({command:Pt.removeLayer,args:[d]}),m=l[l.lastIndexOf(d)+1],r.push({command:Pt.addLayer,args:[f,m]})}(a,n.layers,r)}catch(e){console.warn("Unable to compute style diff:",e),r=[{command:Pt.setStyle,args:[n]}]}return r}(this.serialize(),t).filter((e=>!(e.command in ur)));if(0===r.length)return!1;const i=r.filter((e=>!(e.command in cr)));if(i.length>0)throw new Error("Unimplemented: ".concat(i.map((e=>e.command)).join(", "),"."));const o=[];return r.forEach((e=>{o.push(this[e.command].apply(this,e.args))})),n&&Promise.all(o).then(n),this.stylesheet=t,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}addImage(t,n){return this.getImage(t)?this.fire(new e.t(new Error("An image with this name already exists."))):(this.imageManager.addImage(t,this.scope,n),this._afterImageUpdated(t),this)}updateImage(e,t){this.imageManager.updateImage(e,this.scope,t)}getImage(e){return this.imageManager.getImage(e,this.scope)}removeImage(t){return this.getImage(t)?(this.imageManager.removeImage(t,this.scope),this._afterImageUpdated(t),this):this.fire(new e.t(new Error("No image with this name exists.")))}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(this.scope),this._changes.updateImage(t),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.fire(new e.x("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModel(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this._checkLoaded(),this._validate(Ce,"models.".concat(e),t,null,n)||(this.modelManager.addModel(e,t,this.scope),this._changes.setDirty()),this}hasModel(e){return this.modelManager.hasModel(e,this.scope)}removeModel(t){return this.hasModel(t)?(this.modelManager.removeModel(t,this.scope),this):this.fire(new e.t(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this._checkLoaded(),void 0!==this.getOwnSource(t))throw new Error('There is already a source with ID "'.concat(t,'".'));if(!n.type)throw new Error("The type property must be defined, but only the following properties were given: ".concat(Object.keys(n).join(", "),"."));if(["vector","raster","geojson","video","image"].indexOf(n.type)>=0&&this._validate(be,"sources.".concat(t),n,null,r))return;this.map&&this.map._collectResourceTiming&&(n.collectResourceTiming=!0);const i=rt(t,n,this.dispatcher,this);i.scope=this.scope,i.setEventedParent(this,(()=>({isSourceLoaded:this._isSourceCacheLoaded(i.id),source:i.serialize(),sourceId:i.id})));const o=t=>{const n=(t?"symbol:":"other:")+i.id,r=e.av(n,this.scope),o=this._sourceCaches[n]=new bt(r,i,t);(t?this._symbolSourceCaches:this._otherSourceCaches)[i.id]=o,o.onAdd(this.map)};o(!1),"vector"!==n.type&&"geojson"!==n.type||o(!0),i.onAdd&&i.onAdd(this.map),r.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(t){this._checkLoaded();const n=this.getOwnSource(t);if(!n)throw new Error("There is no source with this ID");for(const i in this._layers)if(this._layers[i].source===t)return this.fire(new e.t(new Error('Source "'.concat(t,'" cannot be removed while layer "').concat(i,'" is using it.'))));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===t)return this.fire(new e.t(new Error('Source "'.concat(t,'" cannot be removed while terrain is using it.'))));const r=this.getOwnSourceCaches(t);for(const i of r){const t=e.cn(i.id);delete this._sourceCaches[t],this._changes.discardSourceCacheUpdate(i.id),i.fire(new e.x("data",{sourceDataType:"metadata",dataType:"source",sourceId:i.getSource().id})),i.setEventedParent(null),i.clearTiles()}return delete this._otherSourceCaches[t],delete this._symbolSourceCaches[t],this.mergeSources(),n.setEventedParent(null),n.onRemove&&n.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(e,t){this._checkLoaded(),this.getOwnSource(e).setData(t),this._changes.setDirty()}getOwnSource(e){const t=this.getOwnSourceCache(e);return t&&t.getSource()}getOwnSources(){const e=[];for(const t in this._otherSourceCaches){const n=this.getOwnSourceCache(t);n&&e.push(n.getSource())}return e}areTilesLoaded(){const e=this._mergedSourceCaches;for(const t in e){const n=e[t]._tiles;for(const e in n){const t=n[e];if("loaded"!==t.state&&"errored"!==t.state)return!1}}return!0}setLights(t){if(this._checkLoaded(),!t)return delete this.ambientLight,void delete this.directionalLight;const n=this._getTransitionParameters();for(const i of t){if(this._validate(Se,"lights",i))return;switch(i.type){case"ambient":if(this.ambientLight){const e=this.ambientLight;e.set(i),e.updateTransitions(n)}else this.ambientLight=new He(i,Ze||(Ze=new e.a0({color:new e.a1(e._.properties_light_ambient.color),intensity:new e.a1(e._.properties_light_ambient.intensity)})),this.scope,this.options);break;case"directional":if(this.directionalLight){const e=this.directionalLight;e.set(i),e.updateTransitions(n)}else this.directionalLight=new He(i,qe||(qe=new e.a0({direction:new e.ad(e._.properties_light_directional.direction),color:new e.a1(e._.properties_light_directional.color),intensity:new e.a1(e._.properties_light_directional.intensity),"cast-shadows":new e.a1(e._.properties_light_directional["cast-shadows"]),"shadow-intensity":new e.a1(e._.properties_light_directional["shadow-intensity"])})),this.scope,this.options)}}const r=new e.a3(this.z||0,n);this.ambientLight&&this.ambientLight.recalculate(r),this.directionalLight&&this.directionalLight.recalculate(r),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const t=this.directionalLight,n=this.ambientLight;if(!t||!n)return;const r=e=>.2126*(e[0]<=.03928?e[0]/12.92:Math.pow((e[0]+.055)/1.055,2.4))+.7152*(e[1]<=.03928?e[1]/12.92:Math.pow((e[1]+.055)/1.055,2.4))+.0722*(e[2]<=.03928?e[2]/12.92:Math.pow((e[2]+.055)/1.055,2.4)),i=t.properties.get("color").toRenderColor(null).toArray01(),o=t.properties.get("intensity"),a=t.properties.get("direction"),s=1-e.c8(a.x,a.y,a.z)[2]/90,l=r(i)*o*s,c=n.properties.get("color").toRenderColor(null).toArray01(),u=n.properties.get("intensity"),h=r(c)*u;return Number(((l+h)/2).toFixed(6))}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const e=[];return this.directionalLight&&e.push(this.directionalLight.get()),this.ambientLight&&e.push(this.ambientLight.get()),e}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(t){if(!t)return this;if(e.aK(t)){const n=e.co(t),r=this.fragments.find((e=>{let{id:t}=e;return t===n}));if(!r)throw new Error("Style import '".concat(t,"' not found"));const i=e.cn(t);return r.style.getFragmentStyle(i)}{const e=this.fragments.find((e=>{let{id:n}=e;return n===t}));if(!e)throw new Error("Style import '".concat(t,"' not found"));return e.style}}getFeaturesetDescriptors(e){const t=this.getFragmentStyle(e);if(!t||!t.stylesheet.featuresets)return[];const n=[];for(const r in t.stylesheet.featuresets)n.push({featuresetId:r,importId:t.scope?t.scope:void 0});return n}getFeaturesetLayers(t,n){const r=this.getFragmentStyle(n),i=r.stylesheet.featuresets;if(!i||!i[t])return this.fire(new e.t(new Error("The featureset '".concat(t,"' does not exist in the map's style and cannot be queried.")))),[];const o=[];for(const e of i[t].selectors){const t=r.getOwnLayer(e.layer);t&&o.push(t)}return o}getConfigProperty(t,n){const r=this.getFragmentStyle(t);if(!r)return null;const i=e.av(n,r.scope),o=r.options.get(i),a=o?o.value||o.default:null;return a?a.serialize():null}setConfigProperty(t,n,r){const o=this.getFragmentStyle(t);if(!o)return;const a=o.stylesheet.schema;if(!a||!a[n])return;const s=e.M(r);if("success"!==s.result)return void lr(this,s.value);const l=s.value.expression,c=e.av(n,o.scope),u=o.options.get(c);if(!u)return;let h;const{minValue:d,maxValue:p,stepValue:f,type:m,values:g}=a[n],y=e.M(a[n].default);"success"===y.result&&(h=y.value.expression),h?(this.options.set(c,i(i({},u),{},{value:l,default:h,minValue:d,maxValue:p,stepValue:f,type:m,values:g})),this.updateConfigDependencies(n)):this.fire(new e.t(new Error('No schema defined for the config option "'.concat(n,'" in the "').concat(t,'" fragment.'))))}getConfig(t){const n=this.getFragmentStyle(t);if(!n)return null;const r=n.stylesheet.schema;if(!r)return null;const i={};for(const o in r){const t=e.av(o,n.scope),r=n.options.get(t),a=r?r.value||r.default:null;i[o]=a?a.serialize():null}return i}setConfig(e,t){const n=this.getFragmentStyle(e);n&&(n.updateConfig(t,n.stylesheet.schema),this.updateConfigDependencies())}getSchema(e){const t=this.getFragmentStyle(e);return t?t.stylesheet.schema:null}setSchema(e,t){const n=this.getFragmentStyle(e);n&&(n.stylesheet.schema=t,n.updateConfig(n._config,t),this.updateConfigDependencies())}updateConfig(t,n){if(this._config=t,t||n)if(n)for(const r in n){let i,o;const a=e.M(n[r].default);if("success"===a.result&&(i=a.value.expression),t&&void 0!==t[r]){const n=e.M(t[r]);"success"===n.result&&(o=n.value.expression)}const{minValue:s,maxValue:l,stepValue:c,type:u,values:h}=n[r];if(i){const t=e.av(r,this.scope);this.options.set(t,{default:i,value:o,minValue:s,maxValue:l,stepValue:c,type:u,values:h})}else this.fire(new e.t(new Error('No schema defined for config option "'.concat(r,'".'))))}else this.fire(new e.t(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(e){for(const t of this._configDependentLayers){const n=this.getLayer(t);if(n){if(e&&!n.configDependencies.has(e))continue;n.possiblyEvaluateVisibility(),this._updateLayer(n)}}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this.forEachFragmentStyle((e=>{if(e._styleColorTheme.colorTheme){const t=e._evaluateColorThemeData(e._styleColorTheme.colorTheme);(!e._styleColorTheme.lut&&""!==t||e._styleColorTheme.lut&&t!==e._styleColorTheme.lut.data)&&e.setColorTheme(e._styleColorTheme.colorTheme)}})),this._changes.setDirty()}addLayer(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._checkLoaded();const i=t.id;if(this._layers[i])return void this.fire(new e.t(new Error('Layer with id "'.concat(i,'" already exists on this map'))));let o;if("custom"===t.type){if(lr(this,e.cp(t)))return;o=e.cq(t,this.scope,this._styleColorTheme.lut,this.options)}else{if("object"==typeof t.source&&(this.addSource(i,t.source),t=e.cm(t),t=e.l(t,{source:i})),this._validate(Ae,"layers.".concat(i),t,{arrayIndex:-1},r))return;o=e.cq(t,this.scope,this._styleColorTheme.lut,this.options),this._validateLayer(o),o.setEventedParent(this,{layer:{id:i}})}0!==o.configDependencies.size&&this._configDependentLayers.add(o.fqid);let a=this._order.length;if(n){const t=this._order.indexOf(n);if(-1===t)return void this.fire(new e.t(new Error('Layer with id "'.concat(n,'" does not exist on this map.'))));o.slot===this._layers[n].slot?a=t:e.w('Layer with id "'.concat(n,'" has a different slot. Layers can only be rearranged within the same slot.'))}this._order.splice(a,0,i),this._layerOrderChanged=!0,this._layers[i]=o;const s=this.getOwnLayerSourceCache(o),l=!!this.directionalLight&&this.directionalLight.shadowsEnabled();s&&o.canCastShadows()&&l&&(s.castsShadows=!0);const c=this._changes.getRemovedLayer(o);if(c&&o.source&&s&&"custom"!==o.type){this._changes.discardLayerRemoval(o);const t=e.av(o.source,o.scope);c.type!==o.type?this._changes.updateSourceCache(t,"clear"):(this._changes.updateSourceCache(t,"reload"),s.pause())}this._updateLayer(o),o.onAdd&&o.onAdd(this.map),o.scope=this.scope,this.mergeLayers()}moveLayer(t,n){this._checkLoaded();const r=this._checkLayer(t);if(!r)return;if(t===n)return;const i=this._order.indexOf(t);this._order.splice(i,1);let o=this._order.length;if(n){const t=this._order.indexOf(n);if(-1===t)return void this.fire(new e.t(new Error('Layer with id "'.concat(n,'" does not exist on this map.'))));r.slot===this._layers[n].slot?o=t:e.w('Layer with id "'.concat(n,'" has a different slot. Layers can only be rearranged within the same slot.'))}this._order.splice(o,0,t),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(e){this._checkLoaded();const t=this._checkLayer(e);if(!t)return;t.setEventedParent(null);const n=this._order.indexOf(e);this._order.splice(n,1),delete this._layers[e],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(t.fqid),this._changes.removeLayer(t);const r=this.getOwnLayerSourceCache(t);if(r&&r.castsShadows){let e=!1;for(const n in this._layers)if(this._layers[n].source===t.source&&this._layers[n].canCastShadows()){e=!0;break}r.castsShadows=e}t.onRemove&&t.onRemove(this.map),this.mergeLayers()}getOwnLayer(e){return this._layers[e]}hasLayer(e){return e in this._mergedLayers}hasLayerType(e){for(const t in this._layers)if(this._layers[t].type===e)return!0;return!1}setLayerZoomRange(e,t,n){this._checkLoaded();const r=this._checkLayer(e);r&&(r.minzoom===t&&r.maxzoom===n||(null!=t&&(r.minzoom=t),null!=n&&(r.maxzoom=n),this._updateLayer(r)))}getSlots(){return this._checkLoaded(),this._mergedSlots}setSlot(e,t){this._checkLoaded();const n=this._checkLayer(e);n&&n.slot!==t&&(n.slot=t,this._updateLayer(n))}setFilter(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._checkLoaded();const i=this._checkLayer(t);if(i&&!e.bi(i.filter,n))return null==n?(i.filter=void 0,void this._updateLayer(i)):void(this._validate(Me,"layers.".concat(i.id,".filter"),n,{layerType:i.type},r)||(i.filter=e.cm(n),this._updateLayer(i)))}getFilter(t){const n=this._checkLayer(t);if(n)return e.cm(n.filter)}setLayoutProperty(t,n,r){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this._checkLoaded();const o=this._checkLayer(t);if(o&&!e.bi(o.getLayoutProperty(n),r)){if(null!=r&&(!i||!1!==i.validate)&&lr(o,ke.call(xe,{key:"layers.".concat(t,".layout.").concat(n),layerType:o.type,objectKey:n,value:r,styleSpec:e._,style:{glyphs:!0,sprite:!0}})))return;o.setLayoutProperty(n,r),0!==o.configDependencies.size&&this._configDependentLayers.add(o.fqid),this._updateLayer(o)}}getLayoutProperty(e,t){const n=this._checkLayer(e);if(n)return n.getLayoutProperty(t)}setPaintProperty(t,n,r){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this._checkLoaded();const o=this._checkLayer(t);if(!o)return;if(e.bi(o.getPaintProperty(n),r))return;if(null!=r&&(!i||!1!==i.validate)&&lr(o,Pe.call(xe,{key:"layers.".concat(t,".paint.").concat(n),layerType:o.type,objectKey:n,value:r,styleSpec:e._})))return;const a=o.setPaintProperty(n,r);0!==o.configDependencies.size&&this._configDependentLayers.add(o.fqid),a&&this._updateLayer(o),this._changes.updatePaintProperties(o)}getPaintProperty(e,t){const n=this._checkLayer(e);if(n)return n.getPaintProperty(t)}setFeatureState(t,n){this._checkLoaded();const r=t.featureset;if(r){if("featuresetId"in r){const e=this.getFragmentStyle(r.importId),i=e.getFeaturesetLayers(r.featuresetId);for(const{source:r,sourceLayer:o}of i)e.setFeatureState({id:t.id,source:r,sourceLayer:o},n)}else if("layerId"in r){const e=this.getLayer(r.layerId);this.setFeatureState({id:t.id,source:e.source,sourceLayer:e.sourceLayer},n)}return}const i=t.source,o=t.sourceLayer,a=this._checkSource(i);if(!a)return;const s=a.type;if("geojson"===s&&o)return void this.fire(new e.t(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if("vector"===s&&!o)return void this.fire(new e.t(new Error("The sourceLayer parameter must be provided for vector source types.")));void 0===t.id&&this.fire(new e.t(new Error("The feature id parameter must be provided.")));const l=this.getOwnSourceCaches(i);for(const e of l)e.setFeatureState(o,t.id,n)}removeFeatureState(t,n){this._checkLoaded();const r=t.featureset;if(r){if("featuresetId"in r){const e=this.getFragmentStyle(r.importId),i=e.getFeaturesetLayers(r.featuresetId);for(const{source:r,sourceLayer:o}of i)e.removeFeatureState({id:t.id,source:r,sourceLayer:o},n)}else if("layerId"in r){const e=this.getLayer(r.layerId);this.removeFeatureState({id:t.id,source:e.source,sourceLayer:e.sourceLayer},n)}return}const i=t.source,o=this._checkSource(i);if(!o)return;const a=o.type,s="vector"===a?t.sourceLayer:void 0;if("vector"===a&&!s)return void this.fire(new e.t(new Error("The sourceLayer parameter must be provided for vector source types.")));if(n&&"string"!=typeof t.id&&"number"!=typeof t.id)return void this.fire(new e.t(new Error("A feature id is required to remove its specific state property.")));const l=this.getOwnSourceCaches(i);for(const e of l)e.removeFeatureState(s,t.id,n)}getFeatureState(t){this._checkLoaded();const n=t.featureset;if(n){let r;if("featuresetId"in n){const i=this.getFragmentStyle(n.importId),o=i.getFeaturesetLayers(n.featuresetId);for(const{source:n,sourceLayer:a}of o){const o=i.getFeatureState({id:t.id,source:n,sourceLayer:a});if(o&&!r)r=o;else if(!e.bi(r,o))return void this.fire(new e.t(new Error("The same feature id exists in multiple sources in the featureset, but their feature states are not consistent through the sources.")))}}else if("layerId"in t){const e=this.getLayer(n.layerId);r=this.getFeatureState({id:t.id,source:e.source,sourceLayer:e.sourceLayer})}return r}const r=t.source,i=t.sourceLayer,o=this._checkSource(r);if(o){if("vector"!==o.type||i)return void 0===t.id&&this.fire(new e.t(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(r)[0].getFeatureState(i,t.id);this.fire(new e.t(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(t){return this.stylesheet.transition=e.l({},this.stylesheet.transition,t),this.transition=this.stylesheet.transition,this}getTransition(){return e.l({},this.stylesheet.transition)}serialize(){this._checkLoaded();const t=this.getTerrain(),n=t&&this.terrain&&this.terrain.scope===this.scope?t:this.stylesheet.terrain;return e.cr({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:n,fog:this.stylesheet.fog,center:this.stylesheet.center,"color-theme":this.stylesheet["color-theme"],zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},(e=>void 0!==e))}_updateFilteredLayers(e){for(const t of Object.values(this._mergedLayers))e(t)&&this._updateLayer(t)}_updateLayer(t){this._changes.updateLayer(t);const n=this.getLayerSourceCache(t),r=e.av(t.source,t.scope),i=this._changes.getUpdatedSourceCaches();t.source&&!i[r]&&n&&"raster"!==n.getSource().type&&(this._changes.updateSourceCache(r,"reload"),n.pause()),t.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(e){const t=e=>this._mergedLayers[e].is3D(),n=this.order,r={},i=[];for(let a=n.length-1;a>=0;a--){const o=n[a];if(t(o)){r[o]=a;for(const t of e){const e=t[o];if(e)for(const t of e)i.push(t)}}}i.sort(((e,t)=>t.intersectionZ-e.intersectionZ));const o=[];for(let a=n.length-1;a>=0;a--){const s=n[a];if(t(s))for(let e=i.length-1;e>=0;e--){const t=i[e].feature;if(t.layer&&r[t.layer.id]<a)break;o.push(t),i.pop()}else for(const t of e){const e=t[s];if(e)for(const t of e)o.push(t.feature)}}return o}queryRenderedFeatures(t,n,r){n&&!Array.isArray(n)&&n.filter&&this._validate(Me,"queryRenderedFeatures.filter",n.filter,null,n);let i,o=!1;const a=new Set;if(n&&n.layers){if(!Array.isArray(n.layers))return this.fire(new e.t(new Error("parameters.layers must be an Array."))),[];i=[];for(const t of n.layers){const n=this._mergedLayers[t];if(!n)return this.fire(new e.t(new Error("The layer '".concat(t,"' does not exist in the map's style and cannot be queried for features.")))),[];n.is3D()&&(o=!0),a.add(n.source),i.push(t)}}else o=this.has3DLayers();const s=this._queryRenderedFeatures(t,r,{layerIds:i,filter:n.filter,has3DLayers:o,includedSources:a}),l=this._flattenAndSortRenderedFeatures(s),c=[];for(const u of l)e.co(u.layer.id)===this.scope&&c.push(u);return c}queryRenderedFeaturesForInteractions(t,n,r){let i=[];for(const{featureset:l,filter:c,radius:u}of n){let n=!1;const o=[],a=new Set;if("featuresetId"in l){const e=this.getFeaturesetLayers(l.featuresetId,l.importId);if(0===e.length)continue;for(const t of e)t.is3D()&&(n=!0),a.add(t.source),o.push(t.fqid)}else if("layerId"in l){const t=this._mergedLayers[l.layerId];if(!t)return this.fire(new e.t(new Error("The layer '".concat(l.layerId,"' does not exist in the map's style and cannot be queried for features.")))),[];t.is3D()&&(n=!0),a.add(t.source),o.push(l.layerId)}let s=t;if(u)if(t instanceof e.P||"number"==typeof t[0]){const n=e.P.convert(t);s=[[n.x-u,n.y-u],[n.x+u,n.y+u]]}else{const n=e.P.convert(t[0]),r=e.P.convert(t[1]);s=[[n.x-u,n.y-u],[r.x+u,r.y+u]]}i=i.concat(this._queryRenderedFeatures(s,r,{layerIds:o,filter:c,has3DLayers:n,includedSources:a}))}const o=this._flattenAndSortRenderedFeatures(i),a=(e,t,n)=>{const r=e.clone();if(delete r.layer,r.featureset=t,n&&n.featureNamespace&&(r.namespace=n.featureNamespace),n&&n.properties){const t={},i=this.map.transform.zoom;for(const r of Object.keys(n.properties)){const o=n.properties[r].evaluate({zoom:i},e._vectorTileFeature,e.state,e.tile,this._availableImages);null!=o&&(t[r]=o)}r.properties=t}return r},s=[];for(const l of o){const t=l.layer.id,r=e.cn(t),i=e.co(t);for(const{featureset:e}of n){if("layerId"in e&&e.layerId!==t)continue;if("layerId"in e&&e.layerId===t){const t=a(l,e);s.push(t);continue}if("featuresetId"in e){if(e.importId!==i)continue;if(!this.getFeaturesetLayers(e.featuresetId,e.importId).map((e=>e.id)).includes(r))continue}const n=this._mergedLayerSelectors.get(t)||[];for(const t of n){const n=a(l,e,t);s.push(n)}}}return s}_queryRenderedFeatures(t,n,r){const{layerIds:i,filter:o,has3DLayers:a,includedSources:s}=r,l=[],c=We.createFromScreenPoints(t,n);for(const e in this._mergedSourceCaches){if(!this._mergedSourceCaches[e].getSource())continue;const t=this._mergedSourceCaches[e].getSource().id;i&&!s.has(t)||l.push(ot(this._mergedSourceCaches[e],this._mergedLayers,c,o,i||[],this._availableImages,n,a,!!this.map._showQueryGeometry))}return this.placement&&l.push(function(t,n,r,i,o,a,s,l){const c={},u=s.queryRenderedSymbols(r),h=[];for(const e of Object.keys(u).map(Number))h.push(l[e]);h.sort(st);for(const e of h){const n=e.featureIndex.lookupSymbolFeatures(u[e.bucketInstanceId],e.bucketIndex,e.sourceLayerIndex,i,o,a,t);for(const t in n){const r=c[t]=c[t]||[],i=n[t];i.sort(((t,n)=>{const r=e.featureSortOrder;if(r){const e=r.indexOf(t.featureIndex);return r.indexOf(n.featureIndex)-e}return n.featureIndex-t.featureIndex}));for(const e of i)r.push(e)}}for(const d in c)c[d].forEach((r=>{const i=r.feature,o=t[d],a=n(o);if(!a)return;const s=a.getFeatureState(i.layer["source-layer"],i.id);i.state=s,e.aK(o.id)||(i.source=i.layer.source,i.layer["source-layer"]&&(i.sourceLayer=i.layer["source-layer"]))}));return c}(this._mergedLayers,this.getLayerSourceCache.bind(this),c.screenGeometry,o,i||[],this._availableImages,this.placement.collisionIndex,this.placement.retainedQueryData)),l}querySourceFeatures(e,t){const n=t&&t.filter;n&&this._validate(Me,"querySourceFeatures.filter",n,null,t);let r=[];const i=this.getOwnSourceCaches(e);for(const o of i)r=r.concat(at(o,t));return r}addSourceType(e,t,n){return pr.getSourceType(e)?n(new Error('A source type called "'.concat(e,'" already exists.'))):(pr.setSourceType(e,t),t.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:e,url:t.workerSourceURL},n):n(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._checkLoaded();const i=this.light.getLight();let o=!1;for(const s in t)if(!e.bi(t[s],i[s])){o=!0;break}if(!o)return;const a=this._getTransitionParameters();this.light.setLight(t,n,r),this.light.updateTransitions(a)}getTerrain(){return this.terrain&&1===this.terrain.drapeRenderMode?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}checkCanvasFingerprintNoise(){void 0===this.disableElevatedTerrain&&(this.disableElevatedTerrain=e.q.hasCanvasFingerprintNoise(),this.disableElevatedTerrain&&e.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."))}setTerrain(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(this._checkLoaded(),!t)return this.terrainSetForDrapingOnly()||(delete this.terrain,this.map.transform.projection.requiresDraping&&this.setTerrainForDraping()),0===n&&delete this.terrain,null===t?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);this.checkCanvasFingerprintNoise();let r=t;const i=null==t.source;if(1===n){if(this.disableElevatedTerrain)return;if("object"==typeof r.source){const t="terrain-dem-src";this.addSource(t,r.source),r=e.cm(r),r=e.l(r,{source:t})}const t=e.l({},r),n={};if(this.terrain&&i){t.source=this.terrain.get().source;const e=this.terrain?this.getFragmentStyle(this.terrain.scope):null;e&&(n.style=e.serialize())}if(this._validate(Te,"terrain",t,n))return}if(!this.terrain||this.terrain.scope!==this.scope&&!i||this.terrain&&n!==this.terrain.drapeRenderMode){if(!r)return;this._createTerrain(r,n),this.fire(new e.x("data",{dataType:"style"}))}else{const n=this.terrain,i=n.get();for(const t of Object.keys(e._.terrain))!r.hasOwnProperty(t)&&e._.terrain[t].default&&(r[t]=e._.terrain[t].default);for(const r in t)if(!e.bi(t[r],i[r])){n.set(t,this.options),this.stylesheet.terrain=t;const r=this._getTransitionParameters({duration:0});n.updateTransitions(r),this.fire(new e.x("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(e){const t=this.fog=new Ge(e,this.map.transform,this.scope,this.options);this.stylesheet.fog=t.get();const n=this._getTransitionParameters({duration:0});t.updateTransitions(n)}_updateMarkersOpacity(){0!==this.map._markers.length&&this.map._requestDomTask((()=>{for(const e of this.map._markers)e._evaluateOpacity()}))}getFog(){return this.fog?this.fog.get():null}setFog(t){if(this._checkLoaded(),!t)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const n=this.fog;if(!e.bi(n.get(),t)){n.set(t,this.options),this.stylesheet.fog=n.get();const e=this._getTransitionParameters({duration:0});n.updateTransitions(e)}}else this._createFog(t);this._markersNeedUpdate=!0}setColorTheme(t){this._checkLoaded();const n=()=>{for(const e in this._layers)this._layers[e].lut=this._styleColorTheme.lut;for(const e in this._sourceCaches)this._sourceCaches[e].clearTiles()};if(this._styleColorTheme.colorTheme=t,!t)return this._styleColorTheme.lut=null,void n();const r=this._evaluateColorThemeData(t);this._loadColorTheme(r).then((()=>{this.fire(new e.x("colorthemeset")),n()})).catch((t=>{e.w("Couldn't set color theme: ".concat(t))}))}_getTransitionParameters(t){return{now:e.q.now(),transition:e.l(this.transition,t)}}updateDrapeFirstLayers(){if(!this.terrain)return;const e=[],t=[];for(const n of this._mergedOrder)this.isLayerDraped(this._mergedLayers[n])?e.push(n):t.push(n);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...e),this._drapedFirstOrder.push(...t)}_createTerrain(e,t){const n=this.terrain=new De(e,t,this.scope,this.options);1===t&&(this.stylesheet.terrain=e),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const r=this._getTransitionParameters({duration:0});n.updateTransitions(r)}_force3DLayerUpdate(){for(const e in this._layers){const t=this._layers[e];"fill-extrusion"===t.type&&this._updateLayer(t)}}_forceSymbolLayerUpdate(){for(const e in this._layers){const t=this._layers[e];"symbol"===t.type&&this._updateLayer(t)}}_validate(t,n,r,i){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};if(o&&!1===o.validate)return!1;const a=e.l({},this.serialize());return lr(this,t.call(xe,e.l({key:n,style:a,value:r,styleSpec:e._},i)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),e.cs.off("pluginStateChange",this._rtlTextPluginCallback);for(const e in this._mergedLayers)this._mergedLayers[e].setEventedParent(null);for(const e in this._mergedSourceCaches)this._mergedSourceCaches[e].clearTiles(),this._mergedSourceCaches[e].setEventedParent(null);this.setEventedParent(null),delete this.fog,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.dispatcher.remove())}clearSource(e){const t=this.getSourceCaches(e);for(const n of t)n.clearTiles()}clearSources(){for(const e in this._mergedSourceCaches)this._mergedSourceCaches[e].clearTiles()}reloadSource(e){const t=this.getSourceCaches(e);for(const n of t)n.resume(),n.reload()}reloadSources(){for(const e of this.getSources())e.reload&&e.reload()}updateSources(e){let t;this.directionalLight&&(t=rr(this.directionalLight));for(const n in this._mergedSourceCaches)this._mergedSourceCaches[n].update(e,void 0,void 0,t)}_generateCollisionBoxes(){for(const e in this._sourceCaches){const t=this._sourceCaches[e];t.resume(),t.reload()}}_updatePlacement(t,n,r,i,o,a){let s=arguments.length>6&&void 0!==arguments[6]&&arguments[6],l=!1,c=!1;const u={},h={};for(const d of this._mergedOrder){const t=this._mergedLayers[d];if("symbol"!==t.type)continue;const r=e.av(t.source,t.scope);let i=u[r];if(!i){const e=this.getLayerSourceCache(t);if(!e)continue;const n=e.getRenderableIds(!0).map((t=>e.getTileByID(t)));h[r]=n.slice(),i=u[r]=n.sort(((e,t)=>t.tileID.overscaledZ-e.tileID.overscaledZ||(e.tileID.isLessThan(t.tileID)?-1:1)))}const o=this.crossTileSymbolIndex.addLayer(t,i,n.center.lng,n.projection);l=l||o}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),s=s||this._layerOrderChanged||0===i,this._layerOrderChanged&&this.fire(new e.x("neworder")),(s||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(e.q.now(),n.zoom))&&(this.pauseablePlacement=new Mn(n,this._mergedOrder,s,r,i,o,this.placement,this.fog&&n.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,u,h,this.map.painter.scaleFactor),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(e.q.now()),c=!0),l&&this.pauseablePlacement.placement.setStale()),c||l){this._buildingIndex.onNewFrame(n.zoom);for(let t=0;t<this._mergedOrder.length;t++){const n=this._mergedLayers[this._mergedOrder[t]];if("symbol"!==n.type)continue;const r=this.isLayerClipped(n);this.placement.updateLayerOpacities(n,u[e.av(n.source,n.scope)],t,r?a:null)}}return{needsRerender:!this.pauseablePlacement.isDone()||this.placement.hasTransitions(e.q.now())}}_releaseSymbolFadeTiles(){for(const e in this._sourceCaches)this._sourceCaches[e].releaseSymbolFadeTiles()}addImport(t,n){this._checkLoaded();const r=this.stylesheet.imports=this.stylesheet.imports||[];if(-1!==r.findIndex((e=>{let{id:n}=e;return n===t.id})))return void this.fire(new e.t(new Error("Import with id '".concat(t.id,"' already exists in the map's style."))));if(!n)return r.push(t),this._loadImports([t],!0);const i=r.findIndex((e=>{let{id:t}=e;return t===n}));return-1===i&&this.fire(new e.t(new Error('Import with id "'.concat(n,'" does not exist on this map.')))),this.stylesheet.imports=r.slice(0,i).concat(t).concat(r.slice(i)),this._loadImports([t],!0,n)}updateImport(t,n){this._checkLoaded();const r=this.stylesheet.imports||[],i=this.getImportIndex(t);return-1===i?this:"string"==typeof n?(this.setImportUrl(t,n),this):(n.url&&n.url!==r[i].url&&this.setImportUrl(t,n.url),e.bi(n.config,r[i].config)||this.setImportConfig(t,n.config),e.bi(n.data,r[i].data)||this.setImportData(t,n.data),this)}moveImport(e,t){this._checkLoaded();let n=this.stylesheet.imports||[];const r=this.getImportIndex(e);if(-1===r)return this;const i=this.getImportIndex(t);if(-1===i)return this;const o=n[r],a=this.fragments[r];return n=n.filter((t=>{let{id:n}=t;return n!==e})),this.fragments=this.fragments.filter((t=>{let{id:n}=t;return n!==e})),this.stylesheet.imports=n.slice(0,i).concat(o).concat(n.slice(i)),this.fragments=this.fragments.slice(0,i).concat(a).concat(this.fragments.slice(i)),this.mergeLayers(),this}setImportUrl(e,t){this._checkLoaded();const n=this.stylesheet.imports||[],r=this.getImportIndex(e);if(-1===r)return this;n[r].url=t;const i=this.fragments[r];return i.style=this._createFragmentStyle(n[r]),i.style.on("style.import.load",(()=>this.mergeAll())),i.style.loadURL(t),this}setImportData(e,t){this._checkLoaded();const n=this.getImportIndex(e),r=this.stylesheet.imports||[];return-1===n?this:t?(this.fragments[n].style.setState(t),this._reloadImports(),this):(delete r[n].data,this.setImportUrl(e,r[n].url))}setImportConfig(e,t){this._checkLoaded();const n=this.getImportIndex(e),r=this.stylesheet.imports||[];if(-1===n)return this;t?r[n].config=t:delete r[n].config;const i=this.fragments[n],o=i.style.stylesheet&&i.style.stylesheet.schema;return i.config=t,i.style.updateConfig(t,o),this.updateConfigDependencies(),this}removeImport(e){this._checkLoaded();const t=this.stylesheet.imports||[],n=this.getImportIndex(e);-1!==n&&(t.splice(n,1),this.fragments[n].style._remove(),this.fragments.splice(n,1),this._reloadImports())}getImportIndex(t){const n=(this.stylesheet.imports||[]).findIndex((e=>e.id===t));return-1===n&&this.fire(new e.t(new Error("Import '".concat(t,"' does not exist in the map's style and cannot be updated.")))),n}getLayer(e){return this._mergedLayers[e]}getSources(){const e=[];for(const t in this._mergedOtherSourceCaches){const n=this._mergedOtherSourceCaches[t];n&&e.push(n.getSource())}return e}getSource(e,t){const n=this.getSourceCache(e,t);return n&&n.getSource()}getLayerSource(e){const t=this.getLayerSourceCache(e);return t&&t.getSource()}getSourceCache(t,n){const r=e.av(t,n);return this._mergedOtherSourceCaches[r]}getLayerSourceCache(t){const n=e.av(t.source,t.scope);return"symbol"===t.type?this._mergedSymbolSourceCaches[n]:this._mergedOtherSourceCaches[n]}getSourceCaches(e){if(null==e)return Object.values(this._mergedSourceCaches);const t=[];return this._mergedOtherSourceCaches[e]&&t.push(this._mergedOtherSourceCaches[e]),this._mergedSymbolSourceCaches[e]&&t.push(this._mergedSymbolSourceCaches[e]),t}updateSourceCaches(){const e=this._changes.getUpdatedSourceCaches();for(const t in e){const n=e[t];"reload"===n?this.reloadSource(t):"clear"===n&&this.clearSource(t)}}updateLayers(e){const t=this._changes.getUpdatedPaintProperties();for(const n of t){const t=this.getLayer(n);t&&t.updateTransitions(e)}}getImages(e,t,n){this.imageManager.getImages(t.icons,t.scope,n),this._updateTilesForChangedImages();const r=e=>{e&&e.setDependencies(t.tileID.key,t.type,t.icons)};r(this._otherSourceCaches[t.source]),r(this._symbolSourceCaches[t.source])}getGlyphs(e,t,n){this.glyphManager.getGlyphs(t.stacks,t.scope,n)}getResource(t,n,r){return e.ct(n,r)}getOwnSourceCache(e){return this._otherSourceCaches[e]}getOwnLayerSourceCache(e){return"symbol"===e.type?this._symbolSourceCaches[e.source]:this._otherSourceCaches[e.source]}getOwnSourceCaches(e){const t=[];return this._otherSourceCaches[e]&&t.push(this._otherSourceCaches[e]),this._symbolSourceCaches[e]&&t.push(this._symbolSourceCaches[e]),t}_isSourceCacheLoaded(t){const n=this.getOwnSourceCaches(t);return 0===n.length?(this.fire(new e.t(new Error("There is no source with ID '".concat(t,"'")))),!1):n.every((e=>e.loaded()))}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}isLayerClipped(e,t){if(!this._clipLayerPresent&&"fill-extrusion"!==e.type)return!1;const n="fill-extrusion"===e.type&&"building"===e.sourceLayer;if(e.is3D()){if(n||t&&"batched-model"===t.type)return!0;if("model"===e.type)return!0}else if("symbol"===e.type)return!0;return!1}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach((e=>{e.style._remove()})),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}pr.getSourceType=function(e){return nt[e]},pr.setSourceType=function(e,t){nt[e]=t},pr.registerForPluginStateChange=e.cd;var fr="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#ifdef RENDER_CUTOFF\nfloat cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}\n#endif",mr="\nout vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}\n#ifdef INDICATOR_CUTOUT\nuniform vec2 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;\n#endif\nvec4 applyCutout(vec4 color) {\n#ifdef INDICATOR_CUTOUT\nfloat holeMinOpacity=u_indicator_cutout_params.x;float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);\n#else\nreturn color;\n#endif\n}\n#ifdef DEBUG_WIREFRAME\n#define HANDLE_WIREFRAME_DEBUG \\\nglFragColor=vec4(0.7,0.0,0.0,0.7); \\\ngl_FragDepth=gl_FragCoord.z-0.0001;\n#else\n#define HANDLE_WIREFRAME_DEBUG\n#endif\n#ifdef RENDER_CUTOFF\nuniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;\n#endif\nvec4 textureLodCustom(sampler2D image,highp vec2 pos,highp vec2 lod_coord) {highp vec2 size=vec2(textureSize(image,0));highp vec2 dx=dFdx(lod_coord.xy*size);highp vec2 dy=dFdy(lod_coord.xy*size);highp float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));highp float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}vec4 applyLUT(highp sampler3D lut,vec4 col) {vec3 size=vec3(textureSize(lut,0));vec3 uvw=(col.rbg*float(size-1.0)+0.5)/size;return vec4(texture(lut,uvw).rgb,col.a);}vec3 applyLUT(highp sampler3D lut,vec3 col) {return applyLUT(lut,vec4(col,1.0)).rgb;}",gr="\n#define EXTENT 8192.0\n#define RAD_TO_DEG 180.0/PI\n#define DEG_TO_RAD PI/180.0\n#define GLOBE_RADIUS EXTENT/PI/2.0\nfloat wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {\n#ifndef PROJECTED_POS_ON_VIEWPORT\nfloat tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;\n#else\nreturn vec3(0.0);\n#endif\n}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const vec2 units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (units_to_pixels*pos+offset)/pattern_size;}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {return get_pattern_pos(pixel_coord_upper,pixel_coord_lower,pattern_size,vec2(tile_units_to_pixels),pos);}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}\n#ifdef RENDER_CUTOFF\nuniform vec4 u_cutoff_params;out float v_cutoff_opacity;\n#endif\nconst vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)\n{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}",yr="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",_r="\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(\nmix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}\n#else\nvec3 elevationVector(vec2 pos) { return vec3(0,0,1); }\n#endif\n#ifdef TERRAIN\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}float prevElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nfloat nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nreturn currentElevation(apos);}\n#endif\nvec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }\n#endif\n#ifdef DEPTH_OCCLUSION\nuniform highp sampler2D u_depth;uniform highp vec2 u_depth_size_inv;uniform highp vec2 u_depth_range_unpack;uniform highp float u_occluder_half_size;uniform highp float u_occlusion_depth_offset;\n#ifdef DEPTH_D24\nfloat unpack_depth(float depth) {return depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}vec4 unpack_depth4(vec4 depth) {return depth*u_depth_range_unpack.x+vec4(u_depth_range_unpack.y);}\n#else\nhighp float unpack_depth_rgba(vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}\n#endif\nbool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;\n#ifdef DEPTH_D24\nfloat depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5).r);\n#else\nfloat depth=unpack_depth_rgba(texture(u_depth,(coord.xy+1.0)*0.5));\n#endif\nreturn coord.z+u_occlusion_depth_offset > depth;}highp vec4 getCornerDepths(vec2 coord) {highp vec3 df=vec3(u_occluder_half_size*u_depth_size_inv,0.0);highp vec2 uv=0.5*coord.xy+0.5;\n#ifdef DEPTH_D24\nhighp vec4 depth=vec4(\ntexture(u_depth,uv-df.xz).r,texture(u_depth,uv+df.xz).r,texture(u_depth,uv-df.zy).r,texture(u_depth,uv+df.zy).r\n);depth=unpack_depth4(depth);\n#else\nhighp vec4 depth=vec4(\nunpack_depth_rgba(texture(u_depth,uv-df.xz)),unpack_depth_rgba(texture(u_depth,uv+df.xz)),unpack_depth_rgba(texture(u_depth,uv-df.zy)),unpack_depth_rgba(texture(u_depth,uv+df.zy))\n);\n#endif\nreturn depth;}highp float occlusionFadeMultiSample(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec2 uv=0.5*coord.xy+0.5;int NX=3;int NY=4;highp vec2 df=u_occluder_half_size*u_depth_size_inv;highp vec2 oneStep=2.0*u_occluder_half_size*u_depth_size_inv/vec2(NX-1,NY-1);highp float res=0.0;for (int y=0; y < NY;++y) {for (int x=0; x < NX;++x) {\n#ifdef DEPTH_D24\nhighp float depth=unpack_depth(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)).r);\n#else\nhighp float depth=unpack_depth_rgba(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)));\n#endif\nres+=1.0-clamp(300.0*(coord.z+u_occlusion_depth_offset-depth),0.0,1.0);}}res=clamp(2.0*res/float(NX*NY)-0.5,0.0,1.0);return res;}highp float occlusionFade(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec4 depth=getCornerDepths(coord.xy);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z+u_occlusion_depth_offset)-depth),0.0,1.0));}\n#else\nbool isOccluded(vec4 frag) { return false; }highp float occlusionFade(vec4 frag) { return 1.0; }highp float occlusionFadeMultiSample(vec4 frag) { return 1.0; }\n#endif//DEPTH_OCCLUSION",vr="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",xr="highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}\n#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {\n#ifdef FOG_DITHERING\nvec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);\n#else\nreturn color;\n#endif\n}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif",br="#ifdef RASTER_ARRAY\nuniform highp sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)\n);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)\n);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}\n#endif",wr="#ifdef RASTER_ARRAY\nuniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec2 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=u_data_offset+vec2(dot(t.rg,u_data_scale),dot(t.ba,u_data_scale));velocity.y=-velocity.y;velocity/=max(u_max_speed,length(velocity));return velocity;}\n#endif\nuniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}",Sr="#ifdef RENDER_SHADOWS\nuniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {vec3 transformed_normal=vec3(-normal.xy,normal.z);float NDotL=dot(normalize(transformed_normal),u_shadow_direction);float dotScale=min(1.0-NDotL,1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}\n#endif//RENDER_SHADOWS",Tr="#ifdef RENDER_SHADOWS\n#ifdef DEPTH_TEXTURE\nuniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;\n#else\nuniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;\n#endif\nuniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;\n#ifdef DEPTH_TEXTURE\nshadow_depth=texture(u_shadowmap_1,uv).r;\n#else\nshadow_depth=unpack_depth(texture(u_shadowmap_1,uv))*0.5+0.5;\n#endif\nreturn step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;\n#ifdef DEPTH_TEXTURE\nshadow_depth=texture(u_shadowmap_0,uv).r;\n#else\nshadow_depth=unpack_depth(texture(u_shadowmap_0,uv))*0.5+0.5;\n#endif\nreturn step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;\n#ifdef TEXTURE_GATHER\nhighp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));\n#else\nhighp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(\nshadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)\n);\n#endif\nvec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return mix(lerpx.x,lerpx.y,f.y);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {\n#ifdef SHADOWS_SINGLE_CASCADE\nlight_view_pos0.xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);\n#else\nlight_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth));\n#endif\n}highp float calculate_shadow_bias(float NDotL) {\n#ifdef NORMAL_OFFSET\nreturn 0.5*u_shadow_bias.x;\n#else\nreturn 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));\n#endif\n}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_opacity(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,float shadow_opacity) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias)*shadow_opacity;return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}\n#endif";const Er=[];jr(fr,Er),jr(gr,Er),jr(mr,Er);const Ar={"_prelude_fog.vertex.glsl":vr,"_prelude_terrain.vertex.glsl":_r,"_prelude_shadow.vertex.glsl":Sr,"_prelude_fog.fragment.glsl":xr,"_prelude_shadow.fragment.glsl":Tr,"_prelude_lighting.glsl":"\n#ifdef LIGHTING_3D_MODE\nuniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}\n#endif//LIGHTING_3D_MODE","_prelude_raster_array.glsl":br,"_prelude_raster_particle.glsl":wr},Mr={};Ir("",_r),Ir(xr,vr),Ir(Tr,Sr),Ir(br,""),Ir(wr,"");const Pr=Ir(mr,gr),kr=fr;var Cr={background:Ir('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform vec4 u_color;uniform float u_opacity;\n#ifdef LIGHTING_3D_MODE\nin vec4 v_color;\n#endif\nvoid main() {vec4 out_color;\n#ifdef LIGHTING_3D_MODE\nout_color=v_color;\n#else\nout_color=u_color;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_lighting.glsl"\nin vec2 a_pos;uniform mat4 u_matrix;\n#ifdef LIGHTING_3D_MODE\nuniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;\n#endif\nvoid main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),backgroundPattern:Ir('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in highp vec2 v_pos;void main() {highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec2 u_pattern_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_pattern_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),circle:Ir('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nin vec3 v_data;in float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nuniform float u_emissive_strength;void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float blur_positive=blur < 0.0 ? 0.0 : 1.0;lowp float antialiasblur=v_data.z;float extrude_length=length(extrude)+antialiasblur*(1.0-blur_positive);float antialiased_blur=-max(abs(blur),antialiasblur);float opacity_t=smoothstep((1.0-blur_positive)*antialiased_blur,blur_positive*antialiased_blur,extrude_length-1.0)-smoothstep(0.0,antialiasblur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\nglFragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\n}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\n#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nout vec3 v_data;out float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\n#ifdef PROJECTION_GLOBE_VIEW\nreturn u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );\n#else\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#endif\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);\n#else \nsurface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);\n#endif\nvec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nocclusion_world_center=world_center;occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}'),clippingMask:Ir("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Ir('#include "_prelude_fog.fragment.glsl"\nuniform highp float u_intensity;in vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\nif (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}\n#endif\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_terrain.vertex.glsl"\n#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nout vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#else\npos=vec3(tilePos+extrude,elevation(tilePos));\n#endif\ngl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}'),heatmapTexture:Ir("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(0.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}","in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Ir("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",'#include "_prelude_terrain.vertex.glsl"\nin vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in vec2 a_elevation_from_sea;in float a_size_scale;in vec2 a_padding;in float a_auto_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {float feature_elevation=a_elevation_from_sea.x+a_auto_z_offset;float terrain_elevation=(a_elevation_from_sea.y==1.0 ? 0.0 : elevation(a_anchor_pos));vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(feature_elevation+terrain_elevation),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}'),collisionCircle:Ir("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}","in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Ir("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",'#include "_prelude_terrain.vertex.glsl"\nin vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;\n#endif\nout vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;\n#ifdef PROJECTION_GLOBE_VIEW\ngl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);\n#else\ngl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);\n#endif\n}'),fill:Ir('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\n#include "_prelude_shadow.fragment.glsl"\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nuniform float u_emissive_strength;\n#ifdef RENDER_SHADOWS\nuniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;\n#endif\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#ifdef RENDER_SHADOWS\nfloat light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);\n#endif\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_shadow.vertex.glsl"\nin vec2 a_pos;\n#ifdef ELEVATED_ROADS\nin float a_road_z_offset;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;\n#endif\nuniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp float z_offset\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp float z_offset\n#ifdef ELEVATED_ROADS\nz_offset+=a_road_z_offset;\n#endif\nfloat hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);\n#ifdef RENDER_SHADOWS\nvec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);\n#ifdef NORMAL_OFFSET\nvec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();\n#endif\nv_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),fillOutline:Ir('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\n#include "_prelude_shadow.fragment.glsl"\nin highp vec2 v_pos;uniform float u_emissive_strength;\n#ifdef RENDER_SHADOWS\nuniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;\n#endif\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#ifdef RENDER_SHADOWS\nfloat light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);\n#endif\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_shadow.vertex.glsl"\nin vec2 a_pos;\n#ifdef ELEVATED_ROADS\nin float a_road_z_offset;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;\n#endif\nuniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp float z_offset\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp float z_offset\n#ifdef ELEVATED_ROADS\nz_offset+=a_road_z_offset;\n#endif\nfloat hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef RENDER_SHADOWS\nvec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);\n#ifdef NORMAL_OFFSET\nvec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();\n#endif\nv_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),fillOutlinePattern:Ir('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\n#include "_prelude_shadow.fragment.glsl"\nuniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_emissive_strength;\n#ifdef RENDER_SHADOWS\nuniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;\n#endif\nin highp vec2 v_pos;in highp vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#ifdef RENDER_SHADOWS\nfloat light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);\n#endif\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_shadow.vertex.glsl"\nuniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;\n#ifdef ELEVATED_ROADS\nin float a_road_z_offset;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;\n#endif\nout highp vec2 v_pos;out highp vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\n#pragma mapbox: define highp float z_offset\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\n#pragma mapbox: initialize highp float z_offset\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;\n#ifdef ELEVATED_ROADS\nz_offset+=a_road_z_offset;\n#endif\nfloat hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef RENDER_SHADOWS\nvec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);\n#ifdef NORMAL_OFFSET\nvec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();\n#endif\nv_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),fillPattern:Ir('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\n#include "_prelude_shadow.fragment.glsl"\nuniform vec2 u_texsize;uniform sampler2D u_image;in highp vec2 v_pos;uniform float u_emissive_strength;\n#ifdef RENDER_SHADOWS\nuniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;\n#endif\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#ifdef RENDER_SHADOWS\nfloat light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);\n#endif\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_shadow.vertex.glsl"\nuniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;\n#ifdef ELEVATED_ROADS\nin float a_road_z_offset;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;\n#endif\nout highp vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\n#pragma mapbox: define highp float z_offset\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\n#pragma mapbox: initialize highp float z_offset\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;\n#ifdef ELEVATED_ROADS\nz_offset+=a_road_z_offset;\n#endif\nfloat hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);\n#ifdef RENDER_SHADOWS\nvec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);\n#ifdef NORMAL_OFFSET\nvec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();\n#endif\nv_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),fillExtrusion:Ir('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_shadow.fragment.glsl"\n#include "_prelude_lighting.glsl"\nin vec4 v_color;in vec4 v_flat;\n#ifdef RENDER_SHADOWS\nin highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;\n#endif\nuniform lowp float u_opacity;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;in vec2 v_ao;\n#endif\n#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)\nin vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)\nin highp vec3 v_normal;\n#endif\nuniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;\n#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)\nin float v_flood_radius;in float v_has_floodlight;\n#endif\nin float v_height;\n#pragma mapbox: define highp float emissive_strength\nvoid main() {\n#pragma mapbox: initialize highp float emissive_strength\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)\nvec3 normal=normalize(v_normal);\n#endif\nfloat z;vec4 color=v_color;\n#ifdef ZERO_ROOF_RADIUS\nz=float(normal.z > 0.00001);\n#ifdef LIGHTING_3D_MODE\nnormal=mix(normal,vec3(0.0,0.0,1.0),z);\n#else\ncolor=mix(v_color,v_roof_color,z);\n#endif\n#endif\nfloat h=max(0.0,v_height);float ao_shade=1.0;\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;\n#ifdef ZERO_ROOF_RADIUS\nconcave*=(1.0-z);\n#endif\nfloat x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);\n#ifdef LIGHTING_3D_MODE\n#ifdef FLOOD_LIGHT\ncolor.rgb*=mix(ao_shade,1.0,v_has_floodlight);\n#else\ncolor.rgb*=ao_shade;\n#endif\n#else\ncolor.rgb*=ao_shade;\n#endif\n#endif\n#ifdef LIGHTING_3D_MODE\nfloat flood_radiance=0.0;\n#ifdef FLOOD_LIGHT\nflood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;\n#endif\n#ifdef RENDER_SHADOWS\n#ifdef FLOOD_LIGHT\nfloat ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);\n#else\nfloat shadowed_lighting_factor;\n#ifdef RENDER_CUTOFF\nshadowed_lighting_factor=shadowed_light_factor_normal_opacity(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,v_cutoff_opacity);if (v_cutoff_opacity==0.0) {discard;}\n#else\nshadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);\n#endif\ncolor.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);\n#endif\n#else\ncolor.rgb=apply_lighting(color.rgb,normal);\n#ifdef FLOOD_LIGHT\ncolor.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);\n#endif\n#endif\ncolor.rgb=mix(color.rgb,v_flat.rgb,emissive_strength);color*=u_opacity;\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));\n#endif\n#ifdef INDICATOR_CUTOUT\ncolor=applyCutout(color);\n#endif\nglFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\n#include "_prelude_shadow.vertex.glsl"\n#include "_prelude_lighting.glsl"\nuniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;uniform float u_width_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;\n#ifdef RENDER_WALL_MODE\nin vec3 a_join_normal_inside;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\n#ifdef TERRAIN\nuniform int u_height_type;uniform int u_base_type;\n#endif\nuniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;\n#endif\n#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)\nout vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)\nout highp vec3 v_normal;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;out vec2 v_ao;\n#endif\n#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)\nout float v_flood_radius;out float v_has_floodlight;\n#endif\nout float v_height;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define highp float flood_light_wall_radius\n#pragma mapbox: define highp float line_width\n#pragma mapbox: define highp float emissive_strength\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize highp float flood_light_wall_radius\n#pragma mapbox: initialize highp float line_width\n#pragma mapbox: initialize highp float emissive_strength\nbase*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)\nv_normal=normal;\n#endif\nbase=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;\n#ifdef TERRAIN\nbool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);\n#else\nh=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat cutoff=1.0;vec3 scaled_pos=pos;\n#ifdef RENDER_CUTOFF\nvec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);cutoff=cutoff_opacity(u_cutoff_params,ground.z);if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;v_cutoff_opacity=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);\n#endif\nfloat hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff==0.0 && centroid_pos.x !=0.0) || (color.a==0.0));\n#ifdef RENDER_WALL_MODE\nvec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);scaled_pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;scaled_pos.xy-=a_join_normal_inside.z*wall_offset*0.5;\n#endif\ngl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;\n#ifdef RENDER_SHADOWS\nvec3 shd_pos0=pos;vec3 shd_pos1=pos;\n#ifdef NORMAL_OFFSET\nvec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();\n#endif\nv_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);\n#endif\nfloat NdotL=0.0;float colorvalue=0.0;\n#ifndef LIGHTING_3D_MODE\ncolorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}\n#endif\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\n#ifdef FLOOD_LIGHT\nfloat is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;\n#endif\nv_color=vec4(color.rgb,1.0);v_flat=vec4(linearProduct(color.rgb,vec3(calculate_NdotL(normal))),1.0);\n#else\nv_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;\n#endif\n#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)\nfloat roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}'),fillExtrusionDepth:Ir("in highp float v_depth;void main() {\n#ifndef DEPTH_TEXTURE\nglFragColor=pack_depth(v_depth);\n#endif\n}",'#include "_prelude_terrain.vertex.glsl"\nuniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_width_scale;uniform float u_vertical_scale;\n#ifdef TERRAIN\nuniform int u_height_type;uniform int u_base_type;\n#endif\nin vec4 a_pos_normal_ed;in vec2 a_centroid_pos;\n#ifdef RENDER_WALL_MODE\nin vec3 a_join_normal_inside;\n#endif\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp float line_width\n#pragma mapbox: define highp vec4 color\nout highp float v_depth;void main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp float line_width\n#pragma mapbox: initialize highp vec4 color\nbase*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nvec3 pos;\n#ifdef TERRAIN\nbool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;float ele=elevation(pos_nx.xy);float c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);float h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);\n#else\npos=vec3(pos_nx.xy,t > 0.0 ? height : base);\n#endif\n#ifdef RENDER_WALL_MODE\nvec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;pos.xy-=a_join_normal_inside.z*wall_offset*0.5;\n#endif\nfloat hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}'),fillExtrusionPattern:Ir('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform vec2 u_texsize;uniform sampler2D u_image;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;in vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nin vec3 v_normal;\n#endif\nin highp vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define mediump vec4 pattern\n#pragma mapbox: define highp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize highp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;\n#else\nout_color=out_color*v_lighting;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\n#ifdef INDICATOR_CUTOUT\nout_color=applyCutout(out_color);\n#endif\nglFragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\n#include "_prelude_lighting.glsl"\nuniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_width_scale;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;\n#ifdef RENDER_WALL_MODE\nin vec3 a_join_normal_inside;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\n#ifdef TERRAIN\nuniform int u_height_type;uniform int u_base_type;\n#endif\nout highp vec2 v_pos;out vec4 v_lighting;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;out vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nout vec3 v_normal;\n#endif\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump vec4 pattern\n#pragma mapbox: define highp float pixel_ratio\n#pragma mapbox: define highp float line_width\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize highp float pixel_ratio\n#pragma mapbox: initialize highp float line_width\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=z;vec3 p;float c_ele;\n#ifdef TERRAIN\nbool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;p=vec3(pos_nx.xy,h);\n#else\np=vec3(pos_nx.xy,z);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\n#ifdef RENDER_WALL_MODE\nvec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);p.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;p.xy-=a_join_normal_inside.z*wall_offset*0.5;\n#endif\nfloat hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\nNdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_normal=normal;\n#else\nv_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#endif \n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}'),groundShadow:Ir('#include "_prelude_shadow.fragment.glsl"\nprecision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;\n#ifdef FOG\nin float v_fog_opacity;\n#endif\nvoid main() {float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);\n#ifdef RENDER_CUTOFF\nshadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));\n#endif\n#ifdef FOG\nshadow=mix(shadow,vec3(1.0),v_fog_opacity);\n#endif\n#ifdef INDICATOR_CUTOUT\nshadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0)).r);\n#endif\nglFragColor=vec4(shadow,1.0);}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;\n#ifdef FOG\nout float v_fog_opacity;\n#endif\nvoid main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);\n#endif\n}'),fillExtrusionGroundEffect:Ir("uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;\n#ifdef SDF_SUBPASS\nin highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}\n#ifdef FOG\nin highp float v_fog;\n#endif\n#endif\nvoid main() {\n#ifdef CLEAR_SUBPASS\nvec4 color=vec4(1.0);\n#ifdef CLEAR_FROM_TEXTURE\ncolor=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));\n#endif\nglFragColor=color;\n#else\n#ifdef SDF_SUBPASS\nhighp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;\n#ifdef FOG\nfog=v_fog;\n#endif\n#ifdef RENDER_CUTOFF\nfog*=v_cutoff_opacity;\n#endif\nglFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));\n#else\nvec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);\n#ifdef OVERDRAW_INSPECTOR\ncolor=vec4(1.0);\n#endif\nglFragColor=color;\n#endif\nHANDLE_WIREFRAME_DEBUG;\n#endif\n}",'#include "_prelude_fog.vertex.glsl"\nin highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;\n#ifdef SDF_SUBPASS\nout highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;\n#ifdef FOG\nout highp float v_fog;\n#endif\n#endif\nuniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp float u_dynamic_offset;uniform highp vec2 u_ao;\n#pragma mapbox: define highp float flood_light_ground_radius\nconst float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {\n#pragma mapbox: initialize highp float flood_light_ground_radius\nvec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(u_dynamic_offset,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;\n#ifdef SDF_SUBPASS\nv_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);\n#ifdef FOG\nv_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);\n#endif\n#endif\nfloat hidden_by_landmark=0.0;\n#ifdef HAS_CENTROID\nhidden_by_landmark=a_hidden_by_landmark;\n#endif\nfloat isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));\n#ifdef RENDER_CUTOFF\nv_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);\n#endif\n}'),hillshadePrepare:Ir("precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}","uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Ir('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef LIGHTING_3D_MODE\nglFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);\n#endif\n#ifdef FOG\nglFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),line:Ir('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\n#include "_prelude_shadow.fragment.glsl"\nuniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform sampler2D u_dash_image;in vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform sampler2D u_gradient_image;\n#endif\n#ifdef RENDER_SHADOWS\nuniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;\n#endif\nfloat luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float border_width\n#pragma mapbox: define lowp vec4 border_color\nfloat linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float border_width\n#pragma mapbox: initialize lowp vec4 border_color\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\n#ifdef RENDER_LINE_DASH\nfloat sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);\n#endif\nhighp vec4 out_color;\n#ifdef RENDER_LINE_GRADIENT\nout_color=texture(u_gradient_image,v_uv.xy);\n#else\nout_color=color;\n#endif\nfloat trim_alpha=1.0;\n#ifdef RENDER_LINE_TRIM_OFFSET\nhighp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);out_color=mix(out_color,u_trim_color,transition_factor);trim_alpha=out_color.a;}\n#endif\nif (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}\n#ifdef RENDER_LINE_BORDER\nfloat edgeBlur=(border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color.rgb=mix(border_color.rgb*border_color.a*trim_alpha,out_color.rgb,smoothAlpha);}}\n#endif\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#ifdef RENDER_SHADOWS\nfloat light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);\n#endif\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nout_color*=(alpha*opacity);\n#ifdef INDICATOR_CUTOUT\nout_color=applyCutout(out_color);\n#endif\nglFragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_shadow.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\n#define EXTRUDE_SCALE 0.015873016\nin vec2 a_pos_normal;in vec4 a_data;\n#if defined(ELEVATED) || defined(ELEVATED_ROADS)\nin float a_z_offset;\n#endif\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nin highp vec4 a_packed;\n#endif\n#ifdef RENDER_LINE_DASH\nin float a_linesofar;\n#endif\nuniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;\n#ifdef ELEVATED\nuniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {\n#ifdef ELEVATION_REFERENCE_SEA\nreturn 0.0;\n#else\nreturn elevation(apos);\n#endif\n}\n#endif\nout vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform float u_image_height;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float border_width\n#pragma mapbox: define lowp vec4 border_color\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float border_width\n#pragma mapbox: initialize lowp vec4 border_color\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;\n#ifdef ELEVATED_ROADS\ngl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset+0.01*step(0.01,a_z_offset),1.0)+projected_extrude;\n#else\n#ifdef ELEVATED\nvec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;\n#ifdef CROSS_SLOPE_VERTICAL\nfloat top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);\n#else\n#ifdef CROSS_SLOPE_HORIZONTAL\nfloat ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;\n#else\nfloat ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;\n#endif\n#endif\ngl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);\n#else\ngl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);\n#endif\n#endif\n#ifdef ELEVATED_ROADS\n#ifdef RENDER_SHADOWS\nvec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;\n#ifdef NORMAL_OFFSET\nvec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();\n#endif\nv_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;\n#endif\n#endif\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));\n#else\nv_gamma_scale=1.0;\n#endif\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nfloat a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];\n#ifdef RENDER_LINE_GRADIENT\nhighp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);\n#else\nv_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);\n#endif\n#endif\n#ifdef RENDER_LINE_DASH\nfloat scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}'),linePattern:Ir('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\n#include "_prelude_shadow.fragment.glsl"\nuniform highp float u_device_pixel_ratio;uniform highp float u_alpha_discard_threshold;uniform highp vec2 u_texsize;uniform highp float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in highp float v_linesofar;in float v_gamma_scale;in float v_width;\n#ifdef RENDER_LINE_TRIM_OFFSET\nin highp vec4 v_uv;\n#endif\n#ifdef LINE_JOIN_NONE\nin vec2 v_pattern_data;\n#endif\n#ifdef RENDER_SHADOWS\nuniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;\n#endif\nuniform float u_emissive_strength;\n#pragma mapbox: define mediump vec4 pattern\n#pragma mapbox: define mediump float pixel_ratio\n#pragma mapbox: define mediump float blur\n#pragma mapbox: define mediump float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize mediump float pixel_ratio\n#pragma mapbox: initialize mediump float blur\n#pragma mapbox: initialize mediump float opacity\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;float pattern_size=display_size.x/u_tile_units_to_pixels;float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);highp float pattern_x=v_linesofar/pattern_size*aspect;highp float x=mod(pattern_x,1.0);highp float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;highp vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));highp vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);\n#ifdef RENDER_LINE_TRIM_OFFSET\nhighp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {color=vec4(0,0,0,0);}}\n#endif\n#ifdef LINE_JOIN_NONE\nfloat pattern_len=pattern_size/aspect;float segment_phase=pattern_len-mod(v_linesofar-v_pattern_data.x+pattern_len,pattern_len);float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}\n#endif\n#ifdef LIGHTING_3D_MODE\ncolor=apply_lighting_with_emission_ground(color,u_emissive_strength);\n#ifdef RENDER_SHADOWS\nfloat light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);\n#endif\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ncolor*=(alpha*opacity);if (u_alpha_discard_threshold !=0.0) {if (color.a < u_alpha_discard_threshold) {discard;}}\n#ifdef INDICATOR_CUTOUT\ncolor=applyCutout(color);\n#endif\nglFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_shadow.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\n#define scale 0.015873016\nin vec2 a_pos_normal;in vec4 a_data;\n#if defined(ELEVATED) || defined(ELEVATED_ROADS)\nin float a_z_offset;\n#endif\n#ifdef RENDER_LINE_TRIM_OFFSET\nin highp vec4 a_packed;\n#endif\nin highp float a_linesofar;\n#ifdef LINE_JOIN_NONE\nin highp vec3 a_pattern_data;out vec2 v_pattern_data;\n#endif\nuniform mat4 u_matrix;uniform float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform float u_device_pixel_ratio;\n#ifdef ELEVATED\nuniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {\n#ifdef ELEVATION_REFERENCE_SEA\nreturn 0.0;\n#else\nreturn elevation(apos);\n#endif\n}\n#endif\nout vec2 v_normal;out vec2 v_width2;out highp float v_linesofar;out float v_gamma_scale;out float v_width;\n#ifdef RENDER_LINE_TRIM_OFFSET\nout highp vec4 v_uv;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;\n#endif\n#pragma mapbox: define mediump float blur\n#pragma mapbox: define mediump float opacity\n#pragma mapbox: define mediump float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define mediump float floorwidth\n#pragma mapbox: define mediump vec4 pattern\n#pragma mapbox: define mediump float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize mediump float blur\n#pragma mapbox: initialize mediump float opacity\n#pragma mapbox: initialize mediump float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize mediump float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize mediump float pixel_ratio\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);vec2 dist=outset*a_extrude*scale;float u=0.5*a_direction;float t=1.0-abs(u);vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;\n#ifdef ELEVATED_ROADS\ngl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset+0.01*step(0.01,a_z_offset),1.0)+projected_extrude;\n#else\n#ifdef ELEVATED\nvec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;\n#ifdef CROSS_SLOPE_VERTICAL\nfloat top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);\n#else\n#ifdef CROSS_SLOPE_HORIZONTAL\nfloat ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;\n#else\nfloat ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;\n#endif\n#endif\ngl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);\n#else\ngl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);\n#endif\n#endif\n#ifdef ELEVATED_ROADS\n#ifdef RENDER_SHADOWS\nvec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;\n#ifdef NORMAL_OFFSET\nvec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();\n#endif\nv_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;\n#endif\n#endif\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));\n#else\nv_gamma_scale=1.0;\n#endif\n#ifdef RENDER_LINE_TRIM_OFFSET\nfloat a_uv_x=a_packed[0];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\n#ifdef LINE_JOIN_NONE\nv_width=floorwidth+ANTIALIASING;mediump float pixels_to_tile_units=1.0/u_tile_units_to_pixels;mediump float pixel_ratio_inverse=1.0/pixel_ratio;mediump float aspect=v_width/((pattern.w-pattern.y)*pixel_ratio_inverse);highp float subt_multiple=(pattern.z-pattern.x)*pixel_ratio_inverse*pixels_to_tile_units*aspect*32.0;highp float subt=floor(a_pattern_data.z/subt_multiple)*subt_multiple;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5*pixels_to_tile_units;v_linesofar=(a_pattern_data.z-subt)+a_linesofar+line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}'),raster:Ir('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\n#include "_prelude_raster_array.glsl"\nuniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;\n#ifdef PROJECTION_GLOBE_VIEW\nin float v_split_fade;\n#endif\nuniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;\n#ifndef RASTER_ARRAY\nuniform highp sampler2D u_image0;uniform sampler2D u_image1;\n#endif\n#ifdef RASTER_COLOR\nuniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;\n#endif\nvoid main() {vec4 color0,color1,color;vec2 value;\n#ifdef RASTER_COLOR\n#ifdef RASTER_ARRAY\n#ifdef RASTER_ARRAY_LINEAR\nvalue=mix(\nraTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t\n);\n#else\nvalue=mix(\nraTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t\n);\n#endif\nif (value.y > 0.0) value.x/=value.y;\n#else\ncolor=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);\n#endif\ncolor=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;\n#else\ncolor0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);\n#endif\ncolor.a*=u_opacity;\n#ifdef GLOBE_POLES\ncolor.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);\n#endif\nvec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;\n#endif\n#ifdef FOG\nhighp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));\n#endif\nglFragColor=vec4(out_color*color.a,color.a);\n#ifdef PROJECTION_GLOBE_VIEW\nglFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));\n#endif\n#ifdef RENDER_CUTOFF\nglFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);\n#endif\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;\n#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8\n#ifdef GLOBE_POLES\nin vec3 a_globe_pos;in vec2 a_uv;\n#else\nin vec2 a_pos;in vec2 a_texture_pos;\n#endif\nout vec2 v_pos0;out vec2 v_pos1;out float v_depth;\n#ifdef PROJECTION_GLOBE_VIEW\nout float v_split_fade;\n#endif\nvoid main() {vec2 uv;\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);\n#endif\n#else\nfloat w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    \nv_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n#else\ngl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n#endif\n#endif\nv_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;\n#ifdef RENDER_CUTOFF\nv_depth=gl_Position.z;\n#endif\n}'),rasterParticle:Ir('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;\n#endif\n#ifdef FOG\nhighp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));\n#endif\nglFragColor=vec4(out_color*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;\n#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8\nin vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n#else\nuv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n#endif\nv_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}'),rasterParticleDraw:Ir("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",'#include "_prelude_raster_particle.glsl"\nin float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(\nmod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-1.0,0,1);v_particle_speed=length(velocity);}gl_PointSize=1.0;}'),rasterParticleTexture:Ir("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:Ir('#include "_prelude_raster_particle.glsl"\nuniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;vec2 linearstep(vec2 edge0,vec2 edge1,vec2 x) {return  clamp((x-edge0)/(edge1-edge0),vec2(0),vec2(1));}const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp vec2 persist_rate=pow(\nlinearstep(vec2(-u_particle_pos_offset),vec2(0),pos)*linearstep(vec2(1.0+u_particle_pos_offset),vec2(1),pos),vec2(4)\n);highp vec2 per_frame_persist=pow(persist_rate,abs(dp)/u_particle_pos_offset);highp float drop_rate=1.0-per_frame_persist.x*per_frame_persist.y;drop_rate=any(greaterThanEqual(abs(pos-0.5),vec2(0.5+u_particle_pos_offset))) ? 1.0 : drop_rate;highp float drop=step(1.0-drop_rate-u_reset_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}',"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbol:Ir('#include "_prelude_lighting.glsl"\n#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;uniform lowp float u_scale_factor;\n#ifdef ICON_TRANSITION\nuniform float u_icon_transition;\n#endif\n#ifdef COLOR_ADJUSTMENT\nuniform mat4 u_color_adj_mat;\n#endif\nin vec2 v_tex_a;\n#ifdef ICON_TRANSITION\nin vec2 v_tex_b;\n#endif\nin float v_draw_halo;in vec3 v_gamma_scale_size_fade_opacity;\n#ifdef RENDER_TEXT_AND_SYMBOL\nin float is_sdf;in vec2 v_tex_a_icon;\n#endif\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n#pragma mapbox: define lowp float emissive_strength\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\n#pragma mapbox: initialize lowp float emissive_strength\nvec4 out_color;float fade_opacity=v_gamma_scale_size_fade_opacity[2];\n#ifdef RENDER_TEXT_AND_SYMBOL\nif (is_sdf==ICON) {vec2 tex_icon=v_tex_a_icon;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nreturn;}\n#endif\n#ifdef RENDER_SDF\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_gamma_scale_size_fade_opacity.x;float size=v_gamma_scale_size_fade_opacity.y;float fontScale=u_is_text ? size/24.0 : size;out_color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {out_color=halo_color;gamma=(halo_blur*u_scale_factor*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width*u_scale_factor/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,v_tex_a).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);out_color*=alpha;\n#else\n#ifdef ICON_TRANSITION\nvec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);\n#else\nout_color=texture(u_texture,v_tex_a);\n#endif\n#ifdef COLOR_ADJUSTMENT\nout_color=u_color_adj_mat*out_color;\n#endif\n#endif\nout_color*=opacity*fade_opacity;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,emissive_strength);\n#endif\nglFragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_terrain.vertex.glsl"\nin vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;\n#ifdef Z_OFFSET\nin float a_auto_z_offset;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_globe_anchor;in vec3 a_globe_normal;\n#endif\n#ifdef ICON_TRANSITION\nin vec2 a_texb;\n#endif\n#ifdef OCCLUSION_QUERIES\nin float a_occlusion_query_opacity;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_elevation_from_sea;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nout vec2 v_tex_a;\n#ifdef ICON_TRANSITION\nout vec2 v_tex_b;\n#endif\nout float v_draw_halo;out vec3 v_gamma_scale_size_fade_opacity;\n#ifdef RENDER_TEXT_AND_SYMBOL\nout float is_sdf;out vec2 v_tex_a_icon;\n#endif\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n#pragma mapbox: define lowp float emissive_strength\n#pragma mapbox: define lowp float occlusion_opacity\n#pragma mapbox: define lowp float z_offset\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\n#pragma mapbox: initialize lowp float emissive_strength\n#pragma mapbox: initialize lowp float occlusion_opacity\n#pragma mapbox: initialize lowp float z_offset\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=u_elevation_from_sea ? z_offset : z_offset+elevation(tile_anchor);\n#ifdef Z_OFFSET\ne+=a_auto_z_offset;\n#endif\nvec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;vec2 a;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;\n#else\noffsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;\n#endif\nvec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\n#ifdef Z_OFFSET\nz+=u_pitch_with_map ? a_auto_z_offset+(u_elevation_from_sea ? z_offset : z_offset) : 0.0;\n#else\nz+=u_pitch_with_map ? (u_elevation_from_sea ? z_offset : z_offset) : 0.0;\n#endif\nfloat occlusion_fade=globe_occlusion_fade;float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;\n#ifdef DEPTH_OCCLUSION\nfloat depth_occlusion=occlusionFadeMultiSample(projected_point);float depth_occlusion_multplier=mix(occlusion_opacity,1.0,depth_occlusion);out_fade_opacity*=depth_occlusion_multplier;\n#endif\n#ifdef OCCLUSION_QUERIES\nfloat occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;\n#endif\nfloat alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);\n#endif\nfloat gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_gamma_scale_size_fade_opacity=vec3(gamma_scale,size,out_fade_opacity);v_tex_a=a_tex/u_texsize;\n#ifdef RENDER_TEXT_AND_SYMBOL\nis_sdf=a_size[0]-2.0*a_size_min;v_tex_a_icon=a_tex/u_texsize_icon;\n#endif\n#ifdef ICON_TRANSITION\nv_tex_b=a_texb/u_texsize;\n#endif\n}'),terrainRaster:Ir('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_shadow.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform sampler2D u_image0;in vec2 v_pos0;\n#ifdef FOG\nin float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nin vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;\n#endif\nuniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;\n#ifdef LIGHTING_3D_MODE\nconst vec3 normal=vec3(0.0,0.0,1.0);\n#ifdef RENDER_SHADOWS\nfloat cutoffOpacity=1.0;\n#ifdef RENDER_CUTOFF\ncutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);\n#endif\n#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS\nvec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;\n#else\nfloat lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));\n#endif\n#else\nfloat lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);\n#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS\ncolor.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;\n#endif\n#endif\n#else\ncolor=image_color;\n#endif\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#else\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\n#endif\nglFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\nuniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;\n#ifdef FOG\nout float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;\n#endif\nvoid main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\nv_fog_pos=fog_position(decodedPos);\n#else\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n#endif\n#ifdef RENDER_SHADOWS\nvec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);\n#endif\n}'),terrainDepth:Ir("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",'#include "_prelude_terrain.vertex.glsl"\nuniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}'),skybox:Ir('#include "_prelude_fog.fragment.glsl"\nin lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\n}',yr),skyboxGradient:Ir('#include "_prelude_fog.fragment.glsl"\nin highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);glFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\n}',yr),skyboxCapture:Ir("\nin highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}","in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Ir('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;\n#ifndef FOG\nuniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;\n#endif\nvoid main() {vec4 color;\n#ifdef CUSTOM_ANTIALIASING\nvec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);\n#ifdef LIGHTING_3D_MODE\n#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS\nraster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(raster.rgb*antialias,antialias);\n#else\nraster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);\n#endif\n#else\ncolor=vec4(raster.rgb*antialias,raster.a*antialias);\n#endif\n#else\ncolor=texture(u_image0,v_pos0);\n#ifdef LIGHTING_3D_MODE\n#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS\ncolor=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;\n#else\ncolor=apply_lighting_ground(color);\n#endif\n#endif\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ncolor*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\nuniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;\n#ifdef GLOBE_POLES\nin vec3 a_globe_pos;in vec2 a_uv;\n#else\nin vec2 a_pos;\n#endif\nout vec2 v_pos0;void main() {\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;vec2 uv=a_uv;\n#else\nfloat tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);\n#endif\nv_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;\n#ifdef GLOBE_POLES\nvec3 up_vector=globe_derived_up_vector;\n#else\nvec3 up_vector=elevationVector(tile_pos);\n#endif\nfloat height=elevation(tile_pos);globe_pos+=up_vector*height;\n#ifndef GLOBE_POLES\nglobe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;\n#endif\n#ifdef GLOBE_POLES\nvec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);\n#else\nvec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);\n#endif\ngl_Position=u_proj_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n}'),globeAtmosphere:Ir('#include "_prelude_fog.fragment.glsl"\nuniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;\n#ifdef PROJECTION_GLOBE_VIEW\nglobe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {\n#ifdef ALPHA_PASS\nglFragColor=vec4(0,0,0,0);return;\n#else\n#ifdef NATIVE\nglFragColor=vec4(1,1,1,1);\n#else\nglFragColor=vec4(0,0,0,1);\n#endif\nreturn;\n#endif\n}\n#endif\nhighp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?\n0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;\n#ifdef PROJECTION_GLOBE_VIEW\nhighp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?\nPI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);\n#else\nhorizon_angle=horizon_angle_mercator;\n#endif\nhorizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;\n#ifdef ALPHA_PASS\nfloat a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);\n#else\nvec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;\n#ifndef NATIVE\nc=dither(c,gl_FragCoord.xy+u_temporal_offset);\n#endif\nglFragColor=vec4(c*t,t);\n#endif\n}',"in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(\nmix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}"),model:Ir('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_shadow.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;\n#ifdef RENDER_SHADOWS\nin highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;\n#endif\n#ifdef OCCLUSION_TEXTURE_TRANSFORM\nuniform vec4 u_occlusionTextureTransform;\n#endif\n#pragma mapbox: define-attribute highp vec3 normal_3f\n#pragma mapbox: define-attribute highp vec3 color_3f\n#pragma mapbox: define-attribute highp vec4 color_4f\n#pragma mapbox: define-attribute highp vec2 uv_2f\n#pragma mapbox: initialize-attribute highp vec3 normal_3f\n#pragma mapbox: initialize-attribute highp vec3 color_3f\n#pragma mapbox: initialize-attribute highp vec4 color_4f\n#pragma mapbox: initialize-attribute highp vec2 uv_2f\n#ifdef HAS_ATTRIBUTE_a_pbr\nin lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;\n#endif\n#ifdef HAS_TEXTURE_u_baseColorTexture\nuniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;\n#endif\n#ifdef HAS_TEXTURE_u_metallicRoughnessTexture\nuniform sampler2D u_metallicRoughnessTexture;\n#endif\n#ifdef HAS_TEXTURE_u_occlusionTexture\nuniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;\n#endif\n#ifdef HAS_TEXTURE_u_normalTexture\nuniform sampler2D u_normalTexture;\n#endif\n#ifdef HAS_TEXTURE_u_emissionTexture\nuniform sampler2D u_emissionTexture;\n#endif\n#ifdef APPLY_LUT_ON_GPU\nuniform highp sampler3D u_lutTexture;\n#endif\n#ifdef TERRAIN_FRAGMENT_OCCLUSION\nin highp float v_depth;uniform highp sampler2D u_depthTexture;uniform highp vec2 u_inv_depth_size;uniform highp vec2 u_depth_range_unpack;\n#ifdef DEPTH_D24\nhighp float unpack_depth(highp float depth) {return  depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}\n#else\nhighp float unpack_depth_rgba(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}\n#endif\nbool isOccluded() {highp vec2 coord=gl_FragCoord.xy*u_inv_depth_size;\n#ifdef DEPTH_D24\nhighp float depth=unpack_depth(texture(u_depthTexture,coord).r);\n#else\nhighp float depth=unpack_depth_rgba(texture(u_depthTexture,coord));\n#endif\nreturn v_depth > depth+0.0005;}\n#endif\n#define saturate(_x) clamp(_x,0.,1.)\nvec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)\n{\n#ifdef LIGHTING_3D_MODE\nvec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;\n#ifdef RENDER_SHADOWS\nlighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);\n#else\nlighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));\n#endif\nreturn apply_lighting(albedo,transformed_normal,lighting_factor);\n#else\nvec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;\n#endif\n}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;\n#ifdef HAS_ATTRIBUTE_a_color_3f\nalbedo*=vec4(color_3f,1.0);\n#endif\n#ifdef HAS_ATTRIBUTE_a_pbr\n#else\n#ifdef HAS_ATTRIBUTE_a_color_4f\nalbedo*=color_4f;\n#endif\n#endif\n#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)\nvec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}\n#ifdef UNPREMULT_TEXTURE_IN_SHADER\nif(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;\n#endif\nif(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}\n#endif\nvec4 color=vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);\n#ifdef APPLY_LUT_ON_GPU\ncolor=applyLUT(u_lutTexture,color);\n#endif\nreturn color;}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {\n#ifdef HAS_TEXTURE_u_normalTexture\nhighp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;\n#else\nreturn mat3(1.0);\n#endif\n}highp vec3 getNormal(){highp vec3 n;\n#ifdef HAS_ATTRIBUTE_a_normal_3f\nn=normalize(normal_3f);\n#else\nhighp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;\n#endif\n#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)\nvec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);\n#endif\nreturn n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;\n#ifdef HAS_ATTRIBUTE_a_pbr\nmat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;\n#endif\n#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) \nvec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;\n#endif\nconst float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)\n{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)\n{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)\n{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)\n{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)\n{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)\n{\n#ifdef LIGHTING_3D_MODE\nreturn mat.diffuseColor;\n#else\nreturn mat.diffuseColor/PI;\n#endif\n}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)\n{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)\n{vec3 env_light=vec3(0.65,0.65,0.65);\n#ifdef LIGHTING_3D_MODE\nfloat ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;\n#endif\nvec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)\n{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;\n#ifdef RENDER_SHADOWS\nlighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);\n#else\nlighting_factor=NdotL;\n#endif\nvec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;\n#if !defined(LIGHTING_3D_MODE)\nconst vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);\n#endif\ncolor*=intensityFactor;return color;}void main() {\n#ifdef TERRAIN_FRAGMENT_OCCLUSION\nif (isOccluded()) {discard;}\n#endif\nvec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;\n#ifdef LIGHTING_3D_MODE\nlightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;\n#endif\nvec4 finalColor;\n#ifdef DIFFUSE_SHADED\nvec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);\n#ifdef HAS_TEXTURE_u_occlusionTexture\nfloat ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;\n#endif\nfinalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;\n#else\nMaterial mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;\n#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)\n#ifdef OCCLUSION_TEXTURE_TRANSFORM\nvec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;\n#else\nvec2 uv=uv_2f;\n#endif\nao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;\n#endif\nvec4 emissive=u_emissiveFactor;\n#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)\nemissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);\n#endif\n#ifdef APPLY_LUT_ON_GPU\nfloat emissiveFactorLength=max(length(u_emissiveFactor.rgb),0.001);emissive.rgb=sRGBToLinear(applyLUT(u_lutTexture,linearTosRGB(emissive.rgb/emissiveFactorLength).rbg))*emissiveFactorLength;\n#endif\ncolor+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;\n#ifdef HAS_ATTRIBUTE_a_pbr\nfloat resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);vec3 color_mix=v_color_mix.rgb;\n#ifdef APPLY_LUT_ON_GPU\ncolor_mix=applyLUT(u_lutTexture,color_mix);\n#endif\ncolor=mix(color,color_mix,min(1.0,resEmission));\n#ifdef HAS_ATTRIBUTE_a_color_4f\nfloat distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);\n#endif\n#endif\nvec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);\n#endif\n#ifdef FOG\nfinalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));\n#endif\n#ifdef RENDER_CUTOFF\nfinalColor*=v_cutoff_opacity;\n#endif\n#ifdef INDICATOR_CUTOUT\nfinalColor=applyCutout(finalColor);\n#endif\nglFragColor=finalColor;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_shadow.vertex.glsl"\nin vec3 a_pos_3f;\n#pragma mapbox: define-attribute highp vec3 normal_3f\n#pragma mapbox: define-attribute highp vec2 uv_2f\n#pragma mapbox: define-attribute highp vec3 color_3f\n#pragma mapbox: define-attribute highp vec4 color_4f\n#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr\n#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength\nuniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;\n#ifdef INSTANCED_ARRAYS\nin vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;\n#else\nuniform highp mat4 u_normal_matrix;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;\n#endif\nout vec4 v_position_height;out lowp vec4 v_color_mix;\n#ifdef TERRAIN_FRAGMENT_OCCLUSION\nout highp float v_depth;\n#endif\n#ifdef HAS_ATTRIBUTE_a_pbr\nout lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;\n#endif\nvec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {\n#pragma mapbox: initialize-attribute highp vec3 normal_3f\n#pragma mapbox: initialize-attribute highp vec2 uv_2f\n#pragma mapbox: initialize-attribute highp vec3 color_3f\n#pragma mapbox: initialize-attribute highp vec4 color_4f\n#pragma mapbox: initialize-attribute-custom highp vec4 pbr\n#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength\nhighp mat4 normal_matrix;\n#ifdef INSTANCED_ARRAYS\nnormal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);\n#else\nnormal_matrix=u_normal_matrix;\n#endif\nvec3 local_pos;mat3 rs;\n#ifdef MODEL_POSITION_ON_GPU\nvec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float hidden=float(pos_a.x > EXTENT);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=mix(u_matrix*pos,AWAY,hidden);pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;\n#else\nlocal_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);\n#endif\nv_position_height.w=a_pos_3f.z;\n#ifdef HAS_ATTRIBUTE_a_pbr\nvec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(local_pos);\n#endif\n#ifdef RENDER_CUTOFF\nv_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);\n#endif\n#ifdef TERRAIN_FRAGMENT_OCCLUSION\nv_depth=gl_Position.z/gl_Position.w;\n#endif\n#ifdef HAS_ATTRIBUTE_a_normal_3f\n#ifdef MODEL_POSITION_ON_GPU\nfloat x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);\n#else\nnormal_3f=vec3(normal_matrix*vec4(normal_3f,0));\n#endif\n#endif\n#ifdef HAS_ATTRIBUTE_a_pbr\n#ifdef HAS_ATTRIBUTE_a_color_4f\nv_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);\n#endif\n#endif\n#ifdef RENDER_SHADOWS\nvec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);\n#ifdef NORMAL_OFFSET\n#ifdef HAS_ATTRIBUTE_a_normal_3f\n#ifdef MODEL_POSITION_ON_GPU\nvec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();\n#else\nvec3 offset=shadow_normal_offset_model(normal_3f);shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();\n#endif\n#endif\n#endif\nv_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;\n#endif\n}'),modelDepth:Ir("in highp float v_depth;void main() {\n#ifndef DEPTH_TEXTURE\nglFragColor=pack_depth(v_depth);\n#endif\n}","in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;\n#ifdef MODEL_POSITION_ON_GPU\n#ifdef INSTANCED_ARRAYS\nin vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;\n#else\nuniform highp mat4 u_instance;\n#endif\nuniform highp mat4 u_node_matrix;\n#endif\nvoid main() {\n#ifdef MODEL_POSITION_ON_GPU\nhighp mat4 instance;\n#ifdef INSTANCED_ARRAYS\ninstance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);\n#else\ninstance=u_instance;\n#endif\nvec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float hidden=float(pos_a.x > EXTENT);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=mix(u_matrix*pos,AWAY,hidden);\n#else\ngl_Position=u_matrix*vec4(a_pos_3f,1);\n#endif\nv_depth=gl_Position.z/gl_Position.w;}"),stars:Ir("in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)\n{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}","\nin vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}"),snowParticle:Ir("in highp vec2 uv;in highp float alphaMultiplier;uniform vec4 u_particleColor;uniform vec2 u_simpleShapeParameters;void main() {float t=clamp((length(uv)-u_simpleShapeParameters.x)/(1.0-u_simpleShapeParameters.x),0.0,1.0);float alpha=1.0-pow(t,pow(10.0,u_simpleShapeParameters.y));alpha*=alphaMultiplier;alpha*=u_particleColor.a;vec3 color=u_particleColor.rgb*alpha;glFragColor=vec4(color,alpha) ;HANDLE_WIREFRAME_DEBUG;}","\nin highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_snowParticleData;in highp vec4 a_snowParticleDataHorizontalOscillation;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform vec2 u_screenSize;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; \nuniform float u_velocity;uniform vec3 u_direction;uniform float u_horizontalOscillationRadius; \nuniform float u_horizontalOscillationRate; \nuniform float u_billboardSize;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;out highp vec2 uv;out highp float alphaMultiplier;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos.xyz*=halfBoxSize;pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_snowParticleData.z;float coneAngleHeadingRad=a_snowParticleData.w*radians(360.0);vec3 localZ=normalize(u_direction);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 direction;direction.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.z=cos(coneAnglePichRad);direction=normalize(direction);vec3 simPosLocal=vec3(0,0,0);float velocityScale=(1.0+3.0*a_snowParticleData.y)*u_velocity;simPosLocal+=direction*velocityScale*u_time;float horizontalOscillationRadius=u_horizontalOscillationRadius*a_snowParticleDataHorizontalOscillation.x;float horizontalOscillationAngle=u_horizontalOscillationRate*u_time*(-1.0+2.0*a_snowParticleDataHorizontalOscillation.y);simPosLocal.xy+=horizontalOscillationRadius*vec2(cos(horizontalOscillationAngle),sin(horizontalOscillationAngle));vec3 simPos=localX*simPosLocal.x+\nlocalY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);float clipZ=-u_cam_pos.z+pos.z;vec4 posView=u_modelview*vec4(pos,1.0);float size=u_billboardSize;alphaMultiplier=1.0;vec4 posScreen=u_projection*posView;posScreen/=posScreen.w;posScreen.xy=vec2(0.5)+posScreen.xy*0.5;posScreen.xy*=u_screenSize;vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=u_screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-posScreen.xy)/(0.5*u_screenSize));screenDist+=a_snowParticleData.x*u_thinningParticleOffset;float scaleFactorMode=0.0;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);if (a_snowParticleData.x < u_thinningAffectedRatio) {scaleFactorMode=1.0-thinningFadeRatio;alphaMultiplier=thinningFadeRatio;}}vec4 posScreen1=u_projection*vec4(posView.x-size,posView.yzw);posScreen1/=posScreen1.w;vec4 posScreen2=u_projection*vec4(posView.x+size,posView.yzw);posScreen2/=posScreen2.w;posScreen1.xy=vec2(0.5)+posScreen1.xy*0.5;posScreen1.xy*=u_screenSize;posScreen2.xy=vec2(0.5)+posScreen2.xy*0.5;posScreen2.xy*=u_screenSize;float screenLength=length(posScreen1.xy-posScreen2.xy);float screenEpsilon=3.0;float scaleFactor=1.0;if (screenLength < screenEpsilon) {scaleFactor=screenEpsilon/max(screenLength,0.01);scaleFactor=mix(scaleFactor,1.0,scaleFactorMode);}float screenEpsilon2=15.0;if (screenLength > screenEpsilon2) {scaleFactor=screenEpsilon2/max(screenLength,0.01);}size*=scaleFactor;vec2 right=size*vec2(1,0);vec2 up=size*vec2(0,1);posView.xy+=right*a_uv.x;posView.xy+=up*a_uv.y;uv=a_uv;gl_Position=u_projection*posView;}"),rainParticle:Ir("in highp vec2 uv;in highp float particleRandomValue;uniform sampler2D u_texScreen;uniform float u_distortionStrength;uniform vec4 u_color;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;uniform float u_shapeDirectionalPower;uniform float u_mode;void main() {vec2 st=uv*0.5+vec2(0.5);vec2 uvm=uv;uvm.y=-1.0+2.0*pow(st.y,u_shapeDirectionalPower);float shape=clamp(1.0-length(uvm),0.0,1.0);float alpha=abs(shape)*u_color.a;vec2 screenSize=vec2(textureSize(u_texScreen,0));vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-gl_FragCoord.xy)/(0.5*screenSize));screenDist+=(0.5+0.5*particleRandomValue)*u_thinningParticleOffset;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;float thinningAlpha=1.0;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);thinningAlpha*=thinningFadeRatio;}vec2 offsetXY=normalize(uvm)*abs(shape);vec2 stScreen=(gl_FragCoord.xy+offsetXY*u_distortionStrength*thinningAlpha)/screenSize;vec3 colorScreen=texture(u_texScreen,stScreen).rgb;alpha*=thinningAlpha;glFragColor=mix(vec4(colorScreen,1.0),vec4(u_color.rgb*alpha,alpha),u_mode);HANDLE_WIREFRAME_DEBUG;}","\nin highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_rainParticleData;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; \nuniform float u_velocity; \nuniform vec2 u_rainDropletSize;uniform vec3 u_rainDirection;out highp vec2 uv;out highp float particleRandomValue;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos*=halfBoxSize; \npos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_rainParticleData.z;float coneAngleHeadingRad=a_rainParticleData.w*radians(360.0);vec3 localZ=normalize(u_rainDirection);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 directionLocal;directionLocal.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.z=cos(coneAnglePichRad);directionLocal=normalize(directionLocal);vec3 directionWorld=localX*directionLocal.x+localY*directionLocal.y+localZ*directionLocal.z;float velocityScale=(1.0+3.0*a_rainParticleData.y)*u_velocity;vec3 simPosLocal=vec3(0,0,0);simPosLocal+=directionLocal*velocityScale*u_time;vec3 simPos=localX*simPosLocal.x+\nlocalY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);vec4 posView=u_modelview*vec4(pos,1.0);vec3 directionView=normalize((u_modelview*vec4(directionWorld,0.0)).xyz);vec3 side=cross(directionView,normalize(posView.xyz));posView.xyz+=side*a_uv.x*u_rainDropletSize.x;posView.xyz+=directionView*a_uv.y*u_rainDropletSize.y;uv=a_uv;particleRandomValue=a_rainParticleData.x;gl_Position=u_projection*posView;}"),occlusion:Ir("uniform vec4 u_color;void main() {glFragColor=u_color;}",'#include "_prelude_terrain.vertex.glsl"\nin highp vec2 a_offset_xy;uniform highp vec3 u_anchorPos;uniform mat4 u_matrix;uniform vec2 u_screenSizePx;uniform vec2 u_occluderSizePx;void main() {vec3 world_pos=u_anchorPos;\n#ifdef TERRAIN\nfloat e=elevation(world_pos.xy);world_pos.z+=e;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1.0);projected_point.xy+=projected_point.w*a_offset_xy*0.5*u_occluderSizePx/u_screenSizePx;gl_Position=projected_point;}')};function jr(e,t){const n=e.replace(/\s*\/\/[^\n]*\n/g,"\n").split("\n");for(let r of n)if(r=r.trim(),"#"===r[0]&&r.includes("if")&&!r.includes("endif")){r=r.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const e=r.split(" ");for(const n of e)t.includes(n)||t.push(n)}}function Ir(e,t){const n=/#include\s+"([^"]+)"/g,r=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let i=t.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);i&&(i=i.map((e=>{const t=e.split(" ");return t[t.length-1]})),i=[...new Set(i)]);const o={},a=[],s=[];if(e=e.replace(n,((e,t)=>(s.push(t),""))),(t=t.replace(n,((e,t)=>(a.push(t),"")))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let l=[...Er];jr(e,l),jr(t,l);for(const c of[...a,...s])Ar[c]||console.error("Undefined include: ".concat(c)),Mr[c]||(Mr[c]=[],jr(Ar[c],Mr[c])),l=[...l,...Mr[c]];return{fragmentSource:e=e.replace(r,((e,t,n,r,i)=>(o[i]=!0,"define"===t?"\n#ifndef HAS_UNIFORM_u_".concat(i,"\nin ").concat(n," ").concat(r," ").concat(i,";\n#else\nuniform ").concat(n," ").concat(r," u_").concat(i,";\n#endif\n"):"initialize"===t?"\n#ifdef HAS_UNIFORM_u_".concat(i,"\n    ").concat(n," ").concat(r," ").concat(i," = u_").concat(i,";\n#endif\n"):"define-attribute"===t?"\n#ifdef HAS_ATTRIBUTE_a_".concat(i,"\n    in ").concat(n," ").concat(r," ").concat(i,";\n#endif\n"):"initialize-attribute"===t?"":void 0))),vertexSource:t=t.replace(r,((e,t,n,r,i)=>{const a="float"===r?"vec2":r,s=i.match(/color/)?"color":a;return"define-attribute-vertex-shader-only"===t?"\n#ifdef HAS_ATTRIBUTE_a_".concat(i,"\nin ").concat(n," ").concat(r," a_").concat(i,";\n#endif\n"):o[i]?"define"===t?"\n#ifndef HAS_UNIFORM_u_".concat(i,"\nuniform lowp float u_").concat(i,"_t;\nin ").concat(n," ").concat(a," a_").concat(i,";\nout ").concat(n," ").concat(r," ").concat(i,";\n#else\nuniform ").concat(n," ").concat(r," u_").concat(i,";\n#endif\n"):"initialize"===t?"vec4"===s?"\n#ifndef HAS_UNIFORM_u_".concat(i,"\n    ").concat(i," = a_").concat(i,";\n#else\n    ").concat(n," ").concat(r," ").concat(i," = u_").concat(i,";\n#endif\n"):"\n#ifndef HAS_UNIFORM_u_".concat(i,"\n    ").concat(i," = unpack_mix_").concat(s,"(a_").concat(i,", u_").concat(i,"_t);\n#else\n    ").concat(n," ").concat(r," ").concat(i," = u_").concat(i,";\n#endif\n"):"define-attribute"===t?"\n#ifdef HAS_ATTRIBUTE_a_".concat(i,"\n    in ").concat(n," ").concat(r," a_").concat(i,";\n    out ").concat(n," ").concat(r," ").concat(i,";\n#endif\n"):"initialize-attribute"===t?"\n#ifdef HAS_ATTRIBUTE_a_".concat(i,"\n    ").concat(i," = a_").concat(i,";\n#endif\n"):void 0:"define"===t?"\n#ifndef HAS_UNIFORM_u_".concat(i,"\nuniform lowp float u_").concat(i,"_t;\nin ").concat(n," ").concat(a," a_").concat(i,";\n#else\nuniform ").concat(n," ").concat(r," u_").concat(i,";\n#endif\n"):"define-instanced"===t?"mat4"===s?"\n#ifdef INSTANCED_ARRAYS\nin vec4 a_".concat(i,"0;\nin vec4 a_").concat(i,"1;\nin vec4 a_").concat(i,"2;\nin vec4 a_").concat(i,"3;\n#else\nuniform ").concat(n," ").concat(r," u_").concat(i,";\n#endif\n"):"\n#ifdef INSTANCED_ARRAYS\nin ".concat(n," ").concat(a," a_").concat(i,";\n#else\nuniform ").concat(n," ").concat(r," u_").concat(i,";\n#endif\n"):"initialize-attribute-custom"===t?"\n#ifdef HAS_ATTRIBUTE_a_".concat(i,"\n    ").concat(n," ").concat(r," ").concat(i," = a_").concat(i,";\n#endif\n"):"vec4"===s?"\n#ifndef HAS_UNIFORM_u_".concat(i,"\n    ").concat(n," ").concat(r," ").concat(i," = a_").concat(i,";\n#else\n    ").concat(n," ").concat(r," ").concat(i," = u_").concat(i,";\n#endif\n"):"\n#ifndef HAS_UNIFORM_u_".concat(i,"\n    ").concat(n," ").concat(r," ").concat(i," = unpack_mix_").concat(s,"(a_").concat(i,", u_").concat(i,"_t);\n#else\n    ").concat(n," ").concat(r," ").concat(i," = u_").concat(i,";\n#endif\n")})),staticAttributes:i,usedDefines:l,vertexIncludes:a,fragmentIncludes:s}}class Or{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(e,t,n,r,i,o,a,s){this.context=e;let l=this.boundPaintVertexBuffers.length!==r.length;for(let u=0;!l&&u<r.length;u++)this.boundPaintVertexBuffers[u]!==r[u]&&(l=!0);let c=this.boundDynamicVertexBuffers.length!==a.length;for(let u=0;!c&&u<a.length;u++)this.boundDynamicVertexBuffers[u]!==a[u]&&(c=!0);if(!this.vao||this.boundProgram!==t||this.boundLayoutVertexBuffer!==n||l||c||this.boundIndexBuffer!==i||this.boundVertexOffset!==o)this.freshBind(t,n,r,i,o,a,s);else{e.bindVertexArrayOES.set(this.vao);for(const n of a)n&&(n.bind(),s&&n.instanceCount&&n.setVertexAttribDivisor(e.gl,t,s));i&&i.dynamicDraw&&i.bind()}}freshBind(e,t,n,r,i,o,a){const s=e.numAttributes,l=this.context,c=l.gl;this.vao&&this.destroy(),this.vao=l.gl.createVertexArray(),l.bindVertexArrayOES.set(this.vao),this.boundProgram=e,this.boundLayoutVertexBuffer=t,this.boundPaintVertexBuffers=n,this.boundIndexBuffer=r,this.boundVertexOffset=i,this.boundDynamicVertexBuffers=o,t.enableAttributes(c,e),t.bind(),t.setVertexAttribPointers(c,e,i);for(const u of n)u.enableAttributes(c,e),u.bind(),u.setVertexAttribPointers(c,e,i);for(const u of o)u&&(u.enableAttributes(c,e),u.bind(),u.setVertexAttribPointers(c,e,i),a&&u.instanceCount&&u.setVertexAttribDivisor(c,e,a));r&&r.bind(),l.currentNumAttributes=s}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function Nr(t,n){const r=Math.pow(2,n.canonical.z),i=n.canonical.y;return[new e.a5(0,i/r).toLngLat().lat,new e.a5(0,(i+1)/r).toLngLat().lat]}function Dr(t,n,r,i,o,a,s){const l=t.context,c=l.gl,u=r.hillshadeFBO;if(!u)return;t.prepareDrawTile();const h=t.isTileAffectedByFog(n),d=t.getOrCreateProgram("hillshade",{overrideFog:h});l.activeTexture.set(c.TEXTURE0),c.bindTexture(c.TEXTURE_2D,u.colorAttachment.get());const p=((t,n,r,i)=>{const o=r.paint.get("hillshade-shadow-color"),a=r.paint.get("hillshade-highlight-color"),s=r.paint.get("hillshade-accent-color"),l=r.paint.get("hillshade-emissive-strength");let c=e.bC(r.paint.get("hillshade-illumination-direction"));if("viewport"===r.paint.get("hillshade-illumination-anchor"))c-=t.transform.angle;else if(t.style&&t.style.enable3dLights()&&t.style.directionalLight){const n=t.style.directionalLight.properties.get("direction"),r=e.c8(n.x,n.y,n.z);c=e.bC(r[1])}const u=!t.options.moving;return{u_matrix:i||t.transform.calculateProjMatrix(n.tileID.toUnwrapped(),u),u_image:0,u_latrange:Nr(0,n.tileID),u_light:[r.paint.get("hillshade-exaggeration"),c],u_shadow:o.toRenderColor(r.lut),u_highlight:a.toRenderColor(r.lut),u_emissive_strength:l,u_accent:s.toRenderColor(r.lut)}})(t,r,i,t.terrain?n.projMatrix:null);t.uploadCommonUniforms(l,d,n.toUnwrapped());const{tileBoundsBuffer:f,tileBoundsIndexBuffer:m,tileBoundsSegments:g}=t.getTileBoundsBuffers(r);d.draw(t,c.TRIANGLES,o,a,s,Bn.disabled,p,i.id,f,m,g)}function Lr(t,n,r){if(!n.needsDEMTextureUpload)return;const i=t.context,o=i.gl;i.pixelStoreUnpackPremultiplyAlpha.set(!1),n.demTexture=n.demTexture||t.getTileTexture(r.stride);const a=r.getPixels();n.demTexture?n.demTexture.update(a,{premultiply:!1}):n.demTexture=new e.T(i,a,o.R32F,{premultiply:!1}),n.needsDEMTextureUpload=!1}function zr(t,n,r){const i=t.context,o=i.gl;if(!n.dem)return;const a=n.dem;if(i.activeTexture.set(o.TEXTURE1),Lr(t,n,a),!n.demTexture)return;n.demTexture.bind(o.NEAREST,o.CLAMP_TO_EDGE);const s=a.dim;i.activeTexture.set(o.TEXTURE0);let l=n.hillshadeFBO;if(!l){const t=new e.T(i,{width:s,height:s,data:null},o.RGBA8);t.bind(o.LINEAR,o.CLAMP_TO_EDGE),l=n.hillshadeFBO=i.createFramebuffer(s,s,!0,"renderbuffer"),l.colorAttachment.set(t.texture)}i.bindFramebuffer.set(l.framebuffer),i.viewport.set([0,0,s,s]);const{tileBoundsBuffer:c,tileBoundsIndexBuffer:u,tileBoundsSegments:h}=t.getMercatorTileBoundsBuffers(),d=[];t.linearFloatFilteringSupported()&&d.push("TERRAIN_DEM_FLOAT_FORMAT"),t.getOrCreateProgram("hillshadePrepare",{defines:d}).draw(t,o.TRIANGLES,Dn.disabled,zn.disabled,Nn.unblended,Bn.disabled,((t,n)=>{const r=n.stride,i=e.a6.mat4.create();return e.a6.mat4.ortho(i,0,e.ab,-e.ab,0,0,1),e.a6.mat4.translate(i,i,[0,-e.ab,0]),{u_matrix:i,u_image:1,u_dimension:[r,r],u_zoom:t.overscaledZ}})(n.tileID,a),r.id,c,u,h),n.needsHillshadePrepare=!1}class Rr{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Fr extends Rr{getDefault(){return e.bA.transparent}set(e){const t=this.current;(e.r!==t.r||e.g!==t.g||e.b!==t.b||e.a!==t.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class Br extends Rr{getDefault(){return 1}set(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}class Vr extends Rr{getDefault(){return 0}set(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}class Ur extends Rr{getDefault(){return[!0,!0,!0,!0]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||e[3]!==t[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class Gr extends Rr{getDefault(){return!0}set(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}class Hr extends Rr{getDefault(){return 255}set(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}class Zr extends Rr{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){const t=this.current;(e.func!==t.func||e.ref!==t.ref||e.mask!==t.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}class qr extends Rr{getDefault(){const e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}class Wr extends Rr{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;e?t.enable(t.STENCIL_TEST):t.disable(t.STENCIL_TEST),this.current=e,this.dirty=!1}}class Xr extends Rr{getDefault(){return[0,1]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}class Yr extends Rr{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;e?t.enable(t.DEPTH_TEST):t.disable(t.DEPTH_TEST),this.current=e,this.dirty=!1}}class Kr extends Rr{getDefault(){return this.gl.LESS}set(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}class Jr extends Rr{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;e?t.enable(t.BLEND):t.disable(t.BLEND),this.current=e,this.dirty=!1}}class Qr extends Rr{getDefault(){const e=this.gl;return[e.ONE,e.ZERO,e.ONE,e.ZERO]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||e[3]!==t[3]||this.dirty)&&(this.gl.blendFuncSeparate(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class $r extends Rr{getDefault(){return e.bA.transparent}set(e){const t=this.current;(e.r!==t.r||e.g!==t.g||e.b!==t.b||e.a!==t.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class ei extends Rr{getDefault(){return this.gl.FUNC_ADD}set(e){(e!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(e,e),this.current=e,this.dirty=!1)}}class ti extends Rr{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;e?t.enable(t.CULL_FACE):t.disable(t.CULL_FACE),this.current=e,this.dirty=!1}}class ni extends Rr{getDefault(){return this.gl.BACK}set(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}class ri extends Rr{getDefault(){return this.gl.CCW}set(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}let ii=class extends Rr{getDefault(){return null}set(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}};class oi extends Rr{getDefault(){return this.gl.TEXTURE0}set(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}class ai extends Rr{getDefault(){const e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||e[3]!==t[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class si extends Rr{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}class li extends Rr{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.bindRenderbuffer(t.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class ci extends Rr{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.bindTexture(t.TEXTURE_2D,e),this.current=e,this.dirty=!1}}class ui extends Rr{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.bindBuffer(t.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class hi extends Rr{getDefault(){return null}set(e){const t=this.gl;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class di extends Rr{getDefault(){return null}set(e){this.gl&&(e!==this.current||this.dirty)&&(this.gl.bindVertexArray(e),this.current=e,this.dirty=!1)}}class pi extends Rr{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.pixelStorei(t.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}class fi extends Rr{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}class mi extends Rr{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}class gi extends Rr{constructor(e,t){super(e),this.context=e,this.parent=t}getDefault(){return null}}class yi extends gi{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const t=this.gl;t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class _i extends gi{attachment(){return this.gl.DEPTH_ATTACHMENT}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const t=this.gl;t.framebufferRenderbuffer(t.FRAMEBUFFER,this.attachment(),t.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class vi extends gi{attachment(){return this.gl.DEPTH_ATTACHMENT}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const t=this.gl;t.framebufferTexture2D(t.FRAMEBUFFER,this.attachment(),t.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class xi extends _i{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}const bi=(e,t,n)=>({u_matrix:e,u_image0:0,u_skirt_height:t,u_ground_shadow_factor:n}),wi=(e,t,n,r,i,o,a,s,l,c,u,h,d,p,f,m)=>({u_proj_matrix:Float32Array.from(e),u_globe_matrix:t,u_normalize_matrix:Float32Array.from(r),u_merc_matrix:n,u_zoom_transition:i,u_merc_center:o,u_image0:0,u_frustum_tl:a,u_frustum_tr:s,u_frustum_br:l,u_frustum_bl:c,u_globe_pos:u,u_globe_radius:h,u_viewport:d,u_grid_matrix:m?Float32Array.from(m):new Float32Array(9),u_skirt_height:p,u_far_z_cutoff:f});function Si(e,t){return null!=e&&null!=t&&!(!e.hasData()||!t.hasData())&&null!=e.demTexture&&null!=t.demTexture&&e.tileID.key!==t.tileID.key}const Ti=new class{constructor(){this.operations={}}newMorphing(e,t,n,r,i){if(e in this.operations){const t=this.operations[e];t.to.tileID.key!==n.tileID.key&&(t.queued=n)}else this.operations[e]={startTime:r,phase:0,duration:i,from:t,to:n,queued:null}}getMorphValuesForProxy(e){if(!(e in this.operations))return null;const t=this.operations[e];return{from:t.from,to:t.to,phase:t.phase}}update(e){for(const t in this.operations){const n=this.operations[t];for(n.phase=(e-n.startTime)/n.duration;n.phase>=1||!this._validOp(n);)if(!this._nextOp(n,e)){delete this.operations[t];break}}}_nextOp(e,t){return!!e.queued&&(e.from=e.to,e.to=e.queued,e.queued=null,e.phase=0,e.startTime=t,!0)}_validOp(e){return e.from.hasData()&&e.to.hasData()}},Ei={0:null,1:"TERRAIN_VERTEX_MORPHING"};function Ai(e,t,n){if(0===t)return 0;const r=t<1&&514===n?.25/t:1;return 6*Math.pow(1.5,22-e)*Math.max(t,1)*r}function Mi(e,t){const n=1<<e.z;return!t&&(0===e.x||e.x===n-1)||0===e.y||e.y===n-1}const Pi=e=>({u_matrix:e});function ki(t,n,r,i,o){if(o>0){const a=e.q.now(),s=(a-t.timeAdded)/o,l=n?(a-n.timeAdded)/o:-1,c=r.getSource(),u=i.coveringZoomLevel({tileSize:c.tileSize,roundZoom:c.roundZoom}),h=!n||Math.abs(n.tileID.overscaledZ-u)>Math.abs(t.tileID.overscaledZ-u),d=h&&t.refreshedUponExpiration?1:e.ap(h?s:1-l,0,1);return t.refreshedUponExpiration&&s>=1&&(t.refreshedUponExpiration=!1),n?{opacity:1,mix:1-d}:{opacity:d,mix:0}}return{opacity:1,mix:0}}class Ci extends bt{constructor(t){const n={type:"raster-dem",maxzoom:t.transform.maxZoom},r=new e.ce(e.cf(),null),i=rt("mock-dem",n,r,t.style);super("mock-dem",i,!1),i.setEventedParent(this),this._sourceLoaded=!0}_loadTile(e,t){e.state="loaded",t(null)}}class ji extends bt{constructor(t){const n=rt("proxy",{type:"geojson",maxzoom:t.transform.maxZoom},new e.ce(e.cf(),null),t.style);super("proxy",n,!1),n.setEventedParent(this),this.map=this.getSource().map=t,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(e,t,n){if(e.freezeTileCoverage)return;this.transform=e;const r=e.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce(((t,n)=>{if(t[n.key]="",!this._tiles[n.key]){const t=new yt(n,this._source.tileSize*n.overscaleFactor(),e.tileZoom);t.state="loaded",this._tiles[n.key]=t}return t}),{});for(const i in this._tiles)i in r||(this.freeFBO(i),this._tiles[i].unloadVectorData(),delete this._tiles[i])}freeFBO(e){const t=this.proxyCachedFBO[e];if(void 0!==t){const n=Object.values(t);this.renderCachePool.push(...n),delete this.proxyCachedFBO[e]}}deallocRenderCache(){this.renderCache.forEach((e=>e.fb.destroy())),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Ii extends e.aA{constructor(e,t,n){super(e.overscaledZ,e.wrap,e.canonical.z,e.canonical.x,e.canonical.y),this.proxyTileKey=t,this.projMatrix=n}}class Oi extends e.cE{constructor(t,n){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},t.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},(()=>{this._style.map.triggerRepaint()})),t.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},(()=>{this._style.map.triggerRepaint()})),t.tp.registerButton(["Terrain"],"Invalidate Render Cache",(()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()})),this.painter=t,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[r,i,o]=function(){const t=new e.a$,n=new e.aP,r=131;t.reserve(17161),n.reserve(33800);const i=e.ab/128,o=e.ab+i/2,a=o+i;for(let l=-i;l<a;l+=i)for(let n=-i;n<a;n+=i){const r=n<0||n>o||l<0||l>o?24575:0,i=e.ap(Math.round(n),0,e.ab),a=e.ap(Math.round(l),0,e.ab);t.emplaceBack(i+r,a)}const s=(e,t)=>{const i=t*r+e;n.emplaceBack(i+1,i,i+r),n.emplaceBack(i+r,i+r+1,i+1)};for(let e=1;e<129;e++)for(let t=1;t<129;t++)s(t,e);return[0,129].forEach((e=>{for(let t=0;t<130;t++)s(t,e),s(e,t)})),[t,n,32768]}(),a=t.context;this.gridBuffer=a.createVertexBuffer(r,e.b1.members),this.gridIndexBuffer=a.createIndexBuffer(i),this.gridSegments=e.b2.simpleSegment(0,0,r.length,i.length),this.gridNoSkirtSegments=e.b2.simpleSegment(0,0,r.length,o),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new ji(n.map),this.orthoMatrix=e.a6.mat4.create(),e.a6.mat4.ortho(this.orthoMatrix,"globe"===this.painter.transform.projection.name?.015:0,e.ab,0,e.ab,0,1);const s=a.gl;this._overlapStencilMode=new zn({func:s.GEQUAL,mask:255},0,255,s.KEEP,s.KEEP,s.REPLACE),this._previousZoom=t.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=n,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Ci(n.map),this._pendingGroundEffectLayers=[]}set style(e){e.on("data",this._onStyleDataEvent.bind(this)),this._style=e,this._style.map.on("moveend",(()=>{this._clearLineLayersFromRenderCache()}))}update(t,n,r){if(t&&t.terrain){this._style!==t&&(this.style=t,this._evaluationZoom=void 0);const i=t.terrain.properties,o=0===t.terrain.drapeRenderMode,a=t.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=e.q.now();const s=t.terrain&&t.terrain.scope,l=i.get("source"),c=o?this._mockSourceCache:t.getSourceCache(l,s);if(!c)return void e.w("Couldn't find terrain source \"".concat(l,'".'));if(this.sourceCache=c,this._attenuationRange=t.terrain.getAttenuationRange(),this._exaggeration=a?this.calculateExaggeration(n):i.get("exaggeration"),!n.projection.requiresDraping&&a&&0===this._exaggeration)return void this._disable();this.enabled=!0;const u=()=>{this.sourceCache.used&&e.w("Raster DEM source '".concat(this.sourceCache.id,"' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source."));const t=this.getScaledDemTileSize();this.sourceCache.update(n,t,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,u(),this._initializing=!0),u(),n.updateElevation(!0,r),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(n),this._emptyDEMTextureDirty=!0,this._previousZoom=n.zoom}else this._disable()}calculateExaggeration(t){if(this._attenuationRange&&t.zoom>=Math.ceil(this._attenuationRange[1]))return this._style.terrain.getExaggeration(t.zoom);const n=this._previousCameraAltitude,r=t.getFreeCameraOptions().position.z/t.pixelsPerMeter*t.worldSize;this._previousCameraAltitude=r;const i=null!=n?r-n:Number.MAX_VALUE;if(Math.abs(i)<2)return this._exaggeration;const o=t.zoom,a=this._style.terrain;if(!this._previousUpdateTimestamp)return a.getExaggeration(o);let s=o-this._previousZoom;const l=this._previousUpdateTimestamp;let c=o;null!=this._evaluationZoom&&(c=this._evaluationZoom,Math.abs(o-c)>.5&&(s=.5*(o-c+s)),s*i<0&&(c+=s)),this._evaluationZoom=c;const u=a.getExaggeration(c),h=u===a.getExaggeration(Math.max(0,c-.1));if(h&&Math.abs(u-this._exaggeration)<.01)return u;let d=Math.min(.1,.00375*(this._updateTimestamp-l));return(h||u<.1||Math.abs(s)<1e-4)&&(d=Math.min(.2,4*d)),e.aa(this._exaggeration,u,d)}resetTileLookupCache(e){this._findCoveringTileCache[e]={}}attenuationRange(){return this._attenuationRange}getDemUpscale(){return this.proxySourceCache.getSource().tileSize/128}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(e){e.coord&&"source"===e.dataType?this._clearRenderCacheForTile(e.sourceCacheId,e.coord):"style"===e.dataType&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._emptyDEMTextureDirty=!0,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const e in this._style._mergedSourceCaches)this._style._mergedSourceCaches[e].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach((e=>e.fb.destroy())),this.pool=[],this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this.enabled?this._exaggeration:0}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const e=2*this.proxySourceCache.getSource().tileSize;return[e,e]}set useVertexMorphing(e){this._useVertexMorphing=e}updateTileBinding(t){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const n=this.proxySourceCache,r=this.painter.transform;this._initializing&&(this._initializing=0===r._centerAltitude&&-1===this.getAtPointOrZero(e.a5.fromLngLat(r.center),-1),this._emptyDEMTextureDirty=!this._initializing);const i=this.proxyCoords=n.getIds().map((e=>{const t=n.getTileByID(e).tileID;return t.projMatrix=r.calculateProjMatrix(t.toUnwrapped()),t}));!function(t,n){const r=n.transform.pointCoordinate(n.transform.getCameraPoint()),i=new e.P(r.x,r.y);t.sort(((t,n)=>{if(n.overscaledZ-t.overscaledZ)return n.overscaledZ-t.overscaledZ;const r=new e.P(t.canonical.x+(1<<t.canonical.z)*t.wrap,t.canonical.y),o=new e.P(n.canonical.x+(1<<n.canonical.z)*n.wrap,n.canonical.y),a=i.mult(1<<t.canonical.z);return a.x-=.5,a.y-=.5,a.distSqr(r)-a.distSqr(o)}))}(i,this.painter);const o=this.proxyToSource||{};this.proxyToSource={},i.forEach((e=>{this.proxyToSource[e.key]={}})),this.terrainTileForTile={};const a=this._style._mergedSourceCaches;for(const e in a){const n=a[e];if(!n.used)continue;if(n!==this.sourceCache&&this.resetTileLookupCache(n.id),this._setupProxiedCoordsForOrtho(n,t[e],o),n.usedForTerrain)continue;const r=t[e];n.getSource().reparseOverscaled&&this._assignTerrainTiles(r)}this.proxiedCoords[n.id]=i.map((e=>new Ii(e,e.key,this.orthoMatrix))),this._assignTerrainTiles(i),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(o),this.renderingToTexture=!1;const s={};this._visibleDemTiles=[];for(const e of this.proxyCoords){const t=this.terrainTileForTile[e.key];if(!t)continue;const n=t.tileID.key;n in s||(this._visibleDemTiles.push(t),s[n]=n)}}_assignTerrainTiles(e){this._initializing||e.forEach((e=>{if(this.terrainTileForTile[e.key])return;const t=this._findTileCoveringTileID(e,this.sourceCache);t&&(this.terrainTileForTile[e.key]=t)}))}_prepareDEMTextures(){const e=this.painter.context,t=e.gl;for(const n in this.terrainTileForTile){const r=this.terrainTileForTile[n],i=r.dem;!i||r.demTexture&&!r.needsDEMTextureUpload||(e.activeTexture.set(t.TEXTURE1),Lr(this.painter,r,i))}}_prepareDemTileUniforms(e,t,n,r){if(!t||null==t.demTexture)return!1;const i=e.tileID.canonical,o=Math.pow(2,t.tileID.canonical.z-i.z),a=r||"";return n["u_dem_tl".concat(a)]=[i.x*o%1,i.y*o%1],n["u_dem_scale".concat(a)]=o,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){if(!this.enabled)return 0;let e=0;const t=this._visibleDemTiles.reduce(((t,n)=>{if(!n.dem)return t;const r=n.dem.tree.minimums[0];return r>0&&e++,t+r}),0);return e?t/e:0}_updateEmptyDEMTexture(){const t=this.painter.context,n=t.gl;t.activeTexture.set(n.TEXTURE2);const r=this._getLoadedAreaMinimum(),i=new e.cF({width:1,height:1},new Float32Array([r]));this._emptyDEMTextureDirty=!1;let o=this._emptyDEMTexture;return o?o.update(i,{premultiply:!1}):o=this._emptyDEMTexture=new e.T(t,i,n.R32F,{premultiply:!1}),o}setupElevationDraw(t,n,r){const i=this.painter.context,o=i.gl,a={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0};a.u_exaggeration=this.exaggeration();let s=null,l=null,c=1;if(r&&r.morphing&&this._useVertexMorphing){const e=r.morphing.srcDemTile,n=r.morphing.dstDemTile;c=r.morphing.phase,e&&n&&(this._prepareDemTileUniforms(t,e,a,"_prev")&&(l=e),this._prepareDemTileUniforms(t,n,a)&&(s=n))}const u=e=>e&&e.demTexture&&this.painter.linearFloatFilteringSupported()?o.LINEAR:o.NEAREST;let h=null;var d;if(this.enabled?l&&s?(h=s.demTexture,i.activeTexture.set(o.TEXTURE4),l.demTexture.bind(u(l),o.CLAMP_TO_EDGE),a.u_dem_lerp=c):(s=this.terrainTileForTile[t.tileID.key],h=this._prepareDemTileUniforms(t,s,a)?s.demTexture:this.emptyDEMTexture):h=this.emptyDEMTexture,i.activeTexture.set(o.TEXTURE2),h&&(a.u_dem_size=1===(d=h).size[0]?1:d.size[0]-2,h.bind(u(s),o.CLAMP_TO_EDGE)),this.painter.setupDepthForOcclusion(r&&r.useDepthForOcclusion,n,a),r&&r.useMeterToDem&&s){const t=(1<<s.tileID.canonical.z)*e.bE(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;a.u_meter_to_dem=t}if(r&&r.labelPlaneMatrixInv&&(a.u_label_plane_matrix_inv=r.labelPlaneMatrixInv),n.setTerrainUniformValues(i,a),"globe"===this.painter.transform.projection.name){const e=this.globeUniformValues(this.painter.transform,t.tileID.canonical,r&&r.useDenormalizedUpVectorScale);n.setGlobeUniformValues(i,e)}}globeUniformValues(t,n,r){const i=t.projection;return{u_tile_tl_up:i.upVector(n,0,0),u_tile_tr_up:i.upVector(n,e.ab,0),u_tile_br_up:i.upVector(n,e.ab,e.ab),u_tile_bl_up:i.upVector(n,0,e.ab),u_tile_up_scale:r?e.cG(1):i.upVectorScale(n,t.center.lat,t.worldSize).metersToTile}}renderToBackBuffer(t){const n=this.painter,r=this.painter.context;0!==t.length&&(r.bindFramebuffer.set(null),r.viewport.set([0,0,n.width,n.height]),n.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(t,n,r,i,o){if("globe"===t.transform.projection.name)!function(t,n,r,i,o){const a=t.context,s=a.gl;let l,c;const u=t.transform,h=e.cx(t,a,u),d=(e,n)=>{if(c===n)return;const r=[Ei[n],"PROJECTION_GLOBE_VIEW"];h&&r.push("CUSTOM_ANTIALIASING");const i=t.isTileAffectedByFog(e);l=t.getOrCreateProgram("globeRaster",{defines:r,overrideFog:i}),c=n},p=t.colorModeForRenderPass(),f=new Dn(s.LEQUAL,Dn.ReadWrite,t.depthRangeFor3D);Ti.update(o);const m=e.cy(u),g=[e.am(u.center.lng),e.at(u.center.lat)],y=t.globeSharedBuffers,_=[u.width*e.q.devicePixelRatio,u.height*e.q.devicePixelRatio],v=Float32Array.from(u.globeMatrix),x={useDenormalizedUpVectorScale:!0};{const u=t.transform,h=Ai(u.zoom,n.exaggeration(),n.sourceCache._source.tileSize);c=-1;const b=s.TRIANGLES;for(const c of i){const i=r.getTile(c),w=zn.disabled,S=n.prevTerrainTileForTile[c.key],T=n.terrainTileForTile[c.key];Si(S,T)&&Ti.newMorphing(c.key,S,T,o,250),a.activeTexture.set(s.TEXTURE0),i.texture&&i.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE);const E=Ti.getMorphValuesForProxy(c.key),A=E?1:0;E&&e.C(x,{morphing:{srcDemTile:E.from,dstDemTile:E.to,phase:e.cw(E.phase)}});const M=e.cz(c.canonical),P=e.cA(M.getCenter().lat),k=e.cB(c.canonical,M,P,u.worldSize/u._pixelsPerMercatorPixel),C=e.b6(e.cC(c.canonical)),j=wi(u.expandedFarZProjMatrix,v,m,C,e.a9(u.zoom),g,u.frustumCorners.TL,u.frustumCorners.TR,u.frustumCorners.BR,u.frustumCorners.BL,u.globeCenterInViewSpace,u.globeRadius,_,h,u._farZ,k);if(d(c,A),l&&(n.setupElevationDraw(i,l,x),t.uploadCommonUniforms(a,l,c.toUnwrapped()),y)){const[e,n,r]=y.getGridBuffers(P,0!==h);l.draw(t,b,f,w,p,Bn.backCCW,j,"globe_raster",e,n,r)}}}if(y&&(t.renderDefaultNorthPole||t.renderDefaultSouthPole)){const o=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];h&&o.push("CUSTOM_ANTIALIASING"),l=t.getOrCreateProgram("globeRaster",{defines:o});for(const c of i){const{x:i,y:o,z:h}=c.canonical,d=0===o,m=o===(1<<h)-1,[v,b,w,S]=y.getPoleBuffers(h,!1);if(S&&(d||m)){const o=r.getTile(c);a.activeTexture.set(s.TEXTURE0),o.texture&&o.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE);let y=e.cD(h,i,u);const T=e.b6(e.cC(c.canonical)),E=(e,n)=>e.draw(t,s.TRIANGLES,f,zn.disabled,p,Bn.disabled,wi(u.expandedFarZProjMatrix,y,y,T,0,g,u.frustumCorners.TL,u.frustumCorners.TR,u.frustumCorners.BR,u.frustumCorners.BL,u.globeCenterInViewSpace,u.globeRadius,_,0,u._farZ),"globe_pole_raster",n,w,S);n.setupElevationDraw(o,l,x),t.uploadCommonUniforms(a,l,c.toUnwrapped()),d&&t.renderDefaultNorthPole&&E(l,v),m&&t.renderDefaultSouthPole&&(y=e.a6.mat4.scale(e.a6.mat4.create(),y,[1,-1,1]),E(l,b))}}}}(t,n,r,i,o);else{const a=t.context,s=a.gl;let l,c;const u=t.shadowRenderer,h=Jn(t,t.longestCutoffRange),d=e=>{if(c===e)return;const n=[];n.push(Ei[e]),h.shouldRenderCutoff&&n.push("RENDER_CUTOFF"),u&&(n.push("RENDER_SHADOWS","DEPTH_TEXTURE"),u.useNormalOffset&&n.push("NORMAL_OFFSET")),l=t.getOrCreateProgram("terrainRaster",{defines:n}),c=e},p=t.colorModeForRenderPass(),f=new Dn(s.LEQUAL,Dn.ReadWrite,t.depthRangeFor3D);Ti.update(o);const m=t.transform,g=Ai(m.zoom,n.exaggeration(),n.sourceCache._source.tileSize);let y=[0,0,0];if(u){const e=t.style.directionalLight,n=t.style.ambientLight;e&&n&&(y=ir(t.style,e,n))}{c=-1;const _=s.TRIANGLES,[v,x]=[n.gridIndexBuffer,n.gridSegments];for(const c of i){const i=r.getTile(c),b=zn.disabled,w=n.prevTerrainTileForTile[c.key],S=n.terrainTileForTile[c.key];Si(w,S)&&Ti.newMorphing(c.key,w,S,o,250),a.activeTexture.set(s.TEXTURE0),i.texture&&i.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE);const T=Ti.getMorphValuesForProxy(c.key),E=T?1:0;let A;T&&(A={morphing:{srcDemTile:T.from,dstDemTile:T.to,phase:e.cw(T.phase)}});const M=bi(c.projMatrix,Mi(c.canonical,m.renderWorldCopies)?g/10:g,y);if(d(E),!l)continue;n.setupElevationDraw(i,l,A);const P=c.toUnwrapped();u&&u.setupShadows(P,l),t.uploadCommonUniforms(a,l,P,null,h),l.draw(t,_,f,b,p,Bn.backCCW,M,"terrain_raster",n.gridBuffer,v,x)}}}}(n,this,this.proxySourceCache,t,this._updateTimestamp),this.renderingToTexture=!0,n.gpuTimingDeferredRenderEnd(),t.splice(0,t.length))}renderBatch(t){if(0===this._drapedRenderBatches.length)return t+1;this.renderingToTexture=!0;const n=this.painter,r=this.painter.context,i=this.proxySourceCache,o=this.proxiedCoords[i.id],a=this._drapedRenderBatches.shift(),s=n.style.order,l=[];let c=0;for(const u of o){const o=i.getTileByID(u.proxyTileKey),h=i.proxyCachedFBO[u.key]?i.proxyCachedFBO[u.key][t]:void 0,d=void 0!==h?i.renderCache[h]:this.pool[c++],p=void 0!==h;if(o.texture=d.tex,p&&!d.dirty){l.push(o.tileID);continue}let f;r.bindFramebuffer.set(d.fb.framebuffer),this.renderedToTile=!1,d.dirty&&(r.clear({color:e.bA.transparent,stencil:0}),d.dirty=!1);for(let e=a.start;e<=a.end;++e){const t=n.style._mergedLayers[s[e]];if(t.isHidden(n.transform.zoom))continue;const i=n.style.getLayerSourceCache(t),o=i?this.proxyToSource[u.key][i.id]:[u];if(!o)continue;const a=o;r.viewport.set([0,0,d.fb.width,d.fb.height]),f!==(i?i.id:null)&&(this._setupStencil(d,o,t,i),f=i?i.id:null),n.renderLayer(n,i,t,a)}if(0===this._drapedRenderBatches.length)for(const e of this._pendingGroundEffectLayers){const t=n.style._mergedLayers[s[e]];if(t.isHidden(n.transform.zoom))continue;const i=n.style.getLayerSourceCache(t),o=i?this.proxyToSource[u.key][i.id]:[u];if(!o)continue;const a=o;r.viewport.set([0,0,d.fb.width,d.fb.height]),f!==(i?i.id:null)&&(this._setupStencil(d,o,t,i),f=i?i.id:null),n.renderLayer(n,i,t,a)}this.renderedToTile?(d.dirty=!0,l.push(o.tileID)):p||--c,5===c&&(c=0,this.renderToBackBuffer(l))}return this.renderToBackBuffer(l),this.renderingToTexture=!1,r.bindFramebuffer.set(null),r.viewport.set([0,0,n.width,n.height]),a.end+1}postRender(){}isLayerOrderingCorrect(e){const t=e.order.length;let n=-1,r=t;for(let i=0;i<t;++i)this._style.isLayerDraped(e._mergedLayers[e.order[i]])?n=Math.max(n,i):r=Math.min(r,i);return r>n}getMinElevationBelowMSL(){let e=0;return this._visibleDemTiles.filter((e=>e.dem)).forEach((t=>{e=Math.min(e,t.dem.tree.minimums[0])})),0===e?e:(e-30)*this._exaggeration}raycast(e,t,n){if(!this._visibleDemTiles)return null;const r=this._visibleDemTiles.filter((e=>e.dem)).map((r=>{const i=r.tileID,o=1<<i.overscaledZ,{x:a,y:s}=i.canonical,l=a/o,c=(a+1)/o,u=s/o,h=(s+1)/o;return{minx:l,miny:u,maxx:c,maxy:h,t:r.dem.tree.raycastRoot(l,u,c,h,e,t,n),tile:r}}));r.sort(((e,t)=>(null!==e.t?e.t:Number.MAX_VALUE)-(null!==t.t?t.t:Number.MAX_VALUE)));for(const i of r){if(null==i.t)return null;const r=i.tile.dem.tree.raycast(i.minx,i.miny,i.maxx,i.maxy,e,t,n);if(null!=r)return r}return null}_createFBO(){const t=this.painter.context,n=t.gl,r=this.drapeBufferSize;t.activeTexture.set(n.TEXTURE0);const i=new e.T(t,{width:r[0],height:r[1],data:null},n.RGBA8);i.bind(n.LINEAR,n.CLAMP_TO_EDGE);const o=t.createFramebuffer(r[0],r[1],!0,null);return o.colorAttachment.set(i.texture),o.depthAttachment=new xi(t,o.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=t.createRenderbuffer(t.gl.DEPTH_STENCIL,r[0],r[1]),this._stencilRef=0,o.depthAttachment.set(this._sharedDepthStencil),t.clear({stencil:0})):o.depthAttachment.set(this._sharedDepthStencil),t.extTextureFilterAnisotropic&&n.texParameterf(n.TEXTURE_2D,t.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,t.extTextureFilterAnisotropicMax),{fb:o,tex:i,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache)return!0;if(this._style.hasLightTransitions())return!0;for(const e in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[e].hasTransition())return!0;return this._style.order.some((e=>{const t=this._style._mergedLayers[e],n=t.isHidden(this.painter.transform.zoom);return"hillshade"===t.type||"custom"===t.type?!n&&t.shouldRedrape():!n&&t.hasTransition()}))}_clearLineLayersFromRenderCache(){let t=!1;for(const e of this._style.getSources())if(e instanceof $e){t=!0;break}if(!t)return;const n={};for(let r=0;r<this._style.order.length;++r){const t=this._style._mergedLayers[this._style.order[r]],i=this._style.getLayerSourceCache(t);if(i&&!n[i.id]&&!t.isHidden(this.painter.transform.zoom)&&"line"===t.type&&t.widthExpression()instanceof e.a4){n[i.id]=!0;for(const e of this.proxyCoords){const t=this.proxyToSource[e.key][i.id];if(t)for(const e of t)this._clearRenderCacheForTile(i.id,e)}}}}_clearRasterLayersFromRenderCache(){let e=!1;for(const n in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[n]._source instanceof et){e=!0;break}if(!e)return;const t={};for(let n=0;n<this._style.order.length;++n){const e=this._style._mergedLayers[this._style.order[n]],r=this._style.getLayerSourceCache(e);if(!r||t[r.id])continue;if(e.isHidden(this.painter.transform.zoom)||"raster"!==e.type)continue;const i=e.paint.get("raster-fade-duration");for(const t of this.proxyCoords){const e=this.proxyToSource[t.key][r.id];if(e)for(const t of e){const e=ki(r.getTile(t),r.findLoadedParent(t,0),r,this.painter.transform,i);(1!==e.opacity||0!==e.mix)&&this._clearRenderCacheForTile(r.id,t)}}}}_setupDrapedRenderBatches(){const t=this._style.order,n=t.length;if(0===n)return;const r=[];this._pendingGroundEffectLayers=[];let i,o=0,a=this._style._mergedLayers[t[o]];for(;!this._style.isLayerDraped(a)&&a.isHidden(this.painter.transform.zoom)&&++o<n;)a=this._style._mergedLayers[t[o]];for(;o<n;++o){const e=this._style._mergedLayers[t[o]];e.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(e)?void 0===i&&(i=o):("fill-extrusion"===e.type&&this._pendingGroundEffectLayers.push(o),void 0!==i&&(r.push({start:i,end:o-1}),i=void 0)))}if(void 0!==i&&r.push({start:i,end:o-1}),0!==r.length){const t=r[r.length-1];this._pendingGroundEffectLayers.every((e=>e>t.end))||e.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=r}_setupRenderCache(e){const t=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,t.renderCache.length>t.renderCachePool.length){const e=Object.values(t.proxyCachedFBO);t.proxyCachedFBO={};for(let n=0;n<e.length;++n){const r=Object.values(e[n]);t.renderCachePool.push(...r)}}return}this._clearRasterLayersFromRenderCache();const n=this.proxyCoords,r=this._tilesDirty;for(let o=n.length-1;o>=0;o--){const i=n[o];if(t.getTileByID(i.key),void 0!==t.proxyCachedFBO[i.key]){const n=e[i.key],o=this.proxyToSource[i.key];let a=0;for(const e in o){const t=o[e],i=n[e];if(!i||i.length!==t.length||t.some(((t,n)=>t!==i[n]||r[e]&&r[e].hasOwnProperty(t.key)))){a=-1;break}++a}for(const e in t.proxyCachedFBO[i.key])t.renderCache[t.proxyCachedFBO[i.key][e]].dirty=a<0||a!==Object.values(n).length}}const i=[...this._drapedRenderBatches];i.sort(((e,t)=>t.end-t.start-(e.end-e.start)));for(const o of i)for(const e of n){if(t.proxyCachedFBO[e.key])continue;let n=t.renderCachePool.pop();void 0===n&&t.renderCache.length<50&&(n=t.renderCache.length,t.renderCache.push(this._createFBO())),void 0!==n&&(t.proxyCachedFBO[e.key]={},t.proxyCachedFBO[e.key][o.start]=n,t.renderCache[n].dirty=!0)}this._tilesDirty={}}_setupStencil(e,t,n,r){if(!r||!this._sourceTilesOverlap[r.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const i=this.painter.context,o=i.gl;if(t.length<=1)return void(this._overlapStencilType=!1);let a;if(n.isTileClipped())a=t.length,this._overlapStencilMode.test={func:o.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(t[0].overscaledZ>t[t.length-1].overscaledZ))return void(this._overlapStencilType=!1);a=1,this._overlapStencilMode.test={func:o.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+a>255&&(i.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=a,this._overlapStencilMode.ref=this._stencilRef,n.isTileClipped()&&this._renderTileClippingMasks(t,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return"Clip"===this._overlapStencilType||"Mask"===this._overlapStencilType}stencilModeForRTTOverlap(e){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[e.key]),this._overlapStencilMode):zn.disabled}_renderTileClippingMasks(e,t){const n=this.painter,r=this.painter.context,i=r.gl;n._tileClippingMaskIDs={},r.setColorMode(Nn.disabled),r.setDepthMode(Dn.disabled);const o=n.getOrCreateProgram("clippingMask");for(const a of e){const e=n._tileClippingMaskIDs[a.key]=--t;o.draw(n,i.TRIANGLES,Dn.disabled,new zn({func:i.ALWAYS,mask:0},e,255,i.KEEP,i.KEEP,i.REPLACE),Nn.disabled,Bn.disabled,Pi(a.projMatrix),"$clipping",n.tileExtentBuffer,n.quadTriangleIndexBuffer,n.tileExtentSegments)}}pointCoordinate(t){const n=this.painter.transform;if(t.x<0||t.x>n.width||t.y<0||t.y>n.height)return null;const r=[t.x,t.y,1,1];e.a6.vec4.transformMat4(r,r,n.pixelMatrixInverse),e.a6.vec4.scale(r,r,1/r[3]),r[0]/=n.worldSize,r[1]/=n.worldSize;const i=n._camera.position,o=e.bE(1,n.center.lat),a=[i[0],i[1],i[2]/o,0],s=e.a6.vec3.subtract([],r.slice(0,3),a);e.a6.vec3.normalize(s,s);const l=this.raycast(a,s,this._exaggeration);return null!==l&&l?(e.a6.vec3.scaleAndAdd(a,a,s,l),a[3]=a[2],a[2]*=o,a):null}_setupProxiedCoordsForOrtho(t,n,r){if(t.getSource()instanceof e.aD)return this._setupProxiedCoordsForImageSource(t,n,r);this._findCoveringTileCache[t.id]=this._findCoveringTileCache[t.id]||{};const i=this.proxiedCoords[t.id]=[],o=this.proxyCoords;for(let e=0;e<o.length;e++){const n=o[e],a=this._findTileCoveringTileID(n,t);if(a){const e=this._createProxiedId(n,a,r[n.key]&&r[n.key][t.id]);i.push(e),this.proxyToSource[n.key][t.id]=[e]}}let a=!1;const s=new Set;for(let e=0;e<n.length;e++){const o=t.getTile(n[e]);if(!o||!o.hasData())continue;const l=this._findTileCoveringTileID(o.tileID,this.proxySourceCache);if(l&&l.tileID.canonical.z!==o.tileID.canonical.z){const e=this.proxyToSource[l.tileID.key][t.id],n=this._createProxiedId(l.tileID,o,r[l.tileID.key]&&r[l.tileID.key][t.id]);e?e.splice(e.length-1,0,n):this.proxyToSource[l.tileID.key][t.id]=[n];const c=this.proxyToSource[l.tileID.key][t.id];s.has(c)||s.add(c),i.push(n),a=!0}}if(this._sourceTilesOverlap[t.id]=a,a&&this._debugParams.sortTilesHiZFirst)for(const e of s)e.sort(((e,t)=>t.overscaledZ-e.overscaledZ))}_setupProxiedCoordsForImageSource(t,n,r){if(!t.getSource().loaded())return;const i=this.proxiedCoords[t.id]=[],o=this.proxyCoords,a=t.getSource(),s=a.tileID;if(!s)return;const l=new e.P(s.x,s.y)._div(1<<s.z),c=a.coordinates.map(e.a5.fromLngLat).reduce(((e,t)=>(e.min.x=Math.min(e.min.x,t.x-l.x),e.min.y=Math.min(e.min.y,t.y-l.y),e.max.x=Math.max(e.max.x,t.x-l.x),e.max.y=Math.max(e.max.y,t.y-l.y),e)),{min:new e.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new e.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),u=(t,n)=>{const r=t.wrap+t.canonical.x/(1<<t.canonical.z),i=t.canonical.y/(1<<t.canonical.z),o=e.ab/(1<<t.canonical.z),a=n.wrap+n.canonical.x/(1<<n.canonical.z),s=n.canonical.y/(1<<n.canonical.z);return r+o<a+c.min.x||r>a+c.max.x||i+o<s+c.min.y||i>s+c.max.y};for(let e=0;e<o.length;e++){const a=o[e];for(let e=0;e<n.length;e++){const o=t.getTile(n[e]);if(!o||!o.hasData())continue;if(u(a,o.tileID))continue;const s=this._createProxiedId(a,o,r[a.key]&&r[a.key][t.id]),l=this.proxyToSource[a.key][t.id];l?l.push(s):this.proxyToSource[a.key][t.id]=[s],i.push(s)}}}_createProxiedId(t,n,r){let i=this.orthoMatrix;if(r){const e=r.find((e=>e.key===n.tileID.key));if(e)return e}if(n.tileID.key!==t.key){const r=t.canonical.z-n.tileID.canonical.z;let o,a,s;i=e.a6.mat4.create();const l=n.tileID.wrap-t.wrap<<t.overscaledZ;r>0?(o=e.ab>>r,a=o*((n.tileID.canonical.x<<r)-t.canonical.x+l),s=o*((n.tileID.canonical.y<<r)-t.canonical.y)):(o=e.ab<<-r,a=e.ab*(n.tileID.canonical.x-(t.canonical.x+l<<-r)),s=e.ab*(n.tileID.canonical.y-(t.canonical.y<<-r))),e.a6.mat4.ortho(i,0,o,0,o,0,1),e.a6.mat4.translate(i,i,[a,s,0])}return new Ii(n.tileID,t.key,i)}_findTileCoveringTileID(t,n){let r=n.getTile(t);if(r&&r.hasData())return r;const i=this._findCoveringTileCache[n.id],o=i[t.key];if(r=o?n.getTileByID(o):null,r&&r.hasData()||null===o)return r;let a=r?r.tileID:t,s=a.overscaledZ;const l=n.getSource().minzoom,c=[];if(!o){const i=n.getSource().maxzoom;if(t.canonical.z>=i){const r=t.canonical.z-i;n.getSource().reparseOverscaled?(s=Math.max(t.canonical.z+2,n.transform.tileZoom),a=new e.aA(s,t.wrap,i,t.canonical.x>>r,t.canonical.y>>r)):0!==r&&(s=i,a=new e.aA(s,t.wrap,i,t.canonical.x>>r,t.canonical.y>>r))}a.key!==t.key&&(c.push(a.key),r=n.getTile(a))}const u=e=>{c.forEach((t=>{i[t]=e})),c.length=0};for(s-=1;s>=l&&(!r||!r.hasData());s--){r&&u(r.tileID.key);const e=a.calculateScaledKey(s);if(r=n.getTileByID(e),r&&r.hasData())break;const t=i[e];if(null===t)break;void 0===t?c.push(e):r=n.getTileByID(t)}return u(r?r.tileID.key:null),r&&r.hasData()?r:null}findDEMTileFor(e){return this.enabled?this._findTileCoveringTileID(e,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(e,t){let n=this._tilesDirty[e];n||(n=this._tilesDirty[e]={}),n[t.key]=!0}}function Ni(t,n,r){const i=function(t,n,r){const i=e.a6.vec3.dot(n,t),o=e.a6.vec3.dot(r,[.2126,.7152,.0722]),a=(e,t,n)=>(1-n)*e+n*t,s=a(1-.3*Math.min(o,1),1,Math.min(i+1,1));return a(.92,1,Math.asin(e.ap(n[2],-1,1))/Math.PI+.5)*s}(t,[0,0,1],n),o=[0,0,0];e.a6.vec3.scale(o,r.slice(0,3),i);const a=[0,0,0];e.a6.vec3.scale(a,n.slice(0,3),t[2]);const s=[0,0,0];return e.a6.vec3.add(s,o,a),e.cc(s)}const Di=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],Li=["stars","rain_particle","snow_particle","fillExtrusion","fillExtrusionGroundEffect","model","symbol"];class zi{static cacheKey(e,t,n,r){let i="".concat(t).concat(r?r.cacheKey:"");for(const o of n)e.usedDefines.includes(o)&&(i+="/".concat(o));return i}constructor(t,n,r,i,o,a){const s=t.gl;this.program=s.createProgram(),this.configuration=i,this.name=n,this.fixedDefines=[...a];const l=i?i.getBinderAttributes():[],c=(r.staticAttributes||[]).concat(l);let u=i?i.defines():[];u=u.concat(a.map((e=>"#define ".concat(e))));const h="#version 300 es\n";let d=h+u.concat("precision mediump float;",kr,Pr.fragmentSource).join("\n");for(const e of r.fragmentIncludes)d+="\n".concat(Ar[e]);d+="\n".concat(r.fragmentSource);let p=h+u.concat("precision highp float;",kr,Pr.vertexSource).join("\n");for(const e of r.vertexIncludes)p+="\n".concat(Ar[e]);p+="\n".concat(r.vertexSource);const f=s.createShader(s.FRAGMENT_SHADER);if(s.isContextLost())return void(this.failedToCreate=!0);s.shaderSource(f,d),s.compileShader(f),s.attachShader(this.program,f);const m=s.createShader(s.VERTEX_SHADER);if(s.isContextLost())this.failedToCreate=!0;else{s.shaderSource(m,p),s.compileShader(m),s.attachShader(this.program,m),this.attributes={},this.numAttributes=c.length;for(let e=0;e<this.numAttributes;e++)if(c[e]){const t=c[e].startsWith("a_")?c[e]:"a_".concat(c[e]);s.bindAttribLocation(this.program,e,t),this.attributes[t]=e}s.linkProgram(this.program),s.deleteShader(m),s.deleteShader(f),this.fixedUniforms=o(t),this.binderUniforms=i?i.getUniforms(t):[],(a.includes("TERRAIN")||-1!==n.indexOf("symbol")||-1!==n.indexOf("circle"))&&(this.terrainUniforms=(t=>({u_dem:new e.bK(t),u_dem_prev:new e.bK(t),u_dem_tl:new e.bH(t),u_dem_scale:new e.bJ(t),u_dem_tl_prev:new e.bH(t),u_dem_scale_prev:new e.bJ(t),u_dem_size:new e.bJ(t),u_dem_lerp:new e.bJ(t),u_exaggeration:new e.bJ(t),u_depth:new e.bK(t),u_depth_size_inv:new e.bH(t),u_depth_range_unpack:new e.bH(t),u_occluder_half_size:new e.bJ(t),u_occlusion_depth_offset:new e.bJ(t),u_meter_to_dem:new e.bJ(t),u_label_plane_matrix_inv:new e.bG(t)}))(t)),a.includes("GLOBE")&&(this.globeUniforms=(t=>({u_tile_tl_up:new e.bI(t),u_tile_tr_up:new e.bI(t),u_tile_br_up:new e.bI(t),u_tile_bl_up:new e.bI(t),u_tile_up_scale:new e.bJ(t)}))(t)),a.includes("FOG")&&(this.fogUniforms=(t=>({u_fog_matrix:new e.bG(t),u_fog_range:new e.bH(t),u_fog_color:new e.c7(t),u_fog_horizon_blend:new e.bJ(t),u_fog_vertical_limit:new e.bH(t),u_fog_temporal_offset:new e.bJ(t),u_frustum_tl:new e.bI(t),u_frustum_tr:new e.bI(t),u_frustum_br:new e.bI(t),u_frustum_bl:new e.bI(t),u_globe_pos:new e.bI(t),u_globe_radius:new e.bJ(t),u_globe_transition:new e.bJ(t),u_is_globe:new e.bK(t),u_viewport:new e.bH(t)}))(t)),a.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(t=>({u_cutoff_params:new e.c7(t)}))(t)),a.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(t=>({u_lighting_ambient_color:new e.bI(t),u_lighting_directional_dir:new e.bI(t),u_lighting_directional_color:new e.bI(t),u_ground_radiance:new e.bI(t)}))(t)),a.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(t=>({u_light_matrix_0:new e.bG(t),u_light_matrix_1:new e.bG(t),u_fade_range:new e.bH(t),u_shadow_normal_offset:new e.bI(t),u_shadow_intensity:new e.bJ(t),u_shadow_texel_size:new e.bJ(t),u_shadow_map_resolution:new e.bJ(t),u_shadow_direction:new e.bI(t),u_shadow_bias:new e.bI(t),u_shadowmap_0:new e.bK(t),u_shadowmap_1:new e.bK(t)}))(t))}}setTerrainUniformValues(e,t){if(!this.terrainUniforms)return;const n=this.terrainUniforms;if(!this.failedToCreate){e.program.set(this.program);for(const e in t)n[e]&&n[e].set(this.program,e,t[e])}}setGlobeUniformValues(e,t){if(!this.globeUniforms)return;const n=this.globeUniforms;if(!this.failedToCreate){e.program.set(this.program);for(const e in t)n[e]&&n[e].set(this.program,e,t[e])}}setFogUniformValues(e,t){if(!this.fogUniforms)return;const n=this.fogUniforms;if(!this.failedToCreate){e.program.set(this.program);for(const e in t)n[e].set(this.program,e,t[e])}}setCutoffUniformValues(e,t){if(!this.cutoffUniforms)return;const n=this.cutoffUniforms;if(!this.failedToCreate){e.program.set(this.program);for(const e in t)n[e].set(this.program,e,t[e])}}setLightsUniformValues(e,t){if(!this.lightsUniforms)return;const n=this.lightsUniforms;if(!this.failedToCreate){e.program.set(this.program);for(const e in t)n[e].set(this.program,e,t[e])}}setShadowUniformValues(e,t){if(this.failedToCreate||!this.shadowUniforms)return;const n=this.shadowUniforms;e.program.set(this.program);for(const r in t)n[r].set(this.program,r,t[r])}_drawDebugWireframe(t,n,r,i,o,a,s,l,c,u){const h=t.options.wireframe;if(!1===h.terrain&&!1===h.layers2D&&!1===h.layers3D)return;const d=t.context;if(!(()=>!(!h.terrain||"terrainRaster"!==this.name&&"globeRaster"!==this.name)||!(!h.layers2D||t._terrain&&t._terrain.renderingToTexture||!Di.includes(this.name))||!(!h.layers3D||!Li.includes(this.name)))())return;const p=d.gl,f=t.wireframeDebugCache.getLinesFromTrianglesBuffer(t.frameCounter,o,d);if(!f)return;const m=[...this.fixedDefines];m.push("DEBUG_WIREFRAME");const g=t.getOrCreateProgram(this.name,{config:this.configuration,defines:m});d.program.set(g.program);const y=(e,t,n)=>{if(t[e]&&n[e])for(const r in t[e])n[e][r]&&n[e][r].set(n.program,r,t[e][r].current)};c&&c.setUniforms(g.program,d,g.binderUniforms,s,{zoom:l}),y("fixedUniforms",this,g),y("terrainUniforms",this,g),y("globeUniforms",this,g),y("fogUniforms",this,g),y("lightsUniforms",this,g),y("shadowUniforms",this,g),f.bind(),d.setColorMode(new Nn([p.ONE,p.ONE_MINUS_SRC_ALPHA,p.ZERO,p.ONE],e.bA.transparent,[!0,!0,!0,!1])),d.setDepthMode(new Dn(n.func===p.LESS?p.LEQUAL:n.func,Dn.ReadOnly,n.range)),d.setStencilMode(zn.disabled);const _=3*a.primitiveLength*2,v=3*a.primitiveOffset*2*2;u&&u>1?p.drawElementsInstanced(p.LINES,_,p.UNSIGNED_SHORT,v,u):p.drawElements(p.LINES,_,p.UNSIGNED_SHORT,v),o.bind(),d.program.set(this.program),d.setDepthMode(n),d.setStencilMode(r),d.setColorMode(i)}checkUniforms(e,t,n){if(this.fixedDefines.includes(t))for(const r of Object.keys(n))if(!n[r].initialized)throw new Error("Program '".concat(this.name,"', from draw '").concat(e,"': uniform ").concat(r," not set but required by ").concat(t," being defined"))}draw(e,t,n,r,i,o,a,s,l,c,u,h,d,p,f,m){const g=e.context,y=g.gl;if(this.failedToCreate)return;g.program.set(this.program),g.setDepthMode(n),g.setStencilMode(r),g.setColorMode(i),g.setCullFace(o);for(const x of Object.keys(this.fixedUniforms))this.fixedUniforms[x].set(this.program,x,a[x]);p&&p.setUniforms(this.program,g,this.binderUniforms,h,{zoom:d});const _={[y.POINTS]:1,[y.LINES]:2,[y.TRIANGLES]:3,[y.LINE_STRIP]:1}[t];this.checkUniforms(s,"RENDER_SHADOWS",this.shadowUniforms);const v=m&&m>0?1:void 0;for(const x of u.get()){const o=x.vaos||(x.vaos={});(o[s]||(o[s]=new Or)).bind(g,this,l,p?p.getPaintVertexBuffers():[],c,x.vertexOffset,f||[],v),m&&m>1?y.drawElementsInstanced(t,x.primitiveLength*_,y.UNSIGNED_SHORT,x.primitiveOffset*_*2,m):c?y.drawElements(t,x.primitiveLength*_,y.UNSIGNED_SHORT,x.primitiveOffset*_*2):y.drawArrays(t,x.vertexOffset,x.vertexLength),t===y.TRIANGLES&&c&&this._drawDebugWireframe(e,n,r,i,c,x,h,d,p,m)}}}function Ri(t,n){const r=Math.pow(2,n.tileID.overscaledZ),i=n.tileSize*Math.pow(2,t.transform.tileZoom)/r,o=i*(n.tileID.canonical.x+n.tileID.wrap*r),a=i*n.tileID.canonical.y;return{u_image:0,u_texsize:n.imageAtlasTexture?n.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/e.ak(n,1,t.transform.tileZoom),u_pixel_coord_upper:[o>>16,a>>16],u_pixel_coord_lower:[65535&o,65535&a]}}const Fi={terrain:0,flat:1},Bi=e.a6.mat4.create(),Vi=(t,n,r,i,o,a,s,l,c,u,h,d,p,f,m,g,y,_)=>{const v=n.style.light,x=v.properties.get("position"),b=[x.x,x.y,x.z],w=e.a6.mat3.create();"viewport"===v.properties.get("anchor")&&(e.a6.mat3.fromRotation(w,-n.transform.angle),e.a6.vec3.transformMat3(b,b,w));const S=v.properties.get("color"),T=n.transform,E={u_matrix:t,u_lightpos:b,u_lightintensity:v.properties.get("intensity"),u_lightcolor:[S.r,S.g,S.b],u_vertical_gradient:+r,u_opacity:i,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Bi,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_height_type:Fi[u],u_base_type:Fi[h],u_ao:o,u_edge_radius:a,u_width_scale:s,u_flood_light_color:m,u_vertical_scale:g,u_flood_light_intensity:y,u_ground_shadow_factor:_};return"globe"===T.projection.name&&(E.u_tile_id=[l.canonical.x,l.canonical.y,1<<l.canonical.z],E.u_zoom_transition=d,E.u_inv_rot_matrix=f,E.u_merc_center=p,E.u_up_dir=T.projection.upVector(new e.bQ(0,0,0),p[0]*e.ab,p[1]*e.ab),E.u_height_lift=c),E},Ui=(e,t,n,r,i,o)=>({u_matrix:e,u_edge_radius:t,u_width_scale:n,u_vertical_scale:r,u_height_type:Fi[i],u_base_type:Fi[o]}),Gi=(t,n,r,i,o,a,s,l,c,u,h,d,p,f,m,g,y)=>{const _=Vi(t,n,r,i,o,a,s,l,u,h,d,p,f,m,g,y,1,[0,0,0]),v={u_height_factor:-Math.pow(2,l.overscaledZ)/c.tileSize/8};return e.l(_,Ri(n,c),v)},Hi=(e,t)=>({u_matrix:e,u_emissive_strength:t}),Zi=(t,n,r,i)=>e.l(Hi(t,n),Ri(r,i)),qi=(e,t,n)=>({u_matrix:e,u_world:n,u_emissive_strength:t}),Wi=(t,n,r,i,o)=>e.l(Zi(t,n,r,i),{u_world:o}),Xi=(t,n,r,i)=>{const o=e.ab/r.tileSize;return{u_matrix:t,u_camera_to_center_distance:n.getCameraToCenterDistance(i),u_extrude_scale:[n.pixelsToGLUnits[0]/o,n.pixelsToGLUnits[1]/o]}},Yi=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return{u_matrix:e,u_color:t.toRenderColor(null),u_overlay:0,u_overlay_scale:n}},Ki=e.a6.mat4.create(),Ji=(t,n,r,i,o,a,s)=>{const l=t.transform,c="globe"===l.projection.name,u=c?e.cI(l.zoom,n.canonical)*l._pixelsPerMercatorPixel:e.ak(r,1,a),h={u_matrix:n.projMatrix,u_extrude_scale:u,u_intensity:s,u_inv_rot_matrix:Ki,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(c){h.u_inv_rot_matrix=i,h.u_merc_center=o,h.u_tile_id=[n.canonical.x,n.canonical.y,1<<n.canonical.z],h.u_zoom_transition=e.a9(l.zoom);const t=o[0]*e.ab,r=o[1]*e.ab;h.u_up_dir=l.projection.upVector(new e.bQ(0,0,0),t,r)}return h};function Qi(e,t,n){let[r,i,o,a]=t,[s,l]=n;if(s===l)return[0,0,0,0];const c=255*(e-1)/(e*(l-s));return[r*c,i*c,o*c,a*c]}function $i(e,t,n){let[r,i]=n;return r===i?0:.5/e+(t-r)*(e-1)/(e*(i-r))}const eo=(t,n,r,i,o,a,s,l,c,u,h,d,p,f,m,g,y,_,v,x,b)=>({u_matrix:t,u_normalize_matrix:n,u_globe_matrix:r,u_merc_matrix:i,u_grid_matrix:o,u_tl_parent:a,u_scale_parent:u,u_fade_t:h.mix,u_opacity:h.opacity*d.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:d.paint.get("raster-brightness-min"),u_brightness_high:d.paint.get("raster-brightness-max"),u_saturation_factor:e.cJ(d.paint.get("raster-saturation")),u_contrast_factor:e.cK(d.paint.get("raster-contrast")),u_spin_weights:to(d.paint.get("raster-hue-rotate")),u_perspective_transform:p,u_raster_elevation:f,u_zoom_transition:s,u_merc_center:l,u_cutoff_params:c,u_colorization_mix:Qi(e.cL,g,_),u_colorization_offset:$i(e.cL,y,_),u_color_ramp:m,u_texture_offset:[x/(v+2*x),v/(v+2*x)],u_texture_res:[v+2*x,v+2*x],u_emissive_strength:b});function to(e){e*=Math.PI/180;const t=Math.sin(e),n=Math.cos(e);return[(2*n+1)/3,(-Math.sqrt(3)*t-n+1)/3,(Math.sqrt(3)*t-n+1)/3]}const no=.05,ro=(e,t,n,r,i,o,a,s,l,c,u,h)=>({u_matrix:e,u_normalize_matrix:t,u_globe_matrix:n,u_merc_matrix:r,u_grid_matrix:i,u_tl_parent:o,u_scale_parent:c,u_fade_t:u.mix,u_opacity:u.opacity,u_image0:0,u_image1:1,u_raster_elevation:h,u_zoom_transition:a,u_merc_center:s,u_cutoff_params:l}),io=(e,t,n,r,i,o,a,s,l,c)=>({u_particle_texture:e,u_particle_texture_side_len:t,u_tile_offset:n,u_velocity:r,u_color_ramp:o,u_velocity_res:i,u_max_speed:a,u_uv_offset:s,u_data_scale:[255*l[0],255*l[1]],u_data_offset:c,u_particle_pos_scale:1.1,u_particle_pos_offset:[no,no]}),oo=(e,t,n,r,i,o,a,s,l,c)=>({u_particle_texture:e,u_particle_texture_side_len:t,u_velocity:n,u_velocity_res:r,u_max_speed:i,u_speed_factor:o,u_reset_rate:a,u_rand_seed:Math.random(),u_uv_offset:s,u_data_scale:[255*l[0],255*l[1]],u_data_offset:c,u_particle_pos_scale:1.1,u_particle_pos_offset:[no,no]}),ao=e.a6.mat4.create(),so=(t,n,r,i,o,a,s,l,c,u,h,d,p,f,m,g,y,_,v,x,b,w)=>{const S=o.transform,T={u_is_size_zoom_constant:+("constant"===t||"source"===t),u_is_size_feature_constant:+("constant"===t||"camera"===t),u_size_t:n?n.uSizeT:0,u_size:n?n.uSize:0,u_camera_to_center_distance:S.getCameraToCenterDistance(v),u_rotate_symbol:+r,u_aspect_ratio:S.width/S.height,u_fade_change:o.options.fadeDuration?o.symbolFadeChange:1,u_matrix:a,u_label_plane_matrix:s,u_coord_matrix:l,u_is_text:+u,u_elevation_from_sea:c?1:0,u_pitch_with_map:+i,u_texsize:h,u_texsize_icon:d,u_texture:0,u_texture_icon:1,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:ao,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:ao,u_up_vector:[0,-1,0],u_color_adj_mat:x,u_icon_transition:b||0,u_gamma_scale:i?o.transform.getCameraToCenterDistance(v)*Math.cos(o.terrain?0:o.transform._pitch):1,u_device_pixel_ratio:e.q.devicePixelRatio,u_is_halo:+p,u_scale_factor:w||1};return"globe"===v.name&&(T.u_tile_id=[f.canonical.x,f.canonical.y,1<<f.canonical.z],T.u_zoom_transition=m,T.u_inv_rot_matrix=y,T.u_merc_center=g,T.u_camera_forward=S._camera.forward(),T.u_ecef_origin=e.cM(S.globeMatrix,f.toUnwrapped()),T.u_tile_matrix=Float32Array.from(S.globeMatrix),T.u_up_vector=_),T},lo=(e,t,n,r)=>({u_matrix:e,u_emissive_strength:t,u_opacity:n,u_color:r}),co=(t,n,r,i,o,a,s,l,c)=>e.l(function(t,n,r,i,o,a){const{width:s,height:l}=i.imageManager.getPixelSize(n),c=Math.pow(2,a.tileID.overscaledZ),u=a.tileSize*Math.pow(2,i.transform.tileZoom)/c,h=u*(a.tileID.canonical.x+a.tileID.wrap*c),d=u*a.tileID.canonical.y;return{u_image:0,u_pattern_tl:r.tl,u_pattern_br:r.br,u_texsize:[s,l],u_pattern_size:r.displaySize,u_pattern_units_to_pixels:o?[i.transform.width,-1*i.transform.height]:[1/e.ak(a,1,i.transform.tileZoom),1/e.ak(a,1,i.transform.tileZoom)],u_pixel_coord_upper:[h>>16,d>>16],u_pixel_coord_lower:[65535&h,65535&d]}}(0,a,s,i,l,c),{u_matrix:t,u_emissive_strength:n,u_opacity:r}),uo=new Float32Array(e.a6.mat4.identity([])),ho=function(t,n,r,i,o,a,s,l,c,u,h,d,p){let f=arguments.length>13&&void 0!==arguments[13]?arguments[13]:[0,0,0],m=arguments.length>14?arguments[14]:void 0;const g=o.style.light,y=g.properties.get("position"),_=[-y.x,-y.y,y.z],v=e.a6.mat3.create();"viewport"===g.properties.get("anchor")&&(e.a6.mat3.fromRotation(v,-o.transform.angle),e.a6.vec3.transformMat3(_,_,v));const x="MASK"===h.alphaMode,b=g.properties.get("color").toRenderColor(null),w=p.paint.get("model-ambient-occlusion-intensity"),S=p.paint.get("model-color").constantOr(e.bA.white).toRenderColor(null),T=p.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:t,u_lighting_matrix:n,u_normal_matrix:r,u_node_matrix:i||uo,u_lightpos:_,u_lightintensity:g.properties.get("intensity"),u_lightcolor:[b.r,b.g,b.b],u_camera_pos:f,u_opacity:a,u_baseTextureIsAlpha:0,u_alphaMask:+x,u_alphaCutoff:h.alphaCutoff,u_baseColorFactor:[s.r,s.g,s.b,s.a],u_emissiveFactor:[l[0],l[1],l[2],1],u_metallicFactor:c,u_roughnessFactor:u,u_baseColorTexture:qn.BaseColor,u_metallicRoughnessTexture:qn.MetallicRoughness,u_normalTexture:qn.Normal,u_occlusionTexture:qn.Occlusion,u_emissionTexture:qn.Emission,u_lutTexture:qn.LUT,u_color_mix:[S.r,S.g,S.b,T],u_aoIntensity:w,u_emissive_strength:d,u_occlusionTextureTransform:m||[0,0,0,0]}},po=function(e){return{u_matrix:e,u_instance:arguments.length>1&&void 0!==arguments[1]?arguments[1]:uo,u_node_matrix:arguments.length>2&&void 0!==arguments[2]?arguments[2]:uo}},fo={fillExtrusion:t=>({u_matrix:new e.bG(t),u_lightpos:new e.bI(t),u_lightintensity:new e.bJ(t),u_lightcolor:new e.bI(t),u_vertical_gradient:new e.bJ(t),u_opacity:new e.bJ(t),u_edge_radius:new e.bJ(t),u_width_scale:new e.bJ(t),u_ao:new e.bH(t),u_height_type:new e.bK(t),u_base_type:new e.bK(t),u_tile_id:new e.bI(t),u_zoom_transition:new e.bJ(t),u_inv_rot_matrix:new e.bG(t),u_merc_center:new e.bH(t),u_up_dir:new e.bI(t),u_height_lift:new e.bJ(t),u_flood_light_color:new e.bI(t),u_vertical_scale:new e.bJ(t),u_flood_light_intensity:new e.bJ(t),u_ground_shadow_factor:new e.bI(t)}),fillExtrusionDepth:t=>({u_matrix:new e.bG(t),u_edge_radius:new e.bJ(t),u_width_scale:new e.bJ(t),u_vertical_scale:new e.bJ(t),u_height_type:new e.bK(t),u_base_type:new e.bK(t)}),fillExtrusionPattern:t=>({u_matrix:new e.bG(t),u_lightpos:new e.bI(t),u_lightintensity:new e.bJ(t),u_lightcolor:new e.bI(t),u_vertical_gradient:new e.bJ(t),u_height_factor:new e.bJ(t),u_edge_radius:new e.bJ(t),u_width_scale:new e.bJ(t),u_ao:new e.bH(t),u_height_type:new e.bK(t),u_base_type:new e.bK(t),u_tile_id:new e.bI(t),u_zoom_transition:new e.bJ(t),u_inv_rot_matrix:new e.bG(t),u_merc_center:new e.bH(t),u_up_dir:new e.bI(t),u_height_lift:new e.bJ(t),u_image:new e.bK(t),u_texsize:new e.bH(t),u_pixel_coord_upper:new e.bH(t),u_pixel_coord_lower:new e.bH(t),u_tile_units_to_pixels:new e.bJ(t),u_opacity:new e.bJ(t)}),fillExtrusionGroundEffect:t=>({u_matrix:new e.bG(t),u_opacity:new e.bJ(t),u_ao_pass:new e.bJ(t),u_meter_to_tile:new e.bJ(t),u_ao:new e.bH(t),u_flood_light_intensity:new e.bJ(t),u_flood_light_color:new e.bI(t),u_attenuation:new e.bJ(t),u_edge_radius:new e.bJ(t),u_fb:new e.bK(t),u_fb_size:new e.bJ(t),u_dynamic_offset:new e.bJ(t)}),fill:t=>({u_matrix:new e.bG(t),u_emissive_strength:new e.bJ(t)}),fillPattern:t=>({u_matrix:new e.bG(t),u_emissive_strength:new e.bJ(t),u_image:new e.bK(t),u_texsize:new e.bH(t),u_pixel_coord_upper:new e.bH(t),u_pixel_coord_lower:new e.bH(t),u_tile_units_to_pixels:new e.bJ(t)}),fillOutline:t=>({u_matrix:new e.bG(t),u_emissive_strength:new e.bJ(t),u_world:new e.bH(t)}),fillOutlinePattern:t=>({u_matrix:new e.bG(t),u_emissive_strength:new e.bJ(t),u_world:new e.bH(t),u_image:new e.bK(t),u_texsize:new e.bH(t),u_pixel_coord_upper:new e.bH(t),u_pixel_coord_lower:new e.bH(t),u_tile_units_to_pixels:new e.bJ(t)}),circle:e.cN,collisionBox:t=>({u_matrix:new e.bG(t),u_camera_to_center_distance:new e.bJ(t),u_extrude_scale:new e.bH(t)}),collisionCircle:t=>({u_matrix:new e.bG(t),u_inv_matrix:new e.bG(t),u_camera_to_center_distance:new e.bJ(t),u_viewport_size:new e.bH(t)}),debug:t=>({u_color:new e.cu(t),u_matrix:new e.bG(t),u_overlay:new e.bK(t),u_overlay_scale:new e.bJ(t)}),clippingMask:t=>({u_matrix:new e.bG(t)}),heatmap:t=>({u_extrude_scale:new e.bJ(t),u_intensity:new e.bJ(t),u_matrix:new e.bG(t),u_inv_rot_matrix:new e.bG(t),u_merc_center:new e.bH(t),u_tile_id:new e.bI(t),u_zoom_transition:new e.bJ(t),u_up_dir:new e.bI(t)}),heatmapTexture:t=>({u_image:new e.bK(t),u_color_ramp:new e.bK(t),u_opacity:new e.bJ(t)}),hillshade:t=>({u_matrix:new e.bG(t),u_image:new e.bK(t),u_latrange:new e.bH(t),u_light:new e.bH(t),u_shadow:new e.cu(t),u_highlight:new e.cu(t),u_emissive_strength:new e.bJ(t),u_accent:new e.cu(t)}),hillshadePrepare:t=>({u_matrix:new e.bG(t),u_image:new e.bK(t),u_dimension:new e.bH(t),u_zoom:new e.bJ(t)}),line:e.cO,linePattern:e.cP,raster:t=>({u_matrix:new e.bG(t),u_normalize_matrix:new e.bG(t),u_globe_matrix:new e.bG(t),u_merc_matrix:new e.bG(t),u_grid_matrix:new e.cv(t),u_tl_parent:new e.bH(t),u_scale_parent:new e.bJ(t),u_fade_t:new e.bJ(t),u_opacity:new e.bJ(t),u_image0:new e.bK(t),u_image1:new e.bK(t),u_brightness_low:new e.bJ(t),u_brightness_high:new e.bJ(t),u_saturation_factor:new e.bJ(t),u_contrast_factor:new e.bJ(t),u_spin_weights:new e.bI(t),u_perspective_transform:new e.bH(t),u_raster_elevation:new e.bJ(t),u_zoom_transition:new e.bJ(t),u_merc_center:new e.bH(t),u_cutoff_params:new e.c7(t),u_colorization_mix:new e.c7(t),u_colorization_offset:new e.bJ(t),u_color_ramp:new e.bK(t),u_texture_offset:new e.bH(t),u_texture_res:new e.bH(t),u_emissive_strength:new e.bJ(t)}),rasterParticle:t=>({u_matrix:new e.bG(t),u_normalize_matrix:new e.bG(t),u_globe_matrix:new e.bG(t),u_merc_matrix:new e.bG(t),u_grid_matrix:new e.cv(t),u_tl_parent:new e.bH(t),u_scale_parent:new e.bJ(t),u_fade_t:new e.bJ(t),u_opacity:new e.bJ(t),u_image0:new e.bK(t),u_image1:new e.bK(t),u_raster_elevation:new e.bJ(t),u_zoom_transition:new e.bJ(t),u_merc_center:new e.bH(t),u_cutoff_params:new e.c7(t)}),rasterParticleTexture:t=>({u_texture:new e.bK(t),u_opacity:new e.bJ(t)}),rasterParticleDraw:t=>({u_particle_texture:new e.bK(t),u_particle_texture_side_len:new e.bJ(t),u_tile_offset:new e.bH(t),u_velocity:new e.bK(t),u_color_ramp:new e.bK(t),u_velocity_res:new e.bH(t),u_max_speed:new e.bJ(t),u_uv_offset:new e.bH(t),u_data_scale:new e.bH(t),u_data_offset:new e.bJ(t),u_particle_pos_scale:new e.bJ(t),u_particle_pos_offset:new e.bH(t)}),rasterParticleUpdate:t=>({u_particle_texture:new e.bK(t),u_particle_texture_side_len:new e.bJ(t),u_velocity:new e.bK(t),u_velocity_res:new e.bH(t),u_max_speed:new e.bJ(t),u_speed_factor:new e.bJ(t),u_reset_rate:new e.bJ(t),u_rand_seed:new e.bJ(t),u_uv_offset:new e.bH(t),u_data_scale:new e.bH(t),u_data_offset:new e.bJ(t),u_particle_pos_scale:new e.bJ(t),u_particle_pos_offset:new e.bH(t)}),symbol:t=>({u_is_size_zoom_constant:new e.bK(t),u_is_size_feature_constant:new e.bK(t),u_size_t:new e.bJ(t),u_size:new e.bJ(t),u_camera_to_center_distance:new e.bJ(t),u_rotate_symbol:new e.bK(t),u_aspect_ratio:new e.bJ(t),u_fade_change:new e.bJ(t),u_matrix:new e.bG(t),u_label_plane_matrix:new e.bG(t),u_coord_matrix:new e.bG(t),u_is_text:new e.bK(t),u_elevation_from_sea:new e.bK(t),u_pitch_with_map:new e.bK(t),u_texsize:new e.bH(t),u_texsize_icon:new e.bH(t),u_texture:new e.bK(t),u_texture_icon:new e.bK(t),u_gamma_scale:new e.bJ(t),u_device_pixel_ratio:new e.bJ(t),u_tile_id:new e.bI(t),u_zoom_transition:new e.bJ(t),u_inv_rot_matrix:new e.bG(t),u_merc_center:new e.bH(t),u_camera_forward:new e.bI(t),u_tile_matrix:new e.bG(t),u_up_vector:new e.bI(t),u_ecef_origin:new e.bI(t),u_is_halo:new e.bK(t),u_icon_transition:new e.bJ(t),u_color_adj_mat:new e.bG(t),u_scale_factor:new e.bJ(t)}),background:t=>({u_matrix:new e.bG(t),u_emissive_strength:new e.bJ(t),u_opacity:new e.bJ(t),u_color:new e.cu(t)}),backgroundPattern:t=>({u_matrix:new e.bG(t),u_emissive_strength:new e.bJ(t),u_opacity:new e.bJ(t),u_image:new e.bK(t),u_pattern_tl:new e.bH(t),u_pattern_br:new e.bH(t),u_texsize:new e.bH(t),u_pattern_size:new e.bH(t),u_pixel_coord_upper:new e.bH(t),u_pixel_coord_lower:new e.bH(t),u_pattern_units_to_pixels:new e.bH(t)}),terrainRaster:t=>({u_matrix:new e.bG(t),u_image0:new e.bK(t),u_skirt_height:new e.bJ(t),u_ground_shadow_factor:new e.bI(t)}),skybox:t=>({u_matrix:new e.bG(t),u_sun_direction:new e.bI(t),u_cubemap:new e.bK(t),u_opacity:new e.bJ(t),u_temporal_offset:new e.bJ(t)}),skyboxGradient:t=>({u_matrix:new e.bG(t),u_color_ramp:new e.bK(t),u_center_direction:new e.bI(t),u_radius:new e.bJ(t),u_opacity:new e.bJ(t),u_temporal_offset:new e.bJ(t)}),skyboxCapture:t=>({u_matrix_3f:new e.cv(t),u_sun_direction:new e.bI(t),u_sun_intensity:new e.bJ(t),u_color_tint_r:new e.c7(t),u_color_tint_m:new e.c7(t),u_luminance:new e.bJ(t)}),globeRaster:t=>({u_proj_matrix:new e.bG(t),u_globe_matrix:new e.bG(t),u_normalize_matrix:new e.bG(t),u_merc_matrix:new e.bG(t),u_zoom_transition:new e.bJ(t),u_merc_center:new e.bH(t),u_image0:new e.bK(t),u_grid_matrix:new e.cv(t),u_skirt_height:new e.bJ(t),u_far_z_cutoff:new e.bJ(t),u_frustum_tl:new e.bI(t),u_frustum_tr:new e.bI(t),u_frustum_br:new e.bI(t),u_frustum_bl:new e.bI(t),u_globe_pos:new e.bI(t),u_globe_radius:new e.bJ(t),u_viewport:new e.bH(t)}),globeAtmosphere:t=>({u_frustum_tl:new e.bI(t),u_frustum_tr:new e.bI(t),u_frustum_br:new e.bI(t),u_frustum_bl:new e.bI(t),u_horizon:new e.bJ(t),u_transition:new e.bJ(t),u_fadeout_range:new e.bJ(t),u_color:new e.c7(t),u_high_color:new e.c7(t),u_space_color:new e.c7(t),u_temporal_offset:new e.bJ(t),u_horizon_angle:new e.bJ(t)}),model:t=>({u_matrix:new e.bG(t),u_lighting_matrix:new e.bG(t),u_normal_matrix:new e.bG(t),u_node_matrix:new e.bG(t),u_lightpos:new e.bI(t),u_lightintensity:new e.bJ(t),u_lightcolor:new e.bI(t),u_camera_pos:new e.bI(t),u_opacity:new e.bJ(t),u_baseColorFactor:new e.c7(t),u_emissiveFactor:new e.c7(t),u_metallicFactor:new e.bJ(t),u_roughnessFactor:new e.bJ(t),u_baseTextureIsAlpha:new e.bK(t),u_alphaMask:new e.bK(t),u_alphaCutoff:new e.bJ(t),u_baseColorTexture:new e.bK(t),u_metallicRoughnessTexture:new e.bK(t),u_normalTexture:new e.bK(t),u_occlusionTexture:new e.bK(t),u_emissionTexture:new e.bK(t),u_lutTexture:new e.bK(t),u_color_mix:new e.c7(t),u_aoIntensity:new e.bJ(t),u_emissive_strength:new e.bJ(t),u_occlusionTextureTransform:new e.c7(t)}),modelDepth:t=>({u_matrix:new e.bG(t),u_instance:new e.bG(t),u_node_matrix:new e.bG(t)}),groundShadow:t=>({u_matrix:new e.bG(t),u_ground_shadow_factor:new e.bI(t)}),stars:t=>({u_matrix:new e.bG(t),u_up:new e.bI(t),u_right:new e.bI(t),u_intensity_multiplier:new e.bJ(t)}),snowParticle:t=>({u_modelview:new e.bG(t),u_projection:new e.bG(t),u_time:new e.bJ(t),u_cam_pos:new e.bI(t),u_velocityConeAperture:new e.bJ(t),u_velocity:new e.bJ(t),u_horizontalOscillationRadius:new e.bJ(t),u_horizontalOscillationRate:new e.bJ(t),u_boxSize:new e.bJ(t),u_billboardSize:new e.bJ(t),u_simpleShapeParameters:new e.bH(t),u_screenSize:new e.bH(t),u_thinningCenterPos:new e.bH(t),u_thinningShape:new e.bI(t),u_thinningAffectedRatio:new e.bJ(t),u_thinningParticleOffset:new e.bJ(t),u_particleColor:new e.c7(t),u_direction:new e.bI(t)}),rainParticle:t=>({u_modelview:new e.bG(t),u_projection:new e.bG(t),u_time:new e.bJ(t),u_cam_pos:new e.bI(t),u_texScreen:new e.bK(t),u_velocityConeAperture:new e.bJ(t),u_velocity:new e.bJ(t),u_boxSize:new e.bJ(t),u_rainDropletSize:new e.bH(t),u_distortionStrength:new e.bJ(t),u_rainDirection:new e.bI(t),u_color:new e.c7(t),u_screenSize:new e.bH(t),u_thinningCenterPos:new e.bH(t),u_thinningShape:new e.bI(t),u_thinningAffectedRatio:new e.bJ(t),u_thinningParticleOffset:new e.bJ(t),u_shapeDirectionalPower:new e.bJ(t),u_mode:new e.bJ(t)}),occlusion:t=>({u_matrix:new e.bG(t),u_anchorPos:new e.bI(t),u_screenSizePx:new e.bH(t),u_occluderSizePx:new e.bH(t),u_color:new e.c7(t)})};class mo{constructor(e,t,n,r){this.id=mo.uniqueIdxCounter,mo.uniqueIdxCounter++,this.context=e;const i=e.gl;this.buffer=i.createBuffer(),this.dynamicDraw=Boolean(n),this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),i.bufferData(i.ELEMENT_ARRAY_BUFFER,t.arrayBuffer,this.dynamicDraw?i.DYNAMIC_DRAW:i.STATIC_DRAW),this.dynamicDraw||r||t.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){this.id=mo.uniqueIdxCounter,mo.uniqueIdxCounter++;const t=this.context.gl;this.context.unbindVAO(),this.bind(),t.bufferSubData(t.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}mo.uniqueIdxCounter=0;const go={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class yo{constructor(e,t,n,r,i,o){this.length=t.length,this.attributes=n,this.itemSize=t.bytesPerElement,this.dynamicDraw=r,this.instanceCount=o,this.context=e;const a=e.gl;this.buffer=a.createBuffer(),e.bindVertexBuffer.set(this.buffer),a.bufferData(a.ARRAY_BUFFER,t.arrayBuffer,this.dynamicDraw?a.DYNAMIC_DRAW:a.STATIC_DRAW),this.dynamicDraw||i||t.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){const t=this.context.gl;this.bind(),t.bufferSubData(t.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,t){for(let n=0;n<this.attributes.length;n++){const r=t.attributes[this.attributes[n].name];void 0!==r&&e.enableVertexAttribArray(r)}}setVertexAttribPointers(e,t,n){for(let r=0;r<this.attributes.length;r++){const i=this.attributes[r],o=t.attributes[i.name];void 0!==o&&e.vertexAttribPointer(o,i.components,e[go[i.type]],!1,this.itemSize,i.offset+this.itemSize*(n||0))}}setVertexAttribDivisor(e,t,n){for(let r=0;r<this.attributes.length;r++){const i=t.attributes[this.attributes[r].name];void 0!==i&&this.instanceCount&&this.instanceCount>0&&e.vertexAttribDivisor(i,n)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class _o{constructor(e,t,n,r,i){this.context=e,this.width=t,this.height=n;const o=this.framebuffer=e.gl.createFramebuffer();r&&(this.colorAttachment=new yi(e,o)),i&&(this.depthAttachmentType=i,this.depthAttachment="renderbuffer"===i?new _i(e,o):new vi(e,o))}destroy(){const e=this.context.gl;if(this.colorAttachment){const t=this.colorAttachment.get();t&&e.deleteTexture(t)}if(this.depthAttachment&&this.depthAttachmentType)if("renderbuffer"===this.depthAttachmentType){const t=this.depthAttachment.get();t&&e.deleteRenderbuffer(t)}else{const t=this.depthAttachment.get();t&&e.deleteTexture(t)}e.deleteFramebuffer(this.framebuffer)}}class vo{constructor(e,t){this.gl=e,this.clearColor=new Fr(this),this.clearDepth=new Br(this),this.clearStencil=new Vr(this),this.colorMask=new Ur(this),this.depthMask=new Gr(this),this.stencilMask=new Hr(this),this.stencilFunc=new Zr(this),this.stencilOp=new qr(this),this.stencilTest=new Wr(this),this.depthRange=new Xr(this),this.depthTest=new Yr(this),this.depthFunc=new Kr(this),this.blend=new Jr(this),this.blendFunc=new Qr(this),this.blendColor=new $r(this),this.blendEquation=new ei(this),this.cullFace=new ti(this),this.cullFaceSide=new ni(this),this.frontFace=new ri(this),this.program=new ii(this),this.activeTexture=new oi(this),this.viewport=new ai(this),this.bindFramebuffer=new si(this),this.bindRenderbuffer=new li(this),this.bindTexture=new ci(this),this.bindVertexBuffer=new ui(this),this.bindElementBuffer=new hi(this),this.bindVertexArrayOES=new di(this),this.pixelStoreUnpack=new pi(this),this.pixelStoreUnpackPremultiplyAlpha=new fi(this),this.pixelStoreUnpackFlipY=new mi(this),this.options=t?i({},t):{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=e.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=e.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=e.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=e.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=e.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=e.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),this.maxPointSize=e.getParameter(e.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,t,n){return new mo(this,e,t,n)}createVertexBuffer(e,t,n,r,i){return new yo(this,e,t,n,r,i)}createRenderbuffer(e,t,n){const r=this.gl,i=r.createRenderbuffer();return this.bindRenderbuffer.set(i),r.renderbufferStorage(r.RENDERBUFFER,e,t,n),this.bindRenderbuffer.set(null),i}createFramebuffer(e,t,n,r){return new _o(this,e,t,n,r)}clear(e){let{color:t,depth:n,stencil:r,colorMask:i}=e;const o=this.gl;let a=0;t&&(a|=o.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set(i||[!0,!0,!0,!0])),void 0!==n&&(a|=o.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(n),this.depthMask.set(!0)),void 0!==r&&(a|=o.STENCIL_BUFFER_BIT,this.clearStencil.set(r),this.stencilMask.set(255)),o.clear(a)}setCullFace(e){!1===e.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}setStencilMode(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}setColorMode(t){e.bi(t.blendFunction,Nn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor),t.blendEquation?this.blendEquation.set(t.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(t.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}let xo;function bo(t,n,r,i,o,a,s){const l=t.context,c=l.gl,u=t.transform,h=t.getOrCreateProgram("collisionBox"),d=[];let p=0,f=0;for(let b=0;b<i.length;b++){const l=i[b],m=n.getTile(l),g=m.getBucket(r);if(!g)continue;const y=on(l,g,u);let _=y;0===o[0]&&0===o[1]||(_=t.translatePosMatrix(y,m,o,a));const v=s?g.textCollisionBox:g.iconCollisionBox,x=g.collisionCircleArray;if(x.length>0){const t=e.a6.mat4.create(),n=_;e.a6.mat4.mul(t,g.placementInvProjMatrix,u.glCoordMatrix),e.a6.mat4.mul(t,t,g.placementViewportMatrix),d.push({circleArray:x,circleOffset:f,transform:n,invTransform:t,projection:g.getProjection()}),p+=x.length/4,f=p}v&&(t.terrain&&t.terrain.setupElevationDraw(m,h),h.draw(t,c.LINES,Dn.disabled,zn.disabled,t.colorModeForRenderPass(),Bn.disabled,Xi(_,u,m,g.getProjection()),r.id,v.layoutVertexBuffer,v.indexBuffer,v.segments,null,u.zoom,null,[v.collisionVertexBuffer,v.collisionVertexBufferExt]))}if(!s||!d.length)return;const m=t.getOrCreateProgram("collisionCircle"),g=new e.cQ;g.resize(4*p),g._trim();let y=0;for(const e of d)for(let t=0;t<e.circleArray.length/4;t++){const n=4*t,r=e.circleArray[n+0],i=e.circleArray[n+1],o=e.circleArray[n+2],a=e.circleArray[n+3];g.emplace(y++,r,i,o,a,0),g.emplace(y++,r,i,o,a,1),g.emplace(y++,r,i,o,a,2),g.emplace(y++,r,i,o,a,3)}(!xo||xo.length<2*p)&&(xo=function(t){const n=2*t,r=new e.aP;r.resize(n),r._trim();for(let e=0;e<n;e++){const t=6*e;r.uint16[t+0]=4*e+0,r.uint16[t+1]=4*e+1,r.uint16[t+2]=4*e+2,r.uint16[t+3]=4*e+2,r.uint16[t+4]=4*e+3,r.uint16[t+5]=4*e+0}return r}(p));const _=l.createIndexBuffer(xo,!0),v=l.createVertexBuffer(g,e.cR.members,!0);for(const b of d){const n={u_matrix:b.transform,u_inv_matrix:b.invTransform,u_camera_to_center_distance:(x=u).getCameraToCenterDistance(b.projection),u_viewport_size:[x.width,x.height]};m.draw(t,c.TRIANGLES,Dn.disabled,zn.disabled,t.colorModeForRenderPass(),Bn.disabled,n,r.id,v,_,e.b2.simpleSegment(0,2*b.circleOffset,b.circleArray.length,b.circleArray.length/2),null,u.zoom)}var x;v.destroy(),_.destroy()}const wo=e.a6.mat4.create();function So(t){const n=t._camera.getWorldToCamera(t.worldSize,1),r=e.a6.mat4.multiply([],n,t.globeMatrix);e.a6.mat4.invert(r,r);const i=[0,0,0],o=[0,1,0,0];return e.a6.vec4.transformMat4(o,o,r),i[0]=o[0],i[1]=o[1],i[2]=o[2],e.a6.vec3.normalize(i,i),i}function To(t,n){let{width:r,height:i,anchor:o,textOffset:a,textScale:s}=t;const{horizontalAlign:l,verticalAlign:c}=e.by(o),u=-(l-.5)*r,h=-(c-.5)*i,d=e.bx(o,a);return new e.P((u/s+d[0])*n,(h/s+d[1])*n)}function Eo(t,n,r,i,o,a,s,l,c,u,h){const d=t.text.placedSymbolArray,p=t.text.dynamicLayoutVertexArray,f=t.icon.dynamicLayoutVertexArray,m={},g=t.getProjection(),y=an(l,g,a),_=a.elevation,v=g.upVectorScale(l.canonical,a.center.lat,a.worldSize).metersToTile;p.clear();for(let x=0;x<d.length;x++){const f=d.get(x),{tileAnchorX:b,tileAnchorY:w,numGlyphs:S}=f,T=f.hidden||!f.crossTileID||t.allowVerticalPlacement&&!f.placedOrientation?null:i[f.crossTileID];if(T){let i=0,d=0,x=0;if(_){const e=_?_.getAtTileOffset(l,b,w):0,[t,n,r]=g.upVector(l.canonical,b,w);i=e*t*v,d=e*n*v,x=e*r*v}let[E,A,M,P]=Gt(f.projectedAnchorX+i,f.projectedAnchorY+d,f.projectedAnchorZ+x,r?y:s);const k=Ht(a.getCameraToCenterDistance(g),P);let C=o.evaluateSizeForFeature(t.textSizeData,u,f)*k/e.br;r&&(C*=t.tilePixelRatio/c);const j=To(T,C);r?(({x:E,y:A,z:M}=g.projectTilePoint(b+j.x,w+j.y,l.canonical)),[E,A,M]=Gt(E+i,A+d,M+x,s)):(n&&j._rotate(-a.angle),E+=j.x,A+=j.y,M=0);const I=t.allowVerticalPlacement&&f.placedOrientation===e.bl.vertical?Math.PI/2:0;for(let t=0;t<S;t++)e.bo(p,E,A,M,I);h&&f.associatedIconIndex>=0&&(m[f.associatedIconIndex]={x:E,y:A,z:M,angle:I})}else $t(S,p)}if(h){f.clear();const n=t.icon.placedSymbolArray;for(let t=0;t<n.length;t++){const r=n.get(t),{numGlyphs:i}=r,o=m[t];if(r.hidden||!o)$t(i,f);else{const{x:t,y:n,z:r,angle:a}=o;for(let o=0;o<i;o++)e.bo(f,t,n,r,a)}}t.icon.dynamicLayoutVertexBuffer.updateData(f)}t.text.dynamicLayoutVertexBuffer.updateData(p)}function Ao(t,n,r,i,o,a){let s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{};const l=r.paint.get("icon-translate"),c=r.paint.get("text-translate"),u=r.paint.get("icon-translate-anchor"),h=r.paint.get("text-translate-anchor"),d=r.layout.get("icon-rotation-alignment"),p=r.layout.get("text-rotation-alignment"),f=r.layout.get("icon-pitch-alignment"),m=r.layout.get("text-pitch-alignment"),g=r.layout.get("icon-keep-upright"),y=r.layout.get("text-keep-upright"),_=r.paint.get("icon-color-saturation"),v=r.paint.get("icon-color-contrast"),x=r.paint.get("icon-color-brightness-min"),b=r.paint.get("icon-color-brightness-max"),w="sea"===r.layout.get("symbol-elevation-reference"),S=t.context,T=S.gl,E=t.transform,A="map"===d,M="map"===p,P="map"===f,k="map"===m,C=void 0!==r.layout.get("symbol-sort-key").constantOr(1);let j=!1;const I=t.depthModeForSublayer(0,Dn.ReadOnly),O=[e.am(E.center.lng),e.at(E.center.lat)],N=r.layout.get("text-variable-anchor"),D="globe"===E.projection.name,L=[],z=[0,-1,0];for(const R of i){const i=n.getTile(R),o=i.getBucket(r);if(!o)continue;if("mercator"===o.projection.name&&D)continue;if(o.fullyClipped)continue;const a="globe"===o.projection.name,d=a?e.a9(E.zoom):0,p=an(R,o.getProjection(),E),f=E.calculatePixelsToTileUnitsMatrix(i),m=N&&o.hasTextData(),S=o.hasIconTextFit()&&m&&o.hasIconData(),I=o.getProjection().createInversionMatrix(E,R.canonical),F=e=>{E.depthOcclusionForSymbolsAndCircles&&(r.hasInitialOcclusionOpacityProperties||t.terrain)&&(e.push("DEPTH_D24"),e.push("DEPTH_OCCLUSION"))},B=()=>{const n=A&&"point"!==r.layout.get("symbol-placement"),s=[];F(s);const c=n||S,h=r.paint.get("icon-image-cross-fade").constantOr(0);t.terrainRenderModeElevated()&&P&&s.push("PITCH_WITH_MAP_TERRAIN"),a&&(s.push("PROJECTION_GLOBE_VIEW"),c&&s.push("PROJECTED_POS_ON_VIEWPORT")),h>0&&s.push("ICON_TRANSITION"),o.icon.zOffsetVertexBuffer&&s.push("Z_OFFSET"),0===_&&0===v&&0===x&&1===b||s.push("COLOR_ADJUSTMENT"),o.sdfIcons&&s.push("RENDER_SDF");const m=o.icon.programConfigurations.get(r.id),y=t.getOrCreateProgram("symbol",{config:m,defines:s}),M=i.imageAtlasTexture?i.imageAtlasTexture.size:[0,0],k=o.iconSizeData,C=e.bk(k,E.zoom),j=P||0!==E.pitch,N=Bt(p,i.tileID.canonical,P,A,E,o.getProjection(),f),L=Ut(p,i.tileID.canonical,P,A,E,o.getProjection(),f),B=t.translatePosMatrix(L,i,l,u,!0),V=t.translatePosMatrix(p,i,l,u),U=c?wo:N,G=A&&!P&&!n;let H=z;!D&&!E.mercatorFromTransition||A||(H=So(E));const Z=a?H:z,q=r.getColorAdjustmentMatrix(_,v,x,b),W=so(k.kind,C,G,P,t,V,U,B,w,!1,M,[0,0],!0,R,d,O,I,Z,o.getProjection(),q,h),X=i.imageAtlasTexture?i.imageAtlasTexture:null,Y=1!==r.layout.get("icon-size").constantOr(0)||o.iconsNeedLinear,K=o.sdfIcons||t.options.rotating||t.options.zooming||Y||j?T.LINEAR:T.NEAREST,J=o.sdfIcons&&0!==r.paint.get("icon-halo-width").constantOr(1),Q=t.terrain&&P&&n?e.a6.mat4.invert(e.a6.mat4.create(),N):wo;if(n&&o.icon){const e=E.elevation,n=e?e.getAtTileOffsetFunc(R,E.center.lat,E.worldSize,o.getProjection()):null,r=Vt(p,i.tileID.canonical,P,A,E,o.getProjection(),f);qt(o,p,t,!1,r,L,P,g,n,R)}return{program:y,buffers:o.icon,uniformValues:W,atlasTexture:X,atlasTextureIcon:null,atlasInterpolation:K,atlasInterpolationIcon:null,isSDF:o.sdfIcons,hasHalo:J,tile:i,labelPlaneMatrixInv:Q}},V=()=>{const n=M&&"point"!==r.layout.get("symbol-placement"),s=[],l=n||N||S;t.terrainRenderModeElevated()&&k&&s.push("PITCH_WITH_MAP_TERRAIN"),a&&(s.push("PROJECTION_GLOBE_VIEW"),l&&s.push("PROJECTED_POS_ON_VIEWPORT")),o.text.zOffsetVertexBuffer&&s.push("Z_OFFSET"),o.iconsInText&&s.push("RENDER_TEXT_AND_SYMBOL"),s.push("RENDER_SDF"),F(s);const u=o.text.programConfigurations.get(r.id),m=t.getOrCreateProgram("symbol",{config:u,defines:s});let g,_=[0,0],v=null;const x=o.textSizeData;o.iconsInText&&(_=i.imageAtlasTexture?i.imageAtlasTexture.size:[0,0],v=i.imageAtlasTexture?i.imageAtlasTexture:null,g=k||0!==E.pitch||t.options.rotating||t.options.zooming||"composite"===x.kind||"camera"===x.kind?T.LINEAR:T.NEAREST);const b=i.glyphAtlasTexture?i.glyphAtlasTexture.size:[0,0],A=r.layout.get("text-size-scale-range"),P=e.ap(t.scaleFactor,A[0],A[1]),C=e.bk(x,E.zoom,P),j=Bt(p,i.tileID.canonical,k,M,E,o.getProjection(),f),L=Ut(p,i.tileID.canonical,k,M,E,o.getProjection(),f),B=t.translatePosMatrix(L,i,c,h,!0),V=t.translatePosMatrix(p,i,c,h),U=l?wo:j,G=M&&!k&&!n;let H=z;!D&&!E.mercatorFromTransition||M||(H=So(E));const Z=so(x.kind,C,G,k,t,V,U,B,w,!0,b,_,!0,R,d,O,I,a?H:z,o.getProjection(),null,null,P),q=i.glyphAtlasTexture?i.glyphAtlasTexture:null,W=T.LINEAR,X=0!==r.paint.get("text-halo-width").constantOr(1),Y=t.terrain&&k&&n?e.a6.mat4.invert(e.a6.mat4.create(),j):wo;if(n&&o.text){const e=E.elevation,n=e?e.getAtTileOffsetFunc(R,E.center.lat,E.worldSize,o.getProjection()):null,r=Vt(p,i.tileID.canonical,k,M,E,o.getProjection(),f);qt(o,p,t,!0,r,L,k,y,n,R)}return{program:m,buffers:o.text,uniformValues:Z,atlasTexture:q,atlasTextureIcon:v,atlasInterpolation:W,atlasInterpolationIcon:g,isSDF:!0,hasHalo:X,tile:i,labelPlaneMatrixInv:Y}},U=o.icon.segments.get().length,G=o.text.segments.get().length,H=U&&!s.onlyText?B():null,Z=G&&!s.onlyIcons?V():null,q=r.paint.get("icon-opacity").constantOr(1),W=r.paint.get("text-opacity").constantOr(1);if(C&&o.canOverlap){j=!0;const t=q&&!s.onlyText?o.icon.segments.get():[],n=W&&!s.onlyIcons?o.text.segments.get():[];for(const r of t)L.push({segments:new e.b2([r]),sortKey:r.sortKey,state:H});for(const r of n)L.push({segments:new e.b2([r]),sortKey:r.sortKey,state:Z})}else s.onlyText||L.push({segments:q?o.icon.segments:new e.b2([]),sortKey:0,state:H}),s.onlyIcons||L.push({segments:W?o.text.segments:new e.b2([]),sortKey:0,state:Z})}j&&L.sort(((e,t)=>e.sortKey-t.sortKey));for(const e of L){const n=e.state;if(n)if(t.terrain?t.terrain.setupElevationDraw(n.tile,n.program,{useDepthForOcclusion:E.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:n.labelPlaneMatrixInv}):t.setupDepthForOcclusion(E.depthOcclusionForSymbolsAndCircles,n.program),S.activeTexture.set(T.TEXTURE0),n.atlasTexture&&n.atlasTexture.bind(n.atlasInterpolation,T.CLAMP_TO_EDGE,!0),n.atlasTextureIcon&&(S.activeTexture.set(T.TEXTURE1),n.atlasTextureIcon&&n.atlasTextureIcon.bind(n.atlasInterpolationIcon,T.CLAMP_TO_EDGE,!0)),t.uploadCommonLightUniforms(t.context,n.program),n.hasHalo){const i=n.uniformValues;i.u_is_halo=1,Mo(n.buffers,e.segments,r,t,n.program,I,o,a,i,2),i.u_is_halo=0}else{if(n.isSDF){const i=n.uniformValues;n.hasHalo&&(i.u_is_halo=1,Mo(n.buffers,e.segments,r,t,n.program,I,o,a,i,1)),i.u_is_halo=0}Mo(n.buffers,e.segments,r,t,n.program,I,o,a,n.uniformValues,1)}}}function Mo(e,t,n,r,i,o,a,s,l,c){const u=[e.dynamicLayoutVertexBuffer,e.opacityVertexBuffer,e.iconTransitioningVertexBuffer,e.globeExtVertexBuffer,e.zOffsetVertexBuffer];i.draw(r,r.context.gl.TRIANGLES,o,a,s,Bn.disabled,l,n.id,e.layoutVertexBuffer,e.indexBuffer,t,n.paint,r.transform.zoom,e.programConfigurations.get(n.id),u,c)}function Po(e,t,n,r,i,o,a){const s=e.context.gl,l=n.paint.get("fill-pattern"),c=n.is3D(),u=c?e.stencilModeFor3D():zn.disabled,h=l&&l.constantOr(1);let d,p,f,m,g;a?(p=h&&!n.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",d=s.LINES):(p=h?"fillPattern":"fill",d=s.TRIANGLES);for(const y of r){const r=t.getTile(y);if(h&&!r.patternsLoaded())continue;const _=r.getBucket(n);if(!_)continue;e.prepareDrawTile();const v=_.programConfigurations.get(n.id),x=e.isTileAffectedByFog(y),b=e.getOrCreateProgram(p,{config:v,overrideFog:x});h&&(e.context.activeTexture.set(s.TEXTURE0),r.imageAtlasTexture&&r.imageAtlasTexture.bind(s.LINEAR,s.CLAMP_TO_EDGE),v.updatePaintBuffers());const w=l.constantOr(null);if(w&&r.imageAtlas){const e=r.imageAtlas.patternPositions[w.toString()];e&&v.setConstantPatternPositions(e)}const S=e.translatePosMatrix(y.projMatrix,r,n.paint.get("fill-translate"),n.paint.get("fill-translate-anchor")),T=n.paint.get("fill-emissive-strength");if(a){m=_.indexBuffer2,g=_.segments2;const t=e.terrain&&e.terrain.renderingToTexture?e.terrain.drapeBufferSize:[s.drawingBufferWidth,s.drawingBufferHeight];f="fillOutlinePattern"===p&&h?Wi(S,T,e,r,t):qi(S,T,t)}else m=_.indexBuffer,g=_.segments,f=h?Zi(S,T,e,r):Hi(S,T);e.uploadCommonUniforms(e.context,b,y.toUnwrapped()),b.draw(e,d,i,c?u:e.stencilModeForClipping(y),o,Bn.disabled,f,n.id,_.layoutVertexBuffer,m,g,n.paint,e.transform.zoom,v,void 0)}}function ko(t,n,r,i,o,a,s,l){r.resetLayerRenderingStats(t);const c=t.context,u=c.gl,h=t.transform,d=r.paint.get("fill-extrusion-pattern"),p=d.constantOr(1),f=r.paint.get("fill-extrusion-opacity"),m=t.style.enable3dLights(),g=r.paint.get(m&&!p?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),y=[r.paint.get("fill-extrusion-ambient-occlusion-intensity"),g],_=r.layout.get("fill-extrusion-edge-radius"),v=_>0&&!r.paint.get("fill-extrusion-rounded-roof"),x=v?0:_,b="globe"===h.projection.name?e.c_():0,w="globe"===h.projection.name,S=w?e.a9(h.zoom):0,T=[e.am(h.center.lng),e.at(h.center.lat)],E=r.paint.get("fill-extrusion-flood-light-color").toRenderColor(r.lut).toArray01().slice(0,3),A=r.paint.get("fill-extrusion-flood-light-intensity"),M=r.paint.get("fill-extrusion-vertical-scale"),P=0!==r.paint.get("fill-extrusion-line-width").constantOr(1),k=r.paint.get("fill-extrusion-height-alignment"),C=r.paint.get("fill-extrusion-base-alignment"),j=Jn(t,r.paint.get("fill-extrusion-cutoff-fade-range")),I=[];let O;w&&I.push("PROJECTION_GLOBE_VIEW"),y[0]>0&&I.push("FAUX_AO"),v&&I.push("ZERO_ROOF_RADIUS"),l&&I.push("HAS_CENTROID"),A>0&&I.push("FLOOD_LIGHT"),j.shouldRenderCutoff&&I.push("RENDER_CUTOFF"),P&&I.push("RENDER_WALL_MODE");const N="shadow"===t.renderPass,D=t.shadowRenderer,L=N&&!!D;t.shadowRenderer&&(t.shadowRenderer.useNormalOffset=!0);let z=[0,0,0];if(D){const e=t.style.directionalLight,n=t.style.ambientLight;e&&n&&(z=ir(t.style,e,n)),N||(I.push("RENDER_SHADOWS","DEPTH_TEXTURE"),D.useNormalOffset&&I.push("NORMAL_OFFSET")),O=I.concat(["SHADOWS_SINGLE_CASCADE"])}const R=L?"fillExtrusionDepth":p?"fillExtrusionPattern":"fillExtrusion",F=r.getLayerRenderingStats();for(const e of i){const i=n.getTile(e),m=i.getBucket(r);if(!m||m.projection.name!==h.projection.name)continue;let g=!1;D&&(g=0===D.getMaxCascadeForTile(e.toUnwrapped()));const _=t.isTileAffectedByFog(e),v=m.programConfigurations.get(r.id),L=t.getOrCreateProgram(R,{config:v,defines:g?O:I,overrideFog:_});if(t.terrain&&t.terrain.setupElevationDraw(i,L,{useMeterToDem:!0}),!m.centroidVertexBuffer){const e=L.attributes.a_centroid_pos;void 0!==e&&u.vertexAttrib2f(e,0,0)}!N&&D&&D.setupShadows(i.tileID.toUnwrapped(),L,"vector-tile",i.tileID.overscaledZ),p&&(t.context.activeTexture.set(u.TEXTURE0),i.imageAtlasTexture&&i.imageAtlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE),v.updatePaintBuffers());const B=d.constantOr(null);if(B&&i.imageAtlas){const e=i.imageAtlas.patternPositions[B.toString()];e&&v.setConstantPatternPositions(e)}const V=r.paint.get("fill-extrusion-vertical-gradient"),U=1/m.tileToMeter;let G;if(N&&D){if(Do(i.tileID,m,t))continue;const e=D.calculateShadowPassMatrixFromTile(i.tileID.toUnwrapped());G=Ui(e,x,U,M,k,C)}else{const n=t.translatePosMatrix(e.expandedProjMatrix,i,r.paint.get("fill-extrusion-translate"),r.paint.get("fill-extrusion-translate-anchor")),o=h.projection.createInversionMatrix(h,e.canonical);G=p?Gi(n,t,V,f,y,x,U,e,i,b,k,C,S,T,o,E,M):Vi(n,t,V,f,y,x,U,e,b,k,C,S,T,o,E,M,A,z)}t.uploadCommonUniforms(c,L,e.toUnwrapped(),null,j);let H=m.segments;if("mercator"===h.projection.name&&!N&&(H=m.getVisibleSegments(i.tileID,t.terrain,t.transform.getFrustum(0)),!H.get().length))continue;if(F)if(N)for(const e of H.get())F.numRenderedVerticesInShadowPass+=e.primitiveLength;else for(const e of H.get())F.numRenderedVerticesInTransparentPass+=e.primitiveLength;const Z=[];(t.terrain||l)&&Z.push(m.centroidVertexBuffer),w&&Z.push(m.layoutVertexExtBuffer),P&&Z.push(m.wallVertexBuffer),L.draw(t,c.gl.TRIANGLES,o,a,s,Bn.backCCW,G,r.id,m.layoutVertexBuffer,m.indexBuffer,H,r.paint,t.transform.zoom,v,Z)}t.shadowRenderer&&(t.shadowRenderer.useNormalOffset=!1)}function Co(t,n,r,i,o,a,s,l,c,u,h,d,p,f,m,g,y,_,v){const x=t.context,b=x.gl,w=t.transform,S=t.transform.zoom,T=[],E=Jn(t,r.paint.get("fill-extrusion-cutoff-fade-range"));"clear"===u?(T.push("CLEAR_SUBPASS"),v&&(T.push("CLEAR_FROM_TEXTURE"),x.activeTexture.set(b.TEXTURE0),v.bind(b.LINEAR,b.CLAMP_TO_EDGE))):"sdf"===u&&T.push("SDF_SUBPASS"),y&&T.push("HAS_CENTROID"),E.shouldRenderCutoff&&T.push("RENDER_CUTOFF");const A=r.layout.get("fill-extrusion-edge-radius"),M=(e,n,i,u,_)=>{const b=n.programConfigurations.get(r.id),w=t.isTileAffectedByFog(e),M=t.getOrCreateProgram("fillExtrusionGroundEffect",{config:b,defines:T,overrideFog:w}),P=((e,t,n,r,i,o,a,s,l,c,u)=>({u_matrix:t,u_opacity:n,u_ao_pass:r?1:0,u_meter_to_tile:i,u_ao:o,u_flood_light_intensity:a,u_flood_light_color:s,u_attenuation:l,u_edge_radius:c,u_fb:0,u_fb_size:u,u_dynamic_offset:1}))(0,u,h,c,_,[d,p*_],f,m,g,S>=17?0:A*_,v?v.size[0]:0),k=[];y&&k.push(n.hiddenByLandmarkVertexBuffer),t.uploadCommonUniforms(x,M,e.toUnwrapped(),null,E),M.draw(t,x.gl.TRIANGLES,o,a,s,l,P,r.id,n.vertexBuffer,n.indexBuffer,i,r.paint,S,b,k)};for(const P of i){const i=n.getTile(P),o=i.getBucket(r);if(!o||o.projection.name!==w.projection.name||!o.groundEffect||o.groundEffect&&!o.groundEffect.hasData())continue;const a=o.groundEffect,s=1/o.tileToMeter;{const e=t.translatePosMatrix(P.projMatrix,i,r.paint.get("fill-extrusion-translate"),r.paint.get("fill-extrusion-translate-anchor")),n=a.getDefaultSegment();M(P,a,n,e,s)}if(_)for(let l=0;l<4;l++){const o=e.c$[l](P),a=n.getTile(o);if(!a)continue;const c=a.getBucket(r);if(!c||c.projection.name!==w.projection.name||!c.groundEffect||c.groundEffect&&!c.groundEffect.hasData())continue;const u=c.groundEffect;let h,d;0===l?(h=[-e.ab,0,0],d=1):1===l?(h=[e.ab,0,0],d=0):2===l?(h=[0,-e.ab,0],d=3):(h=[0,e.ab,0],d=2);const p=u.regionSegments[d];if(!p)continue;const f=new Float32Array(16);e.a6.mat4.translate(f,P.projMatrix,h),M(P,u,p,t.translatePosMatrix(f,i,r.paint.get("fill-extrusion-translate"),r.paint.get("fill-extrusion-translate-anchor")),s)}}}function jo(t,n,r,i,o,a,s){0===i.centroidVertexArray.length&&i.createCentroidsBuffer();const l=a?a.findDEMTileFor(r):null;if(!(l&&l.dem||s))return;const c=t=>new e.P(Math.ceil((t+e.d2)*e.d3),0),u=e=>{const t=n.getSource().minzoom,r=e=>{const t=n.getTileByID(e);if(t&&t.hasData())return t.getBucket(o)},i=[0,-1,1];for(const n of i){if(e.overscaledZ+n<t)continue;const i=r(e.calculateScaledKey(e.overscaledZ+n));if(i)return i}},h=[0,0,0],d=(t,n)=>(h[0]=Math.min(t.min.y,n.min.y),h[1]=Math.max(t.max.y,n.max.y),h[2]=e.ab-n.min.x>t.max.x?n.min.x-e.ab:t.max.x,h),p=(t,n)=>(h[0]=Math.min(t.min.x,n.min.x),h[1]=Math.max(t.max.x,n.max.x),h[2]=e.ab-n.min.y>t.max.y?n.min.y-e.ab:t.max.y,h),f=[(e,t)=>d(e,t),(e,t)=>d(t,e),(e,t)=>p(e,t),(e,t)=>p(t,e)],m=(t,n,i,o,s,c,u)=>{if(!a)return 0;const h=[[c?i:t,c?t:i,0],[c?i:n,c?n:i,0]],d=u<0?e.ab+u:u,p=[c?d:(t+n)/2,c?(t+n)/2:d,0];return 0===i&&u<0||0!==i&&u>0?a.getForTilePoints(s,[p],!0,o):h.push(p),a.getForTilePoints(r,h,!0,l),Math.max(h[0][2],h[1][2],p[2])/a.exaggeration()};for(let _=0;_<4;_++){const t=i.borderFeatureIndices[_];if(0===t.length)continue;const n=e.c$[_](r),o=u(n);if(!(o&&o instanceof e.d0))continue;if(i.borderDoneWithNeighborZ[_]===o.canonical.z)continue;0===o.centroidVertexArray.length&&o.createCentroidsBuffer();const l=a?a.findDEMTileFor(n):null;if(!(l&&l.dem||s))continue;const h=(_<2?1:5)-_,d=o.borderDoneWithNeighborZ[h]!==i.canonical.z,p=o.borderFeatureIndices[h];let v=0;if(i.canonical.z!==o.canonical.z){for(const e of t)i.showCentroid(i.featuresOnBorder[e]);if(d)for(const e of p)o.showCentroid(o.featuresOnBorder[e]);i.borderDoneWithNeighborZ[_]=o.canonical.z,o.borderDoneWithNeighborZ[h]=i.canonical.z}for(const r of t){const t=i.featuresOnBorder[r],a=i.centroidData[t.centroidDataIndex],u=t.borders[_];let d;for(;v<p.length;){d=o.featuresOnBorder[p[v]];const e=d.borders[h];if(e[1]>u[0]+3||e[0]>u[0]-3)break;o.showCentroid(d),v++}if(d&&v<p.length){const r=v;let x=0;for(;!(d.borders[h][0]>u[1]-3)&&(x++,++v!==p.length);)d=o.featuresOnBorder[p[v]];d=o.featuresOnBorder[p[r]];let b=!1;if(x>=1){const e=d.borders[h];Math.abs(u[0]-e[0])<3&&Math.abs(u[1]-e[1])<3&&(x=1,b=!0,v=r+1)}else if(0===x){i.showCentroid(t);continue}const w=o.centroidData[d.centroidDataIndex];s&&b&&(((g=a).flags|(y=w).flags)&e.d1?(g.flags|=e.d1,y.flags|=e.d1):(g.flags&=~e.d1,y.flags&=~e.d1));const S=t.intersectsCount()>1||d.intersectsCount()>1;if(x>1)v=r,a.centroidXY=w.centroidXY=new e.P(0,0);else if(l&&l.dem&&!S){const t=f[_](a,w),r=_%2?e.ab-1:0,i=m(t[0],Math.min(e.ab-1,t[1]),r,l,n,_<2,t[2]);a.centroidXY=w.centroidXY=c(i)}else S?a.centroidXY=w.centroidXY=new e.P(0,0):(a.centroidXY=i.encodeBorderCentroid(t),w.centroidXY=o.encodeBorderCentroid(d));i.writeCentroidToBuffer(a),o.writeCentroidToBuffer(w)}else i.showCentroid(t)}i.borderDoneWithNeighborZ[_]=o.canonical.z,o.borderDoneWithNeighborZ[h]=i.canonical.z}var g,y;(i.needsCentroidUpdate||!i.centroidVertexBuffer&&0!==i.centroidVertexArray.length)&&i.uploadCentroid(t)}const Io=[1,0,0],Oo=[0,1,0],No=[0,0,1];function Do(t,n,r){const i=r.transform,o=r.shadowRenderer;if(!o)return!0;const a=t.toUnwrapped(),s=i.tileSize*o._cascades[r.currentShadowCascade].scale;let l=n.maxHeight;if(i.elevation){const e=i.elevation.getMinMaxForTile(t);e&&(l+=e.max)}const c=[...o.shadowDirection];c[2]=-c[2];const u=o.computeSimplifiedTileShadowVolume(a,l,s,c);if(!u)return!1;const h=[Io,Oo,No,c,[c[0],0,c[2]],[0,c[1],c[2]]],d="globe"===i.projection.name,p=i.scaleZoom(s),f=e.bO.fromInvProjectionMatrix(i.invProjMatrix,i.worldSize,p,!d),m=o.getCurrentCascadeFrustum();return 0===f.intersectsPrecise(u.vertices,u.planes,h)||0===m.intersectsPrecise(u.vertices,u.planes,h)}function Lo(t){return[t[0]*e.d4,t[1]*e.d4,t[2]*e.d4,0]}function zo(t,n,r,i,o,a,s,l,c){const u=i.getSource(),h=r.globeSharedBuffers;if(!h)return;let d,p,f;if(n&&(d=i.getTile(n)),u instanceof e.aD?(p=u.texture,f=e.cD(0,0,r.transform)):d&&n&&(p=d.texture,f=e.cD(n.canonical.z,n.canonical.x,r.transform)),!p||!f)return;t||(f=e.a6.mat4.scale(e.a6.mat4.create(),f,[1,-1,1]));const m=r.context,g=m.gl,y="nearest"===o.paint.get("raster-resampling")?g.NEAREST:g.LINEAR,_=r.colorModeForDrapableLayerRenderPass(a),v=s.defines;v.push("GLOBE_POLES");const x=new Dn(g.LEQUAL,Dn.ReadWrite,r.depthRangeFor3D),b=Float32Array.from(r.transform.expandedFarZProjMatrix),w=Float32Array.from(e.b6(e.cC(new e.bQ(0,0,0))));r.terrain&&r.terrain.prepareDrawTile(),m.activeTexture.set(g.TEXTURE0),p.bind(y,g.CLAMP_TO_EDGE),m.activeTexture.set(g.TEXTURE1),p.bind(y,g.CLAMP_TO_EDGE),p.useMipmap&&m.extTextureFilterAnisotropic&&r.transform.pitch>20&&g.texParameterf(g.TEXTURE_2D,m.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,m.extTextureFilterAnisotropicMax);const[S,T,E,A]=n?h.getPoleBuffers(n.canonical.z,!1):h.getPoleBuffers(0,!0),M=o.paint.get("raster-elevation");let P;t?(P=S,r.renderDefaultNorthPole=0!==M):(P=T,r.renderDefaultSouthPole=0!==M);const k=Lo(s.mix),C=((e,t,n,r,i,o,a,s,l,c,u,h,d)=>eo(e,t,n,new Float32Array(16),new Float32Array(9),[0,0],r,[0,0],[0,0,0,0],1,{opacity:1,mix:0},o,[0,0]||0,s,2,c,u,h,1,0,d))(b,w,f,e.a9(r.transform.zoom),0,o,0,M,0,k,s.offset,s.range,a),j=r.getOrCreateProgram("raster",{defines:v});r.uploadCommonUniforms(m,j,null),j.draw(r,g.TRIANGLES,x,c,_,l,C,o.id,P,E,A)}function Ro(e){const t=e._nearZ,n=e.projection.farthestPixelDistance(e),r=n-t,i=.2*e.height,o=t+i;return[t,n,(o-i-t)/r,(o-t)/r]}function Fo(e,t,n,r){if(e)return t instanceof tt&&e instanceof _t?t.getTextureDescriptor(e,n,!0):{texture:e.texture,mix:Lo(r.mix),offset:r.offset,buffer:0,tileSize:1}}var Bo=e.d5([{name:"a_index",type:"Int16",components:1}]);class Vo{constructor(t,n,r,i){const o={width:r[0],height:r[1],data:null},a=t.gl;this.targetColorTexture=new e.T(t,o,a.RGBA8,{useMipmap:!1}),this.backgroundColorTexture=new e.T(t,o,a.RGBA8,{useMipmap:!1}),this.context=t,this.updateParticleTexture(n,i),this.lastInvalidatedAt=0}updateParticleTexture(t,n){if(this.particleTextureDimension===n.width)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());const r=this.context.gl,i=n.width*n.height;this.particleTexture0=new e.T(this.context,n,r.RGBA8,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new e.T(this.context,n,r.RGBA8,{premultiply:!1,useMipmap:!1});const o=new e.d6;o.reserve(i);for(let e=0;e<i;e++)o.emplaceBack(e);this.particleIndexBuffer=this.context.createVertexBuffer(o,Bo.members,!0),this.particleSegment=e.b2.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=n.width}update(t){return!(this.lastInvalidatedAt<t&&(this.lastInvalidatedAt=e.q.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}function Uo(t,n,r){if(!t)return null;const i=n.getTextureDescriptor(t,r,!0);if(!i)return null;let{texture:o,mix:a,offset:s,tileSize:l,buffer:c,format:u}=i;if(!o||!u)return null;let h=!1;return"uint32"===u&&(h=!0,a[3]=0,a=Qi(e.d7,a,[0,r.paint.get("raster-particle-max-speed")]),s=$i(e.d7,s,[0,r.paint.get("raster-particle-max-speed")])),{texture:o,textureOffset:[c/(l+2*c),l/(l+2*c)],tileSize:l,scalarData:h,scale:a,offset:s,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[u]]}}function Go(e){const t=e._nearZ,n=e.projection.farthestPixelDistance(e),r=n-t,i=.2*e.height,o=t+i;return[t,n,(o-i-t)/r,(o-t)/r]}const Ho=new e.bA(1,0,0,1),Zo=new e.bA(0,1,0,1),qo=new e.bA(0,0,1,1),Wo=new e.bA(1,0,1,1),Xo=new e.bA(0,1,1,1);function Yo(t,n,r,i,o,a,s){const l=t.context,c=t.transform,u=l.gl,h="globe"===c.projection.name,d=h?["PROJECTION_GLOBE_VIEW"]:[];let p=e.a6.mat4.clone(r.projMatrix);if(h&&e.a9(c.zoom)>0){const t=e.b5(r.canonical,c),n=e.d8(t);p=e.a6.mat4.multiply(new Float32Array(16),c.globeMatrix,n),e.a6.mat4.multiply(p,c.projMatrix,p)}const f=e.a6.mat4.create();f[12]+=2*o/(e.q.devicePixelRatio*c.width),f[13]+=2*a/(e.q.devicePixelRatio*c.height),e.a6.mat4.multiply(p,f,p);const m=t.getOrCreateProgram("debug",{defines:d}),g=n.getTileByID(r.key);t.terrain&&t.terrain.setupElevationDraw(g,m);const y=Dn.disabled,_=zn.disabled,v=t.colorModeForRenderPass(),x="$debug";l.activeTexture.set(u.TEXTURE0),t.emptyTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE),h?g._makeGlobeTileDebugBuffers(t.context,c):g._makeDebugTileBoundsBuffers(t.context,c.projection);const b=g._tileDebugBuffer||t.debugBuffer,w=g._tileDebugIndexBuffer||t.debugIndexBuffer,S=g._tileDebugSegments||t.debugSegments;if(m.draw(t,u.LINE_STRIP,y,_,v,Bn.disabled,Yi(p,i),x,b,w,S,null,null,null,[g._globeTileDebugBorderBuffer]),s){const e=g.latestRawTileData,n=Math.floor((e&&e.byteLength||0)/1024);let i=r.canonical.toString();r.overscaledZ!==r.canonical.z&&(i+=" => ".concat(r.overscaledZ)),i+=" ".concat(g.state),i+=" ".concat(n,"kb"),function(e,t){e.initDebugOverlayCanvas();const n=e.debugOverlayCanvas,r=e.context.gl,i=e.debugOverlayCanvas.getContext("2d");i.clearRect(0,0,n.width,n.height),i.shadowColor="white",i.shadowBlur=2,i.lineWidth=1.5,i.strokeStyle="white",i.textBaseline="top",i.font="bold 36px Open Sans, sans-serif",i.fillText(t,5,5),i.strokeText(t,5,5),e.debugOverlayTexture.update(n),e.debugOverlayTexture.bind(r.LINEAR,r.CLAMP_TO_EDGE)}(t,i)}const T=n.getTile(r).tileSize,E=512/Math.min(T,512)*(r.overscaledZ/c.zoom)*.5,A=g._tileDebugTextBuffer||t.debugBuffer,M=g._tileDebugTextIndexBuffer||t.quadTriangleIndexBuffer,P=g._tileDebugTextSegments||t.debugSegments;m.draw(t,u.TRIANGLES,y,_,Nn.alphaBlended,Bn.disabled,Yi(p,e.bA.transparent,E),x,A,M,P,null,null,null,[g._globeTileDebugTextBuffer])}function Ko(e,t,n,r){Qo(e,0,t+n/2,e.transform.width,n,r)}function Jo(e,t,n,r){Qo(e,t-n/2,0,n,e.transform.height,r)}function Qo(t,n,r,i,o,a){const s=t.context,l=s.gl;l.enable(l.SCISSOR_TEST),l.scissor(n*e.q.devicePixelRatio,r*e.q.devicePixelRatio,i*e.q.devicePixelRatio,o*e.q.devicePixelRatio),s.clear({color:a}),l.disable(l.SCISSOR_TEST)}const $o=e.d5([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:ea}=$o;function ta(e,t,n,r){e.emplaceBack(t,n,r)}class na{constructor(t){this.vertexArray=new e.d9,this.indices=new e.aP,ta(this.vertexArray,-1,-1,1),ta(this.vertexArray,1,-1,1),ta(this.vertexArray,-1,1,1),ta(this.vertexArray,1,1,1),ta(this.vertexArray,-1,-1,-1),ta(this.vertexArray,1,-1,-1),ta(this.vertexArray,-1,1,-1),ta(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=t.createVertexBuffer(this.vertexArray,ea),this.indexBuffer=t.createIndexBuffer(this.indices),this.segment=e.b2.simpleSegment(0,0,36,12)}}function ra(t,n,r,i,o,a){const s=t.context.gl,l=n.paint.get("sky-atmosphere-color"),c=n.paint.get("sky-atmosphere-halo-color"),u=n.paint.get("sky-atmosphere-sun-intensity"),h=((e,t,n,r,i)=>({u_matrix_3f:e,u_sun_direction:t,u_sun_intensity:n,u_color_tint_r:[r.r,r.g,r.b,r.a],u_color_tint_m:[i.r,i.g,i.b,i.a],u_luminance:5e-5}))(e.a6.mat3.fromMat4(e.a6.mat3.create(),i),o,u,l,c);s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_CUBE_MAP_POSITIVE_X+a,n.skyboxTexture,0),r.draw(t,s.TRIANGLES,Dn.disabled,zn.disabled,Nn.unblended,Bn.frontCW,h,"skyboxCapture",n.skyboxGeometry.vertexBuffer,n.skyboxGeometry.indexBuffer,n.skyboxGeometry.segment)}const ia=e.d5([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class oa{constructor(t){const n=new e.da;n.emplaceBack(-1,1,1,0,0),n.emplaceBack(1,1,1,1,0),n.emplaceBack(1,-1,1,1,1),n.emplaceBack(-1,-1,1,0,1);const r=new e.aP;r.emplaceBack(0,1,2),r.emplaceBack(2,3,0),this.vertexBuffer=t.createVertexBuffer(n,ia.members),this.indexBuffer=t.createIndexBuffer(r),this.segments=e.b2.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const aa=e.d5([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class sa{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class la{constructor(t){this.colorModeAlphaBlendedWriteRGB=new Nn([1,On,1,On],e.bA.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new Nn([1,0,1,0],e.bA.transparent,[!1,!1,!1,!0]),this.params=new sa,this.updateNeeded=!0,t.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},(()=>{this.updateNeeded=!0})),t.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),t.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},(()=>{this.updateNeeded=!0})),t.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},(()=>{this.updateNeeded=!0}))}update(t){const n=t.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new oa(n);const t=this.params.sizeRange,r=this.params.intensityRange,i=function(t){const n=e.dd(30),r=[];for(let i=0;i<t;++i){const t=2*Math.PI*n(),i=Math.acos(1-2*n())-.5*Math.PI;r.push(e.a6.vec3.fromValues(Math.cos(i)*Math.cos(t),Math.cos(i)*Math.sin(t),Math.sin(i)))}return r}(this.params.starsCount),o=e.dd(300),a=new e.db,s=new e.aP;let l=0;for(let n=0;n<i.length;++n){const c=e.a6.vec3.scale([],i[n],200),u=Math.max(0,1+.01*t*(1*o()-.5)),h=Math.max(0,1+.01*r*(1*o()-.5));a.emplaceBack(c[0],c[1],c[2],-1,-1,u,h),a.emplaceBack(c[0],c[1],c[2],1,-1,u,h),a.emplaceBack(c[0],c[1],c[2],1,1,u,h),a.emplaceBack(c[0],c[1],c[2],-1,1,u,h),s.emplaceBack(l+0,l+1,l+2),s.emplaceBack(l+0,l+2,l+3),l+=4}this.starsVx=n.createVertexBuffer(a,aa.members),this.starsIdx=n.createIndexBuffer(s),this.starsSegments=e.b2.simpleSegment(0,0,a.length,s.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(t,n){const r=t.context,i=r.gl,o=t.transform,a=new Dn(i.LEQUAL,Dn.ReadOnly,[0,1]),s=e.a9(o.zoom),l=t.style.getLut(n.scope),c=n.properties.get("color").toRenderColor(l).toArray01(),u=n.properties.get("high-color").toRenderColor(l).toArray01(),h=n.properties.get("space-color").toRenderColor(l).toArray01PremultipliedAlpha(),d=5e-4,p=e.dc(n.properties.get("horizon-blend"),0,1,d,.25),f=e.cx(t,r,o)&&p===d?o.worldSize/(2*Math.PI*1.025)-1:o.globeRadius,m=t.frameCounter/1e3%1,g=e.a6.vec3.length(o.globeCenterInViewSpace),y=Math.sqrt(Math.pow(g,2)-Math.pow(f,2)),_=Math.acos(y/g),v=e=>{const n="globe"===o.projection.name?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];e&&n.push("ALPHA_PASS");const l=t.getOrCreateProgram("globeAtmosphere",{defines:n}),d=((e,t,n,r,i,o,a,s,l,c,u,h)=>({u_frustum_tl:e,u_frustum_tr:t,u_frustum_br:n,u_frustum_bl:r,u_horizon:i,u_transition:o,u_fadeout_range:a,u_color:s,u_high_color:l,u_space_color:c,u_temporal_offset:u,u_horizon_angle:h}))(o.frustumCorners.TL,o.frustumCorners.TR,o.frustumCorners.BR,o.frustumCorners.BL,o.frustumCorners.horizon,s,p,c,u,h,m,_);t.uploadCommonUniforms(r,l);const f=this.atmosphereBuffer;f&&l.draw(t,i.TRIANGLES,a,zn.disabled,e?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,Bn.backCW,d,e?"atmosphere_glow_alpha":"atmosphere_glow",f.vertexBuffer,f.indexBuffer,f.segments)};v(!1),v(!0)}drawStars(t,n){const r=e.ap(n.properties.get("star-intensity"),0,1);if(0===r)return;const i=t.context,o=i.gl,a=t.transform,s=t.getOrCreateProgram("stars"),l=e.a6.quat.identity([]);e.a6.quat.rotateX(l,l,-a._pitch),e.a6.quat.rotateZ(l,l,-a.angle),e.a6.quat.rotateX(l,l,e.bC(a._center.lat)),e.a6.quat.rotateY(l,l,-e.bC(a._center.lng));const c=e.a6.mat4.fromQuat(new Float32Array(16),l),u=e.a6.mat4.multiply([],a.starsProjMatrix,c),h=e.a6.mat3.fromMat4([],c),d=e.a6.mat3.invert([],h),p=[0,1,0];e.a6.vec3.transformMat3(p,p,d),e.a6.vec3.scale(p,p,this.params.sizeMultiplier);const f=[1,0,0];e.a6.vec3.transformMat3(f,f,d),e.a6.vec3.scale(f,f,this.params.sizeMultiplier);const m=(g=p,y=f,_=r,{u_matrix:Float32Array.from(u),u_up:g,u_right:y,u_intensity_multiplier:_});var g,y,_;t.uploadCommonUniforms(i,s),this.starsVx&&this.starsIdx&&s.draw(t,o.TRIANGLES,Dn.disabled,zn.disabled,this.colorModeAlphaBlendedWriteRGB,Bn.disabled,m,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function ca(t,n){const r=[...t],i=n.cameraWorldSizeForFog/n.worldSize,o=e.a6.mat4.identity([]);return e.a6.mat4.scale(o,o,[i,i,1]),e.a6.mat4.multiply(r,o,r),e.a6.mat4.multiply(r,n.worldToFogMatrix,r),r}function ua(t,n,r,i,o){const a=r.material,s=i.context,{baseColorTexture:l,metallicRoughnessTexture:c}=a.pbrMetallicRoughness,{normalTexture:u,occlusionTexture:h,emissionTexture:d}=a;function p(e,n,r){if(e&&(t.push(n),s.activeTexture.set(s.gl.TEXTURE0+r),e.gfxTexture)){const{minFilter:t,magFilter:n,wrapS:r,wrapT:i}=e.sampler;e.gfxTexture.bindExtraParam(t,n,r,i)}}p(l,"HAS_TEXTURE_u_baseColorTexture",qn.BaseColor),p(c,"HAS_TEXTURE_u_metallicRoughnessTexture",qn.MetallicRoughness),p(u,"HAS_TEXTURE_u_normalTexture",qn.Normal),p(h,"HAS_TEXTURE_u_occlusionTexture",qn.Occlusion),p(d,"HAS_TEXTURE_u_emissionTexture",qn.Emission),o&&(o.texture||(o.texture=new e.df(i.context,o.image,[o.image.height,o.image.height,o.image.height],s.gl.RGBA8)),s.activeTexture.set(s.gl.TEXTURE0+qn.LUT),o.texture&&o.texture.bind(s.gl.LINEAR,s.gl.CLAMP_TO_EDGE),t.push("APPLY_LUT_ON_GPU")),r.texcoordBuffer&&(t.push("HAS_ATTRIBUTE_a_uv_2f"),n.push(r.texcoordBuffer)),r.colorBuffer&&(t.push(12===r.colorBuffer.itemSize?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),n.push(r.colorBuffer)),r.normalBuffer&&(t.push("HAS_ATTRIBUTE_a_normal_3f"),n.push(r.normalBuffer)),r.pbrBuffer&&(t.push("HAS_ATTRIBUTE_a_pbr"),t.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),n.push(r.pbrBuffer)),"OPAQUE"!==a.alphaMode&&"MASK"!==a.alphaMode||t.push("UNPREMULT_TEXTURE_IN_SHADER"),a.defined||t.push("DIFFUSE_SHADED"),t.push("USE_STANDARD_DERIVATIVES");const f=i.shadowRenderer;f&&(t.push("RENDER_SHADOWS","DEPTH_TEXTURE"),f.useNormalOffset&&t.push("NORMAL_OFFSET"))}function ha(t,n,r,i,o,a){const s=r.paint.get("model-opacity"),l=n.context,c=new Dn(n.context.gl.LEQUAL,Dn.ReadWrite,n.depthRangeFor3D),u=n.transform,h=t.mesh,d=h.material,p=d.pbrMetallicRoughness,f=n.style.fog;let m;m="pixels"===n.transform.projection.zAxisUnit?[...t.nodeModelMatrix]:e.a6.mat4.multiply([],i.zScaleMatrix,t.nodeModelMatrix),e.a6.mat4.multiply(m,i.negCameraPosMatrix,m);const g=e.a6.mat4.invert([],m);e.a6.mat4.transpose(g,g);const y=r.paint.get("model-emissive-strength").constantOr(0),_=ho(new Float32Array(t.worldViewProjection),new Float32Array(m),new Float32Array(g),null,n,s,p.baseColorFactor.toRenderColor(null),d.emissiveFactor,p.metallicFactor,p.roughnessFactor,d,y,r),v={defines:[]},x=[],b=n.shadowRenderer;b&&(b.useNormalOffset=!1),ua(v.defines,x,h,n,r.lut);let w=null;if(f){const e=ca(t.nodeModelMatrix,n.transform);if(w=new Float32Array(e),"globe"!==u.projection.name){const t=h.aabb.min,n=h.aabb.max,[r,i]=f.getOpacityForBounds(e,t[0],t[1],n[0],n[1]);v.overrideFog=r>=Re||i>=Re}}const S=Jn(n,r.paint.get("model-cutoff-fade-range"));S.shouldRenderCutoff&&v.defines.push("RENDER_CUTOFF");const T=n.getOrCreateProgram("model",v);n.uploadCommonUniforms(l,T,null,w,S),"shadow"!==n.renderPass&&b&&b.setupShadowsFromMatrix(t.nodeModelMatrix,T),T.draw(n,l.gl.TRIANGLES,c,o,a,h.material.doubleSided?Bn.disabled:Bn.backCCW,_,r.id,h.vertexBuffer,h.indexBuffer,h.segments,r.paint,n.transform.zoom,void 0,x)}function da(t,n,r,i,o,a,s){let l;l="globe"===t.projection.name?e.dg(r,t):[...r],e.a6.mat4.multiply(l,l,n.matrix);const c=e.a6.mat4.multiply([],i,l);if(n.meshes)for(const u of n.meshes){if("BLEND"!==u.material.alphaMode){s.push({mesh:u,depth:0,modelIndex:o,worldViewProjection:c,nodeModelMatrix:l});continue}const t=e.a6.vec3.transformMat4([],u.centroid,c);t[2]>0&&a.push({mesh:u,depth:t[2],modelIndex:o,worldViewProjection:c,nodeModelMatrix:l})}if(n.children)for(const e of n.children)da(t,e,r,i,o,a,s)}function pa(e,t,n,r){const i=n.shadowRenderer;if(!i)return;const o=i.getShadowPassDepthMode(),a=i.getShadowPassColorMode(),s=i.calculateShadowPassMatrixFromMatrix(t),l=po(s);n.getOrCreateProgram("modelDepth",{defines:n._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(n,n.context.gl.TRIANGLES,o,zn.disabled,a,Bn.backCCW,l,r.id,e.vertexBuffer,e.indexBuffer,e.segments,r.paint,n.transform.zoom,void 0,void 0)}function fa(t,n,r){const i=n.updateZoomBasedPaintProperties(),o=function(t,n,r){let i,o,a,s=t.terrain?t.terrain.exaggeration():0;if(t.terrain&&s>0){const n=t.terrain,o=n.findDEMTileFor(r);o&&o.dem?i=e.di.create(n,r,o):s=0}if(0===s&&(n.terrainElevationMin=0,n.terrainElevationMax=0),s===n.validForExaggeration&&(0===s||i&&i._demTile&&i._demTile.tileID===n.validForDEMTile.id&&i._dem._timestamp===n.validForDEMTile.timestamp))return!1;for(const e in n.instancesPerModel){const t=n.instancesPerModel[e];for(let e=0;e<t.instancedDataArray.length;++e){const r=(i?s*i.getElevationAt(0|t.instancedDataArray.float32[16*e],0|t.instancedDataArray.float32[16*e+1],!0,!0):0)+t.instancesEvaluatedElevation[e];t.instancedDataArray.float32[16*e+6]=r,o=o?Math.min(n.terrainElevationMin,r):r,a=a?Math.max(n.terrainElevationMax,r):r}}return n.terrainElevationMin=o||0,n.terrainElevationMax=a||0,n.validForExaggeration=s,n.validForDEMTile=i&&i._demTile?{id:i._demTile.tileID,timestamp:i._dem._timestamp}:{id:void 0,timestamp:0},!0}(t,n,r);(i||o)&&(n.uploaded=!1,n.upload(t.context))}const ma={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new e.ca([0,0,0],[e.ab,e.ab,0])};function ga(t,n){const r=1<<t.canonical.z,i=n.getFreeCameraOptions().position,o=n.elevation,a=t.canonical.x/r,s=(t.canonical.x+1)/r,l=t.canonical.y/r,c=(t.canonical.y+1)/r;let u=n._centerAltitude;if(o){const e=o.getMinMaxForTile(t);e&&e.max>u&&(u=e.max)}const h=e.ap(i.x,a,s)-i.x,d=e.ap(i.y,l,c)-i.y,p=e.bE(u,n.center.lat)-i.z;return n._zoomFromMercatorZ(Math.sqrt(h*h+d*d+p*p))}function ya(e,t,n,r,i,o,a){const s=e.context,l="shadow"===e.renderPass,c=e.shadowRenderer,u=l&&c?c.getShadowPassDepthMode():new Dn(s.gl.LEQUAL,Dn.ReadWrite,e.depthRangeFor3D),h=e.isTileAffectedByFog(o);if(n.meshes)for(const d of n.meshes){const p=["MODEL_POSITION_ON_GPU"],f=[];let m,g,y;r.instancedDataArray.length>20&&p.push("INSTANCED_ARRAYS");const _=Jn(e,t.paint.get("model-cutoff-fade-range"));if(_.shouldRenderCutoff&&p.push("RENDER_CUTOFF"),l&&c)m=e.getOrCreateProgram("modelDepth",{defines:p}),g=po(a.shadowTileMatrix,a.shadowTileMatrix,Float32Array.from(n.matrix)),y=c.getShadowPassColorMode();else{ua(p,f,d,e,t.lut),m=e.getOrCreateProgram("model",{defines:p,overrideFog:h});const r=d.material,l=r.pbrMetallicRoughness,u=t.paint.get("model-opacity"),v=t.paint.get("model-emissive-strength").constantOr(0);g=ho(o.expandedProjMatrix,Float32Array.from(n.matrix),new Float32Array(16),null,e,u,l.baseColorFactor.toRenderColor(null),r.emissiveFactor,l.metallicFactor,l.roughnessFactor,r,v,t,i),c&&(a.shadowUniformsInitialized?m.setShadowUniformValues(s,c.getShadowUniformValues()):(c.setupShadows(o.toUnwrapped(),m,"model-tile",o.overscaledZ),a.shadowUniformsInitialized=!0)),y=_.shouldRenderCutoff||u<1||"OPAQUE"!==r.alphaMode?Nn.alphaBlended:Nn.unblended}e.uploadCommonUniforms(s,m,o.toUnwrapped(),null,_);const v=d.material.doubleSided?Bn.disabled:Bn.backCCW;if(r.instancedDataArray.length>20)f.push(r.instancedDataBuffer),m.draw(e,s.gl.TRIANGLES,u,zn.disabled,y,v,g,t.id,d.vertexBuffer,d.indexBuffer,d.segments,t.paint,e.transform.zoom,void 0,f,r.instancedDataArray.length);else{const n=l?"u_instance":"u_normal_matrix";for(let i=0;i<r.instancedDataArray.length;++i)g[n]=new Float32Array(r.instancedDataArray.arrayBuffer,64*i,16),m.draw(e,s.gl.TRIANGLES,u,zn.disabled,y,v,g,t.id,d.vertexBuffer,d.indexBuffer,d.segments,t.paint,e.transform.zoom,void 0,f)}}if(n.children)for(const d of n.children)ya(e,t,d,r,i,o,a)}const _a=[1,-1,1];function va(t,n,r,i){if(!r.modelManager)return!0;const o=r.modelManager;if(!r.shadowRenderer)return!0;const a=r.shadowRenderer,s=n.aabb;let l=!0,c=t.maxHeight;if(0===c){let e=0;for(const n in t.instancesPerModel){const t=o.getModel(n,i);t?e=Math.max(e,Math.max(Math.max(t.aabb.max[0],t.aabb.max[1]),t.aabb.max[2])):l=!1}c=t.maxScale*e*1.41+t.maxVerticalOffset,l&&(t.maxHeight=c)}s.max[2]=c,s.min[2]+=t.terrainElevationMin,s.max[2]+=t.terrainElevationMax,e.a6.vec3.transformMat4(s.min,s.min,n.tileMatrix),e.a6.vec3.transformMat4(s.max,s.max,n.tileMatrix);const u=s.intersects(a.getCurrentCascadeFrustum());return 0===r.currentShadowCascade&&(t.isInsideFirstShadowMapFrustum=2===u),0===u}function xa(t,n){const r=t.uniformValues.u_cutoff_params[0],i=t.uniformValues.u_cutoff_params[1],o=t.uniformValues.u_cutoff_params[2],a=t.uniformValues.u_cutoff_params[3];return i===r||a===o?1:e.ap(((n-r)/(i-r)-o)/(a-o),0,1)}function ba(t,n,r,i){if(n.pitch<20)return 1;const o=n.getWorldToCameraMatrix();e.a6.mat4.multiply(o,o,t);const a=e.a6.vec4.fromValues(r.min[0],r.min[1],r.min[2],1);let s=e.a6.vec4.transformMat4(e.a6.vec4.create(),a,o),l=s,c=s;a[1]=r.max[1],s=e.a6.vec4.transformMat4(e.a6.vec4.create(),a,o),l=s[1]<l[1]?s:l,c=s[1]>c[1]?s:c,a[0]=r.max[0],s=e.a6.vec4.transformMat4(e.a6.vec4.create(),a,o),l=s[1]<l[1]?s:l,c=s[1]>c[1]?s:c,a[1]=r.min[1],s=e.a6.vec4.transformMat4(e.a6.vec4.create(),a,o),l=s[1]<l[1]?s:l,c=s[1]>c[1]?s:c;const u=e.ap(i[0],0,1),h=100*n.pixelsPerMeter*e.ap(i[1],0,1),d=e.ap(i[2],0,1),p=e.a6.vec4.lerp(e.a6.vec4.create(),l,c,u),f=Math.tan(.5*n.fovX),m=-p[2]*f;if(0===h)return p[1]<-Math.abs(m)?d:1;const g=(-Math.abs(m)-p[1])/h,y=(e,t,n)=>(1-n)*e+n*t,_=e.ap(y(1,d,g),d,1);return y(1,_,e.ap((n.pitch-20)/20,0,1))}class wa{}class Sa{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(t,n,r){{const e=this._storage.get(n.id);if(e)return e.lastUsedFrameIdx=t,e.buf}const i=r.gl,o=i.getBufferParameter(i.ELEMENT_ARRAY_BUFFER,i.BUFFER_SIZE),a=new ArrayBuffer(o),s=new Int16Array(a);i.getBufferSubData(i.ELEMENT_ARRAY_BUFFER,0,new Int16Array(a));const l=new e.dk;for(let e=0;e<o/2;e+=3){const t=s[e],n=s[e+1],r=s[e+2];l.emplaceBack(t,n),l.emplaceBack(n,r),l.emplaceBack(r,t)}const c=r.bindVertexArrayOES.current,u=new wa;return u.buf=new mo(r,l),u.lastUsedFrameIdx=t,this._storage.set(n.id,u),r.bindVertexArrayOES.set(c),u.buf}update(e){for(const[t,n]of this._storage)e-n.lastUsedFrameIdx>30&&(n.buf.destroy(),this._storage.delete(t))}destroy(){for(const[e,t]of this._storage)t.buf.destroy(),this._storage.delete(e)}}class Ta{constructor(e){this.occluderSize=30,this.depthOffset=-1e-4,e.registerParameter(this,["Occlusion"],"occluderSize",{min:1,max:100,step:1}),e.registerParameter(this,["Occlusion"],"depthOffset",{min:-.05,max:0,step:1e-5})}}class Ea{registerParameter(){}registerButton(){}registerBinding(){}refreshUI(){}}const Aa={symbol:function(t,n,r,i,o){if("translucent"!==t.renderPass)return;const a=zn.disabled,s=t.colorModeForRenderPass(),l=r.layout.get("text-variable-anchor"),c=r.layout.get("text-size-scale-range"),u=e.ap(t.scaleFactor,c[0],c[1]);l&&function(t,n,r,i,o,a,s,l){const c=n.transform,u="map"===o,h="map"===a;for(const d of t){const t=i.getTile(d),n=t.getBucket(r);if(!n||!n.text||!n.text.segments.get().length)continue;const o=e.bk(n.textSizeData,c.zoom,l),a=an(d,n.getProjection(),c),p=c.calculatePixelsToTileUnitsMatrix(t),f=Bt(a,t.tileID.canonical,h,u,c,n.getProjection(),p),m=n.hasIconTextFit()&&n.hasIconData();if(o){const r=Math.pow(2,c.zoom-t.tileID.overscaledZ);Eo(n,u,h,s,e.cS,c,f,d,r,o,m)}}}(i,t,r,n,r.layout.get("text-rotation-alignment"),r.layout.get("text-pitch-alignment"),o,u);const h=0!==r.paint.get("icon-opacity").constantOr(1),d=0!==r.paint.get("text-opacity").constantOr(1);void 0!==r.layout.get("symbol-sort-key").constantOr(1)&&(h||d)?Ao(t,n,r,i,a,s):(h&&Ao(t,n,r,i,a,s,{onlyIcons:!0}),d&&Ao(t,n,r,i,a,s,{onlyText:!0})),n.map.showCollisionBoxes&&(bo(t,n,r,i,r.paint.get("text-translate"),r.paint.get("text-translate-anchor"),!0),bo(t,n,r,i,r.paint.get("icon-translate"),r.paint.get("icon-translate-anchor"),!1))},circle:function(t,n,r,i){if("translucent"!==t.renderPass)return;const o=r.paint.get("circle-opacity"),a=r.paint.get("circle-stroke-width"),s=r.paint.get("circle-stroke-opacity"),l=void 0!==r.layout.get("circle-sort-key").constantOr(1),c=r.paint.get("circle-emissive-strength");if(0===o.constantOr(1)&&(0===a.constantOr(1)||0===s.constantOr(1)))return;const u=t.context,h=u.gl,d=t.transform,p=t.depthModeForSublayer(0,Dn.ReadOnly),f=zn.disabled,m=t.colorModeForDrapableLayerRenderPass(c),g="globe"===d.projection.name,y=[e.am(d.center.lng),e.at(d.center.lat)],_=[];for(let x=0;x<i.length;x++){const o=i[x],a=n.getTile(o),s=a.getBucket(r);if(!s||s.projection.name!==d.projection.name)continue;const c=s.programConfigurations.get(r.id),u=e.cT(r),h=t.isTileAffectedByFog(o);g&&u.push("PROJECTION_GLOBE_VIEW"),u.push("DEPTH_D24"),t.terrain&&d.depthOcclusionForSymbolsAndCircles&&u.push("DEPTH_OCCLUSION");const p=t.getOrCreateProgram("circle",{config:c,defines:u,overrideFog:h}),f=s.layoutVertexBuffer,m=s.globeExtVertexBuffer,v=s.indexBuffer,b=d.projection.createInversionMatrix(d,o.canonical),w={programConfiguration:c,program:p,layoutVertexBuffer:f,globeExtVertexBuffer:m,indexBuffer:v,uniformValues:e.cU(t,o,a,b,y,r),tile:a};if(l){const t=s.segments.get();for(const n of t)_.push({segments:new e.b2([n]),sortKey:n.sortKey,state:w})}else _.push({segments:s.segments,sortKey:0,state:w})}l&&_.sort(((e,t)=>e.sortKey-t.sortKey));const v={useDepthForOcclusion:d.depthOcclusionForSymbolsAndCircles};for(const e of _){const{programConfiguration:n,program:i,layoutVertexBuffer:o,globeExtVertexBuffer:a,indexBuffer:s,uniformValues:l,tile:c}=e.state,g=e.segments;t.terrain&&t.terrain.setupElevationDraw(c,i,v),t.uploadCommonUniforms(u,i,c.tileID.toUnwrapped()),i.draw(t,h.TRIANGLES,p,f,m,Bn.disabled,l,r.id,o,s,g,r.paint,d.zoom,n,[a])}},heatmap:function(t,n,r,i){if(0!==r.paint.get("heatmap-opacity"))if("offscreen"===t.renderPass){const o=t.context,a=o.gl,s=zn.disabled,l=new Nn([a.ONE,a.ONE,a.ONE,a.ONE],e.bA.transparent,[!0,!0,!0,!0]);!function(e,t,n,r){const i=e.gl,o=t.width*r,a=t.height*r;e.activeTexture.set(i.TEXTURE1),e.viewport.set([0,0,o,a]);let s=n.heatmapFbo;if(!s||s&&(s.width!==o||s.height!==a)){s&&s.destroy();const t=i.createTexture();i.bindTexture(i.TEXTURE_2D,t),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),s=n.heatmapFbo=e.createFramebuffer(o,a,!0,null),function(e,t,n,r,i,o){const a=e.gl;a.texImage2D(a.TEXTURE_2D,0,e.extRenderToTextureHalfFloat?a.RGBA16F:a.RGBA,i,o,0,a.RGBA,e.extRenderToTextureHalfFloat?a.HALF_FLOAT:a.UNSIGNED_BYTE,null),r.colorAttachment.set(n)}(e,0,t,s,o,a)}else i.bindTexture(i.TEXTURE_2D,s.colorAttachment.get()),e.bindFramebuffer.set(s.framebuffer)}(o,t,r,"globe"===t.transform.projection.name?.5:.25),o.clear({color:e.bA.transparent});const c=t.transform,u="globe"===c.projection.name,h=u?["PROJECTION_GLOBE_VIEW"]:[],d=u?Bn.frontCCW:Bn.disabled,p=[e.am(c.center.lng),e.at(c.center.lat)];for(let e=0;e<i.length;e++){const f=i[e];if(n.hasRenderableParent(f))continue;const m=n.getTile(f),g=m.getBucket(r);if(!g||g.projection.name!==c.projection.name)continue;const y=t.isTileAffectedByFog(f),_=g.programConfigurations.get(r.id),v=t.getOrCreateProgram("heatmap",{config:_,defines:h,overrideFog:y}),{zoom:x}=t.transform;t.terrain&&t.terrain.setupElevationDraw(m,v),t.uploadCommonUniforms(o,v,f.toUnwrapped());const b=c.projection.createInversionMatrix(c,f.canonical);v.draw(t,a.TRIANGLES,Dn.disabled,s,l,d,Ji(t,f,m,b,p,x,r.paint.get("heatmap-intensity")),r.id,g.layoutVertexBuffer,g.indexBuffer,g.segments,r.paint,t.transform.zoom,_,u?[g.globeExtVertexBuffer]:null)}o.viewport.set([0,0,t.width,t.height])}else"translucent"===t.renderPass&&(t.context.setColorMode(t.colorModeForRenderPass()),function(t,n){const r=t.context,i=r.gl,o=n.heatmapFbo;if(!o)return;r.activeTexture.set(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,o.colorAttachment.get()),r.activeTexture.set(i.TEXTURE1);let a=n.colorRampTexture;a||(a=n.colorRampTexture=new e.T(r,n.colorRamp,i.RGBA8)),a.bind(i.LINEAR,i.CLAMP_TO_EDGE),t.getOrCreateProgram("heatmapTexture").draw(t,i.TRIANGLES,Dn.disabled,zn.disabled,t.colorModeForRenderPass(),Bn.disabled,((e,t)=>({u_image:0,u_color_ramp:1,u_opacity:t.paint.get("heatmap-opacity")}))(0,n),n.id,t.viewportBuffer,t.quadTriangleIndexBuffer,t.viewportSegments,n.paint,t.transform.zoom)}(t,r))},line:function(t,n,r,i){if("translucent"!==t.renderPass)return;const o=r.paint.get("line-opacity"),a=r.paint.get("line-width");if(0===o.constantOr(1)||0===a.constantOr(1))return;const s=r.paint.get("line-emissive-strength"),l=r.paint.get("line-occlusion-opacity"),c="sea"===r.layout.get("line-elevation-reference"),u=t.context,h=u.gl,d=!r.isDraped();if(d&&"globe"===t.transform.projection.name)return;const p=r.layout.get("line-cross-slope"),f=void 0!==p,m=p<1,g=d?new Dn(t.depthOcclusion?h.GREATER:h.LEQUAL,Dn.ReadOnly,t.depthRangeFor3D):t.depthModeForSublayer(0,Dn.ReadOnly),y=t.colorModeForDrapableLayerRenderPass(s),_=t.terrain&&t.terrain.renderingToTexture,v=_?1:e.q.devicePixelRatio,x=r.paint.get("line-dasharray"),b=x.constantOr(1),w=r.layout.get("line-cap"),S=x.constantOr(null),T=w.constantOr(null),E=r.paint.get("line-pattern"),A=E.constantOr(1),M=E.constantOr(null),P=r.paint.get("line-opacity").constantOr(1);let k=!A&&1!==P||t.depthOcclusion&&l>0&&l<1;const C=r.paint.get("line-gradient"),j=A?"linePattern":"line",I=e.cV(r);let O;if(_&&t.terrain&&t.terrain.clipOrMaskOverlapStencilType()&&(k=!1),0!==l&&t.depthOcclusion){const t=r.paint._values["line-opacity"];t&&t.value&&"constant"===t.value.kind?O=t.value:e.w("Occlusion opacity for layer ".concat(r.id," is supported only when line-opacity isn't data-driven."))}if(d&&(t.forceTerrainMode=!0),!d&&0!==l&&t.terrain&&!_)return void e.w("Occlusion opacity for layer ".concat(r.id," is supported on terrain only if the layer has line-z-offset enabled."));const N=k&&d?t.stencilModeFor3D():zn.disabled;d&&(I.push("ELEVATED"),f&&I.push(m?"CROSS_SLOPE_HORIZONTAL":"CROSS_SLOPE_VERTICAL"),c&&I.push("ELEVATION_REFERENCE_SEA"));for(const D of i){const i=n.getTile(D);if(A&&!i.patternsLoaded())continue;const o=i.getBucket(r);if(!o)continue;t.prepareDrawTile();const a=o.programConfigurations.get(r.id),s=t.isTileAffectedByFog(D),p=t.getOrCreateProgram(j,{config:a,defines:I,overrideFog:s,overrideRtt:!d&&void 0});if(M&&i.imageAtlas){const e=i.imageAtlas.patternPositions[M.toString()];e&&a.setConstantPatternPositions(e)}if(!A&&S&&T&&i.lineAtlas){const e=i.lineAtlas.getDash(S,T);e&&a.setConstantPatternPositions(e)}let[f,m]=r.paint.get("line-trim-offset");if("round"===T||"square"===T){const e=1;f!==m&&(0===f&&(f-=e),1===m&&(m+=e))}const x=_?D.projMatrix:null,w=A?e.cW(t,i,r,x,v,[f,m]):e.cX(t,i,r,x,o.lineClipsArray.length,v,[f,m]);if(C){const i=o.gradients[r.id];let a=i.texture;if(r.gradientVersion!==i.version){let s=256;if(r.stepInterpolant){const r=n.getSource().maxzoom,i=D.canonical.z===r?Math.ceil(1<<t.transform.maxZoom-D.canonical.z):1;s=e.ap(e.cY(o.maxLineLength/e.ab*1024*i),256,u.maxTextureSize)}i.gradient=e.cZ({expression:r.gradientExpression(),evaluationKey:"lineProgress",resolution:s,image:i.gradient||void 0,clips:o.lineClipsArray}),i.texture?i.texture.update(i.gradient):i.texture=new e.T(u,i.gradient,h.RGBA8),i.version=r.gradientVersion,a=i.texture}u.activeTexture.set(h.TEXTURE1),a.bind(r.stepInterpolant?h.NEAREST:h.LINEAR,h.CLAMP_TO_EDGE)}b&&(u.activeTexture.set(h.TEXTURE0),i.lineAtlasTexture&&i.lineAtlasTexture.bind(h.LINEAR,h.REPEAT),a.updatePaintBuffers()),A&&(u.activeTexture.set(h.TEXTURE0),i.imageAtlasTexture&&i.imageAtlasTexture.bind(h.LINEAR,h.CLAMP_TO_EDGE),a.updatePaintBuffers()),d&&!c&&t.terrain.setupElevationDraw(i,p),t.uploadCommonUniforms(u,p,D.toUnwrapped());const E=e=>{null!=O&&(O.value=P*l),p.draw(t,h.TRIANGLES,g,e,y,Bn.disabled,w,r.id,o.layoutVertexBuffer,o.indexBuffer,o.segments,r.paint,t.transform.zoom,a,[o.layoutVertexBuffer2,o.patternVertexBuffer,o.zOffsetVertexBuffer]),null!=O&&(O.value=P)};if(k&&!d){const e=t.stencilModeForClipping(D).ref;0===e&&_&&u.clear({stencil:0});const n={func:h.EQUAL,mask:255};w.u_alpha_discard_threshold=.8,E(new zn(n,e,255,h.KEEP,h.KEEP,h.INVERT)),w.u_alpha_discard_threshold=0,E(new zn(n,e,255,h.KEEP,h.KEEP,h.KEEP))}else k&&d&&(w.u_alpha_discard_threshold=.001),E(d?N:t.stencilModeForClipping(D))}d&&(t.forceTerrainMode=!1),k&&(t.resetStencilClippingMasks(),_&&u.clear({stencil:0})),0===l||t.depthOcclusion||_||t.layersWithOcclusionOpacity.push(t.currentLayer)},fill:function(t,n,r,i){const o=r.paint.get("fill-color"),a=r.paint.get("fill-opacity"),s=r.is3D(),l=new Dn(t.context.gl.LEQUAL,Dn.ReadWrite,t.depthRangeFor3D);if(0===a.constantOr(1))return;const c=r.paint.get("fill-emissive-strength"),u=t.colorModeForDrapableLayerRenderPass(c),h=r.paint.get("fill-pattern"),d=t.opaquePassEnabledForLayer()&&!h.constantOr(1)&&1===o.constantOr(e.bA.transparent).a&&1===a.constantOr(0)?"opaque":"translucent";if(t.renderPass===d){const e=s?l:t.depthModeForSublayer(1,"opaque"===t.renderPass?Dn.ReadWrite:Dn.ReadOnly);Po(t,n,r,i,e,u,!1)}if(!s&&"translucent"===t.renderPass&&r.paint.get("fill-antialias")){const e=s?l:t.depthModeForSublayer(r.getPaintProperty("fill-outline-color")?2:0,Dn.ReadOnly);Po(t,n,r,i,e,u,!0)}},"fill-extrusion":function(t,n,r,i){const o=r.paint.get("fill-extrusion-opacity"),a=t.context,s=a.gl,l=t.terrain,c=l&&l.renderingToTexture;if(0===o)return;const u=t.conflationActive&&t.style.isLayerClipped(r,n.getSource()),h=t.style.order.indexOf(r.fqid);if(u&&function(e,t,n,r,i){for(const o of r){const r=t.getTile(o).getBucket(n);r&&(r.updateReplacement(o,e.replacementSource,i),r.uploadCentroid(e.context))}}(t,n,r,i,h),l||u)for(const e of i){const i=n.getTile(e).getBucket(r);i&&jo(t.context,n,e,i,r,l,u)}if("shadow"===t.renderPass&&t.shadowRenderer){const a=t.shadowRenderer;if(l&&o<.65&&r._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof e.a4)return;const s=a.getShadowPassDepthMode(),c=a.getShadowPassColorMode();ko(t,n,r,i,s,zn.disabled,c,u)}else if("translucent"===t.renderPass){const h=!r.paint.get("fill-extrusion-pattern").constantOr(1),d=r.paint.get("fill-extrusion-color").constantOr(e.bA.white);if(!c&&0!==d.a){const e=new Dn(t.context.gl.LEQUAL,Dn.ReadWrite,t.depthRangeFor3D);1===o&&h?ko(t,n,r,i,e,zn.disabled,Nn.unblended,u):(ko(t,n,r,i,e,zn.disabled,Nn.disabled,u),ko(t,n,r,i,e,t.stencilModeFor3D(),t.colorModeForRenderPass(),u),t.resetStencilClippingMasks())}if(t.style.enable3dLights()&&h&&(!l&&"globe"!==t.transform.projection.name||c)){const o=r.paint.get("fill-extrusion-opacity"),h=r.paint.get("fill-extrusion-ambient-occlusion-intensity"),d=r.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),p=r.paint.get("fill-extrusion-flood-light-intensity"),f=r.paint.get("fill-extrusion-flood-light-color").toRenderColor(r.lut).toArray01().slice(0,3),m=h>0&&d>0,g=p>0,y=(e,t,n)=>(1-n)*e+n*t,_=a=>{const l=t.depthModeForSublayer(1,Dn.ReadOnly,s.LEQUAL,!0),c=r.paint.get(a?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),m=y(.1,3,c),g=t._showOverdrawInspector;if(!g){const c=new zn({func:s.ALWAYS,mask:255},255,255,s.KEEP,s.KEEP,s.REPLACE),g=new Nn([s.ONE,s.ONE,s.ONE,s.ONE],e.bA.transparent,[!1,!1,!1,!0],s.MIN);Co(t,n,r,i,l,c,g,Bn.disabled,a,"sdf",o,h,d,p,f,m,u,!1)}{const c=g?zn.disabled:new zn({func:s.EQUAL,mask:255},255,255,s.KEEP,s.DECR,s.DECR),y=g?t.colorModeForRenderPass():new Nn([s.ONE_MINUS_DST_ALPHA,s.DST_ALPHA,s.ONE,s.ONE],e.bA.transparent,[!0,!0,!0,!0]);Co(t,n,r,i,l,c,y,Bn.disabled,a,"color",o,h,d,p,f,m,u,!1)}};if(c){const c=(a,l,c)=>{const m=t.depthModeForSublayer(1,Dn.ReadOnly,s.LEQUAL,!1),g=r.paint.get(a?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),_=y(.1,3,g);{const c=new Nn([s.ONE,s.ONE,s.ONE,s.ONE],e.bA.transparent,[!1,!1,!1,!0]);Co(t,n,r,i,m,zn.disabled,c,Bn.disabled,a,"clear",o,h,d,p,f,_,u,l)}{const c=new zn({func:s.ALWAYS,mask:255},255,255,s.KEEP,s.KEEP,s.REPLACE),g=new Nn([s.ONE,s.ONE,s.ONE,s.ONE],e.bA.transparent,[!1,!1,!1,!0],s.MIN);Co(t,n,r,i,m,c,g,Bn.disabled,a,"sdf",o,h,d,p,f,_,u,l)}{const c=a?s.ZERO:s.ONE_MINUS_DST_ALPHA,g=new zn({func:s.EQUAL,mask:255},255,255,s.KEEP,s.DECR,s.DECR),y=new Nn([c,s.DST_ALPHA,s.ONE_MINUS_DST_ALPHA,s.ZERO],e.bA.transparent,[!0,!0,!0,!0]);Co(t,n,r,i,m,g,y,Bn.disabled,a,"color",o,h,d,p,f,_,u,l)}{const g=new Nn([s.ONE,s.ONE,s.ONE,a?s.ZERO:s.ONE],e.bA.transparent,[!1,!1,!1,!0],a?s.FUNC_ADD:s.MAX);Co(t,n,r,i,m,zn.disabled,g,Bn.disabled,a,"clear",o,h,d,p,f,_,u,l,c)}};if(m||g){let n;if(t.prepareDrawTile(),l){const t=l.drapeBufferSize[0],r=l.drapeBufferSize[1];n=l.framebufferCopyTexture,n&&(!n||n.size[0]===t&&n.size[1]===r)||(n&&n.destroy(),n=l.framebufferCopyTexture=new e.T(a,new e.r({width:t,height:r}),s.RGBA8)),n.bind(s.LINEAR,s.CLAMP_TO_EDGE),s.copyTexSubImage2D(s.TEXTURE_2D,0,0,0,0,0,t,r)}m&&c(!0,!1,n),g&&c(!1,!0,n)}}else m&&_(!0),g&&_(!1),(m||g)&&t.resetStencilClippingMasks()}}},hillshade:function(e,t,n,r){if("offscreen"!==e.renderPass&&"translucent"!==e.renderPass)return;if(e.style.disableElevatedTerrain)return;const i=e.context,o=e.terrain&&e.terrain.renderingToTexture,[a,s]="translucent"!==e.renderPass||o?[{},r]:e.stencilConfigForOverlap(r);for(const l of s){const r=t.getTile(l);if(r.needsHillshadePrepare&&"offscreen"===e.renderPass)zr(e,r,n);else if("translucent"===e.renderPass){const t=e.depthModeForSublayer(0,Dn.ReadOnly),i=n.paint.get("hillshade-emissive-strength"),s=e.colorModeForDrapableLayerRenderPass(i),c=o&&e.terrain?e.terrain.stencilModeForRTTOverlap(l):a[l.overscaledZ];Dr(e,l,r,n,t,c,s)}}i.viewport.set([0,0,e.width,e.height]),e.resetStencilClippingMasks()},raster:function(t,n,r,i,o,a){if("translucent"!==t.renderPass)return;if(0===r.paint.get("raster-opacity"))return;const s="globe"===t.transform.projection.name,l=0!==r.paint.get("raster-elevation"),c=l&&s;if(t.renderElevatedRasterBackface&&!c)return;const u=t.context,h=u.gl,d=n.getSource(),p=function(t,n,r,i){const o=n.paint.get("raster-color"),a="raster-array"===t.type,s=[],l=n.paint.get("raster-resampling"),c=n.paint.get("raster-color-mix");let u=n.paint.get("raster-color-range");const h=[c[0],c[1],c[2],0],d=c[3];let p="nearest"===l?i.NEAREST:i.LINEAR;if(a&&(s.push("RASTER_ARRAY"),o||s.push("RASTER_COLOR"),"linear"===l&&s.push("RASTER_ARRAY_LINEAR"),p=i.NEAREST,!u&&t.rasterLayers)){const e=t.rasterLayers.find((e=>{let{id:t}=e;return t===n.sourceLayer}));e&&e.fields&&e.fields.range&&(u=e.fields.range)}if(u=u||[0,1],o){s.push("RASTER_COLOR"),r.activeTexture.set(i.TEXTURE2),n.updateColorRamp(u);let t=n.colorRampTexture;t||(t=n.colorRampTexture=new e.T(r,n.colorRamp,i.RGBA8)),t.bind(i.LINEAR,i.CLAMP_TO_EDGE)}return{mix:h,range:u,offset:d,defines:s,resampling:p}}(d,r,u,h);if(d instanceof e.aD&&!i.length&&!s)return;const f=r.paint.get("raster-emissive-strength"),m=t.colorModeForDrapableLayerRenderPass(f),g=t.terrain&&t.terrain.renderingToTexture,y=!t.options.moving,_="nearest"===r.paint.get("raster-resampling")?h.NEAREST:h.LINEAR;if(d instanceof e.aD&&!i.length&&(d.onNorthPole||d.onSouthPole)){const e=l?t.stencilModeFor3D():zn.disabled;return void zo(!!d.onNorthPole,null,t,n,r,f,p,Bn.disabled,e)}if(!i.length)return;const[v,x]=d instanceof e.aD||g?[{},i]:t.stencilConfigForOverlap(i),b=x[x.length-1].overscaledZ;c&&p.defines.push("PROJECTION_GLOBE_VIEW"),l&&p.defines.push("RENDER_CUTOFF");const w=(i,o,x)=>{for(const w of i){const i=w.toUnwrapped(),S=n.getTile(w);if(g&&(!S||!S.hasData()))continue;u.activeTexture.set(h.TEXTURE0);const T=Fo(S,d,r,p);if(!T||!T.texture)continue;const{texture:E,mix:A,offset:M,tileSize:P,buffer:k}=T;let C,j;g?(C=Dn.disabled,j=w.projMatrix):l?(C=new Dn(h.LEQUAL,Dn.ReadWrite,t.depthRangeFor3D),j=s?Float32Array.from(t.transform.expandedFarZProjMatrix):t.transform.calculateProjMatrix(i,y)):(C=t.depthModeForSublayer(w.overscaledZ-b,1===r.paint.get("raster-opacity")?Dn.ReadWrite:Dn.ReadOnly,h.LESS),j=t.transform.calculateProjMatrix(i,y));const I=t.terrain&&g?t.terrain.stencilModeForRTTOverlap(w):v[w.overscaledZ],O=a?0:r.paint.get("raster-fade-duration");S.registerFadeDuration(O);const N=n.findLoadedParent(w,0),D=ki(S,N,n,t.transform,O);let L,z;t.terrain&&t.terrain.prepareDrawTile(),u.activeTexture.set(h.TEXTURE0),E.bind(_,h.CLAMP_TO_EDGE),u.activeTexture.set(h.TEXTURE1),N?(N.texture&&N.texture.bind(_,h.CLAMP_TO_EDGE),L=Math.pow(2,N.tileID.overscaledZ-S.tileID.overscaledZ),z=[S.tileID.canonical.x*L%1,S.tileID.canonical.y*L%1]):E.bind(_,h.CLAMP_TO_EDGE),E.useMipmap&&u.extTextureFilterAnisotropic&&t.transform.pitch>20&&h.texParameterf(h.TEXTURE_2D,u.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,u.extTextureFilterAnisotropicMax);const R=t.transform;let F;const B=l?Ro(R):[0,0,0,0];let V,U,G,H,Z,q=0;if(c&&d instanceof e.aD&&d.coordinates.length>3)V=Float32Array.from(e.b6(e.cC(new e.bQ(0,0,0)))),U=Float32Array.from(R.globeMatrix),G=Float32Array.from(e.cy(R)),H=[e.am(R.center.lng),e.at(R.center.lat)],F=d.elevatedGlobePerspectiveTransform,Z=d.elevatedGlobeGridMatrix||new Float32Array(9);else if(c){const t=e.cz(w.canonical);q=e.cA(t.getCenter().lat),V=Float32Array.from(e.b6(e.cC(w.canonical))),U=Float32Array.from(R.globeMatrix),G=Float32Array.from(e.cy(R)),H=[e.am(R.center.lng),e.at(R.center.lat)],F=[0,0],Z=Float32Array.from(e.cB(w.canonical,t,q,R.worldSize/R._pixelsPerMercatorPixel))}else F=d instanceof e.aD?d.perspectiveTransform:[0,0],V=new Float32Array(16),U=new Float32Array(9),G=new Float32Array(16),H=[0,0],Z=new Float32Array(9);const W=eo(j,V,U,G,Z,z||[0,0],e.a9(t.transform.zoom),H,B,L||1,D,r,F,l?r.paint.get("raster-elevation"):0,2,A,M,p.range,P,k,f),X=t.isTileAffectedByFog(w),Y=t.getOrCreateProgram("raster",{defines:p.defines,overrideFog:X});if(t.uploadCommonUniforms(u,Y,i),d instanceof e.aD){const n=d.elevatedGlobeVertexBuffer,i=d.elevatedGlobeIndexBuffer;if(g||!s)d.boundsBuffer&&d.boundsSegments&&Y.draw(t,h.TRIANGLES,C,zn.disabled,m,Bn.disabled,W,r.id,d.boundsBuffer,t.quadTriangleIndexBuffer,d.boundsSegments);else if(n&&i){const a=R.zoom<=e.c3?d.elevatedGlobeSegments:d.getSegmentsForLongitude(R.center.lng);a&&Y.draw(t,h.TRIANGLES,C,zn.disabled,m,o,W,r.id,n,i,a)}}else if(c){C=new Dn(h.LEQUAL,Dn.ReadOnly,t.depthRangeFor3D);const e=t.globeSharedBuffers;if(e){const[n,i,a]=e.getGridBuffers(q,!1);Y.draw(t,h.TRIANGLES,C,x||I,t.colorModeForRenderPass(),o,W,r.id,n,i,a)}}else{const{tileBoundsBuffer:e,tileBoundsIndexBuffer:n,tileBoundsSegments:i}=t.getTileBoundsBuffers(S);Y.draw(t,h.TRIANGLES,C,I,m,Bn.disabled,W,r.id,e,n,i)}}if(!(d instanceof e.aD)&&c)for(const e of i){const i=e.canonical.y===(1<<e.canonical.z)-1;0===e.canonical.y&&zo(!0,e,t,n,r,f,p,o,x||zn.disabled),i&&zo(!1,e,t,n,r,f,p,o===Bn.frontCW?Bn.backCW:Bn.frontCW,x||zn.disabled)}};c?w(x,t.renderElevatedRasterBackface?Bn.backCW:Bn.frontCW,t.stencilModeFor3D()):w(x,Bn.disabled,void 0),t.resetStencilClippingMasks()},"raster-particle":function(t,n,r,i,o,a){"offscreen"===t.renderPass&&function(t,n,r,i){if(!i.length)return;const o=t.context,a=o.gl,s=n.getSource();if(!(s instanceof tt))return;const l=Math.ceil(Math.sqrt(r.paint.get("raster-particle-count")));let c=r.particlePositionRGBAImage;if(!c||c.width!==l){const t=function(e){const t=e*e,n=new Uint8Array(4*t),r=function(e){return e|=0,e=Math.imul(2747636419^e,2654435769),e=Math.imul(e^e>>>16,2654435769),((e=Math.imul(e^e>>>16,2654435769))>>>0)/4294967296},i=1/1.1;for(let o=0;o<t;o++){const e=i*(r(2*o+0)+no),t=i*(r(2*o+1)+no),a=255*e%1,s=255*t%1,l=a,c=t-s/255,u=s;n[4*o+0]=255*(e-a/255),n[4*o+1]=255*l,n[4*o+2]=255*c,n[4*o+3]=255*u}return n}(l);c=r.particlePositionRGBAImage=new e.r({width:l,height:l},t)}let u=r.particleFramebuffer;u?u.width!==l&&(u.destroy(),u=r.particleFramebuffer=o.createFramebuffer(l,l,!0,null)):u=r.particleFramebuffer=o.createFramebuffer(l,l,!0,null);const h=[];for(const e of i){const t=n.getTile(e);if(!(t instanceof _t))continue;const i=Uo(t,s,r);if(!i)continue;const a=[t.tileSize,t.tileSize];let u=r.tileFramebuffer;u||(u=r.tileFramebuffer=o.createFramebuffer(a[0],a[1],!0,null));let d=t.rasterParticleState;d||(d=t.rasterParticleState=new Vo(o,e,a,c));const p=d.update(r.lastInvalidatedAt);d.particleTextureDimension!==l&&d.updateParticleTexture(e,c);const f=d.targetColorTexture;d.targetColorTexture=d.backgroundColorTexture,d.backgroundColorTexture=f;const m=d.particleTexture0;d.particleTexture0=d.particleTexture1,d.particleTexture1=m,h.push([e,i,d,p])}if(0===h.length)return;const d=e.q.now(),p=r.previousDrawTimestamp?.001*(d-r.previousDrawTimestamp):.0167;if(r.previousDrawTimestamp=d,r.hasColorMap()){o.activeTexture.set(a.TEXTURE0+2);let t=r.colorRampTexture;t||(t=r.colorRampTexture=new e.T(o,r.colorRamp,a.RGBA8)),t.bind(a.LINEAR,a.CLAMP_TO_EDGE)}o.bindFramebuffer.set(r.tileFramebuffer.framebuffer),function(t,n,r){const i=t.context,o=i.gl,a=n.tileFramebuffer;i.activeTexture.set(o.TEXTURE0);const s={u_texture:0,u_opacity:1.05*(c=n.paint.get("raster-particle-fade-opacity-factor"))/(c+.05)},l=t.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var c;for(const u of r){const[,,r,c]=u;a.colorAttachment.set(r.targetColorTexture.texture),i.viewport.set([0,0,a.width,a.height]),i.clear({color:e.bA.transparent}),c&&(r.backgroundColorTexture.bind(o.NEAREST,o.CLAMP_TO_EDGE),l.draw(t,o.TRIANGLES,Dn.disabled,zn.disabled,Nn.alphaBlended,Bn.disabled,s,n.id,t.viewportBuffer,t.quadTriangleIndexBuffer,t.viewportSegments))}}(t,r,h),function(t,n,r,i){const o=t.context,a=o.gl,s=r.tileFramebuffer,l="globe"===t.transform.projection.name,c=r.paint.get("raster-particle-max-speed");for(const u of i){const[i,h,d]=u;o.activeTexture.set(a.TEXTURE0+0),h.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE),s.colorAttachment.set(d.targetColorTexture.texture);const p=t.getOrCreateProgram("rasterParticleDraw",{defines:h.defines,overrideFog:!1});o.activeTexture.set(a.TEXTURE0+1);const f=h.scalarData?[]:[0,1,2,3].map((t=>e.c$[t](i)));f.push(i);const m=i.canonical.x,g=i.canonical.y;for(const e of f){const o=n.getTile(l?e.wrapped():e);if(!o)continue;const s=o.rasterParticleState;if(!s)continue;const u=e.canonical.x+(1<<e.canonical.z)*(e.wrap-i.wrap),d=e.canonical.y;s.particleTexture0.bind(a.NEAREST,a.CLAMP_TO_EDGE);const f=io(1,s.particleTexture0.size[0],[u-m,d-g],0,h.texture.size,2,c,h.textureOffset,h.scale,h.offset);p.draw(t,a.POINTS,Dn.disabled,zn.disabled,Nn.alphaBlended,Bn.disabled,f,r.id,s.particleIndexBuffer,void 0,s.particleSegment)}}}(t,n,r,h),o.bindFramebuffer.set(r.particleFramebuffer.framebuffer),function(t,n,r,i){const o=t.context,a=o.gl,s=n.paint.get("raster-particle-max-speed"),l=i*n.paint.get("raster-particle-speed-factor")*.15,c=function(e){return Math.pow(e,6)}(.01+1*n.paint.get("raster-particle-reset-rate-factor")),u=n.particleFramebuffer;o.viewport.set([0,0,u.width,u.height]);for(const h of r){const[,r,i]=h;o.activeTexture.set(a.TEXTURE0+0),r.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE),o.activeTexture.set(a.TEXTURE0+1);const d=i.particleTexture0;d.bind(a.NEAREST,a.CLAMP_TO_EDGE);const p=oo(1,d.size[0],0,r.texture.size,s,l,c,r.textureOffset,r.scale,r.offset);u.colorAttachment.set(i.particleTexture1.texture),o.clear({color:e.bA.transparent}),t.getOrCreateProgram("rasterParticleUpdate",{defines:r.defines}).draw(t,a.TRIANGLES,Dn.disabled,zn.disabled,Nn.unblended,Bn.disabled,p,n.id,t.viewportBuffer,t.quadTriangleIndexBuffer,t.viewportSegments)}}(t,r,h,p)}(t,n,r,i),"translucent"===t.renderPass&&(function(t,n,r,i){const o=t.context,a=o.gl,s=n.getSource().tileSize,l=5*(1-e.a7(e.bV,e.bV+1,t.transform.zoom))*s+r.paint.get("raster-particle-elevation"),c=!t.options.moving,u="globe"===t.transform.projection.name;if(!i.length)return;const[h,d]=t.stencilConfigForOverlap(i),p=[];u&&p.push("PROJECTION_GLOBE_VIEW");const f=t.stencilModeFor3D();for(const m of d){const i=m.toUnwrapped(),s=n.getTile(m);if(!s.rasterParticleState)continue;const d=s.rasterParticleState,g=100;s.registerFadeDuration(g);const y=n.findLoadedParent(m,0),_=ki(s,y,n,t.transform,g);let v,x;t.terrain&&t.terrain.prepareDrawTile(),o.activeTexture.set(a.TEXTURE0),d.targetColorTexture.bind(a.LINEAR,a.CLAMP_TO_EDGE),o.activeTexture.set(a.TEXTURE1),y&&y.rasterParticleState?(y.rasterParticleState.targetColorTexture.bind(a.LINEAR,a.CLAMP_TO_EDGE),v=Math.pow(2,y.tileID.overscaledZ-s.tileID.overscaledZ),x=[s.tileID.canonical.x*v%1,s.tileID.canonical.y*v%1]):d.targetColorTexture.bind(a.LINEAR,a.CLAMP_TO_EDGE);const b=u?Float32Array.from(t.transform.expandedFarZProjMatrix):t.transform.calculateProjMatrix(i,c),w=t.transform,S=Go(w),T=e.cz(m.canonical),E=e.cA(T.getCenter().lat);let A,M,P,k,C;u?(A=Float32Array.from(e.b6(e.cC(m.canonical))),M=Float32Array.from(w.globeMatrix),P=Float32Array.from(e.cy(w)),k=[e.am(w.center.lng),e.at(w.center.lat)],C=Float32Array.from(e.cB(m.canonical,T,E,w.worldSize/w._pixelsPerMercatorPixel))):(A=new Float32Array(16),M=new Float32Array(9),P=new Float32Array(16),k=[0,0],C=new Float32Array(9));const j=ro(b,A,M,P,C,x||[0,0],e.a9(t.transform.zoom),k,S,v||1,_,l),I=t.isTileAffectedByFog(m),O=t.getOrCreateProgram("rasterParticle",{defines:p,overrideFog:I});if(t.uploadCommonUniforms(o,O,i),u){const e=new Dn(a.LEQUAL,Dn.ReadOnly,t.depthRangeFor3D),n=0,i=t.globeSharedBuffers;if(i){const[o,s,l]=i.getGridBuffers(E,0!==n);O.draw(t,a.TRIANGLES,e,f,Nn.alphaBlended,t.renderElevatedRasterBackface?Bn.frontCCW:Bn.backCCW,j,r.id,o,s,l)}}else{const e=t.depthModeForSublayer(0,Dn.ReadOnly),n=h[m.overscaledZ],{tileBoundsBuffer:i,tileBoundsIndexBuffer:o,tileBoundsSegments:l}=t.getTileBoundsBuffers(s);O.draw(t,a.TRIANGLES,e,n,Nn.alphaBlended,Bn.disabled,j,r.id,i,o,l)}}t.resetStencilClippingMasks()}(t,n,r,i),t.style.map.triggerRepaint())},background:function(t,n,r,i){const o=r.paint.get("background-color"),a=r.paint.get("background-opacity"),s=r.paint.get("background-emissive-strength"),l="viewport"===r.paint.get("background-pitch-alignment");if(0===a)return;const c=t.context,u=c.gl,h=t.transform,d=h.tileSize,p=r.paint.get("background-pattern");let f;if(void 0!==p){if(null===p)return;if(f=t.imageManager.getPattern(p.toString(),r.scope,t.style.getLut(r.scope)),!f)return}const m=!p&&1===o.a&&1===a&&t.opaquePassEnabledForLayer()?"opaque":"translucent";if(t.renderPass!==m)return;const g=zn.disabled,y=t.depthModeForSublayer(0,"opaque"===m?Dn.ReadWrite:Dn.ReadOnly),_=t.colorModeForDrapableLayerRenderPass(s),v=p?"backgroundPattern":"background";let x,b=i;if(b||(x=t.getBackgroundTiles(),b=Object.values(x).map((e=>e.tileID))),p&&(c.activeTexture.set(u.TEXTURE0),t.imageManager.bind(t.context,r.scope)),l){const n=t.getOrCreateProgram(v,{overrideFog:!1,overrideRtt:!0}),i=new Float32Array(e.a6.mat4.identity([])),c=new e.aA(0,0,0,0,0),h=p?co(i,s,a,t,0,r.scope,f,l,{tileID:c,tileSize:d}):lo(i,s,a,o.toRenderColor(r.lut));n.draw(t,u.TRIANGLES,y,g,_,Bn.disabled,h,r.id,t.viewportBuffer,t.quadTriangleIndexBuffer,t.viewportSegments)}else for(const e of b){const m=t.isTileAffectedByFog(e),b=t.getOrCreateProgram(v,{overrideFog:m}),w=e.toUnwrapped(),S=i?e.projMatrix:t.transform.calculateProjMatrix(w);t.prepareDrawTile();const T=n?n.getTile(e):x?x[e.key]:new yt(e,d,h.zoom,t),E=p?co(S,s,a,t,0,r.scope,f,l,{tileID:e,tileSize:d}):lo(S,s,a,o.toRenderColor(r.lut));t.uploadCommonUniforms(c,b,w);const{tileBoundsBuffer:A,tileBoundsIndexBuffer:M,tileBoundsSegments:P}=t.getTileBoundsBuffers(T);b.draw(t,u.TRIANGLES,y,g,_,Bn.disabled,E,r.id,A,M,P)}},sky:function(t,n,r){const i=t._atmosphere?e.a9(t.transform.zoom):1,o=r.paint.get("sky-opacity")*i;if(0===o)return;const a=t.context,s=r.paint.get("sky-type"),l=new Dn(a.gl.LEQUAL,Dn.ReadOnly,[0,1]),c=t.frameCounter/1e3%1;"atmosphere"===s?"offscreen"===t.renderPass?r.needsSkyboxCapture(t)&&(function(t,n){const r=t.context,i=r.gl;let o=n.skyboxFbo;if(!o){o=n.skyboxFbo=r.createFramebuffer(32,32,!0,null),n.skyboxGeometry=new na(r),n.skyboxTexture=r.gl.createTexture(),i.bindTexture(i.TEXTURE_CUBE_MAP,n.skyboxTexture),i.texParameteri(i.TEXTURE_CUBE_MAP,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_CUBE_MAP,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_CUBE_MAP,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_CUBE_MAP,i.TEXTURE_MAG_FILTER,i.LINEAR);for(let e=0;e<6;++e)i.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+e,0,i.RGBA,32,32,0,i.RGBA,i.UNSIGNED_BYTE,null)}r.bindFramebuffer.set(o.framebuffer),r.viewport.set([0,0,32,32]);const a=n.getCenter(t,!0),s=t.getOrCreateProgram("skyboxCapture"),l=new Float64Array(16);e.a6.mat4.identity(l),e.a6.mat4.rotateY(l,l,.5*-Math.PI),ra(t,n,s,l,a,0),e.a6.mat4.identity(l),e.a6.mat4.rotateY(l,l,.5*Math.PI),ra(t,n,s,l,a,1),e.a6.mat4.identity(l),e.a6.mat4.rotateX(l,l,.5*-Math.PI),ra(t,n,s,l,a,2),e.a6.mat4.identity(l),e.a6.mat4.rotateX(l,l,.5*Math.PI),ra(t,n,s,l,a,3),e.a6.mat4.identity(l),ra(t,n,s,l,a,4),e.a6.mat4.identity(l),e.a6.mat4.rotateY(l,l,Math.PI),ra(t,n,s,l,a,5),r.viewport.set([0,0,t.width,t.height])}(t,r),r.markSkyboxValid(t)):"sky"===t.renderPass&&function(e,t,n,r,i){const o=e.context,a=o.gl,s=e.transform,l=e.getOrCreateProgram("skybox");o.activeTexture.set(a.TEXTURE0),a.bindTexture(a.TEXTURE_CUBE_MAP,t.skyboxTexture);const c=((e,t,n,r,i)=>({u_matrix:e,u_sun_direction:t,u_cubemap:0,u_opacity:r,u_temporal_offset:i}))(s.skyboxMatrix,t.getCenter(e,!1),0,r,i);e.uploadCommonUniforms(o,l),l.draw(e,a.TRIANGLES,n,zn.disabled,e.colorModeForRenderPass(),Bn.backCW,c,"skybox",t.skyboxGeometry.vertexBuffer,t.skyboxGeometry.indexBuffer,t.skyboxGeometry.segment)}(t,r,l,o,c):"gradient"===s&&"sky"===t.renderPass&&function(t,n,r,i,o){const a=t.context,s=a.gl,l=t.transform,c=t.getOrCreateProgram("skyboxGradient");n.skyboxGeometry||(n.skyboxGeometry=new na(a)),a.activeTexture.set(s.TEXTURE0);let u=n.colorRampTexture;u||(u=n.colorRampTexture=new e.T(a,n.colorRamp,s.RGBA8)),u.bind(s.LINEAR,s.CLAMP_TO_EDGE);const h=((t,n,r,i,o)=>({u_matrix:t,u_color_ramp:0,u_center_direction:n,u_radius:e.bC(r),u_opacity:i,u_temporal_offset:o}))(l.skyboxMatrix,n.getCenter(t,!1),n.paint.get("sky-gradient-radius"),i,o);t.uploadCommonUniforms(a,c),c.draw(t,s.TRIANGLES,r,zn.disabled,t.colorModeForRenderPass(),Bn.backCW,h,"skyboxGradient",n.skyboxGeometry.vertexBuffer,n.skyboxGeometry.indexBuffer,n.skyboxGeometry.segment)}(t,r,l,o,c)},debug:function(t,n,r,i,o,a){for(let s=0;s<r.length;s++)if(o){const o=1,l=.8,c=new e.bA(i.r*l,i.g*l,i.b*l,1);Yo(t,n,r[s],i,-o,-o,a),Yo(t,n,r[s],i,-o,o,a),Yo(t,n,r[s],i,o,o,a),Yo(t,n,r[s],i,o,-o,a),Yo(t,n,r[s],c,0,0,a)}else Yo(t,n,r[s],i,0,0,a)},custom:function(t,n,r,i){const o=t.context,a=r.implementation;if(!t.transform.projection.unsupportedLayers||!t.transform.projection.unsupportedLayers.includes("custom")||t.terrain&&(t.terrain.renderingToTexture||"offscreen"===t.renderPass)&&r.isDraped(n)){if("offscreen"===t.renderPass){const n=a.prerender;if(n){if(t.setCustomLayerDefaults(),o.setColorMode(t.colorModeForRenderPass()),"globe"===t.transform.projection.name){const r=t.transform.pointMerc;n.call(a,o.gl,t.transform.customLayerMatrix(),t.transform.getProjection(),t.transform.globeToMercatorMatrix(),e.a9(t.transform.zoom),[r.x,r.y],t.transform.pixelsPerMeterRatio)}else n.call(a,o.gl,t.transform.customLayerMatrix());o.setDirty(),t.setBaseState()}}else if("translucent"===t.renderPass){if(t.terrain&&t.terrain.renderingToTexture){const n=a.renderToTile;if(n){const r=i[0].canonical,s=new e.a5(r.x+i[0].wrap*(1<<r.z),r.y,r.z);o.setDepthMode(Dn.disabled),o.setStencilMode(zn.disabled),o.setColorMode(t.colorModeForRenderPass()),t.setCustomLayerDefaults(),n.call(a,o.gl,s),o.setDirty(),t.setBaseState()}return}t.setCustomLayerDefaults(),o.setColorMode(t.colorModeForRenderPass()),o.setStencilMode(zn.disabled);const n="3d"===a.renderingMode?new Dn(t.context.gl.LEQUAL,Dn.ReadWrite,t.depthRangeFor3D):t.depthModeForSublayer(0,Dn.ReadOnly);if(o.setDepthMode(n),"globe"===t.transform.projection.name){const n=t.transform.pointMerc;a.render(o.gl,t.transform.customLayerMatrix(),t.transform.getProjection(),t.transform.globeToMercatorMatrix(),e.a9(t.transform.zoom),[n.x,n.y],t.transform.pixelsPerMeterRatio)}else a.render(o.gl,t.transform.customLayerMatrix());o.setDirty(),t.setBaseState(),o.bindFramebuffer.set(null)}}else e.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(t,n,r,o){if("opaque"===t.renderPass)return;const a=r.paint.get("model-opacity");if(0===a)return;const s=r.paint.get("model-cast-shadows");if("shadow"===t.renderPass){if(!s)return;if(t.terrain&&a<.65&&r._transitionablePaint._values["model-opacity"].value.expression instanceof e.a4)return}const l=t.shadowRenderer,c=r.paint.get("model-receive-shadows");l&&(l.useNormalOffset=!0,c||(l.enabled=!1));const u=()=>{l&&(l.useNormalOffset=!0,c||(l.enabled=!0))},h=n.getSource();if("light-beam"===t.renderPass&&"batched-model"!==h.type)return;if("vector"===h.type||"geojson"===h.type)return function(t,n,r,o,a){const s=t.transform;if("mercator"!==s.projection.name)return void e.w("Drawing 3D models for ".concat(s.projection.name," projection is not yet implemented"));const l=s.getFreeCameraOptions().position;if(!t.modelManager)return;const c=t.modelManager;r.modelManager=c;const u=t.shadowRenderer;if(!r._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const h=r._unevaluatedLayout._values["model-id"],d=i({},r.layout.get("model-id").parameters),p=t.style.order.indexOf(r.fqid);for(const i of o){const o=n.getTile(i).getBucket(r);if(!o||o.projection.name!==s.projection.name)continue;const f=o.getModelUris();f&&!o.modelsRequested&&(c.addModelsFromBucket(f,a),o.modelsRequested=!0);const m=ga(i,s);d.zoom=m;const g=h.possiblyEvaluate(d);if(fa(t,o,i),ma.shadowUniformsInitialized=!1,ma.useSingleShadowCascade=!!u&&0===u.getMaxCascadeForTile(i.toUnwrapped()),"shadow"===t.renderPass&&u){if(1===t.currentShadowCascade&&o.isInsideFirstShadowMapFrustum)continue;const n=s.calculatePosMatrix(i.toUnwrapped(),s.worldSize);if(ma.tileMatrix.set(n),ma.shadowTileMatrix=Float32Array.from(u.calculateShadowPassMatrixFromMatrix(n)),ma.aabb.min.fill(0),ma.aabb.max[0]=ma.aabb.max[1]=e.ab,ma.aabb.max[2]=0,va(o,ma,t,r.scope))continue}const y=1<<i.canonical.z,_=[((l.x-i.wrap)*y-i.canonical.x)*e.ab,(l.y*y-i.canonical.y)*e.ab,l.z*y*e.ab];t.conflationActive&&Object.keys(o.instancesPerModel).length>0&&t.style.isLayerClipped(r,n.getSource())&&o.updateReplacement(i,t.replacementSource,p,a)&&(o.uploaded=!1,o.upload(t.context));for(let e in o.instancesPerModel){const n=o.instancesPerModel[e];n.features.length>0&&(e=g.evaluate(n.features[0].feature,{}));const s=c.getModel(e,a);if(s&&s.uploaded)for(const e of s.nodes)ya(t,r,e,n,_,i,ma)}}}(t,n,r,o,"vector"===h.type?r.scope:""),void u();if(!h.loaded())return;if("batched-model"===h.type)return function(t,n,r,i){r.resetLayerRenderingStats(t);const o=t.context,a=t.transform,s=t.style.fog,l=t.shadowRenderer;if("mercator"!==a.projection.name)return void e.w("Drawing 3D landmark models for ".concat(a.projection.name," projection is not yet implemented"));const c=t.transform.getFreeCameraOptions().position,u=e.a6.vec3.scale([],[c.x,c.y,c.z],t.transform.worldSize),h=e.a6.vec3.negate([],u),d=e.a6.mat4.identity([]),p=e.de(a.center.lat,a.zoom),f=e.a6.mat4.fromScaling([],[1,1,1/p]);e.a6.mat4.translate(d,d,h);const m=r.paint.get("model-opacity"),g=new Dn(o.gl.LEQUAL,Dn.ReadWrite,t.depthRangeFor3D),y=new Dn(o.gl.LEQUAL,Dn.ReadOnly,t.depthRangeFor3D),_=new e.ca([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),v="shadow"===t.renderPass,x=v&&l?l.getCurrentCascadeFrustum():a.getFrustum(a.scaleZoom(a.worldSize)),b=r.paint.get("model-front-cutoff"),w=b[2]<1,S=Jn(t,r.paint.get("model-cutoff-fade-range")),T=r.getLayerRenderingStats();(function(e,t,n,r){const i=e.terrain?e.terrain.exaggeration():0,o=e.transform.zoom;for(const a of r){const r=t.getTile(a).getBucket(n);r&&(e.conflationActive&&r.updateReplacement(a,e.replacementSource),r.evaluateScale(e,n),e.terrain&&i>0&&r.elevationUpdate(e.terrain,i,a,n.source),r.needsReEvaluation(e,o,n)&&r.evaluate(n))}})(t,n,r,i),function(){let c,h,E;w?(c=i.length-1,h=-1,E=-1):(c=0,h=i.length,E=1);const A=new Float64Array(16),M=e.a6.vec3.create(),P=new e.P(0,0);for(let k=c;k!==h;k+=E){const c=i[k],h=n.getTile(c).getBucket(r);if(!h||!h.uploaded)continue;let E=!1;l&&(E=0===l.getMaxCascadeForTile(c.toUnwrapped()));const C=a.calculatePosMatrix(c.toUnwrapped(),a.worldSize),j=h.modelTraits;!v&&w&&(e.a6.mat4.invert(A,C),e.a6.vec3.transformMat4(M,u,A),P.x=M[0],P.y=M[1]);const I=[];for(const n of h.getNodesInfo()){if(n.hiddenByReplacement)continue;if(!n.node.meshes)continue;const r=n.node;let i=0;t.terrain&&r.elevation&&(i=r.elevation*t.terrain.exaggeration());const o=(()=>{const t=n.aabb;return _.min=[...t.min],_.max=[...t.max],_.min[2]+=i,_.max[2]+=i,e.a6.vec3.transformMat4(_.min,_.min,C),e.a6.vec3.transformMat4(_.max,_.max,C),_})(),s=n.evaluatedScale;if(s[0]<=1&&s[1]<=1&&s[2]<=1&&0===o.intersects(x))continue;if(!v&&w){const t=1/6;n.cameraCollisionOpacity=u[0]>o.min[0]&&u[0]<o.max[0]&&u[1]>o.min[1]&&u[1]<o.max[1]&&u[2]*p<o.max[2]&&r.footprint&&e.bv(P,r.footprint)?Math.max(n.cameraCollisionOpacity-t,0):Math.min(1,n.cameraCollisionOpacity+t)}const l=[...C],c=r.anchor?r.anchor[0]:0,h=r.anchor?r.anchor[1]:0;e.a6.mat4.translate(l,l,[c*(s[0]-1),h*(s[1]-1),i]),e.a6.vec3.exactEquals(s,e.dh)||e.a6.mat4.scale(l,l,s);const d=e.a6.mat4.multiply([],l,r.matrix),f=e.a6.mat4.multiply([],a.expandedFarZProjMatrix,d),g=e.a6.mat4.multiply([],a.expandedFarZProjMatrix,l),y=e.a6.vec4.transformMat4([],[c,h,i,1],f)[2];r.hidden=!1;let T=m;v||(w&&(T*=n.cameraCollisionOpacity,T*=ba(l,a,n.aabb,b)),T*=xa(S,y)),0!==T?I.push({nodeInfo:n,depth:y,opacity:T,wvpForNode:f,wvpForTile:g,nodeModelMatrix:d,tileModelMatrix:l}):r.hidden=!0}v||I.sort(((e,t)=>!w||1===e.opacity&&1===t.opacity?e.depth<t.depth?-1:1:1===e.opacity?-1:1===t.opacity?1:e.depth>t.depth?-1:1));for(const n of I){const i=n.nodeInfo,c=i.node;let u=e.a6.mat4.multiply([],f,n.tileModelMatrix);e.a6.mat4.multiply(u,d,u);const h=e.a6.mat4.invert([],u);e.a6.mat4.transpose(h,h),e.a6.mat4.scale(h,h,_a),u=e.a6.mat4.multiply(u,u,c.matrix);const p="light-beam"===t.renderPass,m=j&e.dj.HasMapboxMeshFeatures,_=m?0:i.evaluatedRMEA[0][2];for(let e=0;e<c.meshes.length;++e){const d=c.meshes[e],f=e===c.lightMeshIndex;let x=n.wvpForNode;if(f){if(!p&&!t.terrain&&t.shadowRenderer){t.currentLayer<t.firstLightBeamLayer&&(t.firstLightBeamLayer=t.currentLayer);continue}x=n.wvpForTile}else if(p)continue;const b={defines:[]},w=[];if(!v&&l&&(l.useNormalOffset=!!d.normalBuffer),ua(b.defines,w,d,t,r.lut),m||b.defines.push("DIFFUSE_SHADED"),E&&b.defines.push("SHADOWS_SINGLE_CASCADE"),T&&(v?T.numRenderedVerticesInShadowPass+=d.vertexArray.length:T.numRenderedVerticesInTransparentPass+=d.vertexArray.length),v){pa(d,n.nodeModelMatrix,t,r);continue}let S=null;if(s){const e=ca(n.nodeModelMatrix,t.transform);if(S=new Float32Array(e),"globe"!==a.projection.name){const t=d.aabb.min,n=d.aabb.max,[r,i]=s.getOpacityForBounds(e,t[0],t[1],n[0],n[1]);b.overrideFog=r>=Re||i>=Re}}const A=d.material;let M;A.occlusionTexture&&A.occlusionTexture.offsetScale&&(M=A.occlusionTexture.offsetScale,b.defines.push("OCCLUSION_TEXTURE_TRANSFORM"));const P=t.getOrCreateProgram("model",b);!v&&l&&l.setupShadowsFromMatrix(n.tileModelMatrix,P,l.useNormalOffset),t.uploadCommonUniforms(o,P,null,S);const k=A.pbrMetallicRoughness;k.metallicFactor=.9,k.roughnessFactor=.5;const C=ho(new Float32Array(x),new Float32Array(u),new Float32Array(h),new Float32Array(c.matrix),t,n.opacity,k.baseColorFactor.toRenderColor(null),A.emissiveFactor,k.metallicFactor,k.roughnessFactor,A,_,r,[0,0,0],M);!f&&(i.hasTranslucentParts||n.opacity<1)&&P.draw(t,o.gl.TRIANGLES,g,zn.disabled,Nn.disabled,Bn.backCCW,C,r.id,d.vertexBuffer,d.indexBuffer,d.segments,r.paint,t.transform.zoom,void 0,w),P.draw(t,o.gl.TRIANGLES,f?y:g,zn.disabled,f||n.opacity<1||i.hasTranslucentParts?Nn.alphaBlended:Nn.unblended,Bn.backCCW,C,r.id,d.vertexBuffer,d.indexBuffer,d.segments,r.paint,t.transform.zoom,void 0,w)}}}}()}(t,n,r,o),void u();if("model"!==h.type)return;const d=h.getModels(),p=[],f=t.transform.getFreeCameraOptions().position,m=e.a6.vec3.scale([],[f.x,f.y,f.z],t.transform.worldSize);e.a6.vec3.negate(m,m);const g=[],y=[];let _=0;for(const i of d){const n=r.paint.get("model-rotation").constantOr(null),o=r.paint.get("model-scale").constantOr(null),a=r.paint.get("model-translation").constantOr(null);i.computeModelMatrix(t,n,o,a,!0,!0,!1);const s=e.a6.mat4.identity([]),l=e.de(i.position.lat,t.transform.zoom),c=e.a6.mat4.fromScaling([],[1,1,1/l]);e.a6.mat4.translate(s,s,m),p.push({zScaleMatrix:c,negCameraPosMatrix:s});for(const e of i.nodes)da(t.transform,e,i.matrix,t.transform.expandedFarZProjMatrix,_,g,y);_++}if(g.sort(((e,t)=>t.depth-e.depth)),"shadow"!==t.renderPass){if(1===a)for(const e of y)ha(e,t,r,p[e.modelIndex],zn.disabled,t.colorModeForRenderPass());else{for(const e of y)ha(e,t,r,p[e.modelIndex],zn.disabled,Nn.disabled);for(const e of y)ha(e,t,r,p[e.modelIndex],t.stencilModeFor3D(),t.colorModeForRenderPass());t.resetStencilClippingMasks()}for(const e of g)ha(e,t,r,p[e.modelIndex],zn.disabled,t.colorModeForRenderPass());u()}else{for(const e of y)pa(e.mesh,e.nodeModelMatrix,t,r);for(const e of g)pa(e.mesh,e.nodeModelMatrix,t,r);u()}}},Ma={model:function(e,t,n){const r=t.getSource();if(!r.loaded())return;if("vector"===r.type||"geojson"===r.type)return void(n.modelManager&&n.modelManager.upload(n,"vector"===r.type?e.scope:""));if("batched-model"===r.type)return;if("model"!==r.type)return;const i=r.getModels();for(const o of i)o.upload(n.context)},raster:function(e,t,n){const r=t.getSource();if(!(r instanceof tt&&r.loaded()))return;const i=e.sourceLayer||r.rasterLayerIds&&r.rasterLayerIds[0];if(!i)return;const o=e.paint.get("raster-array-band")||r.getInitialBand(i);if(null==o)return;const a=t.getIds().map((e=>t.getTileByID(e)));for(const s of a)s.updateNeeded(i,o)&&r.prepareTile(s,i,o)},"raster-particle":function(e,t,n){const r=t.getSource();if(!(r instanceof tt&&r.loaded()))return;const i=e.sourceLayer||r.rasterLayerIds&&r.rasterLayerIds[0];if(!i)return;const o=e.paint.get("raster-particle-array-band")||r.getInitialBand(i);if(null==o)return;const a=t.getIds().map((e=>t.getTileByID(e)));for(const s of a)s.updateNeeded(i,o)&&r.prepareTile(s,i,o)}};class Pa{constructor(t,n,r,i,o){this.context=new vo(t,n),this.transform=r,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=o,this._timeStamp=e.q.now(),this._averageFPS=0,this._fpsHistory=[],this._dt=0,this._debugParams={forceEnablePrecipitation:!1,showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};const a=["fill","line","symbol","circle","heatmap","fill-extrusion","raster","raster-particle","hillshade","model","background","sky"];for(const e of a)this._debugParams.enabledLayers[e]=!0;o.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},(()=>{this.style.map.triggerRepaint()})),o.registerParameter(this._debugParams,["Precipitation"],"forceEnablePrecipitation"),o.registerParameter(this._debugParams,["FPS"],"fpsWindow",{min:1,max:100,step:1}),o.registerBinding(this._debugParams,["FPS"],"continousRedraw",{readonly:!0,label:"continuous redraw"}),o.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"value"}),o.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"graph",view:"graph",min:0,max:200});for(const e of a)o.registerParameter(this._debugParams.enabledLayers,["Debug","Layers"],e);this.occlusionParams=new Ta(o),this.setup(),this.numSublayers=bt.maxUnderzooming+bt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new e.dl,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new tr(this),this._wireframeDebugCache=new Sa,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0,this.layersWithOcclusionOpacity=[];const s=new e.r({width:1,height:1},Uint8Array.of(0,0,0,0));this.emptyDepthTexture=new e.T(this.context,s,t.RGBA8),this._clippingActiveLastFrame=!1,this.scaleFactor=i}updateTerrain(e,t){const n=!!e&&!!e.terrain&&this.transform.projection.supportsTerrain;if(!(n||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Oi(this,e));const r=this._terrain;this.transform.elevation=n?r:null,r.update(e,this.transform,t),this.transform.elevation&&!r.enabled&&(this.transform.elevation=null)}_updateFog(e){const t=e.fog;if(!t||"globe"===this.transform.projection.name||t.getOpacity(this.transform.pitch)<1||t.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[n,r]=t.getFovAdjustedRange(this.transform._fov);if(n>r)return void(this.transform.fogCullDistSq=null);const i=n+.78*(r-n);this.transform.fogCullDistSq=i*i}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled||this._forceTerrainMode?this._terrain:null}get forceTerrainMode(){return this._forceTerrainMode}set forceTerrainMode(e){e&&!this._terrain&&(this._terrain=new Oi(this,this.style)),this._forceTerrainMode=e}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(t,n){if(this.width=t*e.q.devicePixelRatio,this.height=n*e.q.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const e of this.style.order)this.style._mergedLayers[e].resize()}setup(){const t=this.context,n=new e.a$;n.emplaceBack(0,0),n.emplaceBack(e.ab,0),n.emplaceBack(0,e.ab),n.emplaceBack(e.ab,e.ab),this.tileExtentBuffer=t.createVertexBuffer(n,e.b1.members),this.tileExtentSegments=e.b2.simpleSegment(0,0,4,2);const r=new e.a$;r.emplaceBack(0,0),r.emplaceBack(e.ab,0),r.emplaceBack(0,e.ab),r.emplaceBack(e.ab,e.ab),this.debugBuffer=t.createVertexBuffer(r,e.b1.members),this.debugSegments=e.b2.simpleSegment(0,0,4,5);const i=new e.a$;i.emplaceBack(-1,-1),i.emplaceBack(1,-1),i.emplaceBack(-1,1),i.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(i,e.b1.members),this.viewportSegments=e.b2.simpleSegment(0,0,4,2);const o=new e.aO;o.emplaceBack(0,0,0,0),o.emplaceBack(e.ab,0,e.ab,0),o.emplaceBack(0,e.ab,0,e.ab),o.emplaceBack(e.ab,e.ab,e.ab,e.ab),this.mercatorBoundsBuffer=t.createVertexBuffer(o,e.b4.members),this.mercatorBoundsSegments=e.b2.simpleSegment(0,0,4,2);const a=new e.aP;a.emplaceBack(0,1,2),a.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(a);const s=new e.b0;for(const e of[0,1,3,2,0])s.emplaceBack(e);this.debugIndexBuffer=t.createIndexBuffer(s),this.emptyTexture=new e.T(t,new e.r({width:1,height:1},Uint8Array.of(0,0,0,0)),t.gl.RGBA8),this.identityMat=e.a6.mat4.create();const l=this.context.gl;this.stencilClearMode=new zn({func:l.ALWAYS,mask:0},0,255,l.ZERO,l.ZERO,l.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(e){return e._makeTileBoundsBuffers(this.context,this.transform.projection),e._tileBoundsBuffer?{tileBoundsBuffer:e._tileBoundsBuffer,tileBoundsIndexBuffer:e._tileBoundsIndexBuffer,tileBoundsSegments:e._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const e=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,e.TRIANGLES,Dn.disabled,this.stencilClearMode,Nn.disabled,Bn.disabled,Pi(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(e,t,n){if(!t||this.currentStencilSource===t.id||!e.isTileClipped()||!n||0===n.length)return;if(this._tileClippingMaskIDs&&!this.terrain){let e=!1;for(const t of n)if(void 0===this._tileClippingMaskIDs[t.key]){e=!0;break}if(!e)return}this.currentStencilSource=t.id;const r=this.context,i=r.gl;this.nextStencilID+n.length>256&&this.clearStencil(),r.setColorMode(Nn.disabled),r.setDepthMode(Dn.disabled);const o=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const a of n){const e=t.getTile(a),n=this._tileClippingMaskIDs[a.key]=this.nextStencilID++,{tileBoundsBuffer:r,tileBoundsIndexBuffer:s,tileBoundsSegments:l}=this.getTileBoundsBuffers(e);o.draw(this,i.TRIANGLES,Dn.disabled,new zn({func:i.ALWAYS,mask:0},n,255,i.KEEP,i.KEEP,i.REPLACE),Nn.disabled,Bn.disabled,Pi(a.projMatrix),"$clipping",r,s,l)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const e=this.nextStencilID++,t=this.context.gl;return new zn({func:t.NOTEQUAL,mask:255},e,255,t.KEEP,t.KEEP,t.REPLACE)}stencilModeForClipping(e){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(e);const t=this.context.gl;return new zn({func:t.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,t.KEEP,t.KEEP,t.REPLACE)}stencilConfigForOverlap(e){const t=this.context.gl,n=e.sort(((e,t)=>t.overscaledZ-e.overscaledZ)),r=n[n.length-1].overscaledZ,i=n[0].overscaledZ-r+1;if(i>1){this.currentStencilSource=void 0,this.nextStencilID+i>256&&this.clearStencil();const e={};for(let n=0;n<i;n++)e[n+r]=new zn({func:t.GEQUAL,mask:255},n+this.nextStencilID,255,t.KEEP,t.KEEP,t.REPLACE);return this.nextStencilID+=i,[e,n]}return[{[r]:zn.disabled},n]}colorModeForRenderPass(){const t=this.context.gl;if(this._showOverdrawInspector){const n=1/8;return new Nn([t.CONSTANT_COLOR,t.ONE,t.CONSTANT_COLOR,t.ONE],new e.bA(n,n,n,0),[!0,!0,!0,!0])}return"opaque"===this.renderPass?Nn.unblended:Nn.alphaBlended}colorModeForDrapableLayerRenderPass(t){const n=this.context.gl;return(()=>this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture)()&&"translucent"===this.renderPass?new Nn([n.ONE,n.ONE_MINUS_SRC_ALPHA,n.CONSTANT_ALPHA,n.ONE_MINUS_SRC_ALPHA],new e.bA(0,0,0,void 0===t?0:t),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.depthOcclusion)return new Dn(this.context.gl.GREATER,Dn.ReadOnly,this.depthRangeFor3D);if(!this.opaquePassEnabledForLayer()&&!r)return Dn.disabled;const i=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new Dn(n||this.context.gl.LEQUAL,t,[i,i])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}blitDepth(){const t=this.context.gl,n=Math.ceil(this.width),r=Math.ceil(this.height),i=this.context.bindFramebuffer.get(),o=t.getParameter(t.TEXTURE_BINDING_2D);this.depthFBO&&this.depthFBO.width===n&&this.depthFBO.height===r||(this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),0!==n&&0!==r&&(this.depthFBO=new _o(this.context,n,r,!1,"texture"),this.depthTexture=new e.T(this.context,{width:n,height:r,data:null},t.DEPTH24_STENCIL8),this.depthFBO.depthAttachment.set(this.depthTexture.texture))),this.context.bindFramebuffer.set(i),t.bindTexture(t.TEXTURE_2D,o),this.depthFBO&&(t.bindFramebuffer(t.READ_FRAMEBUFFER,null),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,this.depthFBO.framebuffer),t.blitFramebuffer(0,0,n,r,0,0,n,r,t.DEPTH_BUFFER_BIT,t.NEAREST),t.bindFramebuffer(t.FRAMEBUFFER,this.context.bindFramebuffer.current))}updateAverageFPS(){this._fpsHistory.push(0===this._dt?0:1e3/this._dt),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce(((e,t)=>e+t/this._fpsHistory.length),0))}render(t,n){const r=e.q.now();this._dt=r-this._timeStamp,this._timeStamp=r,this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=t.map.repaint,this.style=t,this.options=n;const i=this.style._mergedLayers,o=this.style._getOrder(!(!this.terrain||!this.terrain.enabled)).filter((e=>{const t=i[e];return!(t.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[t.type]}));let a=!1,s=!1;for(const e of o){const t=i[e];"circle"===t.type&&(a=!0),"symbol"===t.type&&(t.hasInitialOcclusionOpacityProperties?s=!0:a=!0)}const l=o.map((e=>i[e])),c=this.style._mergedSourceCaches;this.imageManager=t.imageManager,this.modelManager=t.modelManager,this.symbolFadeChange=t.placement.symbolFadeChange(e.q.now()),this.imageManager.beginFrame();let u=0,h=!1;for(const e in c){const t=c[e];t.used&&(t.prepare(this.context),t.getSource().usedInConflation&&++u)}let d=!1;for(const e of l)e.isHidden(this.transform.zoom)||("clip"===e.type&&(d=!0),this.prepareLayer(e));const p={},f={},m={},g={},y={};for(const e in c){const t=c[e];p[e]=t.getVisibleCoordinates(),f[e]=p[e].slice().reverse(),m[e]=t.getVisibleCoordinates(!0).reverse(),g[e]=t.getShadowCasterCoordinates(),y[e]=t.sortCoordinatesByDistance(p[e])}const _=e=>{const t=this.style.getLayerSourceCache(e);return t&&t.used?t.getSource():null};if(u||d||this._clippingActiveLastFrame){const t=[],n=[];let r=0;for(const e of l)this.isSourceForClippingOrConflation(e,_(e))&&(t.push(e),n.push(r)),r++;if(t&&(d||t.length>1)||this._clippingActiveLastFrame){d=!1;const r=[];for(let i=0;i<t.length;i++){const o=t[i],a=n[i],s=this.style.getLayerSourceCache(o);if(!s||!s.used||!s.getSource().usedInConflation&&"clip"!==o.type)continue;let l=e.dn,c=e.bt.None;const u=[];let h=!0;if("clip"===o.type){l=a;for(const t of o.layout.get("clip-layer-types"))c|="model"===t?e.bt.Model:"symbol"===t?e.bt.Symbol:e.bt.FillExtrusion;for(const e of o.layout.get("clip-layer-scope"))u.push(e);o.isHidden(this.transform.zoom)?h=!1:d=!0}h&&r.push({layer:o.fqid,cache:s,order:l,clipMask:c,clipScope:u})}this.replacementSource.setSources(r),h=!0}}this._clippingActiveLastFrame=d,h||this.replacementSource.clear(),this.conflationActive=h,this.minCutoffZoom=0,this.longestCutoffRange=0,this.opaquePassCutoff=1/0,this._lastOcclusionLayer=-1,this.layersWithOcclusionOpacity=[];for(let e=0;e<l.length;e++){const t=l[e],n=t.cutoffRange();if(this.longestCutoffRange=Math.max(n,this.longestCutoffRange),n>0){const e=_(t);e&&(this.minCutoffZoom=Math.max(e.minzoom,this.minCutoffZoom)),t.minzoom&&(this.minCutoffZoom=Math.max(t.minzoom,this.minCutoffZoom))}t.is3D()&&(this.opaquePassCutoff===1/0&&(this.opaquePassCutoff=e),this._lastOcclusionLayer=e)}const v=this.style&&this.style.fog;v?(this._fogVisible=0!==v.getOpacity(this.transform.pitch),this._fogVisible&&"globe"!==this.transform.projection.name&&(this._fogVisible=v.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(m),this.opaquePassCutoff=0);const x=this._shadowRenderer;if(x){x.updateShadowParameters(this.transform,this.style.directionalLight);for(const e in c)for(const t of p[e]){let e={min:0,max:0};this.terrain&&(e=this.terrain.getMinMaxForTile(t)||e),x.addShadowReceiver(t.toUnwrapped(),e.min,e.max)}}if("globe"!==this.transform.projection.name||this.globeSharedBuffers||(this.globeSharedBuffers=new e.dm(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new la(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),!H.has(this.context.gl))return;this.renderPass="offscreen";for(const e of l){const n=t.getLayerSourceCache(e);if(!e.hasOffscreenPass()||e.isHidden(this.transform.zoom))continue;const r=n?f[n.id]:void 0;("custom"===e.type||"raster"===e.type||"raster-particle"===e.type||e.isSky()||r&&r.length)&&this.renderLayer(this,n,e,r)}this.depthRangeFor3D=[0,1-(l.length+2)*this.numSublayers*this.depthEpsilon],this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,g)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const b="globe"===this.transform.projection.name||this.transform.isHorizonVisible(),w=(()=>{if(n.showOverdrawInspector)return e.bA.black;const t=this.style.fog;if(t&&this.transform.projection.supportsFog){const n=this.style.getLut(t.scope);if(!b){const r=t.properties.get("color").toRenderColor(n).toArray01();return new e.bA(...r)}if(b){const r=t.properties.get("space-color").toRenderColor(n).toArray01();return new e.bA(...r)}}return e.bA.transparent})();if(this.context.clear({color:w,depth:1}),this.clearStencil(),this._showOverdrawInspector=n.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&b&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=o.length-1;this.currentLayer>=0;this.currentLayer--){const e=l[this.currentLayer],n=t.getLayerSourceCache(e);if(e.isSky())continue;const r=n?(e.is3D()?y:f)[n.id]:void 0;this._renderTileClippingMasks(e,n,r),this.renderLayer(this,n,e,r)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&b&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||e.a9(this.transform.zoom)>0)&&("globe"===this.transform.projection.name||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<o.length;this.currentLayer++){const e=l[this.currentLayer],n=t.getLayerSourceCache(e);e.isSky()&&this.renderLayer(this,n,e,n?f[n.id]:void 0)}function S(e,t){let n;return t&&(n=("symbol"===e.type?m:e.is3D()?y:f)[t.id]),n}if(this.renderPass="translucent","globe"===this.transform.projection.name){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<o.length;){const e=l[this.currentLayer];if("raster"===e.type||"raster-particle"===e.type){const n=t.getLayerSourceCache(e);this.renderLayer(this,n,e,S(e,n))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let T=0;x&&(T=x.getShadowCastingLayerCount());let E=!1,A=-1;for(let e=0;e<o.length;++e){const t=l[e];t.isHidden(this.transform.zoom)||t.is3D()&&(A=e)}for(s&&-1===A&&(a=!0);this.currentLayer<o.length;){const e=l[this.currentLayer],n=t.getLayerSourceCache(e);if(e.isSky())++this.currentLayer;else if(this.terrain&&this.style.isLayerDraped(e)){if(e.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer),this._lastOcclusionLayer=Math.max(this.currentLayer,this._lastOcclusionLayer)}else{if(a&&!E&&this.terrain&&!this.transform.isOrthographic&&(E=!0,this.blitDepth()),s&&-1!==A&&this.currentLayer===A+1&&!this.transform.isOrthographic&&this.blitDepth(),e.is3D()||this.terrain||this._renderTileClippingMasks(e,n,n?p[n.id]:void 0),this.renderLayer(this,n,e,S(e,n)),!this.terrain&&x&&T>0&&e.hasShadowPass()&&0==--T&&(x.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){const e=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=e;this.currentLayer++){const e=l[this.currentLayer];if(!e.hasLightBeamPass())continue;const n=t.getLayerSourceCache(e);this.renderLayer(this,n,e,n?f[n.id]:void 0)}this.currentLayer=e,this.renderPass="translucent"}if(this.currentLayer>=this._lastOcclusionLayer&&this.layersWithOcclusionOpacity.length>0){const e=this.currentLayer;this.depthOcclusion=!0;for(const n of this.layersWithOcclusionOpacity){this.currentLayer=n;const e=l[this.currentLayer],r=t.getLayerSourceCache(e),i=r?f[r.id]:void 0;e.is3D()||this.terrain||this._renderTileClippingMasks(e,r,r?p[r.id]:void 0),this.renderLayer(this,r,e,i)}this.depthOcclusion=!1,this.currentLayer=e,this.renderPass="translucent",this.layersWithOcclusionOpacity=[]}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let n=null;l.forEach((e=>{const r=t.getLayerSourceCache(e);r&&!e.isHidden(this.transform.zoom)&&r.getVisibleCoordinates().length&&(!n||n.getSource().maxzoom<r.getSource().maxzoom)&&(n=r)})),n&&this.options.showTileBoundaries&&Aa.debug(this,n,n.getVisibleCoordinates(),e.bA.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&Aa.debug(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new e.bA(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&function(e){const t=e.transform.padding;Ko(e,e.transform.height-(t.top||0),3,Ho),Ko(e,t.bottom||0,3,Zo),Jo(e,t.left||0,3,qo),Jo(e,e.transform.width-(t.right||0),3,Wo);const n=e.transform.centerPoint;!function(e,t,n,r){Qo(e,t-1,n-10,2,20,r),Qo(e,t-10,n-1,20,2,r)}(e,n.x,e.transform.height-n.y,Xo)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),h||(this.conflationActive=!1)}prepareLayer(e){this.gpuTimingStart(e);const{unsupportedLayers:t}=this.transform.projection,n=!t||!t.includes(e.type);if(Ma[e.type]&&(n||this.terrain&&"custom"===e.type)){const t=this.style.getLayerSourceCache(e);Ma[e.type](e,t,this)}this.gpuTimingEnd()}renderLayer(e,t,n,r){n.isHidden(this.transform.zoom)||("background"===n.type||"sky"===n.type||"custom"===n.type||"model"===n.type||"raster"===n.type||"raster-particle"===n.type||r&&r.length)&&(this.id=n.id,this.gpuTimingStart(n),e.transform.projection.unsupportedLayers&&e.transform.projection.unsupportedLayers.includes(n.type)&&(!e.terrain||"custom"!==n.type)||"clip"===n.type||Aa[n.type](e,t,n,r,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(e){if(!this.options.gpuTiming)return;const t=this.context.extTimerQuery,n=this.context.gl;let r=this.gpuTimers[e.id];r||(r=this.gpuTimers[e.id]={calls:0,cpuTime:0,query:n.createQuery()}),r.calls++,n.beginQuery(t.TIME_ELAPSED_EXT,r.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const e=this.context.extTimerQuery,t=this.context.gl,n=t.createQuery();this.deferredRenderGpuTimeQueries.push(n),t.beginQuery(e.TIME_ELAPSED_EXT,n)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const e=this.gpuTimers;return this.gpuTimers={},e}collectDeferredRenderGpuQueries(){const e=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],e}queryGpuTimers(e){const t={};for(const n in e){const r=e[n],i=this.context.extTimerQuery,o=i.getQueryParameter(r.query,this.context.gl.QUERY_RESULT)/1e6;i.deleteQueryEXT(r.query),t[n]=o}return t}queryGpuTimeDeferredRender(e){if(!this.options.gpuTimingDeferredRender)return 0;const t=this.context.gl;let n=0;for(const r of e)n+=t.getQueryParameter(r,t.QUERY_RESULT)/1e6,t.deleteQuery(r);return n}translatePosMatrix(t,n,r,i,o){if(!r[0]&&!r[1])return t;const a=o?"map"===i?this.transform.angle:0:"viewport"===i?-this.transform.angle:0;if(a){const e=Math.sin(a),t=Math.cos(a);r=[r[0]*t-r[1]*e,r[0]*e+r[1]*t]}const s=[o?r[0]:e.ak(n,r[0],this.transform.zoom),o?r[1]:e.ak(n,r[1],this.transform.zoom),0],l=new Float32Array(16);return e.a6.mat4.translate(l,t,s),l}saveTileTexture(e){const t=e.size[0],n=this._tileTextures[t];n?n.push(e):this._tileTextures[t]=[e]}getTileTexture(e){const t=this._tileTextures[e];return t&&t.length>0?t.pop():null}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture||this.forceTerrainMode}linearFloatFilteringSupported(){return null!=this.context.extTextureFloatLinear}currentGlobalDefines(e,t,n){const r=void 0===n?this.terrain&&this.terrain.renderingToTexture:n,i=[];return this.style&&this.style.enable3dLights()&&("globeRaster"===e||"terrainRaster"===e?(i.push("LIGHTING_3D_MODE"),i.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):r||i.push("LIGHTING_3D_MODE")),"shadow"===this.renderPass&&(this._shadowMapDebug||i.push("DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(i.push("TERRAIN"),this.linearFloatFilteringSupported()&&i.push("TERRAIN_DEM_FLOAT_FORMAT")),"globe"===this.transform.projection.name&&i.push("GLOBE"),!this._fogVisible||r||void 0!==t&&!t||i.push("FOG","FOG_DITHERING"),r&&i.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&i.push("OVERDRAW_INSPECTOR"),i}getOrCreateProgram(e,t){this.cache=this.cache||{};const n=t&&t.defines||[],r=t&&t.config,i=this.currentGlobalDefines(e,t&&t.overrideFog,t&&t.overrideRtt).concat(n),o=zi.cacheKey(Cr[e],e,i,r);return this.cache[o]||(this.cache[o]=new zi(this.context,e,Cr[e],r,fo[e],i)),this.cache[o]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new e.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA8))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy(),this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),this.emptyDepthTexture&&this.emptyDepthTexture.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(t,n){if(this.style.enable3dLights()){const r=this.style.directionalLight,i=this.style.ambientLight;if(r&&i){const o=((t,n,r)=>{const i=t.properties.get("direction"),o=t.properties.get("color").toRenderColor(r.getLut(t.scope)).toArray01(),a=t.properties.get("intensity"),s=n.properties.get("color").toRenderColor(r.getLut(n.scope)).toArray01(),l=n.properties.get("intensity"),c=[i.x,i.y,i.z],u=e.cH(s,l),h=e.cH(o,a);return{u_lighting_ambient_color:u,u_lighting_directional_dir:c,u_lighting_directional_color:h,u_ground_radiance:Ni(c,h,u)}})(r,i,this.style);n.setLightsUniformValues(t,o)}}}uploadCommonUniforms(t,n,r,i,o){if(this.uploadCommonLightUniforms(t,n),this.terrain&&this.terrain.renderingToTexture)return;const a=this.style.fog;if(a){const o=a.getOpacity(this.transform.pitch),s=((t,n,r,i,o,a,s,l,c,u,h,d)=>{const p=t.transform,f=n.properties.get("color").toRenderColor(t.style.getLut(n.scope)).toArray01();f[3]=i;const m=t.frameCounter/1e3%1,[g,y]=n.properties.get("vertical-range");return{u_fog_matrix:r?p.calculateFogTileMatrix(r):d||t.identityMat,u_fog_range:n.getFovAdjustedRange(p._fov),u_fog_color:f,u_fog_horizon_blend:n.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(g,y),y],u_fog_temporal_offset:m,u_frustum_tl:o,u_frustum_tr:a,u_frustum_br:s,u_frustum_bl:l,u_globe_pos:c,u_globe_radius:u,u_viewport:h,u_globe_transition:e.a9(p.zoom),u_is_globe:+("globe"===p.projection.name)}})(this,a,r,o,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*e.q.devicePixelRatio,this.transform.height*e.q.devicePixelRatio],i);n.setFogUniformValues(t,s)}o&&n.setCutoffUniformValues(t,o.uniformValues)}setTileLoadedFlag(e){this.tileLoaded=e}saveCanvasCopy(){const e=this.canvasCopy();e&&(this.frameCopies.push(e),this.tileLoaded=!1)}canvasCopy(){const e=this.context.gl,t=e.createTexture();return e.bindTexture(e.TEXTURE_2D,t),e.copyTexImage2D(e.TEXTURE_2D,0,e.RGBA,0,0,e.drawingBufferWidth,e.drawingBufferHeight,0),t}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const e=this.style&&this.style.fog;return!!e&&0!==e.getOpacity(this.transform.pitch)}getBackgroundTiles(){const e=this._backgroundTiles,t=this._backgroundTiles={},n=this.transform.coveringTiles({tileSize:512});for(const r of n)t[r.key]=e[r.key]||new yt(r,512,this.transform.tileZoom,this);return t}clearBackgroundTiles(){this._backgroundTiles={}}isSourceForClippingOrConflation(e,t){return!(!e.is3D()||"clip"!==e.type&&(e.minzoom&&e.minzoom>this.transform.zoom||(this.style._clipLayerPresent||"building"!==e.sourceLayer)&&(!t||"batched-model"!==t.type)))}isTileAffectedByFog(e){if(!this.style||!this.style.fog)return!1;if("globe"===this.transform.projection.name)return!0;let t=this._cachedTileFogOpacities[e.key];return t||(this._cachedTileFogOpacities[e.key]=t=this.style.fog.getOpacityForTile(e)),t[0]>=Re||t[1]>=Re}setupDepthForOcclusion(e,t,n){const r=this.context,i=r.gl,o=!!n;var a;n||(n={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0}),r.activeTexture.set(i.TEXTURE3),e&&this.depthFBO&&this.depthTexture?(this.depthTexture.bind(i.NEAREST,i.CLAMP_TO_EDGE),n.u_depth_size_inv=[1/this.depthFBO.width,1/this.depthFBO.height],n.u_depth_range_unpack=[2/((a=this.depthRangeFor3D)[1]-a[0]),-1-2*a[0]/(a[1]-a[0])],n.u_occluder_half_size=.5*this.occlusionParams.occluderSize,n.u_occlusion_depth_offset=this.occlusionParams.depthOffset):this.emptyDepthTexture.bind(i.NEAREST,i.CLAMP_TO_EDGE),r.activeTexture.set(i.TEXTURE0),o||t.setTerrainUniformValues(r,n)}}function ka(e,t){let n=!1,r=null;const i=()=>{r=null,n&&(e(),r=setTimeout(i,t),n=!1)};return()=>(n=!0,r||i(),r)}class Ca{constructor(t){this._hashName=t&&encodeURIComponent(t),e.aJ(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=ka(this._updateHashUnthrottled.bind(this),300)}addTo(e){return this._map=e,window.addEventListener("hashchange",this._onHashChange,!1),e.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const e=this._map;if(!e)return"";const t=ja(e);if(this._hashName){const e=this._hashName;let n=!1;const r=location.hash.slice(1).split("&").map((r=>{const i=r.split("=")[0];return i===e?(n=!0,"".concat(i,"=").concat(t)):r})).filter((e=>e));return n||r.push("".concat(e,"=").concat(t)),"#".concat(r.join("&"))}return"#".concat(t)}_getCurrentHash(){const e=location.hash.replace("#","");if(this._hashName){let t;return e.split("&").map((e=>e.split("="))).forEach((e=>{e[0]===this._hashName&&(t=e)})),(t&&t[1]||"").split("/")}return e.split("/")}_onHashChange(){const e=this._map;if(!e)return!1;const t=this._getCurrentHash();if(t.length>=3&&!t.some((e=>isNaN(e)))){const n=e.dragRotate.isEnabled()&&e.touchZoomRotate.isEnabled()?+(t[3]||0):e.getBearing();return e.jumpTo({center:[+t[2],+t[1]],zoom:+t[0],bearing:n,pitch:+(t[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function ja(e,t){const n=e.getCenter(),r=Math.round(100*e.getZoom())/100,i=Math.ceil((r*Math.LN2+Math.log(512/360/.5))/Math.LN10),o=Math.pow(10,i),a=Math.round(n.lng*o)/o,s=Math.round(n.lat*o)/o,l=e.getBearing(),c=e.getPitch();let u=t?"/".concat(a,"/").concat(s,"/").concat(r):"".concat(r,"/").concat(s,"/").concat(a);return(l||c)&&(u+="/"+Math.round(10*l)/10),c&&(u+="/".concat(Math.round(c))),u}const Ia={linearity:.3,easing:e.dp(0,0,.3,1)},Oa=e.l({deceleration:2500,maxSpeed:1400},Ia),Na=e.l({deceleration:20,maxSpeed:1400},Ia),Da=e.l({deceleration:1e3,maxSpeed:360},Ia),La=e.l({deceleration:1e3,maxSpeed:90},Ia);class za{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:e.q.now(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,n=e.q.now();for(;t.length>0&&n-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._map._prefersReducedMotion())return;if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const n={zoom:0,bearing:0,pitch:0,pan:new e.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:e}of this._inertiaBuffer)n.zoom+=e.zoomDelta||0,n.bearing+=e.bearingDelta||0,n.pitch+=e.pitchDelta||0,e.panDelta&&n.pan._add(e.panDelta),e.around&&(n.around=e.around),e.pinchAround&&(n.pinchAround=e.pinchAround);const r=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,i={};if(n.pan.mag()){const o=Fa(n.pan.mag(),r,e.l({},Oa,t||{}));i.offset=n.pan.mult(o.amount/n.pan.mag()),i.center=this._map.transform.center,Ra(i,o)}if(n.zoom){const e=Fa(n.zoom,r,Na);i.zoom=this._map.transform.zoom+e.amount,Ra(i,e)}if(n.bearing){const t=Fa(n.bearing,r,Da);i.bearing=this._map.transform.bearing+e.ap(t.amount,-179,179),Ra(i,t)}if(n.pitch){const e=Fa(n.pitch,r,La);i.pitch=this._map.transform.pitch+e.amount,Ra(i,e)}if(i.zoom||i.bearing){const e=void 0===n.pinchAround?n.around:n.pinchAround;i.around=e?this._map.unproject(e):this._map.getCenter()}return this.clear(),i.noMoveStart=!0,i}}function Ra(e,t){(!e.duration||e.duration<t.duration)&&(e.duration=t.duration,e.easing=t.easing)}function Fa(t,n,r){const{maxSpeed:i,linearity:o,deceleration:a}=r,s=e.ap(t*o/(n/1e3),-i,i),l=Math.abs(s)/(a*o);return{easing:r.easing,duration:1e3*l,amount:s*(l/2)}}class Ba extends e.x{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,n,r){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const o=b(n.getCanvasContainer(),r),a=n.unproject(o);super(t,e.l({point:o,lngLat:a,originalEvent:r},i)),this._defaultPrevented=!1,this.target=n}}class Va extends e.x{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,n,r){const i="touchend"===t?r.changedTouches:r.touches,o=w(n.getCanvasContainer(),i),a=o.map((e=>n.unproject(e))),s=o.reduce(((e,t,n,r)=>e.add(t.div(r.length))),new e.P(0,0));super(t,{points:o,point:s,lngLats:a,lngLat:n.unproject(s),originalEvent:r}),this._defaultPrevented=!1}}class Ua extends e.x{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,t){super("wheel",{originalEvent:t}),this._defaultPrevented=!1}}class Ga{constructor(e,t){this._map=e,this._clickTolerance=t.clickTolerance}reset(){this._mousedownPos=void 0}wheel(e){return this._firePreventable(new Ua(this._map,e))}mousedown(e,t){return this._mousedownPos=t,this._firePreventable(new Ba(e.type,this._map,e))}mouseup(e){this._map.fire(new Ba(e.type,this._map,e))}preclick(t){const n=e.l({},t);n.type="preclick",this._map.fire(new Ba(n.type,this._map,n))}click(e,t){this._mousedownPos&&this._mousedownPos.dist(t)>=this._clickTolerance||(this.preclick(e),this._map.fire(new Ba(e.type,this._map,e)))}dblclick(e){return this._firePreventable(new Ba(e.type,this._map,e))}mouseover(e){this._map.fire(new Ba(e.type,this._map,e))}mouseout(e){this._map.fire(new Ba(e.type,this._map,e))}touchstart(e){return this._firePreventable(new Va(e.type,this._map,e))}touchmove(e){this._map.fire(new Va(e.type,this._map,e))}touchend(e){this._map.fire(new Va(e.type,this._map,e))}touchcancel(e){this._map.fire(new Va(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ha{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(e){this._map.fire(new Ba(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ba("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._map.fire(new Ba(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Za{constructor(e,t){this._map=e,this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=t.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,t){this.isEnabled()&&e.shiftKey&&0===e.button&&(y(),this._startPos=this._lastPos=t,this._active=!0)}mousemoveWindow(e,t){if(!this._active)return;const n=t,r=this._startPos,i=this._lastPos;if(!r||!i||i.equals(n)||!this._box&&n.dist(r)<this._clickTolerance)return;this._lastPos=n,this._box||(this._box=d("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",e));const o=Math.min(r.x,n.x),a=Math.max(r.x,n.x),s=Math.min(r.y,n.y),l=Math.max(r.y,n.y);this._map._requestDomTask((()=>{this._box&&(this._box.style.transform="translate(".concat(o,"px,").concat(s,"px)"),this._box.style.width=a-o+"px",this._box.style.height=l-s+"px")}))}mouseupWindow(t,n){if(!this._active)return;const r=this._startPos,i=n;if(r&&0===t.button){if(this.reset(),x(),r.x!==i.x||r.y!==i.y)return this._map.fire(new e.x("boxzoomend",{originalEvent:t})),{cameraAnimation:e=>e.fitScreenCoordinates(r,i,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",t)}}keydown(e){this._active&&27===e.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",e))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),_(),delete this._startPos,delete this._lastPos}_fireEvent(t,n){return this._map.fire(new e.x(t,{originalEvent:n}))}}function qa(e,t){const n={};for(let r=0;r<e.length;r++)n[e[r].identifier]=t[r];return n}class Wa{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(t,n,r){(this.centroid||r.length>this.numTouches)&&(this.aborted=!0),this.aborted||(0===this.startTime&&(this.startTime=t.timeStamp),r.length===this.numTouches&&(this.centroid=function(t){const n=new e.P(0,0);for(const e of t)n._add(e);return n.div(t.length)}(n),this.touches=qa(r,n)))}touchmove(e,t,n){if(this.aborted||!this.centroid)return;const r=qa(n,t);for(const i in this.touches){const e=r[i];(!e||e.dist(this.touches[i])>30)&&(this.aborted=!0)}}touchend(e,t,n){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),0===n.length){const e=!this.aborted&&this.centroid;if(this.reset(),e)return e}}}class Xa{constructor(e){this.singleTap=new Wa(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(e,t,n){this.singleTap.touchstart(e,t,n)}touchmove(e,t,n){this.singleTap.touchmove(e,t,n)}touchend(e,t,n){const r=this.singleTap.touchend(e,t,n);if(r){const t=e.timeStamp-this.lastTime<500,n=!this.lastTap||this.lastTap.dist(r)<30;if(t&&n||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=r,this.count===this.numTaps)return this.reset(),r}}}class Ya{constructor(){this._zoomIn=new Xa({numTouches:1,numTaps:2}),this._zoomOut=new Xa({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,t,n){this._zoomIn.touchstart(e,t,n),this._zoomOut.touchstart(e,t,n)}touchmove(e,t,n){this._zoomIn.touchmove(e,t,n),this._zoomOut.touchmove(e,t,n)}touchend(e,t,n){const r=this._zoomIn.touchend(e,t,n),i=this._zoomOut.touchend(e,t,n);return r?(this._active=!0,e.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:t=>t.easeTo({duration:300,zoom:t.getZoom()+1,around:t.unproject(r)},{originalEvent:e})}):i?(this._active=!0,e.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:t=>t.easeTo({duration:300,zoom:t.getZoom()-1,around:t.unproject(i)},{originalEvent:e})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Ka={0:1,2:2};class Ja{constructor(e){this.reset(),this._clickTolerance=e.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(e,t){return!1}_move(e,t){return{}}mousedown(e,t){if(this._lastPoint)return;const n=S(e);this._correctButton(e,n)&&(this._lastPoint=t,this._eventButton=n)}mousemoveWindow(e,t){const n=this._lastPoint;if(n)if(e.preventDefault(),null!=this._eventButton&&function(e,t){const n=Ka[t];return void 0===e.buttons||(e.buttons&n)!==n}(e,this._eventButton))this.reset();else if(this._moved||!(t.dist(n)<this._clickTolerance))return this._moved=!0,this._lastPoint=t,this._move(n,t)}mouseupWindow(e){this._lastPoint&&S(e)===this._eventButton&&(this._moved&&x(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Qa extends Ja{mousedown(e,t){super.mousedown(e,t),this._lastPoint&&(this._active=!0)}_correctButton(e,t){return 0===t&&!e.ctrlKey}_move(e,t){return{around:t,panDelta:t.sub(e)}}}class $a extends Ja{_correctButton(e,t){return 0===t&&e.ctrlKey||2===t}_move(e,t){const n=.8*(t.x-e.x);if(n)return this._active=!0,{bearingDelta:n}}contextmenu(e){e.preventDefault()}}class es extends Ja{_correctButton(e,t){return 0===t&&e.ctrlKey||2===t}_move(e,t){const n=-.5*(t.y-e.y);if(n)return this._active=!0,{pitchDelta:n}}contextmenu(e){e.preventDefault()}}class ts{constructor(t,n){this._map=t,this._el=t.getCanvasContainer(),this._minTouches=1,this._clickTolerance=n.clickTolerance||1,this.reset(),e.aJ(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new e.P(0,0)}touchstart(e,t,n){return this._calculateTransform(e,t,n)}touchmove(t,n,r){if(this._active&&!(r.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(1===r.length&&!e.dq())return void this._showTouchPanBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return t.cancelable&&t.preventDefault(),this._calculateTransform(t,n,r)}}touchend(e,t,n){this._calculateTransform(e,t,n),this._active&&n.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,n,r){r.length>0&&(this._active=!0);const i=qa(r,n),o=new e.P(0,0),a=new e.P(0,0);let s=0;for(const e in i){const t=i[e],n=this._touches[e];n&&(o._add(t),a._add(t.sub(n)),s++,i[e]=t)}if(this._touches=i,s<this._minTouches||!a.mag())return;const l=a.div(s);return this._sum._add(l),this._sum.mag()<this._clickTolerance?void 0:{around:o.div(s),panDelta:l}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=d("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize="".concat(Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth))),"px"))}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout((()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")}),500)}}class ns{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(e){}_move(e,t,n){return{}}touchstart(e,t,n){this._firstTwoTouches||n.length<2||(this._firstTwoTouches=[n[0].identifier,n[1].identifier],this._start([t[0],t[1]]))}touchmove(e,t,n){const r=this._firstTwoTouches;if(!r)return;e.preventDefault();const[i,o]=r,a=rs(n,t,i),s=rs(n,t,o);if(!a||!s)return;const l=this._aroundCenter?null:a.add(s).div(2);return this._move([a,s],l,e)}touchend(e,t,n){if(!this._firstTwoTouches)return;const[r,i]=this._firstTwoTouches,o=rs(n,t,r),a=rs(n,t,i);o&&a||(this._active&&x(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&"center"===e.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function rs(e,t,n){for(let r=0;r<e.length;r++)if(e[r].identifier===n)return t[r]}function is(e,t){return Math.log(e/t)/Math.LN2}class os extends ns{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,t){const n=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(is(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:is(this._distance,n),pinchAround:t}}}function as(e,t){return 180*e.angleWith(t)/Math.PI}class ss extends ns{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,t){const n=this._vector;if(this._vector=e[0].sub(e[1]),n&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:as(this._vector,n),pinchAround:t}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());const t=25/(Math.PI*this._minDiameter)*360,n=this._startVector;if(!n)return!1;const r=as(e,n);return Math.abs(r)<t}}function ls(e){return Math.abs(e.y)>Math.abs(e.x)}class cs extends ns{constructor(e){super(),this._map=e}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(e){this._lastPoints=e,ls(e[0].sub(e[1]))&&(this._valid=!1)}_move(t,n,r){const i=this._lastPoints;if(!i)return;const o=t[0].sub(i[0]),a=t[1].sub(i[1]);return this._map._cooperativeGestures&&!e.dq()&&r.touches.length<3||(this._valid=this.gestureBeginsVertically(o,a,r.timeStamp),!this._valid)?void 0:(this._lastPoints=t,this._active=!0,{pitchDelta:(o.y+a.y)/2*-.5})}gestureBeginsVertically(e,t,n){if(void 0!==this._valid)return this._valid;const r=e.mag()>=2,i=t.mag()>=2;if(!r&&!i)return;if(!r||!i)return null==this._firstMove&&(this._firstMove=n),n-this._firstMove<100&&void 0;const o=e.y>0==t.y>0;return ls(e)&&ls(t)&&o}}const us={panStep:100,bearingStep:15,pitchStep:10};class hs{constructor(){const e=us;this._panStep=e.panStep,this._bearingStep=e.bearingStep,this._pitchStep=e.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let t=0,n=0,r=0,i=0,o=0;switch(e.keyCode){case 61:case 107:case 171:case 187:t=1;break;case 189:case 109:case 173:t=-1;break;case 37:e.shiftKey?n=-1:(e.preventDefault(),i=-1);break;case 39:e.shiftKey?n=1:(e.preventDefault(),i=1);break;case 38:e.shiftKey?r=1:(e.preventDefault(),o=-1);break;case 40:e.shiftKey?r=-1:(e.preventDefault(),o=1);break;default:return}return this._rotationDisabled&&(n=0,r=0),{cameraAnimation:a=>{const s=a.getZoom();a.easeTo({duration:300,easeId:"keyboardHandler",easing:ds,zoom:t?Math.round(s)+t*(e.shiftKey?2:1):s,bearing:a.getBearing()+n*this._bearingStep,pitch:a.getPitch()+r*this._pitchStep,offset:[-i*this._panStep,-o*this._panStep],center:a.getCenter()},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function ds(e){return e*(2-e)}const ps=4.000244140625,fs=1/450;class ms{constructor(t,n){this._map=t,this._el=t.getCanvasContainer(),this._handler=n,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=fs,e.aJ(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&"center"===e.around,this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(t){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(t.ctrlKey||t.metaKey||this.isZooming()||e.dq()))return void this._showBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let n=t.deltaMode===WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const r=e.q.now(),i=r-(this._lastWheelEventTime||0);this._lastWheelEventTime=r,0!==n&&n%ps==0?this._type="wheel":0!==n&&Math.abs(n)<4?this._type="trackpad":i>400?(this._type=null,this._lastValue=n,this._timeout=window.setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(i*n)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,n+=this._lastValue)),t.shiftKey&&n&&(n/=4),this._type&&(this._lastWheelEvent=t,this._delta-=n,this._active||this._start(t)),t.preventDefault()}_onTimeout(e){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(e)}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const t=b(this._el,e);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:t,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId)return;if(this._frameId=null,!this.isActive())return;const t=this._map.transform;"wheel"===this._type&&t.projection.wrap&&(t._center.lng>=180||t._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const n=()=>t._terrainEnabled()&&this._aroundCoord?t.computeZoomRelativeTo(this._aroundCoord):t.zoom;if(0!==this._delta){const e="wheel"===this._type&&Math.abs(this._delta)>ps?this._wheelZoomRate:this._defaultZoomRate;let r=2/(1+Math.exp(-Math.abs(this._delta*e)));this._delta<0&&0!==r&&(r=1/r);const i=n(),o=Math.pow(2,i),a="number"==typeof this._targetZoom?t.zoomScale(this._targetZoom):o;this._targetZoom=Math.min(t.maxZoom,Math.max(t.minZoom,t.scaleZoom(a*r))),"wheel"===this._type&&(this._startZoom=i,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const r="number"==typeof this._targetZoom?this._targetZoom:n(),i=this._startZoom,o=this._easing;let a,s=!1;if("wheel"===this._type&&i&&o){const t=Math.min((e.q.now()-this._lastWheelEventTime)/200,1),n=o(t);a=e.aa(i,r,n),t<1?this._frameId||(this._frameId=!0):s=!0}else a=r,s=!0;this._active=!0,s&&(this._active=!1,this._finishTimeout=window.setTimeout((()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout}),200));let l=a-n();return l*this._lastDelta<0&&(l=0),{noInertia:!0,needsRenderFrame:!s,zoomDelta:l,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let n=e.dr;if(this._prevEase){const t=this._prevEase,r=(e.q.now()-t.start)/t.duration,i=t.easing(r+.01)-t.easing(r),o=.27/Math.sqrt(i*i+1e-4)*.01,a=Math.sqrt(.0729-o*o);n=e.dp(o,a,.25,1)}return this._prevEase={start:e.q.now(),duration:t,easing:n},n}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=d("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize="".concat(Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth))),"px"))}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout((()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")}),200)}}class gs{constructor(e,t){this._clickZoom=e,this._tapZoom=t}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class ys{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(e,t){return e.preventDefault(),{cameraAnimation:n=>{n.easeTo({duration:300,zoom:n.getZoom()+(e.shiftKey?-1:1),around:n.unproject(t)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class _s{constructor(){this._tap=new Xa({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(e,t,n){this._swipePoint||(this._tapTime&&e.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?n.length>0&&(this._swipePoint=t[0],this._swipeTouch=n[0].identifier):this._tap.touchstart(e,t,n))}touchmove(e,t,n){if(this._tapTime){if(this._swipePoint){if(n[0].identifier!==this._swipeTouch)return;const r=t[0],i=r.y-this._swipePoint.y;return this._swipePoint=r,e.preventDefault(),this._active=!0,{zoomDelta:i/128}}}else this._tap.touchmove(e,t,n)}touchend(e,t,n){this._tapTime?this._swipePoint&&0===n.length&&this.reset():this._tap.touchend(e,t,n)&&(this._tapTime=e.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class vs{constructor(e,t,n){this._el=e,this._mousePan=t,this._touchPan=n}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class xs{constructor(e,t,n){this._pitchWithRotate=e.pitchWithRotate,this._mouseRotate=t,this._mousePitch=n}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class bs{constructor(e,t,n,r){this._el=e,this._touchZoom=t,this._touchRotate=n,this._tapDragZoom=r,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const ws=e=>e.zoom||e.drag||e.pitch||e.rotate;class Ss extends e.x{}class Ts{constructor(){this.constants=[1,1,.01],this.radius=0}setup(t,n){const r=e.a6.vec3.sub([],n,t);this.radius=e.a6.vec3.length(r[2]<0?e.a6.vec3.div([],r,this.constants):[r[0],r[1],0])}projectRay(t){e.a6.vec3.div(t,t,this.constants),e.a6.vec3.normalize(t,t),e.a6.vec3.mul(t,t,this.constants);const n=e.a6.vec3.scale([],t,this.radius);if(n[2]>0){const t=e.a6.vec3.scale([],[0,0,1],e.a6.vec3.dot(n,[0,0,1])),r=e.a6.vec3.scale([],e.a6.vec3.normalize([],[n[0],n[1],0]),this.radius),i=e.a6.vec3.add([],n,e.a6.vec3.scale([],e.a6.vec3.sub([],e.a6.vec3.add([],r,t),n),2));n[0]=i[0],n[1]=i[1]}return n}}function Es(e){return e.panDelta&&e.panDelta.mag()||e.zoomDelta||e.bearingDelta||e.pitchDelta}class As{constructor(t,n){this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new za(t),this._bearingSnap=n.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Ts,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(n),e.aJ(["handleEvent","handleWindowEvent"],this);const r=this._el;this._listeners=[[r,"touchstart",{passive:!0}],[r,"touchmove",{passive:!1}],[r,"touchend",void 0],[r,"touchcancel",void 0],[r,"mousedown",void 0],[r,"mousemove",void 0],[r,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[r,"mouseover",void 0],[r,"mouseout",void 0],[r,"dblclick",void 0],[r,"click",void 0],[r,"keydown",{capture:!1}],[r,"keyup",void 0],[r,"wheel",{passive:!1}],[r,"contextmenu",void 0],[window,"blur",void 0]];for(const[e,i,o]of this._listeners){const t=e===document?this.handleWindowEvent:this.handleEvent;e.addEventListener(i,t,o)}}destroy(){for(const[e,t,n]of this._listeners){const r=e===document?this.handleWindowEvent:this.handleEvent;e.removeEventListener(t,r,n)}}_addDefaultHandlers(e){const t=this._map,n=t.getCanvasContainer();this._add("mapEvent",new Ga(t,e));const r=t.boxZoom=new Za(t,e);this._add("boxZoom",r);const i=new Ya,o=new ys;t.doubleClickZoom=new gs(o,i),this._add("tapZoom",i),this._add("clickZoom",o);const a=new _s;this._add("tapDragZoom",a);const s=t.touchPitch=new cs(t);this._add("touchPitch",s);const l=new $a(e),c=new es(e);t.dragRotate=new xs(e,l,c),this._add("mouseRotate",l,["mousePitch"]),this._add("mousePitch",c,["mouseRotate"]);const u=new Qa(e),h=new ts(t,e);t.dragPan=new vs(n,u,h),this._add("mousePan",u),this._add("touchPan",h,["touchZoom","touchRotate"]);const d=new ss,p=new os;t.touchZoomRotate=new bs(n,p,d,a),this._add("touchRotate",d,["touchPan","touchZoom"]),this._add("touchZoom",p,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Ha(t));const f=t.scrollZoom=new ms(t,this);this._add("scrollZoom",f,["mousePan"]);const m=t.keyboard=new hs;this._add("keyboard",m);for(const g of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])e.interactive&&e[g]&&t[g].enable(e[g])}_add(e,t,n){this._handlers.push({handlerName:e,handler:t,allowed:n}),this._handlersById[e]=t}stop(e){if(!this._updatingCamera){for(const{handler:e}of this._handlers)e.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!ws(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(e,t,n){for(const r in e)if(r!==n&&(!t||t.indexOf(r)<0))return!0;return!1}handleWindowEvent(e){this.handleEvent(e,"".concat(e.type,"Window"))}_getMapTouches(e){const t=[];for(const n of e)this._el.contains(n.target)&&t.push(n);return t}handleEvent(e,t){this._updatingCamera=!0;const n="renderFrame"===e.type,r=n?void 0:e,i={needsRenderFrame:!1},o={},a={},s=e.touches?this._getMapTouches(e.touches):void 0,l=s?w(this._el,s):n?void 0:b(this._el,e);for(const{handlerName:h,handler:d,allowed:p}of this._handlers){if(!d.isEnabled())continue;let n;this._blockedByActive(a,p,h)?d.reset():d[t||e.type]&&(n=d[t||e.type](e,l,s),this.mergeHandlerResult(i,o,n,h,r),n&&n.needsRenderFrame&&this._triggerRenderFrame()),(n||d.isActive())&&(a[h]=d)}const c={};for(const h in this._previousActiveHandlers)a[h]||(c[h]=r);this._previousActiveHandlers=a,(Object.keys(c).length||Es(i))&&(this._changes.push([i,o,c]),this._triggerRenderFrame()),(Object.keys(a).length||Es(i))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:u}=i;u&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],u(this._map))}mergeHandlerResult(t,n,r,i,o){if(!r)return;e.l(t,r);const a={handlerName:i,originalEvent:r.originalEvent||o};void 0!==r.zoomDelta&&(n.zoom=a),void 0!==r.panDelta&&(n.drag=a),void 0!==r.pitchDelta&&(n.pitch=a),void 0!==r.bearingDelta&&(n.rotate=a)}_applyChanges(){const t={},n={},r={};for(const[i,o,a]of this._changes)i.panDelta&&(t.panDelta=(t.panDelta||new e.P(0,0))._add(i.panDelta)),i.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+i.zoomDelta),i.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+i.bearingDelta),i.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+i.pitchDelta),void 0!==i.around&&(t.around=i.around),void 0!==i.aroundCoord&&(t.aroundCoord=i.aroundCoord),void 0!==i.pinchAround&&(t.pinchAround=i.pinchAround),i.noInertia&&(t.noInertia=i.noInertia),e.l(n,o),e.l(r,a);this._updateMapTransform(t,n,r),this._changes=[]}_updateMapTransform(t,n,r){const i=this._map,o=i.transform,a=e=>[e.x,e.y,e.z];if((()=>{const e=this._eventsInProgress.drag;return e&&!this._handlersById[e.handlerName].isActive()})()&&!Es(t)){const e=o.zoom;o.cameraElevationReference="sea",null!=this._originalZoom&&o._orthographicProjectionAtLowPitch&&"globe"!==o.projection.name&&0===o.pitch?(o.cameraElevationReference="ground",o.zoom=this._originalZoom):(o.recenterOnTerrain(),o.cameraElevationReference="ground"),e!==o.zoom&&this._map._update(!0)}if(o._isCameraConstrained&&i._stop(!0),!Es(t))return void this._fireEvents(n,r,!0);let{panDelta:s,zoomDelta:l,bearingDelta:c,pitchDelta:u,around:h,aroundCoord:d,pinchAround:p}=t;o._isCameraConstrained&&(l>0&&(l=0),o._isCameraConstrained=!1),void 0!==p&&(h=p),(l||(e=>n[e]&&!this._eventsInProgress[e])("drag"))&&h&&(this._dragOrigin=a(o.pointCoordinate3D(h)),this._originalZoom=o.zoom,this._trackingEllipsoid.setup(o._camera.position,this._dragOrigin)),o.cameraElevationReference="sea",i._stop(!0),h=h||i.transform.centerPoint,c&&(o.bearing+=c),u&&(o.pitch+=u),o._updateCameraState();const f=[0,0,0];if(s)if("mercator"===o.projection.name){const e=this._trackingEllipsoid.projectRay(o.screenPointToMercatorRay(h).dir),t=this._trackingEllipsoid.projectRay(o.screenPointToMercatorRay(h.sub(s)).dir);f[0]=t[0]-e[0],f[1]=t[1]-e[1]}else{const t=o.pointCoordinate(h);if("globe"===o.projection.name){s=s.rotate(-o.angle);const n=o._pixelsPerMercatorPixel/o.worldSize;f[0]=-s.x*e.ds(e.aN(t.y))*n,f[1]=-s.y*e.ds(o.center.lat)*n}else{const e=o.pointCoordinate(h.sub(s));t&&e&&(f[0]=e.x-t.x,f[1]=e.y-t.y)}}const m=o.zoom,g=[0,0,0];if(l){const t=a(d||o.pointCoordinate3D(h)),n={dir:e.a6.vec3.normalize([],e.a6.vec3.sub([],t,o._camera.position))};if(n.dir[2]<0){const r=o.zoomDeltaToMovement(t,l);e.a6.vec3.scale(g,n.dir,r)}}const y=e.a6.vec3.add(f,f,g);o._translateCameraConstrained(y),l&&Math.abs(o.zoom-m)>1e-4&&o.recenterOnTerrain(),o.cameraElevationReference="ground",this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(n,r,!0)}_fireEvents(t,n,r){const i=ws(this._eventsInProgress),o=ws(t),a={};for(const e in t){const{originalEvent:n}=t[e];this._eventsInProgress[e]||(a["".concat(e,"start")]=n),this._eventsInProgress[e]=t[e]}!i&&o&&this._fireEvent("movestart",o.originalEvent);for(const e in a)this._fireEvent(e,a[e]);o&&this._fireEvent("move",o.originalEvent);for(const e in t){const{originalEvent:n}=t[e];this._fireEvent(e,n)}const s={};let l;for(const e in this._eventsInProgress){const{handlerName:t,originalEvent:r}=this._eventsInProgress[e];this._handlersById[t].isActive()||(delete this._eventsInProgress[e],l=n[t]||r,s["".concat(e,"end")]=l)}for(const e in s)this._fireEvent(e,s[e]);const c=ws(this._eventsInProgress);if(r&&(i||o)&&!c){this._updatingCamera=!0;const t=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),n=e=>0!==e&&-this._bearingSnap<e&&e<this._bearingSnap;t?(n(t.bearing||this._map.getBearing())&&(t.bearing=0),this._map.easeTo(t,{originalEvent:l})):(this._map.fire(new e.x("moveend",{originalEvent:l})),n(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(t,n){this._map.fire(new e.x(t,n?{originalEvent:n}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((e=>{this._frameId=void 0,this.handleEvent(new Ss("renderFrame",{timeStamp:e})),this._applyChanges()}))}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}const Ms="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Ps extends e.E{constructor(t,n){super(),this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=n.bearingSnap,this._respectPrefersReducedMotion=!1!==n.respectPrefersReducedMotion,e.aJ(["_renderFrameCallback"],this)}getCenter(){return new e.bL(this.transform.center.lng,this.transform.center.lat)}setCenter(e,t){return this.jumpTo({center:e},t)}panBy(t,n,r){return t=e.P.convert(t).mult(-1),this.panTo(this.transform.center,e.l({offset:t},n),r)}panTo(t,n,r){return this.easeTo(e.l({center:t},n),r)}getZoom(){return this.transform.zoom}setZoom(e,t){return this.jumpTo({zoom:e},t),this}zoomTo(t,n,r){return this.easeTo(e.l({zoom:t},n),r)}zoomIn(e,t){return this.zoomTo(this.getZoom()+1,e,t),this}zoomOut(e,t){return this.zoomTo(this.getZoom()-1,e,t),this}getBearing(){return this.transform.bearing}setBearing(e,t){return this.jumpTo({bearing:e},t),this}getPadding(){return this.transform.padding}setPadding(e,t){return this.jumpTo({padding:e},t),this}rotateTo(t,n,r){return this.easeTo(e.l({bearing:t},n),r)}resetNorth(t,n){return this.rotateTo(0,e.l({duration:1e3},t),n),this}resetNorthPitch(t,n){return this.easeTo(e.l({bearing:0,pitch:0,duration:1e3},t),n),this}snapToNorth(e,t){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,t):this}getPitch(){return this.transform.pitch}setPitch(e,t){return this.jumpTo({pitch:e},t),this}cameraForBounds(t,n){t=e.as.convert(t);const r=n&&n.bearing||0,i=n&&n.pitch||0,o=t.getNorthWest(),a=t.getSouthEast();return this._cameraForBounds(this.transform,o,a,r,i,n)}_extendPadding(t){const n={top:0,right:0,bottom:0,left:0};return null==t?e.l({},n,this.transform.padding):"number"==typeof t?{top:t,bottom:t,right:t,left:t}:e.l({},n,t)}_extendCameraOptions(t){return(t=e.l({offset:[0,0],maxZoom:this.transform.maxZoom},t)).padding=this._extendPadding(t.padding),t}_minimumAABBFrustumDistance(e,t){const n=t.max[0]-t.min[0],r=t.max[1]-t.min[1];return n/r>e.aspect?n/(2*Math.tan(.5*e.fovX)*e.aspect):r/(2*Math.tan(.5*e.fovY)*e.aspect)}_cameraForBoundsOnGlobe(t,n,r,i,o,a){const s=t.clone(),l=this._extendCameraOptions(a);s.bearing=i,s.pitch=o;const c=e.bL.convert(n),u=e.bL.convert(r),h=.5*(c.lat+u.lat),d=.5*(c.lng+u.lng),p=e.dt(h,d),f=e.a6.vec3.normalize([],p),m=e.a6.vec3.normalize([],e.a6.vec3.cross([],f,[0,1,0])),g=e.a6.vec3.cross([],m,f),y=[m[0],m[1],m[2],0,g[0],g[1],g[2],0,f[0],f[1],f[2],0,0,0,0,1],_=[p,e.dt(c.lat,c.lng),e.dt(u.lat,c.lng),e.dt(u.lat,u.lng),e.dt(c.lat,u.lng),e.dt(h,c.lng),e.dt(h,u.lng),e.dt(c.lat,d),e.dt(u.lat,d)];let v=e.ca.fromPoints(_.map((t=>[e.a6.vec3.dot(m,t),e.a6.vec3.dot(g,t),e.a6.vec3.dot(f,t)])));const x=e.a6.vec3.transformMat4([],v.center,y);0===e.a6.vec3.squaredLength(x)&&e.a6.vec3.set(x,0,0,1),e.a6.vec3.normalize(x,x),e.a6.vec3.scale(x,x,e.aq),s.center=e.du(x);const b=s.getWorldToCameraMatrix(),w=e.a6.mat4.invert(new Float64Array(16),b);v=e.ca.applyTransform(v,e.a6.mat4.multiply([],b,y));const S=this._extendAABB(v,s,l,i);if(!S)return void e.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");v=S,e.a6.vec3.transformMat4(x,x,b);const T=.5*(v.max[2]-v.min[2]),E=this._minimumAABBFrustumDistance(s,v),A=e.a6.vec3.scale([],[0,0,1],T),M=e.a6.vec3.add(A,x,A),P=E+(0===s.pitch?0:e.a6.vec3.distance(x,M)),k=s.globeCenterInViewSpace,C=e.a6.vec3.sub([],x,[k[0],k[1],k[2]]);e.a6.vec3.normalize(C,C),e.a6.vec3.scale(C,C,P);const j=e.a6.vec3.add([],x,C);e.a6.vec3.transformMat4(j,j,w);const I=e.dw/e.aq,O=e.a6.vec3.length(j),N=e.bE(Math.max(O*I-e.dw,Number.EPSILON),0),D=Math.min(s.zoomFromMercatorZAdjusted(N),l.maxZoom);return D>.5*(e.c3+e.bV)?(s.setProjection({name:"mercator"}),s.zoom=D,this._cameraForBounds(s,n,r,i,o,a)):{center:s.center,zoom:D,bearing:i,pitch:o}}_extendAABB(t,n,r,i){const o=.5*((r.padding.left||0)+(r.padding.right||0)),a=.5*((r.padding.top||0)+(r.padding.bottom||0)),s=a,l=o,c=o,u=a,h=n.width-(l+c),d=n.height-(s+u),p=e.a6.vec3.sub([],t.max,t.min),f=Math.min(h/p[0],d/p[1]),m=Math.min(n.scaleZoom(n.scale*f),r.maxZoom);if(isNaN(m))return null;const g=n.scale/n.zoomScale(m),y=new e.ca([t.min[0]-l*g,t.min[1]-u*g,t.min[2]],[t.max[0]+c*g,t.max[1]+s*g,t.max[2]]),_=("number"==typeof r.offset.x&&"number"==typeof r.offset.y?new e.P(r.offset.x,r.offset.y):e.P.convert(r.offset)).rotate(-e.bC(i));return y.center[0]-=_.x*g,y.center[1]+=_.y*g,y}queryTerrainElevation(t,n){const r=this.transform.elevation;return r?(n=e.l({},{exaggerated:!0},n),r.getAtPoint(e.a5.fromLngLat(t),null,n.exaggerated)):null}_cameraForBounds(t,n,r,i,o,a){if("globe"===t.projection.name)return this._cameraForBoundsOnGlobe(t,n,r,i,o,a);const s=t.clone(),l=this._extendCameraOptions(a);s.bearing=i,s.pitch=o;const c=e.bL.convert(n),u=e.bL.convert(r),h=new e.bL(c.lng,u.lat),d=new e.bL(u.lng,c.lat),p=s.project(c),f=s.project(u),m=this.queryTerrainElevation(c),g=this.queryTerrainElevation(u),y=this.queryTerrainElevation(h),_=this.queryTerrainElevation(d),v=[[p.x,p.y,Math.min(m||0,g||0,y||0,_||0)],[f.x,f.y,Math.max(m||0,g||0,y||0,_||0)]];let x=e.ca.fromPoints(v);const b=s.getWorldToCameraMatrix(),w=e.a6.mat4.invert(new Float64Array(16),b);x=e.ca.applyTransform(x,b);const S=this._extendAABB(x,s,l,i);if(!S)return void e.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");x=S;const T=.5*e.a6.vec3.sub([],x.max,x.min)[2],E=this._minimumAABBFrustumDistance(s,x),A=[0,0,1,0];e.a6.vec4.transformMat4(A,A,b),e.a6.vec4.normalize(A,A);const M=e.a6.vec3.scale([],A,E+T),P=e.a6.vec3.add([],x.center,M);e.a6.vec3.transformMat4(x.center,x.center,w),e.a6.vec3.transformMat4(P,P,w);const k=s.unproject(new e.P(x.center[0],x.center[1])),C=e.dv(s.projection,k),j=Math.pow(2,C),I=Math.min(s._zoomFromMercatorZ(P[2]*s.pixelsPerMeter*j/s.worldSize),l.maxZoom);return s.mercatorFromTransition&&I<.5*(e.c3+e.bV)?(s.setProjection({name:"globe"}),s.zoom=I,this._cameraForBounds(s,n,r,i,o,a)):{center:k,zoom:I,bearing:i,pitch:o}}fitBounds(e,t,n){const r=this.cameraForBounds(e,t);return this._fitInternal(r,t,n)}fitScreenCoordinates(t,n,r,i,o){const a=e.P.convert(t),s=e.P.convert(n),l=new e.P(Math.min(a.x,s.x),Math.min(a.y,s.y)),c=new e.P(Math.max(a.x,s.x),Math.max(a.y,s.y));if("mercator"===this.transform.projection.name&&this.transform.anyCornerOffEdge(a,s))return this;const u=this.transform.pointLocation3D(l),h=this.transform.pointLocation3D(c),d=this.transform.pointLocation3D(new e.P(l.x,c.y)),p=this.transform.pointLocation3D(new e.P(c.x,l.y)),f=[Math.min(u.lng,h.lng,d.lng,p.lng),Math.min(u.lat,h.lat,d.lat,p.lat)],m=[Math.max(u.lng,h.lng,d.lng,p.lng),Math.max(u.lat,h.lat,d.lat,p.lat)],g=i&&i.pitch?i.pitch:this.getPitch(),y=this._cameraForBounds(this.transform,f,m,r,g,i);return this._fitInternal(y,i,o)}_fitInternal(t,n,r){return t?(n=e.l(t,n)).linear?this.easeTo(n,r):this.flyTo(n,r):this}jumpTo(t,n){this.stop();const r=t.preloadOnly?this.transform.clone():this.transform;let i=!1,o=!1,a=!1;"zoom"in t&&r.zoom!==+t.zoom&&(i=!0,r.zoom=+t.zoom),void 0!==t.center&&(r.center=e.bL.convert(t.center)),"bearing"in t&&r.bearing!==+t.bearing&&(o=!0,r.bearing=+t.bearing),"pitch"in t&&r.pitch!==+t.pitch&&(a=!0,r.pitch=+t.pitch);const s="number"==typeof t.padding?this._extendPadding(t.padding):t.padding;if(null!=t.padding&&!r.isPaddingEqual(s))if(!1===t.retainPadding){const e=r.clone();e.padding=s,r.setLocationAtPoint(r.center,e.centerPoint)}else r.padding=s;return t.preloadOnly?(this._preloadTiles(r),this):(this.fire(new e.x("movestart",n)).fire(new e.x("move",n)),i&&this.fire(new e.x("zoomstart",n)).fire(new e.x("zoom",n)).fire(new e.x("zoomend",n)),o&&this.fire(new e.x("rotatestart",n)).fire(new e.x("rotate",n)).fire(new e.x("rotateend",n)),a&&this.fire(new e.x("pitchstart",n)).fire(new e.x("pitch",n)).fire(new e.x("pitchend",n)),this.fire(new e.x("moveend",n)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||e.w(Ms),this.transform.getFreeCameraOptions()}setFreeCameraOptions(t,n){const r=this.transform;if(!r.projection.supportsFreeCamera)return e.w(Ms),this;this.stop();const i=r.zoom,o=r.pitch,a=r.bearing;r.setFreeCameraOptions(t);const s=i!==r.zoom,l=o!==r.pitch,c=a!==r.bearing;return this.fire(new e.x("movestart",n)).fire(new e.x("move",n)),s&&this.fire(new e.x("zoomstart",n)).fire(new e.x("zoom",n)).fire(new e.x("zoomend",n)),c&&this.fire(new e.x("rotatestart",n)).fire(new e.x("rotate",n)).fire(new e.x("rotateend",n)),l&&this.fire(new e.x("pitchstart",n)).fire(new e.x("pitch",n)).fire(new e.x("pitchend",n)),this.fire(new e.x("moveend",n)),this}easeTo(t,n){this._stop(!1,t.easeId),(!1===(t=e.l({offset:[0,0],duration:500,easing:e.dr},t)).animate||this._prefersReducedMotion(t))&&(t.duration=0);const r=this.transform,i=this.getZoom(),o=this.getBearing(),a=this.getPitch(),s=this.getPadding(),l="zoom"in t?+t.zoom:i,c="bearing"in t?this._normalizeBearing(t.bearing,o):o,u="pitch"in t?+t.pitch:a,h=this._extendPadding(t.padding),d=e.P.convert(t.offset);let p,f,m;if("globe"===r.projection.name){const n=e.a5.fromLngLat(r.center),i=d.rotate(-r.angle);n.x+=i.x/r.worldSize,n.y+=i.y/r.worldSize;const o=n.toLngLat(),a=e.bL.convert(t.center||o);this._normalizeCenter(a),p=r.centerPoint.add(i),f=new e.P(n.x,n.y).mult(r.worldSize),m=new e.P(e.am(a.lng),e.at(a.lat)).mult(r.worldSize).sub(f)}else{p=r.centerPoint.add(d);const n=r.pointLocation(p),i=e.bL.convert(t.center||n);this._normalizeCenter(i),f=r.project(n),m=r.project(i).sub(f)}const g=r.zoomScale(l-i);let y,_;t.around&&(y=e.bL.convert(t.around),_=r.locationPoint(y));const v=this._zooming||l!==i,x=this._rotating||o!==c,b=this._pitching||u!==a,w=!r.isPaddingEqual(h),S=!1===t.retainPadding?r.clone():r,T=r=>T=>{if(v&&(r.zoom=e.aa(i,l,T)),x&&(r.bearing=e.aa(o,c,T)),b&&(r.pitch=e.aa(a,u,T)),w&&(S.interpolatePadding(s,h,T),p=S.centerPoint.add(d)),y)r.setLocationAtPoint(y,_);else{const e=r.zoomScale(r.zoom-i),t=l>i?Math.min(2,g):Math.max(.5,g),n=Math.pow(t,1-T),o=r.unproject(f.add(m.mult(T*n)).mult(e));r.setLocationAtPoint(r.renderWorldCopies?o.wrap():o,p)}return t.preloadOnly||this._fireMoveEvents(n),r};if(t.preloadOnly){const e=this._emulate(T,t.duration,r);return this._preloadTiles(e),this}const E={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=v,this._rotating=x,this._pitching=b,this._padding=w,this._easeId=t.easeId,this._prepareEase(n,t.noMoveStart,E),this._ease(T(r),(e=>{"sea"===r.cameraElevationReference&&r.recenterOnTerrain(),this._afterEase(n,e)}),t),this}_prepareEase(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&0===this.transform.pitch&&"globe"!==this.transform.projection.name&&(this.transform.cameraElevationReference="ground"),n||r.moving||this.fire(new e.x("movestart",t)),this._zooming&&!r.zooming&&this.fire(new e.x("zoomstart",t)),this._rotating&&!r.rotating&&this.fire(new e.x("rotatestart",t)),this._pitching&&!r.pitching&&this.fire(new e.x("pitchstart",t))}_fireMoveEvents(t){this.fire(new e.x("move",t)),this._zooming&&this.fire(new e.x("zoom",t)),this._rotating&&this.fire(new e.x("rotate",t)),this._pitching&&this.fire(new e.x("pitch",t))}_afterEase(t,n){if(this._easeId&&n&&this._easeId===n)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const r=this._zooming,i=this._rotating,o=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,r&&this.fire(new e.x("zoomend",t)),i&&this.fire(new e.x("rotateend",t)),o&&this.fire(new e.x("pitchend",t)),this.fire(new e.x("moveend",t))}flyTo(t,n){if(this._prefersReducedMotion(t)){const r=e.ar(t,["center","zoom","bearing","pitch","around","padding","retainPadding"]);return this.jumpTo(r,n)}this.stop(),t=e.l({offset:[0,0],speed:1.2,curve:1.42,easing:e.dr},t);const r=this.transform,i=this.getZoom(),o=this.getBearing(),a=this.getPitch(),s=this.getPadding(),l="zoom"in t?e.ap(+t.zoom,r.minZoom,r.maxZoom):i,c="bearing"in t?this._normalizeBearing(t.bearing,o):o,u="pitch"in t?+t.pitch:a,h=this._extendPadding(t.padding),d=r.zoomScale(l-i),p=e.P.convert(t.offset);let f=r.centerPoint.add(p);const m=r.pointLocation(f),g=e.bL.convert(t.center||m);this._normalizeCenter(g);const y=r.project(m),_=r.project(g).sub(y);let v=t.curve;const x=Math.max(r.width,r.height),b=x/d,w=_.mag();if("minZoom"in t){const n=e.ap(Math.min(t.minZoom,i,l),r.minZoom,r.maxZoom),o=x/r.zoomScale(n-i);v=Math.sqrt(o/w*2)}const S=v*v;function T(e){const t=(b*b-x*x+(e?-1:1)*S*S*w*w)/(2*(e?b:x)*S*w);return Math.log(Math.sqrt(t*t+1)-t)}function E(e){return(Math.exp(e)-Math.exp(-e))/2}function A(e){return(Math.exp(e)+Math.exp(-e))/2}const M=T(0);let P=function(e){return A(M)/A(M+v*e)},k=function(e){return x*((A(M)*(E(t=M+v*e)/A(t))-E(M))/S)/w;var t},C=(T(1)-M)/v;if(Math.abs(w)<1e-6||!isFinite(C)){if(Math.abs(x-b)<1e-6)return this.easeTo(t,n);const e=b<x?-1:1;C=Math.abs(Math.log(b/x))/v,k=function(){return 0},P=function(t){return Math.exp(e*v*t)}}t.duration="duration"in t?+t.duration:1e3*C/("screenSpeed"in t?+t.screenSpeed/v:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0);const j=o!==c,I=u!==a,O=!r.isPaddingEqual(h),N=!1===t.retainPadding?r.clone():r,D=r=>d=>{const m=d*C,v=1/P(m);r.zoom=1===d?l:i+r.scaleZoom(v),j&&(r.bearing=e.aa(o,c,d)),I&&(r.pitch=e.aa(a,u,d)),O&&(N.interpolatePadding(s,h,d),f=N.centerPoint.add(p));const x=1===d?g:r.unproject(y.add(_.mult(k(m))).mult(v));return r.setLocationAtPoint(r.renderWorldCopies?x.wrap():x,f),r._updateCameraOnTerrain(),t.preloadOnly||this._fireMoveEvents(n),r};if(t.preloadOnly){const e=this._emulate(D,t.duration,r);return this._preloadTiles(e),this}return this._zooming=!0,this._rotating=j,this._pitching=I,this._padding=O,this._prepareEase(n,!1),this._ease(D(r),(()=>this._afterEase(n)),t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(e){}_cancelRenderFrame(e){}_stop(e,t){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const e=this._onEaseEnd;this._onEaseEnd=void 0,e.call(this,t)}if(!e){const e=this.handlers;e&&e.stop(!1)}return this}_ease(t,n,r){!1===r.animate||0===r.duration?(t(1),n()):(this._easeStart=e.q.now(),this._easeOptions=r,this._onEaseFrame=t,this._onEaseEnd=n,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const t=Math.min((e.q.now()-this._easeStart)/this._easeOptions.duration,1),n=this._onEaseFrame;n&&n(this._easeOptions.easing(t)),t<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(t,n){t=e.bB(t,-180,180);const r=Math.abs(t-n);return Math.abs(t-360-n)<r&&(t-=360),Math.abs(t+360-n)<r&&(t+=360),t}_normalizeCenter(e){const t=this.transform;if(t.maxBounds)return;if("globe"!==t.projection.name&&!t.renderWorldCopies)return;const n=e.lng-t.center.lng;e.lng+=n>180?-360:n<-180?360:0}_prefersReducedMotion(t){return this._respectPrefersReducedMotion&&e.q.prefersReducedMotion&&!(t&&t.essential)}_emulate(e,t,n){const r=Math.ceil(15*t/1e3),i=[],o=e(n.clone());for(let a=0;a<=r;a++){const e=o(a/r);i.push(e.clone())}return i}_preloadTiles(e,t){}}class ks{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options=t,e.aJ(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(e){const t=this.options&&this.options.compact,n=e._getUIString("AttributionControl.ToggleAttribution");this._map=e,this._container=d("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=d("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.setAttribute("aria-label",n);const r=d("span","mapboxgl-ctrl-icon",this._compactButton);return r.setAttribute("aria-hidden","true"),r.setAttribute("title",n),this._innerContainer=d("div","mapboxgl-ctrl-attrib-inner",this._container),t&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===t&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let t=this._editLink;t||(t=this._editLink=this._container.querySelector(".mapbox-improve-map"));const n=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||e.e.ACCESS_TOKEN}];if(t){const r=n.reduce(((e,t,r)=>(t.value&&(e+="".concat(t.key,"=").concat(t.value).concat(r<n.length-1?"&":"")),e)),"?");t.href="".concat(e.e.FEEDBACK_URL,"/").concat(r,"#").concat(ja(this._map,!0)),t.rel="noopener nofollow"}}_updateData(e){!e||"metadata"!==e.sourceDataType&&"visibility"!==e.sourceDataType&&"style"!==e.dataType||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let e=[];if(this._map.style.stylesheet){const e=this._map.style.stylesheet;this.styleOwner=e.owner,this.styleId=e.id}const t=this._map.style._mergedSourceCaches;for(const r in t){const n=t[r];if(n.used){const t=n.getSource();t.attribution&&e.indexOf(t.attribution)<0&&e.push(t.attribution)}}e.sort(((e,t)=>e.length-t.length)),e=e.filter(((t,n)=>{for(let r=n+1;r<e.length;r++)if(e[r].indexOf(t)>=0)return!1;return!0})),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=[...this.options.customAttribution,...e]:e.unshift(this.options.customAttribution));const n=e.join(" | ");n!==this._attribHTML&&(this._attribHTML=n,e.length?(this._innerContainer.innerHTML=n,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Cs{constructor(){e.aJ(["_updateLogo","_updateCompact"],this)}onAdd(e){this._map=e,this._container=d("div","mapboxgl-ctrl");const t=d("a","mapboxgl-ctrl-logo");return t.target="_blank",t.rel="noopener nofollow",t.href="https://www.mapbox.com/",t.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),t.setAttribute("rel","noopener nofollow"),this._container.appendChild(t),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(e){e&&"metadata"!==e.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const e=this._map.style._sourceCaches;if(0===Object.entries(e).length)return!0;for(const t in e){const n=e[t].getSource();if(n.hasOwnProperty("mapbox_logo")&&!n.mapbox_logo)return!1}return!0}_updateCompact(){const e=this._container.children;if(e.length){const t=e[0];this._map.getCanvasContainer().offsetWidth<250?t.classList.add("mapboxgl-compact"):t.classList.remove("mapboxgl-compact")}}}class js{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){const t=++this._id;return this._queue.push({callback:e,id:t,cancelled:!1}),t}remove(e){const t=this._currentlyRunning,n=t?this._queue.concat(t):this._queue;for(const r of n)if(r.id===e)return void(r.cancelled=!0)}run(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;const t=this._currentlyRunning=this._queue;this._queue=[];for(const n of t)if(!n.cancelled&&(n.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}class Is{constructor(e){this.jumpTo(e)}getValue(t){if(t<=this._startTime)return this._start;if(t>=this._endTime)return this._end;const n=e.cw((t-this._startTime)/(this._endTime-this._startTime));return this._start*(1-n)+this._end*n}isEasing(e){return e>=this._startTime&&e<=this._endTime}jumpTo(e){this._startTime=-1/0,this._endTime=-1/0,this._start=e,this._end=e}easeTo(e,t,n){this._start=this.getValue(t),this._end=e,this._startTime=t,this._endTime=t+n}}const Os={"AttributionControl.ToggleAttribution":"Toggle attribution","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox homepage","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},Ns=["mouseenter","mouseover","mouseleave","mouseout"];class Ds extends e.x{constructor(e,t,n,r){const{point:i,lngLat:o,originalEvent:a,target:s}=e;super(e.type,{point:i,lngLat:o,originalEvent:a,target:s}),this.preventDefault=()=>{e.preventDefault()},this.id=t,this.interaction=n,this.feature=r}}class Ls{constructor(e){this.map=e,this.interactionsByType=new Map,this.typeById=new Map,this.filters=new Map,this.handleType=this.handleType.bind(this)}add(t,n){if(this.typeById.has(t))throw new Error('Interaction id "'.concat(t,'" already exists.'));const{type:r,filter:i}=n;if(i){const n=e.M(i,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===n.result)throw new Error(n.value.map((e=>"".concat(e.key,": ").concat(e.message))).join(", "));this.filters.set(t,n.value)}const o=this.interactionsByType.get(r)||new Map;0===o.size&&(Ns.includes(r)?this.map.on(r,n.featureset,this.handleType):this.map.on(r,this.handleType),this.interactionsByType.set(r,o)),o.set(t,n),this.typeById.set(t,r)}remove(e){const t=this.typeById.get(e);if(!t)return;this.typeById.delete(e),this.filters.delete(e);const n=this.interactionsByType.get(t);n&&(n.delete(e),0===n.size&&this.map.off(t,this.handleType))}handleType(t){const n=this.interactionsByType.get(t.type),r=Array.from(n).reverse(),i=[];for(const[,e]of r)e.featureset&&i.push({featureset:e.featureset,filter:e.filter,radius:e.radius});let o=this.map.style.queryRenderedFeaturesForInteractions(t.point,i,this.map.transform);!o.length&&Ns.includes(t.type)&&(o=[null]);let a=!1;for(const s of o){for(const[n,i]of r){const{handler:r,featureset:o}=i;if(o&&(null==s||e.bi(s.featureset,o))&&!1!==r(new Ds(t,n,i,s))){a=!0;break}}if(a)break}if(!a)for(const[e,s]of r){const{handler:n,featureset:r}=s;if(!r&&!1!==n(new Ds(t,e,s,null)))break}}}function zs(t,n){if(Array.isArray(t)&&Array.isArray(n)){const e=new Set(t),r=new Set(n);return e.size===r.size&&t.every((e=>r.has(e)))}return e.bi(t,n)}const Rs={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1,precompilePrograms:!0,scaleFactor:1},Fs={showCompass:!0,showZoom:!0,visualizePitch:!1};class Bs{constructor(t,n){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this._clickTolerance=10,this.element=n,this.mouseRotate=new $a({clickTolerance:t.dragRotate._mouseRotate._clickTolerance}),this.map=t,r&&(this.mousePitch=new es({clickTolerance:t.dragRotate._mousePitch._clickTolerance})),e.aJ(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),n.addEventListener("mousedown",this.mousedown),n.addEventListener("touchstart",this.touchstart,{passive:!1}),n.addEventListener("touchmove",this.touchmove),n.addEventListener("touchend",this.touchend),n.addEventListener("touchcancel",this.reset)}down(e,t){this.mouseRotate.mousedown(e,t),this.mousePitch&&this.mousePitch.mousedown(e,t),y()}move(e,t){const n=this.map,r=this.mouseRotate.mousemoveWindow(e,t),i=r&&r.bearingDelta;if(i&&n.setBearing(n.getBearing()+i),this.mousePitch){const r=this.mousePitch.mousemoveWindow(e,t),i=r&&r.pitchDelta;i&&n.setPitch(n.getPitch()+i)}}off(){const e=this.element;e.removeEventListener("mousedown",this.mousedown),e.removeEventListener("touchstart",this.touchstart,{passive:!1}),e.removeEventListener("touchmove",this.touchmove),e.removeEventListener("touchend",this.touchend),e.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){_(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(t){this.down(e.l({},t,{ctrlKey:!0,preventDefault:()=>t.preventDefault()}),b(this.element,t)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(e){this.move(e,b(this.element,e))}mouseup(e){this.mouseRotate.mouseupWindow(e),this.mousePitch&&this.mousePitch.mouseupWindow(e),this.offTemp()}touchstart(e){1!==e.targetTouches.length?this.reset():(this._startPos=this._lastPos=w(this.element,e.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>e.preventDefault()},this._startPos))}touchmove(e){1!==e.targetTouches.length?this.reset():(this._lastPos=w(this.element,e.targetTouches)[0],this.move({preventDefault:()=>e.preventDefault()},this._lastPos))}touchend(e){0===e.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function Vs(t,n,r){if(t=new e.bL(t.lng,t.lat),n){const i=new e.bL(t.lng-360,t.lat),o=new e.bL(t.lng+360,t.lat),a=360*Math.ceil(Math.abs(t.lng-r.center.lng)/360),s=r.locationPoint(t).distSqr(n),l=n.x<0||n.y<0||n.x>r.width||n.y>r.height;r.locationPoint(i).distSqr(n)<s&&(l||Math.abs(i.lng-r.center.lng)<a)?t=i:r.locationPoint(o).distSqr(n)<s&&(l||Math.abs(o.lng-r.center.lng)<a)&&(t=o)}for(;Math.abs(t.lng-r.center.lng)>180;){const e=r.locationPoint(t);if(e.x>=0&&e.y>=0&&e.x<=r.width&&e.y<=r.height)break;t.lng>r.center.lng?t.lng-=360:t.lng+=360}return t}const Us={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Gs extends e.E{constructor(t,n){if(super(),(t instanceof HTMLElement||n)&&(t=e.l({element:t},n)),e.aJ(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&t.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=t&&t.occludedOpacity||.2,t&&t.element)this._element=t.element,this._offset=e.P.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=d("div");const n=41,r=27,i=p("svg",{display:"block",height:n*this._scale+"px",width:r*this._scale+"px",viewBox:"0 0 ".concat(r," ").concat(n)},this._element),o=p("radialGradient",{id:"shadowGradient"},p("defs",{},i));p("stop",{offset:"10%","stop-opacity":.4},o),p("stop",{offset:"100%","stop-opacity":.05},o),p("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},i),p("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},i),p("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},i),p("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},i),this._offset=e.P.convert(t&&t.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",(e=>{e.preventDefault()})),this._element.addEventListener("mousedown",(e=>{e.preventDefault()}));const r=this._element.classList;for(const e in Us)r.remove("mapboxgl-marker-anchor-".concat(e));r.add("mapboxgl-marker-anchor-".concat(this._anchor));const i=t&&t.className?t.className.trim().split(/\s+/):[];r.add(...i),this._popup=null}addTo(e){return e===this._map||(this.remove(),this._map=e,e.getCanvasContainer().appendChild(this._element),e.on("move",this._updateMoving),e.on("moveend",this._update),e.on("remove",this._clearFadeTimer),e._addMarker(this),this.setDraggable(this._draggable),this._update(),e.on("click",this._onMapClick)),this}remove(){const e=this._map;return e&&(e.off("click",this._onMapClick),e.off("move",this._updateMoving),e.off("moveend",this._update),e.off("mousedown",this._addDragHandler),e.off("touchstart",this._addDragHandler),e.off("mouseup",this._onUp),e.off("touchend",this._onUp),e.off("mousemove",this._onMove),e.off("touchmove",this._onMove),e.off("remove",this._clearFadeTimer),e._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=e.bL.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){const t=38.1,n=13.5,r=Math.sqrt(Math.pow(n,2)/2);e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-t],"bottom-left":[r,-1*(t-n+r)],"bottom-right":[-r,-1*(t-n+r)],left:[n,-1*(t-n)],right:[-n,-1*(t-n)]}:this._offset}this._popup=e,e._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(e){const t=e.code,n=e.charCode||e.keyCode;"Space"!==t&&"Enter"!==t&&32!==n&&13!==n||this.togglePopup()}_onMapClick(e){const t=e.originalEvent.target,n=this._element;this._popup&&(t===n||n.contains(t))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const e=this._popup;return e?(e.isOpen()?(e.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(e.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const e=this._map,t=this._pos;if(!e||!t)return!1;const n=e.unproject(t),r=e.getFreeCameraOptions();if(!r.position)return!1;const i=r.position.toLngLat();return i.distanceTo(n)<.9*i.distanceTo(this._lngLat)}_evaluateOpacity(){const t=this._map;if(!t)return;const n=this._pos;if(!n||n.x<0||n.x>t.transform.width||n.y<0||n.y>t.transform.height)return void this._clearFadeTimer();const r=t.unproject(n);let i;t._showingGlobe()&&e.dz(t.transform,this._lngLat)?i=0:(i=1-t._queryFogOpacity(r),t.transform._terrainEnabled()&&t.getTerrain()&&this._behindTerrain()&&(i*=this._occludedOpacity)),this._element.style.opacity="".concat(i),this._element.style.pointerEvents=i>0?"auto":"none",this._popup&&this._popup._setOpacity(i),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const e=this._pos;if(!e||!this._map)return;const t=this._offset.mult(this._scale);this._element.style.transform="\n            translate(".concat(e.x,"px,").concat(e.y,"px)\n            ").concat(Us[this._anchor],"\n            ").concat(this._calculateXYTransform()," ").concat(this._calculateZTransform(),"\n            translate(").concat(t.x,"px,").concat(t.y,"px)\n        ")}_calculateXYTransform(){const t=this._pos,n=this._map,r=this.getPitchAlignment();if(!n||!t||"map"!==r)return"";if(!n._showingGlobe()){const e=n.getPitch();return e?"rotateX(".concat(e,"deg)"):""}const i=e.c1(e.dA(n.transform,this._lngLat)),o=t.sub(e.dB(n.transform)),a=Math.abs(o.x)+Math.abs(o.y);if(0===a)return"";const s=i/a;return"rotateX(".concat(-o.y*s,"deg) rotateY(").concat(o.x*s,"deg)")}_calculateZTransform(){const t=this._pos,n=this._map;if(!n||!t)return"";let r=0;const i=this.getRotationAlignment();if("map"===i)if(n._showingGlobe()){const t=n.project(new e.bL(this._lngLat.lng,this._lngLat.lat+.001)),i=n.project(new e.bL(this._lngLat.lng,this._lngLat.lat-.001)).sub(t);r=e.c1(Math.atan2(i.y,i.x))-90}else r=-n.getBearing();else if("horizon"===i){const i=e.a7(4,6,n.getZoom()),o=e.dB(n.transform);o.y+=i*n.transform.height;const a=t.sub(o),s=e.c1(Math.atan2(a.y,a.x));r=(s>90?s-270:s+90)*(1-i)}return r+=this._rotation,r?"rotateZ(".concat(r,"deg)"):""}_update(e){cancelAnimationFrame(this._updateFrameId);const t=this._map;t&&(t.transform.renderWorldCopies&&(this._lngLat=Vs(this._lngLat,this._pos,t.transform)),this._pos=t.project(this._lngLat),!0===e?this._updateFrameId=requestAnimationFrame((()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())})):this._pos=this._pos.round(),t._requestDomTask((()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(t._showingGlobe()||t.getTerrain()||t.getFog())&&!this._fadeTimer&&(this._fadeTimer=window.setTimeout(this._evaluateOpacity.bind(this),60)))})))}getOffset(){return this._offset}setOffset(t){return this._offset=e.P.convert(t),this._update(),this}addClassName(e){return this._element.classList.add(e),this}removeClassName(e){return this._element.classList.remove(e),this}toggleClassName(e){return this._element.classList.toggle(e)}_onMove(t){const n=this._map;if(!n)return;const r=this._pointerdownPos,i=this._positionDelta;if(r&&i){if(!this._isDragging){const e=this._clickTolerance||n._clickTolerance;if(t.point.dist(r)<e)return;this._isDragging=!0}this._pos=t.point.sub(i),this._lngLat=n.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new e.x("dragstart"))),this.fire(new e.x("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const t=this._map;t&&(t.off("mousemove",this._onMove),t.off("touchmove",this._onMove)),"active"===this._state&&this.fire(new e.x("dragend")),this._state="inactive"}_addDragHandler(e){const t=this._map,n=this._pos;t&&n&&this._element.contains(e.originalEvent.target)&&(e.preventDefault(),this._positionDelta=e.point.sub(n),this._pointerdownPos=e.point,this._state="pending",t.on("mousemove",this._onMove),t.on("touchmove",this._onMove),t.once("mouseup",this._onUp),t.once("touchend",this._onUp))}setDraggable(e){this._draggable=!!e;const t=this._map;return t&&(e?(t.on("mousedown",this._addDragHandler),t.on("touchstart",this._addDragHandler)):(t.off("mousedown",this._addDragHandler),t.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return"auto"===this._rotationAlignment||"horizon"===this._rotationAlignment&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e||"auto",this._update(),this}getPitchAlignment(){return"auto"===this._pitchAlignment?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(e){return this._occludedOpacity=e||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Hs={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Zs={maxWidth:100,unit:"metric"},qs={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},Ws={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Xs=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Ys(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new e.P(0,0),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"bottom";if("number"==typeof t){const r=Math.round(Math.sqrt(.5*Math.pow(t,2)));switch(n){case"top":return new e.P(0,t);case"top-left":return new e.P(r,r);case"top-right":return new e.P(-r,r);case"bottom":return new e.P(0,-t);case"bottom-left":return new e.P(r,-r);case"bottom-right":return new e.P(-r,-r);case"left":return new e.P(t,0);case"right":return new e.P(-t,0)}return new e.P(0,0)}return t instanceof e.P||Array.isArray(t)?e.P.convert(t):e.P.convert(t[n]||[0,0])}const Ks={version:t,supported:h.supported,setRTLTextPlugin:e.dC,getRTLTextPluginStatus:e.dD,Map:class extends Ps{constructor(t){s.mark(n.create);const r=t;if(null!=(t=e.l({},Rs,t)).minZoom&&null!=t.maxZoom&&t.minZoom>t.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=t.minPitch&&null!=t.maxPitch&&t.minPitch>t.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=t.minPitch&&t.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=t.maxPitch&&t.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(t.antialias&&e.dx(window)&&(t.antialias=!1,e.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Kn(t.minZoom,t.maxZoom,t.minPitch,t.maxPitch,t.renderWorldCopies),t),this._repaint=!!t.repaint,this._interactive=t.interactive,this._minTileCacheSize=t.minTileCacheSize,this._maxTileCacheSize=t.maxTileCacheSize,this._failIfMajorPerformanceCaveat=t.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=t.preserveDrawingBuffer,this._antialias=t.antialias,this._trackResize=t.trackResize,this._bearingSnap=t.bearingSnap,this._refreshExpiredTiles=t.refreshExpiredTiles,this._fadeDuration=t.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=t.crossSourceCollisions,this._collectResourceTiming=t.collectResourceTiming,this._language=this._parseLanguage(t.language),this._worldview=t.worldview,this._renderTaskQueue=new js,this._domRenderTaskQueue=new js,this._controls=[],this._markers=[],this._popups=[],this._mapId=e.aQ(),this._locale=e.l({},Os,t.locale),this._clickTolerance=t.clickTolerance,this._cooperativeGestures=t.cooperativeGestures,this._performanceMetricsCollection=t.performanceMetricsCollection,this._tessellationStep=t.tessellationStep,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._precompilePrograms=t.precompilePrograms,this._scaleFactorChanged=!1,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Is(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._frameId=0,this._scaleFactor=t.scaleFactor,this._requestManager=new M(t.transformRequest,t.accessToken,t.testMode),this._silenceAuthErrors=!!t.testMode,this._contextCreateOptions=t.contextCreateOptions?i({},t.contextCreateOptions):{},"string"==typeof t.container){const e=document.getElementById(t.container);if(!e)throw new Error("Container '".concat(t.container.toString(),"' not found."));this._container=e}else{if(!(t.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=t.container}if(this._container.childNodes.length>0&&e.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),t.maxBounds&&this.setMaxBounds(t.maxBounds),e.aJ(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._tp||(this._tp=new Ea),this._tp.registerParameter(this,["Debug"],"showOverdrawInspector"),this._tp.registerParameter(this,["Debug"],"showTileBoundaries"),this._tp.registerParameter(this,["Debug"],"showParseStatus"),this._tp.registerParameter(this,["Debug"],"repaint"),this._tp.registerParameter(this,["Debug"],"showTileAABBs"),this._tp.registerParameter(this,["Debug"],"showPadding"),this._tp.registerParameter(this,["Debug"],"showCollisionBoxes",{noSave:!0}),this._tp.registerParameter(this.transform,["Debug"],"freezeTileCoverage",{noSave:!0},(()=>{this._update()})),this._tp.registerParameter(this,["Debug","Wireframe"],"showTerrainWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers2DWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers3DWireframe"),this._tp.registerParameter(this,["Scaling"],"_scaleFactor",{min:.1,max:10,step:.1},(()=>{this.setScaleFactor(this._scaleFactor)})),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");if(this.on("move",(()=>this._update(!1))),this.on("moveend",(()=>this._update(!1))),this.on("zoom",(()=>this._update(!0))),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new As(this,t),this._localFontFamily=t.localFontFamily,this._localIdeographFontFamily=t.localIdeographFontFamily,(t.style||!t.testMode)&&this.setStyle(t.style||e.e.DEFAULT_STYLE,{config:t.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),t.projection&&this.setProjection(t.projection),t.hash&&(this._hash=new Ca("string"==typeof t.hash&&t.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){null==r.center&&null==r.zoom||(this.transform._unmodified=!1),this.jumpTo({center:t.center,zoom:t.zoom,bearing:t.bearing,pitch:t.pitch});const n=t.bounds;n&&(this.resize(),this.fitBounds(n,e.l({},t.fitBoundsOptions,{duration:0})))}this.resize(),t.attributionControl&&this.addControl(new ks({customAttribution:t.customAttribution})),this._logoControl=new Cs,this.addControl(this._logoControl,t.logoPosition),this.on("style.load",(()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent()})),this.on("data",(t=>{this._update("style"===t.dataType),this.fire(new e.x("".concat(t.dataType,"data"),t))})),this.on("dataloading",(t=>{this.fire(new e.x("".concat(t.dataType,"dataloading"),t))})),this._interactions=new Ls(this)}_getMapId(){return this._mapId}addControl(t,n){if(void 0===n&&(n=t.getDefaultPosition?t.getDefaultPosition():"top-right"),!t||!t.onAdd)return this.fire(new e.t(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const r=t.onAdd(this);this._controls.push(t);const i=this._controlPositions[n];return-1!==n.indexOf("bottom")?i.insertBefore(r,i.firstChild):i.appendChild(r),this}removeControl(t){if(!t||!t.onRemove)return this.fire(new e.t(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const n=this._controls.indexOf(t);return n>-1&&this._controls.splice(n,1),t.onRemove(this),this}hasControl(e){return this._controls.indexOf(e)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(t){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const n=!this._moving;return n&&this.fire(new e.x("movestart",t)).fire(new e.x("move",t)),this.fire(new e.x("resize",t)),n&&this.fire(new e.x("moveend",t)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(t){return this.transform.setMaxBounds(e.as.convert(t)),this._update()}setMinZoom(t){var n;if((t=null!==(n=t)&&void 0!==n?n:-2)>=-2&&t<=this.transform.maxZoom)return this.transform.minZoom=t,this._update(),this.getZoom()<t?this.setZoom(t):this.fire(new e.x("zoomstart")).fire(new e.x("zoom")).fire(new e.x("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(t){var n;if((t=null!==(n=t)&&void 0!==n?n:22)>=this.transform.minZoom)return this.transform.maxZoom=t,this._update(),this.getZoom()>t?this.setZoom(t):this.fire(new e.x("zoomstart")).fire(new e.x("zoom")).fire(new e.x("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(t){var n;if((t=null!==(n=t)&&void 0!==n?n:0)<0)throw new Error("minPitch must be greater than or equal to 0");if(t>=0&&t<=this.transform.maxPitch)return this.transform.minPitch=t,this._update(),this.getPitch()<t?this.setPitch(t):this.fire(new e.x("pitchstart")).fire(new e.x("pitch")).fire(new e.x("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(t){var n;if((t=null!==(n=t)&&void 0!==n?n:85)>85)throw new Error("maxPitch must be less than or equal to 85");if(t>=this.transform.minPitch)return this.transform.maxPitch=t,this._update(),this.getPitch()>t?this.setPitch(t):this.fire(new e.x("pitchstart")).fire(new e.x("pitch")).fire(new e.x("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getScaleFactor(){return this._scaleFactor}setScaleFactor(e){return this._scaleFactor=e,this.painter.scaleFactor=e,this._tp.refreshUI(),this._scaleFactorChanged=!0,this.style._updateFilteredLayers((e=>"symbol"===e.type)),this._update(!0),this}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(e){return this.transform.renderWorldCopies=e,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(e){return"auto"===e?navigator.language:Array.isArray(e)?0===e.length?void 0:e.map((e=>"auto"===e?navigator.language:e)):e}setLanguage(e){const t=this._parseLanguage(e);if(!this.style||t===this._language)return this;this._language=t,this.style.reloadSources();for(const n of this._controls)n._setLanguage&&n._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(e){return this.style&&e!==this._worldview?(this._worldview=e,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return"globe"===this.transform.projection.name}setProjection(e){return this._lazyInitEmptyStyle(),e?"string"==typeof e&&(e={name:e}):e=null,this._useExplicitProjection=!!e,this._prioritizeAndUpdateProjection(e,this.style.projection)}_updateProjectionTransition(){if("globe"!==this.getProjection().name)return;const t=this.transform,n=t.projection.name;let r;"globe"===n&&t.zoom>=e.bV?(t.setMercatorFromTransition(),r=!0):"mercator"===n&&t.zoom<e.bV&&(t.setProjection({name:"globe"}),r=!0),r&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(e,t){return this._updateProjection(e||t||{name:"mercator"})}_updateProjection(t){let n;return n="globe"===t.name&&this.transform.zoom>=e.bV?this.transform.setMercatorFromTransition():this.transform.setProjection(t),this.style.applyProjectionUpdate(),n&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(t){return this.transform.locationPoint3D(e.bL.convert(t))}unproject(t){return this.transform.pointLocation3D(e.P.convert(t))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(e,t,n){const r=e=>{let n=[];if(Array.isArray(t)){const r=t.filter((e=>this.getLayer(e)));n=r.length?this.queryRenderedFeatures(e,{layers:r}):[]}else n=this.queryRenderedFeatures(e,{featureset:t});return n};if("mouseenter"===e||"mouseover"===e){let i=!1;const o=t=>{const o=r(t.point);o.length?i||(i=!0,n.call(this,new Ba(e,this,t.originalEvent,{features:o}))):i=!1};return{listener:n,targets:t,delegates:{mousemove:o,mouseout:()=>{i=!1}}}}if("mouseleave"===e||"mouseout"===e){let i=!1;const o=t=>{r(t.point).length?i=!0:i&&(i=!1,n.call(this,new Ba(e,this,t.originalEvent)))},a=t=>{i&&(i=!1,n.call(this,new Ba(e,this,t.originalEvent)))};return{listener:n,targets:t,delegates:{mousemove:o,mouseout:a}}}{const i=e=>{const t=r(e.point);t.length&&(e.features=t,n.call(this,e),delete e.features)};return{listener:n,targets:t,delegates:{[e]:i}}}}on(e,t,n){if("function"==typeof t||void 0===n)return super.on(e,t);if("string"==typeof t&&(t=[t]),!this._areTargetsValid(t))return this;const r=this._createDelegatedListener(e,t,n);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[e]=this._delegatedListeners[e]||[],this._delegatedListeners[e].push(r);for(const i in r.delegates)this.on(i,r.delegates[i]);return this}once(e,t,n){if("function"==typeof t||void 0===n)return super.once(e,t);if("string"==typeof t&&(t=[t]),!this._areTargetsValid(t))return this;const r=this._createDelegatedListener(e,t,n);for(const i in r.delegates)this.once(i,r.delegates[i]);return this}off(e,t,n){if("function"==typeof t||void 0===n)return super.off(e,t);if("string"==typeof t&&(t=[t]),!this._areTargetsValid(t))return this;const r=this._delegatedListeners?this._delegatedListeners[e]:void 0;return r&&(e=>{for(let r=0;r<e.length;r++){const i=e[r];if(i.listener===n&&zs(i.targets,t)){for(const e in i.delegates)this.off(e,i.delegates[e]);return e.splice(r,1),this}}})(r),this}queryRenderedFeatures(t,n){if(!this.style)return[];if(void 0!==n||void 0===t||t instanceof e.P||Array.isArray(t)||(n=t,t=void 0),t=t||[[0,0],[this.transform.width,this.transform.height]],"featureset"in(n=n||{}))return this._isFeaturesetDescriptorValid(n.featureset)?this.style.queryRenderedFeaturesForInteractions(t,[n],this.transform):[];if(n.layers&&Array.isArray(n.layers))for(const e of n.layers)if(!this._isValidId(e))return[];return this.style.queryRenderedFeatures(t,n,this.transform)}querySourceFeatures(e,t){return!e||"string"==typeof e&&!this._isValidId(e)?[]:this.style.querySourceFeatures(e,t)}isPointOnSurface(t){const{name:n}=this.transform.projection;return"globe"!==n&&"mercator"!==n&&e.w("".concat(n," projection does not support isPointOnSurface, this API may behave unexpectedly.")),this.transform.isPointOnSurface(e.P.convert(t))}addInteraction(e,t){return this._interactions.add(e,t),this}removeInteraction(e){return this._interactions.remove(e),this}setStyle(t,n){return n=e.l({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},n),this.style&&t&&!1!==n.diff&&n.localFontFamily===this._localFontFamily&&n.localIdeographFontFamily===this._localIdeographFontFamily&&!n.config?(this.style._diffStyle(t,((r,i)=>{r?(e.w("Unable to perform style diff: ".concat(String(r.message||r.error||r),". Rebuilding the style from scratch.")),this._updateStyle(t,n)):i&&this._update(!0)}),(()=>{this._postStyleLoadEvent()})),this):(this._localIdeographFontFamily=n.localIdeographFontFamily,this._localFontFamily=n.localFontFamily,this._updateStyle(t,n))}_getUIString(e){const t=this._locale[e];if(null==t)throw new Error("Missing UI string '".concat(e,"'"));return t}_updateStyle(t,n){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),t){const r=e.l({},n);n&&n.config&&(r.initialConfig=n.config,delete r.config),this.style=new pr(this,r).load(t),this.style.setEventedParent(this,{style:this.style})}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new pr(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(e.w("There is no style added to the map."),!1)}_isValidId(t){return null==t?(this.fire(new e.t(new Error("IDs can't be empty."))),!1):!e.aK(t)||(this.fire(new e.t(new Error("IDs can't contain special symbols: \"".concat(t,'".')))),!1)}_isFeaturesetDescriptorValid(e){return"featuresetId"in e?this._isValidId(e.featuresetId):"layerId"in e&&this._isValidId(e.layerId)}_areTargetsValid(e){if(Array.isArray(e)){for(const t of e)if(!this._isValidId(t))return!1;return!0}return this._isFeaturesetDescriptorValid(e)}addSource(e,t){return this._isValidId(e)?(this._lazyInitEmptyStyle(),this.style.addSource(e,t),this._update(!0)):this}isSourceLoaded(e){return!!this._isValidId(e)&&!!this.style&&this.style._isSourceCacheLoaded(e)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(e,t,n){this._lazyInitEmptyStyle(),this.style.addSourceType(e,t,n)}removeSource(e){return this._isValidId(e)?(this.style.removeSource(e),this._updateTerrain(),this._update(!0)):this}getSource(e){return this._isValidId(e)?this.style.getOwnSource(e):null}addImage(t,n){let{pixelRatio:r=1,sdf:i=!1,stretchX:o,stretchY:a,content:s}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this._lazyInitEmptyStyle(),n instanceof HTMLImageElement||ImageBitmap&&n instanceof ImageBitmap){const{width:l,height:c,data:u}=e.q.getImageData(n);this.style.addImage(t,{data:new e.r({width:l,height:c},u),pixelRatio:r,stretchX:o,stretchY:a,content:s,sdf:i,version:0})}else if(void 0===n.width||void 0===n.height)this.fire(new e.t(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:l,height:c}=n,u=n;this.style.addImage(t,{data:new e.r({width:l,height:c},new Uint8Array(u.data)),pixelRatio:r,stretchX:o,stretchY:a,content:s,sdf:i,version:0,userImage:u}),u.onAdd&&u.onAdd(this,t)}}updateImage(t,n){this._lazyInitEmptyStyle();const r=this.style.getImage(t);if(!r)return void this.fire(new e.t(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const i=n instanceof HTMLImageElement||ImageBitmap&&n instanceof ImageBitmap?e.q.getImageData(n):n,{width:o,height:a,data:s}=i;if(void 0===o||void 0===a)return void this.fire(new e.t(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(o!==r.data.width||a!==r.data.height)return void this.fire(new e.t(new Error("The width and height of the updated image (".concat(o,", ").concat(a,")\n                must be that same as the previous version of the image\n                (").concat(r.data.width,", ").concat(r.data.height,")"))));const l=!(n instanceof HTMLImageElement||ImageBitmap&&n instanceof ImageBitmap);r.data.replace(s,l),this.style.updateImage(t,r)}hasImage(t){return t?!!this.style&&!!this.style.getImage(t):(this.fire(new e.t(new Error("Missing required image id"))),!1)}removeImage(e){this.style.removeImage(e)}loadImage(t,n){e.o(this._requestManager.transformRequest(t,e.R.Image),((t,r)=>{n(t,r instanceof HTMLImageElement?e.q.getImageData(r):r)}))}listImages(){return this.style.listImages()}addModel(e,t){this._lazyInitEmptyStyle(),this.style.addModel(e,t)}hasModel(t){return t?this.style.hasModel(t):(this.fire(new e.t(new Error("Missing required model id"))),!1)}removeModel(e){this.style.removeModel(e)}listModels(){return this.style.listModels()}addLayer(e,t){return this._isValidId(e.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(e,t),this._update(!0)):this}getSlot(e){const t=this.getLayer(e);return t&&t.slot||null}setSlot(e,t){return this.style.setSlot(e,t),this.style.mergeLayers(),this._update(!0)}addImport(e,t){return this.style.addImport(e,t),this}updateImport(e,t){return"string"!=typeof t&&t.id!==e?(this.removeImport(e),this.addImport(t)):(this.style.updateImport(e,t),this._update(!0))}removeImport(e){return this.style.removeImport(e),this}moveImport(e,t){return this.style.moveImport(e,t),this._update(!0)}moveLayer(e,t){return this._isValidId(e)?(this.style.moveLayer(e,t),this._update(!0)):this}removeLayer(e){return this._isValidId(e)?(this.style.removeLayer(e),this._update(!0)):this}getLayer(e){if(!this._isValidId(e))return null;const t=this.style.getOwnLayer(e);return t?"custom"===t.type?t.implementation:t.serialize():void 0}getSlots(){return this.style.getSlots()}setLayerZoomRange(e,t,n){return this._isValidId(e)?(this.style.setLayerZoomRange(e,t,n),this._update(!0)):this}setFilter(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this._isValidId(e)?(this.style.setFilter(e,t,n),this._update(!0)):this}getFilter(e){return this._isValidId(e)?this.style.getFilter(e):null}setPaintProperty(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this._isValidId(e)?(this.style.setPaintProperty(e,t,n,r),this._update(!0)):this}getPaintProperty(e,t){return this._isValidId(e)?this.style.getPaintProperty(e,t):null}setLayoutProperty(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this._isValidId(e)?(this.style.setLayoutProperty(e,t,n,r),this._update(!0)):this}getLayoutProperty(e,t){return this._isValidId(e)?this.style.getLayoutProperty(e,t):null}getSchema(e){return this.style.getSchema(e)}setSchema(e,t){return this.style.setSchema(e,t),this._update(!0)}getConfig(e){return this.style.getConfig(e)}setConfig(e,t){return this.style.setConfig(e,t),this._update(!0)}getConfigProperty(e,t){return this.style.getConfigProperty(e,t)}setConfigProperty(e,t,n){return this.style.setConfigProperty(e,t,n),this._update(!0)}getFeaturesetDescriptors(e){return this.style.getFeaturesetDescriptors(e)}setLights(e){if(this._lazyInitEmptyStyle(),e&&1===e.length&&"flat"===e[0].type){const t=e[0];t.properties?this.style.setFlatLight(t.properties,t.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(e),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const e=this.style.getLights()||[];return 0===e.length&&e.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),e}setLight(e){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:e}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(e){return this._lazyInitEmptyStyle(),!e&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(e),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(e){return this._lazyInitEmptyStyle(),this.style.setFog(e),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setColorTheme(e){return this._lazyInitEmptyStyle(),this.style.setColorTheme(e),this._update(!0)}setCamera(e){return this.style.setCamera(e),this._triggerCameraUpdate(e)}_triggerCameraUpdate(e){return this._update(this.transform.setOrthographicProjectionAtLowPitch("orthographic"===e["camera-projection"]))}getCamera(){return this.style.camera}_queryFogOpacity(t){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(e.bL.convert(t),this.transform):0}setFeatureState(e,t){return e.source&&!this._isValidId(e.source)?this:(this.style.setFeatureState(e,t),this._update())}removeFeatureState(e,t){return e.source&&!this._isValidId(e.source)?this:(this.style.removeFeatureState(e,t),this._update())}getFeatureState(e){return e.source&&!this._isValidId(e.source)?null:this.style.getFeatureState(e)}_updateContainerDimensions(){if(!this._container)return;const e=this._container.getBoundingClientRect().width||400,t=this._container.getBoundingClientRect().height||300;let n,r,i,o=this._container;for(;o&&(!r||!i);){const e=window.getComputedStyle(o).transform;e&&"none"!==e&&(n=e.match(/matrix.*\((.+)\)/)[1].split(", "),n[0]&&"0"!==n[0]&&"1"!==n[0]&&(r=n[0]),n[3]&&"0"!==n[3]&&"1"!==n[3]&&(i=n[3])),o=o.parentElement}this._containerWidth=r?Math.abs(e/r):e,this._containerHeight=i?Math.abs(t/i):t}_detectMissingCSS(){"rgb(250, 128, 114)"!==window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&e.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const e=this._container;e.classList.add("mapboxgl-map"),(this._missingCSSCanary=d("div","mapboxgl-canary",e)).style.visibility="hidden",this._detectMissingCSS();const t=this._canvasContainer=d("div","mapboxgl-canvas-container",e);this._canvas=d("canvas","mapboxgl-canvas",t),this._interactive&&(t.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const n=this._controlContainer=d("div","mapboxgl-control-container",e),r=this._controlPositions={};["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"].forEach((e=>{r[e]=d("div","mapboxgl-ctrl-".concat(e),n)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(t,n){const r=e.q.devicePixelRatio||1;this._canvas.width=r*Math.ceil(t),this._canvas.height=r*Math.ceil(n),this._canvas.style.width="".concat(t,"px"),this._canvas.style.height="".concat(n,"px")}_addMarker(e){this._markers.push(e)}_removeMarker(e){const t=this._markers.indexOf(e);-1!==t&&this._markers.splice(t,1)}_addPopup(e){this._popups.push(e)}_removePopup(e){const t=this._popups.indexOf(e);-1!==t&&this._popups.splice(t,1)}_setupPainter(){const t=e.l({},h.supported.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),n=this._canvas.getContext("webgl2",t);n?(Z(n,!0),this.painter=new Pa(n,this._contextCreateOptions,this.transform,this._scaleFactor,this._tp),this.on("data",(e=>{"source"===e.dataType&&this.painter.setTileLoadedFlag(!0)})),e.m.testSupport(n)):this.fire(new e.t(new Error("Failed to initialize WebGL")))}_contextLost(t){t.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new e.x("webglcontextlost",{originalEvent:t}))}_contextRestored(t){this._setupPainter(),this.resize(),this._update(),this.fire(new e.x("webglcontextrestored",{originalEvent:t}))}_onMapScroll(e){if(e.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}idle(){return!this.isMoving()&&this.loaded()}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}frameReady(){return this.loaded()&&!this._placementDirty}_update(e){return this.style?(this._styleDirty=this._styleDirty||e,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(e){return this._update(),this._renderTaskQueue.add(e)}_cancelRenderFrame(e){this._renderTaskQueue.remove(e)}_requestDomTask(e){!this.loaded()||this.loaded()&&!this.isMoving()?e():this._domRenderTaskQueue.add(e)}_render(t){let r;this.fire(new e.x("renderstart")),++this._frameId;const i=this.painter.context.extTimerQuery,o=e.q.now(),a=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(r=a.createQuery(),a.beginQuery(i.TIME_ELAPSED_EXT,r)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(t),this._domRenderTaskQueue.run(t),this._removed)return;this._updateProjectionTransition();const l=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const t=this.transform.zoom,n=this.transform.pitch,r=e.q.now(),i=new e.a3(t,{now:r,fadeDuration:l,pitch:n,transition:this.style.transition});this.style.update(i)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let c=!1;this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),c=this._updateAverageElevation(o),this.style.updateSources(this.transform),this._forceMarkerAndPopupUpdate()):c=this._updateAverageElevation(o);const u=this.style&&this.style._updatePlacement(this.painter,this.painter.transform,this.showCollisionBoxes,l,this._crossSourceCollisions,this.painter.replacementSource,this._scaleFactorChanged);if(this._scaleFactorChanged&&(this._scaleFactorChanged=!1),u&&(this._placementDirty=u.needsRerender),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:l,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new e.x("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,s.mark(n.load),this.fire(new e.x("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),r){const t=e.q.now()-o;a.endQuery(i.TIME_ELAPSED_EXT),setTimeout((()=>{const n=a.getQueryParameter(r,a.QUERY_RESULT)/1e6;a.deleteQuery(r),this.fire(new e.x("gpu-timing-frame",{cpuTime:t,gpuTime:n}))}),50)}if(this.listens("gpu-timing-layer")){const t=this.painter.collectGpuTimers();setTimeout((()=>{const n=this.painter.queryGpuTimers(t);this.fire(new e.x("gpu-timing-layer",{layerTimes:n}))}),50)}if(this.listens("gpu-timing-deferred-render")){const t=this.painter.collectDeferredRenderGpuQueries();setTimeout((()=>{const n=this.painter.queryGpuTimeDeferredRender(t);this.fire(new e.x("gpu-timing-deferred-render",{gpuTime:n}))}),50)}const h=this._sourcesDirty||this._styleDirty||this._placementDirty||c;if(h||this._repaint)this.triggerRepaint();else{const t=this.idle();if(t&&(c=this._updateAverageElevation(o,!0)),c)this.triggerRepaint();else if(this._triggerFrame(!1),t&&(this.fire(new e.x("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const t=this._calculateSpeedIndex();this.fire(new e.x("speedindexcompleted",{speedIndex:t})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||h||(this._fullyLoaded=!0,s.mark(n.fullLoad),this._performanceMetricsCollection&&V(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(e){for(const t of this._markers)e&&!this.getRenderWorldCopies()&&(t._lngLat=t._lngLat.wrap()),t._update();for(const t of this._popups)!e||this.getRenderWorldCopies()||t._trackPointer||(t._lngLat=t._lngLat.wrap()),t._update()}_updateAverageElevation(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=e=>(this.transform.averageElevation=e,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&n(0);const r=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(r||(t||e-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(e)){const t=this.transform.averageElevation;let i=this.transform.sampleAverageElevation();null!=this.transform.elevation&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(i)?i=0:this._averageElevationLastSampledAt=e;const o=Math.abs(t-i);if(o>1){if(this._isInitialLoad||r)return this._averageElevation.jumpTo(i),n(i);this._averageElevation.easeTo(i,e,300)}else if(o>1e-4)return this._averageElevation.jumpTo(i),n(i)}return!!this._averageElevation.isEasing(e)&&n(this._averageElevation.getValue(e))}_authenticate(){G(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,(t=>{if(t&&(t.message===A||401===t.status)){const t=this.painter.context.gl;Z(t,!1),this._logoControl instanceof Cs&&this._logoControl._updateLogo(),t&&t.clear(t.DEPTH_BUFFER_BIT|t.COLOR_BUFFER_BIT|t.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new e.t(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}})),z(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,(()=>{}))}_postStyleLoadEvent(){this.style.globalId&&F(this._requestManager._customAccessToken,{map:this,skuToken:this._requestManager._skuToken,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_updateTerrain(){const e=this._isDragging();this.painter.updateTerrain(this.style,e)}_calculateSpeedIndex(){const e=this.painter.canvasCopy(),t=this.painter.getCanvasCopiesAndTimestamps();t.timeStamps.push(performance.now());const n=this.painter.context.gl,r=n.createFramebuffer();function i(e){n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,e,0);const t=new Uint8Array(n.drawingBufferWidth*n.drawingBufferHeight*4);return n.readPixels(0,0,n.drawingBufferWidth,n.drawingBufferHeight,n.RGBA,n.UNSIGNED_BYTE,t),t}return n.bindFramebuffer(n.FRAMEBUFFER,r),this._canvasPixelComparison(i(e),t.canvasCopies.map(i),t.timeStamps)}_canvasPixelComparison(e,t,n){let r=n[1]-n[0];const i=e.length/4;for(let o=0;o<t.length;o++){const a=t[o];let s=0;for(let t=0;t<a.length;t+=4)a[t]===e[t]&&a[t+1]===e[t+1]&&a[t+2]===e[t+2]&&a[t+3]===e[t+3]&&(s+=1);r+=(n[o+2]-n[o+1])*(1-s/i)}return r}remove(){this._hash&&this._hash.remove();for(const e of this._controls)e.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const t=this.painter.context.gl.getExtension("WEBGL_lose_context");t&&t.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),H.delete(this.painter.context.gl),U.remove(),L.remove(),this._removed=!0,this.fire(new e.x("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(t){this._renderNextFrame=this._renderNextFrame||t,this.style&&!this._frame&&(this._frame=e.q.frame((e=>{const t=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,t&&this._render(e)})))}_preloadTiles(t){const n=this.style?this.style.getSourceCaches():[];return e.bg(n,((e,n)=>e._preloadTiles(t,n)),(()=>{this.triggerRepaint()})),this}_onWindowOnline(){this._update()}_onWindowResize(e){this._trackResize&&this.resize({originalEvent:e})._update()}_onVisibilityChange(){"hidden"===document.visibilityState&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(e){this._showTileBoundaries!==e&&(this._showTileBoundaries=e,this._tp.refreshUI(),this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(e){this._showParseStatus!==e&&(this._showParseStatus=e,this._tp.refreshUI(),this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(e){this._showTerrainWireframe!==e&&(this._showTerrainWireframe=e,this._tp.refreshUI(),this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(e){this._showLayers2DWireframe!==e&&(this._showLayers2DWireframe=e,this._tp.refreshUI(),this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(e){this._showLayers3DWireframe!==e&&(this._showLayers3DWireframe=e,this._tp.refreshUI(),this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(e){this._speedIndexTiming!==e&&(this._speedIndexTiming=e,this._update())}get showPadding(){return!!this._showPadding}set showPadding(e){this._showPadding!==e&&(this._showPadding=e,this._tp.refreshUI(),this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(e){this._showCollisionBoxes!==e&&(this._showCollisionBoxes=e,this._tp.refreshUI(),e?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(e){this._showOverdrawInspector!==e&&(this._showOverdrawInspector=e,this._tp.refreshUI(),this._update())}get repaint(){return!!this._repaint}set repaint(e){this._repaint!==e&&(this._repaint=e,this._tp.refreshUI(),this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(e){this._vertices=e,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(e){this._showTileAABBs!==e&&(this._showTileAABBs=e,this._tp.refreshUI(),e&&this._update())}_setCacheLimits(t,n){e.dy(t,n)}get version(){return t}},NavigationControl:class{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options=e.l({},Fs,t),this._container=d("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",(e=>e.preventDefault())),this.options.showZoom&&(e.aJ(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",(e=>{this._map&&this._map.zoomIn({},{originalEvent:e})})),d("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",(e=>{this._map&&this._map.zoomOut({},{originalEvent:e})})),d("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(e.aJ(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",(e=>{const t=this._map;t&&(this.options.visualizePitch?t.resetNorthPitch({},{originalEvent:e}):t.resetNorth({},{originalEvent:e}))})),this._compassIcon=d("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const e=this._map;if(!e)return;const t=e.getZoom(),n=t===e.getMaxZoom(),r=t===e.getMinZoom();this._zoomInButton.disabled=n,this._zoomOutButton.disabled=r,this._zoomInButton.setAttribute("aria-disabled",n.toString()),this._zoomOutButton.setAttribute("aria-disabled",r.toString())}_rotateCompassArrow(){const e=this._map;if(!e)return;const t=this.options.visualizePitch?"scale(".concat(1/Math.pow(Math.cos(e.transform.pitch*(Math.PI/180)),.5),") rotateX(").concat(e.transform.pitch,"deg) rotateZ(").concat(e.transform.angle*(180/Math.PI),"deg)"):"rotate(".concat(e.transform.angle*(180/Math.PI),"deg)");e._requestDomTask((()=>{this._compassIcon&&(this._compassIcon.style.transform=t)}))}onAdd(e){return this._map=e,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),e.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&e.on("pitch",this._rotateCompassArrow),e.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Bs(e,this._compass,this.options.visualizePitch)),this._container}onRemove(){const e=this._map;e&&(this._container.remove(),this.options.showZoom&&e.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&e.off("pitch",this._rotateCompassArrow),e.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(e,t){const n=d("button",e,this._container);return n.type="button",n.addEventListener("click",t),n}_setButtonTitle(e,t){if(!this._map)return;const n=this._map._getUIString("NavigationControl.".concat(t));e.setAttribute("aria-label",n),e.firstElementChild&&e.firstElementChild.setAttribute("title",n)}},GeolocateControl:class extends e.E{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super();const n=navigator.geolocation;this.options=e.l({geolocation:n},Hs,t),e.aJ(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=ka(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(e){return this._map=e,this._container=d("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){void 0!==this._geolocationWatchID&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(e){var t=this;const n=function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!!t.options.geolocation;t._supportsGeolocation=n,e(n)};void 0!==this._supportsGeolocation?e(this._supportsGeolocation):void 0!==navigator.permissions?navigator.permissions.query({name:"geolocation"}).then((e=>n("denied"!==e.state))).catch((()=>n())):n()}_isOutOfMapMaxBounds(e){const t=this._map.getMaxBounds(),n=e.coords;return!!t&&(n.longitude<t.getWest()||n.longitude>t.getEast()||n.latitude<t.getSouth()||n.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(t){if(this._map){if(this._isOutOfMapMaxBounds(t))return this._setErrorState(),this.fire(new e.x("outofmaxbounds",t)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(t),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(t),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new e.x("geolocate",t)),this._finish()}}_updateCamera(t){const n=new e.bL(t.coords.longitude,t.coords.latitude),r=t.coords.accuracy,i=this._map.getBearing(),o=e.l({bearing:i},this.options.fitBoundsOptions);this._map.fitBounds(n.toBounds(r),o,{geolocateSource:!0})}_updateMarker(t){if(t){const n=new e.bL(t.coords.longitude,t.coords.latitude);this._accuracyCircleMarker.setLngLat(n).addTo(this._map),this._userLocationDotMarker.setLngLat(n).addTo(this._map),this._accuracy=t.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const t=this._map.transform,n=e.bE(1,t._center.lat)*t.worldSize,r=Math.ceil(2*this._accuracy*n);this._circleElement.style.width="".concat(r,"px"),this._circleElement.style.height="".concat(r,"px")}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&"number"==typeof this._heading?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(t){if(this._map){if(this.options.trackUserLocation)if(1===t.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const e=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",e),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",e),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===t.code&&this._noTimeout)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new e.x("error",t)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(t){if(void 0!==this._map){if(this._container.addEventListener("contextmenu",(e=>e.preventDefault())),this._geolocateButton=d("button","mapboxgl-ctrl-geolocate",this._container),d("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===t){e.w("Geolocation support is not available so the GeolocateControl will be disabled.");const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t)}else{const e=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",e),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",e)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=d("div","mapboxgl-user-location"),this._dotElement.appendChild(d("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(d("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Gs({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=d("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Gs({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(t=>{t.geolocateSource||"ACTIVE_LOCK"!==this._watchState||t.originalEvent&&"resize"===t.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new e.x("trackuserlocationend")))}))}}_onDeviceOrientation(e){this._userLocationDotMarker&&(e.webkitCompassHeading?this._heading=e.webkitCompassHeading:!0===e.absolute&&(this._heading=-1*e.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return e.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new e.x("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new e.x("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new e.x("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let e;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(e={maximumAge:6e5,timeout:0},this._noTimeout=!0):(e=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,e),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=window.setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const e=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};"undefined"!=typeof DeviceMotionEvent&&"function"==typeof DeviceMotionEvent.requestPermission?DeviceOrientationEvent.requestPermission().then((t=>{"granted"===t&&e()})).catch(console.error):e()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:ks,ScaleControl:class{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options=e.l({},Zs,t),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch(e){return!1}}(),e.aJ(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const e=this.options.maxWidth||100,t=this._map,n=t._containerHeight/2,r=t._containerWidth/2-e/2,i=t.unproject([r,n]),o=t.unproject([r+e,n]),a=i.distanceTo(o);if("imperial"===this.options.unit){const t=3.2808*a;t>5280?this._setScale(e,t/5280,"mile"):this._setScale(e,t,"foot")}else"nautical"===this.options.unit?this._setScale(e,a/1852,"nautical-mile"):a>=1e3?this._setScale(e,a/1e3,"kilometer"):this._setScale(e,a,"meter")}_setScale(e,t,n){this._map._requestDomTask((()=>{const r=function(e){const t=Math.pow(10,"".concat(Math.floor(e)).length-1);let n=e/t;return n=n>=10?10:n>=5?5:n>=3?3:n>=2?2:n>=1?1:function(e){const t=Math.pow(10,Math.ceil(-Math.log(e)/Math.LN10));return Math.round(e*t)/t}(n),t*n}(t),i=r/t;this._container.innerHTML=this._isNumberFormatSupported&&"nautical-mile"!==n?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:n}).format(r):"".concat(r,"&nbsp;").concat(qs[n]),this._container.style.width=e*i+"px"}))}onAdd(e){return this._map=e,this._language=e.getLanguage(),this._container=d("div","mapboxgl-ctrl mapboxgl-ctrl-scale",e.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(e){this._language=e,this._update()}setUnit(e){this.options.unit=e,this._update()}},FullscreenControl:class{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._fullscreen=!1,t&&t.container&&(t.container instanceof HTMLElement?this._container=t.container:e.w("Full screen control 'container' must be a DOM element.")),e.aJ(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(t){return this._map=t,this._container||(this._container=this._map.getContainer()),this._controlContainer=d("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",e.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const e=this._fullscreenButton=d("button","mapboxgl-ctrl-fullscreen",this._controlContainer);d("span","mapboxgl-ctrl-icon",e).setAttribute("aria-hidden","true"),e.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const e=this._getTitle();this._fullscreenButton.setAttribute("aria-label",e),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",e)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends e.E{constructor(t){super(),this.options=e.l(Object.create(Ws),t),e.aJ(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(t&&t.className?t.className.trim().split(/\s+/):[])}addTo(t){return this._map&&this.remove(),this._map=t,this.options.closeOnClick&&t.on("preclick",this._onClose),this.options.closeOnMove&&t.on("move",this._onClose),t.on("remove",this.remove),this._update(),t._addPopup(this),this._focusFirstElement(),this._trackPointer?(t.on("mousemove",this._onMouseEvent),t.on("mouseup",this._onMouseEvent),t._canvasContainer.classList.add("mapboxgl-track-pointer")):t.on("move",this._update),this.fire(new e.x("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const t=this._map;return t&&(t.off("move",this._update),t.off("move",this._onClose),t.off("preclick",this._onClose),t.off("click",this._onClose),t.off("remove",this.remove),t.off("mousemove",this._onMouseEvent),t.off("mouseup",this._onMouseEvent),t.off("drag",this._onMouseEvent),t._canvasContainer&&t._canvasContainer.classList.remove("mapboxgl-track-pointer"),t._removePopup(this),this._map=void 0),this.fire(new e.x("close")),this}getLngLat(){return this._lngLat}setLngLat(t){this._lngLat=e.bL.convert(t),this._pos=null,this._trackPointer=!1,this._update();const n=this._map;return n&&(n.on("move",this._update),n.off("mousemove",this._onMouseEvent),n._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const e=this._map;return e&&(e.off("move",this._update),e.on("mousemove",this._onMouseEvent),e.on("drag",this._onMouseEvent),e._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(e){return this.setDOMContent(document.createTextNode(e))}setHTML(e){const t=document.createDocumentFragment(),n=document.createElement("body");let r;for(n.innerHTML=e;r=n.firstChild,r;)t.appendChild(r);return this.setDOMContent(t)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(e){return this.options.maxWidth=e,this._update(),this}setDOMContent(e){let t=this._content;if(t)for(;t.hasChildNodes();)t.firstChild&&t.removeChild(t.firstChild);else t=this._content=d("div","mapboxgl-popup-content",this._container||void 0);if(t.appendChild(e),this.options.closeButton){const e=this._closeButton=d("button","mapboxgl-popup-close-button",t);e.type="button",e.setAttribute("aria-label","Close popup"),e.setAttribute("aria-hidden","true"),e.innerHTML="&#215;",e.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(e){return this._classList.add(e),this._updateClassList(),this}removeClassName(e){return this._classList.delete(e),this._updateClassList(),this}setOffset(e){return this.options.offset=e,this._update(),this}toggleClassName(e){let t;return this._classList.delete(e)?t=!1:(this._classList.add(e),t=!0),this._updateClassList(),t}_onMouseEvent(e){this._update(e.point)}_getAnchor(e){if(this.options.anchor)return this.options.anchor;const t=this._map,n=this._container,r=this._pos;if(!t||!n||!r)return"bottom";const i=n.offsetWidth,o=n.offsetHeight,a=r.x<i/2,s=r.x>t.transform.width-i/2;if(r.y+e<o)return a?"top-left":s?"top-right":"top";if(r.y>t.transform.height-o){if(a)return"bottom-left";if(s)return"bottom-right"}return a?"left":s?"right":"bottom"}_updateClassList(){const e=this._container;if(!e)return;const t=[...this._classList];t.push("mapboxgl-popup"),this._anchor&&t.push("mapboxgl-popup-anchor-".concat(this._anchor)),this._trackPointer&&t.push("mapboxgl-popup-track-pointer"),e.className=t.join(" ")}_update(t){const n=this._map,r=this._content;if(!n||!this._lngLat&&!this._trackPointer||!r)return;let i=this._container;if(i||(i=this._container=d("div","mapboxgl-popup",n.getContainer()),this._tip=d("div","mapboxgl-popup-tip",i),i.appendChild(r)),this.options.maxWidth&&i.style.maxWidth!==this.options.maxWidth&&(i.style.maxWidth=this.options.maxWidth),n.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Vs(this._lngLat,this._pos,n.transform)),!this._trackPointer||t){const r=this._pos=this._trackPointer&&t instanceof e.P?t:n.project(this._lngLat),i=Ys(this.options.offset),o=this._anchor=this._getAnchor(i.y),a=Ys(this.options.offset,o),s=r.add(a).round();n._requestDomTask((()=>{this._container&&o&&(this._container.style.transform="".concat(Us[o]," translate(").concat(s.x,"px,").concat(s.y,"px)"))}))}if(!this._marker&&n._showingGlobe()){const t=e.dz(n.transform,this._lngLat)?0:1;this._setOpacity(t)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const e=this._container.querySelector(Xs);e&&e.focus()}_onClose(){this.remove()}_setOpacity(e){this._container&&(this._container.style.opacity="".concat(e)),this._content&&(this._content.style.pointerEvents=e?"auto":"none")}},Marker:Gs,Style:pr,LngLat:e.bL,LngLatBounds:e.as,Point:e.P,MercatorCoordinate:e.a5,FreeCameraOptions:Hn,Evented:e.E,config:e.e,prewarm:e.dE,clearPrewarmedResources:e.dF,get accessToken(){return e.e.ACCESS_TOKEN},set accessToken(t){e.e.ACCESS_TOKEN=t},get baseApiUrl(){return e.e.API_URL},set baseApiUrl(t){e.e.API_URL=t},get workerCount(){return e.dG.workerCount},set workerCount(t){e.dG.workerCount=t},get maxParallelImageRequests(){return e.e.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(t){e.e.MAX_PARALLEL_IMAGE_REQUESTS=t},clearStorage(t){e.dH(t)},get workerUrl(){return e.dI.workerUrl},set workerUrl(t){e.dI.workerUrl=t},get workerClass(){return e.dI.workerClass},set workerClass(t){e.dI.workerClass=t},get workerParams(){return e.dI.workerParams},set workerParams(t){e.dI.workerParams=t},get dracoUrl(){return e.dJ()},set dracoUrl(t){e.dK(t)},get meshoptUrl(){return e.dL()},set meshoptUrl(t){e.dM(t)},setNow:e.q.setNow,restoreNow:e.q.restoreNow};return Ks})),n}()},1497:(e,t,n)=>{"use strict";var r=n(3218);function i(){}function o(){}o.resetWarningCache=i,e.exports=function(){function e(e,t,n,i,o,a){if(a!==r){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:o,resetWarningCache:i};return n.PropTypes=n,n}},5173:(e,t,n)=>{e.exports=n(1497)()},3218:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},2730:(e,t,n)=>{"use strict";var r=n(5043),i=n(8853);function o(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,s={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(s[e]=t,e=0;e<t.length;e++)a.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},f={};function m(e,t,n,r,i,o,a){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=a}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){g[e]=new m(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];g[t]=new m(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){g[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){g[e]=new m(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){g[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){g[e]=new m(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){g[e]=new m(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){g[e]=new m(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){g[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)}));var y=/[\-:]([a-z])/g;function _(e){return e[1].toUpperCase()}function v(e,t,n,r){var i=g.hasOwnProperty(t)?g[t]:null;(null!==i?0!==i.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!h.call(f,e)||!h.call(p,e)&&(d.test(e)?f[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(y,_);g[t]=new m(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(y,_);g[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(y,_);g[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)})),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)}));var x=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,b=Symbol.for("react.element"),w=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),T=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),A=Symbol.for("react.provider"),M=Symbol.for("react.context"),P=Symbol.for("react.forward_ref"),k=Symbol.for("react.suspense"),C=Symbol.for("react.suspense_list"),j=Symbol.for("react.memo"),I=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var O=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var N=Symbol.iterator;function D(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=N&&e[N]||e["@@iterator"])?e:null}var L,z=Object.assign;function R(e){if(void 0===L)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);L=t&&t[1]||""}return"\n"+L+e}var F=!1;function B(e,t){if(!e||F)return"";F=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var i=c.stack.split("\n"),o=r.stack.split("\n"),a=i.length-1,s=o.length-1;1<=a&&0<=s&&i[a]!==o[s];)s--;for(;1<=a&&0<=s;a--,s--)if(i[a]!==o[s]){if(1!==a||1!==s)do{if(a--,0>--s||i[a]!==o[s]){var l="\n"+i[a].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=a&&0<=s);break}}}finally{F=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?R(e):""}function V(e){switch(e.tag){case 5:return R(e.type);case 16:return R("Lazy");case 13:return R("Suspense");case 19:return R("SuspenseList");case 0:case 2:case 15:return e=B(e.type,!1);case 11:return e=B(e.type.render,!1);case 1:return e=B(e.type,!0);default:return""}}function U(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case S:return"Fragment";case w:return"Portal";case E:return"Profiler";case T:return"StrictMode";case k:return"Suspense";case C:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case M:return(e.displayName||"Context")+".Consumer";case A:return(e._context.displayName||"Context")+".Provider";case P:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case j:return null!==(t=e.displayName||null)?t:U(e.type)||"Memo";case I:t=e._payload,e=e._init;try{return U(e(t))}catch(n){}}return null}function G(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return U(t);case 8:return t===T?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function H(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function Z(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function q(e){e._valueTracker||(e._valueTracker=function(e){var t=Z(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function W(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=Z(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function X(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Y(e,t){var n=t.checked;return z({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function K(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=H(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function J(e,t){null!=(t=t.checked)&&v(e,"checked",t,!1)}function Q(e,t){J(e,t);var n=H(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,H(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function $(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&X(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+H(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(o(91));return z({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ie(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(o(92));if(te(n)){if(1<n.length)throw Error(o(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:H(n)}}function oe(e,t){var n=H(t.value),r=H(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function ae(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function se(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?se(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,he=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return ue(e,t)}))}:ue);function de(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fe=["Webkit","ms","Moz","O"];function me(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=me(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(pe).forEach((function(e){fe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]}))}));var ye=z({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function _e(e,t){if(t){if(ye[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(o(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(o(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(o(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(o(62))}}function ve(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xe=null;function be(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var we=null,Se=null,Te=null;function Ee(e){if(e=vi(e)){if("function"!==typeof we)throw Error(o(280));var t=e.stateNode;t&&(t=bi(t),we(e.stateNode,e.type,t))}}function Ae(e){Se?Te?Te.push(e):Te=[e]:Se=e}function Me(){if(Se){var e=Se,t=Te;if(Te=Se=null,Ee(e),t)for(e=0;e<t.length;e++)Ee(t[e])}}function Pe(e,t){return e(t)}function ke(){}var Ce=!1;function je(e,t,n){if(Ce)return e(t,n);Ce=!0;try{return Pe(e,t,n)}finally{Ce=!1,(null!==Se||null!==Te)&&(ke(),Me())}}function Ie(e,t){var n=e.stateNode;if(null===n)return null;var r=bi(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(o(231,t,typeof n));return n}var Oe=!1;if(u)try{var Ne={};Object.defineProperty(Ne,"passive",{get:function(){Oe=!0}}),window.addEventListener("test",Ne,Ne),window.removeEventListener("test",Ne,Ne)}catch(ue){Oe=!1}function De(e,t,n,r,i,o,a,s,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(u){this.onError(u)}}var Le=!1,ze=null,Re=!1,Fe=null,Be={onError:function(e){Le=!0,ze=e}};function Ve(e,t,n,r,i,o,a,s,l){Le=!1,ze=null,De.apply(Be,arguments)}function Ue(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Ge(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function He(e){if(Ue(e)!==e)throw Error(o(188))}function Ze(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ue(e)))throw Error(o(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var a=i.alternate;if(null===a){if(null!==(r=i.return)){n=r;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===n)return He(i),e;if(a===r)return He(i),t;a=a.sibling}throw Error(o(188))}if(n.return!==r.return)n=i,r=a;else{for(var s=!1,l=i.child;l;){if(l===n){s=!0,n=i,r=a;break}if(l===r){s=!0,r=i,n=a;break}l=l.sibling}if(!s){for(l=a.child;l;){if(l===n){s=!0,n=a,r=i;break}if(l===r){s=!0,r=a,n=i;break}l=l.sibling}if(!s)throw Error(o(189))}}if(n.alternate!==r)throw Error(o(190))}if(3!==n.tag)throw Error(o(188));return n.stateNode.current===n?e:t}(e))?qe(e):null}function qe(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=qe(e);if(null!==t)return t;e=e.sibling}return null}var We=i.unstable_scheduleCallback,Xe=i.unstable_cancelCallback,Ye=i.unstable_shouldYield,Ke=i.unstable_requestPaint,Je=i.unstable_now,Qe=i.unstable_getCurrentPriorityLevel,$e=i.unstable_ImmediatePriority,et=i.unstable_UserBlockingPriority,tt=i.unstable_NormalPriority,nt=i.unstable_LowPriority,rt=i.unstable_IdlePriority,it=null,ot=null;var at=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(st(e)/lt|0)|0},st=Math.log,lt=Math.LN2;var ct=64,ut=4194304;function ht(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function dt(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,i=e.suspendedLanes,o=e.pingedLanes,a=268435455&n;if(0!==a){var s=a&~i;0!==s?r=ht(s):0!==(o&=a)&&(r=ht(o))}else 0!==(a=n&~i)?r=ht(a):0!==o&&(r=ht(o));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&i)&&((i=r&-r)>=(o=t&-t)||16===i&&0!==(4194240&o)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-at(t)),r|=e[n],t&=~i;return r}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ft(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function yt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-at(t)]=n}function _t(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-at(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var vt=0;function xt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var bt,wt,St,Tt,Et,At=!1,Mt=[],Pt=null,kt=null,Ct=null,jt=new Map,It=new Map,Ot=[],Nt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Dt(e,t){switch(e){case"focusin":case"focusout":Pt=null;break;case"dragenter":case"dragleave":kt=null;break;case"mouseover":case"mouseout":Ct=null;break;case"pointerover":case"pointerout":jt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":It.delete(t.pointerId)}}function Lt(e,t,n,r,i,o){return null===e||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},null!==t&&(null!==(t=vi(t))&&wt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function zt(e){var t=_i(e.target);if(null!==t){var n=Ue(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Ge(n)))return e.blockedOn=t,void Et(e.priority,(function(){St(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Rt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Yt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=vi(n))&&wt(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);xe=r,n.target.dispatchEvent(r),xe=null,t.shift()}return!0}function Ft(e,t,n){Rt(e)&&n.delete(t)}function Bt(){At=!1,null!==Pt&&Rt(Pt)&&(Pt=null),null!==kt&&Rt(kt)&&(kt=null),null!==Ct&&Rt(Ct)&&(Ct=null),jt.forEach(Ft),It.forEach(Ft)}function Vt(e,t){e.blockedOn===t&&(e.blockedOn=null,At||(At=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Bt)))}function Ut(e){function t(t){return Vt(t,e)}if(0<Mt.length){Vt(Mt[0],e);for(var n=1;n<Mt.length;n++){var r=Mt[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Pt&&Vt(Pt,e),null!==kt&&Vt(kt,e),null!==Ct&&Vt(Ct,e),jt.forEach(t),It.forEach(t),n=0;n<Ot.length;n++)(r=Ot[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Ot.length&&null===(n=Ot[0]).blockedOn;)zt(n),null===n.blockedOn&&Ot.shift()}var Gt=x.ReactCurrentBatchConfig,Ht=!0;function Zt(e,t,n,r){var i=vt,o=Gt.transition;Gt.transition=null;try{vt=1,Wt(e,t,n,r)}finally{vt=i,Gt.transition=o}}function qt(e,t,n,r){var i=vt,o=Gt.transition;Gt.transition=null;try{vt=4,Wt(e,t,n,r)}finally{vt=i,Gt.transition=o}}function Wt(e,t,n,r){if(Ht){var i=Yt(e,t,n,r);if(null===i)Hr(e,t,r,Xt,n),Dt(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return Pt=Lt(Pt,e,t,n,r,i),!0;case"dragenter":return kt=Lt(kt,e,t,n,r,i),!0;case"mouseover":return Ct=Lt(Ct,e,t,n,r,i),!0;case"pointerover":var o=i.pointerId;return jt.set(o,Lt(jt.get(o)||null,e,t,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,It.set(o,Lt(It.get(o)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(Dt(e,r),4&t&&-1<Nt.indexOf(e)){for(;null!==i;){var o=vi(i);if(null!==o&&bt(o),null===(o=Yt(e,t,n,r))&&Hr(e,t,r,Xt,n),o===i)break;i=o}null!==i&&r.stopPropagation()}else Hr(e,t,r,null,n)}}var Xt=null;function Yt(e,t,n,r){if(Xt=null,null!==(e=_i(e=be(r))))if(null===(t=Ue(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=Ge(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Xt=e,null}function Kt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Qe()){case $e:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Jt=null,Qt=null,$t=null;function en(){if($t)return $t;var e,t,n=Qt,r=n.length,i="value"in Jt?Jt.value:Jt.textContent,o=i.length;for(e=0;e<r&&n[e]===i[e];e++);var a=r-e;for(t=1;t<=a&&n[r-t]===i[o-t];t++);return $t=i.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function on(e){function t(t,n,r,i,o){for(var a in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null,e)e.hasOwnProperty(a)&&(t=e[a],this[a]=t?t(i):i[a]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return z(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var an,sn,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=on(cn),hn=z({},cn,{view:0,detail:0}),dn=on(hn),pn=z({},hn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:En,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(an=e.screenX-ln.screenX,sn=e.screenY-ln.screenY):sn=an=0,ln=e),an)},movementY:function(e){return"movementY"in e?e.movementY:sn}}),fn=on(pn),mn=on(z({},pn,{dataTransfer:0})),gn=on(z({},hn,{relatedTarget:0})),yn=on(z({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),_n=z({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),vn=on(_n),xn=on(z({},cn,{data:0})),bn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Sn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Tn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Sn[e])&&!!t[e]}function En(){return Tn}var An=z({},hn,{key:function(e){if(e.key){var t=bn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?wn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:En,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Mn=on(An),Pn=on(z({},pn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),kn=on(z({},hn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:En})),Cn=on(z({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),jn=z({},pn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),In=on(jn),On=[9,13,27,32],Nn=u&&"CompositionEvent"in window,Dn=null;u&&"documentMode"in document&&(Dn=document.documentMode);var Ln=u&&"TextEvent"in window&&!Dn,zn=u&&(!Nn||Dn&&8<Dn&&11>=Dn),Rn=String.fromCharCode(32),Fn=!1;function Bn(e,t){switch(e){case"keyup":return-1!==On.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Vn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Un=!1;var Gn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Gn[e.type]:"textarea"===t}function Zn(e,t,n,r){Ae(r),0<(t=qr(t,"onChange")).length&&(n=new un("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var qn=null,Wn=null;function Xn(e){Rr(e,0)}function Yn(e){if(W(xi(e)))return e}function Kn(e,t){if("change"===e)return t}var Jn=!1;if(u){var Qn;if(u){var $n="oninput"in document;if(!$n){var er=document.createElement("div");er.setAttribute("oninput","return;"),$n="function"===typeof er.oninput}Qn=$n}else Qn=!1;Jn=Qn&&(!document.documentMode||9<document.documentMode)}function tr(){qn&&(qn.detachEvent("onpropertychange",nr),Wn=qn=null)}function nr(e){if("value"===e.propertyName&&Yn(Wn)){var t=[];Zn(t,Wn,e,be(e)),je(Xn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Wn=n,(qn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ir(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Yn(Wn)}function or(e,t){if("click"===e)return Yn(t)}function ar(e,t){if("input"===e||"change"===e)return Yn(t)}var sr="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function lr(e,t){if(sr(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!h.call(t,i)||!sr(e[i],t[i]))return!1}return!0}function cr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ur(e,t){var n,r=cr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cr(r)}}function hr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?hr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function dr(){for(var e=window,t=X();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=X((e=t.contentWindow).document)}return t}function pr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function fr(e){var t=dr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&hr(n.ownerDocument.documentElement,n)){if(null!==r&&pr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=n.textContent.length,o=Math.min(r.start,i);r=void 0===r.end?o:Math.min(r.end,i),!e.extend&&o>r&&(i=r,r=o,o=i),i=ur(n,o);var a=ur(n,r);i&&a&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),o>r?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mr=u&&"documentMode"in document&&11>=document.documentMode,gr=null,yr=null,_r=null,vr=!1;function xr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;vr||null==gr||gr!==X(r)||("selectionStart"in(r=gr)&&pr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},_r&&lr(_r,r)||(_r=r,0<(r=qr(yr,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=gr)))}function br(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var wr={animationend:br("Animation","AnimationEnd"),animationiteration:br("Animation","AnimationIteration"),animationstart:br("Animation","AnimationStart"),transitionend:br("Transition","TransitionEnd")},Sr={},Tr={};function Er(e){if(Sr[e])return Sr[e];if(!wr[e])return e;var t,n=wr[e];for(t in n)if(n.hasOwnProperty(t)&&t in Tr)return Sr[e]=n[t];return e}u&&(Tr=document.createElement("div").style,"AnimationEvent"in window||(delete wr.animationend.animation,delete wr.animationiteration.animation,delete wr.animationstart.animation),"TransitionEvent"in window||delete wr.transitionend.transition);var Ar=Er("animationend"),Mr=Er("animationiteration"),Pr=Er("animationstart"),kr=Er("transitionend"),Cr=new Map,jr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ir(e,t){Cr.set(e,t),l(t,[e])}for(var Or=0;Or<jr.length;Or++){var Nr=jr[Or];Ir(Nr.toLowerCase(),"on"+(Nr[0].toUpperCase()+Nr.slice(1)))}Ir(Ar,"onAnimationEnd"),Ir(Mr,"onAnimationIteration"),Ir(Pr,"onAnimationStart"),Ir("dblclick","onDoubleClick"),Ir("focusin","onFocus"),Ir("focusout","onBlur"),Ir(kr,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Dr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Lr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Dr));function zr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,i,a,s,l,c){if(Ve.apply(this,arguments),Le){if(!Le)throw Error(o(198));var u=ze;Le=!1,ze=null,Re||(Re=!0,Fe=u)}}(r,t,void 0,e),e.currentTarget=null}function Rr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var o=void 0;if(t)for(var a=r.length-1;0<=a;a--){var s=r[a],l=s.instance,c=s.currentTarget;if(s=s.listener,l!==o&&i.isPropagationStopped())break e;zr(i,s,c),o=l}else for(a=0;a<r.length;a++){if(l=(s=r[a]).instance,c=s.currentTarget,s=s.listener,l!==o&&i.isPropagationStopped())break e;zr(i,s,c),o=l}}}if(Re)throw e=Fe,Re=!1,Fe=null,e}function Fr(e,t){var n=t[mi];void 0===n&&(n=t[mi]=new Set);var r=e+"__bubble";n.has(r)||(Gr(t,e,2,!1),n.add(r))}function Br(e,t,n){var r=0;t&&(r|=4),Gr(n,e,r,t)}var Vr="_reactListening"+Math.random().toString(36).slice(2);function Ur(e){if(!e[Vr]){e[Vr]=!0,a.forEach((function(t){"selectionchange"!==t&&(Lr.has(t)||Br(t,!1,e),Br(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Vr]||(t[Vr]=!0,Br("selectionchange",!1,t))}}function Gr(e,t,n,r){switch(Kt(t)){case 1:var i=Zt;break;case 4:i=qt;break;default:i=Wt}n=i.bind(null,t,n,e),i=void 0,!Oe||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function Hr(e,t,n,r,i){var o=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var a=r.tag;if(3===a||4===a){var s=r.stateNode.containerInfo;if(s===i||8===s.nodeType&&s.parentNode===i)break;if(4===a)for(a=r.return;null!==a;){var l=a.tag;if((3===l||4===l)&&((l=a.stateNode.containerInfo)===i||8===l.nodeType&&l.parentNode===i))return;a=a.return}for(;null!==s;){if(null===(a=_i(s)))return;if(5===(l=a.tag)||6===l){r=o=a;continue e}s=s.parentNode}}r=r.return}je((function(){var r=o,i=be(n),a=[];e:{var s=Cr.get(e);if(void 0!==s){var l=un,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=Mn;break;case"focusin":c="focus",l=gn;break;case"focusout":c="blur",l=gn;break;case"beforeblur":case"afterblur":l=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=fn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=kn;break;case Ar:case Mr:case Pr:l=yn;break;case kr:l=Cn;break;case"scroll":l=dn;break;case"wheel":l=In;break;case"copy":case"cut":case"paste":l=vn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Pn}var u=0!==(4&t),h=!u&&"scroll"===e,d=u?null!==s?s+"Capture":null:s;u=[];for(var p,f=r;null!==f;){var m=(p=f).stateNode;if(5===p.tag&&null!==m&&(p=m,null!==d&&(null!=(m=Ie(f,d))&&u.push(Zr(f,m,p)))),h)break;f=f.return}0<u.length&&(s=new l(s,c,null,n,i),a.push({event:s,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||n===xe||!(c=n.relatedTarget||n.fromElement)||!_i(c)&&!c[fi])&&(l||s)&&(s=i.window===i?i:(s=i.ownerDocument)?s.defaultView||s.parentWindow:window,l?(l=r,null!==(c=(c=n.relatedTarget||n.toElement)?_i(c):null)&&(c!==(h=Ue(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=r),l!==c)){if(u=fn,m="onMouseLeave",d="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(u=Pn,m="onPointerLeave",d="onPointerEnter",f="pointer"),h=null==l?s:xi(l),p=null==c?s:xi(c),(s=new u(m,f+"leave",l,n,i)).target=h,s.relatedTarget=p,m=null,_i(i)===r&&((u=new u(d,f+"enter",c,n,i)).target=p,u.relatedTarget=h,m=u),h=m,l&&c)e:{for(d=c,f=0,p=u=l;p;p=Wr(p))f++;for(p=0,m=d;m;m=Wr(m))p++;for(;0<f-p;)u=Wr(u),f--;for(;0<p-f;)d=Wr(d),p--;for(;f--;){if(u===d||null!==d&&u===d.alternate)break e;u=Wr(u),d=Wr(d)}u=null}else u=null;null!==l&&Xr(a,s,l,u,!1),null!==c&&null!==h&&Xr(a,h,c,u,!0)}if("select"===(l=(s=r?xi(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===l&&"file"===s.type)var g=Kn;else if(Hn(s))if(Jn)g=ar;else{g=ir;var y=rr}else(l=s.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(g=or);switch(g&&(g=g(e,r))?Zn(a,g,n,i):(y&&y(e,s,r),"focusout"===e&&(y=s._wrapperState)&&y.controlled&&"number"===s.type&&ee(s,"number",s.value)),y=r?xi(r):window,e){case"focusin":(Hn(y)||"true"===y.contentEditable)&&(gr=y,yr=r,_r=null);break;case"focusout":_r=yr=gr=null;break;case"mousedown":vr=!0;break;case"contextmenu":case"mouseup":case"dragend":vr=!1,xr(a,n,i);break;case"selectionchange":if(mr)break;case"keydown":case"keyup":xr(a,n,i)}var _;if(Nn)e:{switch(e){case"compositionstart":var v="onCompositionStart";break e;case"compositionend":v="onCompositionEnd";break e;case"compositionupdate":v="onCompositionUpdate";break e}v=void 0}else Un?Bn(e,n)&&(v="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(v="onCompositionStart");v&&(zn&&"ko"!==n.locale&&(Un||"onCompositionStart"!==v?"onCompositionEnd"===v&&Un&&(_=en()):(Qt="value"in(Jt=i)?Jt.value:Jt.textContent,Un=!0)),0<(y=qr(r,v)).length&&(v=new xn(v,e,null,n,i),a.push({event:v,listeners:y}),_?v.data=_:null!==(_=Vn(n))&&(v.data=_))),(_=Ln?function(e,t){switch(e){case"compositionend":return Vn(t);case"keypress":return 32!==t.which?null:(Fn=!0,Rn);case"textInput":return(e=t.data)===Rn&&Fn?null:e;default:return null}}(e,n):function(e,t){if(Un)return"compositionend"===e||!Nn&&Bn(e,t)?(e=en(),$t=Qt=Jt=null,Un=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return zn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=qr(r,"onBeforeInput")).length&&(i=new xn("onBeforeInput","beforeinput",null,n,i),a.push({event:i,listeners:r}),i.data=_))}Rr(a,t)}))}function Zr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function qr(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,o=i.stateNode;5===i.tag&&null!==o&&(i=o,null!=(o=Ie(e,n))&&r.unshift(Zr(e,o,i)),null!=(o=Ie(e,t))&&r.push(Zr(e,o,i))),e=e.return}return r}function Wr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Xr(e,t,n,r,i){for(var o=t._reactName,a=[];null!==n&&n!==r;){var s=n,l=s.alternate,c=s.stateNode;if(null!==l&&l===r)break;5===s.tag&&null!==c&&(s=c,i?null!=(l=Ie(n,o))&&a.unshift(Zr(n,l,s)):i||null!=(l=Ie(n,o))&&a.push(Zr(n,l,s))),n=n.return}0!==a.length&&e.push({event:t,listeners:a})}var Yr=/\r\n?/g,Kr=/\u0000|\uFFFD/g;function Jr(e){return("string"===typeof e?e:""+e).replace(Yr,"\n").replace(Kr,"")}function Qr(e,t,n){if(t=Jr(t),Jr(e)!==t&&n)throw Error(o(425))}function $r(){}var ei=null,ti=null;function ni(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ri="function"===typeof setTimeout?setTimeout:void 0,ii="function"===typeof clearTimeout?clearTimeout:void 0,oi="function"===typeof Promise?Promise:void 0,ai="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof oi?function(e){return oi.resolve(null).then(e).catch(si)}:ri;function si(e){setTimeout((function(){throw e}))}function li(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===r)return e.removeChild(i),void Ut(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=i}while(n);Ut(t)}function ci(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ui(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var hi=Math.random().toString(36).slice(2),di="__reactFiber$"+hi,pi="__reactProps$"+hi,fi="__reactContainer$"+hi,mi="__reactEvents$"+hi,gi="__reactListeners$"+hi,yi="__reactHandles$"+hi;function _i(e){var t=e[di];if(t)return t;for(var n=e.parentNode;n;){if(t=n[fi]||n[di]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ui(e);null!==e;){if(n=e[di])return n;e=ui(e)}return t}n=(e=n).parentNode}return null}function vi(e){return!(e=e[di]||e[fi])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function xi(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(o(33))}function bi(e){return e[pi]||null}var wi=[],Si=-1;function Ti(e){return{current:e}}function Ei(e){0>Si||(e.current=wi[Si],wi[Si]=null,Si--)}function Ai(e,t){Si++,wi[Si]=e.current,e.current=t}var Mi={},Pi=Ti(Mi),ki=Ti(!1),Ci=Mi;function ji(e,t){var n=e.type.contextTypes;if(!n)return Mi;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,o={};for(i in n)o[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function Ii(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Oi(){Ei(ki),Ei(Pi)}function Ni(e,t,n){if(Pi.current!==Mi)throw Error(o(168));Ai(Pi,t),Ai(ki,n)}function Di(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in t))throw Error(o(108,G(e)||"Unknown",i));return z({},n,r)}function Li(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Mi,Ci=Pi.current,Ai(Pi,e),Ai(ki,ki.current),!0}function zi(e,t,n){var r=e.stateNode;if(!r)throw Error(o(169));n?(e=Di(e,t,Ci),r.__reactInternalMemoizedMergedChildContext=e,Ei(ki),Ei(Pi),Ai(Pi,e)):Ei(ki),Ai(ki,n)}var Ri=null,Fi=!1,Bi=!1;function Vi(e){null===Ri?Ri=[e]:Ri.push(e)}function Ui(){if(!Bi&&null!==Ri){Bi=!0;var e=0,t=vt;try{var n=Ri;for(vt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Ri=null,Fi=!1}catch(i){throw null!==Ri&&(Ri=Ri.slice(e+1)),We($e,Ui),i}finally{vt=t,Bi=!1}}return null}var Gi=[],Hi=0,Zi=null,qi=0,Wi=[],Xi=0,Yi=null,Ki=1,Ji="";function Qi(e,t){Gi[Hi++]=qi,Gi[Hi++]=Zi,Zi=e,qi=t}function $i(e,t,n){Wi[Xi++]=Ki,Wi[Xi++]=Ji,Wi[Xi++]=Yi,Yi=e;var r=Ki;e=Ji;var i=32-at(r)-1;r&=~(1<<i),n+=1;var o=32-at(t)+i;if(30<o){var a=i-i%5;o=(r&(1<<a)-1).toString(32),r>>=a,i-=a,Ki=1<<32-at(t)+i|n<<i|r,Ji=o+e}else Ki=1<<o|n<<i|r,Ji=e}function eo(e){null!==e.return&&(Qi(e,1),$i(e,1,0))}function to(e){for(;e===Zi;)Zi=Gi[--Hi],Gi[Hi]=null,qi=Gi[--Hi],Gi[Hi]=null;for(;e===Yi;)Yi=Wi[--Xi],Wi[Xi]=null,Ji=Wi[--Xi],Wi[Xi]=null,Ki=Wi[--Xi],Wi[Xi]=null}var no=null,ro=null,io=!1,oo=null;function ao(e,t){var n=jc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function so(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,no=e,ro=ci(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,no=e,ro=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Yi?{id:Ki,overflow:Ji}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=jc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,no=e,ro=null,!0);default:return!1}}function lo(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function co(e){if(io){var t=ro;if(t){var n=t;if(!so(e,t)){if(lo(e))throw Error(o(418));t=ci(n.nextSibling);var r=no;t&&so(e,t)?ao(r,n):(e.flags=-4097&e.flags|2,io=!1,no=e)}}else{if(lo(e))throw Error(o(418));e.flags=-4097&e.flags|2,io=!1,no=e}}}function uo(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;no=e}function ho(e){if(e!==no)return!1;if(!io)return uo(e),io=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ni(e.type,e.memoizedProps)),t&&(t=ro)){if(lo(e))throw po(),Error(o(418));for(;t;)ao(e,t),t=ci(t.nextSibling)}if(uo(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(o(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ro=ci(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ro=null}}else ro=no?ci(e.stateNode.nextSibling):null;return!0}function po(){for(var e=ro;e;)e=ci(e.nextSibling)}function fo(){ro=no=null,io=!1}function mo(e){null===oo?oo=[e]:oo.push(e)}var go=x.ReactCurrentBatchConfig;function yo(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(o(309));var r=n.stateNode}if(!r)throw Error(o(147,e));var i=r,a=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===a?t.ref:(t=function(e){var t=i.refs;null===e?delete t[a]:t[a]=e},t._stringRef=a,t)}if("string"!==typeof e)throw Error(o(284));if(!n._owner)throw Error(o(290,e))}return e}function _o(e,t){throw e=Object.prototype.toString.call(t),Error(o(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function vo(e){return(0,e._init)(e._payload)}function xo(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Oc(e,t)).index=0,e.sibling=null,e}function a(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=zc(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function c(e,t,n,r){var o=n.type;return o===S?h(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===o||"object"===typeof o&&null!==o&&o.$$typeof===I&&vo(o)===t.type)?((r=i(t,n.props)).ref=yo(e,t,n),r.return=e,r):((r=Nc(n.type,n.key,n.props,null,e.mode,r)).ref=yo(e,t,n),r.return=e,r)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Rc(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function h(e,t,n,r,o){return null===t||7!==t.tag?((t=Dc(n,e.mode,r,o)).return=e,t):((t=i(t,n)).return=e,t)}function d(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=zc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case b:return(n=Nc(t.type,t.key,t.props,null,e.mode,n)).ref=yo(e,null,t),n.return=e,n;case w:return(t=Rc(t,e.mode,n)).return=e,t;case I:return d(e,(0,t._init)(t._payload),n)}if(te(t)||D(t))return(t=Dc(t,e.mode,n,null)).return=e,t;_o(e,t)}return null}function p(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==i?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case b:return n.key===i?c(e,t,n,r):null;case w:return n.key===i?u(e,t,n,r):null;case I:return p(e,t,(i=n._init)(n._payload),r)}if(te(n)||D(n))return null!==i?null:h(e,t,n,r,null);_o(e,n)}return null}function f(e,t,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r)return l(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case b:return c(t,e=e.get(null===r.key?n:r.key)||null,r,i);case w:return u(t,e=e.get(null===r.key?n:r.key)||null,r,i);case I:return f(e,t,n,(0,r._init)(r._payload),i)}if(te(r)||D(r))return h(t,e=e.get(n)||null,r,i,null);_o(t,r)}return null}function m(i,o,s,l){for(var c=null,u=null,h=o,m=o=0,g=null;null!==h&&m<s.length;m++){h.index>m?(g=h,h=null):g=h.sibling;var y=p(i,h,s[m],l);if(null===y){null===h&&(h=g);break}e&&h&&null===y.alternate&&t(i,h),o=a(y,o,m),null===u?c=y:u.sibling=y,u=y,h=g}if(m===s.length)return n(i,h),io&&Qi(i,m),c;if(null===h){for(;m<s.length;m++)null!==(h=d(i,s[m],l))&&(o=a(h,o,m),null===u?c=h:u.sibling=h,u=h);return io&&Qi(i,m),c}for(h=r(i,h);m<s.length;m++)null!==(g=f(h,i,m,s[m],l))&&(e&&null!==g.alternate&&h.delete(null===g.key?m:g.key),o=a(g,o,m),null===u?c=g:u.sibling=g,u=g);return e&&h.forEach((function(e){return t(i,e)})),io&&Qi(i,m),c}function g(i,s,l,c){var u=D(l);if("function"!==typeof u)throw Error(o(150));if(null==(l=u.call(l)))throw Error(o(151));for(var h=u=null,m=s,g=s=0,y=null,_=l.next();null!==m&&!_.done;g++,_=l.next()){m.index>g?(y=m,m=null):y=m.sibling;var v=p(i,m,_.value,c);if(null===v){null===m&&(m=y);break}e&&m&&null===v.alternate&&t(i,m),s=a(v,s,g),null===h?u=v:h.sibling=v,h=v,m=y}if(_.done)return n(i,m),io&&Qi(i,g),u;if(null===m){for(;!_.done;g++,_=l.next())null!==(_=d(i,_.value,c))&&(s=a(_,s,g),null===h?u=_:h.sibling=_,h=_);return io&&Qi(i,g),u}for(m=r(i,m);!_.done;g++,_=l.next())null!==(_=f(m,i,g,_.value,c))&&(e&&null!==_.alternate&&m.delete(null===_.key?g:_.key),s=a(_,s,g),null===h?u=_:h.sibling=_,h=_);return e&&m.forEach((function(e){return t(i,e)})),io&&Qi(i,g),u}return function e(r,o,a,l){if("object"===typeof a&&null!==a&&a.type===S&&null===a.key&&(a=a.props.children),"object"===typeof a&&null!==a){switch(a.$$typeof){case b:e:{for(var c=a.key,u=o;null!==u;){if(u.key===c){if((c=a.type)===S){if(7===u.tag){n(r,u.sibling),(o=i(u,a.props.children)).return=r,r=o;break e}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===I&&vo(c)===u.type){n(r,u.sibling),(o=i(u,a.props)).ref=yo(r,u,a),o.return=r,r=o;break e}n(r,u);break}t(r,u),u=u.sibling}a.type===S?((o=Dc(a.props.children,r.mode,l,a.key)).return=r,r=o):((l=Nc(a.type,a.key,a.props,null,r.mode,l)).ref=yo(r,o,a),l.return=r,r=l)}return s(r);case w:e:{for(u=a.key;null!==o;){if(o.key===u){if(4===o.tag&&o.stateNode.containerInfo===a.containerInfo&&o.stateNode.implementation===a.implementation){n(r,o.sibling),(o=i(o,a.children||[])).return=r,r=o;break e}n(r,o);break}t(r,o),o=o.sibling}(o=Rc(a,r.mode,l)).return=r,r=o}return s(r);case I:return e(r,o,(u=a._init)(a._payload),l)}if(te(a))return m(r,o,a,l);if(D(a))return g(r,o,a,l);_o(r,a)}return"string"===typeof a&&""!==a||"number"===typeof a?(a=""+a,null!==o&&6===o.tag?(n(r,o.sibling),(o=i(o,a)).return=r,r=o):(n(r,o),(o=zc(a,r.mode,l)).return=r,r=o),s(r)):n(r,o)}}var bo=xo(!0),wo=xo(!1),So=Ti(null),To=null,Eo=null,Ao=null;function Mo(){Ao=Eo=To=null}function Po(e){var t=So.current;Ei(So),e._currentValue=t}function ko(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Co(e,t){To=e,Ao=Eo=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(vs=!0),e.firstContext=null)}function jo(e){var t=e._currentValue;if(Ao!==e)if(e={context:e,memoizedValue:t,next:null},null===Eo){if(null===To)throw Error(o(308));Eo=e,To.dependencies={lanes:0,firstContext:e}}else Eo=Eo.next=e;return t}var Io=null;function Oo(e){null===Io?Io=[e]:Io.push(e)}function No(e,t,n,r){var i=t.interleaved;return null===i?(n.next=n,Oo(t)):(n.next=i.next,i.next=n),t.interleaved=n,Do(e,r)}function Do(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Lo=!1;function zo(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ro(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Fo(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Bo(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Pl)){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,Do(e,n)}return null===(i=r.interleaved)?(t.next=t,Oo(r)):(t.next=i.next,i.next=t),r.interleaved=t,Do(e,n)}function Vo(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,_t(e,n)}}function Uo(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,o=null;if(null!==(n=n.firstBaseUpdate)){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===o?i=o=a:o=o.next=a,n=n.next}while(null!==n);null===o?i=o=t:o=o.next=t}else i=o=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Go(e,t,n,r){var i=e.updateQueue;Lo=!1;var o=i.firstBaseUpdate,a=i.lastBaseUpdate,s=i.shared.pending;if(null!==s){i.shared.pending=null;var l=s,c=l.next;l.next=null,null===a?o=c:a.next=c,a=l;var u=e.alternate;null!==u&&((s=(u=u.updateQueue).lastBaseUpdate)!==a&&(null===s?u.firstBaseUpdate=c:s.next=c,u.lastBaseUpdate=l))}if(null!==o){var h=i.baseState;for(a=0,u=c=l=null,s=o;;){var d=s.lane,p=s.eventTime;if((r&d)===d){null!==u&&(u=u.next={eventTime:p,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var f=e,m=s;switch(d=t,p=n,m.tag){case 1:if("function"===typeof(f=m.payload)){h=f.call(p,h,d);break e}h=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null===(d="function"===typeof(f=m.payload)?f.call(p,h,d):f)||void 0===d)break e;h=z({},h,d);break e;case 2:Lo=!0}}null!==s.callback&&0!==s.lane&&(e.flags|=64,null===(d=i.effects)?i.effects=[s]:d.push(s))}else p={eventTime:p,lane:d,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===u?(c=u=p,l=h):u=u.next=p,a|=d;if(null===(s=s.next)){if(null===(s=i.shared.pending))break;s=(d=s).next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}if(null===u&&(l=h),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,null!==(t=i.shared.interleaved)){i=t;do{a|=i.lane,i=i.next}while(i!==t)}else null===o&&(i.shared.lanes=0);Ll|=a,e.lanes=a,e.memoizedState=h}}function Ho(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!==typeof i)throw Error(o(191,i));i.call(r)}}}var Zo={},qo=Ti(Zo),Wo=Ti(Zo),Xo=Ti(Zo);function Yo(e){if(e===Zo)throw Error(o(174));return e}function Ko(e,t){switch(Ai(Xo,t),Ai(Wo,e),Ai(qo,Zo),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Ei(qo),Ai(qo,t)}function Jo(){Ei(qo),Ei(Wo),Ei(Xo)}function Qo(e){Yo(Xo.current);var t=Yo(qo.current),n=le(t,e.type);t!==n&&(Ai(Wo,e),Ai(qo,n))}function $o(e){Wo.current===e&&(Ei(qo),Ei(Wo))}var ea=Ti(0);function ta(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var na=[];function ra(){for(var e=0;e<na.length;e++)na[e]._workInProgressVersionPrimary=null;na.length=0}var ia=x.ReactCurrentDispatcher,oa=x.ReactCurrentBatchConfig,aa=0,sa=null,la=null,ca=null,ua=!1,ha=!1,da=0,pa=0;function fa(){throw Error(o(321))}function ma(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!sr(e[n],t[n]))return!1;return!0}function ga(e,t,n,r,i,a){if(aa=a,sa=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ia.current=null===e||null===e.memoizedState?$a:es,e=n(r,i),ha){a=0;do{if(ha=!1,da=0,25<=a)throw Error(o(301));a+=1,ca=la=null,t.updateQueue=null,ia.current=ts,e=n(r,i)}while(ha)}if(ia.current=Qa,t=null!==la&&null!==la.next,aa=0,ca=la=sa=null,ua=!1,t)throw Error(o(300));return e}function ya(){var e=0!==da;return da=0,e}function _a(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ca?sa.memoizedState=ca=e:ca=ca.next=e,ca}function va(){if(null===la){var e=sa.alternate;e=null!==e?e.memoizedState:null}else e=la.next;var t=null===ca?sa.memoizedState:ca.next;if(null!==t)ca=t,la=e;else{if(null===e)throw Error(o(310));e={memoizedState:(la=e).memoizedState,baseState:la.baseState,baseQueue:la.baseQueue,queue:la.queue,next:null},null===ca?sa.memoizedState=ca=e:ca=ca.next=e}return ca}function xa(e,t){return"function"===typeof t?t(e):t}function ba(e){var t=va(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var r=la,i=r.baseQueue,a=n.pending;if(null!==a){if(null!==i){var s=i.next;i.next=a.next,a.next=s}r.baseQueue=i=a,n.pending=null}if(null!==i){a=i.next,r=r.baseState;var l=s=null,c=null,u=a;do{var h=u.lane;if((aa&h)===h)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=d,s=r):c=c.next=d,sa.lanes|=h,Ll|=h}u=u.next}while(null!==u&&u!==a);null===c?s=r:c.next=l,sr(r,t.memoizedState)||(vs=!0),t.memoizedState=r,t.baseState=s,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){i=e;do{a=i.lane,sa.lanes|=a,Ll|=a,i=i.next}while(i!==e)}else null===i&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function wa(e){var t=va(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,a=t.memoizedState;if(null!==i){n.pending=null;var s=i=i.next;do{a=e(a,s.action),s=s.next}while(s!==i);sr(a,t.memoizedState)||(vs=!0),t.memoizedState=a,null===t.baseQueue&&(t.baseState=a),n.lastRenderedState=a}return[a,r]}function Sa(){}function Ta(e,t){var n=sa,r=va(),i=t(),a=!sr(r.memoizedState,i);if(a&&(r.memoizedState=i,vs=!0),r=r.queue,La(Ma.bind(null,n,r,e),[e]),r.getSnapshot!==t||a||null!==ca&&1&ca.memoizedState.tag){if(n.flags|=2048,ja(9,Aa.bind(null,n,r,i,t),void 0,null),null===kl)throw Error(o(349));0!==(30&aa)||Ea(n,t,i)}return i}function Ea(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=sa.updateQueue)?(t={lastEffect:null,stores:null},sa.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Aa(e,t,n,r){t.value=n,t.getSnapshot=r,Pa(t)&&ka(e)}function Ma(e,t,n){return n((function(){Pa(t)&&ka(e)}))}function Pa(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!sr(e,n)}catch(r){return!0}}function ka(e){var t=Do(e,1);null!==t&&nc(t,e,1,-1)}function Ca(e){var t=_a();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:xa,lastRenderedState:e},t.queue=e,e=e.dispatch=Xa.bind(null,sa,e),[t.memoizedState,e]}function ja(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=sa.updateQueue)?(t={lastEffect:null,stores:null},sa.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Ia(){return va().memoizedState}function Oa(e,t,n,r){var i=_a();sa.flags|=e,i.memoizedState=ja(1|t,n,void 0,void 0===r?null:r)}function Na(e,t,n,r){var i=va();r=void 0===r?null:r;var o=void 0;if(null!==la){var a=la.memoizedState;if(o=a.destroy,null!==r&&ma(r,a.deps))return void(i.memoizedState=ja(t,n,o,r))}sa.flags|=e,i.memoizedState=ja(1|t,n,o,r)}function Da(e,t){return Oa(8390656,8,e,t)}function La(e,t){return Na(2048,8,e,t)}function za(e,t){return Na(4,2,e,t)}function Ra(e,t){return Na(4,4,e,t)}function Fa(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Ba(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Na(4,4,Fa.bind(null,t,e),n)}function Va(){}function Ua(e,t){var n=va();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ma(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Ga(e,t){var n=va();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ma(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Ha(e,t,n){return 0===(21&aa)?(e.baseState&&(e.baseState=!1,vs=!0),e.memoizedState=n):(sr(n,t)||(n=mt(),sa.lanes|=n,Ll|=n,e.baseState=!0),t)}function Za(e,t){var n=vt;vt=0!==n&&4>n?n:4,e(!0);var r=oa.transition;oa.transition={};try{e(!1),t()}finally{vt=n,oa.transition=r}}function qa(){return va().memoizedState}function Wa(e,t,n){var r=tc(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Ya(e))Ka(t,n);else if(null!==(n=No(e,t,n,r))){nc(n,e,r,ec()),Ja(n,t,r)}}function Xa(e,t,n){var r=tc(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Ya(e))Ka(t,i);else{var o=e.alternate;if(0===e.lanes&&(null===o||0===o.lanes)&&null!==(o=t.lastRenderedReducer))try{var a=t.lastRenderedState,s=o(a,n);if(i.hasEagerState=!0,i.eagerState=s,sr(s,a)){var l=t.interleaved;return null===l?(i.next=i,Oo(t)):(i.next=l.next,l.next=i),void(t.interleaved=i)}}catch(c){}null!==(n=No(e,t,i,r))&&(nc(n,e,r,i=ec()),Ja(n,t,r))}}function Ya(e){var t=e.alternate;return e===sa||null!==t&&t===sa}function Ka(e,t){ha=ua=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Ja(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,_t(e,n)}}var Qa={readContext:jo,useCallback:fa,useContext:fa,useEffect:fa,useImperativeHandle:fa,useInsertionEffect:fa,useLayoutEffect:fa,useMemo:fa,useReducer:fa,useRef:fa,useState:fa,useDebugValue:fa,useDeferredValue:fa,useTransition:fa,useMutableSource:fa,useSyncExternalStore:fa,useId:fa,unstable_isNewReconciler:!1},$a={readContext:jo,useCallback:function(e,t){return _a().memoizedState=[e,void 0===t?null:t],e},useContext:jo,useEffect:Da,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Oa(4194308,4,Fa.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Oa(4194308,4,e,t)},useInsertionEffect:function(e,t){return Oa(4,2,e,t)},useMemo:function(e,t){var n=_a();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=_a();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Wa.bind(null,sa,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},_a().memoizedState=e},useState:Ca,useDebugValue:Va,useDeferredValue:function(e){return _a().memoizedState=e},useTransition:function(){var e=Ca(!1),t=e[0];return e=Za.bind(null,e[1]),_a().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=sa,i=_a();if(io){if(void 0===n)throw Error(o(407));n=n()}else{if(n=t(),null===kl)throw Error(o(349));0!==(30&aa)||Ea(r,t,n)}i.memoizedState=n;var a={value:n,getSnapshot:t};return i.queue=a,Da(Ma.bind(null,r,a,e),[e]),r.flags|=2048,ja(9,Aa.bind(null,r,a,n,t),void 0,null),n},useId:function(){var e=_a(),t=kl.identifierPrefix;if(io){var n=Ji;t=":"+t+"R"+(n=(Ki&~(1<<32-at(Ki)-1)).toString(32)+n),0<(n=da++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=pa++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},es={readContext:jo,useCallback:Ua,useContext:jo,useEffect:La,useImperativeHandle:Ba,useInsertionEffect:za,useLayoutEffect:Ra,useMemo:Ga,useReducer:ba,useRef:Ia,useState:function(){return ba(xa)},useDebugValue:Va,useDeferredValue:function(e){return Ha(va(),la.memoizedState,e)},useTransition:function(){return[ba(xa)[0],va().memoizedState]},useMutableSource:Sa,useSyncExternalStore:Ta,useId:qa,unstable_isNewReconciler:!1},ts={readContext:jo,useCallback:Ua,useContext:jo,useEffect:La,useImperativeHandle:Ba,useInsertionEffect:za,useLayoutEffect:Ra,useMemo:Ga,useReducer:wa,useRef:Ia,useState:function(){return wa(xa)},useDebugValue:Va,useDeferredValue:function(e){var t=va();return null===la?t.memoizedState=e:Ha(t,la.memoizedState,e)},useTransition:function(){return[wa(xa)[0],va().memoizedState]},useMutableSource:Sa,useSyncExternalStore:Ta,useId:qa,unstable_isNewReconciler:!1};function ns(e,t){if(e&&e.defaultProps){for(var n in t=z({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function rs(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:z({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var is={isMounted:function(e){return!!(e=e._reactInternals)&&Ue(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=ec(),i=tc(e),o=Fo(r,i);o.payload=t,void 0!==n&&null!==n&&(o.callback=n),null!==(t=Bo(e,o,i))&&(nc(t,e,i,r),Vo(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=ec(),i=tc(e),o=Fo(r,i);o.tag=1,o.payload=t,void 0!==n&&null!==n&&(o.callback=n),null!==(t=Bo(e,o,i))&&(nc(t,e,i,r),Vo(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ec(),r=tc(e),i=Fo(n,r);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),null!==(t=Bo(e,i,r))&&(nc(t,e,r,n),Vo(t,e,r))}};function os(e,t,n,r,i,o,a){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,o,a):!t.prototype||!t.prototype.isPureReactComponent||(!lr(n,r)||!lr(i,o))}function as(e,t,n){var r=!1,i=Mi,o=t.contextType;return"object"===typeof o&&null!==o?o=jo(o):(i=Ii(t)?Ci:Pi.current,o=(r=null!==(r=t.contextTypes)&&void 0!==r)?ji(e,i):Mi),t=new t(n,o),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=is,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=o),t}function ss(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&is.enqueueReplaceState(t,t.state,null)}function ls(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},zo(e);var o=t.contextType;"object"===typeof o&&null!==o?i.context=jo(o):(o=Ii(t)?Ci:Pi.current,i.context=ji(e,o)),i.state=e.memoizedState,"function"===typeof(o=t.getDerivedStateFromProps)&&(rs(e,t,o,n),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&is.enqueueReplaceState(i,i.state,null),Go(e,n,i,r),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4194308)}function cs(e,t){try{var n="",r=t;do{n+=V(r),r=r.return}while(r);var i=n}catch(o){i="\nError generating stack: "+o.message+"\n"+o.stack}return{value:e,source:t,stack:i,digest:null}}function us(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function hs(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var ds="function"===typeof WeakMap?WeakMap:Map;function ps(e,t,n){(n=Fo(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Hl||(Hl=!0,Zl=r),hs(0,t)},n}function fs(e,t,n){(n=Fo(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){hs(0,t)}}var o=e.stateNode;return null!==o&&"function"===typeof o.componentDidCatch&&(n.callback=function(){hs(0,t),"function"!==typeof r&&(null===ql?ql=new Set([this]):ql.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function ms(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new ds;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=Ec.bind(null,e,t,n),t.then(e,e))}function gs(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function ys(e,t,n,r,i){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Fo(-1,1)).tag=2,Bo(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var _s=x.ReactCurrentOwner,vs=!1;function xs(e,t,n,r){t.child=null===e?wo(t,null,n,r):bo(t,e.child,n,r)}function bs(e,t,n,r,i){n=n.render;var o=t.ref;return Co(t,i),r=ga(e,t,n,r,o,i),n=ya(),null===e||vs?(io&&n&&eo(t),t.flags|=1,xs(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Hs(e,t,i))}function ws(e,t,n,r,i){if(null===e){var o=n.type;return"function"!==typeof o||Ic(o)||void 0!==o.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Nc(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=o,Ss(e,t,o,r,i))}if(o=e.child,0===(e.lanes&i)){var a=o.memoizedProps;if((n=null!==(n=n.compare)?n:lr)(a,r)&&e.ref===t.ref)return Hs(e,t,i)}return t.flags|=1,(e=Oc(o,r)).ref=t.ref,e.return=t,t.child=e}function Ss(e,t,n,r,i){if(null!==e){var o=e.memoizedProps;if(lr(o,r)&&e.ref===t.ref){if(vs=!1,t.pendingProps=r=o,0===(e.lanes&i))return t.lanes=e.lanes,Hs(e,t,i);0!==(131072&e.flags)&&(vs=!0)}}return As(e,t,n,r,i)}function Ts(e,t,n){var r=t.pendingProps,i=r.children,o=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ai(Ol,Il),Il|=n;else{if(0===(1073741824&n))return e=null!==o?o.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ai(Ol,Il),Il|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==o?o.baseLanes:n,Ai(Ol,Il),Il|=r}else null!==o?(r=o.baseLanes|n,t.memoizedState=null):r=n,Ai(Ol,Il),Il|=r;return xs(e,t,i,n),t.child}function Es(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function As(e,t,n,r,i){var o=Ii(n)?Ci:Pi.current;return o=ji(t,o),Co(t,i),n=ga(e,t,n,r,o,i),r=ya(),null===e||vs?(io&&r&&eo(t),t.flags|=1,xs(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Hs(e,t,i))}function Ms(e,t,n,r,i){if(Ii(n)){var o=!0;Li(t)}else o=!1;if(Co(t,i),null===t.stateNode)Gs(e,t),as(t,n,r),ls(t,n,r,i),r=!0;else if(null===e){var a=t.stateNode,s=t.memoizedProps;a.props=s;var l=a.context,c=n.contextType;"object"===typeof c&&null!==c?c=jo(c):c=ji(t,c=Ii(n)?Ci:Pi.current);var u=n.getDerivedStateFromProps,h="function"===typeof u||"function"===typeof a.getSnapshotBeforeUpdate;h||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==r||l!==c)&&ss(t,a,r,c),Lo=!1;var d=t.memoizedState;a.state=d,Go(t,r,a,i),l=t.memoizedState,s!==r||d!==l||ki.current||Lo?("function"===typeof u&&(rs(t,n,u,r),l=t.memoizedState),(s=Lo||os(t,n,s,r,d,l,c))?(h||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(t.flags|=4194308)):("function"===typeof a.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),a.props=r,a.state=l,a.context=c,r=s):("function"===typeof a.componentDidMount&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,Ro(e,t),s=t.memoizedProps,c=t.type===t.elementType?s:ns(t.type,s),a.props=c,h=t.pendingProps,d=a.context,"object"===typeof(l=n.contextType)&&null!==l?l=jo(l):l=ji(t,l=Ii(n)?Ci:Pi.current);var p=n.getDerivedStateFromProps;(u="function"===typeof p||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==h||d!==l)&&ss(t,a,r,l),Lo=!1,d=t.memoizedState,a.state=d,Go(t,r,a,i);var f=t.memoizedState;s!==h||d!==f||ki.current||Lo?("function"===typeof p&&(rs(t,n,p,r),f=t.memoizedState),(c=Lo||os(t,n,c,r,d,f,l)||!1)?(u||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(r,f,l),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(r,f,l)),"function"===typeof a.componentDidUpdate&&(t.flags|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof a.componentDidUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=f),a.props=r,a.state=f,a.context=l,r=c):("function"!==typeof a.componentDidUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),r=!1)}return Ps(e,t,n,r,o,i)}function Ps(e,t,n,r,i,o){Es(e,t);var a=0!==(128&t.flags);if(!r&&!a)return i&&zi(t,n,!1),Hs(e,t,o);r=t.stateNode,_s.current=t;var s=a&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&a?(t.child=bo(t,e.child,null,o),t.child=bo(t,null,s,o)):xs(e,t,s,o),t.memoizedState=r.state,i&&zi(t,n,!0),t.child}function ks(e){var t=e.stateNode;t.pendingContext?Ni(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Ni(0,t.context,!1),Ko(e,t.containerInfo)}function Cs(e,t,n,r,i){return fo(),mo(i),t.flags|=256,xs(e,t,n,r),t.child}var js,Is,Os,Ns,Ds={dehydrated:null,treeContext:null,retryLane:0};function Ls(e){return{baseLanes:e,cachePool:null,transitions:null}}function zs(e,t,n){var r,i=t.pendingProps,a=ea.current,s=!1,l=0!==(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&0!==(2&a)),r?(s=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(a|=1),Ai(ea,1&a),null===e)return co(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=i.children,e=i.fallback,s?(i=t.mode,s=t.child,l={mode:"hidden",children:l},0===(1&i)&&null!==s?(s.childLanes=0,s.pendingProps=l):s=Lc(l,i,0,null),e=Dc(e,i,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Ls(n),t.memoizedState=Ds,e):Rs(t,l));if(null!==(a=e.memoizedState)&&null!==(r=a.dehydrated))return function(e,t,n,r,i,a,s){if(n)return 256&t.flags?(t.flags&=-257,Fs(e,t,s,r=us(Error(o(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(a=r.fallback,i=t.mode,r=Lc({mode:"visible",children:r.children},i,0,null),(a=Dc(a,i,s,null)).flags|=2,r.return=t,a.return=t,r.sibling=a,t.child=r,0!==(1&t.mode)&&bo(t,e.child,null,s),t.child.memoizedState=Ls(s),t.memoizedState=Ds,a);if(0===(1&t.mode))return Fs(e,t,s,null);if("$!"===i.data){if(r=i.nextSibling&&i.nextSibling.dataset)var l=r.dgst;return r=l,Fs(e,t,s,r=us(a=Error(o(419)),r,void 0))}if(l=0!==(s&e.childLanes),vs||l){if(null!==(r=kl)){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=0!==(i&(r.suspendedLanes|s))?0:i)&&i!==a.retryLane&&(a.retryLane=i,Do(e,i),nc(r,e,i,-1))}return mc(),Fs(e,t,s,r=us(Error(o(421))))}return"$?"===i.data?(t.flags|=128,t.child=e.child,t=Mc.bind(null,e),i._reactRetry=t,null):(e=a.treeContext,ro=ci(i.nextSibling),no=t,io=!0,oo=null,null!==e&&(Wi[Xi++]=Ki,Wi[Xi++]=Ji,Wi[Xi++]=Yi,Ki=e.id,Ji=e.overflow,Yi=t),t=Rs(t,r.children),t.flags|=4096,t)}(e,t,l,i,r,a,n);if(s){s=i.fallback,l=t.mode,r=(a=e.child).sibling;var c={mode:"hidden",children:i.children};return 0===(1&l)&&t.child!==a?((i=t.child).childLanes=0,i.pendingProps=c,t.deletions=null):(i=Oc(a,c)).subtreeFlags=14680064&a.subtreeFlags,null!==r?s=Oc(r,s):(s=Dc(s,l,n,null)).flags|=2,s.return=t,i.return=t,i.sibling=s,t.child=i,i=s,s=t.child,l=null===(l=e.child.memoizedState)?Ls(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},s.memoizedState=l,s.childLanes=e.childLanes&~n,t.memoizedState=Ds,i}return e=(s=e.child).sibling,i=Oc(s,{mode:"visible",children:i.children}),0===(1&t.mode)&&(i.lanes=n),i.return=t,i.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function Rs(e,t){return(t=Lc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Fs(e,t,n,r){return null!==r&&mo(r),bo(t,e.child,null,n),(e=Rs(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Bs(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),ko(e.return,t,n)}function Vs(e,t,n,r,i){var o=e.memoizedState;null===o?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i)}function Us(e,t,n){var r=t.pendingProps,i=r.revealOrder,o=r.tail;if(xs(e,t,r.children,n),0!==(2&(r=ea.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Bs(e,n,t);else if(19===e.tag)Bs(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ai(ea,r),0===(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===ta(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Vs(t,!1,i,n,o);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===ta(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Vs(t,!0,n,null,o);break;case"together":Vs(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Gs(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Hs(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Ll|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(o(153));if(null!==t.child){for(n=Oc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Oc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Zs(e,t){if(!io)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function qs(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=14680064&i.subtreeFlags,r|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Ws(e,t,n){var r=t.pendingProps;switch(to(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return qs(t),null;case 1:case 17:return Ii(t.type)&&Oi(),qs(t),null;case 3:return r=t.stateNode,Jo(),Ei(ki),Ei(Pi),ra(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(ho(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==oo&&(ac(oo),oo=null))),Is(e,t),qs(t),null;case 5:$o(t);var i=Yo(Xo.current);if(n=t.type,null!==e&&null!=t.stateNode)Os(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(o(166));return qs(t),null}if(e=Yo(qo.current),ho(t)){r=t.stateNode,n=t.type;var a=t.memoizedProps;switch(r[di]=t,r[pi]=a,e=0!==(1&t.mode),n){case"dialog":Fr("cancel",r),Fr("close",r);break;case"iframe":case"object":case"embed":Fr("load",r);break;case"video":case"audio":for(i=0;i<Dr.length;i++)Fr(Dr[i],r);break;case"source":Fr("error",r);break;case"img":case"image":case"link":Fr("error",r),Fr("load",r);break;case"details":Fr("toggle",r);break;case"input":K(r,a),Fr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},Fr("invalid",r);break;case"textarea":ie(r,a),Fr("invalid",r)}for(var l in _e(n,a),i=null,a)if(a.hasOwnProperty(l)){var c=a[l];"children"===l?"string"===typeof c?r.textContent!==c&&(!0!==a.suppressHydrationWarning&&Qr(r.textContent,c,e),i=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==a.suppressHydrationWarning&&Qr(r.textContent,c,e),i=["children",""+c]):s.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Fr("scroll",r)}switch(n){case"input":q(r),$(r,a,!0);break;case"textarea":q(r),ae(r);break;case"select":case"option":break;default:"function"===typeof a.onClick&&(r.onclick=$r)}r=i,t.updateQueue=r,null!==r&&(t.flags|=4)}else{l=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=se(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[di]=t,e[pi]=r,js(e,t,!1,!1),t.stateNode=e;e:{switch(l=ve(n,r),n){case"dialog":Fr("cancel",e),Fr("close",e),i=r;break;case"iframe":case"object":case"embed":Fr("load",e),i=r;break;case"video":case"audio":for(i=0;i<Dr.length;i++)Fr(Dr[i],e);i=r;break;case"source":Fr("error",e),i=r;break;case"img":case"image":case"link":Fr("error",e),Fr("load",e),i=r;break;case"details":Fr("toggle",e),i=r;break;case"input":K(e,r),i=Y(e,r),Fr("invalid",e);break;case"option":default:i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=z({},r,{value:void 0}),Fr("invalid",e);break;case"textarea":ie(e,r),i=re(e,r),Fr("invalid",e)}for(a in _e(n,i),c=i)if(c.hasOwnProperty(a)){var u=c[a];"style"===a?ge(e,u):"dangerouslySetInnerHTML"===a?null!=(u=u?u.__html:void 0)&&he(e,u):"children"===a?"string"===typeof u?("textarea"!==n||""!==u)&&de(e,u):"number"===typeof u&&de(e,""+u):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(s.hasOwnProperty(a)?null!=u&&"onScroll"===a&&Fr("scroll",e):null!=u&&v(e,a,u,l))}switch(n){case"input":q(e),$(e,r,!1);break;case"textarea":q(e),ae(e);break;case"option":null!=r.value&&e.setAttribute("value",""+H(r.value));break;case"select":e.multiple=!!r.multiple,null!=(a=r.value)?ne(e,!!r.multiple,a,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof i.onClick&&(e.onclick=$r)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return qs(t),null;case 6:if(e&&null!=t.stateNode)Ns(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(o(166));if(n=Yo(Xo.current),Yo(qo.current),ho(t)){if(r=t.stateNode,n=t.memoizedProps,r[di]=t,(a=r.nodeValue!==n)&&null!==(e=no))switch(e.tag){case 3:Qr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Qr(r.nodeValue,n,0!==(1&e.mode))}a&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[di]=t,t.stateNode=r}return qs(t),null;case 13:if(Ei(ea),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(io&&null!==ro&&0!==(1&t.mode)&&0===(128&t.flags))po(),fo(),t.flags|=98560,a=!1;else if(a=ho(t),null!==r&&null!==r.dehydrated){if(null===e){if(!a)throw Error(o(318));if(!(a=null!==(a=t.memoizedState)?a.dehydrated:null))throw Error(o(317));a[di]=t}else fo(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;qs(t),a=!1}else null!==oo&&(ac(oo),oo=null),a=!0;if(!a)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&ea.current)?0===Nl&&(Nl=3):mc())),null!==t.updateQueue&&(t.flags|=4),qs(t),null);case 4:return Jo(),Is(e,t),null===e&&Ur(t.stateNode.containerInfo),qs(t),null;case 10:return Po(t.type._context),qs(t),null;case 19:if(Ei(ea),null===(a=t.memoizedState))return qs(t),null;if(r=0!==(128&t.flags),null===(l=a.rendering))if(r)Zs(a,!1);else{if(0!==Nl||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=ta(e))){for(t.flags|=128,Zs(a,!1),null!==(r=l.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(a=n).flags&=14680066,null===(l=a.alternate)?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=l.childLanes,a.lanes=l.lanes,a.child=l.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=l.memoizedProps,a.memoizedState=l.memoizedState,a.updateQueue=l.updateQueue,a.type=l.type,e=l.dependencies,a.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ai(ea,1&ea.current|2),t.child}e=e.sibling}null!==a.tail&&Je()>Ul&&(t.flags|=128,r=!0,Zs(a,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=ta(l))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Zs(a,!0),null===a.tail&&"hidden"===a.tailMode&&!l.alternate&&!io)return qs(t),null}else 2*Je()-a.renderingStartTime>Ul&&1073741824!==n&&(t.flags|=128,r=!0,Zs(a,!1),t.lanes=4194304);a.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=a.last)?n.sibling=l:t.child=l,a.last=l)}return null!==a.tail?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Je(),t.sibling=null,n=ea.current,Ai(ea,r?1&n|2:1&n),t):(qs(t),null);case 22:case 23:return hc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Il)&&(qs(t),6&t.subtreeFlags&&(t.flags|=8192)):qs(t),null;case 24:case 25:return null}throw Error(o(156,t.tag))}function Xs(e,t){switch(to(t),t.tag){case 1:return Ii(t.type)&&Oi(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Jo(),Ei(ki),Ei(Pi),ra(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return $o(t),null;case 13:if(Ei(ea),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(o(340));fo()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Ei(ea),null;case 4:return Jo(),null;case 10:return Po(t.type._context),null;case 22:case 23:return hc(),null;default:return null}}js=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Is=function(){},Os=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,Yo(qo.current);var o,a=null;switch(n){case"input":i=Y(e,i),r=Y(e,r),a=[];break;case"select":i=z({},i,{value:void 0}),r=z({},r,{value:void 0}),a=[];break;case"textarea":i=re(e,i),r=re(e,r),a=[];break;default:"function"!==typeof i.onClick&&"function"===typeof r.onClick&&(e.onclick=$r)}for(u in _e(n,r),n=null,i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&null!=i[u])if("style"===u){var l=i[u];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(s.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in r){var c=r[u];if(l=null!=i?i[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(a||(a=[]),a.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(a=a||[]).push(u,c)):"children"===u?"string"!==typeof c&&"number"!==typeof c||(a=a||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(s.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&Fr("scroll",e),a||l===c||(a=[])):(a=a||[]).push(u,c))}n&&(a=a||[]).push("style",n);var u=a;(t.updateQueue=u)&&(t.flags|=4)}},Ns=function(e,t,n,r){n!==r&&(t.flags|=4)};var Ys=!1,Ks=!1,Js="function"===typeof WeakSet?WeakSet:Set,Qs=null;function $s(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Tc(e,t,r)}else n.current=null}function el(e,t,n){try{n()}catch(r){Tc(e,t,r)}}var tl=!1;function nl(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var i=r=r.next;do{if((i.tag&e)===e){var o=i.destroy;i.destroy=void 0,void 0!==o&&el(t,n,o)}i=i.next}while(i!==r)}}function rl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function il(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function ol(e){var t=e.alternate;null!==t&&(e.alternate=null,ol(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[di],delete t[pi],delete t[mi],delete t[gi],delete t[yi])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function al(e){return 5===e.tag||3===e.tag||4===e.tag}function sl(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||al(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=$r));else if(4!==r&&null!==(e=e.child))for(ll(e,t,n),e=e.sibling;null!==e;)ll(e,t,n),e=e.sibling}function cl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}var ul=null,hl=!1;function dl(e,t,n){for(n=n.child;null!==n;)pl(e,t,n),n=n.sibling}function pl(e,t,n){if(ot&&"function"===typeof ot.onCommitFiberUnmount)try{ot.onCommitFiberUnmount(it,n)}catch(s){}switch(n.tag){case 5:Ks||$s(n,t);case 6:var r=ul,i=hl;ul=null,dl(e,t,n),hl=i,null!==(ul=r)&&(hl?(e=ul,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):ul.removeChild(n.stateNode));break;case 18:null!==ul&&(hl?(e=ul,n=n.stateNode,8===e.nodeType?li(e.parentNode,n):1===e.nodeType&&li(e,n),Ut(e)):li(ul,n.stateNode));break;case 4:r=ul,i=hl,ul=n.stateNode.containerInfo,hl=!0,dl(e,t,n),ul=r,hl=i;break;case 0:case 11:case 14:case 15:if(!Ks&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){i=r=r.next;do{var o=i,a=o.destroy;o=o.tag,void 0!==a&&(0!==(2&o)||0!==(4&o))&&el(n,t,a),i=i.next}while(i!==r)}dl(e,t,n);break;case 1:if(!Ks&&($s(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){Tc(n,t,s)}dl(e,t,n);break;case 21:dl(e,t,n);break;case 22:1&n.mode?(Ks=(r=Ks)||null!==n.memoizedState,dl(e,t,n),Ks=r):dl(e,t,n);break;default:dl(e,t,n)}}function fl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Js),t.forEach((function(t){var r=Pc.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function ml(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r];try{var a=e,s=t,l=s;e:for(;null!==l;){switch(l.tag){case 5:ul=l.stateNode,hl=!1;break e;case 3:case 4:ul=l.stateNode.containerInfo,hl=!0;break e}l=l.return}if(null===ul)throw Error(o(160));pl(a,s,i),ul=null,hl=!1;var c=i.alternate;null!==c&&(c.return=null),i.return=null}catch(u){Tc(i,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gl(t,e),t=t.sibling}function gl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ml(t,e),yl(e),4&r){try{nl(3,e,e.return),rl(3,e)}catch(g){Tc(e,e.return,g)}try{nl(5,e,e.return)}catch(g){Tc(e,e.return,g)}}break;case 1:ml(t,e),yl(e),512&r&&null!==n&&$s(n,n.return);break;case 5:if(ml(t,e),yl(e),512&r&&null!==n&&$s(n,n.return),32&e.flags){var i=e.stateNode;try{de(i,"")}catch(g){Tc(e,e.return,g)}}if(4&r&&null!=(i=e.stateNode)){var a=e.memoizedProps,s=null!==n?n.memoizedProps:a,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===a.type&&null!=a.name&&J(i,a),ve(l,s);var u=ve(l,a);for(s=0;s<c.length;s+=2){var h=c[s],d=c[s+1];"style"===h?ge(i,d):"dangerouslySetInnerHTML"===h?he(i,d):"children"===h?de(i,d):v(i,h,d,u)}switch(l){case"input":Q(i,a);break;case"textarea":oe(i,a);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var f=a.value;null!=f?ne(i,!!a.multiple,f,!1):p!==!!a.multiple&&(null!=a.defaultValue?ne(i,!!a.multiple,a.defaultValue,!0):ne(i,!!a.multiple,a.multiple?[]:"",!1))}i[pi]=a}catch(g){Tc(e,e.return,g)}}break;case 6:if(ml(t,e),yl(e),4&r){if(null===e.stateNode)throw Error(o(162));i=e.stateNode,a=e.memoizedProps;try{i.nodeValue=a}catch(g){Tc(e,e.return,g)}}break;case 3:if(ml(t,e),yl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Ut(t.containerInfo)}catch(g){Tc(e,e.return,g)}break;case 4:default:ml(t,e),yl(e);break;case 13:ml(t,e),yl(e),8192&(i=e.child).flags&&(a=null!==i.memoizedState,i.stateNode.isHidden=a,!a||null!==i.alternate&&null!==i.alternate.memoizedState||(Vl=Je())),4&r&&fl(e);break;case 22:if(h=null!==n&&null!==n.memoizedState,1&e.mode?(Ks=(u=Ks)||h,ml(t,e),Ks=u):ml(t,e),yl(e),8192&r){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!h&&0!==(1&e.mode))for(Qs=e,h=e.child;null!==h;){for(d=Qs=h;null!==Qs;){switch(f=(p=Qs).child,p.tag){case 0:case 11:case 14:case 15:nl(4,p,p.return);break;case 1:$s(p,p.return);var m=p.stateNode;if("function"===typeof m.componentWillUnmount){r=p,n=p.return;try{t=r,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){Tc(r,n,g)}}break;case 5:$s(p,p.return);break;case 22:if(null!==p.memoizedState){bl(d);continue}}null!==f?(f.return=p,Qs=f):bl(d)}h=h.sibling}e:for(h=null,d=e;;){if(5===d.tag){if(null===h){h=d;try{i=d.stateNode,u?"function"===typeof(a=i.style).setProperty?a.setProperty("display","none","important"):a.display="none":(l=d.stateNode,s=void 0!==(c=d.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=me("display",s))}catch(g){Tc(e,e.return,g)}}}else if(6===d.tag){if(null===h)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(g){Tc(e,e.return,g)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===e)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;null===d.sibling;){if(null===d.return||d.return===e)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:ml(t,e),yl(e),4&r&&fl(e);case 21:}}function yl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(al(n)){var r=n;break e}n=n.return}throw Error(o(160))}switch(r.tag){case 5:var i=r.stateNode;32&r.flags&&(de(i,""),r.flags&=-33),cl(e,sl(e),i);break;case 3:case 4:var a=r.stateNode.containerInfo;ll(e,sl(e),a);break;default:throw Error(o(161))}}catch(s){Tc(e,e.return,s)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function _l(e,t,n){Qs=e,vl(e,t,n)}function vl(e,t,n){for(var r=0!==(1&e.mode);null!==Qs;){var i=Qs,o=i.child;if(22===i.tag&&r){var a=null!==i.memoizedState||Ys;if(!a){var s=i.alternate,l=null!==s&&null!==s.memoizedState||Ks;s=Ys;var c=Ks;if(Ys=a,(Ks=l)&&!c)for(Qs=i;null!==Qs;)l=(a=Qs).child,22===a.tag&&null!==a.memoizedState?wl(i):null!==l?(l.return=a,Qs=l):wl(i);for(;null!==o;)Qs=o,vl(o,t,n),o=o.sibling;Qs=i,Ys=s,Ks=c}xl(e)}else 0!==(8772&i.subtreeFlags)&&null!==o?(o.return=i,Qs=o):xl(e)}}function xl(e){for(;null!==Qs;){var t=Qs;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Ks||rl(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Ks)if(null===n)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:ns(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;null!==a&&Ho(t,a,r);break;case 3:var s=t.updateQueue;if(null!==s){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Ho(t,s,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var h=u.memoizedState;if(null!==h){var d=h.dehydrated;null!==d&&Ut(d)}}}break;default:throw Error(o(163))}Ks||512&t.flags&&il(t)}catch(p){Tc(t,t.return,p)}}if(t===e){Qs=null;break}if(null!==(n=t.sibling)){n.return=t.return,Qs=n;break}Qs=t.return}}function bl(e){for(;null!==Qs;){var t=Qs;if(t===e){Qs=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Qs=n;break}Qs=t.return}}function wl(e){for(;null!==Qs;){var t=Qs;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{rl(4,t)}catch(l){Tc(t,n,l)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var i=t.return;try{r.componentDidMount()}catch(l){Tc(t,i,l)}}var o=t.return;try{il(t)}catch(l){Tc(t,o,l)}break;case 5:var a=t.return;try{il(t)}catch(l){Tc(t,a,l)}}}catch(l){Tc(t,t.return,l)}if(t===e){Qs=null;break}var s=t.sibling;if(null!==s){s.return=t.return,Qs=s;break}Qs=t.return}}var Sl,Tl=Math.ceil,El=x.ReactCurrentDispatcher,Al=x.ReactCurrentOwner,Ml=x.ReactCurrentBatchConfig,Pl=0,kl=null,Cl=null,jl=0,Il=0,Ol=Ti(0),Nl=0,Dl=null,Ll=0,zl=0,Rl=0,Fl=null,Bl=null,Vl=0,Ul=1/0,Gl=null,Hl=!1,Zl=null,ql=null,Wl=!1,Xl=null,Yl=0,Kl=0,Jl=null,Ql=-1,$l=0;function ec(){return 0!==(6&Pl)?Je():-1!==Ql?Ql:Ql=Je()}function tc(e){return 0===(1&e.mode)?1:0!==(2&Pl)&&0!==jl?jl&-jl:null!==go.transition?(0===$l&&($l=mt()),$l):0!==(e=vt)?e:e=void 0===(e=window.event)?16:Kt(e.type)}function nc(e,t,n,r){if(50<Kl)throw Kl=0,Jl=null,Error(o(185));yt(e,n,r),0!==(2&Pl)&&e===kl||(e===kl&&(0===(2&Pl)&&(zl|=n),4===Nl&&sc(e,jl)),rc(e,r),1===n&&0===Pl&&0===(1&t.mode)&&(Ul=Je()+500,Fi&&Ui()))}function rc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,o=e.pendingLanes;0<o;){var a=31-at(o),s=1<<a,l=i[a];-1===l?0!==(s&n)&&0===(s&r)||(i[a]=pt(s,t)):l<=t&&(e.expiredLanes|=s),o&=~s}}(e,t);var r=dt(e,e===kl?jl:0);if(0===r)null!==n&&Xe(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Xe(n),1===t)0===e.tag?function(e){Fi=!0,Vi(e)}(lc.bind(null,e)):Vi(lc.bind(null,e)),ai((function(){0===(6&Pl)&&Ui()})),n=null;else{switch(xt(r)){case 1:n=$e;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=kc(n,ic.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ic(e,t){if(Ql=-1,$l=0,0!==(6&Pl))throw Error(o(327));var n=e.callbackNode;if(wc()&&e.callbackNode!==n)return null;var r=dt(e,e===kl?jl:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=gc(e,r);else{t=r;var i=Pl;Pl|=2;var a=fc();for(kl===e&&jl===t||(Gl=null,Ul=Je()+500,dc(e,t));;)try{_c();break}catch(l){pc(e,l)}Mo(),El.current=a,Pl=i,null!==Cl?t=0:(kl=null,jl=0,t=Nl)}if(0!==t){if(2===t&&(0!==(i=ft(e))&&(r=i,t=oc(e,i))),1===t)throw n=Dl,dc(e,0),sc(e,r),rc(e,Je()),n;if(6===t)sc(e,r);else{if(i=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!sr(o(),i))return!1}catch(s){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)&&(2===(t=gc(e,r))&&(0!==(a=ft(e))&&(r=a,t=oc(e,a))),1===t))throw n=Dl,dc(e,0),sc(e,r),rc(e,Je()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(o(345));case 2:case 5:bc(e,Bl,Gl);break;case 3:if(sc(e,r),(130023424&r)===r&&10<(t=Vl+500-Je())){if(0!==dt(e,0))break;if(((i=e.suspendedLanes)&r)!==r){ec(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=ri(bc.bind(null,e,Bl,Gl),t);break}bc(e,Bl,Gl);break;case 4:if(sc(e,r),(4194240&r)===r)break;for(t=e.eventTimes,i=-1;0<r;){var s=31-at(r);a=1<<s,(s=t[s])>i&&(i=s),r&=~a}if(r=i,10<(r=(120>(r=Je()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Tl(r/1960))-r)){e.timeoutHandle=ri(bc.bind(null,e,Bl,Gl),r);break}bc(e,Bl,Gl);break;default:throw Error(o(329))}}}return rc(e,Je()),e.callbackNode===n?ic.bind(null,e):null}function oc(e,t){var n=Fl;return e.current.memoizedState.isDehydrated&&(dc(e,t).flags|=256),2!==(e=gc(e,t))&&(t=Bl,Bl=n,null!==t&&ac(t)),e}function ac(e){null===Bl?Bl=e:Bl.push.apply(Bl,e)}function sc(e,t){for(t&=~Rl,t&=~zl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-at(t),r=1<<n;e[n]=-1,t&=~r}}function lc(e){if(0!==(6&Pl))throw Error(o(327));wc();var t=dt(e,0);if(0===(1&t))return rc(e,Je()),null;var n=gc(e,t);if(0!==e.tag&&2===n){var r=ft(e);0!==r&&(t=r,n=oc(e,r))}if(1===n)throw n=Dl,dc(e,0),sc(e,t),rc(e,Je()),n;if(6===n)throw Error(o(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,bc(e,Bl,Gl),rc(e,Je()),null}function cc(e,t){var n=Pl;Pl|=1;try{return e(t)}finally{0===(Pl=n)&&(Ul=Je()+500,Fi&&Ui())}}function uc(e){null!==Xl&&0===Xl.tag&&0===(6&Pl)&&wc();var t=Pl;Pl|=1;var n=Ml.transition,r=vt;try{if(Ml.transition=null,vt=1,e)return e()}finally{vt=r,Ml.transition=n,0===(6&(Pl=t))&&Ui()}}function hc(){Il=Ol.current,Ei(Ol)}function dc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ii(n)),null!==Cl)for(n=Cl.return;null!==n;){var r=n;switch(to(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Oi();break;case 3:Jo(),Ei(ki),Ei(Pi),ra();break;case 5:$o(r);break;case 4:Jo();break;case 13:case 19:Ei(ea);break;case 10:Po(r.type._context);break;case 22:case 23:hc()}n=n.return}if(kl=e,Cl=e=Oc(e.current,null),jl=Il=t,Nl=0,Dl=null,Rl=zl=Ll=0,Bl=Fl=null,null!==Io){for(t=0;t<Io.length;t++)if(null!==(r=(n=Io[t]).interleaved)){n.interleaved=null;var i=r.next,o=n.pending;if(null!==o){var a=o.next;o.next=i,r.next=a}n.pending=r}Io=null}return e}function pc(e,t){for(;;){var n=Cl;try{if(Mo(),ia.current=Qa,ua){for(var r=sa.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}ua=!1}if(aa=0,ca=la=sa=null,ha=!1,da=0,Al.current=null,null===n||null===n.return){Nl=1,Dl=t,Cl=null;break}e:{var a=e,s=n.return,l=n,c=t;if(t=jl,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,h=l,d=h.tag;if(0===(1&h.mode)&&(0===d||11===d||15===d)){var p=h.alternate;p?(h.updateQueue=p.updateQueue,h.memoizedState=p.memoizedState,h.lanes=p.lanes):(h.updateQueue=null,h.memoizedState=null)}var f=gs(s);if(null!==f){f.flags&=-257,ys(f,s,l,0,t),1&f.mode&&ms(a,u,t),c=u;var m=(t=f).updateQueue;if(null===m){var g=new Set;g.add(c),t.updateQueue=g}else m.add(c);break e}if(0===(1&t)){ms(a,u,t),mc();break e}c=Error(o(426))}else if(io&&1&l.mode){var y=gs(s);if(null!==y){0===(65536&y.flags)&&(y.flags|=256),ys(y,s,l,0,t),mo(cs(c,l));break e}}a=c=cs(c,l),4!==Nl&&(Nl=2),null===Fl?Fl=[a]:Fl.push(a),a=s;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t,Uo(a,ps(0,c,t));break e;case 1:l=c;var _=a.type,v=a.stateNode;if(0===(128&a.flags)&&("function"===typeof _.getDerivedStateFromError||null!==v&&"function"===typeof v.componentDidCatch&&(null===ql||!ql.has(v)))){a.flags|=65536,t&=-t,a.lanes|=t,Uo(a,fs(a,l,t));break e}}a=a.return}while(null!==a)}xc(n)}catch(x){t=x,Cl===n&&null!==n&&(Cl=n=n.return);continue}break}}function fc(){var e=El.current;return El.current=Qa,null===e?Qa:e}function mc(){0!==Nl&&3!==Nl&&2!==Nl||(Nl=4),null===kl||0===(268435455&Ll)&&0===(268435455&zl)||sc(kl,jl)}function gc(e,t){var n=Pl;Pl|=2;var r=fc();for(kl===e&&jl===t||(Gl=null,dc(e,t));;)try{yc();break}catch(i){pc(e,i)}if(Mo(),Pl=n,El.current=r,null!==Cl)throw Error(o(261));return kl=null,jl=0,Nl}function yc(){for(;null!==Cl;)vc(Cl)}function _c(){for(;null!==Cl&&!Ye();)vc(Cl)}function vc(e){var t=Sl(e.alternate,e,Il);e.memoizedProps=e.pendingProps,null===t?xc(e):Cl=t,Al.current=null}function xc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Ws(n,t,Il)))return void(Cl=n)}else{if(null!==(n=Xs(n,t)))return n.flags&=32767,void(Cl=n);if(null===e)return Nl=6,void(Cl=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Cl=t);Cl=t=e}while(null!==t);0===Nl&&(Nl=5)}function bc(e,t,n){var r=vt,i=Ml.transition;try{Ml.transition=null,vt=1,function(e,t,n,r){do{wc()}while(null!==Xl);if(0!==(6&Pl))throw Error(o(327));n=e.finishedWork;var i=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(o(177));e.callbackNode=null,e.callbackPriority=0;var a=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-at(n),o=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~o}}(e,a),e===kl&&(Cl=kl=null,jl=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Wl||(Wl=!0,kc(tt,(function(){return wc(),null}))),a=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||a){a=Ml.transition,Ml.transition=null;var s=vt;vt=1;var l=Pl;Pl|=4,Al.current=null,function(e,t){if(ei=Ht,pr(e=dr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{n.nodeType,a.nodeType}catch(b){n=null;break e}var s=0,l=-1,c=-1,u=0,h=0,d=e,p=null;t:for(;;){for(var f;d!==n||0!==i&&3!==d.nodeType||(l=s+i),d!==a||0!==r&&3!==d.nodeType||(c=s+r),3===d.nodeType&&(s+=d.nodeValue.length),null!==(f=d.firstChild);)p=d,d=f;for(;;){if(d===e)break t;if(p===n&&++u===i&&(l=s),p===a&&++h===r&&(c=s),null!==(f=d.nextSibling))break;p=(d=p).parentNode}d=f}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ti={focusedElem:e,selectionRange:n},Ht=!1,Qs=t;null!==Qs;)if(e=(t=Qs).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Qs=e;else for(;null!==Qs;){t=Qs;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,y=m.memoizedState,_=t.stateNode,v=_.getSnapshotBeforeUpdate(t.elementType===t.type?g:ns(t.type,g),y);_.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var x=t.stateNode.containerInfo;1===x.nodeType?x.textContent="":9===x.nodeType&&x.documentElement&&x.removeChild(x.documentElement);break;default:throw Error(o(163))}}catch(b){Tc(t,t.return,b)}if(null!==(e=t.sibling)){e.return=t.return,Qs=e;break}Qs=t.return}m=tl,tl=!1}(e,n),gl(n,e),fr(ti),Ht=!!ei,ti=ei=null,e.current=n,_l(n,e,i),Ke(),Pl=l,vt=s,Ml.transition=a}else e.current=n;if(Wl&&(Wl=!1,Xl=e,Yl=i),a=e.pendingLanes,0===a&&(ql=null),function(e){if(ot&&"function"===typeof ot.onCommitFiberRoot)try{ot.onCommitFiberRoot(it,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),rc(e,Je()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Hl)throw Hl=!1,e=Zl,Zl=null,e;0!==(1&Yl)&&0!==e.tag&&wc(),a=e.pendingLanes,0!==(1&a)?e===Jl?Kl++:(Kl=0,Jl=e):Kl=0,Ui()}(e,t,n,r)}finally{Ml.transition=i,vt=r}return null}function wc(){if(null!==Xl){var e=xt(Yl),t=Ml.transition,n=vt;try{if(Ml.transition=null,vt=16>e?16:e,null===Xl)var r=!1;else{if(e=Xl,Xl=null,Yl=0,0!==(6&Pl))throw Error(o(331));var i=Pl;for(Pl|=4,Qs=e.current;null!==Qs;){var a=Qs,s=a.child;if(0!==(16&Qs.flags)){var l=a.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(Qs=u;null!==Qs;){var h=Qs;switch(h.tag){case 0:case 11:case 15:nl(8,h,a)}var d=h.child;if(null!==d)d.return=h,Qs=d;else for(;null!==Qs;){var p=(h=Qs).sibling,f=h.return;if(ol(h),h===u){Qs=null;break}if(null!==p){p.return=f,Qs=p;break}Qs=f}}}var m=a.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(null!==g)}}Qs=a}}if(0!==(2064&a.subtreeFlags)&&null!==s)s.return=a,Qs=s;else e:for(;null!==Qs;){if(0!==(2048&(a=Qs).flags))switch(a.tag){case 0:case 11:case 15:nl(9,a,a.return)}var _=a.sibling;if(null!==_){_.return=a.return,Qs=_;break e}Qs=a.return}}var v=e.current;for(Qs=v;null!==Qs;){var x=(s=Qs).child;if(0!==(2064&s.subtreeFlags)&&null!==x)x.return=s,Qs=x;else e:for(s=v;null!==Qs;){if(0!==(2048&(l=Qs).flags))try{switch(l.tag){case 0:case 11:case 15:rl(9,l)}}catch(w){Tc(l,l.return,w)}if(l===s){Qs=null;break e}var b=l.sibling;if(null!==b){b.return=l.return,Qs=b;break e}Qs=l.return}}if(Pl=i,Ui(),ot&&"function"===typeof ot.onPostCommitFiberRoot)try{ot.onPostCommitFiberRoot(it,e)}catch(w){}r=!0}return r}finally{vt=n,Ml.transition=t}}return!1}function Sc(e,t,n){e=Bo(e,t=ps(0,t=cs(n,t),1),1),t=ec(),null!==e&&(yt(e,1,t),rc(e,t))}function Tc(e,t,n){if(3===e.tag)Sc(e,e,n);else for(;null!==t;){if(3===t.tag){Sc(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===ql||!ql.has(r))){t=Bo(t,e=fs(t,e=cs(n,e),1),1),e=ec(),null!==t&&(yt(t,1,e),rc(t,e));break}}t=t.return}}function Ec(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&n,kl===e&&(jl&n)===n&&(4===Nl||3===Nl&&(130023424&jl)===jl&&500>Je()-Vl?dc(e,0):Rl|=n),rc(e,t)}function Ac(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var n=ec();null!==(e=Do(e,t))&&(yt(e,t,n),rc(e,n))}function Mc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Ac(e,n)}function Pc(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(o(314))}null!==r&&r.delete(t),Ac(e,n)}function kc(e,t){return We(e,t)}function Cc(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function jc(e,t,n,r){return new Cc(e,t,n,r)}function Ic(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Oc(e,t){var n=e.alternate;return null===n?((n=jc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Nc(e,t,n,r,i,a){var s=2;if(r=e,"function"===typeof e)Ic(e)&&(s=1);else if("string"===typeof e)s=5;else e:switch(e){case S:return Dc(n.children,i,a,t);case T:s=8,i|=8;break;case E:return(e=jc(12,n,t,2|i)).elementType=E,e.lanes=a,e;case k:return(e=jc(13,n,t,i)).elementType=k,e.lanes=a,e;case C:return(e=jc(19,n,t,i)).elementType=C,e.lanes=a,e;case O:return Lc(n,i,a,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case A:s=10;break e;case M:s=9;break e;case P:s=11;break e;case j:s=14;break e;case I:s=16,r=null;break e}throw Error(o(130,null==e?e:typeof e,""))}return(t=jc(s,n,t,i)).elementType=e,t.type=r,t.lanes=a,t}function Dc(e,t,n,r){return(e=jc(7,e,r,t)).lanes=n,e}function Lc(e,t,n,r){return(e=jc(22,e,r,t)).elementType=O,e.lanes=n,e.stateNode={isHidden:!1},e}function zc(e,t,n){return(e=jc(6,e,null,t)).lanes=n,e}function Rc(e,t,n){return(t=jc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Fc(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Bc(e,t,n,r,i,o,a,s,l){return e=new Fc(e,t,n,s,l),1===t?(t=1,!0===o&&(t|=8)):t=0,o=jc(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},zo(o),e}function Vc(e){if(!e)return Mi;e:{if(Ue(e=e._reactInternals)!==e||1!==e.tag)throw Error(o(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ii(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(o(171))}if(1===e.tag){var n=e.type;if(Ii(n))return Di(e,n,t)}return t}function Uc(e,t,n,r,i,o,a,s,l){return(e=Bc(n,r,!0,e,0,o,0,s,l)).context=Vc(null),n=e.current,(o=Fo(r=ec(),i=tc(n))).callback=void 0!==t&&null!==t?t:null,Bo(n,o,i),e.current.lanes=i,yt(e,i,r),rc(e,r),e}function Gc(e,t,n,r){var i=t.current,o=ec(),a=tc(i);return n=Vc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Fo(o,a)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Bo(i,t,a))&&(nc(e,i,a,o),Vo(e,i,a)),a}function Hc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Zc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function qc(e,t){Zc(e,t),(e=e.alternate)&&Zc(e,t)}Sl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||ki.current)vs=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return vs=!1,function(e,t,n){switch(t.tag){case 3:ks(t),fo();break;case 5:Qo(t);break;case 1:Ii(t.type)&&Li(t);break;case 4:Ko(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;Ai(So,r._currentValue),r._currentValue=i;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Ai(ea,1&ea.current),t.flags|=128,null):0!==(n&t.child.childLanes)?zs(e,t,n):(Ai(ea,1&ea.current),null!==(e=Hs(e,t,n))?e.sibling:null);Ai(ea,1&ea.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return Us(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ai(ea,ea.current),r)break;return null;case 22:case 23:return t.lanes=0,Ts(e,t,n)}return Hs(e,t,n)}(e,t,n);vs=0!==(131072&e.flags)}else vs=!1,io&&0!==(1048576&t.flags)&&$i(t,qi,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Gs(e,t),e=t.pendingProps;var i=ji(t,Pi.current);Co(t,n),i=ga(null,t,r,e,i,n);var a=ya();return t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ii(r)?(a=!0,Li(t)):a=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,zo(t),i.updater=is,t.stateNode=i,i._reactInternals=t,ls(t,r,e,n),t=Ps(null,t,r,!0,a,n)):(t.tag=0,io&&a&&eo(t),xs(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Gs(e,t),e=t.pendingProps,r=(i=r._init)(r._payload),t.type=r,i=t.tag=function(e){if("function"===typeof e)return Ic(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===P)return 11;if(e===j)return 14}return 2}(r),e=ns(r,e),i){case 0:t=As(null,t,r,e,n);break e;case 1:t=Ms(null,t,r,e,n);break e;case 11:t=bs(null,t,r,e,n);break e;case 14:t=ws(null,t,r,ns(r.type,e),n);break e}throw Error(o(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,As(e,t,r,i=t.elementType===r?i:ns(r,i),n);case 1:return r=t.type,i=t.pendingProps,Ms(e,t,r,i=t.elementType===r?i:ns(r,i),n);case 3:e:{if(ks(t),null===e)throw Error(o(387));r=t.pendingProps,i=(a=t.memoizedState).element,Ro(e,t),Go(t,r,null,n);var s=t.memoizedState;if(r=s.element,a.isDehydrated){if(a={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=a,t.memoizedState=a,256&t.flags){t=Cs(e,t,r,n,i=cs(Error(o(423)),t));break e}if(r!==i){t=Cs(e,t,r,n,i=cs(Error(o(424)),t));break e}for(ro=ci(t.stateNode.containerInfo.firstChild),no=t,io=!0,oo=null,n=wo(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(fo(),r===i){t=Hs(e,t,n);break e}xs(e,t,r,n)}t=t.child}return t;case 5:return Qo(t),null===e&&co(t),r=t.type,i=t.pendingProps,a=null!==e?e.memoizedProps:null,s=i.children,ni(r,i)?s=null:null!==a&&ni(r,a)&&(t.flags|=32),Es(e,t),xs(e,t,s,n),t.child;case 6:return null===e&&co(t),null;case 13:return zs(e,t,n);case 4:return Ko(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=bo(t,null,r,n):xs(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,bs(e,t,r,i=t.elementType===r?i:ns(r,i),n);case 7:return xs(e,t,t.pendingProps,n),t.child;case 8:case 12:return xs(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,a=t.memoizedProps,s=i.value,Ai(So,r._currentValue),r._currentValue=s,null!==a)if(sr(a.value,s)){if(a.children===i.children&&!ki.current){t=Hs(e,t,n);break e}}else for(null!==(a=t.child)&&(a.return=t);null!==a;){var l=a.dependencies;if(null!==l){s=a.child;for(var c=l.firstContext;null!==c;){if(c.context===r){if(1===a.tag){(c=Fo(-1,n&-n)).tag=2;var u=a.updateQueue;if(null!==u){var h=(u=u.shared).pending;null===h?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}a.lanes|=n,null!==(c=a.alternate)&&(c.lanes|=n),ko(a.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===a.tag)s=a.type===t.type?null:a.child;else if(18===a.tag){if(null===(s=a.return))throw Error(o(341));s.lanes|=n,null!==(l=s.alternate)&&(l.lanes|=n),ko(s,n,t),s=a.sibling}else s=a.child;if(null!==s)s.return=a;else for(s=a;null!==s;){if(s===t){s=null;break}if(null!==(a=s.sibling)){a.return=s.return,s=a;break}s=s.return}a=s}xs(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,Co(t,n),r=r(i=jo(i)),t.flags|=1,xs(e,t,r,n),t.child;case 14:return i=ns(r=t.type,t.pendingProps),ws(e,t,r,i=ns(r.type,i),n);case 15:return Ss(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:ns(r,i),Gs(e,t),t.tag=1,Ii(r)?(e=!0,Li(t)):e=!1,Co(t,n),as(t,r,i),ls(t,r,i,n),Ps(null,t,r,!0,e,n);case 19:return Us(e,t,n);case 22:return Ts(e,t,n)}throw Error(o(156,t.tag))};var Wc="function"===typeof reportError?reportError:function(e){console.error(e)};function Xc(e){this._internalRoot=e}function Yc(e){this._internalRoot=e}function Kc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Qc(){}function $c(e,t,n,r,i){var o=n._reactRootContainer;if(o){var a=o;if("function"===typeof i){var s=i;i=function(){var e=Hc(a);s.call(e)}}Gc(t,a,e,i)}else a=function(e,t,n,r,i){if(i){if("function"===typeof r){var o=r;r=function(){var e=Hc(a);o.call(e)}}var a=Uc(t,r,e,0,null,!1,0,"",Qc);return e._reactRootContainer=a,e[fi]=a.current,Ur(8===e.nodeType?e.parentNode:e),uc(),a}for(;i=e.lastChild;)e.removeChild(i);if("function"===typeof r){var s=r;r=function(){var e=Hc(l);s.call(e)}}var l=Bc(e,0,!1,null,0,!1,0,"",Qc);return e._reactRootContainer=l,e[fi]=l.current,Ur(8===e.nodeType?e.parentNode:e),uc((function(){Gc(t,l,n,r)})),l}(n,t,e,i,r);return Hc(a)}Yc.prototype.render=Xc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(o(409));Gc(e,t,null,null)},Yc.prototype.unmount=Xc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;uc((function(){Gc(null,e,null,null)})),t[fi]=null}},Yc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Tt();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Ot.length&&0!==t&&t<Ot[n].priority;n++);Ot.splice(n,0,e),0===n&&zt(e)}},bt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ht(t.pendingLanes);0!==n&&(_t(t,1|n),rc(t,Je()),0===(6&Pl)&&(Ul=Je()+500,Ui()))}break;case 13:uc((function(){var t=Do(e,1);if(null!==t){var n=ec();nc(t,e,1,n)}})),qc(e,1)}},wt=function(e){if(13===e.tag){var t=Do(e,134217728);if(null!==t)nc(t,e,134217728,ec());qc(e,134217728)}},St=function(e){if(13===e.tag){var t=tc(e),n=Do(e,t);if(null!==n)nc(n,e,t,ec());qc(e,t)}},Tt=function(){return vt},Et=function(e,t){var n=vt;try{return vt=e,t()}finally{vt=n}},we=function(e,t,n){switch(t){case"input":if(Q(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=bi(r);if(!i)throw Error(o(90));W(r),Q(r,i)}}}break;case"textarea":oe(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Pe=cc,ke=uc;var eu={usingClientEntryPoint:!1,Events:[vi,xi,bi,Ae,Me,cc]},tu={findFiberByHostInstance:_i,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nu={bundleType:tu.bundleType,version:tu.version,rendererPackageName:tu.rendererPackageName,rendererConfig:tu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:x.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ze(e))?null:e.stateNode},findFiberByHostInstance:tu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ru=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ru.isDisabled&&ru.supportsFiber)try{it=ru.inject(nu),ot=ru}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Kc(t))throw Error(o(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:w,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Kc(e))throw Error(o(299));var n=!1,r="",i=Wc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),t=Bc(e,1,!1,null,0,n,0,r,i),e[fi]=t.current,Ur(8===e.nodeType?e.parentNode:e),new Xc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(o(188));throw e=Object.keys(e).join(","),Error(o(268,e))}return e=null===(e=Ze(t))?null:e.stateNode},t.flushSync=function(e){return uc(e)},t.hydrate=function(e,t,n){if(!Jc(t))throw Error(o(200));return $c(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Kc(e))throw Error(o(405));var r=null!=n&&n.hydratedSources||null,i=!1,a="",s=Wc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(a=n.identifierPrefix),void 0!==n.onRecoverableError&&(s=n.onRecoverableError)),t=Uc(t,null,e,1,null!=n?n:null,i,0,a,s),e[fi]=t.current,Ur(e),r)for(e=0;e<r.length;e++)i=(i=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new Yc(t)},t.render=function(e,t,n){if(!Jc(t))throw Error(o(200));return $c(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Jc(e))throw Error(o(40));return!!e._reactRootContainer&&(uc((function(){$c(null,null,e,!1,(function(){e._reactRootContainer=null,e[fi]=null}))})),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Jc(n))throw Error(o(200));if(null==e||void 0===e._reactInternals)throw Error(o(38));return $c(e,t,n,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},7950:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(2730)},4358:(e,t)=>{"use strict";const n=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,r=/^[\u0021-\u003A\u003C-\u007E]*$/,i=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,o=/^[\u0020-\u003A\u003D-\u007E]*$/,a=Object.prototype.toString,s=(()=>{const e=function(){};return e.prototype=Object.create(null),e})();function l(e,t,n){do{const n=e.charCodeAt(t);if(32!==n&&9!==n)return t}while(++t<n);return n}function c(e,t,n){for(;t>n;){const n=e.charCodeAt(--t);if(32!==n&&9!==n)return t+1}return n}function u(e){if(-1===e.indexOf("%"))return e;try{return decodeURIComponent(e)}catch(t){return e}}},1153:(e,t,n)=>{"use strict";var r=n(5043),i=Symbol.for("react.element"),o=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,o={},c=null,u=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)a.call(t,r)&&!l.hasOwnProperty(r)&&(o[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===o[r]&&(o[r]=t[r]);return{$$typeof:i,type:e,key:c,ref:u,props:o,_owner:s.current}}t.Fragment=o,t.jsx=c,t.jsxs=c},4202:(e,t)=>{"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),p=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function y(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}function _(){}function v(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}y.prototype.isReactComponent={},y.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},_.prototype=y.prototype;var x=v.prototype=new _;x.constructor=v,m(x,y.prototype),x.isPureReactComponent=!0;var b=Array.isArray,w=Object.prototype.hasOwnProperty,S={current:null},T={key:!0,ref:!0,__self:!0,__source:!0};function E(e,t,r){var i,o={},a=null,s=null;if(null!=t)for(i in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(a=""+t.key),t)w.call(t,i)&&!T.hasOwnProperty(i)&&(o[i]=t[i]);var l=arguments.length-2;if(1===l)o.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];o.children=c}if(e&&e.defaultProps)for(i in l=e.defaultProps)void 0===o[i]&&(o[i]=l[i]);return{$$typeof:n,type:e,key:a,ref:s,props:o,_owner:S.current}}function A(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var M=/\/+/g;function P(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function k(e,t,i,o,a){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var l=!1;if(null===e)l=!0;else switch(s){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case r:l=!0}}if(l)return a=a(l=e),e=""===o?"."+P(l,0):o,b(a)?(i="",null!=e&&(i=e.replace(M,"$&/")+"/"),k(a,t,i,"",(function(e){return e}))):null!=a&&(A(a)&&(a=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(a,i+(!a.key||l&&l.key===a.key?"":(""+a.key).replace(M,"$&/")+"/")+e)),t.push(a)),1;if(l=0,o=""===o?".":o+":",b(e))for(var c=0;c<e.length;c++){var u=o+P(s=e[c],c);l+=k(s,t,i,u,a)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),c=0;!(s=e.next()).done;)l+=k(s=s.value,t,i,u=o+P(s,c++),a);else if("object"===s)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function C(e,t,n){if(null==e)return e;var r=[],i=0;return k(e,r,"","",(function(e){return t.call(n,e,i++)})),r}function j(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var I={current:null},O={transition:null},N={ReactCurrentDispatcher:I,ReactCurrentBatchConfig:O,ReactCurrentOwner:S};function D(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:C,forEach:function(e,t,n){C(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return C(e,(function(){t++})),t},toArray:function(e){return C(e,(function(e){return e}))||[]},only:function(e){if(!A(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=y,t.Fragment=i,t.Profiler=a,t.PureComponent=v,t.StrictMode=o,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=N,t.act=D,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=m({},e.props),o=e.key,a=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(a=t.ref,s=S.current),void 0!==t.key&&(o=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)w.call(t,c)&&!T.hasOwnProperty(c)&&(i[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)i.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];i.children=l}return{$$typeof:n,type:e.type,key:o,ref:a,props:i,_owner:s}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=E,t.createFactory=function(e){var t=E.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=A,t.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:j}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=O.transition;O.transition={};try{e()}finally{O.transition=t}},t.unstable_act=D,t.useCallback=function(e,t){return I.current.useCallback(e,t)},t.useContext=function(e){return I.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return I.current.useDeferredValue(e)},t.useEffect=function(e,t){return I.current.useEffect(e,t)},t.useId=function(){return I.current.useId()},t.useImperativeHandle=function(e,t,n){return I.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return I.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return I.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return I.current.useMemo(e,t)},t.useReducer=function(e,t,n){return I.current.useReducer(e,t,n)},t.useRef=function(e){return I.current.useRef(e)},t.useState=function(e){return I.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return I.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return I.current.useTransition()},t.version="18.3.1"},5043:(e,t,n)=>{"use strict";e.exports=n(4202)},579:(e,t,n)=>{"use strict";e.exports=n(1153)},6378:(e,t)=>{"use strict";var n,r=Symbol.for("react.element"),i=Symbol.for("react.portal"),o=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),c=Symbol.for("react.context"),u=Symbol.for("react.server_context"),h=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),p=Symbol.for("react.suspense_list"),f=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),g=Symbol.for("react.offscreen");function y(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case r:switch(e=e.type){case o:case s:case a:case d:case p:return e;default:switch(e=e&&e.$$typeof){case u:case c:case h:case m:case f:case l:return e;default:return t}}case i:return t}}}n=Symbol.for("react.module.reference"),t.isFragment=function(e){return y(e)===o}},9062:(e,t,n)=>{"use strict";e.exports=n(6378)},7234:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<o(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,a=i>>>1;r<a;){var s=2*(r+1)-1,l=e[s],c=s+1,u=e[c];if(0>o(l,n))c<i&&0>o(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[s]=n,r=s);else{if(!(c<i&&0>o(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function o(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var a=performance;t.unstable_now=function(){return a.now()}}else{var s=Date,l=s.now();t.unstable_now=function(){return s.now()-l}}var c=[],u=[],h=1,d=null,p=3,f=!1,m=!1,g=!1,y="function"===typeof setTimeout?setTimeout:null,_="function"===typeof clearTimeout?clearTimeout:null,v="undefined"!==typeof setImmediate?setImmediate:null;function x(e){for(var t=r(u);null!==t;){if(null===t.callback)i(u);else{if(!(t.startTime<=e))break;i(u),t.sortIndex=t.expirationTime,n(c,t)}t=r(u)}}function b(e){if(g=!1,x(e),!m)if(null!==r(c))m=!0,O(w);else{var t=r(u);null!==t&&N(b,t.startTime-e)}}function w(e,n){m=!1,g&&(g=!1,_(A),A=-1),f=!0;var o=p;try{for(x(n),d=r(c);null!==d&&(!(d.expirationTime>n)||e&&!k());){var a=d.callback;if("function"===typeof a){d.callback=null,p=d.priorityLevel;var s=a(d.expirationTime<=n);n=t.unstable_now(),"function"===typeof s?d.callback=s:d===r(c)&&i(c),x(n)}else i(c);d=r(c)}if(null!==d)var l=!0;else{var h=r(u);null!==h&&N(b,h.startTime-n),l=!1}return l}finally{d=null,p=o,f=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var S,T=!1,E=null,A=-1,M=5,P=-1;function k(){return!(t.unstable_now()-P<M)}function C(){if(null!==E){var e=t.unstable_now();P=e;var n=!0;try{n=E(!0,e)}finally{n?S():(T=!1,E=null)}}else T=!1}if("function"===typeof v)S=function(){v(C)};else if("undefined"!==typeof MessageChannel){var j=new MessageChannel,I=j.port2;j.port1.onmessage=C,S=function(){I.postMessage(null)}}else S=function(){y(C,0)};function O(e){E=e,T||(T=!0,S())}function N(e,n){A=y((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||f||(m=!0,O(w))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,i,o){var a=t.unstable_now();switch("object"===typeof o&&null!==o?o="number"===typeof(o=o.delay)&&0<o?a+o:a:o=a,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:h++,callback:i,priorityLevel:e,startTime:o,expirationTime:s=o+s,sortIndex:-1},o>a?(e.sortIndex=o,n(u,e),null===r(c)&&e===r(u)&&(g?(_(A),A=-1):g=!0,N(b,o-a))):(e.sortIndex=s,n(c,e),m||f||(m=!0,O(w))),e},t.unstable_shouldYield=k,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},8853:(e,t,n)=>{"use strict";e.exports=n(7234)},8249:e=>{"use strict";e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAABSCAMAAAAhFXfZAAAC91BMVEVMaXEzeak2f7I4g7g3g7cua5gzeKg8hJo3grY4g7c3grU0gLI2frE0daAubJc2gbQwd6QzeKk2gLMtd5sxdKIua5g1frA2f7IydaM0e6w2fq41fK01eqo3grgubJgta5cxdKI1f7AydaQydaMxc6EubJgvbJkwcZ4ubZkwcJwubZgubJcydqUydKIxapgubJctbJcubZcubJcvbJYubJcvbZkubJctbJctbZcubJg2f7AubJcrbZcubJcubJcua5g3grY0fq8ubJcubJdEkdEwhsw6i88vhswuhcsuhMtBjMgthMsrg8srgss6is8qgcs8i9A9iMYtg8spgcoogMo7hcMngMonf8olfso4gr8kfck5iM8jfMk4iM8he8k1fro7itAgesk2hs8eecgzfLcofssdeMg0hc4cd8g2hcsxeLQbdsgZdcgxeLImfcszhM0vda4xgckzhM4xg84wf8Yxgs4udKsvfcQucqhUndROmdM1fK0wcZ8vb5w0eqpQm9MzeKhXoNVcpdYydKNWn9VZotVKltJFjsIwcJ1Rms9OlslLmtH///8+kc9epdYzd6dbo9VHkMM2f7FHmNBClM8ydqVcpNY9hro3gLM9hLczealQmcw3fa46f7A8gLMxc6I3eagyc6FIldJMl9JSnNRSntNNl9JPnNJFi75UnM9ZodVKksg8kM45jc09e6ZHltFBk883gbRBh7pDk9EwcaBzn784g7dKkcY2i81Om9M7j85Llc81is09g7Q4grY/j9A0eqxKmdFFltBEjcXf6fFImdBCiLxJl9FGlNFBi78yiMxVndEvbpo6js74+vx+psPP3+o/ks5HkcpGmNCjwdZCkNDM3ehYoNJEls+lxNkxh8xHks0+jdC1zd5Lg6r+/v/H2ufz9/o3jM3t8/edvdM/k89Th61OiLBSjbZklbaTt9BfptdjmL1AicBHj8hGk9FAgK1dkLNTjLRekrdClc/k7fM0icy0y9tgp9c4jc2NtM9Dlc8zicxeXZn3AAAAQ3RSTlMAHDdTb4yPA+LtnEQmC4L2EmHqB7XA0d0sr478x4/Yd5i1zOfyPkf1sLVq4Nh3FvjxopQ2/STNuFzUwFIwxKaejILpIBEV9wAABhVJREFUeF6s1NdyFEcYBeBeoQIhRAkLlRDGrhIgY3BJL8CVeKzuyXFzzjkn5ZxzzuScg3PO8cKzu70JkO0LfxdTU//pM9vTu7Xgf6KqOVTb9X7toRrVEfBf1HTVjZccrT/2by1VV928Yty9ZbVuucdz90frG8DBjl9pVApbOstvmMuvVgaNXSfAAd6pGxpy6yxf5ph43pS/4f3uoaGm2rdu72S9xzOvMymkZFq/ptDrk90mhW7e4zl7HLzhxGWPR20xmSxJ/VqldG5m9XhaVOA1DadsNh3Pu5L2N6QtPO/32JpqQBVVk20oy/Pi2s23WEvyfHbe1thadVQttvm7Llf65gGmXK67XtupyoM7HQhmXdLS8oGWJNeOJ3C5fG5XCEJnkez3/oFdsvgJ4l2ANZwhrJKk/7OSXa+3Vw2WJMlKnGkobouYk6T0TyX30klOUnTD9HJ5qpckL3EW/w4XF3Xd0FGywXUrstrclVsqz5Pd/sXFYyDnPdrLcQODmGOK47IZb4CmibmMn+MYRzFZ5jg33ZL/EJrWcszHmANy3ARBK/IXtciJy8VsitPSdE3uuHxzougojcUdr8/32atnz/ev3f/K5wtpxUTpcaI45zusVDpYtZi+jg0oU9b3x74h7+n9ABvYEZeKaVq0sh0AtLKsFtqNBdeT0MrSzwwlq9+x6xAO4tgOtSzbCjrNQQiNvQUbUEubvzBUeGw26yDCsRHCoLkTHDa7IdOLIThs/gHvChszh2CimE8peRs47cxANI0lYNB5y1DljpOF0IhzBDPOZnDOqYYbeGKECbPzWnXludPphw5c2YBq5zlwXphIbO4VDCZ0gnPfUO1TwZoYwAs2ExPCedAu9DAjfQUjzITQb3jNj0KG2Sgt6BHaQUdYzWz+XmBktOHwanXjaSTcwwziBcuMOtwBmqPrTOxFQR/DRKKPqyur0aiW6cULYsx6tBm0jXpR/AUWR6HRq9WVW6MRhIq5jLyjbaCTDCijyYJNpCajdyobP/eTw0iexBAKkJ3gA5KcQb2zBXsIBckn+xVv8jkZSaEFHE+jFEleAEfayRU0MouNoBmB/L50Ai/HSLIHxcrpCvnhSQAuakKp2C/YbCylJjXRVy/z3+Kv/RrNcCo+WUzlVEhzKffnTQnxeN9fWF88fiNCUdSTsaufaChKWInHeysygfpIqagoakW+vV20J8uyl6TyNKEZWV4oRSPyCkWpgOLSbkCObT8o2r6tlG58HQquf6O0v50tB7JM7F4EORd2dx/K0w/KHsVkLPaoYrwgP/y7krr3SSMA4zj+OBgmjYkxcdIJQyQRKgg2viX9Hddi9UBb29LrKR7CVVEEEXWojUkXNyfTNDE14W9gbHJNuhjDettN3ZvbOvdOqCD3Jp/9l+/wJE+9PkYGjx/fqkys3S2rMozM/o2106rfMUINo6hVqz+eu/hd1c4xTg0TAfy5kV+4UG6+IthHTU9woWmxuKNbTfuCSfovBCxq7EtHqvYL4Sm6F8GVxsSXHMQ07TOi1DKtZxjWaaIyi4CXWjxPccUw8WVbMYY5wxC1mzEyXMJWkllpRloi+Kkoq69sxBTlElF6aAxYUbjXNlhlDZilDnM4U5SlN5biRsRHnbx3mbeWjEh4mEyiuJDl5XcWVmX5GvNkFgLWZM5qwsop4/AWfLhU1cR7k1VVvcYCWRkOI6Xy5gmnphCYIkvzuNYzHzosq2oNk2RtSs8khfUOfHIDgR6ysYBaMpl4uEgk2U/oJTs9AaTSwma7dT69geAE2ZpEjUsn2ieJNHeKfrI3EcAGJ2ZaNgVuC8EBctCLc57P5u5led6IOBkIYkuQMrmmjChs4VkfOerHqSBkPzZlhe06RslZ3zMjk2sscqKwY0RcjKK+LWbzd7KiHhkncs/siFJ+V5eXxD34B8nVuJEpGJNmxN2gH3vSvp7J70tF+D1Ej8qUJD1TkErAND2GZwTFg/LubvmgiBG3SOvdlsqFQrkEzJCL1rstlnVFROixZoDDSuXQFHESwVGlcuQcMb/b42NgjLowh5MTDFE3vNB5qStRIErdCQEh6pLPR92anSUb/wAIhldAaDMpGgAAAABJRU5ErkJggg=="},7024:e=>{"use strict";e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAApCAYAAADAk4LOAAAFgUlEQVR4Aa1XA5BjWRTN2oW17d3YaZtr2962HUzbDNpjszW24mRt28p47v7zq/bXZtrp/lWnXr337j3nPCe85NcypgSFdugCpW5YoDAMRaIMqRi6aKq5E3YqDQO3qAwjVWrD8Ncq/RBpykd8oZUb/kaJutow8r1aP9II0WmLKLIsJyv1w/kqw9Ch2MYdB++12Onxee/QMwvf4/Dk/Lfp/i4nxTXtOoQ4pW5Aj7wpici1A9erdAN2OH64x8OSP9j3Ft3b7aWkTg/Fm91siTra0f9on5sQr9INejH6CUUUpavjFNq1B+Oadhxmnfa8RfEmN8VNAsQhPqF55xHkMzz3jSmChWU6f7/XZKNH+9+hBLOHYozuKQPxyMPUKkrX/K0uWnfFaJGS1QPRtZsOPtr3NsW0uyh6NNCOkU3Yz+bXbT3I8G3xE5EXLXtCXbbqwCO9zPQYPRTZ5vIDXD7U+w7rFDEoUUf7ibHIR4y6bLVPXrz8JVZEql13trxwue/uDivd3fkWRbS6/IA2bID4uk0UpF1N8qLlbBlXs4Ee7HLTfV1j54APvODnSfOWBqtKVvjgLKzF5YdEk5ewRkGlK0i33Eofffc7HT56jD7/6U+qH3Cx7SBLNntH5YIPvODnyfIXZYRVDPqgHtLs5ABHD3YzLuespb7t79FY34DjMwrVrcTuwlT55YMPvOBnRrJ4VXTdNnYug5ucHLBjEpt30701A3Ts+HEa73u6dT3FNWwflY86eMHPk+Yu+i6pzUpRrW7SNDg5JHR4KapmM5Wv2E8Tfcb1HoqqHMHU+uWDD7zg54mz5/2BSnizi9T1Dg4QQXLToGNCkb6tb1NU+QAlGr1++eADrzhn/u8Q2YZhQVlZ5+CAOtqfbhmaUCS1ezNFVm2imDbPmPng5wmz+gwh+oHDce0eUtQ6OGDIyR0uUhUsoO3vfDmmgOezH0mZN59x7MBi++WDL1g/eEiU3avlidO671bkLfwbw5XV2P8Pzo0ydy4t2/0eu33xYSOMOD8hTf4CrBtGMSoXfPLchX+J0ruSePw3LZeK0juPJbYzrhkH0io7B3k164hiGvawhOKMLkrQLyVpZg8rHFW7E2uHOL888IBPlNZ1FPzstSJM694fWr6RwpvcJK60+0HCILTBzZLFNdtAzJaohze60T8qBzyh5ZuOg5e7uwQppofEmf2++DYvmySqGBuKaicF1blQjhuHdvCIMvp8whTTfZzI7RldpwtSzL+F1+wkdZ2TBOW2gIF88PBTzD/gpeREAMEbxnJcaJHNHrpzji0gQCS6hdkEeYt9DF/2qPcEC8RM28Hwmr3sdNyht00byAut2k3gufWNtgtOEOFGUwcXWNDbdNbpgBGxEvKkOQsxivJx33iow0Vw5S6SVTrpVq11ysA2Rp7gTfPfktc6zhtXBBC+adRLshf6sG2RfHPZ5EAc4sVZ83yCN00Fk/4kggu40ZTvIEm5g24qtU4KjBrx/BTTH8ifVASAG7gKrnWxJDcU7x8X6Ecczhm3o6YicvsLXWfh3Ch1W0k8x0nXF+0fFxgt4phz8QvypiwCCFKMqXCnqXExjq10beH+UUA7+nG6mdG/Pu0f3LgFcGrl2s0kNNjpmoJ9o4B29CMO8dMT4Q5ox8uitF6fqsrJOr8qnwNbRzv6hSnG5wP+64C7h9lp30hKNtKdWjtdkbuPA19nJ7Tz3zR/ibgARbhb4AlhavcBebmTHcFl2fvYEnW0ox9xMxKBS8btJ+KiEbq9zA4RthQXDhPa0T9TEe69gWupwc6uBUphquXgf+/FrIjweHQS4/pduMe5ERUMHUd9xv8ZR98CxkS4F2n3EUrUZ10EYNw7BWm9x1GiPssi3GgiGRDKWRYZfXlON+dfNbM+GgIwYdwAAAAASUVORK5CYII="},1071:e=>{"use strict";e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAQAAAACach9AAACMUlEQVR4Ae3ShY7jQBAE0Aoz/f9/HTMzhg1zrdKUrJbdx+Kd2nD8VNudfsL/Th///dyQN2TH6f3y/BGpC379rV+S+qqetBOxImNQXL8JCAr2V4iMQXHGNJxeCfZXhSRBcQMfvkOWUdtfzlLgAENmZDcmo2TVmt8OSM2eXxBp3DjHSMFutqS7SbmemzBiR+xpKCNUIRkdkkYxhAkyGoBvyQFEJEefwSmmvBfJuJ6aKqKWnAkvGZOaZXTUgFqYULWNSHUckZuR1HIIimUExutRxwzOLROIG4vKmCKQt364mIlhSyzAf1m9lHZHJZrlAOMMztRRiKimp/rpdJDc9Awry5xTZCte7FHtuS8wJgeYGrex28xNTd086Dik7vUMscQOa8y4DoGtCCSkAKlNwpgNtphjrC6MIHUkR6YWxxs6Sc5xqn222mmCRFzIt8lEdKx+ikCtg91qS2WpwVfBelJCiQJwvzixfI9cxZQWgiSJelKnwBElKYtDOb2MFbhmUigbReQBV0Cg4+qMXSxXSyGUn4UbF8l+7qdSGnTC0XLCmahIgUHLhLOhpVCtw4CzYXvLQWQbJNmxoCsOKAxSgBJno75avolkRw8iIAFcsdc02e9iyCd8tHwmeSSoKTowIgvscSGZUOA7PuCN5b2BX9mQM7S0wYhMNU74zgsPBj3HU7wguAfnxxjFQGBE6pwN+GjME9zHY7zGp8wVxMShYX9NXvEWD3HbwJf4giO4CFIQxXScH1/TM+04kkBiAAAAAElFTkSuQmCC"},2806:(e,t,n)=>{"use strict";e.exports=n.p+"static/media/logo.7746efb1cfc3250c9556.png"},3693:(e,t,n)=>{var r=n(7736);e.exports=function(e,t,n){return(t=r(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},e.exports.__esModule=!0,e.exports.default=e.exports},2897:(e,t,n)=>{var r=n(3693);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}e.exports=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e},e.exports.__esModule=!0,e.exports.default=e.exports},1847:(e,t,n)=>{var r=n(4893);e.exports=function(e,t){if(null==e)return{};var n,i,o=r(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],t.includes(n)||{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o},e.exports.__esModule=!0,e.exports.default=e.exports},4893:e=>{e.exports=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.includes(r))continue;n[r]=e[r]}return n},e.exports.__esModule=!0,e.exports.default=e.exports},9045:(e,t,n)=>{var r=n(3738).default;e.exports=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=r(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)},e.exports.__esModule=!0,e.exports.default=e.exports},7736:(e,t,n)=>{var r=n(3738).default,i=n(9045);e.exports=function(e){var t=i(e,"string");return"symbol"==r(t)?t:t+""},e.exports.__esModule=!0,e.exports.default=e.exports},3738:e=>{function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}n.m=e,n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),n.p="/ff360/",n.b=document.baseURI||self.location.href,(()=>{"use strict";var e={};n.r(e),n.d(e,{scaleBand:()=>py,scaleDiverging:()=>Hw,scaleDivergingLog:()=>Zw,scaleDivergingPow:()=>Ww,scaleDivergingSqrt:()=>Xw,scaleDivergingSymlog:()=>qw,scaleIdentity:()=>Rv,scaleImplicit:()=>hy,scaleLinear:()=>zv,scaleLog:()=>Wv,scaleOrdinal:()=>dy,scalePoint:()=>my,scalePow:()=>nx,scaleQuantile:()=>fx,scaleQuantize:()=>mx,scaleRadial:()=>ox,scaleSequential:()=>zw,scaleSequentialLog:()=>Rw,scaleSequentialPow:()=>Bw,scaleSequentialQuantile:()=>Uw,scaleSequentialSqrt:()=>Vw,scaleSequentialSymlog:()=>Fw,scaleSqrt:()=>rx,scaleSymlog:()=>Jv,scaleThreshold:()=>gx,scaleTime:()=>Ow,scaleUtc:()=>Nw,tickFormat:()=>Dv});var t=n(5043),r=n(7950);function i(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.includes(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.includes(n)||{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function a(e){var t=function(e,t){if("object"!=o(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==o(t)?t:t+""}function s(e,t,n){return(t=a(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}n(4358);const u=["page"],h=["page","matches"],d=["onClick","discover","prefetch","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],p=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],f=["discover","fetcherKey","navigate","reloadDocument","replace","state","method","action","onSubmit","relative","preventScrollReset","viewTransition"];var m="popstate";function g(){return S((function(e,t){let{pathname:n="/",search:r="",hash:i=""}=w(e.location.hash.substring(1));return n.startsWith("/")||n.startsWith(".")||(n="/"+n),x("",{pathname:n,search:r,hash:i},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){let n=e.document.querySelector("base"),r="";if(n&&n.getAttribute("href")){let t=e.location.href,n=t.indexOf("#");r=-1===n?t:t.slice(0,n)}return r+"#"+("string"===typeof t?t:b(t))}),(function(e,t){_("/"===e.pathname.charAt(0),"relative pathnames are not supported in hash history.push(".concat(JSON.stringify(t),")"))}),arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}function y(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function _(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(n){}}}function v(e,t){return{usr:e.state,key:e.key,idx:t}}function x(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;return c(c({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?w(t):t),{},{state:n,key:t&&t.key||r||Math.random().toString(36).substring(2,10)})}function b(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),r&&"#"!==r&&(t+="#"===r.charAt(0)?r:"#"+r),t}function w(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substring(n),e=e.substring(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substring(r),e=e.substring(0,r)),e&&(t.pathname=e)}return t}function S(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},{window:i=document.defaultView,v5Compat:o=!1}=r,a=i.history,s="POP",l=null,u=h();function h(){return(a.state||{idx:null}).idx}function d(){s="POP";let e=h(),t=null==e?null:e-u;u=e,l&&l({action:s,location:f.location,delta:t})}function p(e){let t="null"!==i.location.origin?i.location.origin:i.location.href,n="string"===typeof e?e:b(e);return n=n.replace(/ $/,"%20"),y(t,"No window.location.(origin|href) available to create URL for href: ".concat(n)),new URL(n,t)}null==u&&(u=0,a.replaceState(c(c({},a.state),{},{idx:u}),""));let f={get action(){return s},get location(){return e(i,a)},listen(e){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(m,d),l=e,()=>{i.removeEventListener(m,d),l=null}},createHref:e=>t(i,e),createURL:p,encodeLocation(e){let t=p(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){s="PUSH";let r=x(f.location,e,t);n&&n(r,e),u=h()+1;let c=v(r,u),d=f.createHref(r);try{a.pushState(c,"",d)}catch(p){if(p instanceof DOMException&&"DataCloneError"===p.name)throw p;i.location.assign(d)}o&&l&&l({action:s,location:f.location,delta:1})},replace:function(e,t){s="REPLACE";let r=x(f.location,e,t);n&&n(r,e),u=h();let i=v(r,u),c=f.createHref(r);a.replaceState(i,"",c),o&&l&&l({action:s,location:f.location,delta:0})},go:e=>a.go(e)};return f}function T(e,t){return E(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/",!1)}function E(e,t,n,r){let i=F(("string"===typeof t?w(t):t).pathname||"/",n);if(null==i)return null;let o=A(e);!function(e){e.sort(((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every(((e,n)=>e===t[n]));return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((e=>e.childrenIndex)),t.routesMeta.map((e=>e.childrenIndex)))))}(o);let a=null;for(let s=0;null==a&&s<o.length;++s){let e=R(i);a=L(o[s],e,r)}return a}function A(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=(e,i,o)=>{let a={relativePath:void 0===o?e.path||"":o,caseSensitive:!0===e.caseSensitive,childrenIndex:i,route:e};a.relativePath.startsWith("/")&&(y(a.relativePath.startsWith(r),'Absolute route path "'.concat(a.relativePath,'" nested under path "').concat(r,'" is not valid. An absolute child route path must start with the combined path of all its parent routes.')),a.relativePath=a.relativePath.slice(r.length));let s=H([r,a.relativePath]),l=n.concat(a);e.children&&e.children.length>0&&(y(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'.concat(s,'".')),A(e.children,t,l,s)),(null!=e.path||e.index)&&t.push({path:s,score:D(s,e.index),routesMeta:l})};return e.forEach(((e,t)=>{var n;if(""!==e.path&&null!==(n=e.path)&&void 0!==n&&n.includes("?"))for(let r of M(e.path))i(e,t,r);else i(e,t)})),t}function M(e){let t=e.split("/");if(0===t.length)return[];let[n,...r]=t,i=n.endsWith("?"),o=n.replace(/\?$/,"");if(0===r.length)return i?[o,""]:[o];let a=M(r.join("/")),s=[];return s.push(...a.map((e=>""===e?o:[o,e].join("/")))),i&&s.push(...a),s.map((t=>e.startsWith("/")&&""===t?"/":t))}var P=/^:[\w-]+$/,k=3,C=2,j=1,I=10,O=-2,N=e=>"*"===e;function D(e,t){let n=e.split("/"),r=n.length;return n.some(N)&&(r+=O),t&&(r+=C),n.filter((e=>!N(e))).reduce(((e,t)=>e+(P.test(t)?k:""===t?j:I)),r)}function L(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{routesMeta:r}=e,i={},o="/",a=[];for(let s=0;s<r.length;++s){let e=r[s],l=s===r.length-1,c="/"===o?t:t.slice(o.length)||"/",u=z({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),h=e.route;if(!u&&l&&n&&!r[r.length-1].route.index&&(u=z({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!u)return null;Object.assign(i,u.params),a.push({params:i,pathname:H([o,u.pathname]),pathnameBase:Z(H([o,u.pathnameBase])),route:h}),"/"!==u.pathnameBase&&(o=H([o,u.pathnameBase]))}return a}function z(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];_("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'.concat(e,'" will be treated as if it were "').concat(e.replace(/\*$/,"/*"),'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "').concat(e.replace(/\*$/,"/*"),'".'));let r=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,((e,t,n)=>(r.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)")));e.endsWith("*")?(r.push({paramName:"*"}),i+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":""!==e&&"/"!==e&&(i+="(?:(?=\\/|$))");let o=new RegExp(i,t?void 0:"i");return[o,r]}(e.path,e.caseSensitive,e.end),i=t.match(n);if(!i)return null;let o=i[0],a=o.replace(/(.)\/+$/,"$1"),s=i.slice(1),l=r.reduce(((e,t,n)=>{let{paramName:r,isOptional:i}=t;if("*"===r){let e=s[n]||"";a=o.slice(0,o.length-e.length).replace(/(.)\/+$/,"$1")}const l=s[n];return e[r]=i&&!l?void 0:(l||"").replace(/%2F/g,"/"),e}),{});return{params:l,pathname:o,pathnameBase:a,pattern:e}}function R(e){try{return e.split("/").map((e=>decodeURIComponent(e).replace(/\//g,"%2F"))).join("/")}catch(t){return _(!1,'The URL path "'.concat(e,'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding (').concat(t,").")),e}}function F(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&"/"!==r?null:e.slice(n)||"/"}function B(e,t,n,r){return"Cannot include a '".concat(e,"' character in a manually specified `to.").concat(t,"` field [").concat(JSON.stringify(r),"].  Please separate it out to the `to.").concat(n,'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.')}function V(e){return e.filter(((e,t)=>0===t||e.route.path&&e.route.path.length>0))}function U(e){let t=V(e);return t.map(((e,n)=>n===t.length-1?e.pathname:e.pathnameBase))}function G(e,t,n){let r,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];"string"===typeof e?r=w(e):(r=c({},e),y(!r.pathname||!r.pathname.includes("?"),B("?","pathname","search",r)),y(!r.pathname||!r.pathname.includes("#"),B("#","pathname","hash",r)),y(!r.search||!r.search.includes("#"),B("#","search","hash",r)));let o,a=""===e||""===r.pathname,s=a?"/":r.pathname;if(null==s)o=n;else{let e=t.length-1;if(!i&&s.startsWith("..")){let t=s.split("/");for(;".."===t[0];)t.shift(),e-=1;r.pathname=t.join("/")}o=e>=0?t[e]:"/"}let l=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/",{pathname:n,search:r="",hash:i=""}="string"===typeof e?w(e):e,o=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)})),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:o,search:q(r),hash:W(i)}}(r,o),u=s&&"/"!==s&&s.endsWith("/"),h=(a||"."===s)&&n.endsWith("/");return l.pathname.endsWith("/")||!u&&!h||(l.pathname+="/"),l}var H=e=>e.join("/").replace(/\/\/+/g,"/"),Z=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),q=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",W=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";function X(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}var Y=["POST","PUT","PATCH","DELETE"],K=(new Set(Y),["GET",...Y]);new Set(K),Symbol("ResetLoaderData");var J=t.createContext(null);J.displayName="DataRouter";var Q=t.createContext(null);Q.displayName="DataRouterState";var $=t.createContext({isTransitioning:!1});$.displayName="ViewTransition";var ee=t.createContext(new Map);ee.displayName="Fetchers";var te=t.createContext(null);te.displayName="Await";var ne=t.createContext(null);ne.displayName="Navigation";var re=t.createContext(null);re.displayName="Location";var ie=t.createContext({outlet:null,matches:[],isDataRoute:!1});ie.displayName="Route";var oe=t.createContext(null);oe.displayName="RouteError";function ae(){return null!=t.useContext(re)}function se(){return y(ae(),"useLocation() may be used only in the context of a <Router> component."),t.useContext(re).location}var le="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function ce(e){t.useContext(ne).static||t.useLayoutEffect(e)}function ue(){let{isDataRoute:e}=t.useContext(ie);return e?function(){let{router:e}=ve("useNavigate"),n=be("useNavigate"),r=t.useRef(!1);ce((()=>{r.current=!0}));let i=t.useCallback((async function(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_(r.current,le),r.current&&("number"===typeof t?e.navigate(t):await e.navigate(t,c({fromRouteId:n},i)))}),[e,n]);return i}():function(){y(ae(),"useNavigate() may be used only in the context of a <Router> component.");let e=t.useContext(J),{basename:n,navigator:r}=t.useContext(ne),{matches:i}=t.useContext(ie),{pathname:o}=se(),a=JSON.stringify(U(i)),s=t.useRef(!1);ce((()=>{s.current=!0}));let l=t.useCallback((function(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(_(s.current,le),!s.current)return;if("number"===typeof t)return void r.go(t);let l=G(t,JSON.parse(a),o,"path"===i.relative);null==e&&"/"!==n&&(l.pathname="/"===l.pathname?n:H([n,l.pathname])),(i.replace?r.replace:r.push)(l,i.state,i)}),[n,r,a,o,e]);return l}()}t.createContext(null);function he(e){let{relative:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{matches:r}=t.useContext(ie),{pathname:i}=se(),o=JSON.stringify(U(r));return t.useMemo((()=>G(e,JSON.parse(o),i,"path"===n)),[e,o,i,n])}function de(e,n,r,i){y(ae(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:o}=t.useContext(ne),{matches:a}=t.useContext(ie),s=a[a.length-1],l=s?s.params:{},u=(s&&s.pathname,s?s.pathnameBase:"/");s&&s.route;let h,d=se();if(n){var p;let e="string"===typeof n?w(n):n;y("/"===u||(null===(p=e.pathname)||void 0===p?void 0:p.startsWith(u)),'When overriding the location using `<Routes location>` or `useRoutes(routes, location)`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "'.concat(u,'" but pathname "').concat(e.pathname,'" was given in the `location` prop.')),h=e}else h=d;let f=h.pathname||"/",m=f;if("/"!==u){let e=u.replace(/^\//,"").split("/");m="/"+f.replace(/^\//,"").split("/").slice(e.length).join("/")}let g=T(e,{pathname:m});let _=ye(g&&g.map((e=>Object.assign({},e,{params:Object.assign({},l,e.params),pathname:H([u,o.encodeLocation?o.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?u:H([u,o.encodeLocation?o.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])}))),a,r,i);return n&&_?t.createElement(re.Provider,{value:{location:c({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:"POP"}},_):_}function pe(){let e=we(),n=X(e)?"".concat(e.status," ").concat(e.statusText):e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,i="rgba(200,200,200, 0.5)",o={padding:"0.5rem",backgroundColor:i},a=null;return t.createElement(t.Fragment,null,t.createElement("h2",null,"Unexpected Application Error!"),t.createElement("h3",{style:{fontStyle:"italic"}},n),r?t.createElement("pre",{style:o},r):null,a)}var fe=t.createElement(pe,null),me=class extends t.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?t.createElement(ie.Provider,{value:this.props.routeContext},t.createElement(oe.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function ge(e){let{routeContext:n,match:r,children:i}=e,o=t.useContext(J);return o&&o.static&&o.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(o.staticContext._deepestRenderedBoundaryId=r.route.id),t.createElement(ie.Provider,{value:n},i)}function ye(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(null==e){if(!r)return null;if(r.errors)e=r.matches;else{if(0!==n.length||r.initialized||!(r.matches.length>0))return null;e=r.matches}}let i=e,o=null===r||void 0===r?void 0:r.errors;if(null!=o){let e=i.findIndex((e=>e.route.id&&void 0!==(null===o||void 0===o?void 0:o[e.route.id])));y(e>=0,"Could not find a matching route for errors on route IDs: ".concat(Object.keys(o).join(","))),i=i.slice(0,Math.min(i.length,e+1))}let a=!1,s=-1;if(r)for(let t=0;t<i.length;t++){let e=i[t];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(s=t),e.route.id){let{loaderData:t,errors:n}=r,o=e.route.loader&&!t.hasOwnProperty(e.route.id)&&(!n||void 0===n[e.route.id]);if(e.route.lazy||o){a=!0,i=s>=0?i.slice(0,s+1):[i[0]];break}}}return i.reduceRight(((e,l,c)=>{let u,h=!1,d=null,p=null;r&&(u=o&&l.route.id?o[l.route.id]:void 0,d=l.route.errorElement||fe,a&&(s<0&&0===c?(Te("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),h=!0,p=null):s===c&&(h=!0,p=l.route.hydrateFallbackElement||null)));let f=n.concat(i.slice(0,c+1)),m=()=>{let n;return n=u?d:h?p:l.route.Component?t.createElement(l.route.Component,null):l.route.element?l.route.element:e,t.createElement(ge,{match:l,routeContext:{outlet:e,matches:f,isDataRoute:null!=r},children:n})};return r&&(l.route.ErrorBoundary||l.route.errorElement||0===c)?t.createElement(me,{location:r.location,revalidation:r.revalidation,component:d,error:u,children:m(),routeContext:{outlet:null,matches:f,isDataRoute:!0}}):m()}),null)}function _e(e){return"".concat(e," must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.")}function ve(e){let n=t.useContext(J);return y(n,_e(e)),n}function xe(e){let n=t.useContext(Q);return y(n,_e(e)),n}function be(e){let n=function(e){let n=t.useContext(ie);return y(n,_e(e)),n}(e),r=n.matches[n.matches.length-1];return y(r.route.id,"".concat(e,' can only be used on routes that contain a unique "id"')),r.route.id}function we(){var e;let n=t.useContext(oe),r=xe("useRouteError"),i=be("useRouteError");return void 0!==n?n:null===(e=r.errors)||void 0===e?void 0:e[i]}var Se={};function Te(e,t,n){t||Se[e]||(Se[e]=!0,_(!1,n))}t.memo((function(e){let{routes:t,future:n,state:r}=e;return de(t,void 0,r,n)}));function Ee(e){y(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Ae(e){let{basename:n="/",children:r=null,location:i,navigationType:o="POP",navigator:a,static:s=!1}=e;y(!ae(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=n.replace(/^\/*/,"/"),c=t.useMemo((()=>({basename:l,navigator:a,static:s,future:{}})),[l,a,s]);"string"===typeof i&&(i=w(i));let{pathname:u="/",search:h="",hash:d="",state:p=null,key:f="default"}=i,m=t.useMemo((()=>{let e=F(u,l);return null==e?null:{location:{pathname:e,search:h,hash:d,state:p,key:f},navigationType:o}}),[l,u,h,d,p,f,o]);return _(null!=m,'<Router basename="'.concat(l,'"> is not able to match the URL "').concat(u).concat(h).concat(d,"\" because it does not start with the basename, so the <Router> won't render anything.")),null==m?null:t.createElement(ne.Provider,{value:c},t.createElement(re.Provider,{children:r,value:m}))}function Me(e){let{children:t,location:n}=e;return de(Pe(t),n)}t.Component;function Pe(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=[];return t.Children.forEach(e,((e,i)=>{if(!t.isValidElement(e))return;let o=[...n,i];if(e.type===t.Fragment)return void r.push.apply(r,Pe(e.props.children,o));y(e.type===Ee,"[".concat("string"===typeof e.type?e.type:e.type.name,"] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>")),y(!e.props.index||!e.props.children,"An index route cannot have child routes.");let a={id:e.props.id||o.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,hydrateFallbackElement:e.props.hydrateFallbackElement,HydrateFallback:e.props.HydrateFallback,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:!0===e.props.hasErrorBoundary||null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(a.children=Pe(e.props.children,o)),r.push(a)})),r}var ke="get",Ce="application/x-www-form-urlencoded";function je(e){return null!=e&&"string"===typeof e.tagName}function Ie(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return new URLSearchParams("string"===typeof e||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce(((t,n)=>{let r=e[n];return t.concat(Array.isArray(r)?r.map((e=>[n,e])):[[n,r]])}),[]))}var Oe=null;var Ne=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function De(e){return null==e||Ne.has(e)?e:(_(!1,'"'.concat(e,'" is not a valid `encType` for `<Form>`/`<fetcher.Form>` and will default to "').concat(Ce,'"')),null)}function Le(e,t){let n,r,i,o,a;if(function(e){return je(e)&&"form"===e.tagName.toLowerCase()}(e)){let a=e.getAttribute("action");r=a?F(a,t):null,n=e.getAttribute("method")||ke,i=De(e.getAttribute("enctype"))||Ce,o=new FormData(e)}else if(function(e){return je(e)&&"button"===e.tagName.toLowerCase()}(e)||function(e){return je(e)&&"input"===e.tagName.toLowerCase()}(e)&&("submit"===e.type||"image"===e.type)){let a=e.form;if(null==a)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let s=e.getAttribute("formaction")||a.getAttribute("action");if(r=s?F(s,t):null,n=e.getAttribute("formmethod")||a.getAttribute("method")||ke,i=De(e.getAttribute("formenctype"))||De(a.getAttribute("enctype"))||Ce,o=new FormData(a,e),!function(){if(null===Oe)try{new FormData(document.createElement("form"),0),Oe=!1}catch(e){Oe=!0}return Oe}()){let{name:t,type:n,value:r}=e;if("image"===n){let e=t?"".concat(t,"."):"";o.append("".concat(e,"x"),"0"),o.append("".concat(e,"y"),"0")}else t&&o.append(t,r)}}else{if(je(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=ke,r=null,i=Ce,a=e}return o&&"text/plain"===i&&(a=o,o=void 0),{action:r,method:n.toLowerCase(),encType:i,formData:o,body:a}}function ze(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}async function Re(e,t){if(e.id in t)return t[e.id];try{let n=await import(e.module);return t[e.id]=n,n}catch(n){return console.error("Error loading route module `".concat(e.module,"`, reloading page...")),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise((()=>{}))}}function Fe(e){return null!=e&&"string"===typeof e.page}function Be(e){return null!=e&&(null==e.href?"preload"===e.rel&&"string"===typeof e.imageSrcSet&&"string"===typeof e.imageSizes:"string"===typeof e.rel&&"string"===typeof e.href)}function Ve(e,t,n,r,i,o){let a=(e,t)=>!n[t]||e.route.id!==n[t].route.id,s=(e,t)=>{var r;return n[t].pathname!==e.pathname||(null===(r=n[t].route.path)||void 0===r?void 0:r.endsWith("*"))&&n[t].params["*"]!==e.params["*"]};return"assets"===o?t.filter(((e,t)=>a(e,t)||s(e,t))):"data"===o?t.filter(((t,o)=>{let l=r.routes[t.route.id];if(!l||!l.hasLoader)return!1;if(a(t,o)||s(t,o))return!0;if(t.route.shouldRevalidate){var c;let r=t.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:(null===(c=n[0])||void 0===c?void 0:c.params)||{},nextUrl:new URL(e,window.origin),nextParams:t.params,defaultShouldRevalidate:!0});if("boolean"===typeof r)return r}return!0})):[]}function Ue(e){return[...new Set(e)]}function Ge(e,t){let n=new Set,r=new Set(t);return e.reduce(((e,i)=>{if(t&&!Fe(i)&&"script"===i.as&&i.href&&r.has(i.href))return e;let o=JSON.stringify(function(e){let t={},n=Object.keys(e).sort();for(let r of n)t[r]=e[r];return t}(i));return n.has(o)||(n.add(o),e.push({key:o,link:i})),e}),[])}function He(e){return{__html:e}}Symbol("SingleFetchRedirect");function Ze(e){let t="string"===typeof e?new URL(e,"undefined"===typeof window?"server://singlefetch/":window.location.origin):e;return"/"===t.pathname?t.pathname="_root.data":t.pathname="".concat(t.pathname.replace(/\/$/,""),".data"),t}t.Component;function qe(e){let{error:n,isOutsideRemixApp:r}=e;console.error(n);let i,o=t.createElement("script",{dangerouslySetInnerHTML:{__html:'\n        console.log(\n          "\ud83d\udcbf Hey developer \ud83d\udc4b. You can provide a way better UX than this when your app throws errors. Check out https://remix.run/guides/errors for more information."\n        );\n      '}});if(X(n))return t.createElement(We,{title:"Unhandled Thrown Response!"},t.createElement("h1",{style:{fontSize:"24px"}},n.status," ",n.statusText),o);if(n instanceof Error)0;else{let e=null==n?"Unknown Error":"object"===typeof n&&"toString"in n?n.toString():JSON.stringify(n);new Error(e)}return t.createElement(We,{title:"Application Error!",isOutsideRemixApp:r},t.createElement("h1",{style:{fontSize:"24px"}},"Application Error"),t.createElement("pre",{style:{padding:"2rem",background:"hsla(10, 50%, 50%, 0.1)",color:"red",overflow:"auto"}},i.stack),o)}function We(e){var n;let{title:r,renderScripts:i,isOutsideRemixApp:o,children:a}=e,{routeModules:s}=Qe();return null!==s.root&&void 0!==n&&n.Layout&&!o?a:t.createElement("html",{lang:"en"},t.createElement("head",null,t.createElement("meta",{charSet:"utf-8"}),t.createElement("meta",{name:"viewport",content:"width=device-width,initial-scale=1,viewport-fit=cover"}),t.createElement("title",null,r)),t.createElement("body",null,t.createElement("main",{style:{fontFamily:"system-ui, sans-serif",padding:"2rem"}},a,i?t.createElement(ot,null):null)))}function Xe(e){return!e}function Ye(){let e=t.useContext(J);return ze(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function Ke(){let e=t.useContext(Q);return ze(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var Je=t.createContext(void 0);function Qe(){let e=t.useContext(Je);return ze(e,"You must render this element inside a <HydratedRouter> element"),e}function $e(e,t){return n=>{e&&e(n),n.defaultPrevented||t(n)}}function et(e,t,n){if(n&&!it)return[e[0]];if(t){let n=e.findIndex((e=>void 0!==t[e.route.id]));return e.slice(0,n+1)}return e}function tt(e){let{page:n}=e,r=i(e,u),{router:o}=Ye(),a=t.useMemo((()=>T(o.routes,n,o.basename)),[o.routes,n,o.basename]);return a?t.createElement(rt,c({page:n,matches:a},r)):(console.warn("Tried to prefetch ".concat(n," but no routes matched.")),null)}function nt(e){let{manifest:n,routeModules:r}=Qe(),[i,o]=t.useState([]);return t.useEffect((()=>{let t=!1;return async function(e,t,n){return Ge((await Promise.all(e.map((async e=>{let r=t.routes[e.route.id];if(r){let e=await Re(r,n);return e.links?e.links():[]}return[]})))).flat(1).filter(Be).filter((e=>"stylesheet"===e.rel||"preload"===e.rel)).map((e=>"stylesheet"===e.rel?c(c({},e),{},{rel:"prefetch",as:"style"}):c(c({},e),{},{rel:"prefetch"}))))}(e,n,r).then((e=>{t||o(e)})),()=>{t=!0}}),[e,n,r]),i}function rt(e){let{page:n,matches:r}=e,o=i(e,h),a=se(),{manifest:s,routeModules:l}=Qe(),{loaderData:u,matches:d}=Ke(),p=t.useMemo((()=>Ve(n,r,d,s,a,"data")),[n,r,d,s,a]),f=t.useMemo((()=>Ve(n,r,d,s,a,"assets")),[n,r,d,s,a]),m=t.useMemo((()=>{if(n===a.pathname+a.search+a.hash)return[];let e=new Set,t=!1;if(r.forEach((n=>{var r;let i=s.routes[n.route.id];i&&i.hasLoader&&(!p.some((e=>e.route.id===n.route.id))&&n.route.id in u&&null!==(r=l[n.route.id])&&void 0!==r&&r.shouldRevalidate||i.hasClientLoader?t=!0:e.add(n.route.id))})),0===e.size)return[];let i=Ze(n);return t&&e.size>0&&i.searchParams.set("_routes",r.filter((t=>e.has(t.route.id))).map((e=>e.route.id)).join(",")),[i.pathname+i.search]}),[u,a,s,p,r,n,l]),g=t.useMemo((()=>function(e,t){return Ue(e.map((e=>{let n=t.routes[e.route.id];if(!n)return[];let r=[n.module];return n.imports&&(r=r.concat(n.imports)),r})).flat(1))}(f,s)),[f,s]),y=nt(f);return t.createElement(t.Fragment,null,m.map((e=>t.createElement("link",c({key:e,rel:"prefetch",as:"fetch",href:e},o)))),g.map((e=>t.createElement("link",c({key:e,rel:"modulepreload",href:e},o)))),y.map((e=>{let{key:n,link:r}=e;return t.createElement("link",c({key:n},r))})))}Je.displayName="FrameworkContext";var it=!1;function ot(e){let{manifest:n,serverHandoffString:r,isSpaMode:i,renderMeta:o}=Qe(),{router:a,static:s,staticContext:l}=Ye(),{matches:u}=Ke(),h=Xe(i);o&&(o.didRenderScripts=!0);let d=et(u,null,i);t.useEffect((()=>{0}),[]);let p=t.useMemo((()=>{var i;let o=l?"window.__reactRouterContext = ".concat(r,";").concat("window.__reactRouterContext.stream = new ReadableStream({start(controller){window.__reactRouterContext.streamController = controller;}}).pipeThrough(new TextEncoderStream());"):" ",u=s?"".concat(null!==n.hmr&&void 0!==i&&i.runtime?"import ".concat(JSON.stringify(n.hmr.runtime),";"):"").concat(h?"":"import ".concat(JSON.stringify(n.url)),";\n").concat(d.map(((e,t)=>"import * as route".concat(t," from ").concat(JSON.stringify(n.routes[e.route.id].module),";"))).join("\n"),"\n  ").concat(h?"window.__reactRouterManifest = ".concat(JSON.stringify(function(e,t){let n=new Set(t.state.matches.map((e=>e.route.id))),r=t.state.location.pathname.split("/").filter(Boolean),i=["/"];for(r.pop();r.length>0;)i.push("/".concat(r.join("/"))),r.pop();i.forEach((e=>{let r=T(t.routes,e,t.basename);r&&r.forEach((e=>n.add(e.route.id)))}));let o=[...n].reduce(((t,n)=>Object.assign(t,{[n]:e.routes[n]})),{});return c(c({},e),{},{routes:o})}(n,a),null,2),";"):"","\n  window.__reactRouterRouteModules = {").concat(d.map(((e,t)=>"".concat(JSON.stringify(e.route.id),":route").concat(t))).join(","),"};\n\nimport(").concat(JSON.stringify(n.entry.module),");"):" ";return t.createElement(t.Fragment,null,t.createElement("script",c(c({},e),{},{suppressHydrationWarning:!0,dangerouslySetInnerHTML:He(o),type:void 0})),t.createElement("script",c(c({},e),{},{suppressHydrationWarning:!0,dangerouslySetInnerHTML:He(u),type:"module",async:!0})))}),[]),f=d.map((e=>{let t=n.routes[e.route.id];return t?(t.imports||[]).concat([t.module]):[]})).flat(1),m=it?[]:n.entry.imports.concat(f);return it?null:t.createElement(t.Fragment,null,h?null:t.createElement("link",{rel:"modulepreload",href:n.url,crossOrigin:e.crossOrigin}),t.createElement("link",{rel:"modulepreload",href:n.entry.module,crossOrigin:e.crossOrigin}),function(e){return[...new Set(e)]}(m).map((n=>t.createElement("link",{key:n,rel:"modulepreload",href:n,crossOrigin:e.crossOrigin}))),p)}function at(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return e=>{t.forEach((t=>{"function"===typeof t?t(e):null!=t&&(t.current=e)}))}}var st="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement;try{st&&(window.__reactRouterVersion="7.0.1")}catch(KL){}function lt(e){let{basename:n,children:r,window:i}=e,o=t.useRef();null==o.current&&(o.current=g({window:i,v5Compat:!0}));let a=o.current,[s,l]=t.useState({action:a.action,location:a.location}),c=t.useCallback((e=>{t.startTransition((()=>l(e)))}),[l]);return t.useLayoutEffect((()=>a.listen(c)),[a,c]),t.createElement(Ae,{basename:n,children:r,location:s.location,navigationType:s.action,navigator:a})}var ct=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ut=t.forwardRef((function(e,n){let r,{onClick:o,discover:a="render",prefetch:s="none",relative:l,reloadDocument:u,replace:h,state:p,target:f,to:m,preventScrollReset:g,viewTransition:v}=e,x=i(e,d),{basename:w}=t.useContext(ne),S="string"===typeof m&&ct.test(m),T=!1;if("string"===typeof m&&S&&(r=m,st))try{let e=new URL(window.location.href),t=m.startsWith("//")?new URL(e.protocol+m):new URL(m),n=F(t.pathname,w);t.origin===e.origin&&null!=n?m=n+t.search+t.hash:T=!0}catch(KL){_(!1,'<Link to="'.concat(m,'"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.'))}let E=function(e){let{relative:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};y(ae(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:i}=t.useContext(ne),{hash:o,pathname:a,search:s}=he(e,{relative:n}),l=a;return"/"!==r&&(l="/"===a?r:H([r,a])),i.createHref({pathname:l,search:s,hash:o})}(m,{relative:l}),[A,M,P]=function(e,n){let r=t.useContext(Je),[i,o]=t.useState(!1),[a,s]=t.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:u,onMouseLeave:h,onTouchStart:d}=n,p=t.useRef(null);t.useEffect((()=>{if("render"===e&&s(!0),"viewport"===e){let e=new IntersectionObserver((e=>{e.forEach((e=>{s(e.isIntersecting)}))}),{threshold:.5});return p.current&&e.observe(p.current),()=>{e.disconnect()}}}),[e]),t.useEffect((()=>{if(i){let e=setTimeout((()=>{s(!0)}),100);return()=>{clearTimeout(e)}}}),[i]);let f=()=>{o(!0)},m=()=>{o(!1),s(!1)};return r?"intent"!==e?[a,p,{}]:[a,p,{onFocus:$e(l,f),onBlur:$e(c,m),onMouseEnter:$e(u,f),onMouseLeave:$e(h,m),onTouchStart:$e(d,f)}]:[!1,p,{}]}(s,x),k=function(e){let{target:n,replace:r,state:i,preventScrollReset:o,relative:a,viewTransition:s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=ue(),c=se(),u=he(e,{relative:a});return t.useCallback((t=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(t,n)){t.preventDefault();let n=void 0!==r?r:b(c)===b(u);l(e,{replace:n,state:i,preventScrollReset:o,relative:a,viewTransition:s})}}),[c,l,u,r,i,n,e,o,a,s])}(m,{replace:h,state:p,target:f,preventScrollReset:g,relative:l,viewTransition:v});let C=t.createElement("a",c(c(c({},x),P),{},{href:r||E,onClick:T||u?o:function(e){o&&o(e),e.defaultPrevented||k(e)},ref:at(n,M),target:f,"data-discover":S||"render"!==a?void 0:"true"}));return A&&!S?t.createElement(t.Fragment,null,C,t.createElement(tt,{page:E})):C}));ut.displayName="Link";var ht=t.forwardRef((function(e,n){let{"aria-current":r="page",caseSensitive:o=!1,className:a="",end:s=!1,style:l,to:u,viewTransition:h,children:d}=e,f=i(e,p),m=he(u,{relative:f.relative}),g=se(),_=t.useContext(Q),{navigator:v,basename:x}=t.useContext(ne),b=null!=_&&function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.useContext($);y(null!=r,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=ft("useViewTransitionState"),o=he(e,{relative:n.relative});if(!r.isTransitioning)return!1;let a=F(r.currentLocation.pathname,i)||r.currentLocation.pathname,s=F(r.nextLocation.pathname,i)||r.nextLocation.pathname;return null!=z(o.pathname,s)||null!=z(o.pathname,a)}(m)&&!0===h,w=v.encodeLocation?v.encodeLocation(m).pathname:m.pathname,S=g.pathname,T=_&&_.navigation&&_.navigation.location?_.navigation.location.pathname:null;o||(S=S.toLowerCase(),T=T?T.toLowerCase():null,w=w.toLowerCase()),T&&x&&(T=F(T,x)||T);const E="/"!==w&&w.endsWith("/")?w.length-1:w.length;let A,M=S===w||!s&&S.startsWith(w)&&"/"===S.charAt(E),P=null!=T&&(T===w||!s&&T.startsWith(w)&&"/"===T.charAt(w.length)),k={isActive:M,isPending:P,isTransitioning:b},C=M?r:void 0;A="function"===typeof a?a(k):[a,M?"active":null,P?"pending":null,b?"transitioning":null].filter(Boolean).join(" ");let j="function"===typeof l?l(k):l;return t.createElement(ut,c(c({},f),{},{"aria-current":C,className:A,ref:n,style:j,to:u,viewTransition:h}),"function"===typeof d?d(k):d)}));ht.displayName="NavLink";var dt=t.forwardRef(((e,n)=>{let{discover:r="render",fetcherKey:o,navigate:a,reloadDocument:s,replace:l,state:u,method:h=ke,action:d,onSubmit:p,relative:m,preventScrollReset:g,viewTransition:_}=e,v=i(e,f),x=_t(),w=function(e){let{relative:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{basename:r}=t.useContext(ne),i=t.useContext(ie);y(i,"useFormAction must be used inside a RouteContext");let[o]=i.matches.slice(-1),a=c({},he(e||".",{relative:n})),s=se();if(null==e){a.search=s.search;let e=new URLSearchParams(a.search),t=e.getAll("index");if(t.some((e=>""===e))){e.delete("index"),t.filter((e=>e)).forEach((t=>e.append("index",t)));let n=e.toString();a.search=n?"?".concat(n):""}}e&&"."!==e||!o.route.index||(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index");"/"!==r&&(a.pathname="/"===a.pathname?r:H([r,a.pathname]));return b(a)}(d,{relative:m}),S="get"===h.toLowerCase()?"get":"post",T="string"===typeof d&&ct.test(d);return t.createElement("form",c(c({ref:n,method:S,action:w,onSubmit:s?p:e=>{if(p&&p(e),e.defaultPrevented)return;e.preventDefault();let t=e.nativeEvent.submitter,n=(null===t||void 0===t?void 0:t.getAttribute("formmethod"))||h;x(t||e.currentTarget,{fetcherKey:o,method:n,navigate:a,replace:l,state:u,relative:m,preventScrollReset:g,viewTransition:_})}},v),{},{"data-discover":T||"render"!==r?void 0:"true"}))}));function pt(e){return"".concat(e," must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.")}function ft(e){let n=t.useContext(J);return y(n,pt(e)),n}function mt(e){_("undefined"!==typeof URLSearchParams,"You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let n=t.useRef(Ie(e)),r=t.useRef(!1),i=se(),o=t.useMemo((()=>function(e,t){let n=Ie(e);return t&&t.forEach(((e,r)=>{n.has(r)||t.getAll(r).forEach((e=>{n.append(r,e)}))})),n}(i.search,r.current?null:n.current)),[i.search]),a=ue(),s=t.useCallback(((e,t)=>{const n=Ie("function"===typeof e?e(o):e);r.current=!0,a("?"+n,t)}),[a,o]);return[o,s]}dt.displayName="Form";var gt=0,yt=()=>"__".concat(String(++gt),"__");function _t(){let{router:e}=ft("useSubmit"),{basename:n}=t.useContext(ne),r=be("useRouteId");return t.useCallback((async function(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{action:o,method:a,encType:s,formData:l,body:c}=Le(t,n);if(!1===i.navigate){let t=i.fetcherKey||yt();await e.fetch(t,r,i.action||o,{preventScrollReset:i.preventScrollReset,formData:l,body:c,formMethod:i.method||a,formEncType:i.encType||s,flushSync:i.flushSync})}else await e.navigate(i.action||o,{preventScrollReset:i.preventScrollReset,formData:l,body:c,formMethod:i.method||a,formEncType:i.encType||s,replace:i.replace,state:i.state,fromRouteId:r,flushSync:i.flushSync,viewTransition:i.viewTransition})}),[e,n,r])}new TextEncoder;const vt=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),xt=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter(((e,t,n)=>Boolean(e)&&""!==e.trim()&&n.indexOf(e)===t)).join(" ").trim()};var bt={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const wt=["color","size","strokeWidth","absoluteStrokeWidth","className","children","iconNode"],St=(0,t.forwardRef)(((e,n)=>{let{color:r="currentColor",size:o=24,strokeWidth:a=2,absoluteStrokeWidth:s,className:l="",children:u,iconNode:h}=e,d=i(e,wt);return(0,t.createElement)("svg",c(c({ref:n},bt),{},{width:o,height:o,stroke:r,strokeWidth:s?24*Number(a)/Number(o):a,className:xt("lucide",l)},d),[...h.map((e=>{let[n,r]=e;return(0,t.createElement)(n,r)})),...Array.isArray(u)?u:[u]])})),Tt=["className"],Et=(e,n)=>{const r=(0,t.forwardRef)(((r,o)=>{let{className:a}=r,s=i(r,Tt);return(0,t.createElement)(St,c({ref:o,iconNode:n,className:xt("lucide-".concat(vt(e)),a)},s))}));return r.displayName="".concat(e),r},At=Et("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),Mt=Et("Coins",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]]),Pt=Et("ChartNoAxesColumn",[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]]),kt=Et("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),Ct=Et("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),jt=Et("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),It=Et("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);var Ot=n(579);const Nt=(0,t.createContext)(null);function Dt(e){const n=(0,t.useRef)(null);return null===n.current&&(n.current=e()),n.current}const Lt=(0,t.createContext)({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});class zt extends t.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const e=this.props.sizeRef.current;e.height=t.offsetHeight||0,e.width=t.offsetWidth||0,e.top=t.offsetTop,e.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function Rt(e){let{children:n,isPresent:r}=e;const i=(0,t.useId)(),o=(0,t.useRef)(null),a=(0,t.useRef)({width:0,height:0,top:0,left:0}),{nonce:s}=(0,t.useContext)(Lt);return(0,t.useInsertionEffect)((()=>{const{width:e,height:t,top:n,left:l}=a.current;if(r||!o.current||!e||!t)return;o.current.dataset.motionPopId=i;const c=document.createElement("style");return s&&(c.nonce=s),document.head.appendChild(c),c.sheet&&c.sheet.insertRule('\n          [data-motion-pop-id="'.concat(i,'"] {\n            position: absolute !important;\n            width: ').concat(e,"px !important;\n            height: ").concat(t,"px !important;\n            top: ").concat(n,"px !important;\n            left: ").concat(l,"px !important;\n          }\n        ")),()=>{document.head.removeChild(c)}}),[r]),(0,Ot.jsx)(zt,{isPresent:r,childRef:o,sizeRef:a,children:t.cloneElement(n,{ref:o})})}const Ft=e=>{let{children:n,initial:r,isPresent:i,onExitComplete:o,custom:a,presenceAffectsLayout:s,mode:l}=e;const c=Dt(Bt),u=(0,t.useId)(),h=(0,t.useCallback)((e=>{c.set(e,!0);for(const t of c.values())if(!t)return;o&&o()}),[c,o]),d=(0,t.useMemo)((()=>({id:u,initial:r,isPresent:i,custom:a,onExitComplete:h,register:e=>(c.set(e,!1),()=>c.delete(e))})),s?[Math.random(),h]:[i,h]);return(0,t.useMemo)((()=>{c.forEach(((e,t)=>c.set(t,!1)))}),[i]),t.useEffect((()=>{!i&&!c.size&&o&&o()}),[i]),"popLayout"===l&&(n=(0,Ot.jsx)(Rt,{isPresent:i,children:n})),(0,Ot.jsx)(Nt.Provider,{value:d,children:n})};function Bt(){return new Map}const Vt=(0,t.createContext)({}),Ut=e=>e;let Gt=Ut,Ht=Ut;const Zt=e=>e.key||"";function qt(e){const n=[];return t.Children.forEach(e,(e=>{(0,t.isValidElement)(e)&&n.push(e)})),n}const Wt="undefined"!==typeof window,Xt=Wt?t.useLayoutEffect:t.useEffect,Yt=e=>{let{children:n,exitBeforeEnter:r,custom:i,initial:o=!0,onExitComplete:a,presenceAffectsLayout:s=!0,mode:l="sync"}=e;Ht(!r,"Replace exitBeforeEnter with mode='wait'");const c=(0,t.useMemo)((()=>qt(n)),[n]),u=c.map(Zt),h=(0,t.useRef)(!0),d=(0,t.useRef)(c),p=Dt((()=>new Map)),[f,m]=(0,t.useState)(c),[g,y]=(0,t.useState)(c);Xt((()=>{h.current=!1,d.current=c;for(let e=0;e<g.length;e++){const t=Zt(g[e]);u.includes(t)?p.delete(t):!0!==p.get(t)&&p.set(t,!1)}}),[g,u.length,u.join("-")]);const _=[];if(c!==f){let e=[...c];for(let t=0;t<g.length;t++){const n=g[t],r=Zt(n);u.includes(r)||(e.splice(t,0,n),_.push(n))}return"wait"===l&&_.length&&(e=_),y(qt(e)),void m(c)}const{forceRender:v}=(0,t.useContext)(Vt);return(0,Ot.jsx)(Ot.Fragment,{children:g.map((e=>{const t=Zt(e),n=c===g||u.includes(t);return(0,Ot.jsx)(Ft,{isPresent:n,initial:!(h.current&&!o)&&void 0,custom:n?void 0:i,presenceAffectsLayout:s,mode:l,onExitComplete:n?void 0:()=>{if(!p.has(t))return;p.set(t,!0);let e=!0;p.forEach((t=>{t||(e=!1)})),e&&(null===v||void 0===v||v(),y(d.current),a&&a())},children:e},t)}))})};function Kt(e){if("undefined"===typeof Proxy)return e;const t=new Map;return new Proxy((function(){return e(...arguments)}),{get:(n,r)=>"create"===r?e:(t.has(r)||t.set(r,e(r)),t.get(r))})}function Jt(e){return null!==e&&"object"===typeof e&&"function"===typeof e.start}const Qt=e=>Array.isArray(e);function $t(e,t){if(!Array.isArray(t))return!1;const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}function en(e){return"string"===typeof e||Array.isArray(e)}function tn(e){const t=[{},{}];return null===e||void 0===e||e.values.forEach(((e,n)=>{t[0][n]=e.get(),t[1][n]=e.getVelocity()})),t}function nn(e,t,n,r){if("function"===typeof t){const[i,o]=tn(r);t=t(void 0!==n?n:e.custom,i,o)}if("string"===typeof t&&(t=e.variants&&e.variants[t]),"function"===typeof t){const[i,o]=tn(r);t=t(void 0!==n?n:e.custom,i,o)}return t}function rn(e,t,n){const r=e.getProps();return nn(r,t,void 0!==n?n:r.custom,e)}const on=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],an=["initial",...on],sn=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],ln=new Set(sn),cn=e=>1e3*e,un=e=>e/1e3,hn={type:"spring",stiffness:500,damping:25,restSpeed:10},dn={type:"keyframes",duration:.8},pn={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},fn=(e,t)=>{let{keyframes:n}=t;return n.length>2?dn:ln.has(e)?e.startsWith("scale")?{type:"spring",stiffness:550,damping:0===n[1]?2*Math.sqrt(550):30,restSpeed:10}:hn:pn};function mn(e,t){return e?e[t]||e.default||e:void 0}const gn=!1,yn=!1,_n=!1,vn=e=>null!==e;function xn(e,t,n){let{repeat:r,repeatType:i="loop"}=t;const o=e.filter(vn),a=r&&"loop"!==i&&r%2===1?0:o.length-1;return a&&void 0!==n?n:o[a]}const bn=["read","resolveKeyframes","update","preRender","render","postRender"];function wn(e,t){let n=!1,r=!0;const i={delta:0,timestamp:0,isProcessing:!1},o=()=>n=!0,a=bn.reduce(((e,t)=>(e[t]=function(e){let t=new Set,n=new Set,r=!1,i=!1;const o=new WeakSet;let a={delta:0,timestamp:0,isProcessing:!1};function s(t){o.has(t)&&(l.schedule(t),e()),t(a)}const l={schedule:function(e){const i=arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&r?t:n;return arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&o.add(e),i.has(e)||i.add(e),e},cancel:e=>{n.delete(e),o.delete(e)},process:e=>{a=e,r?i=!0:(r=!0,[t,n]=[n,t],t.forEach(s),t.clear(),r=!1,i&&(i=!1,l.process(e)))}};return l}(o),e)),{}),{read:s,resolveKeyframes:l,update:c,preRender:u,render:h,postRender:d}=a,p=()=>{const o=yn?i.timestamp:performance.now();n=!1,i.delta=r?1e3/60:Math.max(Math.min(o-i.timestamp,40),1),i.timestamp=o,i.isProcessing=!0,s.process(i),l.process(i),c.process(i),u.process(i),h.process(i),d.process(i),i.isProcessing=!1,n&&t&&(r=!1,e(p))},f=bn.reduce(((t,o)=>{const s=a[o];return t[o]=function(t){let o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return n||(n=!0,r=!0,i.isProcessing||e(p)),s.schedule(t,o,a)},t}),{});return{schedule:f,cancel:e=>{for(let t=0;t<bn.length;t++)a[bn[t]].cancel(e)},state:i,steps:a}}const{schedule:Sn,cancel:Tn,state:En,steps:An}=wn("undefined"!==typeof requestAnimationFrame?requestAnimationFrame:Ut,!0),Mn=(e,t,n)=>(((1-3*n+3*t)*e+(3*n-6*t))*e+3*t)*e;function Pn(e,t,n,r){if(e===t&&n===r)return Ut;const i=t=>function(e,t,n,r,i){let o,a,s=0;do{a=t+(n-t)/2,o=Mn(a,r,i)-e,o>0?n=a:t=a}while(Math.abs(o)>1e-7&&++s<12);return a}(t,0,1,e,n);return e=>0===e||1===e?e:Mn(i(e),t,r)}const kn=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,Cn=e=>t=>1-e(1-t),jn=Pn(.33,1.53,.69,.99),In=Cn(jn),On=kn(In),Nn=e=>(e*=2)<1?.5*In(e):.5*(2-Math.pow(2,-10*(e-1))),Dn=e=>1-Math.sin(Math.acos(e)),Ln=Cn(Dn),zn=kn(Dn),Rn=e=>/^0(?:[\0-\x08\x0E-\x1F!-\x2D\/-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+$/.test(e);function Fn(e){return"number"===typeof e?0===e:null===e||("none"===e||"0"===e||Rn(e))}const Bn=e=>/^-?(?:[0-9]+(?:\.[0-9]+)?|\.[0-9]+)$/.test(e),Vn=e=>t=>"string"===typeof t&&t.startsWith(e),Un=Vn("--"),Gn=Vn("var(--"),Hn=e=>!!Gn(e)&&Zn.test(e.split("/*")[0].trim()),Zn=/var\(--(?:[\x2D0-9A-Z_a-z\u017F\u212A]+[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*|[\x2D0-9A-Z_a-z\u017F\u212A]+[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*,(?:[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*(?:(?![\t-\r \(\)\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uD800-\uDFFF\uFEFF])[^]|[\uD800-\uDBFF][\uDC00-\uDFFF])|[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*\((?:(?:(?![\(\)\uD800-\uDFFF])[^]|[\uD800-\uDBFF][\uDC00-\uDFFF])|\((?:(?![\(\)\uD800-\uDFFF])[^]|[\uD800-\uDBFF][\uDC00-\uDFFF])*\))*\))+[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*)\)$/i,qn=/^var\(--(?:([\x2D0-9A-Z_a-z]+)|([\x2D0-9A-Z_a-z]+), ?([ #%\(\),-\.0-9A-Za-z]+))\)/;function Wn(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;Ht(n<=4,'Max CSS variable fallback depth detected in property "'.concat(e,'". This may indicate a circular fallback dependency.'));const[r,i]=function(e){const t=qn.exec(e);if(!t)return[,];const[,n,r,i]=t;return["--".concat(null!==n&&void 0!==n?n:r),i]}(e);if(!r)return;const o=window.getComputedStyle(t).getPropertyValue(r);if(o){const e=o.trim();return Bn(e)?parseFloat(e):e}return Hn(i)?Wn(i,t,n+1):i}const Xn=(e,t,n)=>n>t?t:n<e?e:n,Yn={test:e=>"number"===typeof e,parse:parseFloat,transform:e=>e},Kn=c(c({},Yn),{},{transform:e=>Xn(0,1,e)}),Jn=c(c({},Yn),{},{default:1}),Qn=e=>({test:t=>"string"===typeof t&&t.endsWith(e)&&1===t.split(" ").length,parse:parseFloat,transform:t=>"".concat(t).concat(e)}),$n=Qn("deg"),er=Qn("%"),tr=Qn("px"),nr=Qn("vh"),rr=Qn("vw"),ir=c(c({},er),{},{parse:e=>er.parse(e)/100,transform:e=>er.transform(100*e)}),or=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),ar=e=>e===Yn||e===tr,sr=(e,t)=>parseFloat(e.split(", ")[t]),lr=(e,t)=>(n,r)=>{let{transform:i}=r;if("none"===i||!i)return 0;const o=i.match(/^matrix3d\(((?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)\)$/);if(o)return sr(o[1],t);{const t=i.match(/^matrix\(((?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)\)$/);return t?sr(t[1],e):0}},cr=new Set(["x","y","z"]),ur=sn.filter((e=>!cr.has(e)));const hr={width:(e,t)=>{let{x:n}=e,{paddingLeft:r="0",paddingRight:i="0"}=t;return n.max-n.min-parseFloat(r)-parseFloat(i)},height:(e,t)=>{let{y:n}=e,{paddingTop:r="0",paddingBottom:i="0"}=t;return n.max-n.min-parseFloat(r)-parseFloat(i)},top:(e,t)=>{let{top:n}=t;return parseFloat(n)},left:(e,t)=>{let{left:n}=t;return parseFloat(n)},bottom:(e,t)=>{let{y:n}=e,{top:r}=t;return parseFloat(r)+(n.max-n.min)},right:(e,t)=>{let{x:n}=e,{left:r}=t;return parseFloat(r)+(n.max-n.min)},x:lr(4,13),y:lr(5,14)};hr.translateX=hr.x,hr.translateY=hr.y;const dr=e=>t=>t.test(e),pr=[Yn,tr,er,$n,rr,nr,{test:e=>"auto"===e,parse:e=>e}],fr=e=>pr.find(dr(e)),mr=new Set;let gr=!1,yr=!1;function _r(){if(yr){const e=Array.from(mr).filter((e=>e.needsMeasurement)),t=new Set(e.map((e=>e.element))),n=new Map;t.forEach((e=>{const t=function(e){const t=[];return ur.forEach((n=>{const r=e.getValue(n);void 0!==r&&(t.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))})),t}(e);t.length&&(n.set(e,t),e.render())})),e.forEach((e=>e.measureInitialState())),t.forEach((e=>{e.render();const t=n.get(e);t&&t.forEach((t=>{let[n,r]=t;var i;null===(i=e.getValue(n))||void 0===i||i.set(r)}))})),e.forEach((e=>e.measureEndState())),e.forEach((e=>{void 0!==e.suspendedScrollY&&window.scrollTo(0,e.suspendedScrollY)}))}yr=!1,gr=!1,mr.forEach((e=>e.complete())),mr.clear()}function vr(){mr.forEach((e=>{e.readKeyframes(),e.needsMeasurement&&(yr=!0)}))}class xr{constructor(e,t,n,r,i){let o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=n,this.motionValue=r,this.element=i,this.isAsync=o}scheduleResolve(){this.isScheduled=!0,this.isAsync?(mr.add(this),gr||(gr=!0,Sn.read(vr),Sn.resolveKeyframes(_r))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:n,motionValue:r}=this;for(let i=0;i<e.length;i++)if(null===e[i])if(0===i){const i=null===r||void 0===r?void 0:r.get(),o=e[e.length-1];if(void 0!==i)e[0]=i;else if(n&&t){const r=n.readValue(t,o);void 0!==r&&null!==r&&(e[0]=r)}void 0===e[0]&&(e[0]=o),r&&void 0===i&&r.set(e[0])}else e[i]=e[i-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),mr.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,mr.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const br=e=>Math.round(1e5*e)/1e5,wr=/-?(?:[0-9]+(?:\.[0-9]+)?|\.[0-9]+)/g;const Sr=/^(?:#[0-9a-f]{3,8}|(?:rgb|h[s\u017F]l)a?\((?:-?[\.0-9]+%?[\t-\r ,\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+){2}-?[\.0-9]+%?[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*(?:[,\/][\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*)?(?:\b[0-9]+(?:\.[0-9]+)?|\.[0-9]+)?%?\))$/i,Tr=(e,t)=>n=>Boolean("string"===typeof n&&Sr.test(n)&&n.startsWith(e)||t&&!function(e){return null==e}(n)&&Object.prototype.hasOwnProperty.call(n,t)),Er=(e,t,n)=>r=>{if("string"!==typeof r)return r;const[i,o,a,s]=r.match(wr);return{[e]:parseFloat(i),[t]:parseFloat(o),[n]:parseFloat(a),alpha:void 0!==s?parseFloat(s):1}},Ar=c(c({},Yn),{},{transform:e=>Math.round((e=>Xn(0,255,e))(e))}),Mr={test:Tr("rgb","red"),parse:Er("red","green","blue"),transform:e=>{let{red:t,green:n,blue:r,alpha:i=1}=e;return"rgba("+Ar.transform(t)+", "+Ar.transform(n)+", "+Ar.transform(r)+", "+br(Kn.transform(i))+")"}};const Pr={test:Tr("#"),parse:function(e){let t="",n="",r="",i="";return e.length>5?(t=e.substring(1,3),n=e.substring(3,5),r=e.substring(5,7),i=e.substring(7,9)):(t=e.substring(1,2),n=e.substring(2,3),r=e.substring(3,4),i=e.substring(4,5),t+=t,n+=n,r+=r,i+=i),{red:parseInt(t,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:i?parseInt(i,16)/255:1}},transform:Mr.transform},kr={test:Tr("hsl","hue"),parse:Er("hue","saturation","lightness"),transform:e=>{let{hue:t,saturation:n,lightness:r,alpha:i=1}=e;return"hsla("+Math.round(t)+", "+er.transform(br(n))+", "+er.transform(br(r))+", "+br(Kn.transform(i))+")"}},Cr={test:e=>Mr.test(e)||Pr.test(e)||kr.test(e),parse:e=>Mr.test(e)?Mr.parse(e):kr.test(e)?kr.parse(e):Pr.parse(e),transform:e=>"string"===typeof e?e:e.hasOwnProperty("red")?Mr.transform(e):kr.transform(e)},jr=/(?:#[0-9a-f]{3,8}|(?:rgb|h[s\u017F]l)a?\((?:-?[\.0-9]+%?[\t-\r ,\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+){2}-?[\.0-9]+%?[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*(?:[,\/][\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*)?(?:\b[0-9]+(?:\.[0-9]+)?|\.[0-9]+)?%?\))/gi;const Ir="number",Or="color",Nr=/var[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*\([\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*--(?:[\x2D0-9A-Z_a-z\u017F\u212A]+[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*|[\x2D0-9A-Z_a-z\u017F\u212A]+[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*,(?:[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*(?:(?![\t-\r \(\)\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uD800-\uDFFF\uFEFF])[^]|[\uD800-\uDBFF][\uDC00-\uDFFF])|[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*\((?:(?:(?![\(\)\uD800-\uDFFF])[^]|[\uD800-\uDBFF][\uDC00-\uDFFF])|\((?:(?![\(\)\uD800-\uDFFF])[^]|[\uD800-\uDBFF][\uDC00-\uDFFF])*\))*\))+[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*)\)|#[0-9a-f]{3,8}|(?:rgb|h[s\u017F]l)a?\((?:-?[\.0-9]+%?[\t-\r ,\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+){2}-?[\.0-9]+%?[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*(?:[,\/][\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*)?(?:\b[0-9]+(?:\.[0-9]+)?|\.[0-9]+)?%?\)|-?(?:[0-9]+(?:\.[0-9]+)?|\.[0-9]+)/gi;function Dr(e){const t=e.toString(),n=[],r={color:[],number:[],var:[]},i=[];let o=0;const a=t.replace(Nr,(e=>(Cr.test(e)?(r.color.push(o),i.push(Or),n.push(Cr.parse(e))):e.startsWith("var(")?(r.var.push(o),i.push("var"),n.push(e)):(r.number.push(o),i.push(Ir),n.push(parseFloat(e))),++o,"${}"))).split("${}");return{values:n,split:a,indexes:r,types:i}}function Lr(e){return Dr(e).values}function zr(e){const{split:t,types:n}=Dr(e),r=t.length;return e=>{let i="";for(let o=0;o<r;o++)if(i+=t[o],void 0!==e[o]){const t=n[o];i+=t===Ir?br(e[o]):t===Or?Cr.transform(e[o]):e[o]}return i}}const Rr=e=>"number"===typeof e?0:e;const Fr={test:function(e){var t,n;return isNaN(e)&&"string"===typeof e&&((null===(t=e.match(wr))||void 0===t?void 0:t.length)||0)+((null===(n=e.match(jr))||void 0===n?void 0:n.length)||0)>0},parse:Lr,createTransformer:zr,getAnimatableNone:function(e){const t=Lr(e);return zr(e)(t.map(Rr))}},Br=new Set(["brightness","contrast","saturate","opacity"]);function Vr(e){const[t,n]=e.slice(0,-1).split("(");if("drop-shadow"===t)return e;const[r]=n.match(wr)||[];if(!r)return e;const i=n.replace(r,"");let o=Br.has(t)?1:0;return r!==n&&(o*=100),t+"("+o+i+")"}const Ur=/\b([\x2Da-z]*)\((?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*?\)/g,Gr=c(c({},Fr),{},{getAnimatableNone:e=>{const t=e.match(Ur);return t?t.map(Vr).join(" "):e}}),Hr={borderWidth:tr,borderTopWidth:tr,borderRightWidth:tr,borderBottomWidth:tr,borderLeftWidth:tr,borderRadius:tr,radius:tr,borderTopLeftRadius:tr,borderTopRightRadius:tr,borderBottomRightRadius:tr,borderBottomLeftRadius:tr,width:tr,maxWidth:tr,height:tr,maxHeight:tr,top:tr,right:tr,bottom:tr,left:tr,padding:tr,paddingTop:tr,paddingRight:tr,paddingBottom:tr,paddingLeft:tr,margin:tr,marginTop:tr,marginRight:tr,marginBottom:tr,marginLeft:tr,backgroundPositionX:tr,backgroundPositionY:tr},Zr={rotate:$n,rotateX:$n,rotateY:$n,rotateZ:$n,scale:Jn,scaleX:Jn,scaleY:Jn,scaleZ:Jn,skew:$n,skewX:$n,skewY:$n,distance:tr,translateX:tr,translateY:tr,translateZ:tr,x:tr,y:tr,z:tr,perspective:tr,transformPerspective:tr,opacity:Kn,originX:ir,originY:ir,originZ:tr},qr=c(c({},Yn),{},{transform:Math.round}),Wr=c(c(c({},Hr),Zr),{},{zIndex:qr,size:tr,fillOpacity:Kn,strokeOpacity:Kn,numOctaves:qr}),Xr=c(c({},Wr),{},{color:Cr,backgroundColor:Cr,outlineColor:Cr,fill:Cr,stroke:Cr,borderColor:Cr,borderTopColor:Cr,borderRightColor:Cr,borderBottomColor:Cr,borderLeftColor:Cr,filter:Gr,WebkitFilter:Gr}),Yr=e=>Xr[e];function Kr(e,t){let n=Yr(e);return n!==Gr&&(n=Fr),n.getAnimatableNone?n.getAnimatableNone(t):void 0}const Jr=new Set(["auto","none","0"]);class Qr extends xr{constructor(e,t,n,r,i){super(e,t,n,r,i,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:n}=this;if(!t||!t.current)return;super.readKeyframes();for(let s=0;s<e.length;s++){let n=e[s];if("string"===typeof n&&(n=n.trim(),Hn(n))){const r=Wn(n,t.current);void 0!==r&&(e[s]=r),s===e.length-1&&(this.finalKeyframe=n)}}if(this.resolveNoneKeyframes(),!or.has(n)||2!==e.length)return;const[r,i]=e,o=fr(r),a=fr(i);if(o!==a)if(ar(o)&&ar(a))for(let s=0;s<e.length;s++){const t=e[s];"string"===typeof t&&(e[s]=parseFloat(t))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,n=[];for(let r=0;r<e.length;r++)Fn(e[r])&&n.push(r);n.length&&function(e,t,n){let r,i=0;for(;i<e.length&&!r;){const t=e[i];"string"===typeof t&&!Jr.has(t)&&Dr(t).values.length&&(r=e[i]),i++}if(r&&n)for(const o of t)e[o]=Kr(n,r)}(e,n,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:n}=this;if(!e||!e.current)return;"height"===n&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=hr[n](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const r=t[t.length-1];void 0!==r&&e.getValue(n,r).jump(r,!1)}measureEndState(){var e;const{element:t,name:n,unresolvedKeyframes:r}=this;if(!t||!t.current)return;const i=t.getValue(n);i&&i.jump(this.measuredOrigin,!1);const o=r.length-1,a=r[o];r[o]=hr[n](t.measureViewportBox(),window.getComputedStyle(t.current)),null!==a&&void 0===this.finalKeyframe&&(this.finalKeyframe=a),(null===(e=this.removedTransforms)||void 0===e?void 0:e.length)&&this.removedTransforms.forEach((e=>{let[n,r]=e;t.getValue(n).set(r)})),this.resolveNoneKeyframes()}}function $r(e){return"function"===typeof e}let ei;function ti(){ei=void 0}const ni={now:()=>(void 0===ei&&ni.set(En.isProcessing||yn?En.timestamp:performance.now()),ei),set:e=>{ei=e,queueMicrotask(ti)}},ri=(e,t)=>"zIndex"!==t&&(!("number"!==typeof e&&!Array.isArray(e))||!("string"!==typeof e||!Fr.test(e)&&"0"!==e||e.startsWith("url(")));function ii(e,t,n,r){const i=e[0];if(null===i)return!1;if("display"===t||"visibility"===t)return!0;const o=e[e.length-1],a=ri(i,t),s=ri(o,t);return Gt(a===s,"You are trying to animate ".concat(t,' from "').concat(i,'" to "').concat(o,'". ').concat(i," is not an animatable value - to enable this animation set ").concat(i," to a value animatable to ").concat(o," via the `style` property.")),!(!a||!s)&&(function(e){const t=e[0];if(1===e.length)return!0;for(let n=0;n<e.length;n++)if(e[n]!==t)return!0}(e)||("spring"===n||$r(n))&&r)}const oi=["autoplay","delay","type","repeat","repeatDelay","repeatType"];class ai{constructor(e){let{autoplay:t=!0,delay:n=0,type:r="keyframes",repeat:o=0,repeatDelay:a=0,repeatType:s="loop"}=e,l=i(e,oi);this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=ni.now(),this.options=c({autoplay:t,delay:n,type:r,repeat:o,repeatDelay:a,repeatType:s},l),this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt&&this.resolvedAt-this.createdAt>40?this.resolvedAt:this.createdAt}get resolved(){return this._resolved||this.hasAttemptedResolve||(vr(),_r()),this._resolved}onKeyframesResolved(e,t){this.resolvedAt=ni.now(),this.hasAttemptedResolve=!0;const{name:n,type:r,velocity:i,delay:o,onComplete:a,onUpdate:s,isGenerator:l}=this.options;if(!l&&!ii(e,n,r,i)){if(_n||!o)return null===s||void 0===s||s(xn(e,this.options,t)),null===a||void 0===a||a(),void this.resolveFinishedPromise();this.options.duration=0}const u=this.initPlayback(e,t);!1!==u&&(this._resolved=c({keyframes:e,finalKeyframe:t},u),this.onPostResolved())}onPostResolved(){}then(e,t){return this.currentFinishedPromise.then(e,t)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise((e=>{this.resolveFinishedPromise=e}))}}const si=(e,t,n)=>{const r=t-e;return 0===r?1:(n-e)/r},li=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,r="";const i=Math.max(Math.round(t/n),2);for(let o=0;o<i;o++)r+=e(si(0,i-1,o))+", ";return"linear(".concat(r.substring(0,r.length-2),")")};function ci(e,t){return t?e*(1e3/t):0}function ui(e,t,n){const r=Math.max(t-5,0);return ci(n-e(r),t-r)}const hi={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},di=.001;function pi(e){let t,n,{duration:r=hi.duration,bounce:i=hi.bounce,velocity:o=hi.velocity,mass:a=hi.mass}=e;Gt(r<=cn(hi.maxDuration),"Spring duration must be 10 seconds or less");let s=1-i;s=Xn(hi.minDamping,hi.maxDamping,s),r=Xn(hi.minDuration,hi.maxDuration,un(r)),s<1?(t=e=>{const t=e*s,n=t*r,i=t-o,a=mi(e,s),l=Math.exp(-n);return di-i/a*l},n=e=>{const n=e*s*r,i=n*o+o,a=Math.pow(s,2)*Math.pow(e,2)*r,l=Math.exp(-n),c=mi(Math.pow(e,2),s);return(-t(e)+di>0?-1:1)*((i-a)*l)/c}):(t=e=>Math.exp(-e*r)*((e-o)*r+1)-.001,n=e=>Math.exp(-e*r)*(r*r*(o-e)));const l=function(e,t,n){let r=n;for(let i=1;i<fi;i++)r-=e(r)/t(r);return r}(t,n,5/r);if(r=cn(r),isNaN(l))return{stiffness:hi.stiffness,damping:hi.damping,duration:r};{const e=Math.pow(l,2)*a;return{stiffness:e,damping:2*s*Math.sqrt(a*e),duration:r}}}const fi=12;function mi(e,t){return e*Math.sqrt(1-t*t)}const gi=2e4;function yi(e){let t=0;let n=e.next(t);for(;!n.done&&t<gi;)t+=50,n=e.next(t);return t>=gi?1/0:t}const _i=["duration","bounce"],vi=["stiffness","damping","mass"];function xi(e,t){return t.some((t=>void 0!==e[t]))}function bi(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:hi.visualDuration,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:hi.bounce;const n="object"!==typeof e?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:r,restDelta:i}=n;const o=n.keyframes[0],a=n.keyframes[n.keyframes.length-1],s={done:!1,value:o},{stiffness:l,damping:u,mass:h,duration:d,velocity:p,isResolvedFromDuration:f}=function(e){let t=c({velocity:hi.velocity,stiffness:hi.stiffness,damping:hi.damping,mass:hi.mass,isResolvedFromDuration:!1},e);if(!xi(e,vi)&&xi(e,_i))if(e.visualDuration){const n=e.visualDuration,r=2*Math.PI/(1.2*n),i=r*r,o=2*Xn(.05,1,1-e.bounce)*Math.sqrt(i);t=c(c({},t),{},{mass:hi.mass,stiffness:i,damping:o})}else{const n=pi(e);t=c(c(c({},t),n),{},{mass:hi.mass}),t.isResolvedFromDuration=!0}return t}(c(c({},n),{},{velocity:-un(n.velocity||0)})),m=p||0,g=u/(2*Math.sqrt(l*h)),y=a-o,_=un(Math.sqrt(l/h)),v=Math.abs(y)<5;let x;if(r||(r=v?hi.restSpeed.granular:hi.restSpeed.default),i||(i=v?hi.restDelta.granular:hi.restDelta.default),g<1){const e=mi(_,g);x=t=>{const n=Math.exp(-g*_*t);return a-n*((m+g*_*y)/e*Math.sin(e*t)+y*Math.cos(e*t))}}else if(1===g)x=e=>a-Math.exp(-_*e)*(y+(m+_*y)*e);else{const e=_*Math.sqrt(g*g-1);x=t=>{const n=Math.exp(-g*_*t),r=Math.min(e*t,300);return a-n*((m+g*_*y)*Math.sinh(r)+e*y*Math.cosh(r))/e}}const b={calculatedDuration:f&&d||null,next:e=>{const t=x(e);if(f)s.done=e>=d;else{let n=0;g<1&&(n=0===e?cn(m):ui(x,e,t));const o=Math.abs(n)<=r,l=Math.abs(a-t)<=i;s.done=o&&l}return s.value=s.done?a:t,s},toString:()=>{const e=Math.min(yi(b),gi),t=li((t=>b.next(e*t).value),e,30);return e+"ms "+t}};return b}function wi(e){let{keyframes:t,velocity:n=0,power:r=.8,timeConstant:i=325,bounceDamping:o=10,bounceStiffness:a=500,modifyTarget:s,min:l,max:c,restDelta:u=.5,restSpeed:h}=e;const d=t[0],p={done:!1,value:d},f=e=>void 0===l?c:void 0===c||Math.abs(l-e)<Math.abs(c-e)?l:c;let m=r*n;const g=d+m,y=void 0===s?g:s(g);y!==g&&(m=y-d);const _=e=>-m*Math.exp(-e/i),v=e=>y+_(e),x=e=>{const t=_(e),n=v(e);p.done=Math.abs(t)<=u,p.value=p.done?y:n};let b,w;const S=e=>{var t;(t=p.value,void 0!==l&&t<l||void 0!==c&&t>c)&&(b=e,w=bi({keyframes:[p.value,f(p.value)],velocity:ui(v,e,p.value),damping:o,stiffness:a,restDelta:u,restSpeed:h}))};return S(0),{calculatedDuration:null,next:e=>{let t=!1;return w||void 0!==b||(t=!0,x(e),S(e)),void 0!==b&&e>=b?w.next(e-b):(!t&&x(e),p)}}}const Si=Pn(.42,0,1,1),Ti=Pn(0,0,.58,1),Ei=Pn(.42,0,.58,1),Ai=e=>Array.isArray(e)&&"number"===typeof e[0],Mi={linear:Ut,easeIn:Si,easeInOut:Ei,easeOut:Ti,circIn:Dn,circInOut:zn,circOut:Ln,backIn:In,backInOut:On,backOut:jn,anticipate:Nn},Pi=e=>{if(Ai(e)){Ht(4===e.length,"Cubic bezier arrays must contain four numerical values.");const[t,n,r,i]=e;return Pn(t,n,r,i)}return"string"===typeof e?(Ht(void 0!==Mi[e],"Invalid easing type '".concat(e,"'")),Mi[e]):e},ki=(e,t)=>n=>t(e(n)),Ci=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(ki)},ji=(e,t,n)=>e+(t-e)*n;function Ii(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function Oi(e,t){return n=>n>0?t:e}const Ni=(e,t,n)=>{const r=e*e,i=n*(t*t-r)+r;return i<0?0:Math.sqrt(i)},Di=[Pr,Mr,kr];function Li(e){const t=(n=e,Di.find((e=>e.test(n))));var n;if(Gt(Boolean(t),"'".concat(e,"' is not an animatable color. Use the equivalent color code instead.")),!Boolean(t))return!1;let r=t.parse(e);return t===kr&&(r=function(e){let{hue:t,saturation:n,lightness:r,alpha:i}=e;t/=360,n/=100,r/=100;let o=0,a=0,s=0;if(n){const e=r<.5?r*(1+n):r+n-r*n,i=2*r-e;o=Ii(i,e,t+1/3),a=Ii(i,e,t),s=Ii(i,e,t-1/3)}else o=a=s=r;return{red:Math.round(255*o),green:Math.round(255*a),blue:Math.round(255*s),alpha:i}}(r)),r}const zi=(e,t)=>{const n=Li(e),r=Li(t);if(!n||!r)return Oi(e,t);const i=c({},n);return e=>(i.red=Ni(n.red,r.red,e),i.green=Ni(n.green,r.green,e),i.blue=Ni(n.blue,r.blue,e),i.alpha=ji(n.alpha,r.alpha,e),Mr.transform(i))},Ri=new Set(["none","hidden"]);function Fi(e,t){return n=>ji(e,t,n)}function Bi(e){return"number"===typeof e?Fi:"string"===typeof e?Hn(e)?Oi:Cr.test(e)?zi:Gi:Array.isArray(e)?Vi:"object"===typeof e?Cr.test(e)?zi:Ui:Oi}function Vi(e,t){const n=[...e],r=n.length,i=e.map(((e,n)=>Bi(e)(e,t[n])));return e=>{for(let t=0;t<r;t++)n[t]=i[t](e);return n}}function Ui(e,t){const n=c(c({},e),t),r={};for(const i in n)void 0!==e[i]&&void 0!==t[i]&&(r[i]=Bi(e[i])(e[i],t[i]));return e=>{for(const t in r)n[t]=r[t](e);return n}}const Gi=(e,t)=>{const n=Fr.createTransformer(t),r=Dr(e),i=Dr(t);return r.indexes.var.length===i.indexes.var.length&&r.indexes.color.length===i.indexes.color.length&&r.indexes.number.length>=i.indexes.number.length?Ri.has(e)&&!i.values.length||Ri.has(t)&&!r.values.length?function(e,t){return Ri.has(e)?n=>n<=0?e:t:n=>n>=1?t:e}(e,t):Ci(Vi(function(e,t){var n;const r=[],i={color:0,var:0,number:0};for(let o=0;o<t.values.length;o++){const a=t.types[o],s=e.indexes[a][i[a]],l=null!==(n=e.values[s])&&void 0!==n?n:0;r[o]=l,i[a]++}return r}(r,i),i.values),n):(Gt(!0,"Complex values '".concat(e,"' and '").concat(t,"' too different to mix. Ensure all colors are of the same type, and that each contains the same quantity of number and color values. Falling back to instant transition.")),Oi(e,t))};function Hi(e,t,n){if("number"===typeof e&&"number"===typeof t&&"number"===typeof n)return ji(e,t,n);return Bi(e)(e,t)}function Zi(e,t){let{clamp:n=!0,ease:r,mixer:i}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=e.length;if(Ht(o===t.length,"Both input and output ranges must be the same length"),1===o)return()=>t[0];if(2===o&&e[0]===e[1])return()=>t[1];e[0]>e[o-1]&&(e=[...e].reverse(),t=[...t].reverse());const a=function(e,t,n){const r=[],i=n||Hi,o=e.length-1;for(let a=0;a<o;a++){let n=i(e[a],e[a+1]);if(t){const e=Array.isArray(t)?t[a]||Ut:t;n=Ci(e,n)}r.push(n)}return r}(t,r,i),s=a.length,l=t=>{let n=0;if(s>1)for(;n<e.length-2&&!(t<e[n+1]);n++);const r=si(e[n],e[n+1],t);return a[n](r)};return n?t=>l(Xn(e[0],e[o-1],t)):l}function qi(e){const t=[0];return function(e,t){const n=e[e.length-1];for(let r=1;r<=t;r++){const i=si(0,t,r);e.push(ji(n,1,i))}}(t,e.length-1),t}function Wi(e){let{duration:t=300,keyframes:n,times:r,ease:i="easeInOut"}=e;const o=(e=>Array.isArray(e)&&"number"!==typeof e[0])(i)?i.map(Pi):Pi(i),a={done:!1,value:n[0]},s=function(e,t){return e.map((e=>e*t))}(r&&r.length===n.length?r:qi(n),t),l=Zi(s,n,{ease:Array.isArray(o)?o:(c=n,u=o,c.map((()=>u||Ei)).splice(0,c.length-1))});var c,u;return{calculatedDuration:t,next:e=>(a.value=l(e),a.done=e>=t,a)}}const Xi=e=>{const t=t=>{let{timestamp:n}=t;return e(n)};return{start:()=>Sn.update(t,!0),stop:()=>Tn(t),now:()=>En.isProcessing?En.timestamp:ni.now()}},Yi={decay:wi,inertia:wi,tween:Wi,keyframes:Wi,spring:bi},Ki=e=>e/100;class Ji extends ai{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,"idle"===this.state)return;this.teardown();const{onStop:e}=this.options;e&&e()};const{name:t,motionValue:n,element:r,keyframes:i}=this.options,o=(null===r||void 0===r?void 0:r.KeyframeResolver)||xr;this.resolver=new o(i,((e,t)=>this.onKeyframesResolved(e,t)),t,n,r),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:t="keyframes",repeat:n=0,repeatDelay:r=0,repeatType:i,velocity:o=0}=this.options,a=$r(t)?t:Yi[t]||Wi;let s,l;a!==Wi&&"number"!==typeof e[0]&&(s=Ci(Ki,Hi(e[0],e[1])),e=[0,100]);const u=a(c(c({},this.options),{},{keyframes:e}));"mirror"===i&&(l=a(c(c({},this.options),{},{keyframes:[...e].reverse(),velocity:-o}))),null===u.calculatedDuration&&(u.calculatedDuration=yi(u));const{calculatedDuration:h}=u,d=h+r;return{generator:u,mirroredGenerator:l,mapPercentToKeyframes:s,calculatedDuration:h,resolvedDuration:d,totalDuration:d*(n+1)-r}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),"paused"!==this.pendingPlayState&&e?this.state=this.pendingPlayState:this.pause()}tick(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{resolved:n}=this;if(!n){const{keyframes:e}=this.options;return{done:!0,value:e[e.length-1]}}const{finalKeyframe:r,generator:i,mirroredGenerator:o,mapPercentToKeyframes:a,keyframes:s,calculatedDuration:l,totalDuration:c,resolvedDuration:u}=n;if(null===this.startTime)return i.next(0);const{delay:h,repeat:d,repeatType:p,repeatDelay:f,onUpdate:m}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-c/this.speed,this.startTime)),t?this.currentTime=e:null!==this.holdTime?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const g=this.currentTime-h*(this.speed>=0?1:-1),y=this.speed>=0?g<0:g>c;this.currentTime=Math.max(g,0),"finished"===this.state&&null===this.holdTime&&(this.currentTime=c);let _=this.currentTime,v=i;if(d){const e=Math.min(this.currentTime,c)/u;let t=Math.floor(e),n=e%1;!n&&e>=1&&(n=1),1===n&&t--,t=Math.min(t,d+1);Boolean(t%2)&&("reverse"===p?(n=1-n,f&&(n-=f/u)):"mirror"===p&&(v=o)),_=Xn(0,1,n)*u}const x=y?{done:!1,value:s[0]}:v.next(_);a&&(x.value=a(x.value));let{done:b}=x;y||null===l||(b=this.speed>=0?this.currentTime>=c:this.currentTime<=0);const w=null===this.holdTime&&("finished"===this.state||"running"===this.state&&b);return w&&void 0!==r&&(x.value=xn(s,this.options,r)),m&&m(x.value),w&&this.finish(),x}get duration(){const{resolved:e}=this;return e?un(e.calculatedDuration):0}get time(){return un(this.currentTime)}set time(e){e=cn(e),this.currentTime=e,null!==this.holdTime||0===this.speed?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=un(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved)return void(this.pendingPlayState="running");if(this.isStopped)return;const{driver:e=Xi,onPlay:t,startTime:n}=this.options;this.driver||(this.driver=e((e=>this.tick(e)))),t&&t();const r=this.driver.now();null!==this.holdTime?this.startTime=r-this.holdTime:this.startTime?"finished"===this.state&&(this.startTime=r):this.startTime=null!==n&&void 0!==n?n:this.calcStartTime(),"finished"===this.state&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;this._resolved?(this.state="paused",this.holdTime=null!==(e=this.currentTime)&&void 0!==e?e:0):this.pendingPlayState="paused"}complete(){"running"!==this.state&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){null!==this.cancelTime&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const Qi=new Set(["opacity","clipPath","filter","transform"]);function $i(e){let t;return()=>(void 0===t&&(t=e()),t)}const eo={linearEasing:void 0};function to(e,t){const n=$i(e);return()=>{var e;return null!==(e=eo[t])&&void 0!==e?e:n()}}const no=to((()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch(KL){return!1}return!0}),"linearEasing");function ro(e){return Boolean("function"===typeof e&&no()||!e||"string"===typeof e&&(e in oo||no())||Ai(e)||Array.isArray(e)&&e.every(ro))}const io=e=>{let[t,n,r,i]=e;return"cubic-bezier(".concat(t,", ").concat(n,", ").concat(r,", ").concat(i,")")},oo={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:io([0,.65,.55,1]),circOut:io([.55,0,1,.45]),backIn:io([.31,.01,.66,-.59]),backOut:io([.33,1.53,.69,.99])};function ao(e,t){return e?"function"===typeof e&&no()?li(e,t):Ai(e)?io(e):Array.isArray(e)?e.map((e=>ao(e,t)||oo.easeOut)):oo[e]:void 0}function so(e,t,n){let{delay:r=0,duration:i=300,repeat:o=0,repeatType:a="loop",ease:s="easeInOut",times:l}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const c={[t]:n};l&&(c.offset=l);const u=ao(s,i);return Array.isArray(u)&&(c.easing=u),e.animate(c,{delay:r,duration:i,easing:Array.isArray(u)?"linear":u,fill:"both",iterations:o+1,direction:"reverse"===a?"alternate":"normal"})}function lo(e,t){e.timeline=t,e.onfinish=null}const co=$i((()=>Object.hasOwnProperty.call(Element.prototype,"animate"))),uo=["onComplete","onUpdate","motionValue","element"],ho=["motionValue","onUpdate","onComplete","element"];const po={anticipate:Nn,backInOut:On,circInOut:zn};class fo extends ai{constructor(e){super(e);const{name:t,motionValue:n,element:r,keyframes:i}=this.options;this.resolver=new Qr(i,((e,t)=>this.onKeyframesResolved(e,t)),t,n,r),this.resolver.scheduleResolve()}initPlayback(e,t){var n;let{duration:r=300,times:o,ease:a,type:s,motionValue:l,name:u,startTime:h}=this.options;if(!(null===(n=l.owner)||void 0===n?void 0:n.current))return!1;var d;if("string"===typeof a&&no()&&a in po&&(a=po[a]),$r((d=this.options).type)||"spring"===d.type||!ro(d.ease)){const t=this.options,{onComplete:n,onUpdate:l,motionValue:u,element:h}=t,d=i(t,uo),p=function(e,t){const n=new Ji(c(c({},t),{},{keyframes:e,repeat:0,delay:0,isGenerator:!0}));let r={done:!1,value:e[0]};const i=[];let o=0;for(;!r.done&&o<2e4;)r=n.sample(o),i.push(r.value),o+=10;return{times:void 0,keyframes:i,duration:o-10,ease:"linear"}}(e,d);1===(e=p.keyframes).length&&(e[1]=e[0]),r=p.duration,o=p.times,a=p.ease,s="keyframes"}const p=so(l.owner.current,u,e,c(c({},this.options),{},{duration:r,times:o,ease:a}));return p.startTime=null!==h&&void 0!==h?h:this.calcStartTime(),this.pendingTimeline?(lo(p,this.pendingTimeline),this.pendingTimeline=void 0):p.onfinish=()=>{const{onComplete:n}=this.options;l.set(xn(e,this.options,t)),n&&n(),this.cancel(),this.resolveFinishedPromise()},{animation:p,duration:r,times:o,type:s,ease:a,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:t}=e;return un(t)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:t}=e;return un(t.currentTime||0)}set time(e){const{resolved:t}=this;if(!t)return;const{animation:n}=t;n.currentTime=cn(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:t}=e;return t.playbackRate}set speed(e){const{resolved:t}=this;if(!t)return;const{animation:n}=t;n.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:t}=e;return t.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:t}=e;return t.startTime}attachTimeline(e){if(this._resolved){const{resolved:t}=this;if(!t)return Ut;const{animation:n}=t;lo(n,e)}else this.pendingTimeline=e;return Ut}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:t}=e;"finished"===t.playState&&this.updateFinishedPromise(),t.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,"idle"===this.state)return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:t,keyframes:n,duration:r,type:o,ease:a,times:s}=e;if("idle"===t.playState||"finished"===t.playState)return;if(this.time){const e=this.options,{motionValue:t,onUpdate:l,onComplete:u,element:h}=e,d=i(e,ho),p=new Ji(c(c({},d),{},{keyframes:n,duration:r,type:o,ease:a,times:s,isGenerator:!0})),f=cn(this.time);t.setWithVelocity(p.sample(f-10).value,p.sample(f).value,10)}const{onStop:l}=this.options;l&&l(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:t,name:n,repeatDelay:r,repeatType:i,damping:o,type:a}=e;return co()&&n&&Qi.has(n)&&t&&t.owner&&t.owner.current instanceof HTMLElement&&!t.owner.getProps().onUpdate&&!r&&"mirror"!==i&&0!==o&&"inertia"!==a}}const mo=$i((()=>void 0!==window.ScrollTimeline));class go{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}then(e,t){return Promise.all(this.animations).then(e).catch(t)}getAll(e){return this.animations[0][e]}setAll(e,t){for(let n=0;n<this.animations.length;n++)this.animations[n][e]=t}attachTimeline(e,t){const n=this.animations.map((n=>mo()&&n.attachTimeline?n.attachTimeline(e):t(n)));return()=>{n.forEach(((e,t)=>{e&&e(),this.animations[t].stop()}))}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let t=0;t<this.animations.length;t++)e=Math.max(e,this.animations[t].duration);return e}runAll(e){this.animations.forEach((t=>t[e]()))}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}const yo=["when","delay","delayChildren","staggerChildren","staggerDirection","repeat","repeatType","repeatDelay","from","elapsed"];const _o=function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0;return s=>{const l=mn(r,e)||{},u=l.delay||r.delay||0;let{elapsed:h=0}=r;h-=cn(u);let d=c(c({keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:t.getVelocity()},l),{},{delay:-h,onUpdate:e=>{t.set(e),l.onUpdate&&l.onUpdate(e)},onComplete:()=>{s(),l.onComplete&&l.onComplete()},name:e,motionValue:t,element:a?void 0:o});(function(e){let{when:t,delay:n,delayChildren:r,staggerChildren:o,staggerDirection:a,repeat:s,repeatType:l,repeatDelay:c,from:u,elapsed:h}=e,d=i(e,yo);return!!Object.keys(d).length})(l)||(d=c(c({},d),fn(e,d))),d.duration&&(d.duration=cn(d.duration)),d.repeatDelay&&(d.repeatDelay=cn(d.repeatDelay)),void 0!==d.from&&(d.keyframes[0]=d.from);let p=!1;if((!1===d.type||0===d.duration&&!d.repeatDelay)&&(d.duration=0,0===d.delay&&(p=!0)),(_n||gn)&&(p=!0,d.duration=0,d.delay=0),p&&!a&&void 0!==t.get()){const e=xn(d.keyframes,l);if(void 0!==e)return Sn.update((()=>{d.onUpdate(e),d.onComplete()})),new go([])}return!a&&fo.supports(d)?new fo(d):new Ji(d)}};function vo(e,t){-1===e.indexOf(t)&&e.push(t)}function xo(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}class bo{constructor(){this.subscriptions=[]}add(e){return vo(this.subscriptions,e),()=>xo(this.subscriptions,e)}notify(e,t,n){const r=this.subscriptions.length;if(r)if(1===r)this.subscriptions[0](e,t,n);else for(let i=0;i<r;i++){const r=this.subscriptions[i];r&&r(e,t,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const wo={current:void 0};class So{constructor(e){var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.version="11.15.0",this.canTrackVelocity=null,this.events={},this.updateAndNotify=function(e){let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const r=ni.now();t.updatedAt!==r&&t.setPrevFrameValue(),t.prev=t.current,t.setCurrent(e),t.current!==t.prev&&t.events.change&&t.events.change.notify(t.current),n&&t.events.renderRequest&&t.events.renderRequest.notify(t.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=n.owner}setCurrent(e){this.current=e,this.updatedAt=ni.now(),null===this.canTrackVelocity&&void 0!==e&&(this.canTrackVelocity=(e=>!isNaN(parseFloat(e)))(this.current))}setPrevFrameValue(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.current;this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new bo);const n=this.events[e].add(t);return"change"===e?()=>{n(),Sn.read((()=>{this.events.change.getSize()||this.stop()}))}:n}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t&&this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e,t)}setWithVelocity(e,t,n){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-n}jump(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return wo.current&&wo.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){const e=ni.now();if(!this.canTrackVelocity||void 0===this.prevFrameValue||e-this.updatedAt>30)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,30);return ci(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise((t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()})).then((()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()}))}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function To(e,t){return new So(e,t)}const Eo=["transitionEnd","transition"];function Ao(e,t,n){e.hasValue(t)?e.getValue(t).set(n):e.addValue(t,To(n))}const Mo=e=>e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),Po="data-"+Mo("framerAppearId");function ko(e){return e.props[Po]}const Co=e=>Boolean(e&&e.getVelocity);function jo(e,t){const n=e.getValue("willChange");if(function(e){return Boolean(Co(e)&&e.add)}(n))return n.add(t)}const Io=["transition","transitionEnd"];function Oo(e,t){let{protectedKeys:n,needsAnimating:r}=e;const i=n.hasOwnProperty(t)&&!0!==r[t];return r[t]=!1,i}function No(e,t){let{delay:n=0,transitionOverride:r,type:o}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var a;let{transition:s=e.getDefaultTransition(),transitionEnd:l}=t,u=i(t,Io);r&&(s=r);const h=[],d=o&&e.animationState&&e.animationState.getState()[o];for(const i in u){const t=e.getValue(i,null!==(a=e.latestValues[i])&&void 0!==a?a:null),r=u[i];if(void 0===r||d&&Oo(d,i))continue;const o=c({delay:n},mn(s||{},i));let l=!1;if(window.MotionHandoffAnimation){const t=ko(e);if(t){const e=window.MotionHandoffAnimation(t,i,Sn);null!==e&&(o.startTime=e,l=!0)}}jo(e,i),t.start(_o(i,t,r,e.shouldReduceMotion&&ln.has(i)?{type:!1}:o,e,l));const p=t.animation;p&&h.push(p)}return l&&Promise.all(h).then((()=>{Sn.update((()=>{l&&function(e,t){let n=rn(e,t)||{},{transitionEnd:r={},transition:o={}}=n,a=i(n,Eo);a=c(c({},a),r);for(const i in a)Ao(e,i,(s=a[i],Qt(s)?s[s.length-1]||0:s));var s}(e,l)}))})),h}function Do(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var r;const i=rn(e,t,"exit"===n.type?null===(r=e.presenceContext)||void 0===r?void 0:r.custom:void 0);let{transition:o=e.getDefaultTransition()||{}}=i||{};n.transitionOverride&&(o=n.transitionOverride);const a=i?()=>Promise.all(No(e,i,n)):()=>Promise.resolve(),s=e.variantChildren&&e.variantChildren.size?function(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;const{delayChildren:i=0,staggerChildren:a,staggerDirection:s}=o;return function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,o=arguments.length>5?arguments[5]:void 0;const a=[],s=(e.variantChildren.size-1)*r,l=1===i?function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)*r}:function(){return s-(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)*r};return Array.from(e.variantChildren).sort(Lo).forEach(((e,r)=>{e.notify("AnimationStart",t),a.push(Do(e,t,c(c({},o),{},{delay:n+l(r)})).then((()=>e.notify("AnimationComplete",t))))})),Promise.all(a)}(e,t,i+r,a,s,n)}:()=>Promise.resolve(),{when:l}=o;if(l){const[e,t]="beforeChildren"===l?[a,s]:[s,a];return e().then((()=>t()))}return Promise.all([a(),s(n.delay)])}function Lo(e,t){return e.sortNodePosition(t)}const zo=an.length;function Ro(e){if(!e)return;if(!e.isControllingVariants){const t=e.parent&&Ro(e.parent)||{};return void 0!==e.props.initial&&(t.initial=e.props.initial),t}const t={};for(let n=0;n<zo;n++){const r=an[n],i=e.props[r];(en(i)||!1===i)&&(t[r]=i)}return t}const Fo=["transition","transitionEnd"],Bo=[...on].reverse(),Vo=on.length;function Uo(e){return t=>Promise.all(t.map((t=>{let{animation:n,options:r}=t;return function(e,t){let n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e.notify("AnimationStart",t),Array.isArray(t)){const i=t.map((t=>Do(e,t,r)));n=Promise.all(i)}else if("string"===typeof t)n=Do(e,t,r);else{const i="function"===typeof t?rn(e,t,r.custom):t;n=Promise.all(No(e,i,r))}return n.then((()=>{e.notify("AnimationComplete",t)}))}(e,n,r)})))}function Go(e){let t=Uo(e),n=qo(),r=!0;const o=t=>(n,r)=>{var o;const a=rn(e,r,"exit"===t?null===(o=e.presenceContext)||void 0===o?void 0:o.custom:void 0);if(a){const{transition:e,transitionEnd:t}=a,r=i(a,Fo);n=c(c(c({},n),r),t)}return n};function a(i){const{props:a}=e,s=Ro(e.parent)||{},l=[],u=new Set;let h={},d=1/0;for(let t=0;t<Vo;t++){const p=Bo[t],f=n[p],m=void 0!==a[p]?a[p]:s[p],g=en(m),y=p===i?f.isActive:null;!1===y&&(d=t);let _=m===s[p]&&m!==a[p]&&g;if(_&&r&&e.manuallyAnimateOnMount&&(_=!1),f.protectedKeys=c({},h),!f.isActive&&null===y||!m&&!f.prevProp||Jt(m)||"boolean"===typeof m)continue;const v=Ho(f.prevProp,m);let x=v||p===i&&f.isActive&&!_&&g||t>d&&g,b=!1;const w=Array.isArray(m)?m:[m];let S=w.reduce(o(p),{});!1===y&&(S={});const{prevResolvedValues:T={}}=f,E=c(c({},T),S),A=t=>{x=!0,u.has(t)&&(b=!0,u.delete(t)),f.needsAnimating[t]=!0;const n=e.getValue(t);n&&(n.liveStyle=!1)};for(const e in E){const t=S[e],n=T[e];if(h.hasOwnProperty(e))continue;let r=!1;r=Qt(t)&&Qt(n)?!$t(t,n):t!==n,r?void 0!==t&&null!==t?A(e):u.add(e):void 0!==t&&u.has(e)?A(e):f.protectedKeys[e]=!0}f.prevProp=m,f.prevResolvedValues=S,f.isActive&&(h=c(c({},h),S)),r&&e.blockInitialAnimation&&(x=!1);x&&(!(_&&v)||b)&&l.push(...w.map((e=>({animation:e,options:{type:p}}))))}if(u.size){const t={};u.forEach((n=>{const r=e.getBaseTarget(n),i=e.getValue(n);i&&(i.liveStyle=!0),t[n]=null!==r&&void 0!==r?r:null})),l.push({animation:t})}let p=Boolean(l.length);return!r||!1!==a.initial&&a.initial!==a.animate||e.manuallyAnimateOnMount||(p=!1),r=!1,p?t(l):Promise.resolve()}return{animateChanges:a,setActive:function(t,r){var i;if(n[t].isActive===r)return Promise.resolve();null===(i=e.variantChildren)||void 0===i||i.forEach((e=>{var n;return null===(n=e.animationState)||void 0===n?void 0:n.setActive(t,r)})),n[t].isActive=r;const o=a(t);for(const e in n)n[e].protectedKeys={};return o},setAnimateFunction:function(n){t=n(e)},getState:()=>n,reset:()=>{n=qo(),r=!0}}}function Ho(e,t){return"string"===typeof t?t!==e:!!Array.isArray(t)&&!$t(t,e)}function Zo(){return{isActive:arguments.length>0&&void 0!==arguments[0]&&arguments[0],protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function qo(){return{animate:Zo(!0),whileInView:Zo(),whileHover:Zo(),whileTap:Zo(),whileDrag:Zo(),whileFocus:Zo(),exit:Zo()}}class Wo{constructor(e){this.isMounted=!1,this.node=e}update(){}}let Xo=0;const Yo={animation:{Feature:class extends Wo{constructor(e){super(e),e.animationState||(e.animationState=Go(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();Jt(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),null===(e=this.unmountControls)||void 0===e||e.call(this)}}},exit:{Feature:class extends Wo{constructor(){super(...arguments),this.id=Xo++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===n)return;const r=this.node.animationState.setActive("exit",!e);t&&!e&&r.then((()=>t(this.id)))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}}};function Ko(e){let t;return()=>(void 0===t&&(t=e()),t)}Ko((()=>void 0!==window.ScrollTimeline));const Jo={x:!1,y:!1};function Qo(){return Jo.x||Jo.y}function $o(e,t){const n=function(e,t,n){var r;if(e instanceof Element)return[e];if("string"===typeof e){let i=document;t&&(i=t.current);const o=null!==(r=null===n||void 0===n?void 0:n[e])&&void 0!==r?r:i.querySelectorAll(e);return o?Array.from(o):[]}return Array.from(e)}(e),r=new AbortController;return[n,c(c({passive:!0},t),{},{signal:r.signal}),()=>r.abort()]}function ea(e){return t=>{"touch"===t.pointerType||Qo()||e(t)}}const ta=e=>"mouse"===e.pointerType?"number"!==typeof e.button||e.button<=0:!1!==e.isPrimary,na=new WeakSet;function ra(e){return t=>{"Enter"===t.key&&e(t)}}function ia(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const oa=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);const aa=(e,t)=>!!t&&(e===t||aa(e,t.parentElement));function sa(e){return ta(e)&&!Qo()}function la(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const[r,i,o]=$o(e,n),a=e=>{const r=e.currentTarget;if(!sa(e)||na.has(r))return;na.add(r);const o=t(e),a=(e,t)=>{window.removeEventListener("pointerup",s),window.removeEventListener("pointercancel",l),sa(e)&&na.has(r)&&(na.delete(r),o&&o(e,{success:t}))},s=e=>{a(e,n.useGlobalTarget||aa(r,e.target))},l=e=>{a(e,!1)};window.addEventListener("pointerup",s,i),window.addEventListener("pointercancel",l,i)};return r.forEach((e=>{(function(e){return oa.has(e.tagName)||-1!==e.tabIndex})(e)||(e.tabIndex=0);(n.useGlobalTarget?window:e).addEventListener("pointerdown",a,i),e.addEventListener("focus",(e=>((e,t)=>{const n=e.currentTarget;if(!n)return;const r=ra((()=>{if(na.has(n))return;ia(n,"down");const e=ra((()=>{ia(n,"up")}));n.addEventListener("keyup",e,t),n.addEventListener("blur",(()=>ia(n,"cancel")),t)}));n.addEventListener("keydown",r,t),n.addEventListener("blur",(()=>n.removeEventListener("keydown",r)),t)})(e,i)),i)})),o}function ca(e){return{point:{x:e.pageX,y:e.pageY}}}function ua(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{passive:!0};return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n)}function ha(e,t,n,r){return ua(e,t,(e=>t=>ta(t)&&e(t,ca(t)))(n),r)}const da=(e,t)=>Math.abs(e-t);class pa{constructor(e,t){let{transformPagePoint:n,contextWindow:r,dragSnapToOrigin:i=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!this.lastMoveEvent||!this.lastMoveEventInfo)return;const e=ga(this.lastMoveEventInfo,this.history),t=null!==this.startEvent,n=function(e,t){const n=da(e.x,t.x),r=da(e.y,t.y);return Math.sqrt(n**2+r**2)}(e.offset,{x:0,y:0})>=3;if(!t&&!n)return;const{point:r}=e,{timestamp:i}=En;this.history.push(c(c({},r),{},{timestamp:i}));const{onStart:o,onMove:a}=this.handlers;t||(o&&o(this.lastMoveEvent,e),this.startEvent=this.lastMoveEvent),a&&a(this.lastMoveEvent,e)},this.handlePointerMove=(e,t)=>{this.lastMoveEvent=e,this.lastMoveEventInfo=fa(t,this.transformPagePoint),Sn.update(this.updatePoint,!0)},this.handlePointerUp=(e,t)=>{this.end();const{onEnd:n,onSessionEnd:r,resumeAnimation:i}=this.handlers;if(this.dragSnapToOrigin&&i&&i(),!this.lastMoveEvent||!this.lastMoveEventInfo)return;const o=ga("pointercancel"===e.type?this.lastMoveEventInfo:fa(t,this.transformPagePoint),this.history);this.startEvent&&n&&n(e,o),r&&r(e,o)},!ta(e))return;this.dragSnapToOrigin=i,this.handlers=t,this.transformPagePoint=n,this.contextWindow=r||window;const o=fa(ca(e),this.transformPagePoint),{point:a}=o,{timestamp:s}=En;this.history=[c(c({},a),{},{timestamp:s})];const{onSessionStart:l}=t;l&&l(e,ga(o,this.history)),this.removeListeners=Ci(ha(this.contextWindow,"pointermove",this.handlePointerMove),ha(this.contextWindow,"pointerup",this.handlePointerUp),ha(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Tn(this.updatePoint)}}function fa(e,t){return t?{point:t(e.point)}:e}function ma(e,t){return{x:e.x-t.x,y:e.y-t.y}}function ga(e,t){let{point:n}=e;return{point:n,delta:ma(n,_a(t)),offset:ma(n,ya(t)),velocity:va(t,.1)}}function ya(e){return e[0]}function _a(e){return e[e.length-1]}function va(e,t){if(e.length<2)return{x:0,y:0};let n=e.length-1,r=null;const i=_a(e);for(;n>=0&&(r=e[n],!(i.timestamp-r.timestamp>cn(t)));)n--;if(!r)return{x:0,y:0};const o=un(i.timestamp-r.timestamp);if(0===o)return{x:0,y:0};const a={x:(i.x-r.x)/o,y:(i.y-r.y)/o};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}function xa(e){return e&&"object"===typeof e&&Object.prototype.hasOwnProperty.call(e,"current")}function ba(e){return e.max-e.min}function wa(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;e.origin=r,e.originPoint=ji(t.min,t.max,e.origin),e.scale=ba(n)/ba(t),e.translate=ji(n.min,n.max,e.origin)-e.originPoint,(e.scale>=.9999&&e.scale<=1.0001||isNaN(e.scale))&&(e.scale=1),(e.translate>=-.01&&e.translate<=.01||isNaN(e.translate))&&(e.translate=0)}function Sa(e,t,n,r){wa(e.x,t.x,n.x,r?r.originX:void 0),wa(e.y,t.y,n.y,r?r.originY:void 0)}function Ta(e,t,n){e.min=n.min+t.min,e.max=e.min+ba(t)}function Ea(e,t,n){e.min=t.min-n.min,e.max=e.min+ba(t)}function Aa(e,t,n){Ea(e.x,t.x,n.x),Ea(e.y,t.y,n.y)}function Ma(e,t,n){return{min:void 0!==t?e.min+t:void 0,max:void 0!==n?e.max+n-(e.max-e.min):void 0}}function Pa(e,t){let n=t.min-e.min,r=t.max-e.max;return t.max-t.min<e.max-e.min&&([n,r]=[r,n]),{min:n,max:r}}const ka=.35;function Ca(e,t,n){return{min:ja(e,t),max:ja(e,n)}}function ja(e,t){return"number"===typeof e?e:e[t]||0}const Ia=()=>({x:{min:0,max:0},y:{min:0,max:0}});function Oa(e){return[e("x"),e("y")]}function Na(e){let{top:t,left:n,right:r,bottom:i}=e;return{x:{min:n,max:r},y:{min:t,max:i}}}function Da(e){return void 0===e||1===e}function La(e){let{scale:t,scaleX:n,scaleY:r}=e;return!Da(t)||!Da(n)||!Da(r)}function za(e){return La(e)||Ra(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function Ra(e){return Fa(e.x)||Fa(e.y)}function Fa(e){return e&&"0%"!==e}function Ba(e,t,n){return n+t*(e-n)}function Va(e,t,n,r,i){return void 0!==i&&(e=Ba(e,i,r)),Ba(e,n,r)+t}function Ua(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;e.min=Va(e.min,t,n,r,i),e.max=Va(e.max,t,n,r,i)}function Ga(e,t){let{x:n,y:r}=t;Ua(e.x,n.translate,n.scale,n.originPoint),Ua(e.y,r.translate,r.scale,r.originPoint)}const Ha=.999999999999,Za=1.0000000000001;function qa(e,t){e.min=e.min+t,e.max=e.max+t}function Wa(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5;Ua(e,t,n,ji(e.min,e.max,i),r)}function Xa(e,t){Wa(e.x,t.x,t.scaleX,t.scale,t.originX),Wa(e.y,t.y,t.scaleY,t.scale,t.originY)}function Ya(e,t){return Na(function(e,t){if(!t)return e;const n=t({x:e.left,y:e.top}),r=t({x:e.right,y:e.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}(e.getBoundingClientRect(),t))}const Ka=e=>{let{current:t}=e;return t?t.ownerDocument.defaultView:null},Ja=new WeakMap;class Qa{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic={x:{min:0,max:0},y:{min:0,max:0}},this.visualElement=e}start(e){let{snapToCursor:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{presenceContext:n}=this.visualElement;if(n&&!1===n.isPresent)return;const{dragSnapToOrigin:r}=this.getProps();this.panSession=new pa(e,{onSessionStart:e=>{const{dragSnapToOrigin:n}=this.getProps();n?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(ca(e).point)},onStart:(e,t)=>{const{drag:n,dragPropagation:r,onDragStart:i}=this.getProps();if(n&&!r&&(this.openDragLock&&this.openDragLock(),this.openDragLock="x"===(o=n)||"y"===o?Jo[o]?null:(Jo[o]=!0,()=>{Jo[o]=!1}):Jo.x||Jo.y?null:(Jo.x=Jo.y=!0,()=>{Jo.x=Jo.y=!1}),!this.openDragLock))return;var o;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Oa((e=>{let t=this.getAxisMotionValue(e).get()||0;if(er.test(t)){const{projection:n}=this.visualElement;if(n&&n.layout){const r=n.layout.layoutBox[e];if(r){t=ba(r)*(parseFloat(t)/100)}}}this.originPoint[e]=t})),i&&Sn.postRender((()=>i(e,t))),jo(this.visualElement,"transform");const{animationState:a}=this.visualElement;a&&a.setActive("whileDrag",!0)},onMove:(e,t)=>{const{dragPropagation:n,dragDirectionLock:r,onDirectionLock:i,onDrag:o}=this.getProps();if(!n&&!this.openDragLock)return;const{offset:a}=t;if(r&&null===this.currentDirection)return this.currentDirection=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=null;Math.abs(e.y)>t?n="y":Math.abs(e.x)>t&&(n="x");return n}(a),void(null!==this.currentDirection&&i&&i(this.currentDirection));this.updateAxis("x",t.point,a),this.updateAxis("y",t.point,a),this.visualElement.render(),o&&o(e,t)},onSessionEnd:(e,t)=>this.stop(e,t),resumeAnimation:()=>Oa((e=>{var t;return"paused"===this.getAnimationState(e)&&(null===(t=this.getAxisMotionValue(e).animation)||void 0===t?void 0:t.play())}))},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:r,contextWindow:Ka(this.visualElement)})}stop(e,t){const n=this.isDragging;if(this.cancel(),!n)return;const{velocity:r}=t;this.startAnimation(r);const{onDragEnd:i}=this.getProps();i&&Sn.postRender((()=>i(e,t)))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,n){const{drag:r}=this.getProps();if(!n||!$a(e,r,this.currentDirection))return;const i=this.getAxisMotionValue(e);let o=this.originPoint[e]+n[e];this.constraints&&this.constraints[e]&&(o=function(e,t,n){let{min:r,max:i}=t;return void 0!==r&&e<r?e=n?ji(r,e,n.min):Math.max(e,r):void 0!==i&&e>i&&(e=n?ji(i,e,n.max):Math.min(e,i)),e}(o,this.constraints[e],this.elastic[e])),i.set(o)}resolveConstraints(){var e;const{dragConstraints:t,dragElastic:n}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):null===(e=this.visualElement.projection)||void 0===e?void 0:e.layout,i=this.constraints;t&&xa(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):this.constraints=!(!t||!r)&&function(e,t){let{top:n,left:r,bottom:i,right:o}=t;return{x:Ma(e.x,r,o),y:Ma(e.y,n,i)}}(r.layoutBox,t),this.elastic=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ka;return!1===e?e=0:!0===e&&(e=ka),{x:Ca(e,"left","right"),y:Ca(e,"top","bottom")}}(n),i!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&Oa((e=>{!1!==this.constraints&&this.getAxisMotionValue(e)&&(this.constraints[e]=function(e,t){const n={};return void 0!==t.min&&(n.min=t.min-e.min),void 0!==t.max&&(n.max=t.max-e.min),n}(r.layoutBox[e],this.constraints[e]))}))}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!xa(e))return!1;const n=e.current;Ht(null!==n,"If `dragConstraints` is set as a React ref, that ref must be passed to another component's `ref` prop.");const{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const i=function(e,t,n){const r=Ya(e,n),{scroll:i}=t;return i&&(qa(r.x,i.offset.x),qa(r.y,i.offset.y)),r}(n,r.root,this.visualElement.getTransformPagePoint());let o=function(e,t){return{x:Pa(e.x,t.x),y:Pa(e.y,t.y)}}(r.layout.layoutBox,i);if(t){const e=t(function(e){let{x:t,y:n}=e;return{top:n.min,right:t.max,bottom:n.max,left:t.min}}(o));this.hasMutatedConstraints=!!e,e&&(o=Na(e))}return o}startAnimation(e){const{drag:t,dragMomentum:n,dragElastic:r,dragTransition:i,dragSnapToOrigin:o,onDragTransitionEnd:a}=this.getProps(),s=this.constraints||{},l=Oa((a=>{if(!$a(a,t,this.currentDirection))return;let l=s&&s[a]||{};o&&(l={min:0,max:0});const u=r?200:1e6,h=r?40:1e7,d=c(c({type:"inertia",velocity:n?e[a]:0,bounceStiffness:u,bounceDamping:h,timeConstant:750,restDelta:1,restSpeed:10},i),l);return this.startAxisValueAnimation(a,d)}));return Promise.all(l).then(a)}startAxisValueAnimation(e,t){const n=this.getAxisMotionValue(e);return jo(this.visualElement,e),n.start(_o(e,n,0,t,this.visualElement,!1))}stopAnimation(){Oa((e=>this.getAxisMotionValue(e).stop()))}pauseAnimation(){Oa((e=>{var t;return null===(t=this.getAxisMotionValue(e).animation)||void 0===t?void 0:t.pause()}))}getAnimationState(e){var t;return null===(t=this.getAxisMotionValue(e).animation)||void 0===t?void 0:t.state}getAxisMotionValue(e){const t="_drag".concat(e.toUpperCase()),n=this.visualElement.getProps(),r=n[t];return r||this.visualElement.getValue(e,(n.initial?n.initial[e]:void 0)||0)}snapToCursor(e){Oa((t=>{const{drag:n}=this.getProps();if(!$a(t,n,this.currentDirection))return;const{projection:r}=this.visualElement,i=this.getAxisMotionValue(t);if(r&&r.layout){const{min:n,max:o}=r.layout.layoutBox[t];i.set(e[t]-ji(n,o,.5))}}))}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:n}=this.visualElement;if(!xa(t)||!n||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};Oa((e=>{const t=this.getAxisMotionValue(e);if(t&&!1!==this.constraints){const n=t.get();r[e]=function(e,t){let n=.5;const r=ba(e),i=ba(t);return i>r?n=si(t.min,t.max-r,e.min):r>i&&(n=si(e.min,e.max-i,t.min)),Xn(0,1,n)}({min:n,max:n},this.constraints[e])}}));const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),Oa((t=>{if(!$a(t,e,null))return;const n=this.getAxisMotionValue(t),{min:i,max:o}=this.constraints[t];n.set(ji(i,o,r[t]))}))}addListeners(){if(!this.visualElement.current)return;Ja.set(this.visualElement,this);const e=ha(this.visualElement.current,"pointerdown",(e=>{const{drag:t,dragListener:n=!0}=this.getProps();t&&n&&this.start(e)})),t=()=>{const{dragConstraints:e}=this.getProps();xa(e)&&e.current&&(this.constraints=this.resolveRefConstraints())},{projection:n}=this.visualElement,r=n.addEventListener("measure",t);n&&!n.layout&&(n.root&&n.root.updateScroll(),n.updateLayout()),Sn.read(t);const i=ua(window,"resize",(()=>this.scalePositionWithinConstraints())),o=n.addEventListener("didUpdate",(e=>{let{delta:t,hasLayoutChanged:n}=e;this.isDragging&&n&&(Oa((e=>{const n=this.getAxisMotionValue(e);n&&(this.originPoint[e]+=t[e].translate,n.set(n.get()+t[e].translate))})),this.visualElement.render())}));return()=>{i(),e(),r(),o&&o()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:n=!1,dragPropagation:r=!1,dragConstraints:i=!1,dragElastic:o=ka,dragMomentum:a=!0}=e;return c(c({},e),{},{drag:t,dragDirectionLock:n,dragPropagation:r,dragConstraints:i,dragElastic:o,dragMomentum:a})}}function $a(e,t,n){return(!0===t||t===e)&&(null===n||n===e)}const es=e=>(t,n)=>{e&&Sn.postRender((()=>e(t,n)))};const ts=(0,t.createContext)({}),ns={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function rs(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const is={correct:(e,t)=>{if(!t.target)return e;if("string"===typeof e){if(!tr.test(e))return e;e=parseFloat(e)}const n=rs(e,t.target.x),r=rs(e,t.target.y);return"".concat(n,"% ").concat(r,"%")}},os={correct:(e,t)=>{let{treeScale:n,projectionDelta:r}=t;const i=e,o=Fr.parse(e);if(o.length>5)return i;const a=Fr.createTransformer(e),s="number"!==typeof o[0]?1:0,l=r.x.scale*n.x,c=r.y.scale*n.y;o[0+s]/=l,o[1+s]/=c;const u=ji(l,c,.5);return"number"===typeof o[2+s]&&(o[2+s]/=u),"number"===typeof o[3+s]&&(o[3+s]/=u),a(o)}},as={};const{schedule:ss,cancel:ls}=wn(queueMicrotask,!1);class cs extends t.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:n,layoutId:r}=this.props,{projection:i}=e;var o;o=hs,Object.assign(as,o),i&&(t.group&&t.group.add(i),n&&n.register&&r&&n.register(i),i.root.didUpdate(),i.addEventListener("animationComplete",(()=>{this.safeToRemove()})),i.setOptions(c(c({},i.options),{},{onExitComplete:()=>this.safeToRemove()}))),ns.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:n,drag:r,isPresent:i}=this.props,o=n.projection;return o?(o.isPresent=i,r||e.layoutDependency!==t||void 0===t?o.willUpdate():this.safeToRemove(),e.isPresent!==i&&(i?o.promote():o.relegate()||Sn.postRender((()=>{const e=o.getStack();e&&e.members.length||this.safeToRemove()}))),null):null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),ss.postRender((()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()})))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:n}=this.props,{projection:r}=e;r&&(r.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(r),n&&n.deregister&&n.deregister(r))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function us(e){const[n,r]=function(){const e=(0,t.useContext)(Nt);if(null===e)return[!0,null];const{isPresent:n,onExitComplete:r,register:i}=e,o=(0,t.useId)();(0,t.useEffect)((()=>i(o)),[]);const a=(0,t.useCallback)((()=>r&&r(o)),[o,r]);return!n&&r?[!1,a]:[!0]}(),i=(0,t.useContext)(Vt);return(0,Ot.jsx)(cs,c(c({},e),{},{layoutGroup:i,switchLayoutGroup:(0,t.useContext)(ts),isPresent:n,safeToRemove:r}))}const hs={borderRadius:c(c({},is),{},{applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]}),borderTopLeftRadius:is,borderTopRightRadius:is,borderBottomLeftRadius:is,borderBottomRightRadius:is,boxShadow:os},ds=["TopLeft","TopRight","BottomLeft","BottomRight"],ps=ds.length,fs=e=>"string"===typeof e?parseFloat(e):e,ms=e=>"number"===typeof e||tr.test(e);function gs(e,t){return void 0!==e[t]?e[t]:e.borderRadius}const ys=vs(0,.5,Ln),_s=vs(.5,.95,Ut);function vs(e,t,n){return r=>r<e?0:r>t?1:n(si(e,t,r))}function xs(e,t){e.min=t.min,e.max=t.max}function bs(e,t){xs(e.x,t.x),xs(e.y,t.y)}function ws(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function Ss(e,t,n,r,i){return e=Ba(e-=t,1/n,r),void 0!==i&&(e=Ba(e,1/i,r)),e}function Ts(e,t,n,r,i){let[o,a,s]=n;!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,i=arguments.length>4?arguments[4]:void 0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:e,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:e;er.test(t)&&(t=parseFloat(t),t=ji(a.min,a.max,t/100)-a.min);if("number"!==typeof t)return;let s=ji(o.min,o.max,r);e===o&&(s-=t),e.min=Ss(e.min,t,n,s,i),e.max=Ss(e.max,t,n,s,i)}(e,t[o],t[a],t[s],t.scale,r,i)}const Es=["x","scaleX","originX"],As=["y","scaleY","originY"];function Ms(e,t,n,r){Ts(e.x,t,Es,n?n.x:void 0,r?r.x:void 0),Ts(e.y,t,As,n?n.y:void 0,r?r.y:void 0)}function Ps(e){return 0===e.translate&&1===e.scale}function ks(e){return Ps(e.x)&&Ps(e.y)}function Cs(e,t){return e.min===t.min&&e.max===t.max}function js(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function Is(e,t){return js(e.x,t.x)&&js(e.y,t.y)}function Os(e){return ba(e.x)/ba(e.y)}function Ns(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class Ds{constructor(){this.members=[]}add(e){vo(this.members,e),e.scheduleRender()}remove(e){if(xo(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const e=this.members[this.members.length-1];e&&this.promote(e)}}relegate(e){const t=this.members.findIndex((t=>e===t));if(0===t)return!1;let n;for(let r=t;r>=0;r--){const e=this.members[r];if(!1!==e.isPresent){n=e;break}}return!!n&&(this.promote(n),!0)}promote(e,t){const n=this.lead;if(e!==n&&(this.prevLead=n,this.lead=e,e.show(),n)){n.instance&&n.scheduleRender(),e.scheduleRender(),e.resumeFrom=n,t&&(e.resumeFrom.preserveOpacity=!0),n.snapshot&&(e.snapshot=n.snapshot,e.snapshot.latestValues=n.animationValues||n.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:r}=e.options;!1===r&&n.hide()}}exitAnimationComplete(){this.members.forEach((e=>{const{options:t,resumingFrom:n}=e;t.onExitComplete&&t.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()}))}scheduleRender(){this.members.forEach((e=>{e.instance&&e.scheduleRender(!1)}))}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}const Ls=(e,t)=>e.depth-t.depth;class zs{constructor(){this.children=[],this.isDirty=!1}add(e){vo(this.children,e),this.isDirty=!0}remove(e){xo(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(Ls),this.isDirty=!1,this.children.forEach(e)}}function Rs(e){const t=Co(e)?e.get():e;return n=t,Boolean(n&&"object"===typeof n&&n.mix&&n.toValue)?t.toValue():t;var n}function Fs(e,t){const n=ni.now(),r=i=>{let{timestamp:o}=i;const a=o-n;a>=t&&(Tn(r),e(a-t))};return Sn.read(r,!0),()=>Tn(r)}const Bs={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},Vs="undefined"!==typeof window&&void 0!==window.MotionDebug,Us=["","X","Y","Z"],Gs={visibility:"hidden"};let Hs=0;function Zs(e,t,n,r){const{latestValues:i}=t;i[e]&&(n[e]=i[e],t.setStaticValue(e,0),r&&(r[e]=0))}function qs(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const n=ko(t);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:t,layoutId:r}=e.options;window.MotionCancelOptimisedAnimation(n,"transform",Sn,!(t||r))}const{parent:r}=e;r&&!r.hasCheckedOptimisedAppear&&qs(r)}function Ws(e){let{attachResizeListener:t,defaultParent:n,measureScroll:r,checkIsScrollRoot:i,resetTransform:o}=e;return class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null===n||void 0===n?void 0:n();this.id=Hs++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,Vs&&(Bs.totalNodes=Bs.resolvedTargetDeltas=Bs.recalculatedProjection=0),this.nodes.forEach(Ks),this.nodes.forEach(rl),this.nodes.forEach(il),this.nodes.forEach(Js),Vs&&window.MotionDebug.record(Bs)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=e,this.root=t?t.root||t:this,this.path=t?[...t.path,t]:[],this.parent=t,this.depth=t?t.depth+1:0;for(let n=0;n<this.path.length;n++)this.path[n].shouldResetTransform=!0;this.root===this&&(this.nodes=new zs)}addEventListener(e,t){return this.eventHandlers.has(e)||this.eventHandlers.set(e,new bo),this.eventHandlers.get(e).add(t)}notifyListeners(e){const t=this.eventHandlers.get(e);for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];t&&t.notify(...r)}hasListeners(e){return this.eventHandlers.has(e)}mount(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.root.hasTreeAnimated;if(this.instance)return;var r;this.isSVG=(r=e)instanceof SVGElement&&"svg"!==r.tagName,this.instance=e;const{layoutId:i,layout:o,visualElement:a}=this.options;if(a&&!a.current&&a.mount(e),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),n&&(o||i)&&(this.isLayoutDirty=!0),t){let n;const r=()=>this.root.updateBlockedByResize=!1;t(e,(()=>{this.root.updateBlockedByResize=!0,n&&n(),n=Fs(r,250),ns.hasAnimatedSinceResize&&(ns.hasAnimatedSinceResize=!1,this.nodes.forEach(nl))}))}i&&this.root.registerSharedNode(i,this),!1!==this.options.animate&&a&&(i||o)&&this.addEventListener("didUpdate",(e=>{let{delta:t,hasLayoutChanged:n,hasRelativeTargetChanged:r,layout:i}=e;if(this.isTreeAnimationBlocked())return this.target=void 0,void(this.relativeTarget=void 0);const o=this.options.transition||a.getDefaultTransition()||ul,{onLayoutAnimationStart:s,onLayoutAnimationComplete:l}=a.getProps(),u=!this.targetLayout||!Is(this.targetLayout,i)||r,h=!n&&r;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||h||n&&(u||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(t,h);const e=c(c({},mn(o,"layout")),{},{onPlay:s,onComplete:l});(a.shouldReduceMotion||this.options.layoutRoot)&&(e.delay=0,e.type=!1),this.startAnimation(e)}else n||nl(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=i}))}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const e=this.getStack();e&&e.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Tn(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(ol),this.animationId++)}getTransformTemplate(){const{visualElement:e}=this.options;return e&&e.getProps().transformTemplate}willUpdate(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked())return void(this.options.onExitComplete&&this.options.onExitComplete());if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&qs(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let i=0;i<this.path.length;i++){const e=this.path[i];e.shouldResetTransform=!0,e.updateScroll("snapshot"),e.options.layoutRoot&&e.willUpdate(!1)}const{layoutId:t,layout:n}=this.options;if(void 0===t&&!n)return;const r=this.getTransformTemplate();this.prevTransformTemplateValue=r?r(this.latestValues,""):void 0,this.updateSnapshot(),e&&this.notifyListeners("willUpdate")}update(){this.updateScheduled=!1;if(this.isUpdateBlocked())return this.unblockUpdate(),this.clearAllSnapshots(),void this.nodes.forEach($s);this.isUpdating||this.nodes.forEach(el),this.isUpdating=!1,this.nodes.forEach(tl),this.nodes.forEach(Xs),this.nodes.forEach(Ys),this.clearAllSnapshots();const e=ni.now();En.delta=Xn(0,1e3/60,e-En.timestamp),En.timestamp=e,En.isProcessing=!0,An.update.process(En),An.preRender.process(En),An.render.process(En),En.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,ss.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(Qs),this.sharedNodes.forEach(al)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Sn.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Sn.postRender((()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()}))}updateSnapshot(){!this.snapshot&&this.instance&&(this.snapshot=this.measure())}updateLayout(){if(!this.instance)return;if(this.updateScroll(),(!this.options.alwaysMeasureLayout||!this.isLead())&&!this.isLayoutDirty)return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let n=0;n<this.path.length;n++){this.path[n].updateScroll()}const e=this.layout;this.layout=this.measure(!1),this.layoutCorrected={x:{min:0,max:0},y:{min:0,max:0}},this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:t}=this.options;t&&t.notify("LayoutMeasure",this.layout.layoutBox,e?e.layoutBox:void 0)}updateScroll(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"measure",t=Boolean(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===e&&(t=!1),t){const t=i(this.instance);this.scroll={animationId:this.root.animationId,phase:e,isRoot:t,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:t}}}resetTransform(){if(!o)return;const e=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,t=this.projectionDelta&&!ks(this.projectionDelta),n=this.getTransformTemplate(),r=n?n(this.latestValues,""):void 0,i=r!==this.prevTransformTemplateValue;e&&(t||za(this.latestValues)||i)&&(o(this.instance,r),this.shouldResetTransform=!1,this.scheduleRender())}measure(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const t=this.measurePageBox();let n=this.removeElementScroll(t);var r;return e&&(n=this.removeTransform(n)),pl((r=n).x),pl(r.y),{animationId:this.root.animationId,measuredBox:t,layoutBox:n,latestValues:{},source:this.id}}measurePageBox(){var e;const{visualElement:t}=this.options;if(!t)return{x:{min:0,max:0},y:{min:0,max:0}};const n=t.measureViewportBox();if(!((null===(e=this.scroll)||void 0===e?void 0:e.wasRoot)||this.path.some(ml))){const{scroll:e}=this.root;e&&(qa(n.x,e.offset.x),qa(n.y,e.offset.y))}return n}removeElementScroll(e){var t;const n={x:{min:0,max:0},y:{min:0,max:0}};if(bs(n,e),null===(t=this.scroll)||void 0===t?void 0:t.wasRoot)return n;for(let r=0;r<this.path.length;r++){const t=this.path[r],{scroll:i,options:o}=t;t!==this.root&&i&&o.layoutScroll&&(i.wasRoot&&bs(n,e),qa(n.x,i.offset.x),qa(n.y,i.offset.y))}return n}applyTransform(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n={x:{min:0,max:0},y:{min:0,max:0}};bs(n,e);for(let r=0;r<this.path.length;r++){const e=this.path[r];!t&&e.options.layoutScroll&&e.scroll&&e!==e.root&&Xa(n,{x:-e.scroll.offset.x,y:-e.scroll.offset.y}),za(e.latestValues)&&Xa(n,e.latestValues)}return za(this.latestValues)&&Xa(n,this.latestValues),n}removeTransform(e){const t={x:{min:0,max:0},y:{min:0,max:0}};bs(t,e);for(let n=0;n<this.path.length;n++){const e=this.path[n];if(!e.instance)continue;if(!za(e.latestValues))continue;La(e.latestValues)&&e.updateSnapshot();const r={x:{min:0,max:0},y:{min:0,max:0}};bs(r,e.measurePageBox()),Ms(t,e.latestValues,e.snapshot?e.snapshot.layoutBox:void 0,r)}return za(this.latestValues)&&Ms(t,this.latestValues),t}setTargetDelta(e){this.targetDelta=e,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(e){this.options=c(c(c({},this.options),e),{},{crossfade:void 0===e.crossfade||e.crossfade})}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==En.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];var t;const n=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=n.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=n.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=n.isSharedProjectionDirty);const r=Boolean(this.resumingFrom)||this!==n;if(!(e||r&&this.isSharedProjectionDirty||this.isProjectionDirty||(null===(t=this.parent)||void 0===t?void 0:t.isProjectionDirty)||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:i,layoutId:o}=this.options;if(this.layout&&(i||o)){if(this.resolvedRelativeTargetAt=En.timestamp,!this.targetDelta&&!this.relativeTarget){const e=this.getClosestProjectingParent();e&&e.layout&&1!==this.animationProgress?(this.relativeParent=e,this.forceRelativeParentToResolveTarget(),this.relativeTarget={x:{min:0,max:0},y:{min:0,max:0}},this.relativeTargetOrigin={x:{min:0,max:0},y:{min:0,max:0}},Aa(this.relativeTargetOrigin,this.layout.layoutBox,e.layout.layoutBox),bs(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(this.relativeTarget||this.targetDelta){if(this.target||(this.target={x:{min:0,max:0},y:{min:0,max:0}},this.targetWithTransforms={x:{min:0,max:0},y:{min:0,max:0}}),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),function(e,t,n){Ta(e.x,t.x,n.x),Ta(e.y,t.y,n.y)}(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(Boolean(this.resumingFrom)?this.target=this.applyTransform(this.layout.layoutBox):bs(this.target,this.layout.layoutBox),Ga(this.target,this.targetDelta)):bs(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const e=this.getClosestProjectingParent();e&&Boolean(e.resumingFrom)===Boolean(this.resumingFrom)&&!e.options.layoutScroll&&e.target&&1!==this.animationProgress?(this.relativeParent=e,this.forceRelativeParentToResolveTarget(),this.relativeTarget={x:{min:0,max:0},y:{min:0,max:0}},this.relativeTargetOrigin={x:{min:0,max:0},y:{min:0,max:0}},Aa(this.relativeTargetOrigin,this.target,e.target),bs(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}Vs&&Bs.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(this.parent&&!La(this.parent.latestValues)&&!Ra(this.parent.latestValues))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return Boolean((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var e;const t=this.getLead(),n=Boolean(this.resumingFrom)||this!==t;let r=!0;if((this.isProjectionDirty||(null===(e=this.parent)||void 0===e?void 0:e.isProjectionDirty))&&(r=!1),n&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(r=!1),this.resolvedRelativeTargetAt===En.timestamp&&(r=!1),r)return;const{layout:i,layoutId:o}=this.options;if(this.isTreeAnimating=Boolean(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!i&&!o)return;bs(this.layoutCorrected,this.layout.layoutBox);const a=this.treeScale.x,s=this.treeScale.y;!function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=n.length;if(!i)return;let o,a;t.x=t.y=1;for(let s=0;s<i;s++){o=n[s],a=o.projectionDelta;const{visualElement:i}=o.options;i&&i.props.style&&"contents"===i.props.style.display||(r&&o.options.layoutScroll&&o.scroll&&o!==o.root&&Xa(e,{x:-o.scroll.offset.x,y:-o.scroll.offset.y}),a&&(t.x*=a.x.scale,t.y*=a.y.scale,Ga(e,a)),r&&za(o.latestValues)&&Xa(e,o.latestValues))}t.x<Za&&t.x>Ha&&(t.x=1),t.y<Za&&t.y>Ha&&(t.y=1)}(this.layoutCorrected,this.treeScale,this.path,n),!t.layout||t.target||1===this.treeScale.x&&1===this.treeScale.y||(t.target=t.layout.layoutBox,t.targetWithTransforms={x:{min:0,max:0},y:{min:0,max:0}});const{target:l}=t;l?(this.projectionDelta&&this.prevProjectionDelta?(ws(this.prevProjectionDelta.x,this.projectionDelta.x),ws(this.prevProjectionDelta.y,this.projectionDelta.y)):this.createProjectionDeltas(),Sa(this.projectionDelta,this.layoutCorrected,l,this.latestValues),this.treeScale.x===a&&this.treeScale.y===s&&Ns(this.projectionDelta.x,this.prevProjectionDelta.x)&&Ns(this.projectionDelta.y,this.prevProjectionDelta.y)||(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",l)),Vs&&Bs.recalculatedProjection++):this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender())}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];var t;if(null===(t=this.options.visualElement)||void 0===t||t.scheduleRender(),e){const e=this.getStack();e&&e.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}},this.projectionDelta={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}},this.projectionDeltaWithTransform={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}}}setAnimationOrigin(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this.snapshot,r=n?n.latestValues:{},i=c({},this.latestValues),o={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}};this.relativeParent&&this.relativeParent.options.layoutRoot||(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!t;const a={x:{min:0,max:0},y:{min:0,max:0}},s=(n?n.source:void 0)!==(this.layout?this.layout.source:void 0),l=this.getStack(),u=!l||l.members.length<=1,h=Boolean(s&&!u&&!0===this.options.crossfade&&!this.path.some(cl));let d;this.animationProgress=0,this.mixTargetDelta=t=>{const n=t/1e3;var l,c,p,f;sl(o.x,e.x,n),sl(o.y,e.y,n),this.setTargetDelta(o),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Aa(a,this.layout.layoutBox,this.relativeParent.layout.layoutBox),l=this.relativeTarget,c=this.relativeTargetOrigin,p=a,f=n,ll(l.x,c.x,p.x,f),ll(l.y,c.y,p.y,f),d&&function(e,t){return Cs(e.x,t.x)&&Cs(e.y,t.y)}(this.relativeTarget,d)&&(this.isProjectionDirty=!1),d||(d={x:{min:0,max:0},y:{min:0,max:0}}),bs(d,this.relativeTarget)),s&&(this.animationValues=i,function(e,t,n,r,i,o){i?(e.opacity=ji(0,void 0!==n.opacity?n.opacity:1,ys(r)),e.opacityExit=ji(void 0!==t.opacity?t.opacity:1,0,_s(r))):o&&(e.opacity=ji(void 0!==t.opacity?t.opacity:1,void 0!==n.opacity?n.opacity:1,r));for(let a=0;a<ps;a++){const i="border".concat(ds[a],"Radius");let o=gs(t,i),s=gs(n,i);void 0===o&&void 0===s||(o||(o=0),s||(s=0),0===o||0===s||ms(o)===ms(s)?(e[i]=Math.max(ji(fs(o),fs(s),r),0),(er.test(s)||er.test(o))&&(e[i]+="%")):e[i]=s)}(t.rotate||n.rotate)&&(e.rotate=ji(t.rotate||0,n.rotate||0,r))}(i,r,this.latestValues,n,h,u)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=n},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(e){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Tn(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Sn.update((()=>{ns.hasAnimatedSinceResize=!0,this.currentAnimation=function(e,t,n){const r=Co(e)?e:To(e);return r.start(_o("",r,t,n)),r.animation}(0,1e3,c(c({},e),{},{onUpdate:t=>{this.mixTargetDelta(t),e.onUpdate&&e.onUpdate(t)},onComplete:()=>{e.onComplete&&e.onComplete(),this.completeAnimation()}})),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0}))}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const e=this.getStack();e&&e.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(1e3),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const e=this.getLead();let{targetWithTransforms:t,target:n,layout:r,latestValues:i}=e;if(t&&n&&r){if(this!==e&&this.layout&&r&&fl(this.options.animationType,this.layout.layoutBox,r.layoutBox)){n=this.target||{x:{min:0,max:0},y:{min:0,max:0}};const t=ba(this.layout.layoutBox.x);n.x.min=e.target.x.min,n.x.max=n.x.min+t;const r=ba(this.layout.layoutBox.y);n.y.min=e.target.y.min,n.y.max=n.y.min+r}bs(t,n),Xa(t,i),Sa(this.projectionDeltaWithTransform,this.layoutCorrected,t,i)}}registerSharedNode(e,t){this.sharedNodes.has(e)||this.sharedNodes.set(e,new Ds);this.sharedNodes.get(e).add(t);const n=t.options.initialPromotionConfig;t.promote({transition:n?n.transition:void 0,preserveFollowOpacity:n&&n.shouldPreserveFollowOpacity?n.shouldPreserveFollowOpacity(t):void 0})}isLead(){const e=this.getStack();return!e||e.lead===this}getLead(){var e;const{layoutId:t}=this.options;return t&&(null===(e=this.getStack())||void 0===e?void 0:e.lead)||this}getPrevLead(){var e;const{layoutId:t}=this.options;return t?null===(e=this.getStack())||void 0===e?void 0:e.prevLead:void 0}getStack(){const{layoutId:e}=this.options;if(e)return this.root.sharedNodes.get(e)}promote(){let{needsReset:e,transition:t,preserveFollowOpacity:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const r=this.getStack();r&&r.promote(this,n),e&&(this.projectionDelta=void 0,this.needsReset=!0),t&&this.setOptions({transition:t})}relegate(){const e=this.getStack();return!!e&&e.relegate(this)}resetSkewAndRotation(){const{visualElement:e}=this.options;if(!e)return;let t=!1;const{latestValues:n}=e;if((n.z||n.rotate||n.rotateX||n.rotateY||n.rotateZ||n.skewX||n.skewY)&&(t=!0),!t)return;const r={};n.z&&Zs("z",e,r,this.animationValues);for(let i=0;i<Us.length;i++)Zs("rotate".concat(Us[i]),e,r,this.animationValues),Zs("skew".concat(Us[i]),e,r,this.animationValues);e.render();for(const i in r)e.setStaticValue(i,r[i]),this.animationValues&&(this.animationValues[i]=r[i]);e.scheduleRender()}getProjectionStyles(e){var t,n;if(!this.instance||this.isSVG)return;if(!this.isVisible)return Gs;const r={visibility:""},i=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,r.opacity="",r.pointerEvents=Rs(null===e||void 0===e?void 0:e.pointerEvents)||"",r.transform=i?i(this.latestValues,""):"none",r;const o=this.getLead();if(!this.projectionDelta||!this.layout||!o.target){const t={};return this.options.layoutId&&(t.opacity=void 0!==this.latestValues.opacity?this.latestValues.opacity:1,t.pointerEvents=Rs(null===e||void 0===e?void 0:e.pointerEvents)||""),this.hasProjected&&!za(this.latestValues)&&(t.transform=i?i({},""):"none",this.hasProjected=!1),t}const a=o.animationValues||o.latestValues;this.applyTransformsToTarget(),r.transform=function(e,t,n){let r="";const i=e.x.translate/t.x,o=e.y.translate/t.y,a=(null===n||void 0===n?void 0:n.z)||0;if((i||o||a)&&(r="translate3d(".concat(i,"px, ").concat(o,"px, ").concat(a,"px) ")),1===t.x&&1===t.y||(r+="scale(".concat(1/t.x,", ").concat(1/t.y,") ")),n){const{transformPerspective:e,rotate:t,rotateX:i,rotateY:o,skewX:a,skewY:s}=n;e&&(r="perspective(".concat(e,"px) ").concat(r)),t&&(r+="rotate(".concat(t,"deg) ")),i&&(r+="rotateX(".concat(i,"deg) ")),o&&(r+="rotateY(".concat(o,"deg) ")),a&&(r+="skewX(".concat(a,"deg) ")),s&&(r+="skewY(".concat(s,"deg) "))}const s=e.x.scale*t.x,l=e.y.scale*t.y;return 1===s&&1===l||(r+="scale(".concat(s,", ").concat(l,")")),r||"none"}(this.projectionDeltaWithTransform,this.treeScale,a),i&&(r.transform=i(a,r.transform));const{x:s,y:l}=this.projectionDelta;r.transformOrigin="".concat(100*s.origin,"% ").concat(100*l.origin,"% 0"),o.animationValues?r.opacity=o===this?null!==(n=null!==(t=a.opacity)&&void 0!==t?t:this.latestValues.opacity)&&void 0!==n?n:1:this.preserveOpacity?this.latestValues.opacity:a.opacityExit:r.opacity=o===this?void 0!==a.opacity?a.opacity:"":void 0!==a.opacityExit?a.opacityExit:0;for(const c in as){if(void 0===a[c])continue;const{correct:e,applyTo:t}=as[c],n="none"===r.transform?a[c]:e(a[c],o);if(t){const e=t.length;for(let i=0;i<e;i++)r[t[i]]=n}else r[c]=n}return this.options.layoutId&&(r.pointerEvents=o===this?Rs(null===e||void 0===e?void 0:e.pointerEvents)||"":"none"),r}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach((e=>{var t;return null===(t=e.currentAnimation)||void 0===t?void 0:t.stop()})),this.root.nodes.forEach($s),this.root.sharedNodes.clear()}}}function Xs(e){e.updateLayout()}function Ys(e){var t;const n=(null===(t=e.resumeFrom)||void 0===t?void 0:t.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&n&&e.hasListeners("didUpdate")){const{layoutBox:t,measuredBox:r}=e.layout,{animationType:i}=e.options,o=n.source!==e.layout.source;"size"===i?Oa((e=>{const r=o?n.measuredBox[e]:n.layoutBox[e],i=ba(r);r.min=t[e].min,r.max=r.min+i})):fl(i,n.layoutBox,t)&&Oa((r=>{const i=o?n.measuredBox[r]:n.layoutBox[r],a=ba(t[r]);i.max=i.min+a,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[r].max=e.relativeTarget[r].min+a)}));const a={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}};Sa(a,t,n.layoutBox);const s={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}};o?Sa(s,e.applyTransform(r,!0),n.measuredBox):Sa(s,t,n.layoutBox);const l=!ks(a);let c=!1;if(!e.resumeFrom){const r=e.getClosestProjectingParent();if(r&&!r.resumeFrom){const{snapshot:i,layout:o}=r;if(i&&o){const a={x:{min:0,max:0},y:{min:0,max:0}};Aa(a,n.layoutBox,i.layoutBox);const s={x:{min:0,max:0},y:{min:0,max:0}};Aa(s,t,o.layoutBox),Is(a,s)||(c=!0),r.options.layoutRoot&&(e.relativeTarget=s,e.relativeTargetOrigin=a,e.relativeParent=r)}}}e.notifyListeners("didUpdate",{layout:t,snapshot:n,delta:s,layoutDelta:a,hasLayoutChanged:l,hasRelativeTargetChanged:c})}else if(e.isLead()){const{onExitComplete:t}=e.options;t&&t()}e.options.transition=void 0}function Ks(e){Vs&&Bs.totalNodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=Boolean(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function Js(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function Qs(e){e.clearSnapshot()}function $s(e){e.clearMeasurements()}function el(e){e.isLayoutDirty=!1}function tl(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function nl(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function rl(e){e.resolveTargetDelta()}function il(e){e.calcProjection()}function ol(e){e.resetSkewAndRotation()}function al(e){e.removeLeadSnapshot()}function sl(e,t,n){e.translate=ji(t.translate,0,n),e.scale=ji(t.scale,1,n),e.origin=t.origin,e.originPoint=t.originPoint}function ll(e,t,n,r){e.min=ji(t.min,n.min,r),e.max=ji(t.max,n.max,r)}function cl(e){return e.animationValues&&void 0!==e.animationValues.opacityExit}const ul={duration:.45,ease:[.4,0,.1,1]},hl=e=>"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),dl=hl("applewebkit/")&&!hl("chrome/")?Math.round:Ut;function pl(e){e.min=dl(e.min),e.max=dl(e.max)}function fl(e,t,n){return"position"===e||"preserve-aspect"===e&&!function(e,t,n){return Math.abs(e-t)<=n}(Os(t),Os(n),.2)}function ml(e){var t;return e!==e.root&&(null===(t=e.scroll)||void 0===t?void 0:t.wasRoot)}const gl=Ws({attachResizeListener:(e,t)=>ua(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),yl={current:void 0},_l=Ws({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!yl.current){const e=new gl({});e.mount(window),e.setOptions({layoutScroll:!0}),yl.current=e}return yl.current},resetTransform:(e,t)=>{e.style.transform=void 0!==t?t:"none"},checkIsScrollRoot:e=>Boolean("fixed"===window.getComputedStyle(e).position)}),vl={pan:{Feature:class extends Wo{constructor(){super(...arguments),this.removePointerDownListener=Ut}onPointerDown(e){this.session=new pa(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:Ka(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:n,onPanEnd:r}=this.node.getProps();return{onSessionStart:es(e),onStart:es(t),onMove:n,onEnd:(e,t)=>{delete this.session,r&&Sn.postRender((()=>r(e,t)))}}}mount(){this.removePointerDownListener=ha(this.node.current,"pointerdown",(e=>this.onPointerDown(e)))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}},drag:{Feature:class extends Wo{constructor(e){super(e),this.removeGroupControls=Ut,this.removeListeners=Ut,this.controls=new Qa(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Ut}unmount(){this.removeGroupControls(),this.removeListeners()}},ProjectionNode:_l,MeasureLayout:us}};function xl(e,t,n){const{props:r}=e;e.animationState&&r.whileHover&&e.animationState.setActive("whileHover","Start"===n);const i=r["onHover"+n];i&&Sn.postRender((()=>i(t,ca(t))))}function bl(e,t,n){const{props:r}=e;e.animationState&&r.whileTap&&e.animationState.setActive("whileTap","Start"===n);const i=r["onTap"+("End"===n?"":n)];i&&Sn.postRender((()=>i(t,ca(t))))}const wl=["root"],Sl=new WeakMap,Tl=new WeakMap,El=e=>{const t=Sl.get(e.target);t&&t(e)},Al=e=>{e.forEach(El)};function Ml(e,t,n){const r=function(e){let{root:t}=e,n=i(e,wl);const r=t||document;Tl.has(r)||Tl.set(r,{});const o=Tl.get(r),a=JSON.stringify(n);return o[a]||(o[a]=new IntersectionObserver(Al,c({root:t},n))),o[a]}(t);return Sl.set(e,n),r.observe(e),()=>{Sl.delete(e),r.unobserve(e)}}const Pl={some:0,all:1};const kl={inView:{Feature:class extends Wo{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:n,amount:r="some",once:i}=e,o={root:t?t.current:void 0,rootMargin:n,threshold:"number"===typeof r?r:Pl[r]};return Ml(this.node.current,o,(e=>{const{isIntersecting:t}=e;if(this.isInView===t)return;if(this.isInView=t,i&&!t&&this.hasEnteredView)return;t&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",t);const{onViewportEnter:n,onViewportLeave:r}=this.node.getProps(),o=t?n:r;o&&o(e)}))}mount(){this.startObserver()}update(){if("undefined"===typeof IntersectionObserver)return;const{props:e,prevProps:t}=this.node,n=["amount","margin","root"].some(function(e){let{viewport:t={}}=e,{viewport:n={}}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e=>t[e]!==n[e]}(e,t));n&&this.startObserver()}unmount(){}}},tap:{Feature:class extends Wo{mount(){const{current:e}=this.node;e&&(this.unmount=la(e,(e=>(bl(this.node,e,"Start"),(e,t)=>{let{success:n}=t;return bl(this.node,e,n?"End":"Cancel")})),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}},focus:{Feature:class extends Wo{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch(KL){e=!0}e&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){this.isActive&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Ci(ua(this.node.current,"focus",(()=>this.onFocus())),ua(this.node.current,"blur",(()=>this.onBlur())))}unmount(){}}},hover:{Feature:class extends Wo{mount(){const{current:e}=this.node;e&&(this.unmount=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const[r,i,o]=$o(e,n),a=ea((e=>{const{target:n}=e,r=t(e);if(!r||!n)return;const o=ea((e=>{r(e),n.removeEventListener("pointerleave",o)}));n.addEventListener("pointerleave",o,i)}));return r.forEach((e=>{e.addEventListener("pointerenter",a,i)})),o}(e,(e=>(xl(this.node,e,"Start"),e=>xl(this.node,e,"End")))))}unmount(){}}}},Cl={layout:{ProjectionNode:_l,MeasureLayout:us}},jl=(0,t.createContext)({}),Il=(0,t.createContext)({strict:!1});function Ol(e,n,r,i,o){var a,s;const{visualElement:l}=(0,t.useContext)(jl),c=(0,t.useContext)(Il),u=(0,t.useContext)(Nt),h=(0,t.useContext)(Lt).reducedMotion,d=(0,t.useRef)(null);i=i||c.renderer,!d.current&&i&&(d.current=i(e,{visualState:n,parent:l,props:r,presenceContext:u,blockInitialAnimation:!!u&&!1===u.initial,reducedMotionConfig:h}));const p=d.current,f=(0,t.useContext)(ts);!p||p.projection||!o||"html"!==p.type&&"svg"!==p.type||function(e,t,n,r){const{layoutId:i,layout:o,drag:a,dragConstraints:s,layoutScroll:l,layoutRoot:c}=t;e.projection=new n(e.latestValues,t["data-framer-portal-id"]?void 0:Nl(e.parent)),e.projection.setOptions({layoutId:i,layout:o,alwaysMeasureLayout:Boolean(a)||s&&xa(s),visualElement:e,animationType:"string"===typeof o?o:"both",initialPromotionConfig:r,layoutScroll:l,layoutRoot:c})}(d.current,r,o,f);const m=(0,t.useRef)(!1);(0,t.useInsertionEffect)((()=>{p&&m.current&&p.update(r,u)}));const g=r[Po],y=(0,t.useRef)(Boolean(g)&&!(null===(a=window.MotionHandoffIsComplete)||void 0===a?void 0:a.call(window,g))&&(null===(s=window.MotionHasOptimisedAnimation)||void 0===s?void 0:s.call(window,g)));return Xt((()=>{p&&(m.current=!0,window.MotionIsMounted=!0,p.updateFeatures(),ss.render(p.render),y.current&&p.animationState&&p.animationState.animateChanges())})),(0,t.useEffect)((()=>{p&&(!y.current&&p.animationState&&p.animationState.animateChanges(),y.current&&(queueMicrotask((()=>{var e;null===(e=window.MotionHandoffMarkAsComplete)||void 0===e||e.call(window,g)})),y.current=!1))})),p}function Nl(e){if(e)return!1!==e.options.allowProjection?e.projection:Nl(e.parent)}function Dl(e,n,r){return(0,t.useCallback)((t=>{t&&e.mount&&e.mount(t),n&&(t?n.mount(t):n.unmount()),r&&("function"===typeof r?r(t):xa(r)&&(r.current=t))}),[n])}function Ll(e){return Jt(e.animate)||an.some((t=>en(e[t])))}function zl(e){return Boolean(Ll(e)||e.variants)}function Rl(e){const{initial:n,animate:r}=function(e,t){if(Ll(e)){const{initial:t,animate:n}=e;return{initial:!1===t||en(t)?t:void 0,animate:en(n)?n:void 0}}return!1!==e.inherit?t:{}}(e,(0,t.useContext)(jl));return(0,t.useMemo)((()=>({initial:n,animate:r})),[Fl(n),Fl(r)])}function Fl(e){return Array.isArray(e)?e.join(" "):e}const Bl={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Vl={};for(const n in Bl)Vl[n]={isEnabled:e=>Bl[n].some((t=>!!e[t]))};const Ul=Symbol.for("motionComponentSymbol");function Gl(e){let{preloadedFeatures:n,createVisualElement:r,useRender:i,useVisualState:o,Component:a}=e;n&&function(e){for(const t in e)Vl[t]=c(c({},Vl[t]),e[t])}(n);const s=(0,t.forwardRef)((function(e,n){let s;const l=c(c(c({},(0,t.useContext)(Lt)),e),{},{layoutId:Hl(e)}),{isStatic:u}=l,h=Rl(e),d=o(e,u);if(!u&&Wt){!function(){(0,t.useContext)(Il).strict;0}();const e=function(e){const{drag:t,layout:n}=Vl;if(!t&&!n)return{};const r=c(c({},t),n);return{MeasureLayout:(null===t||void 0===t?void 0:t.isEnabled(e))||(null===n||void 0===n?void 0:n.isEnabled(e))?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}(l);s=e.MeasureLayout,h.visualElement=Ol(a,d,l,r,e.ProjectionNode)}return(0,Ot.jsxs)(jl.Provider,{value:h,children:[s&&h.visualElement?(0,Ot.jsx)(s,c({visualElement:h.visualElement},l)):null,i(a,e,Dl(d,h.visualElement,n),d,u,h.visualElement)]})}));return s[Ul]=a,s}function Hl(e){let{layoutId:n}=e;const r=(0,t.useContext)(Vt).id;return r&&void 0!==n?r+"-"+n:n}const Zl=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function ql(e){return"string"===typeof e&&!e.includes("-")&&!!(Zl.indexOf(e)>-1||/[A-Z]/.test(e))}function Wl(e,t,n,r){let{style:i,vars:o}=t;Object.assign(e.style,i,r&&r.getProjectionStyles(n));for(const a in o)e.style.setProperty(a,o[a])}const Xl=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function Yl(e,t,n,r){Wl(e,t,void 0,r);for(const i in t.attrs)e.setAttribute(Xl.has(i)?i:Mo(i),t.attrs[i])}function Kl(e,t){let{layout:n,layoutId:r}=t;return ln.has(e)||e.startsWith("origin")||(n||void 0!==r)&&(!!as[e]||"opacity"===e)}function Jl(e,t,n){var r;const{style:i}=e,o={};for(const a in i)(Co(i[a])||t.style&&Co(t.style[a])||Kl(a,e)||void 0!==(null===(r=null===n||void 0===n?void 0:n.getValue(a))||void 0===r?void 0:r.liveStyle))&&(o[a]=i[a]);return o}function Ql(e,t,n){const r=Jl(e,t,n);for(const i in e)if(Co(e[i])||Co(t[i])){r[-1!==sn.indexOf(i)?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i]=e[i]}return r}const $l=["transitionEnd","transition"];const ec=e=>(n,r)=>{const i=(0,t.useContext)(jl),o=(0,t.useContext)(Nt),a=()=>function(e,t,n,r){let{scrapeMotionValuesFromProps:i,createRenderState:o,onMount:a}=e;const s={latestValues:tc(t,n,r,i),renderState:o()};return a&&(s.mount=e=>a(t,e,s)),s}(e,n,i,o);return r?a():Dt(a)};function tc(e,t,n,r){const o={},a=r(e,{});for(const i in a)o[i]=Rs(a[i]);let{initial:s,animate:l}=e;const c=Ll(e),u=zl(e);t&&u&&!c&&!1!==e.inherit&&(void 0===s&&(s=t.initial),void 0===l&&(l=t.animate));let h=!!n&&!1===n.initial;h=h||!1===s;const d=h?l:s;if(d&&"boolean"!==typeof d&&!Jt(d)){const t=Array.isArray(d)?d:[d];for(let n=0;n<t.length;n++){const r=nn(e,t[n]);if(r){const{transitionEnd:e,transition:t}=r,n=i(r,$l);for(const r in n){let e=n[r];if(Array.isArray(e)){e=e[h?e.length-1:0]}null!==e&&(o[r]=e)}for(const r in e)o[r]=e[r]}}}return o}const nc=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),rc=()=>c(c({},{style:{},transform:{},transformOrigin:{},vars:{}}),{},{attrs:{}}),ic=(e,t)=>t&&"number"===typeof e?t.transform(e):e,oc={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},ac=sn.length;function sc(e,t,n){const{style:r,vars:i,transformOrigin:o}=e;let a=!1,s=!1;for(const l in t){const e=t[l];if(ln.has(l))a=!0;else if(Un(l))i[l]=e;else{const t=ic(e,Wr[l]);l.startsWith("origin")?(s=!0,o[l]=t):r[l]=t}}if(t.transform||(a||n?r.transform=function(e,t,n){let r="",i=!0;for(let o=0;o<ac;o++){const a=sn[o],s=e[a];if(void 0===s)continue;let l=!0;if(l="number"===typeof s?s===(a.startsWith("scale")?1:0):0===parseFloat(s),!l||n){const e=ic(s,Wr[a]);l||(i=!1,r+="".concat(oc[a]||a,"(").concat(e,") ")),n&&(t[a]=e)}}return r=r.trim(),n?r=n(t,i?"":r):i&&(r="none"),r}(t,e.transform,n):r.transform&&(r.transform="none")),s){const{originX:e="50%",originY:t="50%",originZ:n=0}=o;r.transformOrigin="".concat(e," ").concat(t," ").concat(n)}}function lc(e,t,n){return"string"===typeof e?e:tr.transform(t+n*e)}const cc={offset:"stroke-dashoffset",array:"stroke-dasharray"},uc={offset:"strokeDashoffset",array:"strokeDasharray"};const hc=["attrX","attrY","attrScale","originX","originY","pathLength","pathSpacing","pathOffset"];function dc(e,t,n,r){let{attrX:o,attrY:a,attrScale:s,originX:l,originY:c,pathLength:u,pathSpacing:h=1,pathOffset:d=0}=t;if(sc(e,i(t,hc),r),n)return void(e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox));e.attrs=e.style,e.style={};const{attrs:p,style:f,dimensions:m}=e;p.transform&&(m&&(f.transform=p.transform),delete p.transform),m&&(void 0!==l||void 0!==c||f.transform)&&(f.transformOrigin=function(e,t,n){const r=lc(t,e.x,e.width),i=lc(n,e.y,e.height);return"".concat(r," ").concat(i)}(m,void 0!==l?l:.5,void 0!==c?c:.5)),void 0!==o&&(p.x=o),void 0!==a&&(p.y=a),void 0!==s&&(p.scale=s),void 0!==u&&function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];e.pathLength=1;const o=i?cc:uc;e[o.offset]=tr.transform(-r);const a=tr.transform(t),s=tr.transform(n);e[o.array]="".concat(a," ").concat(s)}(p,u,h,d,!1)}const pc=e=>"string"===typeof e&&"svg"===e.toLowerCase(),fc={useVisualState:ec({scrapeMotionValuesFromProps:Ql,createRenderState:rc,onMount:(e,t,n)=>{let{renderState:r,latestValues:i}=n;Sn.read((()=>{try{r.dimensions="function"===typeof t.getBBox?t.getBBox():t.getBoundingClientRect()}catch(KL){r.dimensions={x:0,y:0,width:0,height:0}}})),Sn.render((()=>{dc(r,i,pc(t.tagName),e.transformTemplate),Yl(t,r)}))}})},mc={useVisualState:ec({scrapeMotionValuesFromProps:Jl,createRenderState:nc})};function gc(e,t,n){for(const r in t)Co(t[r])||Kl(r,n)||(e[r]=t[r])}function yc(e,n){const r={};return gc(r,e.style||{},e),Object.assign(r,function(e,n){let{transformTemplate:r}=e;return(0,t.useMemo)((()=>{const e={style:{},transform:{},transformOrigin:{},vars:{}};return sc(e,n,r),Object.assign({},e.vars,e.style)}),[n])}(e,n)),r}function _c(e,t){const n={},r=yc(e,t);return e.drag&&!1!==e.dragListener&&(n.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=!0===e.drag?"none":"pan-".concat("x"===e.drag?"y":"x")),void 0===e.tabIndex&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=r,n}const vc=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function xc(e){return e.startsWith("while")||e.startsWith("drag")&&"draggable"!==e||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||vc.has(e)}let bc=e=>!xc(e);try{(wc=require("@emotion/is-prop-valid").default)&&(bc=e=>e.startsWith("on")?!xc(e):wc(e))}catch(JL){}var wc;function Sc(e,n,r,i){const o=(0,t.useMemo)((()=>{const t=rc();return dc(t,n,pc(i),e.transformTemplate),c(c({},t.attrs),{},{style:c({},t.style)})}),[n]);if(e.style){const t={};gc(t,e.style,e),o.style=c(c({},t),o.style)}return o}function Tc(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(n,r,i,o,a)=>{let{latestValues:s}=o;const l=(ql(n)?Sc:_c)(r,s,a,n),u=function(e,t,n){const r={};for(const i in e)"values"===i&&"object"===typeof e.values||(bc(i)||!0===n&&xc(i)||!t&&!xc(i)||e.draggable&&i.startsWith("onDrag"))&&(r[i]=e[i]);return r}(r,"string"===typeof n,e),h=n!==t.Fragment?c(c(c({},u),l),{},{ref:i}):{},{children:d}=r,p=(0,t.useMemo)((()=>Co(d)?d.get():d),[d]);return(0,t.createElement)(n,c(c({},h),{},{children:p}))}}function Ec(e,t){return function(n){let{forwardMotionProps:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{forwardMotionProps:!1};return Gl(c(c({},ql(n)?fc:mc),{},{preloadedFeatures:e,useRender:Tc(r),createVisualElement:t,Component:n}))}}const Ac={current:null},Mc={current:!1};const Pc=new WeakMap,kc=[...pr,Cr,Fr],Cc=["willChange"],jc=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class Ic{scrapeMotionValuesFromProps(e,t,n){return{}}constructor(e){let{parent:t,props:n,presenceContext:r,reducedMotionConfig:o,blockInitialAnimation:a,visualState:s}=e,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=xr,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const e=ni.now();this.renderScheduledAt<e&&(this.renderScheduledAt=e,Sn.render(this.render,!1,!0))};const{latestValues:u,renderState:h}=s;this.latestValues=u,this.baseTarget=c({},u),this.initialValues=n.initial?c({},u):{},this.renderState=h,this.parent=t,this.props=n,this.presenceContext=r,this.depth=t?t.depth+1:0,this.reducedMotionConfig=o,this.options=l,this.blockInitialAnimation=Boolean(a),this.isControllingVariants=Ll(n),this.isVariantNode=zl(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=Boolean(t&&t.current);const d=this.scrapeMotionValuesFromProps(n,{},this),{willChange:p}=d,f=i(d,Cc);for(const i in f){const e=f[i];void 0!==u[i]&&Co(e)&&e.set(u[i],!1)}}mount(e){this.current=e,Pc.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach(((e,t)=>this.bindToMotionValue(t,e))),Mc.current||function(){if(Mc.current=!0,Wt)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>Ac.current=e.matches;e.addListener(t),t()}else Ac.current=!1}(),this.shouldReduceMotion="never"!==this.reducedMotionConfig&&("always"===this.reducedMotionConfig||Ac.current),this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){Pc.delete(this.current),this.projection&&this.projection.unmount(),Tn(this.notifyUpdate),Tn(this.render),this.valueSubscriptions.forEach((e=>e())),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const n=ln.has(e),r=t.on("change",(t=>{this.latestValues[e]=t,this.props.onUpdate&&Sn.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0)})),i=t.on("renderRequest",this.scheduleRender);let o;window.MotionCheckAppearSync&&(o=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,(()=>{r(),i(),o&&o(),t.owner&&t.stop()}))}sortNodePosition(e){return this.current&&this.sortInstanceNodePosition&&this.type===e.type?this.sortInstanceNodePosition(this.current,e.current):0}updateFeatures(){let e="animation";for(e in Vl){const t=Vl[e];if(!t)continue;const{isEnabled:n,Feature:r}=t;if(!this.features[e]&&r&&n(this.props)&&(this.features[e]=new r(this)),this.features[e]){const t=this.features[e];t.isMounted?t.update():(t.mount(),t.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):{x:{min:0,max:0},y:{min:0,max:0}}}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let n=0;n<jc.length;n++){const t=jc[n];this.propEventSubscriptions[t]&&(this.propEventSubscriptions[t](),delete this.propEventSubscriptions[t]);const r=e["on"+t];r&&(this.propEventSubscriptions[t]=this.on(t,r))}this.prevMotionValues=function(e,t,n){for(const r in t){const i=t[r],o=n[r];if(Co(i))e.addValue(r,i);else if(Co(o))e.addValue(r,To(i,{owner:e}));else if(o!==i)if(e.hasValue(r)){const t=e.getValue(r);!0===t.liveStyle?t.jump(i):t.hasAnimated||t.set(i)}else{const t=e.getStaticValue(r);e.addValue(r,To(void 0!==t?t:i,{owner:e}))}}for(const r in n)void 0===t[r]&&e.removeValue(r);return t}(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const n=this.values.get(e);t!==n&&(n&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let n=this.values.get(e);return void 0===n&&void 0!==t&&(n=To(null===t?void 0:t,{owner:this}),this.addValue(e,n)),n}readValue(e,t){var n;let r=void 0===this.latestValues[e]&&this.current?null!==(n=this.getBaseTargetFromProps(this.props,e))&&void 0!==n?n:this.readValueFromInstance(this.current,e,this.options):this.latestValues[e];var i;return void 0!==r&&null!==r&&("string"===typeof r&&(Bn(r)||Rn(r))?r=parseFloat(r):(i=r,!kc.find(dr(i))&&Fr.test(t)&&(r=Kr(e,t))),this.setBaseTarget(e,Co(r)?r.get():r)),Co(r)?r.get():r}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var t;const{initial:n}=this.props;let r;if("string"===typeof n||"object"===typeof n){const i=nn(this.props,n,null===(t=this.presenceContext)||void 0===t?void 0:t.custom);i&&(r=i[e])}if(n&&void 0!==r)return r;const i=this.getBaseTargetFromProps(this.props,e);return void 0===i||Co(i)?void 0!==this.initialValues[e]&&void 0===r?void 0:this.baseTarget[e]:i}on(e,t){return this.events[e]||(this.events[e]=new bo),this.events[e].add(t)}notify(e){if(this.events[e]){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.events[e].notify(...n)}}}class Oc extends Ic{constructor(){super(...arguments),this.KeyframeResolver=Qr}sortInstanceNodePosition(e,t){return 2&e.compareDocumentPosition(t)?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,t){let{vars:n,style:r}=t;delete n[e],delete r[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Co(e)&&(this.childSubscription=e.on("change",(e=>{this.current&&(this.current.textContent="".concat(e))})))}}class Nc extends Oc{constructor(){super(...arguments),this.type="html",this.renderInstance=Wl}readValueFromInstance(e,t){if(ln.has(t)){const e=Yr(t);return e&&e.default||0}{const r=(n=e,window.getComputedStyle(n)),i=(Un(t)?r.getPropertyValue(t):r[t])||0;return"string"===typeof i?i.trim():i}var n}measureInstanceViewportBox(e,t){let{transformPagePoint:n}=t;return Ya(e,n)}build(e,t,n){sc(e,t,n.transformTemplate)}scrapeMotionValuesFromProps(e,t,n){return Jl(e,t,n)}}class Dc extends Oc{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Ia}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(ln.has(t)){const e=Yr(t);return e&&e.default||0}return t=Xl.has(t)?t:Mo(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,n){return Ql(e,t,n)}build(e,t,n){dc(e,t,this.isSVGTag,n.transformTemplate)}renderInstance(e,t,n,r){Yl(e,t,0,r)}mount(e){this.isSVGTag=pc(e.tagName),super.mount(e)}}const Lc=(e,n)=>ql(e)?new Dc(n):new Nc(n,{allowProjection:e!==t.Fragment}),zc=Kt(Ec(c(c(c(c({},Yo),kl),vl),Cl),Lc));var Rc=n(2806);const Fc=()=>{const[e,n]=(0,t.useState)(!1),r=se(),i=ue(),o=[{path:"/",label:"Home"},{path:"/properties",label:"Properties"},{path:"/buildfund-hub",label:"BuildFund Hub",isNew:!0,subItems:[{path:"/buildfund-hub/community-pulse",label:"CommunityPulse",icon:At,description:"Shape your community's future"},{path:"/buildfund-hub/smart-vest",label:"SmartVest",icon:Mt,description:"Smart real estate investment from \u20a61,000"},{path:"/buildfund-hub/revenue-sense",label:"RevenueSense",icon:Pt,description:"RevenueSense insights"}]},{path:"/infrastructure",label:"Infrastructure",subItems:[{path:"/infrastructure/analysis",label:"Analysis",icon:Pt,description:"Infrastructure scoring and insights"},{path:"/infrastructure/market",label:"Market Trends",icon:kt,description:"Real estate market analysis"}]}],a=e=>r.pathname===e,s=e=>e.subItems?e.subItems.some((e=>r.pathname.startsWith(e.path))):r.pathname===e.path,l=e=>{e.subItems,i(e.path),n(!1)};return(0,Ot.jsx)("header",{className:"bg-white shadow-sm fixed w-full top-0 z-50",children:(0,Ot.jsxs)("nav",{className:"container mx-auto px-4",children:[(0,Ot.jsxs)("div",{className:"flex items-center justify-between h-20",children:[(0,Ot.jsx)(ut,{to:"/",className:"flex items-center",children:(0,Ot.jsx)("img",{src:Rc,alt:"FastFind360 Logo",className:"h-12 w-auto"})}),(0,Ot.jsx)("div",{className:"hidden md:flex items-center space-x-1",children:o.map((e=>(0,Ot.jsxs)("div",{className:"relative group",children:[(0,Ot.jsxs)("button",{onClick:()=>l(e),className:"px-4 py-2 rounded-full font-medium transition-all duration-300 flex items-center gap-2\n                    ".concat(a(e.path)?"text-[#1c5bde] bg-[#1c5bde]/5":"text-gray-600 hover:text-[#1c5bde] hover:bg-[#1c5bde]/5"),children:[e.label,e.isNew&&(0,Ot.jsx)("span",{className:"absolute -top-1 -right-1 px-1.5 py-0.5 bg-[#ff8533] text-white text-xs rounded-full",children:"New"})]}),e.subItems&&(0,Ot.jsx)("div",{className:"absolute left-0 mt-2 w-64 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300",children:(0,Ot.jsx)("div",{className:"bg-white rounded-xl shadow-lg p-3 space-y-1",children:e.subItems.map((e=>(0,Ot.jsxs)(ut,{to:e.path,className:"flex items-start p-3 rounded-lg hover:bg-gray-50 transition-colors\n                            ".concat(a(e.path)?"bg-gray-50":""),children:[(0,Ot.jsx)(e.icon,{className:"h-5 w-5 mt-0.5 ".concat(a(e.path)?"text-[#1c5bde]":"text-gray-400")}),(0,Ot.jsxs)("div",{className:"ml-3",children:[(0,Ot.jsx)("div",{className:"font-medium ".concat(a(e.path)?"text-[#1c5bde]":"text-gray-900"),children:e.label}),(0,Ot.jsx)("div",{className:"text-sm text-gray-500",children:e.description})]})]},e.path)))})})]},e.path)))}),(0,Ot.jsxs)("div",{className:"hidden md:flex items-center gap-2",children:[(0,Ot.jsx)("button",{className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:(0,Ot.jsx)(Ct,{className:"h-5 w-5 text-gray-600"})}),(0,Ot.jsx)(ut,{to:"/signin",className:"px-4 py-2 text-[#1c5bde] hover:bg-[#1c5bde]/5 rounded-full transition-colors",children:"Sign In"}),(0,Ot.jsx)(ut,{to:"/signup",className:"px-4 py-2 bg-[#1c5bde] text-white rounded-full hover:bg-[#0c0d8a] transition-colors",children:"Get Started"})]}),(0,Ot.jsx)("button",{onClick:()=>n(!e),className:"md:hidden p-2",children:e?(0,Ot.jsx)(jt,{}):(0,Ot.jsx)(It,{})})]}),(0,Ot.jsx)(Yt,{children:e&&(0,Ot.jsx)(zc.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"md:hidden border-t",children:(0,Ot.jsxs)("div",{className:"py-4 space-y-1",children:[o.map((e=>(0,Ot.jsxs)("div",{children:[(0,Ot.jsxs)("button",{onClick:()=>{l(e),n(!1)},className:"w-full px-4 py-2 text-left ".concat(s(e)?"text-[#1c5bde] bg-[#1c5bde]/5":"text-gray-600"),children:[e.label,e.isNew&&(0,Ot.jsx)("span",{className:"ml-2 px-1.5 py-0.5 bg-red-500 text-white text-xs rounded-full",children:"New"})]}),e.subItems&&(0,Ot.jsx)("div",{className:"pl-8 space-y-1 py-2",children:e.subItems.map((e=>(0,Ot.jsxs)(ut,{to:e.path,onClick:()=>n(!1),className:"flex items-center gap-2 px-4 py-2 rounded-lg\n                              ".concat(a(e.path)?"text-[#1c5bde] bg-[#1c5bde]/5":"text-gray-600 hover:text-[#1c5bde] hover:bg-[#1c5bde]/5"),children:[(0,Ot.jsx)(e.icon,{className:"h-4 w-4"}),e.label]},e.path)))})]},e.path))),(0,Ot.jsxs)("div",{className:"pt-4 mt-4 border-t space-y-2 px-4",children:[(0,Ot.jsx)(ut,{to:"/signin",onClick:()=>n(!1),className:"block w-full py-2 text-center text-[#1c5bde] hover:bg-[#1c5bde]/5 rounded-full transition-colors",children:"Sign In"}),(0,Ot.jsx)(ut,{to:"/signup",onClick:()=>n(!1),className:"block w-full py-2 text-center bg-[#1c5bde] text-white rounded-full hover:bg-[#0c0d8a] transition-colors",children:"Get Started"})]})]})})})]})})},Bc=Et("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]),Vc=Et("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]),Uc=Et("Minimize2",[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]),Gc=Et("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]),Hc=(n.p,[{id:1,title:"Braverock Park Estate Villa",price:"\u20a645,000,000",location:"Braverock Park, Gombe",beds:4,baths:3,area:"250m\xb2",image:"https://images.unsplash.com/photo-1600047509807-ba8f99d2cdde",description:"Luxurious villa in the prestigious Braverock Park Estate.",coordinates:[11.172,10.284],type:"luxury",investment_score:8,growth:10},{id:2,title:"Modern Apartment in Maitama",price:"\u20a675,000,000",location:"Maitama District, Abuja",beds:3,baths:2,area:"150m\xb2",image:"https://images.unsplash.com/photo-1600596542815-ffad4c1539a9",description:"Spacious apartment with modern amenities in the heart of Maitama.",coordinates:[7.498,9.082],type:"residential",investment_score:7,growth:8},{id:3,title:"Luxury Villa in Asokoro",price:"\u20a6120,000,000",location:"Asokoro District, Abuja",beds:5,baths:4,area:"300m\xb2",image:n.p+"static/media/image2.98b35eb01a1e854cba4d.jpg",description:"Elegant villa with premium finishes in prestigious Asokoro.",coordinates:[7.526,9.045],type:"luxury",investment_score:8,growth:12},{id:4,title:"Office Space in Central Business District",price:"\u20a645,000,000",location:"CBD, Abuja",beds:null,baths:2,area:"200m\xb2",image:n.p+"static/media/image3.c0e0e4fd7c8edfd6a69e.jpg",description:"Prime office space in Abuja's business hub.",coordinates:[7.498,9.027],type:"commercial",investment_score:9,growth:15},{id:5,title:"Luxury Penthouse in Jabi",price:"\u20a6180,000,000",location:"Jabi District, Abuja",beds:4,baths:4,area:"350m\xb2",image:"https://images.unsplash.com/photo-1600607687939-ce8a6c25118c",description:"Stunning penthouse with panoramic city views.",coordinates:[7.425,9.082],type:"luxury",investment_score:9,growth:14},{id:6,title:"Garden Apartment in Wuse",price:"\u20a665,000,000",location:"Wuse Zone 6, Abuja",beds:2,baths:2,area:"120m\xb2",image:"https://images.unsplash.com/photo-1600585154340-be6161a56a0c",description:"Modern apartment with beautiful garden views.",coordinates:[7.459,9.072],type:"residential",investment_score:6,growth:7},{id:7,title:"Modern Townhouse in GRA",price:"\u20a635,000,000",location:"GRA, Gombe",beds:3,baths:2,area:"180m\xb2",image:"https://images.unsplash.com/photo-1600566753376-12c8ab7fb75b",description:"Contemporary townhouse in Gombe's prime location.",coordinates:[11.169,10.287],type:"residential",investment_score:7,growth:9},{id:8,title:"Oceanfront Apartment in Eko Atlantic",price:"\u20a6250,000,000",location:"Eko Atlantic, Lagos",beds:3,baths:3,area:"200m\xb2",image:"https://images.unsplash.com/photo-1600573472592-401b489a3cdc",description:"Luxury apartment with stunning ocean views.",coordinates:[3.404,6.419],type:"luxury",investment_score:9,growth:15},{id:9,title:"Modern Villa in Lekki Phase 1",price:"\u20a6180,000,000",location:"Lekki Phase 1, Lagos",beds:5,baths:4,area:"400m\xb2",image:"https://images.unsplash.com/photo-1600047509358-9dc75507daeb",description:"Spacious family home in prestigious Lekki.",coordinates:[3.475,6.431],type:"luxury",investment_score:8,growth:12},{id:10,title:"Executive Home in Millennium City",price:"\u20a685,000,000",location:"Millennium City, Kaduna",beds:4,baths:3,area:"300m\xb2",image:"https://images.unsplash.com/photo-1600585154526-990dced4db0d",description:"Modern family home in secure estate.",coordinates:[7.509,10.469],type:"residential",investment_score:7,growth:8},{id:11,title:"Garden Estate Villa in Barnawa",price:"\u20a665,000,000",location:"Barnawa, Kaduna",beds:3,baths:2,area:"250m\xb2",image:"https://images.unsplash.com/photo-1600566753190-17f0baa2a6c3",description:"Beautiful villa with extensive gardens.",coordinates:[7.44,10.482],type:"residential",investment_score:6,growth:7},{id:12,title:"Waterfront Mansion in Old GRA",price:"\u20a6150,000,000",location:"Old GRA, Port Harcourt",beds:6,baths:5,area:"500m\xb2",image:"https://images.unsplash.com/photo-1600607687920-4e2a09cf159d",description:"Luxurious mansion with waterfront views.",coordinates:[7.05,4.816],type:"luxury",investment_score:8,growth:11},{id:13,title:"Modern Apartment in Peter Odili",price:"\u20a655,000,000",location:"Peter Odili Road, Port Harcourt",beds:3,baths:2,area:"150m\xb2",image:"https://images.unsplash.com/photo-1600585154340-be6161a56a0c",description:"Contemporary apartment in prime location.",coordinates:[7.08,4.789],type:"residential",investment_score:7,growth:9}]),Zc={categories:[{id:"schools",name:"Schools",icon:"\ud83c\udfeb",items:[{id:1,name:"Turkish Nile University",location:[7.491,9.082],type:"University",rating:4.7,distance:"1.2km",details:{type:"Private University",facilities:["Library","Sports Complex","Labs"],studentCapacity:5e3}},{id:2,name:"Baze University",location:[7.479,9.097],type:"University",rating:4.6,distance:"2.5km",details:{type:"Private University",facilities:["Modern Library","Research Centers"],studentCapacity:4e3}},{id:3,name:"Veritas University",location:[7.513,9.087],type:"University",rating:4.5,distance:"3.1km",details:{type:"Private Catholic University",facilities:["Chapel","Library","Labs"],studentCapacity:3500}},{id:4,name:"Lead British International School",location:[7.503,9.089],type:"International School",rating:4.8,distance:"1.1km",details:{type:"Primary & Secondary",curriculum:"British",facilities:["Swimming Pool","Sports Complex"]}},{id:5,name:"Nigerian Turkish International School",location:[7.495,9.094],type:"International School",rating:4.5,distance:"2.0km",details:{type:"Primary & Secondary",curriculum:"International",facilities:["Science Labs","Sports Facilities"]}},{id:6,name:"Capital Science Academy",location:[7.512,9.078],type:"Secondary School",rating:4.7,distance:"0.8km",details:{type:"Secondary Education",facilities:["Science Labs","Sports Field"]}},{id:7,name:"Government Secondary School Garki",location:[7.489,9.065],type:"Secondary School",rating:4,distance:"1.5km",details:{type:"Public Secondary",facilities:["Classrooms","Sports Field"]}},{id:8,name:"Model Secondary School Maitama",location:[7.505,9.082],type:"Secondary School",rating:4.3,distance:"1.8km",details:{type:"Public Secondary",facilities:["Library","Labs","Sports Field"]}}]},{id:"hospitals",name:"Hospitals",icon:"\ud83c\udfe5",items:[{id:1,name:"National Hospital Abuja",location:[7.483,9.051],type:"General Hospital",rating:4.5,distance:"1.5km",details:{services:["Emergency Care","Surgery","Pediatrics"],beds:350,operatingHours:"24/7"}},{id:2,name:"Cedarcrest Hospital",location:[7.491,9.076],type:"Specialist Hospital",rating:4.6,distance:"0.9km",details:{services:["Orthopedics","Cardiology"],beds:200,operatingHours:"24/7"}},{id:3,name:"Garki Hospital",location:[7.495,9.033],type:"General Hospital",rating:4.3,distance:"2.2km",details:{services:["General Medicine","Surgery"],beds:250,operatingHours:"24/7"}},{id:4,name:"Asokoro District Hospital",location:[7.526,9.045],type:"General Hospital",rating:4.3,distance:"1.8km",details:{services:["Emergency Care","Maternity"],beds:200,operatingHours:"24/7"}},{id:5,name:"Wuse General Hospital",location:[7.491,9.082],type:"General Hospital",rating:4.2,distance:"1.3km",details:{services:["General Medicine","Pediatrics"],beds:180,operatingHours:"24/7"}},{id:6,name:"Nisa Premier Hospital",location:[7.488,9.058],type:"Private Hospital",rating:4.7,distance:"1.4km",details:{services:["Maternity","Surgery","IVF"],beds:100,operatingHours:"24/7"}}]},{id:"roads",name:"Roads",icon:"\ud83d\udee3\ufe0f",items:[{id:1,name:"Nnamdi Azikiwe Expressway",location:[7.495,9.065],type:"Major Highway",rating:4.3,distance:"1.1km",details:{type:"Six-Lane Highway",condition:"Excellent",connections:["Airport Road","City Center"]}},{id:2,name:"Ahmadu Bello Way",location:[7.486,9.072],type:"Major Road",rating:4,distance:"0.7km",details:{type:"Four-Lane Road",condition:"Good",connections:["Central Business District"]}}]},{id:"transport",name:"Transport",icon:"\ud83d\ude8c",items:[{id:1,name:"Abuja Central Station",location:[7.495,9.065],type:"Train Station",rating:4.3,distance:"1.1km",details:{routes:["Abuja-Kaduna","Abuja-Lagos"],facilities:["Parking","Waiting Area"]}},{id:2,name:"Berger Bus Terminal",location:[7.486,9.072],type:"Bus Station",rating:4,distance:"0.7km",details:{routes:["City Center","Airport"],operatingHours:"5:00 AM - 10:00 PM"}}]},{id:"utilities",name:"Utilities",icon:"\u26a1",items:[{id:1,name:"Abuja Power Substation",location:[7.482,9.071],type:"Electricity",rating:4,coverage:"20km radius",details:{type:"Power Distribution",capacity:"132/33 KV",reliability:"90%"}},{id:2,name:"Water Treatment Plant",location:[7.489,9.068],type:"Water Supply",rating:4.2,coverage:"15km radius",details:{type:"Water Treatment",capacity:"500,000 liters/day"}}]},{id:"development",name:"Development Projects",icon:"\ud83c\udfd7\ufe0f",items:[{id:1,name:"Abuja Light Rail Extension",location:[7.488,9.068],type:"Infrastructure",status:"In Progress",completion:"2025",details:{description:"Extension of light rail network",impact:"Improved transportation",stage:"Phase 2"}},{id:2,name:"Smart City Initiative",location:[7.492,9.075],type:"Urban Development",status:"Planning",completion:"2026",details:{description:"Digital infrastructure upgrade",impact:"Enhanced connectivity",stage:"Initial Phase"}},{id:3,name:"City Initiative",location:[7.492,9.75],type:"Urban Development",status:"Planning",completion:"2026",details:{description:"Digital infrastructure upgrade",impact:"Enhanced connectivity",stage:"Initial Phase"}}]}]},qc={MAPBOX_TOKEN:"pk.eyJ1IjoibW10dWt1ciIsImEiOiJjbTEyZGk2dmwwbjZyMmtzMXFzb3V0cHRuIn0.pDgNHWd_o6u2NKVFib0EPQ"},Wc=qc.API_URL,Xc=()=>{const[e,n]=(0,t.useState)(!1),[r,i]=(0,t.useState)(!1),[o,a]=(0,t.useState)(""),[s,l]=(0,t.useState)(!1),[c]=(0,t.useState)([{text:"Find houses under \u20a65,000,000",category:"price"},{text:"Show luxury properties in Lagos",category:"property"},{text:"What's the infrastructure like in Lekki?",category:"infrastructure"},{text:"Properties near good schools",category:"infrastructure"},{text:"Commercial spaces in Abuja",category:"property"},{text:"3 bedroom apartments in Victoria Island",category:"property"}]),[u,h]=(0,t.useState)([0,1,2]),[d,p]=(0,t.useState)([{type:"bot",content:"Hello! I'm FastFind AI Assistant. How can I help you find your perfect property today?"}]);(0,t.useEffect)((()=>{const e=setInterval((()=>{h((e=>e.map((e=>(e+3)%c.length))))}),5e3);return()=>clearInterval(e)}),[c.length]);const f=async e=>{l(!0);try{const t=Hc.map((e=>({title:e.title,price:e.price,location:e.location,beds:e.beds,baths:e.baths,area:e.area}))),n=Zc.categories.map((e=>({category:e.name,items:e.items.map((e=>({name:e.name,location:e.location,distance:e.distance})))}))),r=d.map((e=>({role:"user"===e.type?"user":"assistant",content:e.content})));console.log("Sending request to API with:",{messages:r,propertyContext:t,infrastructureContext:n});const i=await fetch("".concat(Wc,"/api/chat"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:[...r,{role:"user",content:e}],propertyContext:t,infrastructureContext:n})});console.log("API Response status:",i.status);const o=await i.json();if(console.log("API Response data:",o),!i.ok)throw new Error(o.error||"API Error: ".concat(i.status));setTimeout((()=>{p((e=>[...e,{type:"bot",content:o.response}])),l(!1)}),1e3)}catch(t){console.error("Detailed error in processAIResponse:",t),p((e=>[...e,{type:"bot",content:"I apologize, but I encountered an error: ".concat(t.message,". Please try again.")}])),l(!1)}},m=()=>{o.trim()&&(p((e=>[...e,{type:"user",content:o}])),f(o),a(""))};return(0,Ot.jsxs)("div",{className:"fixed bottom-4 right-4 z-50",children:[!e&&(0,Ot.jsxs)("button",{onClick:()=>n(!0),className:"bg-[#1c5bde] hover:bg-[#0c0d8a] text-white rounded-full p-4 shadow-lg transition-all duration-200 flex items-center gap-2",children:[(0,Ot.jsx)(Bc,{className:"h-6 w-6"}),(0,Ot.jsx)("span",{className:"text-sm",children:"Ask FastFind AI"})]}),e&&(0,Ot.jsxs)("div",{className:"bg-white rounded-lg shadow-xl transition-all duration-200 ".concat(r?"h-14":"h-[500px]"," w-[350px] flex flex-col"),children:[(0,Ot.jsxs)("div",{className:"p-4 bg-[#1c5bde] text-white rounded-t-lg flex justify-between items-center",children:[(0,Ot.jsx)("h3",{className:"font-semibold",children:"FastFind AI Assistant"}),(0,Ot.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Ot.jsx)("button",{onClick:()=>i(!r),className:"hover:bg-blue-700 p-1 rounded",children:r?(0,Ot.jsx)(Vc,{size:18}):(0,Ot.jsx)(Uc,{size:18})}),(0,Ot.jsx)("button",{onClick:()=>n(!1),className:"hover:bg-blue-700 p-1 rounded",children:(0,Ot.jsx)(jt,{size:18})})]})]}),!r&&(0,Ot.jsxs)(Ot.Fragment,{children:[(0,Ot.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[d.map(((e,t)=>(0,Ot.jsx)("div",{className:"flex ".concat("user"===e.type?"justify-end":"justify-start"),children:(0,Ot.jsx)("div",{className:"max-w-[80%] rounded-lg p-3 ".concat("user"===e.type?"bg-[#1c5bde] text-white":"bg-gray-100 text-gray-800"),children:e.content})},t))),s&&(0,Ot.jsx)("div",{className:"flex justify-start",children:(0,Ot.jsx)("div",{className:"bg-gray-100 rounded-lg p-3 max-w-[80%]",children:(0,Ot.jsxs)("div",{className:"flex gap-2",children:[(0,Ot.jsx)("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce"}),(0,Ot.jsx)("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}}),(0,Ot.jsx)("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.4s"}})]})})})]}),(0,Ot.jsxs)("div",{className:"p-4 border-t",children:[(0,Ot.jsx)("div",{className:"mb-4 space-y-2",children:u.map((e=>(0,Ot.jsxs)("button",{onClick:()=>{return t=c[e],p((e=>[...e,{type:"user",content:t.text}])),void f(t.text);var t},className:"w-full text-left text-sm text-gray-600 hover:text-[#1c5bde] hover:bg-[#1c5bde]/5 p-2 rounded-lg transition-colors cursor-pointer flex items-center gap-2",children:[(0,Ot.jsxs)("span",{className:"w-4 h-4",children:["price"===c[e].category&&"\ud83d\udcb0","property"===c[e].category&&"\ud83c\udfe0","infrastructure"===c[e].category&&"\ud83c\udfd7\ufe0f"]}),c[e].text]},e)))}),(0,Ot.jsxs)("div",{className:"flex gap-2",children:[(0,Ot.jsx)("input",{type:"text",value:o,onChange:e=>a(e.target.value),onKeyPress:e=>"Enter"===e.key&&m(),placeholder:"Type your question...",className:"flex-1 border rounded-lg px-3 py-2 focus:outline-none focus:border-blue-600"}),(0,Ot.jsx)("button",{onClick:m,className:"bg-[#1c5bde] hover:bg-[#0c0d8a] text-white rounded-lg px-4 py-2",children:(0,Ot.jsx)(Gc,{size:18})})]})]})]})]})]})},Yc=Et("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]),Kc=Et("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]),Jc=Et("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]),Qc=Et("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),$c=Et("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]),eu=Et("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),tu=Et("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),nu=Et("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]),ru=Et("Trees",[["path",{d:"M10 10v.2A3 3 0 0 1 8.9 16H5a3 3 0 0 1-1-5.8V10a3 3 0 0 1 6 0Z",key:"1l6gj6"}],["path",{d:"M7 16v6",key:"1a82de"}],["path",{d:"M13 19v3",key:"13sx9i"}],["path",{d:"M12 19h8.3a1 1 0 0 0 .7-1.7L18 14h.3a1 1 0 0 0 .7-1.7L16 9h.2a1 1 0 0 0 .8-1.7L13 3l-1.4 1.5",key:"1sj9kv"}]]),iu=Et("Castle",[["path",{d:"M22 20v-9H2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2Z",key:"109fe4"}],["path",{d:"M18 11V4H6v7",key:"mon5oj"}],["path",{d:"M15 22v-4a3 3 0 0 0-3-3a3 3 0 0 0-3 3v4",key:"1k4jtn"}],["path",{d:"M22 11V9",key:"3zbp94"}],["path",{d:"M2 11V9",key:"1x5rnq"}],["path",{d:"M6 4V2",key:"1rsq15"}],["path",{d:"M18 4V2",key:"1jsdo1"}],["path",{d:"M10 4V2",key:"75d9ly"}],["path",{d:"M14 4V2",key:"8nj3z6"}]]),ou=Et("Factory",[["path",{d:"M2 20a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8l-7 5V8l-7 5V4a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"159hny"}],["path",{d:"M17 18h1",key:"uldtlt"}],["path",{d:"M12 18h1",key:"s9uhes"}],["path",{d:"M7 18h1",key:"1neino"}]]),au=Et("Hotel",[["path",{d:"M10 22v-6.57",key:"1wmca3"}],["path",{d:"M12 11h.01",key:"z322tv"}],["path",{d:"M12 7h.01",key:"1ivr5q"}],["path",{d:"M14 15.43V22",key:"1q2vjd"}],["path",{d:"M15 16a5 5 0 0 0-6 0",key:"o9wqvi"}],["path",{d:"M16 11h.01",key:"xkw8gn"}],["path",{d:"M16 7h.01",key:"1kdx03"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 7h.01",key:"1vti4s"}],["rect",{x:"4",y:"2",width:"16",height:"20",rx:"2",key:"1uxh74"}]]),su=Et("Landmark",[["line",{x1:"3",x2:"21",y1:"22",y2:"22",key:"j8o0r"}],["line",{x1:"6",x2:"6",y1:"18",y2:"11",key:"10tf0k"}],["line",{x1:"10",x2:"10",y1:"18",y2:"11",key:"54lgf6"}],["line",{x1:"14",x2:"14",y1:"18",y2:"11",key:"380y"}],["line",{x1:"18",x2:"18",y1:"18",y2:"11",key:"1kevvc"}],["polygon",{points:"12 2 20 7 4 7",key:"jkujk7"}]]),lu=Et("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]),cu=Et("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),uu=Et("Map",[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]]),hu=Et("BedDouble",[["path",{d:"M2 20v-8a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v8",key:"1k78r4"}],["path",{d:"M4 10V6a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v4",key:"fb3tl2"}],["path",{d:"M12 4v6",key:"1dcgq2"}],["path",{d:"M2 18h20",key:"ajqnye"}]]),du=Et("Bath",[["path",{d:"M10 4 8 6",key:"1rru8s"}],["path",{d:"M17 19v2",key:"ts1sot"}],["path",{d:"M2 12h20",key:"9i4pu4"}],["path",{d:"M7 19v2",key:"12npes"}],["path",{d:"M9 5 7.621 3.621A2.121 2.121 0 0 0 4 5v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-5",key:"14ym8i"}]]),pu=Et("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]),fu=Et("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]),mu=Et("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),gu=Et("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]),yu=Et("Quote",[["path",{d:"M16 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"rib7q0"}],["path",{d:"M5 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"1ymkrd"}]]),_u=Et("Apple",[["path",{d:"M12 20.94c1.5 0 2.75 1.06 4 1.06 3 0 6-8 6-12.22A4.91 4.91 0 0 0 17 5c-2.22 0-4 1.44-5 2-1-.56-2.78-2-5-2a4.9 4.9 0 0 0-5 4.78C2 14 5 22 8 22c1.25 0 2.5-1.06 4-1.06Z",key:"3s7exb"}],["path",{d:"M10 2c1 .5 2 2 2 5",key:"fcco2y"}]]),vu=Et("CirclePlay",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]),xu=e=>{let{children:t,className:n=""}=e;return(0,Ot.jsx)("div",{className:"bg-white rounded-lg shadow-lg p-4 ".concat(n),children:t})},bu=e=>{let{children:t,className:n=""}=e;return(0,Ot.jsx)("div",{className:"border-b pb-4 mb-4 ".concat(n),children:t})},wu=e=>{let{children:t,className:n=""}=e;return(0,Ot.jsx)("h2",{className:"text-xl font-semibold ".concat(n),children:t})},Su=e=>{let{children:t,className:n=""}=e;return(0,Ot.jsx)("div",{className:"".concat(n),children:t})},Tu=e=>{let{children:t,className:n=""}=e;return(0,Ot.jsx)("p",{className:"text-sm text-gray-500 ".concat(n),children:t})};var Eu=n(879),Au=n.n(Eu);const Mu=n.p+"static/media/residential.e6cf6d8cb27f56290c8e.png",Pu=n.p+"static/media/commercial.d4eda67619467a3100ee.png",ku=n.p+"static/media/land.49d95e9d2592e844bda6.png",Cu=n.p+"static/media/luxury.d73467159148b16230d8.png",ju=n.p+"static/media/industrial.05e0ccf14ce431204cde.png",Iu=n.p+"static/media/hotels.b924f52871712df1c02b.png",Ou=n.p+"static/media/institutional.d06174c93e0d3d8ae6d6.png",Nu=n.p+"static/media/mixed-use.fe15ae37d4824357a076.png",Du=n.p+"static/media/app-mockup.e0f4b343f81e10dd7d53.png",Lu=[{title:"Easy to Use",description:"Intuitive interface for seamless experience",icon:(0,Ot.jsx)(Yc,{className:"h-5 w-5 text-[#1c5bde]"})},{title:"Real-time Updates",description:"Get instant notifications for new properties",icon:(0,Ot.jsx)(Kc,{className:"h-5 w-5 text-[#1c5bde]"})},{title:"Save Favorites",description:"Bookmark properties for later viewing",icon:(0,Ot.jsx)(Jc,{className:"h-5 w-5 text-[#1c5bde]"})},{title:"Virtual Tours",description:"View properties in 360\xb0 from anywhere",icon:(0,Ot.jsx)(Qc,{className:"h-5 w-5 text-[#1c5bde]"})}],zu=[{name:"John Smith",role:"Property Buyer",comment:"FastFind made my property search incredibly easy. The 360\xb0 tours saved me so much time!",image:"/path/to/image1.jpg"},{name:"Sarah Johnson",role:"Real Estate Agent",comment:"The best platform for showcasing properties. My clients love the virtual tours feature.",image:"/path/to/image2.jpg"},{name:"Michael Brown",role:"Property Investor",comment:"The infrastructure insights helped me make informed investment decisions. Highly recommended!",image:"/path/to/image3.jpg"}],Ru=[{title:"Search Location",description:"Enter your preferred location and property requirements",icon:(0,Ot.jsx)(Ct,{className:"w-6 h-6 text-[#1c5bde]"})},{title:"Explore Properties",description:"Browse through verified properties with detailed information",icon:(0,Ot.jsx)($c,{className:"w-6 h-6 text-[#1c5bde]"})},{title:"Make Your Choice",description:"Select your perfect property and contact the agent",icon:(0,Ot.jsx)(eu,{className:"w-6 h-6 text-[#1c5bde]"})}],Fu=[{title:"360\xb0 Virtual Tours",description:"Experience properties virtually with our immersive 3D tours",icon:(0,Ot.jsx)(Qc,{className:"w-6 h-6 text-[#1c5bde]"})},{title:"Infrastructure Insights",description:"Make informed decisions with detailed infrastructure information",icon:(0,Ot.jsx)(tu,{className:"w-6 h-6 text-[#1c5bde]"})},{title:"Verified Listings",description:"All properties are verified for authenticity and accuracy",icon:(0,Ot.jsx)(eu,{className:"w-6 h-6 text-[#1c5bde]"})}],Bu=[{type:"residential",title:"Residential",subtitle:"Houses & Apartments",image:Mu,icon:(0,Ot.jsx)($c,{className:"w-6 h-6 text-white"})},{type:"commercial",title:"Commercial",subtitle:"Offices & Shops",image:Pu,icon:(0,Ot.jsx)(nu,{className:"w-6 h-6 text-white"})},{type:"land",title:"Land",subtitle:"Plots & Farmland",image:ku,icon:(0,Ot.jsx)(ru,{className:"w-6 h-6 text-white"})},{type:"luxury",title:"Luxury",subtitle:"Premium Properties",image:Cu,icon:(0,Ot.jsx)(iu,{className:"w-6 h-6 text-white"})},{type:"industrial",title:"Industrial",subtitle:"Warehouses & Factories",image:ju,icon:(0,Ot.jsx)(ou,{className:"w-6 h-6 text-white"})},{type:"hospitality",title:"Hotels & Resorts",subtitle:"Hospitality Properties",image:Iu,icon:(0,Ot.jsx)(au,{className:"w-6 h-6 text-white"})},{type:"institutional",title:"Institutional",subtitle:"Schools & Hospitals",image:Ou,icon:(0,Ot.jsx)(su,{className:"w-6 h-6 text-white"})},{type:"mixed-use",title:"Mixed Use",subtitle:"Multi-purpose Properties",image:Nu,icon:(0,Ot.jsx)(lu,{className:"w-6 h-6 text-white"})}],Vu=()=>{const e=ue(),[n,r]=(0,t.useState)("properties"),[i,o]=(0,t.useState)(!1),[a,s]=(0,t.useState)(null),[l,u]=(0,t.useState)(!1),[h,d]=(0,t.useState)("all"),p=(0,t.useRef)(null),f=(0,t.useRef)(null),[m,g]=(0,t.useState)({propertyType:"",priceRange:"",location:"",bedrooms:""}),y=(0,t.useRef)(null);(0,t.useEffect)((()=>{var e;if(!i)return;const t=e=>{if(!y.current)return;const t=y.current.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),n=t[0],r=t[t.length-1];e.shiftKey||document.activeElement!==r||(n.focus(),e.preventDefault()),e.shiftKey&&document.activeElement===n&&(r.focus(),e.preventDefault())},n=e=>{"Escape"===e.key&&_()};return document.addEventListener("keydown",n),null===(e=y.current)||void 0===e||e.addEventListener("keydown",t),()=>{var e;document.removeEventListener("keydown",n),null===(e=y.current)||void 0===e||e.removeEventListener("keydown",t)}}),[i]);const _=()=>{o(!1),s(null),document.body.style.overflow="unset"};return(0,t.useEffect)((()=>{if(!f.current&&p.current)return Au().accessToken="pk.eyJ1IjoibW10dWt1ciIsImEiOiJjbTEyZGk2dmwwbjZyMmtzMXFzb3V0cHRuIn0.pDgNHWd_o6u2NKVFib0EPQ",f.current=new(Au().Map)({container:p.current,style:"mapbox://styles/mapbox/light-v11",center:[7.491,9.082],zoom:12,pitch:45}),f.current.on("load",(()=>{f.current.addLayer({id:"3d-buildings",source:"composite","source-layer":"building",filter:["==","extrude","true"],type:"fill-extrusion",minzoom:12,paint:{"fill-extrusion-color":"#aaa","fill-extrusion-height":["get","height"],"fill-extrusion-opacity":.6}}),f.current.addLayer({id:"infrastructure-heat",type:"heatmap",source:{type:"geojson",data:{type:"FeatureCollection",features:Zc.categories.flatMap((e=>e.items.map((t=>({type:"Feature",properties:{intensity:t.rating,category:e.name},geometry:{type:"Point",coordinates:t.location}})))))}},paint:{"heatmap-weight":["get","intensity"],"heatmap-intensity":1,"heatmap-color":["interpolate",["linear"],["heatmap-density"],0,"rgba(33,102,172,0)",.2,"rgb(103,169,207)",.4,"rgb(209,229,240)",.6,"rgb(253,219,199)",.8,"rgb(239,138,98)",1,"rgb(178,24,43)"],"heatmap-radius":30}}),Zc.categories.forEach((e=>{e.items.forEach((t=>{const n=document.createElement("div");n.className="custom-marker",n.innerHTML=e.icon,n.style.fontSize="24px",n.style.cursor="pointer";const r=new(Au().Popup)({offset:25}).setHTML('\n              <div class="p-4 max-w-sm">\n                <h3 class="font-semibold text-lg">'.concat(t.name,'</h3>\n                <p class="text-sm text-gray-600">').concat(t.type,'</p>\n                <div class="flex items-center mt-2">\n                  <span class="text-yellow-500">\u2605</span>\n                  <span class="ml-1">').concat(t.rating,'</span>\n                </div>\n                <p class="text-sm mt-2">').concat(t.distance," from center</p>\n              </div>\n            "));new(Au().Marker)(n).setLngLat(t.location).setPopup(r).addTo(f.current)}))}))})),f.current.addControl(new(Au().NavigationControl)),f.current.addControl(new(Au().FullscreenControl)),()=>{var e;null===(e=f.current)||void 0===e||e.remove()}}),[]),(0,t.useEffect)((()=>{f.current&&Zc.categories.forEach((e=>{document.querySelectorAll('.custom-marker[data-category="'.concat(e.id,'"]')).forEach((t=>{t.style.display="all"===h||h===e.id?"block":"none"}))}))}),[h]),(0,Ot.jsxs)("div",{className:"min-h-screen",children:[(0,Ot.jsxs)("section",{className:"pt-40 pb-16 px-4 sm:px-6 lg:px-8 relative overflow-hidden",children:[(0,Ot.jsx)(zc.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:1},className:"absolute inset-0 bg-gradient-to-br from-[#1c5bde]/10 via-[#f8fafc] to-[#ff8533]/5 -z-10"}),(0,Ot.jsxs)("div",{className:"absolute inset-0 overflow-hidden -z-10",children:[(0,Ot.jsx)("div",{className:"absolute -top-40 -right-40 w-80 h-80 bg-[#1c5bde]/10 rounded-full blur-3xl"}),(0,Ot.jsx)("div",{className:"absolute -bottom-40 -left-40 w-80 h-80 bg-[#ff8533]/10 rounded-full blur-3xl"})]}),(0,Ot.jsx)("div",{className:"container mx-auto",children:(0,Ot.jsxs)("div",{className:"max-w-4xl mx-auto text-center",children:[(0,Ot.jsxs)(zc.h1,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{duration:.6},className:"text-4xl sm:text-5xl lg:text-6xl font-bold mb-6",children:["Find Your Perfect Property in"," ",(0,Ot.jsxs)("span",{className:"relative inline-block",children:[(0,Ot.jsx)("span",{className:"relative z-10 bg-gradient-to-r from-[#1c5bde] to-[#1c5bde]/80 bg-clip-text text-transparent",children:"Nigeria"}),(0,Ot.jsx)(zc.span,{className:"absolute -bottom-1 left-0 w-full h-1 bg-[#1c5bde]/20 rounded-full",initial:{width:0},animate:{width:"100%"},transition:{delay:.8,duration:.6}})]})]}),(0,Ot.jsx)(zc.p,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.3,duration:.6},className:"text-lg sm:text-xl text-neutral-600 mb-8",children:"Discover properties with comprehensive infrastructure insights and 360\xb0 virtual tours"}),(0,Ot.jsx)(zc.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.5,duration:.6},className:"max-w-2xl mx-auto",children:(0,Ot.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,Ot.jsxs)("div",{className:"group flex items-center gap-2 p-2 bg-white rounded-2xl shadow-lg hover:shadow-xl transition-all duration-300 border border-[#1c5bde]/10",children:[(0,Ot.jsxs)("div",{className:"flex-1 flex items-center gap-2 px-4",children:[(0,Ot.jsx)(Ct,{className:"text-neutral-400 h-5 w-5 group-hover:text-[#1c5bde] transition-colors"}),(0,Ot.jsx)("input",{type:"text",placeholder:"Search by location, property type...",className:"w-full py-3 focus:outline-none text-neutral-700 placeholder:text-neutral-400","aria-label":"Search properties"})]}),(0,Ot.jsxs)("button",{onClick:()=>u(!l),className:"px-4 py-2 text-[#1c5bde] hover:bg-[#1c5bde]/10 rounded-xl transition-colors flex items-center gap-2","aria-expanded":l,"aria-controls":"filter-panel",children:[(0,Ot.jsx)("span",{children:"Filters"}),(0,Ot.jsx)(cu,{className:"h-4 w-4 transition-transform duration-300 ".concat(l?"rotate-180":"")})]}),(0,Ot.jsx)("button",{className:"bg-[#1c5bde] hover:bg-[#1c5bde]/90 text-white px-6 py-3 rounded-xl font-semibold transition-all duration-300 hover:shadow-lg hover:shadow-[#1c5bde]/25 active:scale-95","aria-label":"Search properties",children:"Search"})]}),(0,Ot.jsx)(Yt,{children:l&&(0,Ot.jsxs)(zc.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"bg-white rounded-2xl shadow-lg border border-[#1c5bde]/10 p-6",children:[(0,Ot.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,Ot.jsxs)("div",{className:"space-y-2",children:[(0,Ot.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Property Type"}),(0,Ot.jsxs)("select",{value:m.propertyType,onChange:e=>g(c(c({},m),{},{propertyType:e.target.value})),className:"w-full p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-[#1c5bde]/20 focus:border-[#1c5bde] bg-white hover:bg-[#f8fafc] transition-colors",children:[(0,Ot.jsx)("option",{value:"",children:"All Types"}),Bu.map((e=>(0,Ot.jsx)("option",{value:e.type,children:e.title},e.type)))]})]}),(0,Ot.jsxs)("div",{className:"space-y-2",children:[(0,Ot.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Price Range"}),(0,Ot.jsxs)("select",{value:m.priceRange,onChange:e=>g(c(c({},m),{},{priceRange:e.target.value})),className:"w-full p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-[#1c5bde]/20 focus:border-[#1c5bde] bg-white hover:bg-[#f8fafc] transition-colors",children:[(0,Ot.jsx)("option",{value:"",children:"Any Price"}),["\u20a61M - \u20a65M","\u20a65M - \u20a610M","\u20a610M - \u20a620M","\u20a620M - \u20a650M","\u20a650M+"].map((e=>(0,Ot.jsx)("option",{value:e,children:e},e)))]})]}),(0,Ot.jsxs)("div",{className:"space-y-2",children:[(0,Ot.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Location"}),(0,Ot.jsxs)("select",{value:m.location,onChange:e=>g(c(c({},m),{},{location:e.target.value})),className:"w-full p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-[#1c5bde]/20 focus:border-[#1c5bde] bg-white hover:bg-[#f8fafc] transition-colors",children:[(0,Ot.jsx)("option",{value:"",children:"Any Location"}),["Lagos","Abuja","Port Harcourt","Ibadan","Kano"].map((e=>(0,Ot.jsx)("option",{value:e,children:e},e)))]})]}),(0,Ot.jsxs)("div",{className:"space-y-2",children:[(0,Ot.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Bedrooms"}),(0,Ot.jsxs)("select",{value:m.bedrooms,onChange:e=>g(c(c({},m),{},{bedrooms:e.target.value})),className:"w-full p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-[#1c5bde]/20 focus:border-[#1c5bde] bg-white hover:bg-[#f8fafc] transition-colors",children:[(0,Ot.jsx)("option",{value:"",children:"Any Bedrooms"}),["1","2","3","4","5+"].map((e=>(0,Ot.jsx)("option",{value:e,children:e},e)))]})]})]}),(0,Ot.jsxs)("div",{className:"flex justify-end gap-3 pt-4 mt-4 border-t border-[#1c5bde]/10",children:[(0,Ot.jsx)("button",{onClick:()=>g({propertyType:"",priceRange:"",location:"",bedrooms:""}),className:"px-4 py-2 text-gray-600 hover:text-[#1c5bde] transition-colors",children:"Clear Filters"}),(0,Ot.jsx)("button",{onClick:()=>u(!1),className:"px-6 py-2 bg-[#1c5bde] text-white rounded-lg hover:bg-[#1c5bde]/90 transition-all duration-300 hover:shadow-md active:scale-95",children:"Apply Filters"})]})]})})]})})]})})]}),(0,Ot.jsx)("section",{className:"py-16 bg-[#f8fafc]",children:(0,Ot.jsxs)("div",{className:"container mx-auto px-4",children:[(0,Ot.jsxs)(zc.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{duration:.5},className:"flex justify-center gap-4 mb-8",children:[(0,Ot.jsx)("button",{onClick:()=>r("properties"),className:"px-4 sm:px-8 py-3 rounded-full font-semibold transition-all duration-300 ".concat("properties"===n?"bg-[#1c5bde] text-white shadow-lg shadow-[#1c5bde]/20 scale-105":"bg-white text-[#1c5bde] border border-[#1c5bde] hover:bg-[#1c5bde]/5"),children:(0,Ot.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Ot.jsx)(lu,{className:"w-5 h-5"}),(0,Ot.jsx)("span",{className:"text-sm sm:text-base",children:"Browse Properties"})]})}),(0,Ot.jsx)("button",{onClick:()=>r("infrastructure"),className:"px-4 sm:px-8 py-3 rounded-full font-semibold transition-all duration-300 ".concat("infrastructure"===n?"bg-[#1c5bde] text-white shadow-lg shadow-[#1c5bde]/20 scale-105":"bg-white text-[#1c5bde] border border-[#1c5bde] hover:bg-[#1c5bde]/5"),children:(0,Ot.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Ot.jsx)(uu,{className:"w-5 h-5"}),(0,Ot.jsx)("span",{className:"text-sm sm:text-base",children:"View Properties Map"})]})})]}),(0,Ot.jsx)(zc.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},className:"bg-white rounded-xl shadow-sm overflow-hidden border border-[#1c5bde]/10",children:"properties"===n?(0,Ot.jsxs)("div",{className:"p-6",children:[(0,Ot.jsx)("div",{className:"flex justify-between items-center mb-6",children:(0,Ot.jsx)(zc.h2,{initial:{x:-20,opacity:0},animate:{x:0,opacity:1},className:"text-2xl font-bold bg-gradient-to-r from-[#1c5bde] to-[#1c5bde]/80 bg-clip-text text-transparent",children:"Featured Properties"})}),(0,Ot.jsxs)("div",{className:"space-y-8",children:[(0,Ot.jsx)(zc.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.3},className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Hc.slice(0,3).map((e=>(0,Ot.jsxs)("div",{onClick:()=>(e=>{s(e),o(!0),document.body.style.overflow="hidden"})(e),className:"group relative bg-white rounded-xl overflow-hidden hover:shadow-lg transition-all duration-300 border border-[#1c5bde]/10 cursor-pointer",children:[(0,Ot.jsxs)("div",{className:"relative h-48 overflow-hidden",children:[(0,Ot.jsx)("img",{src:e.image,alt:e.title,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-500"}),(0,Ot.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/50 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]}),(0,Ot.jsxs)("div",{className:"p-4",children:[(0,Ot.jsx)("div",{className:"flex justify-between items-start mb-2",children:(0,Ot.jsx)("h3",{className:"font-semibold text-lg text-neutral-800 group-hover:text-[#1c5bde] transition-colors",children:e.title})}),(0,Ot.jsx)("p",{className:"text-[#1c5bde] font-bold mb-2",children:e.price}),(0,Ot.jsxs)("p",{className:"text-neutral-600 flex items-center gap-1 mb-3",children:[(0,Ot.jsx)(tu,{className:"h-4 w-4"}),e.location]}),(0,Ot.jsxs)("div",{className:"flex items-center gap-4 text-neutral-600 text-sm",children:[e.beds&&(0,Ot.jsxs)("div",{className:"flex items-center gap-1 bg-[#f8fafc] px-2 py-1 rounded-md",children:[(0,Ot.jsx)(hu,{className:"h-4 w-4 text-[#1c5bde]"}),(0,Ot.jsxs)("span",{children:[e.beds," Beds"]})]}),e.baths&&(0,Ot.jsxs)("div",{className:"flex items-center gap-1 bg-[#f8fafc] px-2 py-1 rounded-md",children:[(0,Ot.jsx)(du,{className:"h-4 w-4 text-[#1c5bde]"}),(0,Ot.jsxs)("span",{children:[e.baths," Baths"]})]}),(0,Ot.jsxs)("div",{className:"flex items-center gap-1 bg-[#f8fafc] px-2 py-1 rounded-md",children:[(0,Ot.jsx)(pu,{className:"h-4 w-4 text-[#1c5bde]"}),(0,Ot.jsx)("span",{children:e.area})]})]})]}),(0,Ot.jsxs)("div",{className:"absolute top-4 right-4 flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[(0,Ot.jsx)("button",{className:"p-2 bg-white/90 backdrop-blur-sm rounded-full hover:bg-[#1c5bde] hover:text-white transition-colors",children:(0,Ot.jsx)(Jc,{className:"h-4 w-4"})}),(0,Ot.jsx)("button",{className:"p-2 bg-white/90 backdrop-blur-sm rounded-full hover:bg-[#1c5bde] hover:text-white transition-colors",children:(0,Ot.jsx)(fu,{className:"h-4 w-4"})})]})]},e.id)))}),(0,Ot.jsx)(zc.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.4},className:"flex justify-center",children:(0,Ot.jsxs)(ut,{to:"/properties",className:"group inline-flex items-center gap-2 px-6 py-3 bg-[#1c5bde] text-white rounded-lg hover:bg-[#1c5bde]/90 transition-all duration-300 hover:shadow-lg hover:shadow-[#1c5bde]/20 active:scale-95",children:[(0,Ot.jsx)("span",{children:"View All Properties"}),(0,Ot.jsx)(mu,{className:"w-4 h-4 group-hover:translate-x-1 transition-transform"})]})})]})]}):(0,Ot.jsx)("div",{className:"w-full p-6",children:(0,Ot.jsxs)(xu,{className:"h-full",children:[(0,Ot.jsx)(bu,{className:"p-4 border-b border-[#1c5bde]/10",children:(0,Ot.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Ot.jsxs)(wu,{className:"flex items-center gap-2 text-[#1c5bde]",children:[(0,Ot.jsx)(uu,{size:20}),"Infrastructure Map"]}),(0,Ot.jsxs)(zc.div,{className:"flex gap-2",initial:{opacity:0},animate:{opacity:1},transition:{delay:.4},children:[(0,Ot.jsx)("button",{onClick:()=>d("all"),className:"px-3 py-1 rounded-md text-sm font-medium transition-all duration-300 ".concat("all"===h?"bg-[#1c5bde] text-white shadow-sm":"bg-[#f8fafc] text-neutral-600 hover:bg-[#1c5bde]/10 hover:text-[#1c5bde]"),children:"All Layers"}),(0,Ot.jsx)("button",{className:"p-2 rounded-md hover:bg-[#f8fafc] transition-colors text-[#1c5bde]",title:"Toggle fullscreen",children:(0,Ot.jsx)(gu,{size:18})})]})]})}),(0,Ot.jsx)(Su,{className:"p-0 relative h-[calc(100%-70px)]",children:(0,Ot.jsx)("div",{ref:p,className:"h-[600px] w-full rounded-b-xl overflow-hidden bg-[#f8fafc]"})})]})})})]})}),i&&a&&(0,Ot.jsx)("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 overflow-y-auto",onClick:e=>{e.target===e.currentTarget&&_()},children:(0,Ot.jsx)("div",{className:"min-h-screen px-4 py-12 flex items-center justify-center",children:(0,Ot.jsxs)(zc.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},transition:{duration:.2},ref:y,className:"relative bg-white rounded-2xl shadow-xl w-[700px] max-w-full",role:"dialog","aria-modal":"true","aria-labelledby":"modal-title",children:[(0,Ot.jsxs)("div",{className:"sticky top-0 z-10 bg-white/95 backdrop-blur-sm p-4 border-b border-[#1c5bde]/10 flex justify-between items-center rounded-t-2xl",children:[(0,Ot.jsx)("h3",{id:"modal-title",className:"font-semibold text-lg text-neutral-800",children:"Property Details"}),(0,Ot.jsx)("button",{onClick:_,className:"h-8 w-8 bg-[#f8fafc] hover:bg-[#1c5bde]/10 flex justify-center items-center rounded-full transition-colors","aria-label":"Close modal",children:(0,Ot.jsx)(jt,{className:"h-5 w-5 text-neutral-600"})})]}),(0,Ot.jsxs)("div",{className:"p-4",children:[(0,Ot.jsxs)("div",{className:"relative rounded-xl overflow-hidden mb-4",children:[(0,Ot.jsx)("img",{src:a.image,alt:a.title,className:"w-full h-64 object-cover hover:scale-105 transition-transform duration-500"}),(0,Ot.jsxs)("div",{className:"absolute top-4 right-4 flex gap-2",children:[(0,Ot.jsx)("button",{className:"p-2 bg-white/90 backdrop-blur-sm rounded-full hover:bg-[#1c5bde] hover:text-white transition-colors shadow-sm",children:(0,Ot.jsx)(Jc,{className:"h-4 w-4"})}),(0,Ot.jsx)("button",{className:"p-2 bg-white/90 backdrop-blur-sm rounded-full hover:bg-[#1c5bde] hover:text-white transition-colors shadow-sm",children:(0,Ot.jsx)(fu,{className:"h-4 w-4"})})]})]}),(0,Ot.jsx)("h2",{className:"text-2xl font-bold mb-2 text-neutral-800",children:a.title}),(0,Ot.jsx)("p",{className:"text-[#1c5bde] text-xl font-bold mb-4",children:a.price}),(0,Ot.jsxs)("div",{className:"flex items-center gap-6 mb-6",children:[a.beds&&(0,Ot.jsxs)("div",{className:"flex items-center gap-2 text-neutral-700",children:[(0,Ot.jsx)("div",{className:"p-2 bg-[#1c5bde]/5 rounded-lg",children:(0,Ot.jsx)(hu,{className:"h-5 w-5 text-[#1c5bde]"})}),(0,Ot.jsxs)("span",{children:[a.beds," Bedrooms"]})]}),a.baths&&(0,Ot.jsxs)("div",{className:"flex items-center gap-2 text-neutral-700",children:[(0,Ot.jsx)("div",{className:"p-2 bg-[#1c5bde]/5 rounded-lg",children:(0,Ot.jsx)(du,{className:"h-5 w-5 text-[#1c5bde]"})}),(0,Ot.jsxs)("span",{children:[a.baths," Bathrooms"]})]}),(0,Ot.jsxs)("div",{className:"flex items-center gap-2 text-neutral-700",children:[(0,Ot.jsx)("div",{className:"p-2 bg-[#1c5bde]/5 rounded-lg",children:(0,Ot.jsx)(pu,{className:"h-5 w-5 text-[#1c5bde]"})}),(0,Ot.jsx)("span",{children:a.area})]})]}),(0,Ot.jsxs)("div",{className:"mb-6",children:[(0,Ot.jsx)("h3",{className:"font-semibold mb-2 text-neutral-800",children:"Location"}),(0,Ot.jsxs)("p",{className:"flex items-center gap-2 text-neutral-600 mb-4",children:[(0,Ot.jsx)(tu,{className:"h-5 w-5"}),a.location]}),(0,Ot.jsxs)("div",{className:"rounded-lg h-[200px] relative overflow-hidden shadow-sm border",children:[(0,Ot.jsx)("img",{src:"https://api.mapbox.com/styles/v1/mapbox/streets-v11/static/pin-s+ff0000(".concat(a.coordinates[0],",").concat(a.coordinates[1],")/").concat(a.coordinates[0],",").concat(a.coordinates[1],",14,0,0/600x400@2x?access_token=pk.eyJ1IjoibW10dWt1ciIsImEiOiJjbTEyZGk2dmwwbjZyMmtzMXFzb3V0cHRuIn0.pDgNHWd_o6u2NKVFib0EPQ"),alt:"Map showing ".concat(a.location),className:"absolute inset-0 w-full h-full object-cover"}),(0,Ot.jsx)("div",{className:"absolute bottom-2 right-2",children:(0,Ot.jsxs)(ut,{to:"/infrastructure-analysis?lat=".concat(a.coordinates[1],"&lng=").concat(a.coordinates[0]),onClick:_,className:"bg-white/90 hover:bg-white text-[#1c5bde] px-3 py-1.5 rounded-lg text-sm font-medium backdrop-blur-sm transition-colors shadow-sm flex items-center gap-1.5",children:[(0,Ot.jsx)(tu,{className:"h-4 w-4"}),"View Infrastructure"]})})]})]}),a.description&&(0,Ot.jsxs)("div",{className:"mb-6",children:[(0,Ot.jsx)("h3",{className:"font-semibold mb-2 text-neutral-800",children:"Description"}),(0,Ot.jsx)("p",{className:"text-neutral-600",children:a.description})]}),(0,Ot.jsxs)("div",{className:"flex gap-4",children:[(0,Ot.jsx)("button",{onClick:()=>{return t=a.id,_(),void e("/properties/".concat(t));var t},className:"flex-1 bg-[#1c5bde] hover:bg-[#1c5bde]/90 text-white py-2 rounded-lg text-center font-semibold transition-all duration-300 hover:shadow-lg hover:shadow-[#1c5bde]/20 active:scale-95",children:"View Property"}),(0,Ot.jsx)("button",{onClick:_,className:"flex-1 bg-[#f8fafc] hover:bg-[#1c5bde]/5 text-neutral-700 py-2 rounded-lg text-center font-semibold transition-colors",children:"Close"})]})]})]})})}),(0,Ot.jsx)("section",{className:"py-16 bg-gradient-to-br from-[#f8fafc] via-white to-[#1c5bde]/5",children:(0,Ot.jsxs)("div",{className:"container mx-auto px-4",children:[(0,Ot.jsxs)(zc.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},className:"max-w-4xl mx-auto text-center mb-12",children:[(0,Ot.jsx)("h2",{className:"text-3xl font-bold mb-4 bg-gradient-to-r from-[#1c5bde] to-[#1c5bde]/80 bg-clip-text text-transparent",children:"Explore Infrastructure Around Properties"}),(0,Ot.jsx)("p",{className:"text-neutral-600 text-lg",children:"Make informed decisions by understanding the surrounding infrastructure"})]}),(0,Ot.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Array.isArray(Zc)&&Zc.map(((e,n)=>(0,Ot.jsx)(zc.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1*n},className:"bg-white rounded-xl p-6 shadow-sm hover:shadow-md transition-all duration-300 border border-[#1c5bde]/10 group hover:border-[#1c5bde]/20",children:(0,Ot.jsxs)("div",{className:"flex items-start gap-4",children:[(0,Ot.jsx)("div",{className:"bg-[#1c5bde]/5 p-3 rounded-lg group-hover:bg-[#1c5bde]/10 transition-colors",children:t.cloneElement(e.icon,{className:"w-6 h-6 text-[#1c5bde]"})}),(0,Ot.jsxs)("div",{children:[(0,Ot.jsx)("h3",{className:"font-semibold text-lg mb-2 text-neutral-800",children:e.title}),(0,Ot.jsx)("p",{className:"text-neutral-600",children:e.description})]})]})},n)))})]})}),(0,Ot.jsx)("section",{className:"py-16 bg-gradient-to-br from-[#1c5bde]/5 via-white to-[#ff8533]/5",children:(0,Ot.jsxs)("div",{className:"container mx-auto px-4",children:[(0,Ot.jsxs)(zc.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},className:"max-w-4xl mx-auto text-center mb-12",children:[(0,Ot.jsx)("h2",{className:"text-3xl font-bold mb-4 bg-gradient-to-r from-[#1c5bde] to-[#1c5bde]/80 bg-clip-text text-transparent",children:"Why Choose FastFind"}),(0,Ot.jsx)("p",{className:"text-neutral-600 text-lg",children:"Experience the future of property search with our innovative features"})]}),(0,Ot.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:Fu.map(((e,n)=>(0,Ot.jsx)(zc.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1*n},className:"bg-white rounded-xl p-6 shadow-sm hover:shadow-md transition-all duration-300 border border-[#1c5bde]/10 group hover:border-[#1c5bde]/20",children:(0,Ot.jsxs)("div",{className:"flex flex-col items-center text-center",children:[(0,Ot.jsx)("div",{className:"bg-[#1c5bde]/5 p-4 rounded-full mb-4 group-hover:bg-[#1c5bde]/10 transition-colors",children:t.cloneElement(e.icon,{className:"w-6 h-6 text-[#1c5bde]"})}),(0,Ot.jsx)("h3",{className:"font-semibold text-lg mb-2 text-neutral-800",children:e.title}),(0,Ot.jsx)("p",{className:"text-neutral-600",children:e.description})]})},n)))})]})}),(0,Ot.jsx)("section",{className:"py-16 bg-gradient-to-br from-[#f8fafc] via-white to-[#1c5bde]/5",children:(0,Ot.jsxs)("div",{className:"container mx-auto px-4",children:[(0,Ot.jsxs)(zc.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},className:"max-w-4xl mx-auto text-center mb-12",children:[(0,Ot.jsx)("h2",{className:"text-3xl font-bold mb-4 bg-gradient-to-r from-[#1c5bde] to-[#1c5bde]/80 bg-clip-text text-transparent",children:"How It Works"}),(0,Ot.jsx)("p",{className:"text-neutral-600 text-lg",children:"Find your perfect property in three simple steps"})]}),(0,Ot.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:Ru.map(((e,t)=>(0,Ot.jsxs)(zc.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1*t},className:"relative group",children:[(0,Ot.jsx)("div",{className:"bg-white rounded-xl p-6 shadow-sm hover:shadow-md transition-all duration-300 border border-[#1c5bde]/10 hover:border-[#1c5bde]/20",children:(0,Ot.jsxs)("div",{className:"flex flex-col items-center text-center",children:[(0,Ot.jsx)("div",{className:"bg-[#1c5bde]/10 w-12 h-12 rounded-full flex items-center justify-center mb-4 group-hover:bg-[#1c5bde]/20 transition-colors",children:(0,Ot.jsx)("span",{className:"text-[#1c5bde] font-bold text-xl",children:t+1})}),(0,Ot.jsx)("h3",{className:"font-semibold text-lg mb-2 text-neutral-800",children:e.title}),(0,Ot.jsx)("p",{className:"text-neutral-600",children:e.description})]})}),t<Ru.length-1&&(0,Ot.jsx)("div",{className:"hidden md:block absolute top-1/2 right-0 transform translate-x-1/2 -translate-y-1/2",children:(0,Ot.jsx)(mu,{className:"text-[#1c5bde] w-6 h-6 opacity-50 group-hover:opacity-100 transition-opacity"})})]},t)))})]})}),(0,Ot.jsx)("section",{className:"py-16 bg-gradient-to-br from-[#1c5bde]/5 via-white to-[#ff8533]/5",children:(0,Ot.jsxs)("div",{className:"container mx-auto px-4",children:[(0,Ot.jsxs)(zc.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},className:"max-w-4xl mx-auto text-center mb-12",children:[(0,Ot.jsx)("h2",{className:"text-3xl font-bold mb-4 bg-gradient-to-r from-[#1c5bde] to-[#1c5bde]/80 bg-clip-text text-transparent",children:"Browse by Property Type"}),(0,Ot.jsx)("p",{className:"text-neutral-600 text-lg",children:"Explore properties across different categories"})]}),(0,Ot.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:Bu.map(((e,n)=>(0,Ot.jsx)("div",{className:"relative group cursor-pointer",children:(0,Ot.jsxs)("div",{className:"relative h-[200px] rounded-xl overflow-hidden",children:[(0,Ot.jsx)("img",{src:e.image,alt:e.title,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"}),(0,Ot.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-black/20 to-transparent group-hover:from-[#1c5bde]/80 transition-colors duration-300"}),(0,Ot.jsxs)("div",{className:"absolute inset-0 p-4 flex flex-col items-center justify-center text-center gap-4",children:[(0,Ot.jsx)("div",{className:"bg-white/10 backdrop-blur-sm w-16 h-16 rounded-full flex items-center justify-center group-hover:bg-white/20 transition-colors",children:t.cloneElement(e.icon,{className:"w-8 h-8 text-white"})}),(0,Ot.jsxs)("div",{children:[(0,Ot.jsx)("h3",{className:"text-white font-semibold text-lg mb-1",children:e.title}),(0,Ot.jsx)("p",{className:"text-white/90 text-sm",children:e.subtitle})]})]})]})},e.type)))})]})}),(0,Ot.jsx)("section",{className:"py-16 bg-gradient-to-br from-[#1c5bde]/5 via-white to-[#ff8533]/5",children:(0,Ot.jsxs)("div",{className:"container mx-auto px-4",children:[(0,Ot.jsxs)(zc.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},className:"max-w-4xl mx-auto text-center mb-12",children:[(0,Ot.jsx)("h2",{className:"text-3xl font-bold mb-4 bg-gradient-to-r from-[#1c5bde] to-[#1c5bde]/80 bg-clip-text text-transparent",children:"What Our Users Say"}),(0,Ot.jsx)("p",{className:"text-neutral-600 text-lg",children:"Discover why thousands of people trust FastFind for their property search"})]}),(0,Ot.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:zu.map(((e,t)=>(0,Ot.jsx)(zc.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1*t},className:"bg-white rounded-xl p-6 shadow-sm hover:shadow-md transition-all duration-300 border border-[#1c5bde]/10",children:(0,Ot.jsxs)("div",{className:"flex flex-col h-full",children:[(0,Ot.jsx)("div",{className:"mb-4",children:(0,Ot.jsx)(yu,{className:"w-8 h-8 text-[#1c5bde]/20"})}),(0,Ot.jsx)("p",{className:"text-neutral-600 mb-6 flex-1",children:e.comment}),(0,Ot.jsxs)("div",{className:"flex items-center gap-4",children:[(0,Ot.jsx)("img",{src:e.image,alt:e.name,className:"w-12 h-12 rounded-full object-cover border-2 border-[#1c5bde]/10"}),(0,Ot.jsxs)("div",{children:[(0,Ot.jsx)("h3",{className:"font-semibold text-neutral-800",children:e.name}),(0,Ot.jsx)("p",{className:"text-sm text-neutral-600",children:e.role})]})]})]})},t)))})]})}),(0,Ot.jsx)("section",{className:"py-16 bg-gradient-to-br from-[#f8fafc] via-white to-[#1c5bde]/5 overflow-hidden",children:(0,Ot.jsx)("div",{className:"container mx-auto px-4",children:(0,Ot.jsxs)("div",{className:"flex flex-col lg:flex-row items-center gap-12",children:[(0,Ot.jsxs)(zc.div,{initial:{x:-20,opacity:0},animate:{x:0,opacity:1},className:"flex-1 text-center lg:text-left",children:[(0,Ot.jsx)("h2",{className:"text-3xl font-bold mb-6 bg-gradient-to-r from-[#1c5bde] to-[#1c5bde]/80 bg-clip-text text-transparent",children:"Take FastFind With You"}),(0,Ot.jsx)("p",{className:"text-neutral-600 text-lg mb-8",children:"Download our mobile app to search for properties on the go and receive instant notifications"}),(0,Ot.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6 mb-8",children:Lu.map(((e,n)=>(0,Ot.jsxs)(zc.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1*n},className:"flex items-start gap-4 p-4 rounded-xl bg-white border border-[#1c5bde]/10 hover:border-[#1c5bde]/20 hover:shadow-sm transition-all",children:[(0,Ot.jsx)("div",{className:"bg-[#1c5bde]/5 p-2 rounded-lg",children:t.cloneElement(e.icon,{className:"w-5 h-5 text-[#1c5bde]"})}),(0,Ot.jsxs)("div",{className:"flex-1",children:[(0,Ot.jsx)("h3",{className:"font-semibold text-neutral-800 mb-1",children:e.title}),(0,Ot.jsx)("p",{className:"text-sm text-neutral-600",children:e.description})]})]},n)))}),(0,Ot.jsxs)("div",{className:"flex flex-wrap justify-center lg:justify-start gap-4",children:[(0,Ot.jsxs)("button",{className:"flex items-center gap-2 px-6 py-3 bg-black text-white rounded-xl hover:bg-black/90 transition-all",children:[(0,Ot.jsx)(_u,{className:"w-6 h-6"}),(0,Ot.jsxs)("div",{className:"text-left",children:[(0,Ot.jsx)("div",{className:"text-xs",children:"Download on the"}),(0,Ot.jsx)("div",{className:"text-sm font-semibold",children:"App Store"})]})]}),(0,Ot.jsxs)("button",{className:"flex items-center gap-2 px-6 py-3 bg-black text-white rounded-xl hover:bg-black/90 transition-all",children:[(0,Ot.jsx)(vu,{className:"w-6 h-6"}),(0,Ot.jsxs)("div",{className:"text-left",children:[(0,Ot.jsx)("div",{className:"text-xs",children:"Get it on"}),(0,Ot.jsx)("div",{className:"text-sm font-semibold",children:"Google Play"})]})]})]})]}),(0,Ot.jsx)(zc.div,{initial:{x:20,opacity:0},animate:{x:0,opacity:1},className:"flex-1 relative",children:(0,Ot.jsxs)("div",{className:"relative w-full max-w-[400px] mx-auto",children:[(0,Ot.jsx)("img",{src:Du,alt:"FastFind Mobile App Interface",className:"w-full h-auto rounded-3xl shadow-2xl"}),(0,Ot.jsx)("div",{className:"absolute -top-4 -right-4 w-24 h-24 bg-[#1c5bde]/10 rounded-full blur-xl"}),(0,Ot.jsx)("div",{className:"absolute -bottom-4 -left-4 w-32 h-32 bg-[#ff8533]/10 rounded-full blur-xl"})]})})]})})}),(0,Ot.jsx)("section",{className:"py-16 bg-gradient-to-br from-[#1c5bde] to-[#1c5bde]/90 text-white",children:(0,Ot.jsx)("div",{className:"container mx-auto px-4",children:(0,Ot.jsxs)(zc.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},className:"max-w-4xl mx-auto text-center",children:[(0,Ot.jsx)("h2",{className:"text-3xl font-bold mb-4",children:"Stay Updated"}),(0,Ot.jsx)("p",{className:"text-white/90 text-lg mb-8",children:"Subscribe to our newsletter for the latest property insights and market updates"}),(0,Ot.jsxs)("form",{className:"flex flex-col sm:flex-row gap-4 max-w-md mx-auto",children:[(0,Ot.jsx)("input",{type:"email",placeholder:"Enter your email",className:"flex-1 px-4 py-3 rounded-xl bg-white/10 border border-white/20 placeholder:text-white/60 focus:outline-none focus:border-white/40 backdrop-blur-sm"}),(0,Ot.jsx)("button",{type:"submit",className:"px-6 py-3 bg-white text-[#1c5bde] rounded-xl font-semibold hover:bg-white/90 transition-all duration-300 hover:shadow-lg hover:shadow-black/10 active:scale-95",children:"Subscribe"})]})]})})})]})},Uu=e=>{let{value:n,onValueChange:r,children:i}=e;const[o,a]=(0,t.useState)(!1),s=e=>{r(e),a(!1)};return(0,Ot.jsx)("div",{className:"relative w-full",children:t.Children.map(i,(e=>e.type===Gu?t.cloneElement(e,{isOpen:o,onClick:()=>a(!o)}):e.type===Zu&&o?t.cloneElement(e,{onSelect:s}):null))})},Gu=e=>{let{children:t,isOpen:n,onClick:r}=e;return(0,Ot.jsx)("button",{className:"w-full border border-gray-300 rounded-lg py-2 px-3 text-left ".concat(n?"ring-2 ring-blue-600":""),onClick:r,children:t})},Hu=e=>{let{value:t,placeholder:n="Select..."}=e;return(0,Ot.jsx)("span",{children:t||n})},Zu=e=>{let{children:n,onSelect:r}=e;return(0,Ot.jsx)("div",{className:"absolute mt-1 w-full bg-white border border-gray-300 rounded-lg shadow-lg z-10",children:t.Children.map(n,(e=>t.cloneElement(e,{onSelect:r})))})},qu=e=>{let{value:t,children:n,onSelect:r}=e;return(0,Ot.jsx)("div",{className:"px-4 py-2 hover:bg-blue-100 cursor-pointer",onClick:()=>r(t),children:n})},Wu=["children","variant"],Xu=e=>{let{children:t,variant:n="primary"}=e,r=i(e,Wu);return(0,Ot.jsx)("button",c(c({className:"".concat("px-4 py-2 rounded-lg font-medium transition-colors"," ").concat({primary:"bg-blue-600 text-white hover:bg-blue-700",outline:"border border-blue-600 text-blue-600 hover:bg-blue-100"}[n])},r),{},{children:t}))},Yu=Et("Hospital",[["path",{d:"M12 6v4",key:"16clxf"}],["path",{d:"M14 14h-4",key:"esezmu"}],["path",{d:"M14 18h-4",key:"16mqa2"}],["path",{d:"M14 8h-4",key:"z8ypaz"}],["path",{d:"M18 12h2a2 2 0 0 1 2 2v6a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-9a2 2 0 0 1 2-2h2",key:"b1k337"}],["path",{d:"M18 22V4a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v18",key:"16g51d"}]]),Ku=Et("School",[["path",{d:"M14 22v-4a2 2 0 1 0-4 0v4",key:"hhkicm"}],["path",{d:"m18 10 3.447 1.724a1 1 0 0 1 .553.894V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-7.382a1 1 0 0 1 .553-.894L6 10",key:"1xqip1"}],["path",{d:"M18 5v17",key:"1sw6gf"}],["path",{d:"m4 6 7.106-3.553a2 2 0 0 1 1.788 0L20 6",key:"9d2mlk"}],["path",{d:"M6 5v17",key:"1xfsm0"}],["circle",{cx:"12",cy:"9",r:"2",key:"1092wv"}]]),Ju=Et("Car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]]),Qu=Et("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),$u=Et("Cpu",[["rect",{width:"16",height:"16",x:"4",y:"4",rx:"2",key:"14l7u7"}],["rect",{width:"6",height:"6",x:"9",y:"9",rx:"1",key:"5aljv4"}],["path",{d:"M15 2v2",key:"13l42r"}],["path",{d:"M15 20v2",key:"15mkzm"}],["path",{d:"M2 15h2",key:"1gxd5l"}],["path",{d:"M2 9h2",key:"1bbxkp"}],["path",{d:"M20 15h2",key:"19e6y8"}],["path",{d:"M20 9h2",key:"19tzq7"}],["path",{d:"M9 2v2",key:"165o2o"}],["path",{d:"M9 20v2",key:"i2bqo8"}]]),eh=Et("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]),th=Et("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),nh=Et("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);Au().accessToken="pk.eyJ1IjoibW10dWt1ciIsImEiOiJjbTEyZGk2dmwwbjZyMmtzMXFzb3V0cHRuIn0.pDgNHWd_o6u2NKVFib0EPQ";const rh=[{state:"Federal Capital Territory",region:"North Central",cities:[{name:"Abuja",coordinates:[7.491,9.082],zone:"Central",highlights:["Federal Capital","Administrative Hub"],infrastructureScore:95},{name:"Gwagwalada",coordinates:[7.079,8.947],zone:"Satellite",highlights:["Education Hub","Growing Township"],infrastructureScore:82},{name:"Kuje",coordinates:[7.227,8.879],zone:"Satellite",highlights:["Agricultural Zone"],infrastructureScore:78},{name:"Bwari",coordinates:[7.381,9.287],zone:"Satellite",highlights:["Educational District"],infrastructureScore:80}]},{state:"Gombe",region:"North East",cities:[{name:"Gombe",coordinates:[11.167,10.283],zone:"Central",highlights:["State Capital","Commercial Hub"],infrastructureScore:85},{name:"Billiri",coordinates:[11.217,9.867],zone:"South",highlights:["Educational Center"],infrastructureScore:75},{name:"Kaltungo",coordinates:[11.309,9.82],zone:"South",highlights:["Cultural Heritage"],infrastructureScore:72},{name:"Akko",coordinates:[11.167,10.283],zone:"Central",highlights:["Agricultural Hub"],infrastructureScore:70},{name:"Dukku",coordinates:[10.823,10.772],zone:"North",highlights:["Tourism"],infrastructureScore:68},{name:"Yamaltu/Deba",coordinates:[11.167,10.283],zone:"East",highlights:["Industrial Zone"],infrastructureScore:73},{name:"Nafada",coordinates:[11.095,11.096],zone:"North",highlights:["Historical Site"],infrastructureScore:65},{name:"Funakaye",coordinates:[11.237,10.95],zone:"North East",highlights:["Agricultural Center"],infrastructureScore:67}]},{state:"Lagos",region:"South West",cities:[{name:"Ikeja",coordinates:[3.342,6.601],zone:"Mainland",highlights:["State Capital","Business District"],infrastructureScore:92},{name:"Victoria Island",coordinates:[3.426,6.428],zone:"Island",highlights:["Financial Hub","Luxury District"],infrastructureScore:95},{name:"Lekki",coordinates:[3.517,6.458],zone:"Island",highlights:["Tech Hub","New Development"],infrastructureScore:90},{name:"Surulere",coordinates:[3.35,6.5],zone:"Mainland",highlights:["Entertainment District"],infrastructureScore:85}]},{state:"Rivers",region:"South South",cities:[{name:"Port Harcourt",coordinates:[7.033,4.817],zone:"Central",highlights:["State Capital","Oil & Gas Hub"],infrastructureScore:88},{name:"Obio-Akpor",coordinates:[7.05,4.833],zone:"Metropolitan",highlights:["Industrial Zone"],infrastructureScore:85},{name:"Eleme",coordinates:[7.117,4.783],zone:"Industrial",highlights:["Petrochemical Hub"],infrastructureScore:82}]}],ih=e=>{let{selectedState:t,selectedCity:n,activeCategory:r,handleStateChange:i,handleCityChange:o,setActiveCategory:a,availableCities:s}=e;return(0,Ot.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-100",children:(0,Ot.jsxs)("div",{className:"p-3",children:[(0,Ot.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,Ot.jsxs)("div",{className:"flex-1 min-w-[200px] flex gap-2",children:[(0,Ot.jsxs)("select",{className:"flex-1 px-3 py-1.5 text-sm border border-gray-300  focus:outline-none focus:ring-1 focus:ring-blue-500  rounded-md bg-white",value:t,onChange:e=>i(e.target.value),children:[(0,Ot.jsx)("option",{value:"",children:"All States"}),rh.map((e=>(0,Ot.jsxs)("option",{value:e.state,children:[e.state," (",e.region,")"]},e.state)))]}),(0,Ot.jsxs)("select",{className:"flex-1 px-3 py-1.5 text-sm border border-gray-300  focus:outline-none focus:ring-1 focus:ring-blue-500  rounded-md bg-white disabled:bg-gray-50",value:n,onChange:e=>o(e.target.value),disabled:!t,children:[(0,Ot.jsx)("option",{value:"",children:"All Cities"}),s.map((e=>(0,Ot.jsx)("option",{value:e.name,children:e.name},e.name)))]})]}),(0,Ot.jsx)("div",{className:"flex flex-wrap gap-1.5",children:["all","healthcare","education","transport","utilities"].map((e=>(0,Ot.jsx)("button",{onClick:()=>a(e),className:"px-3 py-1 rounded-full text-xs font-medium transition-colors\n                          ".concat(r===e?"bg-blue-100 text-blue-700 border border-blue-200":"bg-gray-50 text-gray-600 border border-gray-200 hover:bg-gray-100"),children:e.charAt(0).toUpperCase()+e.slice(1)},e)))})]}),(t||n||"all"!==r)&&(0,Ot.jsxs)("div",{className:"mt-2 flex flex-wrap gap-1.5",children:[t&&(0,Ot.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-blue-50 text-blue-700",children:[t,(0,Ot.jsx)("button",{onClick:()=>i(""),className:"ml-1 hover:text-blue-800",children:"\xd7"})]}),n&&(0,Ot.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-green-50 text-green-700",children:[n,(0,Ot.jsx)("button",{onClick:()=>o(""),className:"ml-1 hover:text-green-800",children:"\xd7"})]})]})]})})},oh={healthcare:{title:"Healthcare",icon:Yu,color:"#1c5bde",stats:{total:245,operational:220,inProgress:25,coverage:85,rating:4.2,yearOverYear:"+12%"},facilities:[{type:"Hospitals",count:42},{type:"Clinics",count:156},{type:"Emergency Centers",count:28},{type:"Specialized Centers",count:19}]},education:{title:"Education",icon:Ku,color:"#2ecc71",stats:{total:312,operational:298,inProgress:14,coverage:88,rating:4,yearOverYear:"+8%"},facilities:[{type:"Universities",count:15},{type:"Secondary Schools",count:127},{type:"Primary Schools",count:145},{type:"Technical Institutes",count:25}]},transport:{title:"Transport",icon:Ju,color:"#f39c12",stats:{total:178,operational:165,inProgress:13,coverage:82,rating:3.8,yearOverYear:"+15%"},facilities:[{type:"Major Roads",count:45},{type:"Bridges",count:23},{type:"Bus Terminals",count:68},{type:"Rail Stations",count:42}]},utilities:{title:"Utilities",icon:nu,color:"#9b59b6",stats:{total:198,operational:182,inProgress:16,coverage:90,rating:4.1,yearOverYear:"+10%"},facilities:[{type:"Power Stations",count:28},{type:"Water Treatment",count:35},{type:"Waste Management",count:42},{type:"Distribution Centers",count:93}]}},ah=e=>{let{data:t,activeCategory:n}=e;const r="all"===n?Object.values(t):[t[n]].filter(Boolean);return(0,Ot.jsx)("div",{className:"grid grid-cols-1 gap-4",children:r.map((e=>(0,Ot.jsxs)(xu,{className:"overflow-hidden",children:[(0,Ot.jsx)(bu,{className:"pb-2",children:(0,Ot.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ot.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Ot.jsx)("div",{className:"p-2 rounded-lg",style:{backgroundColor:"".concat(e.color,"15")},children:(0,Ot.jsx)(e.icon,{className:"h-5 w-5",style:{color:e.color}})}),(0,Ot.jsx)(wu,{className:"text-lg",children:e.title})]}),(0,Ot.jsx)("span",{className:"text-sm font-medium px-2 py-1 rounded-full",style:{backgroundColor:"".concat(e.color,"15"),color:e.color},children:e.stats.yearOverYear})]})}),(0,Ot.jsx)(Su,{className:"pt-4",children:(0,Ot.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,Ot.jsxs)("div",{className:"space-y-4",children:[(0,Ot.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,Ot.jsxs)("div",{className:"space-y-1",children:[(0,Ot.jsx)("p",{className:"text-sm text-gray-500",children:"Total Facilities"}),(0,Ot.jsx)("p",{className:"text-2xl font-semibold",children:e.stats.total})]}),(0,Ot.jsxs)("div",{className:"space-y-1",children:[(0,Ot.jsx)("p",{className:"text-sm text-gray-500",children:"Coverage"}),(0,Ot.jsxs)("p",{className:"text-2xl font-semibold",children:[e.stats.coverage,"%"]})]})]}),(0,Ot.jsxs)("div",{className:"space-y-2",children:[(0,Ot.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,Ot.jsx)("span",{className:"text-green-600",children:"Operational"}),(0,Ot.jsx)("span",{className:"text-orange-600",children:"In Progress"})]}),(0,Ot.jsx)("div",{className:"h-2 rounded-full bg-gray-100 overflow-hidden",children:(0,Ot.jsx)("div",{className:"h-full bg-green-500 rounded-full",style:{width:"".concat(e.stats.operational/e.stats.total*100,"%")}})})]})]}),(0,Ot.jsx)("div",{className:"space-y-2",children:e.facilities.map((e=>(0,Ot.jsxs)("div",{className:"flex justify-between items-center p-2 rounded-lg bg-gray-50",children:[(0,Ot.jsx)("span",{className:"text-sm text-gray-600",children:e.type}),(0,Ot.jsx)("span",{className:"text-sm font-medium",children:e.count})]},e.type)))})]})})]},e.title)))})},sh={overview:{averageIncrease:"15.2%",timeFrame:"12 months",totalProperties:1250},byInfrastructure:[{type:"Healthcare",impact:"+18%",radius:"2km",details:"Properties near hospitals and clinics",trend:"increasing"},{type:"Education",impact:"+12%",radius:"1.5km",details:"Properties near schools and universities",trend:"stable"},{type:"Transport",impact:"+22%",radius:"1km",details:"Properties near major transport hubs",trend:"increasing"},{type:"Utilities",impact:"+8%",radius:"3km",details:"Properties near utility facilities",trend:"stable"}],hotspots:[{area:"Central Business District",growth:"+25%",factors:["Transport Hub","Business Centers"]},{area:"Educational Zone",growth:"+15%",factors:["Universities","Research Centers"]},{area:"Healthcare District",growth:"+20%",factors:["Major Hospitals","Medical Facilities"]}]},lh=e=>{let{data:t}=e;return(0,Ot.jsxs)(xu,{children:[(0,Ot.jsxs)(bu,{children:[(0,Ot.jsxs)(wu,{className:"flex items-center gap-2",children:[(0,Ot.jsx)(nu,{className:"h-5 w-5 text-blue-600"}),"Property Value Impact"]}),(0,Ot.jsx)("p",{className:"text-sm text-gray-500",children:"Impact of infrastructure on property values"})]}),(0,Ot.jsxs)(Su,{className:"space-y-6",children:[(0,Ot.jsxs)("div",{className:"grid grid-cols-3 gap-4 p-4 bg-blue-50 rounded-lg",children:[(0,Ot.jsxs)("div",{className:"text-center",children:[(0,Ot.jsx)("p",{className:"text-sm text-gray-600",children:"Average Increase"}),(0,Ot.jsx)("p",{className:"text-2xl font-bold text-blue-700",children:t.overview.averageIncrease})]}),(0,Ot.jsxs)("div",{className:"text-center",children:[(0,Ot.jsx)("p",{className:"text-sm text-gray-600",children:"Time Frame"}),(0,Ot.jsx)("p",{className:"text-2xl font-bold text-blue-700",children:t.overview.timeFrame})]}),(0,Ot.jsxs)("div",{className:"text-center",children:[(0,Ot.jsx)("p",{className:"text-sm text-gray-600",children:"Properties"}),(0,Ot.jsx)("p",{className:"text-2xl font-bold text-blue-700",children:t.overview.totalProperties})]})]}),(0,Ot.jsxs)("div",{className:"space-y-3",children:[(0,Ot.jsx)("h3",{className:"text-sm font-medium text-gray-700",children:"Impact by Infrastructure"}),t.byInfrastructure.map(((e,t)=>(0,Ot.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[(0,Ot.jsxs)("div",{className:"space-y-1",children:[(0,Ot.jsx)("p",{className:"font-medium",children:e.type}),(0,Ot.jsxs)("p",{className:"text-xs text-gray-500",children:["Within ",e.radius," radius"]})]}),(0,Ot.jsxs)("div",{className:"text-right",children:[(0,Ot.jsx)("p",{className:"text-lg font-bold ".concat(parseFloat(e.impact)>15?"text-green-600":parseFloat(e.impact)>10?"text-blue-600":"text-gray-600"),children:e.impact}),(0,Ot.jsx)("p",{className:"text-xs text-gray-500",children:e.trend})]})]},t)))]}),(0,Ot.jsxs)("div",{className:"space-y-3",children:[(0,Ot.jsx)("h3",{className:"text-sm font-medium text-gray-700",children:"Value Hotspots"}),(0,Ot.jsx)("div",{className:"grid grid-cols-1 gap-2",children:t.hotspots.map(((e,t)=>(0,Ot.jsxs)("div",{className:"p-3 border border-gray-200 rounded-lg",children:[(0,Ot.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,Ot.jsx)("p",{className:"font-medium",children:e.area}),(0,Ot.jsx)("span",{className:"text-green-600 font-bold",children:e.growth})]}),(0,Ot.jsx)("div",{className:"flex gap-2",children:e.factors.map(((e,t)=>(0,Ot.jsx)("span",{className:"text-xs px-2 py-1 bg-gray-100 rounded-full text-gray-600",children:e},t)))})]},t)))})]})]})]})},ch=()=>(0,Ot.jsxs)(xu,{children:[(0,Ot.jsx)(bu,{className:"py-3",children:(0,Ot.jsxs)(wu,{className:"flex items-center gap-2 text-base",children:[(0,Ot.jsx)(uu,{className:"h-4 w-4 text-blue-600"}),"Investment Hotspots"]})}),(0,Ot.jsx)(Su,{className:"p-3",children:(0,Ot.jsx)("div",{className:"space-y-2",children:[{area:"Tech District",roi:"+25%",projects:8,status:"High Growth",type:"Commercial"},{area:"Medical City",roi:"+20%",projects:5,status:"Emerging",type:"Healthcare"},{area:"Education Hub",roi:"+18%",projects:6,status:"Stable",type:"Institutional"}].map(((e,t)=>(0,Ot.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded-lg hover:bg-gray-100",children:[(0,Ot.jsxs)("div",{children:[(0,Ot.jsx)("p",{className:"font-medium text-sm",children:e.area}),(0,Ot.jsxs)("div",{className:"flex gap-2 mt-1",children:[(0,Ot.jsx)("span",{className:"text-xs px-2 py-0.5 bg-blue-100 text-blue-700 rounded-full",children:e.type}),(0,Ot.jsxs)("span",{className:"text-xs px-2 py-0.5 bg-gray-100 text-gray-600 rounded-full",children:[e.projects," projects"]})]})]}),(0,Ot.jsxs)("div",{className:"text-right",children:[(0,Ot.jsx)("p",{className:"text-green-600 font-bold text-sm",children:e.roi}),(0,Ot.jsx)("p",{className:"text-xs text-gray-500",children:e.status})]})]},t)))})})]}),uh=()=>(0,Ot.jsxs)(xu,{children:[(0,Ot.jsx)(bu,{className:"py-3",children:(0,Ot.jsxs)(wu,{className:"flex items-center gap-2 text-base",children:[(0,Ot.jsx)(Qu,{className:"h-4 w-4 text-blue-600"}),"Development Timeline"]})}),(0,Ot.jsx)(Su,{className:"p-3",children:(0,Ot.jsx)("div",{className:"space-y-3",children:[{phase:"Q4 2023",status:"Completed",projects:["Healthcare Hub","Transport Terminal"]},{phase:"Q1 2024",status:"In Progress",projects:["Education Center","Smart Grid"]},{phase:"Q2 2024",status:"Planned",projects:["Tech Park","Green Space"]}].map(((e,t)=>(0,Ot.jsxs)("div",{className:"relative pl-4 border-l-2 border-blue-200",children:[(0,Ot.jsx)("div",{className:"absolute -left-[9px] top-1 w-4 h-4 rounded-full bg-blue-500"}),(0,Ot.jsxs)("div",{className:"mb-1",children:[(0,Ot.jsx)("span",{className:"text-sm font-medium",children:e.phase}),(0,Ot.jsx)("span",{className:"ml-2 text-xs px-2 py-0.5 rounded-full ".concat("Completed"===e.status?"bg-green-100 text-green-700":"In Progress"===e.status?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"),children:e.status})]}),(0,Ot.jsx)("div",{className:"flex gap-2",children:e.projects.map(((e,t)=>(0,Ot.jsx)("span",{className:"text-xs px-2 py-0.5 bg-gray-100 text-gray-600 rounded-full",children:e},t)))})]},t)))})})]}),hh=()=>{const[e,n]=(0,t.useState)(!1),[r,i]=(0,t.useState)(""),[o,a]=(0,t.useState)("");return(0,Ot.jsxs)(xu,{className:"bg-gradient-to-br from-blue-50 to-white",children:[(0,Ot.jsx)(bu,{className:"py-3",children:(0,Ot.jsxs)(wu,{className:"flex items-center gap-2",children:[(0,Ot.jsx)($u,{className:"h-5 w-5 text-blue-600"}),"AI Market Insights"]})}),(0,Ot.jsxs)(Su,{className:"space-y-4",children:[(0,Ot.jsxs)("div",{className:"bg-white p-3 rounded-lg border border-blue-100",children:[(0,Ot.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,Ot.jsx)(eh,{className:"h-4 w-4 text-blue-600"}),(0,Ot.jsx)("h3",{className:"text-sm font-medium",children:"AI Assistant"})]}),(0,Ot.jsxs)("div",{className:"space-y-2",children:[(0,Ot.jsx)("textarea",{className:"w-full p-2 text-sm border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Ask about market trends, investment opportunities, or infrastructure impact...",rows:"2",value:o,onChange:e=>a(e.target.value)}),(0,Ot.jsxs)("button",{className:"w-full py-1.5 bg-blue-600 text-white rounded-lg text-sm hover:bg-blue-700  flex items-center justify-center gap-2",onClick:()=>{n(!0),setTimeout((()=>{i("Based on current trends and infrastructure development plans, this area shows strong potential for investment, particularly in residential and commercial sectors..."),n(!1)}),1500)},children:[e?(0,Ot.jsx)(th,{className:"h-4 w-4 animate-spin"}):(0,Ot.jsx)(Gc,{className:"h-4 w-4"}),"Get AI Insights"]})]}),r&&(0,Ot.jsx)("div",{className:"mt-3 p-3 bg-blue-50 rounded-lg text-sm",children:(0,Ot.jsx)("p",{className:"text-gray-700",children:r})})]}),(0,Ot.jsxs)("div",{className:"space-y-3",children:[(0,Ot.jsxs)("h3",{className:"text-sm font-medium flex items-center gap-2",children:[(0,Ot.jsx)(kt,{className:"h-4 w-4 text-green-600"}),"Market Predictions"]}),[{type:"Growth Forecast",prediction:"+18% YoY",confidence:85,factors:["Infrastructure Development","Economic Indicators"],trend:"Upward",timeframe:"Next 12 months"},{type:"Investment Opportunity",areas:["Tech Corridor","Medical District"],potentialROI:"22-25%",riskLevel:"Moderate"}].map(((e,t)=>{var n;return(0,Ot.jsxs)("div",{className:"bg-white p-3 rounded-lg border border-gray-100",children:[(0,Ot.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,Ot.jsx)("span",{className:"text-sm font-medium",children:e.type}),e.prediction&&(0,Ot.jsx)("span",{className:"text-green-600 font-bold text-sm",children:e.prediction})]}),e.confidence&&(0,Ot.jsx)("div",{className:"w-full h-2 bg-gray-100 rounded-full overflow-hidden mb-2",children:(0,Ot.jsx)("div",{className:"h-full bg-green-500 rounded-full",style:{width:"".concat(e.confidence,"%")}})}),(0,Ot.jsx)("div",{className:"flex flex-wrap gap-1",children:null===(n=e.factors)||void 0===n?void 0:n.map(((e,t)=>(0,Ot.jsx)("span",{className:"text-xs px-2 py-0.5 bg-gray-100 rounded-full",children:e},t)))})]},t)}))]}),(0,Ot.jsxs)("div",{className:"space-y-3",children:[(0,Ot.jsxs)("h3",{className:"text-sm font-medium flex items-center gap-2",children:[(0,Ot.jsx)(nh,{className:"h-4 w-4 text-yellow-600"}),"Smart Recommendations"]}),[{strategy:"Premium Residential",timing:"Immediate Entry",confidence:92,reasoning:"Strong infrastructure growth + high demand"},{strategy:"Commercial Development",timing:"Q2 2024",confidence:88,reasoning:"Upcoming tech hub expansion"}].map(((e,t)=>(0,Ot.jsxs)("div",{className:"bg-white p-3 rounded-lg border border-gray-100",children:[(0,Ot.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,Ot.jsx)("span",{className:"text-sm font-medium",children:e.strategy}),(0,Ot.jsxs)("span",{className:"text-xs px-2 py-0.5 rounded-full ".concat(e.confidence>=90?"bg-green-100 text-green-700":e.confidence>=80?"bg-blue-100 text-blue-700":"bg-yellow-100 text-yellow-700"),children:[e.confidence,"% Confidence"]})]}),(0,Ot.jsx)("p",{className:"text-xs text-gray-600 mb-2",children:e.reasoning}),(0,Ot.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Ot.jsx)(Qu,{className:"h-3 w-3 text-gray-400"}),(0,Ot.jsx)("span",{className:"text-xs text-gray-600",children:e.timing})]})]},t)))]})]})]})},dh=()=>{const[e,n]=(0,t.useState)("all"),[r,i]=(0,t.useState)("downtown"),[o,a]=(0,t.useState)("1y"),[s,l]=(0,t.useState)([]),[c,u]=(0,t.useState)(85),h=(0,t.useRef)(null),d=(0,t.useRef)(null),[p,f]=(0,t.useState)({infrastructureScore:85,dataLayers:[]}),[m,g]=(0,t.useState)(!1),[y,_]=(0,t.useState)(""),[v,x]=(0,t.useState)(""),[b,w]=(0,t.useState)([]),[S,T]=(0,t.useState)("all"),[E,A]=(0,t.useState)(Zc["Federal Capital Territory"]),M=[{month:"Jan 2024",value:25e4,impact:2.5},{month:"Feb 2024",value:255e3,impact:2},{month:"Mar 2024",value:258e3,impact:1.2},{month:"Apr 2024",value:262e3,impact:1.5},{month:"May 2024",value:27e4,impact:3.1},{month:"Jun 2024",value:275e3,impact:1.9},{month:"Jul 2024",value:28e4,impact:1.8},{month:"Aug 2024",value:285e3,impact:1.8},{month:"Sep 2024",value:29e4,impact:1.7},{month:"Oct 2024",value:295e3,impact:1.7},{month:"Nov 2024",value:3e5,impact:1.7},{month:"Dec 2024",value:305e3,impact:1.7}],P=(((M[M.length-1].value-M[0].value)/M[0].value*100).toFixed(1),Zc.categories.find((e=>"schools"===e.id)).items.length,Zc.categories.find((e=>"hospitals"===e.id)).items.length,Zc.categories.find((e=>"transport"===e.id)).items.length,Zc.categories.find((e=>"roads"===e.id)).items.length,Zc.categories.find((e=>"utilities"===e.id)).items.length,Zc.categories.find((e=>"development"===e.id)).items.length,[{state:"Federal Capital Territory",cities:[{name:"Abuja",coordinates:[7.491,9.082],zone:"Central"},{name:"Gwagwalada",coordinates:[7.079,8.947],zone:"South"},{name:"Kuje",coordinates:[7.227,8.879],zone:"South"},{name:"Bwari",coordinates:[7.381,9.287],zone:"North"}]},{state:"Gombe",cities:[{name:"Gombe",coordinates:[11.167,10.283],zone:"Central"},{name:"Billiri",coordinates:[11.217,9.867],zone:"South"},{name:"Kaltungo",coordinates:[11.309,9.82],zone:"South"},{name:"Akko",coordinates:[11.167,10.283],zone:"Central"},{name:"Dukku",coordinates:[10.823,10.772],zone:"North"},{name:"Funakaye",coordinates:[10.523,10.702],zone:"North"}]}]);(0,t.useEffect)((()=>{if(y){const e=P.find((e=>e.state===y));w(e?e.cities:[]),x("")}else w([]),x("")}),[y]);return(0,t.useEffect)((()=>{if(h.current&&!d.current)return d.current=new(Au().Map)({container:h.current,style:"mapbox://styles/mapbox/light-v11",center:[8.6753,9.082],zoom:5.5,pitch:45}),d.current.addControl(new(Au().NavigationControl)),()=>{d.current&&(d.current.remove(),d.current=null)}}),[]),(0,Ot.jsx)("div",{className:"pt-20 min-h-screen bg-gray-50 px-4 pb-4",children:(0,Ot.jsxs)("div",{className:"max-w-7xl mx-auto space-y-4",children:[(0,Ot.jsx)(ih,{selectedState:y,selectedCity:v,activeCategory:S,handleStateChange:e=>{_(e),e&&Zc[e]?A(Zc[e]):A(Zc["Federal Capital Territory"])},handleCityChange:e=>{if(x(e),e){const t=b.find((t=>t.name===e));t&&d.current&&d.current.flyTo({center:t.coordinates,zoom:13,duration:2e3})}},setActiveCategory:T,availableCities:b}),(0,Ot.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[(0,Ot.jsxs)("div",{className:"lg:col-span-2 space-y-4",children:[(0,Ot.jsxs)(xu,{children:[(0,Ot.jsx)(bu,{className:"py-3",children:(0,Ot.jsx)(wu,{children:"Infrastructure Map"})}),(0,Ot.jsx)(Su,{className:"p-0",children:(0,Ot.jsx)("div",{ref:h,className:"h-[400px] w-full",style:{position:"relative"}})})]}),(0,Ot.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,Ot.jsx)(ah,{data:oh,activeCategory:S}),(0,Ot.jsx)(lh,{data:sh})]}),(0,Ot.jsx)(uh,{})]}),(0,Ot.jsxs)("div",{className:"space-y-4",children:[(0,Ot.jsx)(hh,{}),(0,Ot.jsx)(ch,{})]})]})]})})},ph=Et("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]),fh=Et("Tv",[["rect",{width:"20",height:"15",x:"2",y:"7",rx:"2",ry:"2",key:"10ag99"}],["polyline",{points:"17 2 12 7 7 2",key:"11pgbg"}]]),mh=Et("Wind",[["path",{d:"M12.8 19.6A2 2 0 1 0 14 16H2",key:"148xed"}],["path",{d:"M17.5 8a2.5 2.5 0 1 1 2 4H2",key:"1u4tom"}],["path",{d:"M9.8 4.4A2 2 0 1 1 11 8H2",key:"75valh"}]]),gh=Et("Droplet",[["path",{d:"M12 22a7 7 0 0 0 7-7c0-2-1-3.9-3-5.5s-3.5-4-4-6.5c-.5 2.5-2 4.9-4 6.5C6 11.1 5 13 5 15a7 7 0 0 0 7 7z",key:"c7niix"}]]),yh=Et("Mountain",[["path",{d:"m8 3 4 8 5-5 5 15H2L8 3z",key:"otkl63"}]]),_h=Et("Utensils",[["path",{d:"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2",key:"cjf0a3"}],["path",{d:"M7 2v20",key:"1473qp"}],["path",{d:"M21 15V2a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7",key:"j28e5"}]]),vh=Et("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]),xh=Et("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]),bh=Et("Coffee",[["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M14 2v2",key:"6buw04"}],["path",{d:"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1",key:"pwadti"}],["path",{d:"M6 2v2",key:"colzsn"}]]),wh=Et("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]),Sh=Et("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),Th=Et("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),Eh=Et("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),Ah=Et("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);function Mh(e){var t,n,r="";if("string"==typeof e||"number"==typeof e)r+=e;else if("object"==typeof e)if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(n=Mh(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function Ph(){for(var e,t,n=0,r="",i=arguments.length;n<i;n++)(e=arguments[n])&&(t=Mh(e))&&(r&&(r+=" "),r+=t);return r}const kh=Ph;var Ch=n(9889),jh=n.n(Ch),Ih=n(620),Oh=n.n(Ih),Nh=n(5268),Dh=n.n(Nh),Lh=n(3097),zh=n.n(Lh),Rh=n(9160),Fh=n.n(Rh),Bh=function(e){return 0===e?0:e>0?1:-1},Vh=function(e){return Oh()(e)&&e.indexOf("%")===e.length-1},Uh=function(e){return Fh()(e)&&!Dh()(e)},Gh=function(e){return Uh(e)||Oh()(e)},Hh=0,Zh=function(e){var t=++Hh;return"".concat(e||"").concat(t)},qh=function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!Uh(e)&&!Oh()(e))return r;if(Vh(e)){var o=e.indexOf("%");n=t*parseFloat(e.slice(0,o))/100}else n=+e;return Dh()(n)&&(n=r),i&&n>t&&(n=t),n},Wh=function(e){if(!e)return null;var t=Object.keys(e);return t&&t.length?e[t[0]]:null},Xh=function(e,t){return Uh(e)&&Uh(t)?function(n){return e+n*(t-e)}:function(){return t}};function Yh(e,t,n){return e&&e.length?e.find((function(e){return e&&("function"===typeof t?t(e):zh()(e,t))===n})):null}var Kh=function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i]},Jh=n(9686),Qh=n.n(Jh),$h=n(1629),ed=n.n($h),td=n(6686),nd=n.n(td),rd=n(9062);function id(e,t){for(var n in e)if({}.hasOwnProperty.call(e,n)&&(!{}.hasOwnProperty.call(t,n)||e[n]!==t[n]))return!1;for(var r in t)if({}.hasOwnProperty.call(t,r)&&!{}.hasOwnProperty.call(e,r))return!1;return!0}function od(e){return od="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},od(e)}var ad=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],sd=["points","pathLength"],ld={svg:["viewBox","children"],polygon:sd,polyline:sd},cd=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],ud=function(e,n){if(!e||"function"===typeof e||"boolean"===typeof e)return null;var r=e;if((0,t.isValidElement)(e)&&(r=e.props),!nd()(r))return null;var i={};return Object.keys(r).forEach((function(e){cd.includes(e)&&(i[e]=n||function(t){return r[e](r,t)})})),i},hd=function(e,t,n){if(!nd()(e)||"object"!==od(e))return null;var r=null;return Object.keys(e).forEach((function(i){var o=e[i];cd.includes(i)&&"function"===typeof o&&(r||(r={}),r[i]=function(e,t,n){return function(r){return e(t,n,r),null}}(o,t,n))})),r},dd=["children"],pd=["children"];function fd(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function md(e){return md="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},md(e)}var gd={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},yd=function(e){return"string"===typeof e?e:e?e.displayName||e.name||"Component":""},_d=null,vd=null,xd=function e(n){if(n===_d&&Array.isArray(vd))return vd;var r=[];return t.Children.forEach(n,(function(t){Qh()(t)||((0,rd.isFragment)(t)?r=r.concat(e(t.props.children)):r.push(t))})),vd=r,_d=n,r};function bd(e,t){var n=[],r=[];return r=Array.isArray(t)?t.map((function(e){return yd(e)})):[yd(t)],xd(e).forEach((function(e){var t=zh()(e,"type.displayName")||zh()(e,"type.name");-1!==r.indexOf(t)&&n.push(e)})),n}function wd(e,t){var n=bd(e,t);return n&&n[0]}var Sd=function(e){if(!e||!e.props)return!1;var t=e.props,n=t.width,r=t.height;return!(!Uh(n)||n<=0||!Uh(r)||r<=0)},Td=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],Ed=function(e){return e&&e.type&&Oh()(e.type)&&Td.indexOf(e.type)>=0},Ad=function(e){return e&&"object"===md(e)&&"clipDot"in e},Md=function(e,n,r){if(!e||"function"===typeof e||"boolean"===typeof e)return null;var i=e;if((0,t.isValidElement)(e)&&(i=e.props),!nd()(i))return null;var o={};return Object.keys(i).forEach((function(e){var t;(function(e,t,n,r){var i,o=null!==(i=null===ld||void 0===ld?void 0:ld[r])&&void 0!==i?i:[];return!ed()(e)&&(r&&o.includes(t)||ad.includes(t))||n&&cd.includes(t)})(null===(t=i)||void 0===t?void 0:t[e],e,n,r)&&(o[e]=i[e])})),o},Pd=function e(n,r){if(n===r)return!0;var i=t.Children.count(n);if(i!==t.Children.count(r))return!1;if(0===i)return!0;if(1===i)return kd(Array.isArray(n)?n[0]:n,Array.isArray(r)?r[0]:r);for(var o=0;o<i;o++){var a=n[o],s=r[o];if(Array.isArray(a)||Array.isArray(s)){if(!e(a,s))return!1}else if(!kd(a,s))return!1}return!0},kd=function(e,t){if(Qh()(e)&&Qh()(t))return!0;if(!Qh()(e)&&!Qh()(t)){var n=e.props||{},r=n.children,i=fd(n,dd),o=t.props||{},a=o.children,s=fd(o,pd);return r&&a?id(i,s)&&Pd(r,a):!r&&!a&&id(i,s)}return!1},Cd=function(e,t){var n=[],r={};return xd(e).forEach((function(e,i){if(Ed(e))n.push(e);else if(e){var o=yd(e.type),a=t[o]||{},s=a.handler,l=a.once;if(s&&(!l||!r[o])){var c=s(e,o,i);n.push(c),r[o]=!0}}})),n};function jd(e){return jd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jd(e)}function Id(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Od(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Id(Object(n),!0).forEach((function(t){Nd(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Id(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Nd(e,t,n){return t=function(e){var t=function(e,t){if("object"!=jd(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=jd(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==jd(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Dd(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],l=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){c=!0,i=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw i}}return s}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return Ld(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ld(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ld(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var zd=(0,t.forwardRef)((function(e,n){var r=e.aspect,i=e.initialDimension,o=void 0===i?{width:-1,height:-1}:i,a=e.width,s=void 0===a?"100%":a,l=e.height,c=void 0===l?"100%":l,u=e.minWidth,h=void 0===u?0:u,d=e.minHeight,p=e.maxHeight,f=e.children,m=e.debounce,g=void 0===m?0:m,y=e.id,_=e.className,v=e.onResize,x=e.style,b=void 0===x?{}:x,w=(0,t.useRef)(null),S=(0,t.useRef)();S.current=v,(0,t.useImperativeHandle)(n,(function(){return Object.defineProperty(w.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),w.current},configurable:!0})}));var T=Dd((0,t.useState)({containerWidth:o.width,containerHeight:o.height}),2),E=T[0],A=T[1],M=(0,t.useCallback)((function(e,t){A((function(n){var r=Math.round(e),i=Math.round(t);return n.containerWidth===r&&n.containerHeight===i?n:{containerWidth:r,containerHeight:i}}))}),[]);(0,t.useEffect)((function(){var e=function(e){var t,n=e[0].contentRect,r=n.width,i=n.height;M(r,i),null===(t=S.current)||void 0===t||t.call(S,r,i)};g>0&&(e=jh()(e,g,{trailing:!0,leading:!1}));var t=new ResizeObserver(e),n=w.current.getBoundingClientRect(),r=n.width,i=n.height;return M(r,i),t.observe(w.current),function(){t.disconnect()}}),[M,g]);var P=(0,t.useMemo)((function(){var e=E.containerWidth,n=E.containerHeight;if(e<0||n<0)return null;Kh(Vh(s)||Vh(c),"The width(%s) and height(%s) are both fixed numbers,\n       maybe you don't need to use a ResponsiveContainer.",s,c),Kh(!r||r>0,"The aspect(%s) must be greater than zero.",r);var i=Vh(s)?e:s,o=Vh(c)?n:c;r&&r>0&&(i?o=i/r:o&&(i=o*r),p&&o>p&&(o=p)),Kh(i>0||o>0,"The width(%s) and height(%s) of chart should be greater than 0,\n       please check the style of container, or the props width(%s) and height(%s),\n       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the\n       height and width.",i,o,s,c,h,d,r);var a=!Array.isArray(f)&&yd(f.type).endsWith("Chart");return t.Children.map(f,(function(e){return t.isValidElement(e)?(0,t.cloneElement)(e,Od({width:i,height:o},a?{style:Od({height:"100%",width:"100%",maxHeight:o,maxWidth:i},e.props.style)}:{})):e}))}),[r,f,c,p,d,h,E,s]);return t.createElement("div",{id:y?"".concat(y):void 0,className:kh("recharts-responsive-container",_),style:Od(Od({},b),{},{width:s,height:c,minWidth:h,minHeight:d,maxHeight:p}),ref:w},P)})),Rd=n(6604),Fd=n.n(Rd),Bd=n(7424),Vd=n.n(Bd),Ud="Invariant failed";function Gd(e,t){if(!e)throw new Error(Ud)}var Hd=["children","width","height","viewBox","className","style","title","desc"];function Zd(){return Zd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Zd.apply(this,arguments)}function qd(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Wd(e){var n=e.children,r=e.width,i=e.height,o=e.viewBox,a=e.className,s=e.style,l=e.title,c=e.desc,u=qd(e,Hd),h=o||{width:r,height:i,x:0,y:0},d=kh("recharts-surface",a);return t.createElement("svg",Zd({},Md(u,!0,"svg"),{className:d,width:r,height:i,style:s,viewBox:"".concat(h.x," ").concat(h.y," ").concat(h.width," ").concat(h.height)}),t.createElement("title",null,l),t.createElement("desc",null,c),n)}var Xd=["children","className"];function Yd(){return Yd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Yd.apply(this,arguments)}function Kd(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var Jd=t.forwardRef((function(e,n){var r=e.children,i=e.className,o=Kd(e,Xd),a=kh("recharts-layer",i);return t.createElement("g",Yd({className:a},Md(o,!0),{ref:n}),r)}));function Qd(e){return Qd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qd(e)}function $d(){return $d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},$d.apply(this,arguments)}function ep(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],l=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){c=!0,i=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw i}}return s}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return tp(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tp(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function tp(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function np(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function rp(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?np(Object(n),!0).forEach((function(t){ip(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):np(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ip(e,t,n){return t=function(e){var t=function(e,t){if("object"!=Qd(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=Qd(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Qd(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function op(e){return Array.isArray(e)&&Gh(e[0])&&Gh(e[1])?e.join(" ~ "):e}var ap=function(e){var n=e.separator,r=void 0===n?" : ":n,i=e.contentStyle,o=void 0===i?{}:i,a=e.itemStyle,s=void 0===a?{}:a,l=e.labelStyle,c=void 0===l?{}:l,u=e.payload,h=e.formatter,d=e.itemSorter,p=e.wrapperClassName,f=e.labelClassName,m=e.label,g=e.labelFormatter,y=e.accessibilityLayer,_=void 0!==y&&y,v=rp({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},o),x=rp({margin:0},c),b=!Qh()(m),w=b?m:"",S=kh("recharts-default-tooltip",p),T=kh("recharts-tooltip-label",f);b&&g&&void 0!==u&&null!==u&&(w=g(m,u));var E=_?{role:"status","aria-live":"assertive"}:{};return t.createElement("div",$d({className:S,style:v},E),t.createElement("p",{className:T,style:x},t.isValidElement(w)?w:"".concat(w)),function(){if(u&&u.length){var e=(d?Vd()(u,d):u).map((function(e,n){if("none"===e.type)return null;var i=rp({display:"block",paddingTop:4,paddingBottom:4,color:e.color||"#000"},s),o=e.formatter||h||op,a=e.value,l=e.name,c=a,d=l;if(o&&null!=c&&null!=d){var p=o(a,l,e,n,u);if(Array.isArray(p)){var f=ep(p,2);c=f[0],d=f[1]}else c=p}return t.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(n),style:i},Gh(d)?t.createElement("span",{className:"recharts-tooltip-item-name"},d):null,Gh(d)?t.createElement("span",{className:"recharts-tooltip-item-separator"},r):null,t.createElement("span",{className:"recharts-tooltip-item-value"},c),t.createElement("span",{className:"recharts-tooltip-item-unit"},e.unit||""))}));return t.createElement("ul",{className:"recharts-tooltip-item-list",style:{padding:0,margin:0}},e)}return null}())};function sp(e){return sp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},sp(e)}function lp(e,t,n){return t=function(e){var t=function(e,t){if("object"!=sp(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=sp(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==sp(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var cp="recharts-tooltip-wrapper",up={visibility:"hidden"};function hp(e){var t=e.coordinate,n=e.translateX,r=e.translateY;return kh(cp,lp(lp(lp(lp({},"".concat(cp,"-right"),Uh(n)&&t&&Uh(t.x)&&n>=t.x),"".concat(cp,"-left"),Uh(n)&&t&&Uh(t.x)&&n<t.x),"".concat(cp,"-bottom"),Uh(r)&&t&&Uh(t.y)&&r>=t.y),"".concat(cp,"-top"),Uh(r)&&t&&Uh(t.y)&&r<t.y))}function dp(e){var t=e.allowEscapeViewBox,n=e.coordinate,r=e.key,i=e.offsetTopLeft,o=e.position,a=e.reverseDirection,s=e.tooltipDimension,l=e.viewBox,c=e.viewBoxDimension;if(o&&Uh(o[r]))return o[r];var u=n[r]-s-i,h=n[r]+i;return t[r]?a[r]?u:h:a[r]?u<l[r]?Math.max(h,l[r]):Math.max(u,l[r]):h+s>l[r]+c?Math.max(u,l[r]):Math.max(h,l[r])}function pp(e){return pp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pp(e)}function fp(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function mp(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fp(Object(n),!0).forEach((function(t){bp(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fp(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function gp(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,wp(r.key),r)}}function yp(e,t,n){return t=vp(t),function(e,t){if(t&&("object"===pp(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,_p()?Reflect.construct(t,n||[],vp(e).constructor):t.apply(e,n))}function _p(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(_p=function(){return!!e})()}function vp(e){return vp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},vp(e)}function xp(e,t){return xp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},xp(e,t)}function bp(e,t,n){return(t=wp(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function wp(e){var t=function(e,t){if("object"!=pp(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=pp(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==pp(t)?t:t+""}var Sp=function(e){function n(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return bp(e=yp(this,n,[].concat(r)),"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),bp(e,"handleKeyDown",(function(t){var n,r,i,o;"Escape"===t.key&&e.setState({dismissed:!0,dismissedAtCoordinate:{x:null!==(n=null===(r=e.props.coordinate)||void 0===r?void 0:r.x)&&void 0!==n?n:0,y:null!==(i=null===(o=e.props.coordinate)||void 0===o?void 0:o.y)&&void 0!==i?i:0}})})),e}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xp(e,t)}(n,e),r=n,(i=[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var e=this.wrapperNode.getBoundingClientRect();(Math.abs(e.width-this.state.lastBoundingBox.width)>1||Math.abs(e.height-this.state.lastBoundingBox.height)>1)&&this.setState({lastBoundingBox:{width:e.width,height:e.height}})}else-1===this.state.lastBoundingBox.width&&-1===this.state.lastBoundingBox.height||this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var e,t;this.props.active&&this.updateBBox(),this.state.dismissed&&((null===(e=this.props.coordinate)||void 0===e?void 0:e.x)===this.state.dismissedAtCoordinate.x&&(null===(t=this.props.coordinate)||void 0===t?void 0:t.y)===this.state.dismissedAtCoordinate.y||(this.state.dismissed=!1))}},{key:"render",value:function(){var e=this,n=this.props,r=n.active,i=n.allowEscapeViewBox,o=n.animationDuration,a=n.animationEasing,s=n.children,l=n.coordinate,c=n.hasPayload,u=n.isAnimationActive,h=n.offset,d=n.position,p=n.reverseDirection,f=n.useTranslate3d,m=n.viewBox,g=n.wrapperStyle,y=function(e){var t,n,r=e.allowEscapeViewBox,i=e.coordinate,o=e.offsetTopLeft,a=e.position,s=e.reverseDirection,l=e.tooltipBox,c=e.useTranslate3d,u=e.viewBox;return{cssProperties:l.height>0&&l.width>0&&i?function(e){var t=e.translateX,n=e.translateY;return{transform:e.useTranslate3d?"translate3d(".concat(t,"px, ").concat(n,"px, 0)"):"translate(".concat(t,"px, ").concat(n,"px)")}}({translateX:t=dp({allowEscapeViewBox:r,coordinate:i,key:"x",offsetTopLeft:o,position:a,reverseDirection:s,tooltipDimension:l.width,viewBox:u,viewBoxDimension:u.width}),translateY:n=dp({allowEscapeViewBox:r,coordinate:i,key:"y",offsetTopLeft:o,position:a,reverseDirection:s,tooltipDimension:l.height,viewBox:u,viewBoxDimension:u.height}),useTranslate3d:c}):up,cssClasses:hp({translateX:t,translateY:n,coordinate:i})}}({allowEscapeViewBox:i,coordinate:l,offsetTopLeft:h,position:d,reverseDirection:p,tooltipBox:this.state.lastBoundingBox,useTranslate3d:f,viewBox:m}),_=y.cssClasses,v=y.cssProperties,x=mp(mp({transition:u&&r?"transform ".concat(o,"ms ").concat(a):void 0},v),{},{pointerEvents:"none",visibility:!this.state.dismissed&&r&&c?"visible":"hidden",position:"absolute",top:0,left:0},g);return t.createElement("div",{tabIndex:-1,className:_,style:x,ref:function(t){e.wrapperNode=t}},s)}}])&&gp(r.prototype,i),o&&gp(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,i,o}(t.PureComponent),Tp={isSsr:!("undefined"!==typeof window&&window.document&&window.document.createElement&&window.setTimeout),get:function(e){return Tp[e]},set:function(e,t){if("string"===typeof e)Tp[e]=t;else{var n=Object.keys(e);n&&n.length&&n.forEach((function(t){Tp[t]=e[t]}))}}},Ep=n(977),Ap=n.n(Ep);function Mp(e,t,n){return!0===t?Ap()(e,n):ed()(t)?Ap()(e,t):e}function Pp(e){return Pp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pp(e)}function kp(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Cp(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?kp(Object(n),!0).forEach((function(t){Lp(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kp(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function jp(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,zp(r.key),r)}}function Ip(e,t,n){return t=Np(t),function(e,t){if(t&&("object"===Pp(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Op()?Reflect.construct(t,n||[],Np(e).constructor):t.apply(e,n))}function Op(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Op=function(){return!!e})()}function Np(e){return Np=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Np(e)}function Dp(e,t){return Dp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Dp(e,t)}function Lp(e,t,n){return(t=zp(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function zp(e){var t=function(e,t){if("object"!=Pp(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=Pp(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Pp(t)?t:t+""}function Rp(e){return e.dataKey}var Fp=function(e){function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),Ip(this,n,arguments)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Dp(e,t)}(n,e),r=n,(i=[{key:"render",value:function(){var e=this,n=this.props,r=n.active,i=n.allowEscapeViewBox,o=n.animationDuration,a=n.animationEasing,s=n.content,l=n.coordinate,c=n.filterNull,u=n.isAnimationActive,h=n.offset,d=n.payload,p=n.payloadUniqBy,f=n.position,m=n.reverseDirection,g=n.useTranslate3d,y=n.viewBox,_=n.wrapperStyle,v=null!==d&&void 0!==d?d:[];c&&v.length&&(v=Mp(d.filter((function(t){return null!=t.value&&(!0!==t.hide||e.props.includeHidden)})),p,Rp));var x=v.length>0;return t.createElement(Sp,{allowEscapeViewBox:i,animationDuration:o,animationEasing:a,isAnimationActive:u,active:r,coordinate:l,hasPayload:x,offset:h,position:f,reverseDirection:m,useTranslate3d:g,viewBox:y,wrapperStyle:_},function(e,n){return t.isValidElement(e)?t.cloneElement(e,n):"function"===typeof e?t.createElement(e,n):t.createElement(ap,n)}(s,Cp(Cp({},this.props),{},{payload:v})))}}])&&jp(r.prototype,i),o&&jp(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,i,o}(t.PureComponent);Lp(Fp,"displayName","Tooltip"),Lp(Fp,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!Tp.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var Bp=n(643),Vp=n.n(Bp);Math.abs,Math.atan2;const Up=Math.cos,Gp=(Math.max,Math.min,Math.sin),Hp=Math.sqrt,Zp=Math.PI,qp=2*Zp;const Wp={draw(e,t){const n=Hp(t/Zp);e.moveTo(n,0),e.arc(0,0,n,0,qp)}},Xp={draw(e,t){const n=Hp(t/5)/2;e.moveTo(-3*n,-n),e.lineTo(-n,-n),e.lineTo(-n,-3*n),e.lineTo(n,-3*n),e.lineTo(n,-n),e.lineTo(3*n,-n),e.lineTo(3*n,n),e.lineTo(n,n),e.lineTo(n,3*n),e.lineTo(-n,3*n),e.lineTo(-n,n),e.lineTo(-3*n,n),e.closePath()}},Yp=Hp(1/3),Kp=2*Yp,Jp={draw(e,t){const n=Hp(t/Kp),r=n*Yp;e.moveTo(0,-n),e.lineTo(r,0),e.lineTo(0,n),e.lineTo(-r,0),e.closePath()}},Qp={draw(e,t){const n=Hp(t),r=-n/2;e.rect(r,r,n,n)}},$p=Gp(Zp/10)/Gp(7*Zp/10),ef=Gp(qp/10)*$p,tf=-Up(qp/10)*$p,nf={draw(e,t){const n=Hp(.8908130915292852*t),r=ef*n,i=tf*n;e.moveTo(0,-n),e.lineTo(r,i);for(let o=1;o<5;++o){const t=qp*o/5,a=Up(t),s=Gp(t);e.lineTo(s*n,-a*n),e.lineTo(a*r-s*i,s*r+a*i)}e.closePath()}},rf=Hp(3),of={draw(e,t){const n=-Hp(t/(3*rf));e.moveTo(0,2*n),e.lineTo(-rf*n,-n),e.lineTo(rf*n,-n),e.closePath()}},af=-.5,sf=Hp(3)/2,lf=1/Hp(12),cf=3*(lf/2+1),uf={draw(e,t){const n=Hp(t/cf),r=n/2,i=n*lf,o=r,a=n*lf+n,s=-o,l=a;e.moveTo(r,i),e.lineTo(o,a),e.lineTo(s,l),e.lineTo(af*r-sf*i,sf*r+af*i),e.lineTo(af*o-sf*a,sf*o+af*a),e.lineTo(af*s-sf*l,sf*s+af*l),e.lineTo(af*r+sf*i,af*i-sf*r),e.lineTo(af*o+sf*a,af*a-sf*o),e.lineTo(af*s+sf*l,af*l-sf*s),e.closePath()}};function hf(e){return function(){return e}}function df(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var pf,ff,mf,gf,yf,_f,vf,xf,bf,wf,Sf,Tf,Ef,Af;const Mf=Math.PI,Pf=2*Mf,kf=1e-6,Cf=Pf-kf;function jf(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}class If{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==e?jf:function(e){let t=Math.floor(e);if(!(t>=0))throw new Error("invalid digits: ".concat(e));if(t>15)return jf;const n=10**t;return function(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=Math.round(arguments[t]*n)/n+e[t]}}(e)}moveTo(e,t){this._append(pf||(pf=df(["M",",",""])),this._x0=this._x1=+e,this._y0=this._y1=+t)}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append(ff||(ff=df(["Z"]))))}lineTo(e,t){this._append(mf||(mf=df(["L",",",""])),this._x1=+e,this._y1=+t)}quadraticCurveTo(e,t,n,r){this._append(gf||(gf=df(["Q",",",",",",",""])),+e,+t,this._x1=+n,this._y1=+r)}bezierCurveTo(e,t,n,r,i,o){this._append(yf||(yf=df(["C",",",",",",",",",",",""])),+e,+t,+n,+r,this._x1=+i,this._y1=+o)}arcTo(e,t,n,r,i){if(e=+e,t=+t,n=+n,r=+r,(i=+i)<0)throw new Error("negative radius: ".concat(i));let o=this._x1,a=this._y1,s=n-e,l=r-t,c=o-e,u=a-t,h=c*c+u*u;if(null===this._x1)this._append(_f||(_f=df(["M",",",""])),this._x1=e,this._y1=t);else if(h>kf)if(Math.abs(u*s-l*c)>kf&&i){let d=n-o,p=r-a,f=s*s+l*l,m=d*d+p*p,g=Math.sqrt(f),y=Math.sqrt(h),_=i*Math.tan((Mf-Math.acos((f+h-m)/(2*g*y)))/2),v=_/y,x=_/g;Math.abs(v-1)>kf&&this._append(xf||(xf=df(["L",",",""])),e+v*c,t+v*u),this._append(bf||(bf=df(["A",",",",0,0,",",",",",""])),i,i,+(u*d>c*p),this._x1=e+x*s,this._y1=t+x*l)}else this._append(vf||(vf=df(["L",",",""])),this._x1=e,this._y1=t);else;}arc(e,t,n,r,i,o){if(e=+e,t=+t,o=!!o,(n=+n)<0)throw new Error("negative radius: ".concat(n));let a=n*Math.cos(r),s=n*Math.sin(r),l=e+a,c=t+s,u=1^o,h=o?r-i:i-r;null===this._x1?this._append(wf||(wf=df(["M",",",""])),l,c):(Math.abs(this._x1-l)>kf||Math.abs(this._y1-c)>kf)&&this._append(Sf||(Sf=df(["L",",",""])),l,c),n&&(h<0&&(h=h%Pf+Pf),h>Cf?this._append(Tf||(Tf=df(["A",",",",0,1,",",",",","A",",",",0,1,",",",",",""])),n,n,u,e-a,t-s,n,n,u,this._x1=l,this._y1=c):h>kf&&this._append(Ef||(Ef=df(["A",",",",0,",",",",",",",""])),n,n,+(h>=Mf),u,this._x1=e+n*Math.cos(i),this._y1=t+n*Math.sin(i)))}rect(e,t,n,r){this._append(Af||(Af=df(["M",",","h","v","h","Z"])),this._x0=this._x1=+e,this._y0=this._y1=+t,n=+n,+r,-n)}toString(){return this._}}function Of(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(null==n)t=null;else{const e=Math.floor(n);if(!(e>=0))throw new RangeError("invalid digits: ".concat(n));t=e}return e},()=>new If(t)}Hp(3),Hp(3);function Nf(e){return Nf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Nf(e)}var Df=["type","size","sizeType"];function Lf(){return Lf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Lf.apply(this,arguments)}function zf(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Rf(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?zf(Object(n),!0).forEach((function(t){Ff(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zf(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ff(e,t,n){return t=function(e){var t=function(e,t){if("object"!=Nf(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=Nf(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Nf(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Bf(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var Vf={symbolCircle:Wp,symbolCross:Xp,symbolDiamond:Jp,symbolSquare:Qp,symbolStar:nf,symbolTriangle:of,symbolWye:uf},Uf=Math.PI/180,Gf=function(e){var n=e.type,r=void 0===n?"circle":n,i=e.size,o=void 0===i?64:i,a=e.sizeType,s=void 0===a?"area":a,l=Rf(Rf({},Bf(e,Df)),{},{type:r,size:o,sizeType:s}),c=l.className,u=l.cx,h=l.cy,d=Md(l,!0);return u===+u&&h===+h&&o===+o?t.createElement("path",Lf({},d,{className:kh("recharts-symbols",c),transform:"translate(".concat(u,", ").concat(h,")"),d:function(){var e=function(e){var t="symbol".concat(Vp()(e));return Vf[t]||Wp}(r),t=function(e,t){let n=null,r=Of(i);function i(){let i;if(n||(n=i=r()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),i)return n=null,i+""||null}return e="function"===typeof e?e:hf(e||Wp),t="function"===typeof t?t:hf(void 0===t?64:+t),i.type=function(t){return arguments.length?(e="function"===typeof t?t:hf(t),i):e},i.size=function(e){return arguments.length?(t="function"===typeof e?e:hf(+e),i):t},i.context=function(e){return arguments.length?(n=null==e?null:e,i):n},i}().type(e).size(function(e,t,n){if("area"===t)return e;switch(n){case"cross":return 5*e*e/9;case"diamond":return.5*e*e/Math.sqrt(3);case"square":return e*e;case"star":var r=18*Uf;return 1.25*e*e*(Math.tan(r)-Math.tan(2*r)*Math.pow(Math.tan(r),2));case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}}(o,s,r));return t()}()})):null};function Hf(e){return Hf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Hf(e)}function Zf(){return Zf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Zf.apply(this,arguments)}function qf(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Wf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,$f(r.key),r)}}function Xf(e,t,n){return t=Kf(t),function(e,t){if(t&&("object"===Hf(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Yf()?Reflect.construct(t,n||[],Kf(e).constructor):t.apply(e,n))}function Yf(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Yf=function(){return!!e})()}function Kf(e){return Kf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Kf(e)}function Jf(e,t){return Jf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Jf(e,t)}function Qf(e,t,n){return(t=$f(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $f(e){var t=function(e,t){if("object"!=Hf(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=Hf(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Hf(t)?t:t+""}Gf.registerSymbol=function(e,t){Vf["symbol".concat(Vp()(e))]=t};var em=32,tm=function(e){function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),Xf(this,n,arguments)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Jf(e,t)}(n,e),r=n,i=[{key:"renderIcon",value:function(e){var n=this.props.inactiveColor,r=16,i=em/6,o=em/3,a=e.inactive?n:e.color;if("plainline"===e.type)return t.createElement("line",{strokeWidth:4,fill:"none",stroke:a,strokeDasharray:e.payload.strokeDasharray,x1:0,y1:r,x2:em,y2:r,className:"recharts-legend-icon"});if("line"===e.type)return t.createElement("path",{strokeWidth:4,fill:"none",stroke:a,d:"M0,".concat(r,"h").concat(o,"\n            A").concat(i,",").concat(i,",0,1,1,").concat(2*o,",").concat(r,"\n            H").concat(em,"M").concat(2*o,",").concat(r,"\n            A").concat(i,",").concat(i,",0,1,1,").concat(o,",").concat(r),className:"recharts-legend-icon"});if("rect"===e.type)return t.createElement("path",{stroke:"none",fill:a,d:"M0,".concat(4,"h").concat(em,"v").concat(24,"h").concat(-32,"z"),className:"recharts-legend-icon"});if(t.isValidElement(e.legendIcon)){var s=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qf(Object(n),!0).forEach((function(t){Qf(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qf(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e);return delete s.legendIcon,t.cloneElement(e.legendIcon,s)}return t.createElement(Gf,{fill:a,cx:r,cy:r,size:em,sizeType:"diameter",type:e.type})}},{key:"renderItems",value:function(){var e=this,n=this.props,r=n.payload,i=n.iconSize,o=n.layout,a=n.formatter,s=n.inactiveColor,l={x:0,y:0,width:em,height:em},c={display:"horizontal"===o?"inline-block":"block",marginRight:10},u={display:"inline-block",verticalAlign:"middle",marginRight:4};return r.map((function(n,r){var o=n.formatter||a,h=kh(Qf(Qf({"recharts-legend-item":!0},"legend-item-".concat(r),!0),"inactive",n.inactive));if("none"===n.type)return null;var d=ed()(n.value)?null:n.value;Kh(!ed()(n.value),'The name property is also required when using a function for the dataKey of a chart\'s cartesian components. Ex: <Bar name="Name of my Data"/>');var p=n.inactive?s:n.color;return t.createElement("li",Zf({className:h,style:c,key:"legend-item-".concat(r)},hd(e.props,n,r)),t.createElement(Wd,{width:i,height:i,viewBox:l,style:u},e.renderIcon(n)),t.createElement("span",{className:"recharts-legend-item-text",style:{color:p}},o?o(d,n,r):d))}))}},{key:"render",value:function(){var e=this.props,n=e.payload,r=e.layout,i=e.align;if(!n||!n.length)return null;var o={padding:0,margin:0,textAlign:"horizontal"===r?i:"left"};return t.createElement("ul",{className:"recharts-default-legend",style:o},this.renderItems())}}],i&&Wf(r.prototype,i),o&&Wf(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,i,o}(t.PureComponent);function nm(e){return nm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nm(e)}Qf(tm,"displayName","Legend"),Qf(tm,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var rm=["ref"];function im(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function om(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?im(Object(n),!0).forEach((function(t){hm(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):im(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function am(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,dm(r.key),r)}}function sm(e,t,n){return t=cm(t),function(e,t){if(t&&("object"===nm(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,lm()?Reflect.construct(t,n||[],cm(e).constructor):t.apply(e,n))}function lm(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(lm=function(){return!!e})()}function cm(e){return cm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},cm(e)}function um(e,t){return um=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},um(e,t)}function hm(e,t,n){return(t=dm(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function dm(e){var t=function(e,t){if("object"!=nm(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=nm(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==nm(t)?t:t+""}function pm(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function fm(e){return e.value}var mm=function(e){function n(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return hm(e=sm(this,n,[].concat(r)),"lastBoundingBox",{width:-1,height:-1}),e}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&um(e,t)}(n,e),r=n,i=[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var e=this.wrapperNode.getBoundingClientRect();return e.height=this.wrapperNode.offsetHeight,e.width=this.wrapperNode.offsetWidth,e}return null}},{key:"updateBBox",value:function(){var e=this.props.onBBoxUpdate,t=this.getBBox();t?(Math.abs(t.width-this.lastBoundingBox.width)>1||Math.abs(t.height-this.lastBoundingBox.height)>1)&&(this.lastBoundingBox.width=t.width,this.lastBoundingBox.height=t.height,e&&e(t)):-1===this.lastBoundingBox.width&&-1===this.lastBoundingBox.height||(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,e&&e(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?om({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(e){var t,n,r=this.props,i=r.layout,o=r.align,a=r.verticalAlign,s=r.margin,l=r.chartWidth,c=r.chartHeight;return e&&(void 0!==e.left&&null!==e.left||void 0!==e.right&&null!==e.right)||(t="center"===o&&"vertical"===i?{left:((l||0)-this.getBBoxSnapshot().width)/2}:"right"===o?{right:s&&s.right||0}:{left:s&&s.left||0}),e&&(void 0!==e.top&&null!==e.top||void 0!==e.bottom&&null!==e.bottom)||(n="middle"===a?{top:((c||0)-this.getBBoxSnapshot().height)/2}:"bottom"===a?{bottom:s&&s.bottom||0}:{top:s&&s.top||0}),om(om({},t),n)}},{key:"render",value:function(){var e=this,n=this.props,r=n.content,i=n.width,o=n.height,a=n.wrapperStyle,s=n.payloadUniqBy,l=n.payload,c=om(om({position:"absolute",width:i||"auto",height:o||"auto"},this.getDefaultPosition(a)),a);return t.createElement("div",{className:"recharts-legend-wrapper",style:c,ref:function(t){e.wrapperNode=t}},function(e,n){if(t.isValidElement(e))return t.cloneElement(e,n);if("function"===typeof e)return t.createElement(e,n);n.ref;var r=pm(n,rm);return t.createElement(tm,r)}(r,om(om({},this.props),{},{payload:Mp(l,s,fm)})))}}],o=[{key:"getWithHeight",value:function(e,t){var n=om(om({},this.defaultProps),e.props).layout;return"vertical"===n&&Uh(e.props.height)?{height:e.props.height}:"horizontal"===n?{width:e.props.width||t}:null}}],i&&am(r.prototype,i),o&&am(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,i,o}(t.PureComponent);function gm(){return gm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},gm.apply(this,arguments)}hm(mm,"displayName","Legend"),hm(mm,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var ym=function(e){var n=e.cx,r=e.cy,i=e.r,o=e.className,a=kh("recharts-dot",o);return n===+n&&r===+r&&i===+i?t.createElement("circle",gm({},Md(e,!1),ud(e),{className:a,cx:n,cy:r,r:i})):null},_m=n(5173),vm=n.n(_m),xm=Object.getOwnPropertyNames,bm=Object.getOwnPropertySymbols,wm=Object.prototype.hasOwnProperty;function Sm(e,t){return function(n,r,i){return e(n,r,i)&&t(n,r,i)}}function Tm(e){return function(t,n,r){if(!t||!n||"object"!==typeof t||"object"!==typeof n)return e(t,n,r);var i=r.cache,o=i.get(t),a=i.get(n);if(o&&a)return o===n&&a===t;i.set(t,n),i.set(n,t);var s=e(t,n,r);return i.delete(t),i.delete(n),s}}function Em(e){return xm(e).concat(bm(e))}var Am=Object.hasOwn||function(e,t){return wm.call(e,t)};function Mm(e,t){return e===t||!e&&!t&&e!==e&&t!==t}var Pm=Object.getOwnPropertyDescriptor,km=Object.keys;function Cm(e,t,n){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(!n.equals(e[r],t[r],r,r,e,t,n))return!1;return!0}function jm(e,t){return Mm(e.getTime(),t.getTime())}function Im(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function Om(e,t){return e===t}function Nm(e,t,n){var r=e.size;if(r!==t.size)return!1;if(!r)return!0;for(var i,o,a=new Array(r),s=e.entries(),l=0;(i=s.next())&&!i.done;){for(var c=t.entries(),u=!1,h=0;(o=c.next())&&!o.done;)if(a[h])h++;else{var d=i.value,p=o.value;if(n.equals(d[0],p[0],l,h,e,t,n)&&n.equals(d[1],p[1],d[0],p[0],e,t,n)){u=a[h]=!0;break}h++}if(!u)return!1;l++}return!0}var Dm=Mm;function Lm(e,t,n){var r=km(e),i=r.length;if(km(t).length!==i)return!1;for(;i-- >0;)if(!Gm(e,t,n,r[i]))return!1;return!0}function zm(e,t,n){var r,i,o,a=Em(e),s=a.length;if(Em(t).length!==s)return!1;for(;s-- >0;){if(!Gm(e,t,n,r=a[s]))return!1;if(i=Pm(e,r),o=Pm(t,r),(i||o)&&(!i||!o||i.configurable!==o.configurable||i.enumerable!==o.enumerable||i.writable!==o.writable))return!1}return!0}function Rm(e,t){return Mm(e.valueOf(),t.valueOf())}function Fm(e,t){return e.source===t.source&&e.flags===t.flags}function Bm(e,t,n){var r=e.size;if(r!==t.size)return!1;if(!r)return!0;for(var i,o,a=new Array(r),s=e.values();(i=s.next())&&!i.done;){for(var l=t.values(),c=!1,u=0;(o=l.next())&&!o.done;){if(!a[u]&&n.equals(i.value,o.value,i.value,o.value,e,t,n)){c=a[u]=!0;break}u++}if(!c)return!1}return!0}function Vm(e,t){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(e[n]!==t[n])return!1;return!0}function Um(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function Gm(e,t,n,r){return!("_owner"!==r&&"__o"!==r&&"__v"!==r||!e.$$typeof&&!t.$$typeof)||Am(t,r)&&n.equals(e[r],t[r],r,r,e,t,n)}var Hm=Array.isArray,Zm="function"===typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView:null,qm=Object.assign,Wm=Object.prototype.toString.call.bind(Object.prototype.toString);var Xm=Ym();Ym({strict:!0}),Ym({circular:!0}),Ym({circular:!0,strict:!0}),Ym({createInternalComparator:function(){return Mm}}),Ym({strict:!0,createInternalComparator:function(){return Mm}}),Ym({circular:!0,createInternalComparator:function(){return Mm}}),Ym({circular:!0,createInternalComparator:function(){return Mm},strict:!0});function Ym(e){void 0===e&&(e={});var t,n=e.circular,r=void 0!==n&&n,i=e.createInternalComparator,o=e.createState,a=e.strict,s=void 0!==a&&a,l=function(e){var t=e.circular,n=e.createCustomConfig,r=e.strict,i={areArraysEqual:r?zm:Cm,areDatesEqual:jm,areErrorsEqual:Im,areFunctionsEqual:Om,areMapsEqual:r?Sm(Nm,zm):Nm,areNumbersEqual:Dm,areObjectsEqual:r?zm:Lm,arePrimitiveWrappersEqual:Rm,areRegExpsEqual:Fm,areSetsEqual:r?Sm(Bm,zm):Bm,areTypedArraysEqual:r?zm:Vm,areUrlsEqual:Um};if(n&&(i=qm({},i,n(i))),t){var o=Tm(i.areArraysEqual),a=Tm(i.areMapsEqual),s=Tm(i.areObjectsEqual),l=Tm(i.areSetsEqual);i=qm({},i,{areArraysEqual:o,areMapsEqual:a,areObjectsEqual:s,areSetsEqual:l})}return i}(e),c=function(e){var t=e.areArraysEqual,n=e.areDatesEqual,r=e.areErrorsEqual,i=e.areFunctionsEqual,o=e.areMapsEqual,a=e.areNumbersEqual,s=e.areObjectsEqual,l=e.arePrimitiveWrappersEqual,c=e.areRegExpsEqual,u=e.areSetsEqual,h=e.areTypedArraysEqual,d=e.areUrlsEqual;return function(e,p,f){if(e===p)return!0;if(null==e||null==p)return!1;var m=typeof e;if(m!==typeof p)return!1;if("object"!==m)return"number"===m?a(e,p,f):"function"===m&&i(e,p,f);var g=e.constructor;if(g!==p.constructor)return!1;if(g===Object)return s(e,p,f);if(Hm(e))return t(e,p,f);if(null!=Zm&&Zm(e))return h(e,p,f);if(g===Date)return n(e,p,f);if(g===RegExp)return c(e,p,f);if(g===Map)return o(e,p,f);if(g===Set)return u(e,p,f);var y=Wm(e);return"[object Date]"===y?n(e,p,f):"[object RegExp]"===y?c(e,p,f):"[object Map]"===y?o(e,p,f):"[object Set]"===y?u(e,p,f):"[object Object]"===y?"function"!==typeof e.then&&"function"!==typeof p.then&&s(e,p,f):"[object URL]"===y?d(e,p,f):"[object Error]"===y?r(e,p,f):"[object Arguments]"===y?s(e,p,f):("[object Boolean]"===y||"[object Number]"===y||"[object String]"===y)&&l(e,p,f)}}(l),u=i?i(c):(t=c,function(e,n,r,i,o,a,s){return t(e,n,s)});return function(e){var t=e.circular,n=e.comparator,r=e.createState,i=e.equals,o=e.strict;if(r)return function(e,a){var s=r(),l=s.cache,c=void 0===l?t?new WeakMap:void 0:l,u=s.meta;return n(e,a,{cache:c,equals:i,meta:u,strict:o})};if(t)return function(e,t){return n(e,t,{cache:new WeakMap,equals:i,meta:void 0,strict:o})};var a={cache:void 0,equals:i,meta:void 0,strict:o};return function(e,t){return n(e,t,a)}}({circular:r,comparator:c,createState:o,equals:u,strict:s})}function Km(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=-1;requestAnimationFrame((function r(i){n<0&&(n=i),i-n>t?(e(i),n=-1):function(e){"undefined"!==typeof requestAnimationFrame&&requestAnimationFrame(e)}(r)}))}function Jm(e){return Jm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Jm(e)}function Qm(e){return function(e){if(Array.isArray(e))return e}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return $m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $m(e,t)}(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function eg(){var e=function(){return null},t=!1,n=function n(r){if(!t){if(Array.isArray(r)){if(!r.length)return;var i=Qm(r),o=i[0],a=i.slice(1);return"number"===typeof o?void Km(n.bind(null,a),o):(n(o),void Km(n.bind(null,a)))}"object"===Jm(r)&&e(r),"function"===typeof r&&r()}};return{stop:function(){t=!0},start:function(e){t=!1,n(e)},subscribe:function(t){return e=t,function(){e=function(){return null}}}}}function tg(e){return tg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tg(e)}function ng(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function rg(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ng(Object(n),!0).forEach((function(t){ig(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ng(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ig(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==tg(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==tg(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===tg(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var og=function(e){return e},ag=function(e,t){return Object.keys(t).reduce((function(n,r){return rg(rg({},n),{},ig({},r,e(r,t[r])))}),{})},sg=function(e,t,n){return e.map((function(e){return"".concat((r=e,r.replace(/([A-Z])/g,(function(e){return"-".concat(e.toLowerCase())})))," ").concat(t,"ms ").concat(n);var r})).join(",")};function lg(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],l=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){c=!0,i=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw i}}return s}}(e,t)||ug(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function cg(e){return function(e){if(Array.isArray(e))return hg(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||ug(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ug(e,t){if(e){if("string"===typeof e)return hg(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?hg(e,t):void 0}}function hg(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var dg=1e-4,pg=function(e,t){return[0,3*e,3*t-6*e,3*e-3*t+1]},fg=function(e,t){return e.map((function(e,n){return e*Math.pow(t,n)})).reduce((function(e,t){return e+t}))},mg=function(e,t){return function(n){var r=pg(e,t);return fg(r,n)}},gg=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t[0],i=t[1],o=t[2],a=t[3];if(1===t.length)switch(t[0]){case"linear":r=0,i=0,o=1,a=1;break;case"ease":r=.25,i=.1,o=.25,a=1;break;case"ease-in":r=.42,i=0,o=1,a=1;break;case"ease-out":r=.42,i=0,o=.58,a=1;break;case"ease-in-out":r=0,i=0,o=.58,a=1;break;default:var s=t[0].split("(");if("cubic-bezier"===s[0]&&4===s[1].split(")")[0].split(",").length){var l=lg(s[1].split(")")[0].split(",").map((function(e){return parseFloat(e)})),4);r=l[0],i=l[1],o=l[2],a=l[3]}}[r,o,i,a].every((function(e){return"number"===typeof e&&e>=0&&e<=1}));var c,u,h=mg(r,o),d=mg(i,a),p=(c=r,u=o,function(e){var t=pg(c,u),n=[].concat(cg(t.map((function(e,t){return e*t})).slice(1)),[0]);return fg(n,e)}),f=function(e){return e>1?1:e<0?0:e},m=function(e){for(var t=e>1?1:e,n=t,r=0;r<8;++r){var i=h(n)-t,o=p(n);if(Math.abs(i-t)<dg||o<dg)return d(n);n=f(n-i/o)}return d(n)};return m.isStepper=!1,m},yg=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t[0];if("string"===typeof r)switch(r){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return gg(r);case"spring":return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.stiff,n=void 0===t?100:t,r=e.damping,i=void 0===r?8:r,o=e.dt,a=void 0===o?17:o,s=function(e,t,r){var o=r+(-(e-t)*n-r*i)*a/1e3,s=r*a/1e3+e;return Math.abs(s-t)<dg&&Math.abs(o)<dg?[t,0]:[s,o]};return s.isStepper=!0,s.dt=a,s}();default:if("cubic-bezier"===r.split("(")[0])return gg(r)}return"function"===typeof r?r:null};function _g(e){return _g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_g(e)}function vg(e){return function(e){if(Array.isArray(e))return Eg(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Tg(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xg(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function bg(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xg(Object(n),!0).forEach((function(t){wg(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xg(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function wg(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==_g(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==_g(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===_g(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Sg(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],l=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){c=!0,i=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw i}}return s}}(e,t)||Tg(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Tg(e,t){if(e){if("string"===typeof e)return Eg(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Eg(e,t):void 0}}function Eg(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ag=function(e,t,n){return e+(t-e)*n},Mg=function(e){return e.from!==e.to},Pg=function e(t,n,r){var i=ag((function(e,n){if(Mg(n)){var r=Sg(t(n.from,n.to,n.velocity),2),i=r[0],o=r[1];return bg(bg({},n),{},{from:i,velocity:o})}return n}),n);return r<1?ag((function(e,t){return Mg(t)?bg(bg({},t),{},{velocity:Ag(t.velocity,i[e].velocity,r),from:Ag(t.from,i[e].from,r)}):t}),n):e(t,i,r-1)};const kg=function(e,t,n,r,i){var o,a,s,l,c=(o=e,a=t,[Object.keys(o),Object.keys(a)].reduce((function(e,t){return e.filter((function(e){return t.includes(e)}))}))),u=c.reduce((function(n,r){return bg(bg({},n),{},wg({},r,[e[r],t[r]]))}),{}),h=c.reduce((function(n,r){return bg(bg({},n),{},wg({},r,{from:e[r],velocity:0,to:t[r]}))}),{}),d=-1,p=function(){return null};return p=n.isStepper?function(r){s||(s=r);var o=(r-s)/n.dt;h=Pg(n,h,o),i(bg(bg(bg({},e),t),ag((function(e,t){return t.from}),h))),s=r,Object.values(h).filter(Mg).length&&(d=requestAnimationFrame(p))}:function(o){l||(l=o);var a=(o-l)/r,s=ag((function(e,t){return Ag.apply(void 0,vg(t).concat([n(a)]))}),u);if(i(bg(bg(bg({},e),t),s)),a<1)d=requestAnimationFrame(p);else{var c=ag((function(e,t){return Ag.apply(void 0,vg(t).concat([n(1)]))}),u);i(bg(bg(bg({},e),t),c))}},function(){return requestAnimationFrame(p),function(){cancelAnimationFrame(d)}}};function Cg(e){return Cg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Cg(e)}var jg=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function Ig(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Og(e){return function(e){if(Array.isArray(e))return Ng(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return Ng(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ng(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ng(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Dg(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Lg(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Dg(Object(n),!0).forEach((function(t){zg(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Dg(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function zg(e,t,n){return(t=Fg(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Rg(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Fg(r.key),r)}}function Fg(e){var t=function(e,t){if("object"!==Cg(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Cg(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Cg(t)?t:String(t)}function Bg(e,t){return Bg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Bg(e,t)}function Vg(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(KL){return!1}}();return function(){var n,r=Hg(e);if(t){var i=Hg(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ug(this,n)}}function Ug(e,t){if(t&&("object"===Cg(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Gg(e)}function Gg(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Hg(e){return Hg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Hg(e)}var Zg=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Bg(e,t)}(a,e);var n,r,i,o=Vg(a);function a(e,t){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a);var r=(n=o.call(this,e,t)).props,i=r.isActive,s=r.attributeName,l=r.from,c=r.to,u=r.steps,h=r.children,d=r.duration;if(n.handleStyleChange=n.handleStyleChange.bind(Gg(n)),n.changeStyle=n.changeStyle.bind(Gg(n)),!i||d<=0)return n.state={style:{}},"function"===typeof h&&(n.state={style:c}),Ug(n);if(u&&u.length)n.state={style:u[0].style};else if(l){if("function"===typeof h)return n.state={style:l},Ug(n);n.state={style:s?zg({},s,l):l}}else n.state={style:{}};return n}return n=a,r=[{key:"componentDidMount",value:function(){var e=this.props,t=e.isActive,n=e.canBegin;this.mounted=!0,t&&n&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.isActive,r=t.canBegin,i=t.attributeName,o=t.shouldReAnimate,a=t.to,s=t.from,l=this.state.style;if(r)if(n){if(!(Xm(e.to,a)&&e.canBegin&&e.isActive)){var c=!e.canBegin||!e.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var u=c||o?s:e.to;if(this.state&&l){var h={style:i?zg({},i,u):u};(i&&l[i]!==u||!i&&l!==u)&&this.setState(h)}this.runAnimation(Lg(Lg({},this.props),{},{from:u,begin:0}))}}else{var d={style:i?zg({},i,a):a};this.state&&l&&(i&&l[i]!==a||!i&&l!==a)&&this.setState(d)}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var e=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),e&&e()}},{key:"handleStyleChange",value:function(e){this.changeStyle(e)}},{key:"changeStyle",value:function(e){this.mounted&&this.setState({style:e})}},{key:"runJSAnimation",value:function(e){var t=this,n=e.from,r=e.to,i=e.duration,o=e.easing,a=e.begin,s=e.onAnimationEnd,l=e.onAnimationStart,c=kg(n,r,yg(o),i,this.changeStyle);this.manager.start([l,a,function(){t.stopJSAnimation=c()},i,s])}},{key:"runStepAnimation",value:function(e){var t=this,n=e.steps,r=e.begin,i=e.onAnimationStart,o=n[0],a=o.style,s=o.duration,l=void 0===s?0:s;return this.manager.start([i].concat(Og(n.reduce((function(e,r,i){if(0===i)return e;var o=r.duration,a=r.easing,s=void 0===a?"ease":a,l=r.style,c=r.properties,u=r.onAnimationEnd,h=i>0?n[i-1]:r,d=c||Object.keys(l);if("function"===typeof s||"spring"===s)return[].concat(Og(e),[t.runJSAnimation.bind(t,{from:h.style,to:l,duration:o,easing:s}),o]);var p=sg(d,o,s),f=Lg(Lg(Lg({},h.style),l),{},{transition:p});return[].concat(Og(e),[f,o,u]).filter(og)}),[a,Math.max(l,r)])),[e.onAnimationEnd]))}},{key:"runAnimation",value:function(e){this.manager||(this.manager=eg());var t=e.begin,n=e.duration,r=e.attributeName,i=e.to,o=e.easing,a=e.onAnimationStart,s=e.onAnimationEnd,l=e.steps,c=e.children,u=this.manager;if(this.unSubscribe=u.subscribe(this.handleStyleChange),"function"!==typeof o&&"function"!==typeof c&&"spring"!==o)if(l.length>1)this.runStepAnimation(e);else{var h=r?zg({},r,i):i,d=sg(Object.keys(h),n,o);u.start([a,t,Lg(Lg({},h),{},{transition:d}),n,s])}else this.runJSAnimation(e)}},{key:"render",value:function(){var e=this.props,n=e.children,r=(e.begin,e.duration),i=(e.attributeName,e.easing,e.isActive),o=(e.steps,e.from,e.to,e.canBegin,e.onAnimationEnd,e.shouldReAnimate,e.onAnimationReStart,Ig(e,jg)),a=t.Children.count(n),s=this.state.style;if("function"===typeof n)return n(s);if(!i||0===a||r<=0)return n;var l=function(e){var n=e.props,r=n.style,i=void 0===r?{}:r,a=n.className;return(0,t.cloneElement)(e,Lg(Lg({},o),{},{style:Lg(Lg({},i),s),className:a}))};return 1===a?l(t.Children.only(n)):t.createElement("div",null,t.Children.map(n,(function(e){return l(e)})))}}],r&&Rg(n.prototype,r),i&&Rg(n,i),Object.defineProperty(n,"prototype",{writable:!1}),a}(t.PureComponent);Zg.displayName="Animate",Zg.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}},Zg.propTypes={from:vm().oneOfType([vm().object,vm().string]),to:vm().oneOfType([vm().object,vm().string]),attributeName:vm().string,duration:vm().number,begin:vm().number,easing:vm().oneOfType([vm().string,vm().func]),steps:vm().arrayOf(vm().shape({duration:vm().number.isRequired,style:vm().object.isRequired,easing:vm().oneOfType([vm().oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),vm().func]),properties:vm().arrayOf("string"),onAnimationEnd:vm().func})),children:vm().oneOfType([vm().node,vm().func]),isActive:vm().bool,canBegin:vm().bool,onAnimationEnd:vm().func,shouldReAnimate:vm().bool,onAnimationStart:vm().func,onAnimationReStart:vm().func};const qg=Zg;function Wg(e){return Wg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wg(e)}function Xg(){return Xg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Xg.apply(this,arguments)}function Yg(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],l=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){c=!0,i=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw i}}return s}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return Kg(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Kg(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Kg(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Jg(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Qg(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Jg(Object(n),!0).forEach((function(t){$g(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Jg(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function $g(e,t,n){return t=function(e){var t=function(e,t){if("object"!=Wg(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=Wg(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Wg(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ey=function(e,t,n,r,i){var o,a=Math.min(Math.abs(n)/2,Math.abs(r)/2),s=r>=0?1:-1,l=n>=0?1:-1,c=r>=0&&n>=0||r<0&&n<0?1:0;if(a>0&&i instanceof Array){for(var u=[0,0,0,0],h=0;h<4;h++)u[h]=i[h]>a?a:i[h];o="M".concat(e,",").concat(t+s*u[0]),u[0]>0&&(o+="A ".concat(u[0],",").concat(u[0],",0,0,").concat(c,",").concat(e+l*u[0],",").concat(t)),o+="L ".concat(e+n-l*u[1],",").concat(t),u[1]>0&&(o+="A ".concat(u[1],",").concat(u[1],",0,0,").concat(c,",\n        ").concat(e+n,",").concat(t+s*u[1])),o+="L ".concat(e+n,",").concat(t+r-s*u[2]),u[2]>0&&(o+="A ".concat(u[2],",").concat(u[2],",0,0,").concat(c,",\n        ").concat(e+n-l*u[2],",").concat(t+r)),o+="L ".concat(e+l*u[3],",").concat(t+r),u[3]>0&&(o+="A ".concat(u[3],",").concat(u[3],",0,0,").concat(c,",\n        ").concat(e,",").concat(t+r-s*u[3])),o+="Z"}else if(a>0&&i===+i&&i>0){var d=Math.min(a,i);o="M ".concat(e,",").concat(t+s*d,"\n            A ").concat(d,",").concat(d,",0,0,").concat(c,",").concat(e+l*d,",").concat(t,"\n            L ").concat(e+n-l*d,",").concat(t,"\n            A ").concat(d,",").concat(d,",0,0,").concat(c,",").concat(e+n,",").concat(t+s*d,"\n            L ").concat(e+n,",").concat(t+r-s*d,"\n            A ").concat(d,",").concat(d,",0,0,").concat(c,",").concat(e+n-l*d,",").concat(t+r,"\n            L ").concat(e+l*d,",").concat(t+r,"\n            A ").concat(d,",").concat(d,",0,0,").concat(c,",").concat(e,",").concat(t+r-s*d," Z")}else o="M ".concat(e,",").concat(t," h ").concat(n," v ").concat(r," h ").concat(-n," Z");return o},ty=function(e,t){if(!e||!t)return!1;var n=e.x,r=e.y,i=t.x,o=t.y,a=t.width,s=t.height;if(Math.abs(a)>0&&Math.abs(s)>0){var l=Math.min(i,i+a),c=Math.max(i,i+a),u=Math.min(o,o+s),h=Math.max(o,o+s);return n>=l&&n<=c&&r>=u&&r<=h}return!1},ny={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},ry=function(e){var n=Qg(Qg({},ny),e),r=(0,t.useRef)(),i=Yg((0,t.useState)(-1),2),o=i[0],a=i[1];(0,t.useEffect)((function(){if(r.current&&r.current.getTotalLength)try{var e=r.current.getTotalLength();e&&a(e)}catch(t){}}),[]);var s=n.x,l=n.y,c=n.width,u=n.height,h=n.radius,d=n.className,p=n.animationEasing,f=n.animationDuration,m=n.animationBegin,g=n.isAnimationActive,y=n.isUpdateAnimationActive;if(s!==+s||l!==+l||c!==+c||u!==+u||0===c||0===u)return null;var _=kh("recharts-rectangle",d);return y?t.createElement(qg,{canBegin:o>0,from:{width:c,height:u,x:s,y:l},to:{width:c,height:u,x:s,y:l},duration:f,animationEasing:p,isActive:y},(function(e){var i=e.width,a=e.height,s=e.x,l=e.y;return t.createElement(qg,{canBegin:o>0,from:"0px ".concat(-1===o?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:m,duration:f,isActive:g,easing:p},t.createElement("path",Xg({},Md(n,!0),{className:_,d:ey(s,l,i,a,h),ref:r})))})):t.createElement("path",Xg({},Md(n,!0),{className:_,d:ey(s,l,c,u,h)}))};function iy(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}function oy(e,t){switch(arguments.length){case 0:break;case 1:"function"===typeof e?this.interpolator(e):this.range(e);break;default:this.domain(e),"function"===typeof t?this.interpolator(t):this.range(t)}return this}class ay extends Map{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:uy;if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(const[n,r]of e)this.set(n,r)}get(e){return super.get(sy(this,e))}has(e){return super.has(sy(this,e))}set(e,t){return super.set(ly(this,e),t)}delete(e){return super.delete(cy(this,e))}}Set;function sy(e,t){let{_intern:n,_key:r}=e;const i=r(t);return n.has(i)?n.get(i):t}function ly(e,t){let{_intern:n,_key:r}=e;const i=r(t);return n.has(i)?n.get(i):(n.set(i,t),t)}function cy(e,t){let{_intern:n,_key:r}=e;const i=r(t);return n.has(i)&&(t=n.get(i),n.delete(i)),t}function uy(e){return null!==e&&"object"===typeof e?e.valueOf():e}const hy=Symbol("implicit");function dy(){var e=new ay,t=[],n=[],r=hy;function i(i){let o=e.get(i);if(void 0===o){if(r!==hy)return r;e.set(i,o=t.push(i)-1)}return n[o%n.length]}return i.domain=function(n){if(!arguments.length)return t.slice();t=[],e=new ay;for(const r of n)e.has(r)||e.set(r,t.push(r)-1);return i},i.range=function(e){return arguments.length?(n=Array.from(e),i):n.slice()},i.unknown=function(e){return arguments.length?(r=e,i):r},i.copy=function(){return dy(t,n).unknown(r)},iy.apply(i,arguments),i}function py(){var e,t,n=dy().unknown(void 0),r=n.domain,i=n.range,o=0,a=1,s=!1,l=0,c=0,u=.5;function h(){var n=r().length,h=a<o,d=h?a:o,p=h?o:a;e=(p-d)/Math.max(1,n-l+2*c),s&&(e=Math.floor(e)),d+=(p-d-e*(n-l))*u,t=e*(1-l),s&&(d=Math.round(d),t=Math.round(t));var f=function(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((t-e)/n)),o=new Array(i);++r<i;)o[r]=e+r*n;return o}(n).map((function(t){return d+e*t}));return i(h?f.reverse():f)}return delete n.unknown,n.domain=function(e){return arguments.length?(r(e),h()):r()},n.range=function(e){return arguments.length?([o,a]=e,o=+o,a=+a,h()):[o,a]},n.rangeRound=function(e){return[o,a]=e,o=+o,a=+a,s=!0,h()},n.bandwidth=function(){return t},n.step=function(){return e},n.round=function(e){return arguments.length?(s=!!e,h()):s},n.padding=function(e){return arguments.length?(l=Math.min(1,c=+e),h()):l},n.paddingInner=function(e){return arguments.length?(l=Math.min(1,e),h()):l},n.paddingOuter=function(e){return arguments.length?(c=+e,h()):c},n.align=function(e){return arguments.length?(u=Math.max(0,Math.min(1,e)),h()):u},n.copy=function(){return py(r(),[o,a]).round(s).paddingInner(l).paddingOuter(c).align(u)},iy.apply(h(),arguments)}function fy(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return fy(t())},e}function my(){return fy(py.apply(null,arguments).paddingInner(1))}function gy(e){return gy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gy(e)}function yy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?yy(Object(n),!0).forEach((function(t){vy(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yy(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function vy(e,t,n){return t=function(e){var t=function(e,t){if("object"!=gy(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=gy(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==gy(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var xy={widthCache:{},cacheCount:0},by={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},wy="recharts_measurement_span";var Sy=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(void 0===e||null===e||Tp.isSsr)return{width:0,height:0};var n=function(e){var t=_y({},e);return Object.keys(t).forEach((function(e){t[e]||delete t[e]})),t}(t),r=JSON.stringify({text:e,copyStyle:n});if(xy.widthCache[r])return xy.widthCache[r];try{var i=document.getElementById(wy);i||((i=document.createElement("span")).setAttribute("id",wy),i.setAttribute("aria-hidden","true"),document.body.appendChild(i));var o=_y(_y({},by),n);Object.assign(i.style,o),i.textContent="".concat(e);var a=i.getBoundingClientRect(),s={width:a.width,height:a.height};return xy.widthCache[r]=s,++xy.cacheCount>2e3&&(xy.cacheCount=0,xy.widthCache={}),s}catch(KL){return{width:0,height:0}}};function Ty(e){return Ty="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ty(e)}function Ey(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],l=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){c=!0,i=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw i}}return s}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return Ay(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ay(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ay(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function My(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Py(r.key),r)}}function Py(e){var t=function(e,t){if("object"!=Ty(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=Ty(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Ty(t)?t:t+""}var ky=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,Cy=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,jy=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,Iy=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,Oy={cm:96/2.54,mm:96/25.4,pt:96/72,pc:16,in:96,Q:96/101.6,px:1},Ny=Object.keys(Oy),Dy="NaN";var Ly=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.num=t,this.unit=n,this.num=t,this.unit=n,Number.isNaN(t)&&(this.unit=""),""===n||jy.test(n)||(this.num=NaN,this.unit=""),Ny.includes(n)&&(this.num=function(e,t){return e*Oy[t]}(t,n),this.unit="px")}return t=e,r=[{key:"parse",value:function(t){var n,r=Ey(null!==(n=Iy.exec(t))&&void 0!==n?n:[],3),i=r[1],o=r[2];return new e(parseFloat(i),null!==o&&void 0!==o?o:"")}}],(n=[{key:"add",value:function(t){return this.unit!==t.unit?new e(NaN,""):new e(this.num+t.num,this.unit)}},{key:"subtract",value:function(t){return this.unit!==t.unit?new e(NaN,""):new e(this.num-t.num,this.unit)}},{key:"multiply",value:function(t){return""!==this.unit&&""!==t.unit&&this.unit!==t.unit?new e(NaN,""):new e(this.num*t.num,this.unit||t.unit)}},{key:"divide",value:function(t){return""!==this.unit&&""!==t.unit&&this.unit!==t.unit?new e(NaN,""):new e(this.num/t.num,this.unit||t.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}])&&My(t.prototype,n),r&&My(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,r}();function zy(e){if(e.includes(Dy))return Dy;for(var t=e;t.includes("*")||t.includes("/");){var n,r=Ey(null!==(n=ky.exec(t))&&void 0!==n?n:[],4),i=r[1],o=r[2],a=r[3],s=Ly.parse(null!==i&&void 0!==i?i:""),l=Ly.parse(null!==a&&void 0!==a?a:""),c="*"===o?s.multiply(l):s.divide(l);if(c.isNaN())return Dy;t=t.replace(ky,c.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var u,h=Ey(null!==(u=Cy.exec(t))&&void 0!==u?u:[],4),d=h[1],p=h[2],f=h[3],m=Ly.parse(null!==d&&void 0!==d?d:""),g=Ly.parse(null!==f&&void 0!==f?f:""),y="+"===p?m.add(g):m.subtract(g);if(y.isNaN())return Dy;t=t.replace(Cy,y.toString())}return t}var Ry=/\(([^()]*)\)/;function Fy(e){var t=e.replace(/\s+/g,"");return t=function(e){for(var t=e;t.includes("(");){var n=Ey(Ry.exec(t),2)[1];t=t.replace(Ry,zy(n))}return t}(t),t=zy(t)}function By(e){var t=function(e){try{return Fy(e)}catch(KL){return Dy}}(e.slice(5,-1));return t===Dy?"":t}var Vy=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],Uy=["dx","dy","angle","className","breakAll"];function Gy(){return Gy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Gy.apply(this,arguments)}function Hy(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Zy(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],l=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){c=!0,i=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw i}}return s}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return qy(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return qy(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function qy(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Wy=/[ \f\n\r\t\v\u2028\u2029]+/,Xy=function(e){var t=e.children,n=e.breakAll,r=e.style;try{var i=[];return Qh()(t)||(i=n?t.toString().split(""):t.toString().split(Wy)),{wordsWithComputedWidth:i.map((function(e){return{word:e,width:Sy(e,r).width}})),spaceWidth:n?0:Sy("\xa0",r).width}}catch(KL){return null}},Yy=function(e){return[{words:Qh()(e)?[]:e.toString().split(Wy)}]},Ky=function(e){var t=e.width,n=e.scaleToFit,r=e.children,i=e.style,o=e.breakAll,a=e.maxLines;if((t||n)&&!Tp.isSsr){var s=Xy({breakAll:o,children:r,style:i});return s?function(e,t,n,r,i){var o=e.maxLines,a=e.children,s=e.style,l=e.breakAll,c=Uh(o),u=a,h=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).reduce((function(e,t){var o=t.word,a=t.width,s=e[e.length-1];if(s&&(null==r||i||s.width+a+n<Number(r)))s.words.push(o),s.width+=a+n;else{var l={words:[o],width:a};e.push(l)}return e}),[])},d=h(t);if(!c)return d;for(var p,f=function(e){var t=u.slice(0,e),n=Xy({breakAll:l,style:s,children:t+"\u2026"}).wordsWithComputedWidth,i=h(n),a=i.length>o||function(e){return e.reduce((function(e,t){return e.width>t.width?e:t}))}(i).width>Number(r);return[a,i]},m=0,g=u.length-1,y=0;m<=g&&y<=u.length-1;){var _=Math.floor((m+g)/2),v=Zy(f(_-1),2),x=v[0],b=v[1],w=Zy(f(_),1)[0];if(x||w||(m=_+1),x&&w&&(g=_-1),!x&&w){p=b;break}y++}return p||d}({breakAll:o,children:r,maxLines:a,style:i},s.wordsWithComputedWidth,s.spaceWidth,t,n):Yy(r)}return Yy(r)},Jy="#808080",Qy=function(e){var n=e.x,r=void 0===n?0:n,i=e.y,o=void 0===i?0:i,a=e.lineHeight,s=void 0===a?"1em":a,l=e.capHeight,c=void 0===l?"0.71em":l,u=e.scaleToFit,h=void 0!==u&&u,d=e.textAnchor,p=void 0===d?"start":d,f=e.verticalAnchor,m=void 0===f?"end":f,g=e.fill,y=void 0===g?Jy:g,_=Hy(e,Vy),v=(0,t.useMemo)((function(){return Ky({breakAll:_.breakAll,children:_.children,maxLines:_.maxLines,scaleToFit:h,style:_.style,width:_.width})}),[_.breakAll,_.children,_.maxLines,h,_.style,_.width]),x=_.dx,b=_.dy,w=_.angle,S=_.className,T=_.breakAll,E=Hy(_,Uy);if(!Gh(r)||!Gh(o))return null;var A,M=r+(Uh(x)?x:0),P=o+(Uh(b)?b:0);switch(m){case"start":A=By("calc(".concat(c,")"));break;case"middle":A=By("calc(".concat((v.length-1)/2," * -").concat(s," + (").concat(c," / 2))"));break;default:A=By("calc(".concat(v.length-1," * -").concat(s,")"))}var k=[];if(h){var C=v[0].width,j=_.width;k.push("scale(".concat((Uh(j)?j/C:1)/C,")"))}return w&&k.push("rotate(".concat(w,", ").concat(M,", ").concat(P,")")),k.length&&(E.transform=k.join(" ")),t.createElement("text",Gy({},Md(E,!0),{x:M,y:P,className:kh("recharts-text",S),textAnchor:p,fill:y.includes("url")?Jy:y}),v.map((function(e,n){var r=e.words.join(T?"":" ");return t.createElement("tspan",{x:M,dy:0===n?A:s,key:"".concat(r,"-").concat(n)},r)})))};const $y=Math.sqrt(50),e_=Math.sqrt(10),t_=Math.sqrt(2);function n_(e,t,n){const r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),o=r/Math.pow(10,i),a=o>=$y?10:o>=e_?5:o>=t_?2:1;let s,l,c;return i<0?(c=Math.pow(10,-i)/a,s=Math.round(e*c),l=Math.round(t*c),s/c<e&&++s,l/c>t&&--l,c=-c):(c=Math.pow(10,i)*a,s=Math.round(e/c),l=Math.round(t/c),s*c<e&&++s,l*c>t&&--l),l<s&&.5<=n&&n<2?n_(e,t,2*n):[s,l,c]}function r_(e,t,n){if(!((n=+n)>0))return[];if((e=+e)===(t=+t))return[e];const r=t<e,[i,o,a]=r?n_(t,e,n):n_(e,t,n);if(!(o>=i))return[];const s=o-i+1,l=new Array(s);if(r)if(a<0)for(let c=0;c<s;++c)l[c]=(o-c)/-a;else for(let c=0;c<s;++c)l[c]=(o-c)*a;else if(a<0)for(let c=0;c<s;++c)l[c]=(i+c)/-a;else for(let c=0;c<s;++c)l[c]=(i+c)*a;return l}function i_(e,t,n){return n_(e=+e,t=+t,n=+n)[2]}function o_(e,t,n){n=+n;const r=(t=+t)<(e=+e),i=r?i_(t,e,n):i_(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}function a_(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function s_(e,t){return null==e||null==t?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function l_(e){let t,n,r;function i(e,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;if(i<o){if(0!==t(r,r))return o;do{const t=i+o>>>1;n(e[t],r)<0?i=t+1:o=t}while(i<o)}return i}return 2!==e.length?(t=a_,n=(t,n)=>a_(e(t),n),r=(t,n)=>e(t)-n):(t=e===a_||e===s_?e:c_,n=e,r=e),{left:i,center:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const o=i(e,t,n,(arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length)-1);return o>n&&r(e[o-1],t)>-r(e[o],t)?o-1:o},right:function(e,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;if(i<o){if(0!==t(r,r))return o;do{const t=i+o>>>1;n(e[t],r)<=0?i=t+1:o=t}while(i<o)}return i}}}function c_(){return 0}function u_(e){return null===e?NaN:+e}const h_=l_(a_),d_=h_.right,p_=(h_.left,l_(u_).center,d_);function f_(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function m_(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function g_(){}var y_=.7,__=1/y_,v_="\\s*([+-]?\\d+)\\s*",x_="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",b_="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",w_=/^#([0-9a-f]{3,8})$/,S_=new RegExp("^rgb\\(".concat(v_,",").concat(v_,",").concat(v_,"\\)$")),T_=new RegExp("^rgb\\(".concat(b_,",").concat(b_,",").concat(b_,"\\)$")),E_=new RegExp("^rgba\\(".concat(v_,",").concat(v_,",").concat(v_,",").concat(x_,"\\)$")),A_=new RegExp("^rgba\\(".concat(b_,",").concat(b_,",").concat(b_,",").concat(x_,"\\)$")),M_=new RegExp("^hsl\\(".concat(x_,",").concat(b_,",").concat(b_,"\\)$")),P_=new RegExp("^hsla\\(".concat(x_,",").concat(b_,",").concat(b_,",").concat(x_,"\\)$")),k_={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function C_(){return this.rgb().formatHex()}function j_(){return this.rgb().formatRgb()}function I_(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=w_.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?O_(t):3===n?new L_(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?N_(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?N_(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=S_.exec(e))?new L_(t[1],t[2],t[3],1):(t=T_.exec(e))?new L_(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=E_.exec(e))?N_(t[1],t[2],t[3],t[4]):(t=A_.exec(e))?N_(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=M_.exec(e))?U_(t[1],t[2]/100,t[3]/100,1):(t=P_.exec(e))?U_(t[1],t[2]/100,t[3]/100,t[4]):k_.hasOwnProperty(e)?O_(k_[e]):"transparent"===e?new L_(NaN,NaN,NaN,0):null}function O_(e){return new L_(e>>16&255,e>>8&255,255&e,1)}function N_(e,t,n,r){return r<=0&&(e=t=n=NaN),new L_(e,t,n,r)}function D_(e,t,n,r){return 1===arguments.length?((i=e)instanceof g_||(i=I_(i)),i?new L_((i=i.rgb()).r,i.g,i.b,i.opacity):new L_):new L_(e,t,n,null==r?1:r);var i}function L_(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function z_(){return"#".concat(V_(this.r)).concat(V_(this.g)).concat(V_(this.b))}function R_(){const e=F_(this.opacity);return"".concat(1===e?"rgb(":"rgba(").concat(B_(this.r),", ").concat(B_(this.g),", ").concat(B_(this.b)).concat(1===e?")":", ".concat(e,")"))}function F_(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function B_(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function V_(e){return((e=B_(e))<16?"0":"")+e.toString(16)}function U_(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new H_(e,t,n,r)}function G_(e){if(e instanceof H_)return new H_(e.h,e.s,e.l,e.opacity);if(e instanceof g_||(e=I_(e)),!e)return new H_;if(e instanceof H_)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),o=Math.max(t,n,r),a=NaN,s=o-i,l=(o+i)/2;return s?(a=t===o?(n-r)/s+6*(n<r):n===o?(r-t)/s+2:(t-n)/s+4,s/=l<.5?o+i:2-o-i,a*=60):s=l>0&&l<1?0:a,new H_(a,s,l,e.opacity)}function H_(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function Z_(e){return(e=(e||0)%360)<0?e+360:e}function q_(e){return Math.max(0,Math.min(1,e||0))}function W_(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}function X_(e,t,n,r,i){var o=e*e,a=o*e;return((1-3*e+3*o-a)*t+(4-6*o+3*a)*n+(1+3*e+3*o-3*a)*r+a*i)/6}f_(g_,I_,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:C_,formatHex:C_,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return G_(this).formatHsl()},formatRgb:j_,toString:j_}),f_(L_,D_,m_(g_,{brighter(e){return e=null==e?__:Math.pow(__,e),new L_(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?y_:Math.pow(y_,e),new L_(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new L_(B_(this.r),B_(this.g),B_(this.b),F_(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:z_,formatHex:z_,formatHex8:function(){return"#".concat(V_(this.r)).concat(V_(this.g)).concat(V_(this.b)).concat(V_(255*(isNaN(this.opacity)?1:this.opacity)))},formatRgb:R_,toString:R_})),f_(H_,(function(e,t,n,r){return 1===arguments.length?G_(e):new H_(e,t,n,null==r?1:r)}),m_(g_,{brighter(e){return e=null==e?__:Math.pow(__,e),new H_(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?y_:Math.pow(y_,e),new H_(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new L_(W_(e>=240?e-240:e+120,i,r),W_(e,i,r),W_(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new H_(Z_(this.h),q_(this.s),q_(this.l),F_(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=F_(this.opacity);return"".concat(1===e?"hsl(":"hsla(").concat(Z_(this.h),", ").concat(100*q_(this.s),"%, ").concat(100*q_(this.l),"%").concat(1===e?")":", ".concat(e,")"))}}));const Y_=e=>()=>e;function K_(e,t){return function(n){return e+n*t}}function J_(e){return 1===(e=+e)?Q_:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):Y_(isNaN(t)?n:t)}}function Q_(e,t){var n=t-e;return n?K_(e,n):Y_(isNaN(e)?t:e)}const $_=function e(t){var n=J_(t);function r(e,t){var r=n((e=D_(e)).r,(t=D_(t)).r),i=n(e.g,t.g),o=n(e.b,t.b),a=Q_(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=i(t),e.b=o(t),e.opacity=a(t),e+""}}return r.gamma=e,r}(1);function ev(e){return function(t){var n,r,i=t.length,o=new Array(i),a=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=D_(t[n]),o[n]=r.r||0,a[n]=r.g||0,s[n]=r.b||0;return o=e(o),a=e(a),s=e(s),r.opacity=1,function(e){return r.r=o(e),r.g=a(e),r.b=s(e),r+""}}}ev((function(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],o=e[r+1],a=r>0?e[r-1]:2*i-o,s=r<t-1?e[r+2]:2*o-i;return X_((n-r/t)*t,a,i,o,s)}})),ev((function(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],o=e[r%t],a=e[(r+1)%t],s=e[(r+2)%t];return X_((n-r/t)*t,i,o,a,s)}}));function tv(e,t){var n,r=t?t.length:0,i=e?Math.min(r,e.length):0,o=new Array(i),a=new Array(r);for(n=0;n<i;++n)o[n]=cv(e[n],t[n]);for(;n<r;++n)a[n]=t[n];return function(e){for(n=0;n<i;++n)a[n]=o[n](e);return a}}function nv(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function rv(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function iv(e,t){var n,r={},i={};for(n in null!==e&&"object"===typeof e||(e={}),null!==t&&"object"===typeof t||(t={}),t)n in e?r[n]=cv(e[n],t[n]):i[n]=t[n];return function(e){for(n in r)i[n]=r[n](e);return i}}var ov=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,av=new RegExp(ov.source,"g");function sv(e,t){var n,r,i,o=ov.lastIndex=av.lastIndex=0,a=-1,s=[],l=[];for(e+="",t+="";(n=ov.exec(e))&&(r=av.exec(t));)(i=r.index)>o&&(i=t.slice(o,i),s[a]?s[a]+=i:s[++a]=i),(n=n[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,l.push({i:a,x:rv(n,r)})),o=av.lastIndex;return o<t.length&&(i=t.slice(o),s[a]?s[a]+=i:s[++a]=i),s.length<2?l[0]?function(e){return function(t){return e(t)+""}}(l[0].x):function(e){return function(){return e}}(t):(t=l.length,function(e){for(var n,r=0;r<t;++r)s[(n=l[r]).i]=n.x(e);return s.join("")})}function lv(e,t){t||(t=[]);var n,r=e?Math.min(t.length,e.length):0,i=t.slice();return function(o){for(n=0;n<r;++n)i[n]=e[n]*(1-o)+t[n]*o;return i}}function cv(e,t){var n,r,i=typeof t;return null==t||"boolean"===i?Y_(t):("number"===i?rv:"string"===i?(n=I_(t))?(t=n,$_):sv:t instanceof I_?$_:t instanceof Date?nv:(r=t,!ArrayBuffer.isView(r)||r instanceof DataView?Array.isArray(t)?tv:"function"!==typeof t.valueOf&&"function"!==typeof t.toString||isNaN(t)?iv:rv:lv))(e,t)}function uv(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function hv(e){return+e}var dv=[0,1];function pv(e){return e}function fv(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:(n=isNaN(t)?NaN:.5,function(){return n});var n}function mv(e,t,n){var r=e[0],i=e[1],o=t[0],a=t[1];return i<r?(r=fv(i,r),o=n(a,o)):(r=fv(r,i),o=n(o,a)),function(e){return o(r(e))}}function gv(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),o=new Array(r),a=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++a<r;)i[a]=fv(e[a],e[a+1]),o[a]=n(t[a],t[a+1]);return function(t){var n=p_(e,t,1,r)-1;return o[n](i[n](t))}}function yv(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function _v(){var e,t,n,r,i,o,a=dv,s=dv,l=cv,c=pv;function u(){var e=Math.min(a.length,s.length);return c!==pv&&(c=function(e,t){var n;return e>t&&(n=e,e=t,t=n),function(n){return Math.max(e,Math.min(t,n))}}(a[0],a[e-1])),r=e>2?gv:mv,i=o=null,h}function h(t){return null==t||isNaN(t=+t)?n:(i||(i=r(a.map(e),s,l)))(e(c(t)))}return h.invert=function(n){return c(t((o||(o=r(s,a.map(e),rv)))(n)))},h.domain=function(e){return arguments.length?(a=Array.from(e,hv),u()):a.slice()},h.range=function(e){return arguments.length?(s=Array.from(e),u()):s.slice()},h.rangeRound=function(e){return s=Array.from(e),l=uv,u()},h.clamp=function(e){return arguments.length?(c=!!e||pv,u()):c!==pv},h.interpolate=function(e){return arguments.length?(l=e,u()):l},h.unknown=function(e){return arguments.length?(n=e,h):n},function(n,r){return e=n,t=r,u()}}function vv(){return _v()(pv,pv)}var xv,bv=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function wv(e){if(!(t=bv.exec(e)))throw new Error("invalid format: "+e);var t;return new Sv({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function Sv(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function Tv(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function Ev(e){return(e=Tv(Math.abs(e)))?e[1]:NaN}function Av(e,t){var n=Tv(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}wv.prototype=Sv.prototype,Sv.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const Mv={"%":(e,t)=>(100*e).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>Av(100*e,t),r:Av,s:function(e,t){var n=Tv(e,t);if(!n)return e+"";var r=n[0],i=n[1],o=i-(xv=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+Tv(e,Math.max(0,t+o-1))[0]},X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function Pv(e){return e}var kv,Cv,jv,Iv=Array.prototype.map,Ov=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function Nv(e){var t,n,r=void 0===e.grouping||void 0===e.thousands?Pv:(t=Iv.call(e.grouping,Number),n=e.thousands+"",function(e,r){for(var i=e.length,o=[],a=0,s=t[0],l=0;i>0&&s>0&&(l+s+1>r&&(s=Math.max(1,r-l)),o.push(e.substring(i-=s,i+s)),!((l+=s+1)>r));)s=t[a=(a+1)%t.length];return o.reverse().join(n)}),i=void 0===e.currency?"":e.currency[0]+"",o=void 0===e.currency?"":e.currency[1]+"",a=void 0===e.decimal?".":e.decimal+"",s=void 0===e.numerals?Pv:function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}(Iv.call(e.numerals,String)),l=void 0===e.percent?"%":e.percent+"",c=void 0===e.minus?"\u2212":e.minus+"",u=void 0===e.nan?"NaN":e.nan+"";function h(e){var t=(e=wv(e)).fill,n=e.align,h=e.sign,d=e.symbol,p=e.zero,f=e.width,m=e.comma,g=e.precision,y=e.trim,_=e.type;"n"===_?(m=!0,_="g"):Mv[_]||(void 0===g&&(g=12),y=!0,_="g"),(p||"0"===t&&"="===n)&&(p=!0,t="0",n="=");var v="$"===d?i:"#"===d&&/[boxX]/.test(_)?"0"+_.toLowerCase():"",x="$"===d?o:/[%p]/.test(_)?l:"",b=Mv[_],w=/[defgprs%]/.test(_);function S(e){var i,o,l,d=v,S=x;if("c"===_)S=b(e)+S,e="";else{var T=(e=+e)<0||1/e<0;if(e=isNaN(e)?u:b(Math.abs(e),g),y&&(e=function(e){e:for(var t,n=e.length,r=1,i=-1;r<n;++r)switch(e[r]){case".":i=t=r;break;case"0":0===i&&(i=r),t=r;break;default:if(!+e[r])break e;i>0&&(i=0)}return i>0?e.slice(0,i)+e.slice(t+1):e}(e)),T&&0===+e&&"+"!==h&&(T=!1),d=(T?"("===h?h:c:"-"===h||"("===h?"":h)+d,S=("s"===_?Ov[8+xv/3]:"")+S+(T&&"("===h?")":""),w)for(i=-1,o=e.length;++i<o;)if(48>(l=e.charCodeAt(i))||l>57){S=(46===l?a+e.slice(i+1):e.slice(i))+S,e=e.slice(0,i);break}}m&&!p&&(e=r(e,1/0));var E=d.length+e.length+S.length,A=E<f?new Array(f-E+1).join(t):"";switch(m&&p&&(e=r(A+e,A.length?f-S.length:1/0),A=""),n){case"<":e=d+e+S+A;break;case"=":e=d+A+e+S;break;case"^":e=A.slice(0,E=A.length>>1)+d+e+S+A.slice(E);break;default:e=A+d+e+S}return s(e)}return g=void 0===g?6:/[gprs]/.test(_)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),S.toString=function(){return e+""},S}return{format:h,formatPrefix:function(e,t){var n=h(((e=wv(e)).type="f",e)),r=3*Math.max(-8,Math.min(8,Math.floor(Ev(t)/3))),i=Math.pow(10,-r),o=Ov[8+r/3];return function(e){return n(i*e)+o}}}}function Dv(e,t,n,r){var i,o=o_(e,t,n);switch((r=wv(null==r?",f":r)).type){case"s":var a=Math.max(Math.abs(e),Math.abs(t));return null!=r.precision||isNaN(i=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Ev(t)/3)))-Ev(Math.abs(e)))}(o,a))||(r.precision=i),jv(r,a);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Ev(t)-Ev(e))+1}(o,Math.max(Math.abs(e),Math.abs(t))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=function(e){return Math.max(0,-Ev(Math.abs(e)))}(o))||(r.precision=i-2*("%"===r.type))}return Cv(r)}function Lv(e){var t=e.domain;return e.ticks=function(e){var n=t();return r_(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){var r=t();return Dv(r[0],r[r.length-1],null==e?10:e,n)},e.nice=function(n){null==n&&(n=10);var r,i,o=t(),a=0,s=o.length-1,l=o[a],c=o[s],u=10;for(c<l&&(i=l,l=c,c=i,i=a,a=s,s=i);u-- >0;){if((i=i_(l,c,n))===r)return o[a]=l,o[s]=c,t(o);if(i>0)l=Math.floor(l/i)*i,c=Math.ceil(c/i)*i;else{if(!(i<0))break;l=Math.ceil(l*i)/i,c=Math.floor(c*i)/i}r=i}return e},e}function zv(){var e=vv();return e.copy=function(){return yv(e,zv())},iy.apply(e,arguments),Lv(e)}function Rv(e){var t;function n(e){return null==e||isNaN(e=+e)?t:e}return n.invert=n,n.domain=n.range=function(t){return arguments.length?(e=Array.from(t,hv),n):e.slice()},n.unknown=function(e){return arguments.length?(t=e,n):t},n.copy=function(){return Rv(e).unknown(t)},e=arguments.length?Array.from(e,hv):[0,1],Lv(n)}function Fv(e,t){var n,r=0,i=(e=e.slice()).length-1,o=e[r],a=e[i];return a<o&&(n=r,r=i,i=n,n=o,o=a,a=n),e[r]=t.floor(o),e[i]=t.ceil(a),e}function Bv(e){return Math.log(e)}function Vv(e){return Math.exp(e)}function Uv(e){return-Math.log(-e)}function Gv(e){return-Math.exp(-e)}function Hv(e){return isFinite(e)?+("1e"+e):e<0?0:e}function Zv(e){return(t,n)=>-e(-t,n)}function qv(e){const t=e(Bv,Vv),n=t.domain;let r,i,o=10;function a(){return r=function(e){return e===Math.E?Math.log:10===e&&Math.log10||2===e&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}(o),i=function(e){return 10===e?Hv:e===Math.E?Math.exp:t=>Math.pow(e,t)}(o),n()[0]<0?(r=Zv(r),i=Zv(i),e(Uv,Gv)):e(Bv,Vv),t}return t.base=function(e){return arguments.length?(o=+e,a()):o},t.domain=function(e){return arguments.length?(n(e),a()):n()},t.ticks=e=>{const t=n();let a=t[0],s=t[t.length-1];const l=s<a;l&&([a,s]=[s,a]);let c,u,h=r(a),d=r(s);const p=null==e?10:+e;let f=[];if(!(o%1)&&d-h<p){if(h=Math.floor(h),d=Math.ceil(d),a>0){for(;h<=d;++h)for(c=1;c<o;++c)if(u=h<0?c/i(-h):c*i(h),!(u<a)){if(u>s)break;f.push(u)}}else for(;h<=d;++h)for(c=o-1;c>=1;--c)if(u=h>0?c/i(-h):c*i(h),!(u<a)){if(u>s)break;f.push(u)}2*f.length<p&&(f=r_(a,s,p))}else f=r_(h,d,Math.min(d-h,p)).map(i);return l?f.reverse():f},t.tickFormat=(e,n)=>{if(null==e&&(e=10),null==n&&(n=10===o?"s":","),"function"!==typeof n&&(o%1||null!=(n=wv(n)).precision||(n.trim=!0),n=Cv(n)),e===1/0)return n;const a=Math.max(1,o*e/t.ticks().length);return e=>{let t=e/i(Math.round(r(e)));return t*o<o-.5&&(t*=o),t<=a?n(e):""}},t.nice=()=>n(Fv(n(),{floor:e=>i(Math.floor(r(e))),ceil:e=>i(Math.ceil(r(e)))})),t}function Wv(){const e=qv(_v()).domain([1,10]);return e.copy=()=>yv(e,Wv()).base(e.base()),iy.apply(e,arguments),e}function Xv(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function Yv(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function Kv(e){var t=1,n=e(Xv(t),Yv(t));return n.constant=function(n){return arguments.length?e(Xv(t=+n),Yv(t)):t},Lv(n)}function Jv(){var e=Kv(_v());return e.copy=function(){return yv(e,Jv()).constant(e.constant())},iy.apply(e,arguments)}function Qv(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function $v(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function ex(e){return e<0?-e*e:e*e}function tx(e){var t=e(pv,pv),n=1;return t.exponent=function(t){return arguments.length?1===(n=+t)?e(pv,pv):.5===n?e($v,ex):e(Qv(n),Qv(1/n)):n},Lv(t)}function nx(){var e=tx(_v());return e.copy=function(){return yv(e,nx()).exponent(e.exponent())},iy.apply(e,arguments),e}function rx(){return nx.apply(null,arguments).exponent(.5)}function ix(e){return Math.sign(e)*e*e}function ox(){var e,t=vv(),n=[0,1],r=!1;function i(n){var i=function(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}(t(n));return isNaN(i)?e:r?Math.round(i):i}return i.invert=function(e){return t.invert(ix(e))},i.domain=function(e){return arguments.length?(t.domain(e),i):t.domain()},i.range=function(e){return arguments.length?(t.range((n=Array.from(e,hv)).map(ix)),i):n.slice()},i.rangeRound=function(e){return i.range(e).round(!0)},i.round=function(e){return arguments.length?(r=!!e,i):r},i.clamp=function(e){return arguments.length?(t.clamp(e),i):t.clamp()},i.unknown=function(t){return arguments.length?(e=t,i):e},i.copy=function(){return ox(t.domain(),n).round(r).clamp(t.clamp()).unknown(e)},iy.apply(i,arguments),Lv(i)}function ax(e,t){let n;if(void 0===t)for(const r of e)null!=r&&(n<r||void 0===n&&r>=r)&&(n=r);else{let r=-1;for(let i of e)null!=(i=t(i,++r,e))&&(n<i||void 0===n&&i>=i)&&(n=i)}return n}function sx(e,t){let n;if(void 0===t)for(const r of e)null!=r&&(n>r||void 0===n&&r>=r)&&(n=r);else{let r=-1;for(let i of e)null!=(i=t(i,++r,e))&&(n>i||void 0===n&&i>=i)&&(n=i)}return n}function lx(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a_;if(e===a_)return cx;if("function"!==typeof e)throw new TypeError("compare is not a function");return(t,n)=>{const r=e(t,n);return r||0===r?r:(0===e(n,n))-(0===e(t,t))}}function cx(e,t){return(null==e||!(e>=e))-(null==t||!(t>=t))||(e<t?-1:e>t?1:0)}function ux(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0,i=arguments.length>4?arguments[4]:void 0;if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(e.length-1,r)),!(n<=t&&t<=r))return e;for(i=void 0===i?cx:lx(i);r>n;){if(r-n>600){const o=r-n+1,a=t-n+1,s=Math.log(o),l=.5*Math.exp(2*s/3),c=.5*Math.sqrt(s*l*(o-l)/o)*(a-o/2<0?-1:1);ux(e,t,Math.max(n,Math.floor(t-a*l/o+c)),Math.min(r,Math.floor(t+(o-a)*l/o+c)),i)}const o=e[t];let a=n,s=r;for(hx(e,n,t),i(e[r],o)>0&&hx(e,n,r);a<s;){for(hx(e,a,s),++a,--s;i(e[a],o)<0;)++a;for(;i(e[s],o)>0;)--s}0===i(e[n],o)?hx(e,n,s):(++s,hx(e,s,r)),s<=t&&(n=s+1),t<=s&&(r=s-1)}return e}function hx(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function dx(e,t,n){if(e=Float64Array.from(function*(e,t){if(void 0===t)for(let n of e)null!=n&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)null!=(r=t(r,++n,e))&&(r=+r)>=r&&(yield r)}}(e,n)),(r=e.length)&&!isNaN(t=+t)){if(t<=0||r<2)return sx(e);if(t>=1)return ax(e);var r,i=(r-1)*t,o=Math.floor(i),a=ax(ux(e,o).subarray(0,o+1));return a+(sx(e.subarray(o+1))-a)*(i-o)}}function px(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:u_;if((r=e.length)&&!isNaN(t=+t)){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,o=Math.floor(i),a=+n(e[o],o,e);return a+(+n(e[o+1],o+1,e)-a)*(i-o)}}function fx(){var e,t=[],n=[],r=[];function i(){var e=0,i=Math.max(1,n.length);for(r=new Array(i-1);++e<i;)r[e-1]=px(t,e/i);return o}function o(t){return null==t||isNaN(t=+t)?e:n[p_(r,t)]}return o.invertExtent=function(e){var i=n.indexOf(e);return i<0?[NaN,NaN]:[i>0?r[i-1]:t[0],i<r.length?r[i]:t[t.length-1]]},o.domain=function(e){if(!arguments.length)return t.slice();t=[];for(let n of e)null==n||isNaN(n=+n)||t.push(n);return t.sort(a_),i()},o.range=function(e){return arguments.length?(n=Array.from(e),i()):n.slice()},o.unknown=function(t){return arguments.length?(e=t,o):e},o.quantiles=function(){return r.slice()},o.copy=function(){return fx().domain(t).range(n).unknown(e)},iy.apply(o,arguments)}function mx(){var e,t=0,n=1,r=1,i=[.5],o=[0,1];function a(t){return null!=t&&t<=t?o[p_(i,t,0,r)]:e}function s(){var e=-1;for(i=new Array(r);++e<r;)i[e]=((e+1)*n-(e-r)*t)/(r+1);return a}return a.domain=function(e){return arguments.length?([t,n]=e,t=+t,n=+n,s()):[t,n]},a.range=function(e){return arguments.length?(r=(o=Array.from(e)).length-1,s()):o.slice()},a.invertExtent=function(e){var a=o.indexOf(e);return a<0?[NaN,NaN]:a<1?[t,i[0]]:a>=r?[i[r-1],n]:[i[a-1],i[a]]},a.unknown=function(t){return arguments.length?(e=t,a):a},a.thresholds=function(){return i.slice()},a.copy=function(){return mx().domain([t,n]).range(o).unknown(e)},iy.apply(Lv(a),arguments)}function gx(){var e,t=[.5],n=[0,1],r=1;function i(i){return null!=i&&i<=i?n[p_(t,i,0,r)]:e}return i.domain=function(e){return arguments.length?(t=Array.from(e),r=Math.min(t.length,n.length-1),i):t.slice()},i.range=function(e){return arguments.length?(n=Array.from(e),r=Math.min(t.length,n.length-1),i):n.slice()},i.invertExtent=function(e){var r=n.indexOf(e);return[t[r-1],t[r]]},i.unknown=function(t){return arguments.length?(e=t,i):e},i.copy=function(){return gx().domain(t).range(n).unknown(e)},iy.apply(i,arguments)}kv=Nv({thousands:",",grouping:[3],currency:["$",""]}),Cv=kv.format,jv=kv.formatPrefix;const yx=1e3,_x=6e4,vx=36e5,xx=864e5,bx=6048e5,wx=2592e6,Sx=31536e6,Tx=new Date,Ex=new Date;function Ax(e,t,n,r){function i(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return i.floor=t=>(e(t=new Date(+t)),t),i.ceil=n=>(e(n=new Date(n-1)),t(n,1),e(n),n),i.round=e=>{const t=i(e),n=i.ceil(e);return e-t<n-e?t:n},i.offset=(e,n)=>(t(e=new Date(+e),null==n?1:Math.floor(n)),e),i.range=(n,r,o)=>{const a=[];if(n=i.ceil(n),o=null==o?1:Math.floor(o),!(n<r)||!(o>0))return a;let s;do{a.push(s=new Date(+n)),t(n,o),e(n)}while(s<n&&n<r);return a},i.filter=n=>Ax((t=>{if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)}),((e,r)=>{if(e>=e)if(r<0)for(;++r<=0;)for(;t(e,-1),!n(e););else for(;--r>=0;)for(;t(e,1),!n(e););})),n&&(i.count=(t,r)=>(Tx.setTime(+t),Ex.setTime(+r),e(Tx),e(Ex),Math.floor(n(Tx,Ex))),i.every=e=>(e=Math.floor(e),isFinite(e)&&e>0?e>1?i.filter(r?t=>r(t)%e===0:t=>i.count(0,t)%e===0):i:null)),i}const Mx=Ax((()=>{}),((e,t)=>{e.setTime(+e+t)}),((e,t)=>t-e));Mx.every=e=>(e=Math.floor(e),isFinite(e)&&e>0?e>1?Ax((t=>{t.setTime(Math.floor(t/e)*e)}),((t,n)=>{t.setTime(+t+n*e)}),((t,n)=>(n-t)/e)):Mx:null);Mx.range;const Px=Ax((e=>{e.setTime(e-e.getMilliseconds())}),((e,t)=>{e.setTime(+e+t*yx)}),((e,t)=>(t-e)/yx),(e=>e.getUTCSeconds())),kx=(Px.range,Ax((e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*yx)}),((e,t)=>{e.setTime(+e+t*_x)}),((e,t)=>(t-e)/_x),(e=>e.getMinutes()))),Cx=(kx.range,Ax((e=>{e.setUTCSeconds(0,0)}),((e,t)=>{e.setTime(+e+t*_x)}),((e,t)=>(t-e)/_x),(e=>e.getUTCMinutes()))),jx=(Cx.range,Ax((e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*yx-e.getMinutes()*_x)}),((e,t)=>{e.setTime(+e+t*vx)}),((e,t)=>(t-e)/vx),(e=>e.getHours()))),Ix=(jx.range,Ax((e=>{e.setUTCMinutes(0,0,0)}),((e,t)=>{e.setTime(+e+t*vx)}),((e,t)=>(t-e)/vx),(e=>e.getUTCHours()))),Ox=(Ix.range,Ax((e=>e.setHours(0,0,0,0)),((e,t)=>e.setDate(e.getDate()+t)),((e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*_x)/xx),(e=>e.getDate()-1))),Nx=(Ox.range,Ax((e=>{e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCDate(e.getUTCDate()+t)}),((e,t)=>(t-e)/xx),(e=>e.getUTCDate()-1))),Dx=(Nx.range,Ax((e=>{e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCDate(e.getUTCDate()+t)}),((e,t)=>(t-e)/xx),(e=>Math.floor(e/xx))));Dx.range;function Lx(e){return Ax((t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)}),((e,t)=>{e.setDate(e.getDate()+7*t)}),((e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*_x)/bx))}const zx=Lx(0),Rx=Lx(1),Fx=Lx(2),Bx=Lx(3),Vx=Lx(4),Ux=Lx(5),Gx=Lx(6);zx.range,Rx.range,Fx.range,Bx.range,Vx.range,Ux.range,Gx.range;function Hx(e){return Ax((t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCDate(e.getUTCDate()+7*t)}),((e,t)=>(t-e)/bx))}const Zx=Hx(0),qx=Hx(1),Wx=Hx(2),Xx=Hx(3),Yx=Hx(4),Kx=Hx(5),Jx=Hx(6),Qx=(Zx.range,qx.range,Wx.range,Xx.range,Yx.range,Kx.range,Jx.range,Ax((e=>{e.setDate(1),e.setHours(0,0,0,0)}),((e,t)=>{e.setMonth(e.getMonth()+t)}),((e,t)=>t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())),(e=>e.getMonth()))),$x=(Qx.range,Ax((e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)}),((e,t)=>t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())),(e=>e.getUTCMonth()))),eb=($x.range,Ax((e=>{e.setMonth(0,1),e.setHours(0,0,0,0)}),((e,t)=>{e.setFullYear(e.getFullYear()+t)}),((e,t)=>t.getFullYear()-e.getFullYear()),(e=>e.getFullYear())));eb.every=e=>isFinite(e=Math.floor(e))&&e>0?Ax((t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)}),((t,n)=>{t.setFullYear(t.getFullYear()+n*e)})):null;eb.range;const tb=Ax((e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)}),((e,t)=>t.getUTCFullYear()-e.getUTCFullYear()),(e=>e.getUTCFullYear()));tb.every=e=>isFinite(e=Math.floor(e))&&e>0?Ax((t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),((t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)})):null;tb.range;function nb(e,t,n,r,i,o){const a=[[Px,1,yx],[Px,5,5e3],[Px,15,15e3],[Px,30,3e4],[o,1,_x],[o,5,3e5],[o,15,9e5],[o,30,18e5],[i,1,vx],[i,3,108e5],[i,6,216e5],[i,12,432e5],[r,1,xx],[r,2,1728e5],[n,1,bx],[t,1,wx],[t,3,7776e6],[e,1,Sx]];function s(t,n,r){const i=Math.abs(n-t)/r,o=l_((e=>{let[,,t]=e;return t})).right(a,i);if(o===a.length)return e.every(o_(t/Sx,n/Sx,r));if(0===o)return Mx.every(Math.max(o_(t,n,r),1));const[s,l]=a[i/a[o-1][2]<a[o][2]/i?o-1:o];return s.every(l)}return[function(e,t,n){const r=t<e;r&&([e,t]=[t,e]);const i=n&&"function"===typeof n.range?n:s(e,t,n),o=i?i.range(e,+t+1):[];return r?o.reverse():o},s]}const[rb,ib]=nb(tb,$x,Zx,Dx,Ix,Cx),[ob,ab]=nb(eb,Qx,zx,Ox,jx,kx);function sb(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function lb(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function cb(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}var ub,hb,db,pb={"-":"",_:" ",0:"0"},fb=/^\s*\d+/,mb=/^%/,gb=/[\\^$*+?|[\]().{}]/g;function yb(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(t)+i:i)}function _b(e){return e.replace(gb,"\\$&")}function vb(e){return new RegExp("^(?:"+e.map(_b).join("|")+")","i")}function xb(e){return new Map(e.map(((e,t)=>[e.toLowerCase(),t])))}function bb(e,t,n){var r=fb.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function wb(e,t,n){var r=fb.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function Sb(e,t,n){var r=fb.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function Tb(e,t,n){var r=fb.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function Eb(e,t,n){var r=fb.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function Ab(e,t,n){var r=fb.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function Mb(e,t,n){var r=fb.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function Pb(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function kb(e,t,n){var r=fb.exec(t.slice(n,n+1));return r?(e.q=3*r[0]-3,n+r[0].length):-1}function Cb(e,t,n){var r=fb.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function jb(e,t,n){var r=fb.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function Ib(e,t,n){var r=fb.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function Ob(e,t,n){var r=fb.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function Nb(e,t,n){var r=fb.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function Db(e,t,n){var r=fb.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function Lb(e,t,n){var r=fb.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function zb(e,t,n){var r=fb.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function Rb(e,t,n){var r=mb.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function Fb(e,t,n){var r=fb.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function Bb(e,t,n){var r=fb.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function Vb(e,t){return yb(e.getDate(),t,2)}function Ub(e,t){return yb(e.getHours(),t,2)}function Gb(e,t){return yb(e.getHours()%12||12,t,2)}function Hb(e,t){return yb(1+Ox.count(eb(e),e),t,3)}function Zb(e,t){return yb(e.getMilliseconds(),t,3)}function qb(e,t){return Zb(e,t)+"000"}function Wb(e,t){return yb(e.getMonth()+1,t,2)}function Xb(e,t){return yb(e.getMinutes(),t,2)}function Yb(e,t){return yb(e.getSeconds(),t,2)}function Kb(e){var t=e.getDay();return 0===t?7:t}function Jb(e,t){return yb(zx.count(eb(e)-1,e),t,2)}function Qb(e){var t=e.getDay();return t>=4||0===t?Vx(e):Vx.ceil(e)}function $b(e,t){return e=Qb(e),yb(Vx.count(eb(e),e)+(4===eb(e).getDay()),t,2)}function ew(e){return e.getDay()}function tw(e,t){return yb(Rx.count(eb(e)-1,e),t,2)}function nw(e,t){return yb(e.getFullYear()%100,t,2)}function rw(e,t){return yb((e=Qb(e)).getFullYear()%100,t,2)}function iw(e,t){return yb(e.getFullYear()%1e4,t,4)}function ow(e,t){var n=e.getDay();return yb((e=n>=4||0===n?Vx(e):Vx.ceil(e)).getFullYear()%1e4,t,4)}function aw(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+yb(t/60|0,"0",2)+yb(t%60,"0",2)}function sw(e,t){return yb(e.getUTCDate(),t,2)}function lw(e,t){return yb(e.getUTCHours(),t,2)}function cw(e,t){return yb(e.getUTCHours()%12||12,t,2)}function uw(e,t){return yb(1+Nx.count(tb(e),e),t,3)}function hw(e,t){return yb(e.getUTCMilliseconds(),t,3)}function dw(e,t){return hw(e,t)+"000"}function pw(e,t){return yb(e.getUTCMonth()+1,t,2)}function fw(e,t){return yb(e.getUTCMinutes(),t,2)}function mw(e,t){return yb(e.getUTCSeconds(),t,2)}function gw(e){var t=e.getUTCDay();return 0===t?7:t}function yw(e,t){return yb(Zx.count(tb(e)-1,e),t,2)}function _w(e){var t=e.getUTCDay();return t>=4||0===t?Yx(e):Yx.ceil(e)}function vw(e,t){return e=_w(e),yb(Yx.count(tb(e),e)+(4===tb(e).getUTCDay()),t,2)}function xw(e){return e.getUTCDay()}function bw(e,t){return yb(qx.count(tb(e)-1,e),t,2)}function ww(e,t){return yb(e.getUTCFullYear()%100,t,2)}function Sw(e,t){return yb((e=_w(e)).getUTCFullYear()%100,t,2)}function Tw(e,t){return yb(e.getUTCFullYear()%1e4,t,4)}function Ew(e,t){var n=e.getUTCDay();return yb((e=n>=4||0===n?Yx(e):Yx.ceil(e)).getUTCFullYear()%1e4,t,4)}function Aw(){return"+0000"}function Mw(){return"%"}function Pw(e){return+e}function kw(e){return Math.floor(+e/1e3)}function Cw(e){return new Date(e)}function jw(e){return e instanceof Date?+e:+new Date(+e)}function Iw(e,t,n,r,i,o,a,s,l,c){var u=vv(),h=u.invert,d=u.domain,p=c(".%L"),f=c(":%S"),m=c("%I:%M"),g=c("%I %p"),y=c("%a %d"),_=c("%b %d"),v=c("%B"),x=c("%Y");function b(e){return(l(e)<e?p:s(e)<e?f:a(e)<e?m:o(e)<e?g:r(e)<e?i(e)<e?y:_:n(e)<e?v:x)(e)}return u.invert=function(e){return new Date(h(e))},u.domain=function(e){return arguments.length?d(Array.from(e,jw)):d().map(Cw)},u.ticks=function(t){var n=d();return e(n[0],n[n.length-1],null==t?10:t)},u.tickFormat=function(e,t){return null==t?b:c(t)},u.nice=function(e){var n=d();return e&&"function"===typeof e.range||(e=t(n[0],n[n.length-1],null==e?10:e)),e?d(Fv(n,e)):u},u.copy=function(){return yv(u,Iw(e,t,n,r,i,o,a,s,l,c))},u}function Ow(){return iy.apply(Iw(ob,ab,eb,Qx,zx,Ox,jx,kx,Px,hb).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Nw(){return iy.apply(Iw(rb,ib,tb,$x,Zx,Nx,Ix,Cx,Px,db).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Dw(){var e,t,n,r,i,o=0,a=1,s=pv,l=!1;function c(t){return null==t||isNaN(t=+t)?i:s(0===n?.5:(t=(r(t)-e)*n,l?Math.max(0,Math.min(1,t)):t))}function u(e){return function(t){var n,r;return arguments.length?([n,r]=t,s=e(n,r),c):[s(0),s(1)]}}return c.domain=function(i){return arguments.length?([o,a]=i,e=r(o=+o),t=r(a=+a),n=e===t?0:1/(t-e),c):[o,a]},c.clamp=function(e){return arguments.length?(l=!!e,c):l},c.interpolator=function(e){return arguments.length?(s=e,c):s},c.range=u(cv),c.rangeRound=u(uv),c.unknown=function(e){return arguments.length?(i=e,c):i},function(i){return r=i,e=i(o),t=i(a),n=e===t?0:1/(t-e),c}}function Lw(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function zw(){var e=Lv(Dw()(pv));return e.copy=function(){return Lw(e,zw())},oy.apply(e,arguments)}function Rw(){var e=qv(Dw()).domain([1,10]);return e.copy=function(){return Lw(e,Rw()).base(e.base())},oy.apply(e,arguments)}function Fw(){var e=Kv(Dw());return e.copy=function(){return Lw(e,Fw()).constant(e.constant())},oy.apply(e,arguments)}function Bw(){var e=tx(Dw());return e.copy=function(){return Lw(e,Bw()).exponent(e.exponent())},oy.apply(e,arguments)}function Vw(){return Bw.apply(null,arguments).exponent(.5)}function Uw(){var e=[],t=pv;function n(n){if(null!=n&&!isNaN(n=+n))return t((p_(e,n,1)-1)/(e.length-1))}return n.domain=function(t){if(!arguments.length)return e.slice();e=[];for(let n of t)null==n||isNaN(n=+n)||e.push(n);return e.sort(a_),n},n.interpolator=function(e){return arguments.length?(t=e,n):t},n.range=function(){return e.map(((n,r)=>t(r/(e.length-1))))},n.quantiles=function(t){return Array.from({length:t+1},((n,r)=>dx(e,r/t)))},n.copy=function(){return Uw(t).domain(e)},oy.apply(n,arguments)}function Gw(){var e,t,n,r,i,o,a,s=0,l=.5,c=1,u=1,h=pv,d=!1;function p(e){return isNaN(e=+e)?a:(e=.5+((e=+o(e))-t)*(u*e<u*t?r:i),h(d?Math.max(0,Math.min(1,e)):e))}function f(e){return function(t){var n,r,i;return arguments.length?([n,r,i]=t,h=function(e,t){void 0===t&&(t=e,e=cv);for(var n=0,r=t.length-1,i=t[0],o=new Array(r<0?0:r);n<r;)o[n]=e(i,i=t[++n]);return function(e){var t=Math.max(0,Math.min(r-1,Math.floor(e*=r)));return o[t](e-t)}}(e,[n,r,i]),p):[h(0),h(.5),h(1)]}}return p.domain=function(a){return arguments.length?([s,l,c]=a,e=o(s=+s),t=o(l=+l),n=o(c=+c),r=e===t?0:.5/(t-e),i=t===n?0:.5/(n-t),u=t<e?-1:1,p):[s,l,c]},p.clamp=function(e){return arguments.length?(d=!!e,p):d},p.interpolator=function(e){return arguments.length?(h=e,p):h},p.range=f(cv),p.rangeRound=f(uv),p.unknown=function(e){return arguments.length?(a=e,p):a},function(a){return o=a,e=a(s),t=a(l),n=a(c),r=e===t?0:.5/(t-e),i=t===n?0:.5/(n-t),u=t<e?-1:1,p}}function Hw(){var e=Lv(Gw()(pv));return e.copy=function(){return Lw(e,Hw())},oy.apply(e,arguments)}function Zw(){var e=qv(Gw()).domain([.1,1,10]);return e.copy=function(){return Lw(e,Zw()).base(e.base())},oy.apply(e,arguments)}function qw(){var e=Kv(Gw());return e.copy=function(){return Lw(e,qw()).constant(e.constant())},oy.apply(e,arguments)}function Ww(){var e=tx(Gw());return e.copy=function(){return Lw(e,Ww()).exponent(e.exponent())},oy.apply(e,arguments)}function Xw(){return Ww.apply(null,arguments).exponent(.5)}function Yw(e,t){if((i=e.length)>1)for(var n,r,i,o=1,a=e[t[0]],s=a.length;o<i;++o)for(r=a,a=e[t[o]],n=0;n<s;++n)a[n][1]+=a[n][0]=isNaN(r[n][1])?r[n][0]:r[n][1]}!function(e){ub=function(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,o=e.days,a=e.shortDays,s=e.months,l=e.shortMonths,c=vb(i),u=xb(i),h=vb(o),d=xb(o),p=vb(a),f=xb(a),m=vb(s),g=xb(s),y=vb(l),_=xb(l),v={a:function(e){return a[e.getDay()]},A:function(e){return o[e.getDay()]},b:function(e){return l[e.getMonth()]},B:function(e){return s[e.getMonth()]},c:null,d:Vb,e:Vb,f:qb,g:rw,G:ow,H:Ub,I:Gb,j:Hb,L:Zb,m:Wb,M:Xb,p:function(e){return i[+(e.getHours()>=12)]},q:function(e){return 1+~~(e.getMonth()/3)},Q:Pw,s:kw,S:Yb,u:Kb,U:Jb,V:$b,w:ew,W:tw,x:null,X:null,y:nw,Y:iw,Z:aw,"%":Mw},x={a:function(e){return a[e.getUTCDay()]},A:function(e){return o[e.getUTCDay()]},b:function(e){return l[e.getUTCMonth()]},B:function(e){return s[e.getUTCMonth()]},c:null,d:sw,e:sw,f:dw,g:Sw,G:Ew,H:lw,I:cw,j:uw,L:hw,m:pw,M:fw,p:function(e){return i[+(e.getUTCHours()>=12)]},q:function(e){return 1+~~(e.getUTCMonth()/3)},Q:Pw,s:kw,S:mw,u:gw,U:yw,V:vw,w:xw,W:bw,x:null,X:null,y:ww,Y:Tw,Z:Aw,"%":Mw},b={a:function(e,t,n){var r=p.exec(t.slice(n));return r?(e.w=f.get(r[0].toLowerCase()),n+r[0].length):-1},A:function(e,t,n){var r=h.exec(t.slice(n));return r?(e.w=d.get(r[0].toLowerCase()),n+r[0].length):-1},b:function(e,t,n){var r=y.exec(t.slice(n));return r?(e.m=_.get(r[0].toLowerCase()),n+r[0].length):-1},B:function(e,t,n){var r=m.exec(t.slice(n));return r?(e.m=g.get(r[0].toLowerCase()),n+r[0].length):-1},c:function(e,n,r){return T(e,t,n,r)},d:jb,e:jb,f:zb,g:Mb,G:Ab,H:Ob,I:Ob,j:Ib,L:Lb,m:Cb,M:Nb,p:function(e,t,n){var r=c.exec(t.slice(n));return r?(e.p=u.get(r[0].toLowerCase()),n+r[0].length):-1},q:kb,Q:Fb,s:Bb,S:Db,u:wb,U:Sb,V:Tb,w:bb,W:Eb,x:function(e,t,r){return T(e,n,t,r)},X:function(e,t,n){return T(e,r,t,n)},y:Mb,Y:Ab,Z:Pb,"%":Rb};function w(e,t){return function(n){var r,i,o,a=[],s=-1,l=0,c=e.length;for(n instanceof Date||(n=new Date(+n));++s<c;)37===e.charCodeAt(s)&&(a.push(e.slice(l,s)),null!=(i=pb[r=e.charAt(++s)])?r=e.charAt(++s):i="e"===r?" ":"0",(o=t[r])&&(r=o(n,i)),a.push(r),l=s+1);return a.push(e.slice(l,s)),a.join("")}}function S(e,t){return function(n){var r,i,o=cb(1900,void 0,1);if(T(o,e,n+="",0)!=n.length)return null;if("Q"in o)return new Date(o.Q);if("s"in o)return new Date(1e3*o.s+("L"in o?o.L:0));if(t&&!("Z"in o)&&(o.Z=0),"p"in o&&(o.H=o.H%12+12*o.p),void 0===o.m&&(o.m="q"in o?o.q:0),"V"in o){if(o.V<1||o.V>53)return null;"w"in o||(o.w=1),"Z"in o?(i=(r=lb(cb(o.y,0,1))).getUTCDay(),r=i>4||0===i?qx.ceil(r):qx(r),r=Nx.offset(r,7*(o.V-1)),o.y=r.getUTCFullYear(),o.m=r.getUTCMonth(),o.d=r.getUTCDate()+(o.w+6)%7):(i=(r=sb(cb(o.y,0,1))).getDay(),r=i>4||0===i?Rx.ceil(r):Rx(r),r=Ox.offset(r,7*(o.V-1)),o.y=r.getFullYear(),o.m=r.getMonth(),o.d=r.getDate()+(o.w+6)%7)}else("W"in o||"U"in o)&&("w"in o||(o.w="u"in o?o.u%7:"W"in o?1:0),i="Z"in o?lb(cb(o.y,0,1)).getUTCDay():sb(cb(o.y,0,1)).getDay(),o.m=0,o.d="W"in o?(o.w+6)%7+7*o.W-(i+5)%7:o.w+7*o.U-(i+6)%7);return"Z"in o?(o.H+=o.Z/100|0,o.M+=o.Z%100,lb(o)):sb(o)}}function T(e,t,n,r){for(var i,o,a=0,s=t.length,l=n.length;a<s;){if(r>=l)return-1;if(37===(i=t.charCodeAt(a++))){if(i=t.charAt(a++),!(o=b[i in pb?t.charAt(a++):i])||(r=o(e,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return v.x=w(n,v),v.X=w(r,v),v.c=w(t,v),x.x=w(n,x),x.X=w(r,x),x.c=w(t,x),{format:function(e){var t=w(e+="",v);return t.toString=function(){return e},t},parse:function(e){var t=S(e+="",!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=w(e+="",x);return t.toString=function(){return e},t},utcParse:function(e){var t=S(e+="",!0);return t.toString=function(){return e},t}}}(e),hb=ub.format,ub.parse,db=ub.utcFormat,ub.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});Array.prototype.slice;function Kw(e){return"object"===typeof e&&"length"in e?e:Array.from(e)}function Jw(e){for(var t=e.length,n=new Array(t);--t>=0;)n[t]=t;return n}function Qw(e,t){return e[t]}function $w(e){const t=[];return t.key=e,t}var eS=n(539),tS=n.n(eS),nS=n(6745),rS=n.n(nS),iS=n(3538),oS=n.n(iS),aS=n(9853),sS=n.n(aS),lS=n(8210),cS=n.n(lS);function uS(e){return function(e){if(Array.isArray(e))return hS(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return hS(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return hS(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function hS(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var dS=function(e){return e},pS={"@@functional/placeholder":!0},fS=function(e){return e===pS},mS=function(e){return function t(){return 0===arguments.length||1===arguments.length&&fS(arguments.length<=0?void 0:arguments[0])?t:e.apply(void 0,arguments)}},gS=function e(t,n){return 1===t?n:mS((function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];var a=i.filter((function(e){return e!==pS})).length;return a>=t?n.apply(void 0,i):e(t-a,mS((function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var o=i.map((function(e){return fS(e)?t.shift():e}));return n.apply(void 0,uS(o).concat(t))})))}))},yS=function(e){return gS(e.length,e)},_S=function(e,t){for(var n=[],r=e;r<t;++r)n[r-e]=r;return n},vS=yS((function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map((function(e){return t[e]})).map(e)})),xS=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(!t.length)return dS;var r=t.reverse(),i=r[0],o=r.slice(1);return function(){return o.reduce((function(e,t){return t(e)}),i.apply(void 0,arguments))}},bS=function(e){return Array.isArray(e)?e.reverse():e.split("").reverse.join("")},wS=function(e){var t=null,n=null;return function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return t&&i.every((function(e,n){return e===t[n]}))?n:(t=i,n=e.apply(void 0,i))}};var SS=yS((function(e,t,n){var r=+e;return r+n*(+t-r)})),TS=yS((function(e,t,n){var r=t-+e;return(n-e)/(r=r||1/0)})),ES=yS((function(e,t,n){var r=t-+e;return r=r||1/0,Math.max(0,Math.min(1,(n-e)/r))}));const AS={rangeStep:function(e,t,n){for(var r=new(cS())(e),i=0,o=[];r.lt(t)&&i<1e5;)o.push(r.toNumber()),r=r.add(n),i++;return o},getDigitCount:function(e){return 0===e?1:Math.floor(new(cS())(e).abs().log(10).toNumber())+1},interpolateNumber:SS,uninterpolateNumber:TS,uninterpolateTruncation:ES};function MS(e){return function(e){if(Array.isArray(e))return CS(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||kS(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function PS(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){i=!0,o=l}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(e,t)||kS(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function kS(e,t){if(e){if("string"===typeof e)return CS(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?CS(e,t):void 0}}function CS(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function jS(e){var t=PS(e,2),n=t[0],r=t[1],i=n,o=r;return n>r&&(i=r,o=n),[i,o]}function IS(e,t,n){if(e.lte(0))return new(cS())(0);var r=AS.getDigitCount(e.toNumber()),i=new(cS())(10).pow(r),o=e.div(i),a=1!==r?.05:.1,s=new(cS())(Math.ceil(o.div(a).toNumber())).add(n).mul(a).mul(i);return t?s:new(cS())(Math.ceil(s))}function OS(e,t,n){var r=1,i=new(cS())(e);if(!i.isint()&&n){var o=Math.abs(e);o<1?(r=new(cS())(10).pow(AS.getDigitCount(e)-1),i=new(cS())(Math.floor(i.div(r).toNumber())).mul(r)):o>1&&(i=new(cS())(Math.floor(e)))}else 0===e?i=new(cS())(Math.floor((t-1)/2)):n||(i=new(cS())(Math.floor(e)));var a=Math.floor((t-1)/2);return xS(vS((function(e){return i.add(new(cS())(e-a).mul(r)).toNumber()})),_S)(0,t)}function NS(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(!Number.isFinite((t-e)/(n-1)))return{step:new(cS())(0),tickMin:new(cS())(0),tickMax:new(cS())(0)};var o,a=IS(new(cS())(t).sub(e).div(n-1),r,i);o=e<=0&&t>=0?new(cS())(0):(o=new(cS())(e).add(t).div(2)).sub(new(cS())(o).mod(a));var s=Math.ceil(o.sub(e).div(a).toNumber()),l=Math.ceil(new(cS())(t).sub(o).div(a).toNumber()),c=s+l+1;return c>n?NS(e,t,n,r,i+1):(c<n&&(l=t>0?l+(n-c):l,s=t>0?s:s+(n-c)),{step:a,tickMin:o.sub(new(cS())(s).mul(a)),tickMax:o.add(new(cS())(l).mul(a))})}var DS=wS((function(e){var t=PS(e,2),n=t[0],r=t[1],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6,o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=Math.max(i,2),s=PS(jS([n,r]),2),l=s[0],c=s[1];if(l===-1/0||c===1/0){var u=c===1/0?[l].concat(MS(_S(0,i-1).map((function(){return 1/0})))):[].concat(MS(_S(0,i-1).map((function(){return-1/0}))),[c]);return n>r?bS(u):u}if(l===c)return OS(l,i,o);var h=NS(l,c,a,o),d=h.step,p=h.tickMin,f=h.tickMax,m=AS.rangeStep(p,f.add(new(cS())(.1).mul(d)),d);return n>r?bS(m):m})),LS=(wS((function(e){var t=PS(e,2),n=t[0],r=t[1],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6,o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=Math.max(i,2),s=PS(jS([n,r]),2),l=s[0],c=s[1];if(l===-1/0||c===1/0)return[n,r];if(l===c)return OS(l,i,o);var u=IS(new(cS())(c).sub(l).div(a-1),o,0),h=xS(vS((function(e){return new(cS())(l).add(new(cS())(e).mul(u)).toNumber()})),_S)(0,a).filter((function(e){return e>=l&&e<=c}));return n>r?bS(h):h})),wS((function(e,t){var n=PS(e,2),r=n[0],i=n[1],o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=PS(jS([r,i]),2),s=a[0],l=a[1];if(s===-1/0||l===1/0)return[r,i];if(s===l)return[s];var c=Math.max(t,2),u=IS(new(cS())(l).sub(s).div(c-1),o,0),h=[].concat(MS(AS.rangeStep(new(cS())(s),new(cS())(l).sub(new(cS())(.99).mul(u)),u)),[l]);return r>i?bS(h):h}))),zS=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function RS(e){return RS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},RS(e)}function FS(){return FS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},FS.apply(this,arguments)}function BS(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],l=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){c=!0,i=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw i}}return s}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return VS(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return VS(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function VS(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function US(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function GS(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,YS(r.key),r)}}function HS(e,t,n){return t=qS(t),function(e,t){if(t&&("object"===RS(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,ZS()?Reflect.construct(t,n||[],qS(e).constructor):t.apply(e,n))}function ZS(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ZS=function(){return!!e})()}function qS(e){return qS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},qS(e)}function WS(e,t){return WS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},WS(e,t)}function XS(e,t,n){return(t=YS(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function YS(e){var t=function(e,t){if("object"!=RS(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=RS(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==RS(t)?t:t+""}var KS=function(e){function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),HS(this,n,arguments)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&WS(e,t)}(n,e),r=n,i=[{key:"render",value:function(){var e=this.props,n=e.offset,r=e.layout,i=e.width,o=e.dataKey,a=e.data,s=e.dataPointFormatter,l=e.xAxis,c=e.yAxis,u=US(e,zS),h=Md(u,!1);"x"===this.props.direction&&"number"!==l.type&&Gd(!1);var d=a.map((function(e){var a=s(e,o),u=a.x,d=a.y,p=a.value,f=a.errorVal;if(!f)return null;var m,g,y=[];if(Array.isArray(f)){var _=BS(f,2);m=_[0],g=_[1]}else m=g=f;if("vertical"===r){var v=l.scale,x=d+n,b=x+i,w=x-i,S=v(p-m),T=v(p+g);y.push({x1:T,y1:b,x2:T,y2:w}),y.push({x1:S,y1:x,x2:T,y2:x}),y.push({x1:S,y1:b,x2:S,y2:w})}else if("horizontal"===r){var E=c.scale,A=u+n,M=A-i,P=A+i,k=E(p-m),C=E(p+g);y.push({x1:M,y1:C,x2:P,y2:C}),y.push({x1:A,y1:k,x2:A,y2:C}),y.push({x1:M,y1:k,x2:P,y2:k})}return t.createElement(Jd,FS({className:"recharts-errorBar",key:"bar-".concat(y.map((function(e){return"".concat(e.x1,"-").concat(e.x2,"-").concat(e.y1,"-").concat(e.y2)})))},h),y.map((function(e){return t.createElement("line",FS({},e,{key:"line-".concat(e.x1,"-").concat(e.x2,"-").concat(e.y1,"-").concat(e.y2)}))})))}));return t.createElement(Jd,{className:"recharts-errorBars"},d)}}],i&&GS(r.prototype,i),o&&GS(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,i,o}(t.Component);function JS(e){return JS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},JS(e)}function QS(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?QS(Object(n),!0).forEach((function(t){eT(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):QS(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function eT(e,t,n){return t=function(e){var t=function(e,t){if("object"!=JS(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=JS(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==JS(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}XS(KS,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"}),XS(KS,"displayName","ErrorBar");var tT=function(e){var t=e.children,n=e.formattedGraphicalItems,r=e.legendWidth,i=e.legendContent,o=wd(t,mm);if(!o)return null;var a,s=mm.defaultProps,l=void 0!==s?$S($S({},s),o.props):{};return a=o.props&&o.props.payload?o.props&&o.props.payload:"children"===i?(n||[]).reduce((function(e,t){var n=t.item,r=t.props,i=r.sectors||r.data||[];return e.concat(i.map((function(e){return{type:o.props.iconType||n.props.legendType,value:e.name,color:e.fill,payload:e}})))}),[]):(n||[]).map((function(e){var t=e.item,n=t.type.defaultProps,r=void 0!==n?$S($S({},n),t.props):{},i=r.dataKey,o=r.name,a=r.legendType;return{inactive:r.hide,dataKey:i,type:l.iconType||a||"square",color:uT(t),value:o||i,payload:r}})),$S($S($S({},l),mm.getWithHeight(o,r)),{},{payload:a,item:o})};function nT(e){return nT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nT(e)}function rT(e){return function(e){if(Array.isArray(e))return iT(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return iT(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return iT(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function iT(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function oT(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function aT(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?oT(Object(n),!0).forEach((function(t){sT(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oT(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function sT(e,t,n){return t=function(e){var t=function(e,t){if("object"!=nT(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=nT(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==nT(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function lT(e,t,n){return Qh()(e)||Qh()(t)?n:Gh(t)?zh()(e,t,n):ed()(t)?t(e):n}function cT(e,t,n,r){var i=oS()(e,(function(e){return lT(e,t)}));if("number"===n){var o=i.filter((function(e){return Uh(e)||parseFloat(e)}));return o.length?[rS()(o),tS()(o)]:[1/0,-1/0]}return(r?i.filter((function(e){return!Qh()(e)})):i).map((function(e){return Gh(e)||e instanceof Date?e:""}))}var uT=function(e){var t,n,r=e.type.displayName,i=null!==(t=e.type)&&void 0!==t&&t.defaultProps?aT(aT({},e.type.defaultProps),e.props):e.props,o=i.stroke,a=i.fill;switch(r){case"Line":n=o;break;case"Area":case"Radar":n=o&&"none"!==o?o:a;break;default:n=a}return n},hT=function(e,t,n,r,i){var o=bd(t.props.children,KS).filter((function(e){return function(e,t,n){return!!Qh()(t)||("horizontal"===e?"yAxis"===t:"vertical"===e||"x"===n?"xAxis"===t:"y"!==n||"yAxis"===t)}(r,i,e.props.direction)}));if(o&&o.length){var a=o.map((function(e){return e.props.dataKey}));return e.reduce((function(e,t){var r=lT(t,n);if(Qh()(r))return e;var i=Array.isArray(r)?[rS()(r),tS()(r)]:[r,r],o=a.reduce((function(e,n){var r=lT(t,n,0),o=i[0]-Math.abs(Array.isArray(r)?r[0]:r),a=i[1]+Math.abs(Array.isArray(r)?r[1]:r);return[Math.min(o,e[0]),Math.max(a,e[1])]}),[1/0,-1/0]);return[Math.min(o[0],e[0]),Math.max(o[1],e[1])]}),[1/0,-1/0])}return null},dT=function(e,t,n,r,i){var o=t.map((function(t){var o=t.props.dataKey;return"number"===n&&o&&hT(e,t,o,r)||cT(e,o,n,i)}));if("number"===n)return o.reduce((function(e,t){return[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}),[1/0,-1/0]);var a={};return o.reduce((function(e,t){for(var n=0,r=t.length;n<r;n++)a[t[n]]||(a[t[n]]=!0,e.push(t[n]));return e}),[])},pT=function(e,t){return"horizontal"===e&&"xAxis"===t||"vertical"===e&&"yAxis"===t||"centric"===e&&"angleAxis"===t||"radial"===e&&"radiusAxis"===t},fT=function(e,t,n,r){if(r)return e.map((function(e){return e.coordinate}));var i,o,a=e.map((function(e){return e.coordinate===t&&(i=!0),e.coordinate===n&&(o=!0),e.coordinate}));return i||a.push(t),o||a.push(n),a},mT=function(e,t,n){if(!e)return null;var r=e.scale,i=e.duplicateDomain,o=e.type,a=e.range,s="scaleBand"===e.realScaleType?r.bandwidth()/2:2,l=(t||n)&&"category"===o&&r.bandwidth?r.bandwidth()/s:0;return l="angleAxis"===e.axisType&&(null===a||void 0===a?void 0:a.length)>=2?2*Bh(a[0]-a[1])*l:l,t&&(e.ticks||e.niceTicks)?(e.ticks||e.niceTicks).map((function(e){var t=i?i.indexOf(e):e;return{coordinate:r(t)+l,value:e,offset:l}})).filter((function(e){return!Dh()(e.coordinate)})):e.isCategorical&&e.categoricalDomain?e.categoricalDomain.map((function(e,t){return{coordinate:r(e)+l,value:e,index:t,offset:l}})):r.ticks&&!n?r.ticks(e.tickCount).map((function(e){return{coordinate:r(e)+l,value:e,offset:l}})):r.domain().map((function(e,t){return{coordinate:r(e)+l,value:i?i[e]:e,index:t,offset:l}}))},gT=new WeakMap,yT=function(e,t){if("function"!==typeof t)return e;gT.has(e)||gT.set(e,new WeakMap);var n=gT.get(e);if(n.has(t))return n.get(t);var r=function(){e.apply(void 0,arguments),t.apply(void 0,arguments)};return n.set(t,r),r},_T=function(t,n,r){var i=t.scale,o=t.type,a=t.layout,s=t.axisType;if("auto"===i)return"radial"===a&&"radiusAxis"===s?{scale:py(),realScaleType:"band"}:"radial"===a&&"angleAxis"===s?{scale:zv(),realScaleType:"linear"}:"category"===o&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?{scale:my(),realScaleType:"point"}:"category"===o?{scale:py(),realScaleType:"band"}:{scale:zv(),realScaleType:"linear"};if(Oh()(i)){var l="scale".concat(Vp()(i));return{scale:(e[l]||my)(),realScaleType:e[l]?l:"point"}}return ed()(i)?{scale:i}:{scale:my(),realScaleType:"point"}},vT=1e-4,xT=function(e){var t=e.domain();if(t&&!(t.length<=2)){var n=t.length,r=e.range(),i=Math.min(r[0],r[1])-vT,o=Math.max(r[0],r[1])+vT,a=e(t[0]),s=e(t[n-1]);(a<i||a>o||s<i||s>o)&&e.domain([t[0],t[n-1]])}},bT={sign:function(e){var t=e.length;if(!(t<=0))for(var n=0,r=e[0].length;n<r;++n)for(var i=0,o=0,a=0;a<t;++a){var s=Dh()(e[a][n][1])?e[a][n][0]:e[a][n][1];s>=0?(e[a][n][0]=i,e[a][n][1]=i+s,i=e[a][n][1]):(e[a][n][0]=o,e[a][n][1]=o+s,o=e[a][n][1])}},expand:function(e,t){if((r=e.length)>0){for(var n,r,i,o=0,a=e[0].length;o<a;++o){for(i=n=0;n<r;++n)i+=e[n][o][1]||0;if(i)for(n=0;n<r;++n)e[n][o][1]/=i}Yw(e,t)}},none:Yw,silhouette:function(e,t){if((n=e.length)>0){for(var n,r=0,i=e[t[0]],o=i.length;r<o;++r){for(var a=0,s=0;a<n;++a)s+=e[a][r][1]||0;i[r][1]+=i[r][0]=-s/2}Yw(e,t)}},wiggle:function(e,t){if((i=e.length)>0&&(r=(n=e[t[0]]).length)>0){for(var n,r,i,o=0,a=1;a<r;++a){for(var s=0,l=0,c=0;s<i;++s){for(var u=e[t[s]],h=u[a][1]||0,d=(h-(u[a-1][1]||0))/2,p=0;p<s;++p){var f=e[t[p]];d+=(f[a][1]||0)-(f[a-1][1]||0)}l+=h,c+=d*h}n[a-1][1]+=n[a-1][0]=o,l&&(o-=c/l)}n[a-1][1]+=n[a-1][0]=o,Yw(e,t)}},positive:function(e){var t=e.length;if(!(t<=0))for(var n=0,r=e[0].length;n<r;++n)for(var i=0,o=0;o<t;++o){var a=Dh()(e[o][n][1])?e[o][n][0]:e[o][n][1];a>=0?(e[o][n][0]=i,e[o][n][1]=i+a,i=e[o][n][1]):(e[o][n][0]=0,e[o][n][1]=0)}}},wT=function(e,t,n){var r=t.map((function(e){return e.props.dataKey})),i=bT[n],o=function(){var e=hf([]),t=Jw,n=Yw,r=Qw;function i(i){var o,a,s=Array.from(e.apply(this,arguments),$w),l=s.length,c=-1;for(const e of i)for(o=0,++c;o<l;++o)(s[o][c]=[0,+r(e,s[o].key,c,i)]).data=e;for(o=0,a=Kw(t(s));o<l;++o)s[a[o]].index=o;return n(s,a),s}return i.keys=function(t){return arguments.length?(e="function"===typeof t?t:hf(Array.from(t)),i):e},i.value=function(e){return arguments.length?(r="function"===typeof e?e:hf(+e),i):r},i.order=function(e){return arguments.length?(t=null==e?Jw:"function"===typeof e?e:hf(Array.from(e)),i):t},i.offset=function(e){return arguments.length?(n=null==e?Yw:e,i):n},i}().keys(r).value((function(e,t){return+lT(e,t,0)})).order(Jw).offset(i);return o(e)},ST=function(e,t){var n=t.realScaleType,r=t.type,i=t.tickCount,o=t.originalDomain,a=t.allowDecimals,s=n||t.scale;if("auto"!==s&&"linear"!==s)return null;if(i&&"number"===r&&o&&("auto"===o[0]||"auto"===o[1])){var l=e.domain();if(!l.length)return null;var c=DS(l,i,a);return e.domain([rS()(c),tS()(c)]),{niceTicks:c}}if(i&&"number"===r){var u=e.domain();return{niceTicks:LS(u,i,a)}}return null};function TT(e){var t=e.axis,n=e.ticks,r=e.bandSize,i=e.entry,o=e.index,a=e.dataKey;if("category"===t.type){if(!t.allowDuplicatedCategory&&t.dataKey&&!Qh()(i[t.dataKey])){var s=Yh(n,"value",i[t.dataKey]);if(s)return s.coordinate+r/2}return n[o]?n[o].coordinate+r/2:null}var l=lT(i,Qh()(a)?t.dataKey:a);return Qh()(l)?null:t.scale(l)}var ET=function(e){var t=e.axis,n=e.ticks,r=e.offset,i=e.bandSize,o=e.entry,a=e.index;if("category"===t.type)return n[a]?n[a].coordinate+r:null;var s=lT(o,t.dataKey,t.domain[a]);return Qh()(s)?null:t.scale(s)-i/2+r},AT=function(e,t,n){return Object.keys(e).reduce((function(r,i){var o=e[i].stackedData.reduce((function(e,r){var i=function(e){return e.reduce((function(e,t){return[rS()(t.concat([e[0]]).filter(Uh)),tS()(t.concat([e[1]]).filter(Uh))]}),[1/0,-1/0])}(r.slice(t,n+1));return[Math.min(e[0],i[0]),Math.max(e[1],i[1])]}),[1/0,-1/0]);return[Math.min(o[0],r[0]),Math.max(o[1],r[1])]}),[1/0,-1/0]).map((function(e){return e===1/0||e===-1/0?0:e}))},MT=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,PT=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,kT=function(e,t,n){if(ed()(e))return e(t,n);if(!Array.isArray(e))return t;var r=[];if(Uh(e[0]))r[0]=n?e[0]:Math.min(e[0],t[0]);else if(MT.test(e[0])){var i=+MT.exec(e[0])[1];r[0]=t[0]-i}else ed()(e[0])?r[0]=e[0](t[0]):r[0]=t[0];if(Uh(e[1]))r[1]=n?e[1]:Math.max(e[1],t[1]);else if(PT.test(e[1])){var o=+PT.exec(e[1])[1];r[1]=t[1]+o}else ed()(e[1])?r[1]=e[1](t[1]):r[1]=t[1];return r},CT=function(e,t,n){if(e&&e.scale&&e.scale.bandwidth){var r=e.scale.bandwidth();if(!n||r>0)return r}if(e&&t&&t.length>=2){for(var i=Vd()(t,(function(e){return e.coordinate})),o=1/0,a=1,s=i.length;a<s;a++){var l=i[a],c=i[a-1];o=Math.min((l.coordinate||0)-(c.coordinate||0),o)}return o===1/0?0:o}return n?void 0:0},jT=function(e,t,n){return e&&e.length?sS()(e,zh()(n,"type.defaultProps.domain"))?t:e:t},IT=function(e,t){var n=e.type.defaultProps?aT(aT({},e.type.defaultProps),e.props):e.props,r=n.dataKey,i=n.name,o=n.unit,a=n.formatter,s=n.tooltipType,l=n.chartType,c=n.hide;return aT(aT({},Md(e,!1)),{},{dataKey:r,unit:o,formatter:a,name:i||r,color:uT(e),value:lT(t,r),type:s,payload:t,chartType:l,hide:c})};function OT(e){return OT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},OT(e)}function NT(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function DT(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?NT(Object(n),!0).forEach((function(t){LT(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):NT(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function LT(e,t,n){return t=function(e){var t=function(e,t){if("object"!=OT(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=OT(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==OT(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var zT=["Webkit","Moz","O","ms"];function RT(e){return RT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},RT(e)}function FT(){return FT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},FT.apply(this,arguments)}function BT(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function VT(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?BT(Object(n),!0).forEach((function(t){WT(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):BT(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function UT(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,XT(r.key),r)}}function GT(e,t,n){return t=ZT(t),function(e,t){if(t&&("object"===RT(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,HT()?Reflect.construct(t,n||[],ZT(e).constructor):t.apply(e,n))}function HT(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(HT=function(){return!!e})()}function ZT(e){return ZT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ZT(e)}function qT(e,t){return qT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},qT(e,t)}function WT(e,t,n){return(t=XT(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function XT(e){var t=function(e,t){if("object"!=RT(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=RT(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==RT(t)?t:t+""}var YT=function(e){return e.changedTouches&&!!e.changedTouches.length},KT=function(e){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),WT(t=GT(this,n,[e]),"handleDrag",(function(e){t.leaveTimer&&(clearTimeout(t.leaveTimer),t.leaveTimer=null),t.state.isTravellerMoving?t.handleTravellerMove(e):t.state.isSlideMoving&&t.handleSlideDrag(e)})),WT(t,"handleTouchMove",(function(e){null!=e.changedTouches&&e.changedTouches.length>0&&t.handleDrag(e.changedTouches[0])})),WT(t,"handleDragEnd",(function(){t.setState({isTravellerMoving:!1,isSlideMoving:!1},(function(){var e=t.props,n=e.endIndex,r=e.onDragEnd,i=e.startIndex;null===r||void 0===r||r({endIndex:n,startIndex:i})})),t.detachDragEndListener()})),WT(t,"handleLeaveWrapper",(function(){(t.state.isTravellerMoving||t.state.isSlideMoving)&&(t.leaveTimer=window.setTimeout(t.handleDragEnd,t.props.leaveTimeOut))})),WT(t,"handleEnterSlideOrTraveller",(function(){t.setState({isTextActive:!0})})),WT(t,"handleLeaveSlideOrTraveller",(function(){t.setState({isTextActive:!1})})),WT(t,"handleSlideDragStart",(function(e){var n=YT(e)?e.changedTouches[0]:e;t.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:n.pageX}),t.attachDragEndListener()})),t.travellerDragStartHandlers={startX:t.handleTravellerDragStart.bind(t,"startX"),endX:t.handleTravellerDragStart.bind(t,"endX")},t.state={},t}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qT(e,t)}(n,e),r=n,i=[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(e){var t=e.startX,r=e.endX,i=this.state.scaleValues,o=this.props,a=o.gap,s=o.data.length-1,l=Math.min(t,r),c=Math.max(t,r),u=n.getIndexInRange(i,l),h=n.getIndexInRange(i,c);return{startIndex:u-u%a,endIndex:h===s?s:h-h%a}}},{key:"getTextOfTick",value:function(e){var t=this.props,n=t.data,r=t.tickFormatter,i=t.dataKey,o=lT(n[e],i,e);return ed()(r)?r(o,e):o}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(e){var t=this.state,n=t.slideMoveStartX,r=t.startX,i=t.endX,o=this.props,a=o.x,s=o.width,l=o.travellerWidth,c=o.startIndex,u=o.endIndex,h=o.onChange,d=e.pageX-n;d>0?d=Math.min(d,a+s-l-i,a+s-l-r):d<0&&(d=Math.max(d,a-r,a-i));var p=this.getIndex({startX:r+d,endX:i+d});p.startIndex===c&&p.endIndex===u||!h||h(p),this.setState({startX:r+d,endX:i+d,slideMoveStartX:e.pageX})}},{key:"handleTravellerDragStart",value:function(e,t){var n=YT(t)?t.changedTouches[0]:t;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:e,brushMoveStartX:n.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(e){var t=this.state,n=t.brushMoveStartX,r=t.movingTravellerId,i=t.endX,o=t.startX,a=this.state[r],s=this.props,l=s.x,c=s.width,u=s.travellerWidth,h=s.onChange,d=s.gap,p=s.data,f={startX:this.state.startX,endX:this.state.endX},m=e.pageX-n;m>0?m=Math.min(m,l+c-u-a):m<0&&(m=Math.max(m,l-a)),f[r]=a+m;var g=this.getIndex(f),y=g.startIndex,_=g.endIndex;this.setState(WT(WT({},r,a+m),"brushMoveStartX",e.pageX),(function(){h&&function(){var e=p.length-1;return"startX"===r&&(i>o?y%d===0:_%d===0)||i<o&&_===e||"endX"===r&&(i>o?_%d===0:y%d===0)||i>o&&_===e}()&&h(g)}))}},{key:"handleTravellerMoveKeyboard",value:function(e,t){var n=this,r=this.state,i=r.scaleValues,o=r.startX,a=r.endX,s=this.state[t],l=i.indexOf(s);if(-1!==l){var c=l+e;if(!(-1===c||c>=i.length)){var u=i[c];"startX"===t&&u>=a||"endX"===t&&u<=o||this.setState(WT({},t,u),(function(){n.props.onChange(n.getIndex({startX:n.state.startX,endX:n.state.endX}))}))}}}},{key:"renderBackground",value:function(){var e=this.props,n=e.x,r=e.y,i=e.width,o=e.height,a=e.fill,s=e.stroke;return t.createElement("rect",{stroke:s,fill:a,x:n,y:r,width:i,height:o})}},{key:"renderPanorama",value:function(){var e=this.props,n=e.x,r=e.y,i=e.width,o=e.height,a=e.data,s=e.children,l=e.padding,c=t.Children.only(s);return c?t.cloneElement(c,{x:n,y:r,width:i,height:o,margin:l,compact:!0,data:a}):null}},{key:"renderTravellerLayer",value:function(e,r){var i,o,a=this,s=this.props,l=s.y,c=s.travellerWidth,u=s.height,h=s.traveller,d=s.ariaLabel,p=s.data,f=s.startIndex,m=s.endIndex,g=Math.max(e,this.props.x),y=VT(VT({},Md(this.props,!1)),{},{x:g,y:l,width:c,height:u}),_=d||"Min value: ".concat(null===(i=p[f])||void 0===i?void 0:i.name,", Max value: ").concat(null===(o=p[m])||void 0===o?void 0:o.name);return t.createElement(Jd,{tabIndex:0,role:"slider","aria-label":_,"aria-valuenow":e,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[r],onTouchStart:this.travellerDragStartHandlers[r],onKeyDown:function(e){["ArrowLeft","ArrowRight"].includes(e.key)&&(e.preventDefault(),e.stopPropagation(),a.handleTravellerMoveKeyboard("ArrowRight"===e.key?1:-1,r))},onFocus:function(){a.setState({isTravellerFocused:!0})},onBlur:function(){a.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},n.renderTraveller(h,y))}},{key:"renderSlide",value:function(e,n){var r=this.props,i=r.y,o=r.height,a=r.stroke,s=r.travellerWidth,l=Math.min(e,n)+s,c=Math.max(Math.abs(n-e)-s,0);return t.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:a,fillOpacity:.2,x:l,y:i,width:c,height:o})}},{key:"renderText",value:function(){var e=this.props,n=e.startIndex,r=e.endIndex,i=e.y,o=e.height,a=e.travellerWidth,s=e.stroke,l=this.state,c=l.startX,u=l.endX,h={pointerEvents:"none",fill:s};return t.createElement(Jd,{className:"recharts-brush-texts"},t.createElement(Qy,FT({textAnchor:"end",verticalAnchor:"middle",x:Math.min(c,u)-5,y:i+o/2},h),this.getTextOfTick(n)),t.createElement(Qy,FT({textAnchor:"start",verticalAnchor:"middle",x:Math.max(c,u)+a+5,y:i+o/2},h),this.getTextOfTick(r)))}},{key:"render",value:function(){var e=this.props,n=e.data,r=e.className,i=e.children,o=e.x,a=e.y,s=e.width,l=e.height,c=e.alwaysShowText,u=this.state,h=u.startX,d=u.endX,p=u.isTextActive,f=u.isSlideMoving,m=u.isTravellerMoving,g=u.isTravellerFocused;if(!n||!n.length||!Uh(o)||!Uh(a)||!Uh(s)||!Uh(l)||s<=0||l<=0)return null;var y=kh("recharts-brush",r),_=1===t.Children.count(i),v=function(e,t){if(!e)return null;var n=e.replace(/(\w)/,(function(e){return e.toUpperCase()})),r=zT.reduce((function(e,r){return DT(DT({},e),{},LT({},r+n,t))}),{});return r[e]=t,r}("userSelect","none");return t.createElement(Jd,{className:y,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:v},this.renderBackground(),_&&this.renderPanorama(),this.renderSlide(h,d),this.renderTravellerLayer(h,"startX"),this.renderTravellerLayer(d,"endX"),(p||f||m||g||c)&&this.renderText())}}],o=[{key:"renderDefaultTraveller",value:function(e){var n=e.x,r=e.y,i=e.width,o=e.height,a=e.stroke,s=Math.floor(r+o/2)-1;return t.createElement(t.Fragment,null,t.createElement("rect",{x:n,y:r,width:i,height:o,fill:a,stroke:"none"}),t.createElement("line",{x1:n+1,y1:s,x2:n+i-1,y2:s,fill:"none",stroke:"#fff"}),t.createElement("line",{x1:n+1,y1:s+2,x2:n+i-1,y2:s+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(e,r){return t.isValidElement(e)?t.cloneElement(e,r):ed()(e)?e(r):n.renderDefaultTraveller(r)}},{key:"getDerivedStateFromProps",value:function(e,t){var n=e.data,r=e.width,i=e.x,o=e.travellerWidth,a=e.updateId,s=e.startIndex,l=e.endIndex;if(n!==t.prevData||a!==t.prevUpdateId)return VT({prevData:n,prevTravellerWidth:o,prevUpdateId:a,prevX:i,prevWidth:r},n&&n.length?function(e){var t=e.data,n=e.startIndex,r=e.endIndex,i=e.x,o=e.width,a=e.travellerWidth;if(!t||!t.length)return{};var s=t.length,l=my().domain(Fd()(0,s)).range([i,i+o-a]),c=l.domain().map((function(e){return l(e)}));return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:l(n),endX:l(r),scale:l,scaleValues:c}}({data:n,width:r,x:i,travellerWidth:o,startIndex:s,endIndex:l}):{scale:null,scaleValues:null});if(t.scale&&(r!==t.prevWidth||i!==t.prevX||o!==t.prevTravellerWidth)){t.scale.range([i,i+r-o]);var c=t.scale.domain().map((function(e){return t.scale(e)}));return{prevData:n,prevTravellerWidth:o,prevUpdateId:a,prevX:i,prevWidth:r,startX:t.scale(e.startIndex),endX:t.scale(e.endIndex),scaleValues:c}}return null}},{key:"getIndexInRange",value:function(e,t){for(var n=0,r=e.length-1;r-n>1;){var i=Math.floor((n+r)/2);e[i]>t?r=i:n=i}return t>=e[r]?r:n}}],i&&UT(r.prototype,i),o&&UT(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,i,o}(t.PureComponent);function JT(e){return JT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},JT(e)}function QT(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?QT(Object(n),!0).forEach((function(t){eE(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):QT(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function eE(e,t,n){return t=function(e){var t=function(e,t){if("object"!=JT(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=JT(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==JT(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function tE(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],l=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){c=!0,i=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw i}}return s}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return nE(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return nE(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function nE(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}WT(KT,"displayName","Brush"),WT(KT,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var rE=Math.PI/180,iE=function(e){return 180*e/Math.PI},oE=function(e,t,n,r){return{x:e+Math.cos(-rE*r)*n,y:t+Math.sin(-rE*r)*n}},aE=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(e-(n.left||0)-(n.right||0)),Math.abs(t-(n.top||0)-(n.bottom||0)))/2},sE=function(e,t){var n=e.x,r=e.y,i=t.cx,o=t.cy,a=function(e,t){var n=e.x,r=e.y,i=t.x,o=t.y;return Math.sqrt(Math.pow(n-i,2)+Math.pow(r-o,2))}({x:n,y:r},{x:i,y:o});if(a<=0)return{radius:a};var s=(n-i)/a,l=Math.acos(s);return r>o&&(l=2*Math.PI-l),{radius:a,angle:iE(l),angleInRadian:l}},lE=function(e,t){var n=t.startAngle,r=t.endAngle,i=Math.floor(n/360),o=Math.floor(r/360);return e+360*Math.min(i,o)},cE=function(e,t){var n=e.x,r=e.y,i=sE({x:n,y:r},t),o=i.radius,a=i.angle,s=t.innerRadius,l=t.outerRadius;if(o<s||o>l)return!1;if(0===o)return!0;var c,u=function(e){var t=e.startAngle,n=e.endAngle,r=Math.floor(t/360),i=Math.floor(n/360),o=Math.min(r,i);return{startAngle:t-360*o,endAngle:n-360*o}}(t),h=u.startAngle,d=u.endAngle,p=a;if(h<=d){for(;p>d;)p-=360;for(;p<h;)p+=360;c=p>=h&&p<=d}else{for(;p>h;)p-=360;for(;p<d;)p+=360;c=p>=d&&p<=h}return c?$T($T({},t),{},{radius:o,angle:lE(p,t)}):null},uE=function(e){return(0,t.isValidElement)(e)||ed()(e)||"boolean"===typeof e?"":e.className};function hE(e){return hE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hE(e)}var dE=["offset"];function pE(e){return function(e){if(Array.isArray(e))return fE(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return fE(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return fE(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fE(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function mE(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function gE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function yE(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?gE(Object(n),!0).forEach((function(t){_E(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gE(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _E(e,t,n){return t=function(e){var t=function(e,t){if("object"!=hE(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=hE(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==hE(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function vE(){return vE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},vE.apply(this,arguments)}var xE=function(e,n,r){var i,o,a=e.position,s=e.viewBox,l=e.offset,c=e.className,u=s,h=u.cx,d=u.cy,p=u.innerRadius,f=u.outerRadius,m=u.startAngle,g=u.endAngle,y=u.clockWise,_=(p+f)/2,v=function(e,t){return Bh(t-e)*Math.min(Math.abs(t-e),360)}(m,g),x=v>=0?1:-1;"insideStart"===a?(i=m+x*l,o=y):"insideEnd"===a?(i=g-x*l,o=!y):"end"===a&&(i=g+x*l,o=y),o=v<=0?o:!o;var b=oE(h,d,_,i),w=oE(h,d,_,i+359*(o?1:-1)),S="M".concat(b.x,",").concat(b.y,"\n    A").concat(_,",").concat(_,",0,1,").concat(o?0:1,",\n    ").concat(w.x,",").concat(w.y),T=Qh()(e.id)?Zh("recharts-radial-line-"):e.id;return t.createElement("text",vE({},r,{dominantBaseline:"central",className:kh("recharts-radial-bar-label",c)}),t.createElement("defs",null,t.createElement("path",{id:T,d:S})),t.createElement("textPath",{xlinkHref:"#".concat(T)},n))};function bE(e){var n,r=e.offset,i=yE({offset:void 0===r?5:r},mE(e,dE)),o=i.viewBox,a=i.position,s=i.value,l=i.children,c=i.content,u=i.className,h=void 0===u?"":u,d=i.textBreakAll;if(!o||Qh()(s)&&Qh()(l)&&!(0,t.isValidElement)(c)&&!ed()(c))return null;if((0,t.isValidElement)(c))return(0,t.cloneElement)(c,i);if(ed()(c)){if(n=(0,t.createElement)(c,i),(0,t.isValidElement)(n))return n}else n=function(e){var t=e.value,n=e.formatter,r=Qh()(e.children)?t:e.children;return ed()(n)?n(r):r}(i);var p=function(e){return"cx"in e&&Uh(e.cx)}(o),f=Md(i,!0);if(p&&("insideStart"===a||"insideEnd"===a||"end"===a))return xE(i,n,f);var m=p?function(e){var t=e.viewBox,n=e.offset,r=e.position,i=t,o=i.cx,a=i.cy,s=i.innerRadius,l=i.outerRadius,c=(i.startAngle+i.endAngle)/2;if("outside"===r){var u=oE(o,a,l+n,c),h=u.x;return{x:h,y:u.y,textAnchor:h>=o?"start":"end",verticalAnchor:"middle"}}if("center"===r)return{x:o,y:a,textAnchor:"middle",verticalAnchor:"middle"};if("centerTop"===r)return{x:o,y:a,textAnchor:"middle",verticalAnchor:"start"};if("centerBottom"===r)return{x:o,y:a,textAnchor:"middle",verticalAnchor:"end"};var d=oE(o,a,(s+l)/2,c);return{x:d.x,y:d.y,textAnchor:"middle",verticalAnchor:"middle"}}(i):function(e){var t=e.viewBox,n=e.parentViewBox,r=e.offset,i=e.position,o=t,a=o.x,s=o.y,l=o.width,c=o.height,u=c>=0?1:-1,h=u*r,d=u>0?"end":"start",p=u>0?"start":"end",f=l>=0?1:-1,m=f*r,g=f>0?"end":"start",y=f>0?"start":"end";if("top"===i)return yE(yE({},{x:a+l/2,y:s-u*r,textAnchor:"middle",verticalAnchor:d}),n?{height:Math.max(s-n.y,0),width:l}:{});if("bottom"===i)return yE(yE({},{x:a+l/2,y:s+c+h,textAnchor:"middle",verticalAnchor:p}),n?{height:Math.max(n.y+n.height-(s+c),0),width:l}:{});if("left"===i){var _={x:a-m,y:s+c/2,textAnchor:g,verticalAnchor:"middle"};return yE(yE({},_),n?{width:Math.max(_.x-n.x,0),height:c}:{})}if("right"===i){var v={x:a+l+m,y:s+c/2,textAnchor:y,verticalAnchor:"middle"};return yE(yE({},v),n?{width:Math.max(n.x+n.width-v.x,0),height:c}:{})}var x=n?{width:l,height:c}:{};return"insideLeft"===i?yE({x:a+m,y:s+c/2,textAnchor:y,verticalAnchor:"middle"},x):"insideRight"===i?yE({x:a+l-m,y:s+c/2,textAnchor:g,verticalAnchor:"middle"},x):"insideTop"===i?yE({x:a+l/2,y:s+h,textAnchor:"middle",verticalAnchor:p},x):"insideBottom"===i?yE({x:a+l/2,y:s+c-h,textAnchor:"middle",verticalAnchor:d},x):"insideTopLeft"===i?yE({x:a+m,y:s+h,textAnchor:y,verticalAnchor:p},x):"insideTopRight"===i?yE({x:a+l-m,y:s+h,textAnchor:g,verticalAnchor:p},x):"insideBottomLeft"===i?yE({x:a+m,y:s+c-h,textAnchor:y,verticalAnchor:d},x):"insideBottomRight"===i?yE({x:a+l-m,y:s+c-h,textAnchor:g,verticalAnchor:d},x):nd()(i)&&(Uh(i.x)||Vh(i.x))&&(Uh(i.y)||Vh(i.y))?yE({x:a+qh(i.x,l),y:s+qh(i.y,c),textAnchor:"end",verticalAnchor:"end"},x):yE({x:a+l/2,y:s+c/2,textAnchor:"middle",verticalAnchor:"middle"},x)}(i);return t.createElement(Qy,vE({className:kh("recharts-label",h)},f,m,{breakAll:d}),n)}bE.displayName="Label";var wE=function(e){var t=e.cx,n=e.cy,r=e.angle,i=e.startAngle,o=e.endAngle,a=e.r,s=e.radius,l=e.innerRadius,c=e.outerRadius,u=e.x,h=e.y,d=e.top,p=e.left,f=e.width,m=e.height,g=e.clockWise,y=e.labelViewBox;if(y)return y;if(Uh(f)&&Uh(m)){if(Uh(u)&&Uh(h))return{x:u,y:h,width:f,height:m};if(Uh(d)&&Uh(p))return{x:d,y:p,width:f,height:m}}return Uh(u)&&Uh(h)?{x:u,y:h,width:0,height:0}:Uh(t)&&Uh(n)?{cx:t,cy:n,startAngle:i||r||0,endAngle:o||r||0,innerRadius:l||0,outerRadius:c||s||a||0,clockWise:g}:e.viewBox?e.viewBox:{}};bE.parseViewBox=wE,bE.renderCallByParent=function(e,n){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!e||!e.children&&r&&!e.label)return null;var i=e.children,o=wE(e),a=bd(i,bE).map((function(e,r){return(0,t.cloneElement)(e,{viewBox:n||o,key:"label-".concat(r)})}));if(!r)return a;var s=function(e,n){return e?!0===e?t.createElement(bE,{key:"label-implicit",viewBox:n}):Gh(e)?t.createElement(bE,{key:"label-implicit",viewBox:n,value:e}):(0,t.isValidElement)(e)?e.type===bE?(0,t.cloneElement)(e,{key:"label-implicit",viewBox:n}):t.createElement(bE,{key:"label-implicit",content:e,viewBox:n}):ed()(e)?t.createElement(bE,{key:"label-implicit",content:e,viewBox:n}):nd()(e)?t.createElement(bE,vE({viewBox:n},e,{key:"label-implicit"})):null:null}(e.label,n||o);return[s].concat(pE(a))};var SE=function(e,t){var n=e.alwaysShow,r=e.ifOverflow;return n&&(r="extendDomain"),r===t},TE=n(1733),EE=n.n(TE),AE=n(7002),ME=n.n(AE),PE=function(e){return null};PE.displayName="Cell";var kE=n(4065),CE=n.n(kE);function jE(e){return jE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jE(e)}var IE=["valueAccessor"],OE=["data","dataKey","clockWise","id","textBreakAll"];function NE(e){return function(e){if(Array.isArray(e))return DE(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return DE(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return DE(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function DE(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function LE(){return LE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},LE.apply(this,arguments)}function zE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function RE(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?zE(Object(n),!0).forEach((function(t){FE(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zE(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function FE(e,t,n){return t=function(e){var t=function(e,t){if("object"!=jE(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=jE(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==jE(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function BE(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var VE=function(e){return Array.isArray(e.value)?CE()(e.value):e.value};function UE(e){var n=e.valueAccessor,r=void 0===n?VE:n,i=BE(e,IE),o=i.data,a=i.dataKey,s=i.clockWise,l=i.id,c=i.textBreakAll,u=BE(i,OE);return o&&o.length?t.createElement(Jd,{className:"recharts-label-list"},o.map((function(e,n){var i=Qh()(a)?r(e,n):lT(e&&e.payload,a),o=Qh()(l)?{}:{id:"".concat(l,"-").concat(n)};return t.createElement(bE,LE({},Md(e,!0),u,o,{parentViewBox:e.parentViewBox,value:i,textBreakAll:c,viewBox:bE.parseViewBox(Qh()(s)?e:RE(RE({},e),{},{clockWise:s})),key:"label-".concat(n),index:n}))}))):null}UE.displayName="LabelList",UE.renderCallByParent=function(e,n){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!e||!e.children&&r&&!e.label)return null;var i=bd(e.children,UE).map((function(e,r){return(0,t.cloneElement)(e,{data:n,key:"labelList-".concat(r)})}));if(!r)return i;var o=function(e,n){return e?!0===e?t.createElement(UE,{key:"labelList-implicit",data:n}):t.isValidElement(e)||ed()(e)?t.createElement(UE,{key:"labelList-implicit",data:n,content:e}):nd()(e)?t.createElement(UE,LE({data:n},e,{key:"labelList-implicit"})):null:null}(e.label,n);return[o].concat(NE(i))};var GE=n(2322),HE=n.n(GE),ZE=n(6361),qE=n.n(ZE);function WE(e){return WE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},WE(e)}function XE(){return XE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},XE.apply(this,arguments)}function YE(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],l=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){c=!0,i=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw i}}return s}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return KE(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return KE(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function KE(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function JE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function QE(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?JE(Object(n),!0).forEach((function(t){$E(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):JE(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function $E(e,t,n){return t=function(e){var t=function(e,t){if("object"!=WE(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=WE(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==WE(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var eA=function(e,t,n,r,i){var o,a=n-r;return o="M ".concat(e,",").concat(t),o+="L ".concat(e+n,",").concat(t),o+="L ".concat(e+n-a/2,",").concat(t+i),o+="L ".concat(e+n-a/2-r,",").concat(t+i),o+="L ".concat(e,",").concat(t," Z")},tA={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},nA=function(e){var n=QE(QE({},tA),e),r=(0,t.useRef)(),i=YE((0,t.useState)(-1),2),o=i[0],a=i[1];(0,t.useEffect)((function(){if(r.current&&r.current.getTotalLength)try{var e=r.current.getTotalLength();e&&a(e)}catch(t){}}),[]);var s=n.x,l=n.y,c=n.upperWidth,u=n.lowerWidth,h=n.height,d=n.className,p=n.animationEasing,f=n.animationDuration,m=n.animationBegin,g=n.isUpdateAnimationActive;if(s!==+s||l!==+l||c!==+c||u!==+u||h!==+h||0===c&&0===u||0===h)return null;var y=kh("recharts-trapezoid",d);return g?t.createElement(qg,{canBegin:o>0,from:{upperWidth:0,lowerWidth:0,height:h,x:s,y:l},to:{upperWidth:c,lowerWidth:u,height:h,x:s,y:l},duration:f,animationEasing:p,isActive:g},(function(e){var i=e.upperWidth,a=e.lowerWidth,s=e.height,l=e.x,c=e.y;return t.createElement(qg,{canBegin:o>0,from:"0px ".concat(-1===o?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:m,duration:f,easing:p},t.createElement("path",XE({},Md(n,!0),{className:y,d:eA(l,c,i,a,s),ref:r})))})):t.createElement("g",null,t.createElement("path",XE({},Md(n,!0),{className:y,d:eA(s,l,c,u,h)})))};function rA(e){return rA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rA(e)}function iA(){return iA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},iA.apply(this,arguments)}function oA(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function aA(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?oA(Object(n),!0).forEach((function(t){sA(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oA(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function sA(e,t,n){return t=function(e){var t=function(e,t){if("object"!=rA(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=rA(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==rA(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var lA=function(e){var t=e.cx,n=e.cy,r=e.radius,i=e.angle,o=e.sign,a=e.isExternal,s=e.cornerRadius,l=e.cornerIsExternal,c=s*(a?1:-1)+r,u=Math.asin(s/c)/rE,h=l?i:i+o*u,d=l?i-o*u:i;return{center:oE(t,n,c,h),circleTangency:oE(t,n,r,h),lineTangency:oE(t,n,c*Math.cos(u*rE),d),theta:u}},cA=function(e){var t=e.cx,n=e.cy,r=e.innerRadius,i=e.outerRadius,o=e.startAngle,a=function(e,t){return Bh(t-e)*Math.min(Math.abs(t-e),359.999)}(o,e.endAngle),s=o+a,l=oE(t,n,i,o),c=oE(t,n,i,s),u="M ".concat(l.x,",").concat(l.y,"\n    A ").concat(i,",").concat(i,",0,\n    ").concat(+(Math.abs(a)>180),",").concat(+(o>s),",\n    ").concat(c.x,",").concat(c.y,"\n  ");if(r>0){var h=oE(t,n,r,o),d=oE(t,n,r,s);u+="L ".concat(d.x,",").concat(d.y,"\n            A ").concat(r,",").concat(r,",0,\n            ").concat(+(Math.abs(a)>180),",").concat(+(o<=s),",\n            ").concat(h.x,",").concat(h.y," Z")}else u+="L ".concat(t,",").concat(n," Z");return u},uA={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},hA=function(e){var n=aA(aA({},uA),e),r=n.cx,i=n.cy,o=n.innerRadius,a=n.outerRadius,s=n.cornerRadius,l=n.forceCornerRadius,c=n.cornerIsExternal,u=n.startAngle,h=n.endAngle,d=n.className;if(a<o||u===h)return null;var p,f=kh("recharts-sector",d),m=a-o,g=qh(s,m,0,!0);return p=g>0&&Math.abs(u-h)<360?function(e){var t=e.cx,n=e.cy,r=e.innerRadius,i=e.outerRadius,o=e.cornerRadius,a=e.forceCornerRadius,s=e.cornerIsExternal,l=e.startAngle,c=e.endAngle,u=Bh(c-l),h=lA({cx:t,cy:n,radius:i,angle:l,sign:u,cornerRadius:o,cornerIsExternal:s}),d=h.circleTangency,p=h.lineTangency,f=h.theta,m=lA({cx:t,cy:n,radius:i,angle:c,sign:-u,cornerRadius:o,cornerIsExternal:s}),g=m.circleTangency,y=m.lineTangency,_=m.theta,v=s?Math.abs(l-c):Math.abs(l-c)-f-_;if(v<0)return a?"M ".concat(p.x,",").concat(p.y,"\n        a").concat(o,",").concat(o,",0,0,1,").concat(2*o,",0\n        a").concat(o,",").concat(o,",0,0,1,").concat(2*-o,",0\n      "):cA({cx:t,cy:n,innerRadius:r,outerRadius:i,startAngle:l,endAngle:c});var x="M ".concat(p.x,",").concat(p.y,"\n    A").concat(o,",").concat(o,",0,0,").concat(+(u<0),",").concat(d.x,",").concat(d.y,"\n    A").concat(i,",").concat(i,",0,").concat(+(v>180),",").concat(+(u<0),",").concat(g.x,",").concat(g.y,"\n    A").concat(o,",").concat(o,",0,0,").concat(+(u<0),",").concat(y.x,",").concat(y.y,"\n  ");if(r>0){var b=lA({cx:t,cy:n,radius:r,angle:l,sign:u,isExternal:!0,cornerRadius:o,cornerIsExternal:s}),w=b.circleTangency,S=b.lineTangency,T=b.theta,E=lA({cx:t,cy:n,radius:r,angle:c,sign:-u,isExternal:!0,cornerRadius:o,cornerIsExternal:s}),A=E.circleTangency,M=E.lineTangency,P=E.theta,k=s?Math.abs(l-c):Math.abs(l-c)-T-P;if(k<0&&0===o)return"".concat(x,"L").concat(t,",").concat(n,"Z");x+="L".concat(M.x,",").concat(M.y,"\n      A").concat(o,",").concat(o,",0,0,").concat(+(u<0),",").concat(A.x,",").concat(A.y,"\n      A").concat(r,",").concat(r,",0,").concat(+(k>180),",").concat(+(u>0),",").concat(w.x,",").concat(w.y,"\n      A").concat(o,",").concat(o,",0,0,").concat(+(u<0),",").concat(S.x,",").concat(S.y,"Z")}else x+="L".concat(t,",").concat(n,"Z");return x}({cx:r,cy:i,innerRadius:o,outerRadius:a,cornerRadius:Math.min(g,m/2),forceCornerRadius:l,cornerIsExternal:c,startAngle:u,endAngle:h}):cA({cx:r,cy:i,innerRadius:o,outerRadius:a,startAngle:u,endAngle:h}),t.createElement("path",iA({},Md(n,!0),{className:f,d:p,role:"img"}))},dA=["option","shapeType","propTransformer","activeClassName","isActive"];function pA(e){return pA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pA(e)}function fA(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function mA(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function gA(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?mA(Object(n),!0).forEach((function(t){yA(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mA(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function yA(e,t,n){return t=function(e){var t=function(e,t){if("object"!=pA(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=pA(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==pA(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _A(e,t){return gA(gA({},t),e)}function vA(e){var n=e.shapeType,r=e.elementProps;switch(n){case"rectangle":return t.createElement(ry,r);case"trapezoid":return t.createElement(nA,r);case"sector":return t.createElement(hA,r);case"symbols":if(function(e){return"symbols"===e}(n))return t.createElement(Gf,r);break;default:return null}}function xA(e){var n,r=e.option,i=e.shapeType,o=e.propTransformer,a=void 0===o?_A:o,s=e.activeClassName,l=void 0===s?"recharts-active-shape":s,c=e.isActive,u=fA(e,dA);if((0,t.isValidElement)(r))n=(0,t.cloneElement)(r,gA(gA({},u),function(e){return(0,t.isValidElement)(e)?e.props:e}(r)));else if(ed()(r))n=r(u);else if(HE()(r)&&!qE()(r)){var h=a(r,u);n=t.createElement(vA,{shapeType:i,elementProps:h})}else{var d=u;n=t.createElement(vA,{shapeType:i,elementProps:d})}return c?t.createElement(Jd,{className:l},n):n}function bA(e,t){return null!=t&&"trapezoids"in e.props}function wA(e,t){return null!=t&&"sectors"in e.props}function SA(e,t){return null!=t&&"points"in e.props}function TA(e,t){var n,r,i=e.x===(null===t||void 0===t||null===(n=t.labelViewBox)||void 0===n?void 0:n.x)||e.x===t.x,o=e.y===(null===t||void 0===t||null===(r=t.labelViewBox)||void 0===r?void 0:r.y)||e.y===t.y;return i&&o}function EA(e,t){var n=e.endAngle===t.endAngle,r=e.startAngle===t.startAngle;return n&&r}function AA(e,t){var n=e.x===t.x,r=e.y===t.y,i=e.z===t.z;return n&&r&&i}function MA(e){var t=e.activeTooltipItem,n=e.graphicalItem,r=e.itemData,i=function(e,t){var n;return bA(e,t)?n="trapezoids":wA(e,t)?n="sectors":SA(e,t)&&(n="points"),n}(n,t),o=function(e,t){var n,r;return bA(e,t)?null===(n=t.tooltipPayload)||void 0===n||null===(n=n[0])||void 0===n||null===(n=n.payload)||void 0===n?void 0:n.payload:wA(e,t)?null===(r=t.tooltipPayload)||void 0===r||null===(r=r[0])||void 0===r||null===(r=r.payload)||void 0===r?void 0:r.payload:SA(e,t)?t.payload:{}}(n,t),a=r.filter((function(e,r){var a=sS()(o,e),s=n.props[i].filter((function(e){var r=function(e,t){var n;return bA(e,t)?n=TA:wA(e,t)?n=EA:SA(e,t)&&(n=AA),n}(n,t);return r(e,t)})),l=n.props[i].indexOf(s[s.length-1]);return a&&r===l}));return r.indexOf(a[a.length-1])}var PA=["x","y"];function kA(e){return kA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kA(e)}function CA(){return CA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},CA.apply(this,arguments)}function jA(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function IA(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?jA(Object(n),!0).forEach((function(t){OA(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jA(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function OA(e,t,n){return t=function(e){var t=function(e,t){if("object"!=kA(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=kA(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==kA(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function NA(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function DA(e,t){var n=e.x,r=e.y,i=NA(e,PA),o="".concat(n),a=parseInt(o,10),s="".concat(r),l=parseInt(s,10),c="".concat(t.height||i.height),u=parseInt(c,10),h="".concat(t.width||i.width),d=parseInt(h,10);return IA(IA(IA(IA(IA({},t),i),a?{x:a}:{}),l?{y:l}:{}),{},{height:u,width:d,name:t.name,radius:t.radius})}function LA(e){return t.createElement(xA,CA({shapeType:"rectangle",propTransformer:DA,activeClassName:"recharts-active-bar"},e))}var zA,RA=["value","background"];function FA(e){return FA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},FA(e)}function BA(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function VA(){return VA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},VA.apply(this,arguments)}function UA(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function GA(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?UA(Object(n),!0).forEach((function(t){YA(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):UA(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function HA(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,KA(r.key),r)}}function ZA(e,t,n){return t=WA(t),function(e,t){if(t&&("object"===FA(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,qA()?Reflect.construct(t,n||[],WA(e).constructor):t.apply(e,n))}function qA(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(qA=function(){return!!e})()}function WA(e){return WA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},WA(e)}function XA(e,t){return XA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},XA(e,t)}function YA(e,t,n){return(t=KA(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function KA(e){var t=function(e,t){if("object"!=FA(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=FA(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==FA(t)?t:t+""}var JA=function(e){function n(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return YA(e=ZA(this,n,[].concat(r)),"state",{isAnimationFinished:!1}),YA(e,"id",Zh("recharts-bar-")),YA(e,"handleAnimationEnd",(function(){var t=e.props.onAnimationEnd;e.setState({isAnimationFinished:!0}),t&&t()})),YA(e,"handleAnimationStart",(function(){var t=e.props.onAnimationStart;e.setState({isAnimationFinished:!1}),t&&t()})),e}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&XA(e,t)}(n,e),r=n,i=[{key:"renderRectanglesStatically",value:function(e){var n=this,r=this.props,i=r.shape,o=r.dataKey,a=r.activeIndex,s=r.activeBar,l=Md(this.props,!1);return e&&e.map((function(e,r){var c=r===a,u=c?s:i,h=GA(GA(GA({},l),e),{},{isActive:c,option:u,index:r,dataKey:o,onAnimationStart:n.handleAnimationStart,onAnimationEnd:n.handleAnimationEnd});return t.createElement(Jd,VA({className:"recharts-bar-rectangle"},hd(n.props,e,r),{key:"rectangle-".concat(null===e||void 0===e?void 0:e.x,"-").concat(null===e||void 0===e?void 0:e.y,"-").concat(null===e||void 0===e?void 0:e.value)}),t.createElement(LA,h))}))}},{key:"renderRectanglesWithAnimation",value:function(){var e=this,n=this.props,r=n.data,i=n.layout,o=n.isAnimationActive,a=n.animationBegin,s=n.animationDuration,l=n.animationEasing,c=n.animationId,u=this.state.prevData;return t.createElement(qg,{begin:a,duration:s,isActive:o,easing:l,from:{t:0},to:{t:1},key:"bar-".concat(c),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},(function(n){var o=n.t,a=r.map((function(e,t){var n=u&&u[t];if(n){var r=Xh(n.x,e.x),a=Xh(n.y,e.y),s=Xh(n.width,e.width),l=Xh(n.height,e.height);return GA(GA({},e),{},{x:r(o),y:a(o),width:s(o),height:l(o)})}if("horizontal"===i){var c=Xh(0,e.height)(o);return GA(GA({},e),{},{y:e.y+e.height-c,height:c})}var h=Xh(0,e.width)(o);return GA(GA({},e),{},{width:h})}));return t.createElement(Jd,null,e.renderRectanglesStatically(a))}))}},{key:"renderRectangles",value:function(){var e=this.props,t=e.data,n=e.isAnimationActive,r=this.state.prevData;return!(n&&t&&t.length)||r&&sS()(r,t)?this.renderRectanglesStatically(t):this.renderRectanglesWithAnimation()}},{key:"renderBackground",value:function(){var e=this,n=this.props,r=n.data,i=n.dataKey,o=n.activeIndex,a=Md(this.props.background,!1);return r.map((function(n,r){n.value;var s=n.background,l=BA(n,RA);if(!s)return null;var c=GA(GA(GA(GA(GA({},l),{},{fill:"#eee"},s),a),hd(e.props,n,r)),{},{onAnimationStart:e.handleAnimationStart,onAnimationEnd:e.handleAnimationEnd,dataKey:i,index:r,className:"recharts-bar-background-rectangle"});return t.createElement(LA,VA({key:"background-bar-".concat(r),option:e.props.background,isActive:r===o},c))}))}},{key:"renderErrorBar",value:function(e,n){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var r=this.props,i=r.data,o=r.xAxis,a=r.yAxis,s=r.layout,l=bd(r.children,KS);if(!l)return null;var c="vertical"===s?i[0].height/2:i[0].width/2,u=function(e,t){var n=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:n,errorVal:lT(e,t)}},h={clipPath:e?"url(#clipPath-".concat(n,")"):null};return t.createElement(Jd,h,l.map((function(e){return t.cloneElement(e,{key:"error-bar-".concat(n,"-").concat(e.props.dataKey),data:i,xAxis:o,yAxis:a,layout:s,offset:c,dataPointFormatter:u})})))}},{key:"render",value:function(){var e=this.props,n=e.hide,r=e.data,i=e.className,o=e.xAxis,a=e.yAxis,s=e.left,l=e.top,c=e.width,u=e.height,h=e.isAnimationActive,d=e.background,p=e.id;if(n||!r||!r.length)return null;var f=this.state.isAnimationFinished,m=kh("recharts-bar",i),g=o&&o.allowDataOverflow,y=a&&a.allowDataOverflow,_=g||y,v=Qh()(p)?this.id:p;return t.createElement(Jd,{className:m},g||y?t.createElement("defs",null,t.createElement("clipPath",{id:"clipPath-".concat(v)},t.createElement("rect",{x:g?s:s-c/2,y:y?l:l-u/2,width:g?c:2*c,height:y?u:2*u}))):null,t.createElement(Jd,{className:"recharts-bar-rectangles",clipPath:_?"url(#clipPath-".concat(v,")"):null},d?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(_,v),(!h||f)&&UE.renderCallByParent(this.props,r))}}],o=[{key:"getDerivedStateFromProps",value:function(e,t){return e.animationId!==t.prevAnimationId?{prevAnimationId:e.animationId,curData:e.data,prevData:t.curData}:e.data!==t.curData?{curData:e.data}:null}}],i&&HA(r.prototype,i),o&&HA(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,i,o}(t.PureComponent);function QA(e){return QA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},QA(e)}function $A(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,rM(r.key),r)}}function eM(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function tM(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?eM(Object(n),!0).forEach((function(t){nM(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eM(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function nM(e,t,n){return(t=rM(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function rM(e){var t=function(e,t){if("object"!=QA(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=QA(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==QA(t)?t:t+""}zA=JA,YA(JA,"displayName","Bar"),YA(JA,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!Tp.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"}),YA(JA,"getComposedData",(function(e){var t=e.props,n=e.item,r=e.barPosition,i=e.bandSize,o=e.xAxis,a=e.yAxis,s=e.xAxisTicks,l=e.yAxisTicks,c=e.stackedData,u=e.dataStartIndex,h=e.displayedData,d=e.offset,p=function(e,t){if(!e)return null;for(var n=0,r=e.length;n<r;n++)if(e[n].item===t)return e[n].position;return null}(r,n);if(!p)return null;var f=t.layout,m=n.type.defaultProps,g=void 0!==m?GA(GA({},m),n.props):n.props,y=g.dataKey,_=g.children,v=g.minPointSize,x="horizontal"===f?a:o,b=c?x.scale.domain():null,w=function(e){var t=e.numericAxis,n=t.scale.domain();if("number"===t.type){var r=Math.min(n[0],n[1]),i=Math.max(n[0],n[1]);return r<=0&&i>=0?0:i<0?i:r}return n[0]}({numericAxis:x}),S=bd(_,PE),T=h.map((function(e,t){var r,h,d,m,g,_;c?r=function(e,t){if(!t||2!==t.length||!Uh(t[0])||!Uh(t[1]))return e;var n=Math.min(t[0],t[1]),r=Math.max(t[0],t[1]),i=[e[0],e[1]];return(!Uh(e[0])||e[0]<n)&&(i[0]=n),(!Uh(e[1])||e[1]>r)&&(i[1]=r),i[0]>r&&(i[0]=r),i[1]<n&&(i[1]=n),i}(c[u+t],b):(r=lT(e,y),Array.isArray(r)||(r=[w,r]));var x=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return function(n,r){if("number"===typeof e)return e;var i="number"===typeof n;return i?e(n,r):(i||Gd(!1),t)}}(v,zA.defaultProps.minPointSize)(r[1],t);if("horizontal"===f){var T,E=[a.scale(r[0]),a.scale(r[1])],A=E[0],M=E[1];h=ET({axis:o,ticks:s,bandSize:i,offset:p.offset,entry:e,index:t}),d=null!==(T=null!==M&&void 0!==M?M:A)&&void 0!==T?T:void 0,m=p.size;var P=A-M;if(g=Number.isNaN(P)?0:P,_={x:h,y:a.y,width:m,height:a.height},Math.abs(x)>0&&Math.abs(g)<Math.abs(x)){var k=Bh(g||x)*(Math.abs(x)-Math.abs(g));d-=k,g+=k}}else{var C=[o.scale(r[0]),o.scale(r[1])],j=C[0],I=C[1];if(h=j,d=ET({axis:a,ticks:l,bandSize:i,offset:p.offset,entry:e,index:t}),m=I-j,g=p.size,_={x:o.x,y:d,width:o.width,height:g},Math.abs(x)>0&&Math.abs(m)<Math.abs(x))m+=Bh(m||x)*(Math.abs(x)-Math.abs(m))}return GA(GA(GA({},e),{},{x:h,y:d,width:m,height:g,value:c?r:r[1],payload:e,background:_},S&&S[t]&&S[t].props),{},{tooltipPayload:[IT(n,e)],tooltipPosition:{x:h+m/2,y:d+g/2}})}));return GA({data:T,layout:f},d)}));var iM=function(e,t,n,r,i){var o=e.width,a=e.height,s=e.layout,l=e.children,c=Object.keys(t),u={left:n.left,leftMirror:n.left,right:o-n.right,rightMirror:o-n.right,top:n.top,topMirror:n.top,bottom:a-n.bottom,bottomMirror:a-n.bottom},h=!!wd(l,JA);return c.reduce((function(o,a){var l,c,d,p,f,m=t[a],g=m.orientation,y=m.domain,_=m.padding,v=void 0===_?{}:_,x=m.mirror,b=m.reversed,w="".concat(g).concat(x?"Mirror":"");if("number"===m.type&&("gap"===m.padding||"no-gap"===m.padding)){var S=y[1]-y[0],T=1/0,E=m.categoricalDomain.sort();if(E.forEach((function(e,t){t>0&&(T=Math.min((e||0)-(E[t-1]||0),T))})),Number.isFinite(T)){var A=T/S,M="vertical"===m.layout?n.height:n.width;if("gap"===m.padding&&(l=A*M/2),"no-gap"===m.padding){var P=qh(e.barCategoryGap,A*M),k=A*M/2;l=k-P-(k-P)/M*P}}}c="xAxis"===r?[n.left+(v.left||0)+(l||0),n.left+n.width-(v.right||0)-(l||0)]:"yAxis"===r?"horizontal"===s?[n.top+n.height-(v.bottom||0),n.top+(v.top||0)]:[n.top+(v.top||0)+(l||0),n.top+n.height-(v.bottom||0)-(l||0)]:m.range,b&&(c=[c[1],c[0]]);var C=_T(m,i,h),j=C.scale,I=C.realScaleType;j.domain(y).range(c),xT(j);var O=ST(j,tM(tM({},m),{},{realScaleType:I}));"xAxis"===r?(f="top"===g&&!x||"bottom"===g&&x,d=n.left,p=u[w]-f*m.height):"yAxis"===r&&(f="left"===g&&!x||"right"===g&&x,d=u[w]-f*m.width,p=n.top);var N=tM(tM(tM({},m),O),{},{realScaleType:I,x:d,y:p,scale:j,width:"xAxis"===r?n.width:m.width,height:"yAxis"===r?n.height:m.height});return N.bandSize=CT(N,O),m.hide||"xAxis"!==r?m.hide||(u[w]+=(f?-1:1)*N.width):u[w]+=(f?-1:1)*N.height,tM(tM({},o),{},nM({},a,N))}),{})},oM=function(e,t){var n=e.x,r=e.y,i=t.x,o=t.y;return{x:Math.min(n,i),y:Math.min(r,o),width:Math.abs(i-n),height:Math.abs(o-r)}},aM=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scale=t}return t=e,n=[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.bandAware,r=t.position;if(void 0!==e){if(r)switch(r){case"start":default:return this.scale(e);case"middle":var i=this.bandwidth?this.bandwidth()/2:0;return this.scale(e)+i;case"end":var o=this.bandwidth?this.bandwidth():0;return this.scale(e)+o}if(n){var a=this.bandwidth?this.bandwidth()/2:0;return this.scale(e)+a}return this.scale(e)}}},{key:"isInRange",value:function(e){var t=this.range(),n=t[0],r=t[t.length-1];return n<=r?e>=n&&e<=r:e>=r&&e<=n}}],r=[{key:"create",value:function(t){return new e(t)}}],n&&$A(t.prototype,n),r&&$A(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,r}();nM(aM,"EPS",1e-4);var sM=function(e){var t=Object.keys(e).reduce((function(t,n){return tM(tM({},t),{},nM({},n,aM.create(e[n])))}),{});return tM(tM({},t),{},{apply:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.bandAware,i=n.position;return EE()(e,(function(e,n){return t[n].apply(e,{bandAware:r,position:i})}))},isInRange:function(e){return ME()(e,(function(e,n){return t[n].isInRange(e)}))}})};function lM(){return lM=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},lM.apply(this,arguments)}function cM(e){return cM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cM(e)}function uM(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function hM(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?uM(Object(n),!0).forEach((function(t){yM(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):uM(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function dM(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_M(r.key),r)}}function pM(e,t,n){return t=mM(t),function(e,t){if(t&&("object"===cM(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,fM()?Reflect.construct(t,n||[],mM(e).constructor):t.apply(e,n))}function fM(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(fM=function(){return!!e})()}function mM(e){return mM=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},mM(e)}function gM(e,t){return gM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},gM(e,t)}function yM(e,t,n){return(t=_M(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _M(e){var t=function(e,t){if("object"!=cM(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=cM(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==cM(t)?t:t+""}var vM=function(e){function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),pM(this,n,arguments)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gM(e,t)}(n,e),r=n,i=[{key:"render",value:function(){var e=this.props,r=e.x,i=e.y,o=e.r,a=e.alwaysShow,s=e.clipPathId,l=Gh(r),c=Gh(i);if(Kh(void 0===a,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!l||!c)return null;var u=function(e){var t=e.x,n=e.y,r=e.xAxis,i=e.yAxis,o=sM({x:r.scale,y:i.scale}),a=o.apply({x:t,y:n},{bandAware:!0});return SE(e,"discard")&&!o.isInRange(a)?null:a}(this.props);if(!u)return null;var h=u.x,d=u.y,p=this.props,f=p.shape,m=p.className,g=hM(hM({clipPath:SE(this.props,"hidden")?"url(#".concat(s,")"):void 0},Md(this.props,!0)),{},{cx:h,cy:d});return t.createElement(Jd,{className:kh("recharts-reference-dot",m)},n.renderDot(f,g),bE.renderCallByParent(this.props,{x:h-o,y:d-o,width:2*o,height:2*o}))}}],i&&dM(r.prototype,i),o&&dM(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,i,o}(t.Component);yM(vM,"displayName","ReferenceDot"),yM(vM,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1}),yM(vM,"renderDot",(function(e,n){return t.isValidElement(e)?t.cloneElement(e,n):ed()(e)?e(n):t.createElement(ym,lM({},n,{cx:n.cx,cy:n.cy,className:"recharts-reference-dot-dot"}))}));var xM=n(4597),bM=n.n(xM),wM=n(8990),SM=n.n(wM),TM=n(5797),EM=n.n(TM)()((function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}}),(function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}));var AM=(0,t.createContext)(void 0),MM=(0,t.createContext)(void 0),PM=(0,t.createContext)(void 0),kM=(0,t.createContext)({}),CM=(0,t.createContext)(void 0),jM=(0,t.createContext)(0),IM=(0,t.createContext)(0),OM=function(e){var n=e.state,r=n.xAxisMap,i=n.yAxisMap,o=n.offset,a=e.clipPathId,s=e.children,l=e.width,c=e.height,u=EM(o);return t.createElement(AM.Provider,{value:r},t.createElement(MM.Provider,{value:i},t.createElement(kM.Provider,{value:o},t.createElement(PM.Provider,{value:u},t.createElement(CM.Provider,{value:a},t.createElement(jM.Provider,{value:c},t.createElement(IM.Provider,{value:l},s)))))))};var NM=function(e){var n=(0,t.useContext)(AM);null==n&&Gd(!1);var r=n[e];return null==r&&Gd(!1),r},DM=function(e){var n=(0,t.useContext)(MM);null==n&&Gd(!1);var r=n[e];return null==r&&Gd(!1),r},LM=function(){return(0,t.useContext)(IM)},zM=function(){return(0,t.useContext)(jM)};function RM(e){return RM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},RM(e)}function FM(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,WM(r.key),r)}}function BM(e,t,n){return t=UM(t),function(e,t){if(t&&("object"===RM(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,VM()?Reflect.construct(t,n||[],UM(e).constructor):t.apply(e,n))}function VM(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(VM=function(){return!!e})()}function UM(e){return UM=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},UM(e)}function GM(e,t){return GM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},GM(e,t)}function HM(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ZM(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?HM(Object(n),!0).forEach((function(t){qM(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):HM(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function qM(e,t,n){return(t=WM(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function WM(e){var t=function(e,t){if("object"!=RM(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=RM(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==RM(t)?t:t+""}function XM(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],l=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){c=!0,i=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw i}}return s}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return YM(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return YM(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function YM(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function KM(){return KM=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},KM.apply(this,arguments)}function JM(e){var n=e.x,r=e.y,i=e.segment,o=e.xAxisId,a=e.yAxisId,s=e.shape,l=e.className,c=e.alwaysShow,u=(0,t.useContext)(CM),h=NM(o),d=DM(a),p=(0,t.useContext)(PM);if(!u||!p)return null;Kh(void 0===c,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var f=function(e,t,n,r,i,o,a,s,l){var c=i.x,u=i.y,h=i.width,d=i.height;if(n){var p=l.y,f=e.y.apply(p,{position:o});if(SE(l,"discard")&&!e.y.isInRange(f))return null;var m=[{x:c+h,y:f},{x:c,y:f}];return"left"===s?m.reverse():m}if(t){var g=l.x,y=e.x.apply(g,{position:o});if(SE(l,"discard")&&!e.x.isInRange(y))return null;var _=[{x:y,y:u+d},{x:y,y:u}];return"top"===a?_.reverse():_}if(r){var v=l.segment.map((function(t){return e.apply(t,{position:o})}));return SE(l,"discard")&&bM()(v,(function(t){return!e.isInRange(t)}))?null:v}return null}(sM({x:h.scale,y:d.scale}),Gh(n),Gh(r),i&&2===i.length,p,e.position,h.orientation,d.orientation,e);if(!f)return null;var m=XM(f,2),g=m[0],y=g.x,_=g.y,v=m[1],x=v.x,b=v.y,w=ZM(ZM({clipPath:SE(e,"hidden")?"url(#".concat(u,")"):void 0},Md(e,!0)),{},{x1:y,y1:_,x2:x,y2:b});return t.createElement(Jd,{className:kh("recharts-reference-line",l)},function(e,n){return t.isValidElement(e)?t.cloneElement(e,n):ed()(e)?e(n):t.createElement("line",KM({},n,{className:"recharts-reference-line-line"}))}(s,w),bE.renderCallByParent(e,function(e){var t=e.x1,n=e.y1,r=e.x2,i=e.y2;return oM({x:t,y:n},{x:r,y:i})}({x1:y,y1:_,x2:x,y2:b})))}var QM=function(e){function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),BM(this,n,arguments)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&GM(e,t)}(n,e),r=n,(i=[{key:"render",value:function(){return t.createElement(JM,this.props)}}])&&FM(r.prototype,i),o&&FM(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,i,o}(t.Component);function $M(){return $M=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},$M.apply(this,arguments)}function eP(e){return eP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},eP(e)}function tP(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function nP(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tP(Object(n),!0).forEach((function(t){lP(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tP(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function rP(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,cP(r.key),r)}}function iP(e,t,n){return t=aP(t),function(e,t){if(t&&("object"===eP(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,oP()?Reflect.construct(t,n||[],aP(e).constructor):t.apply(e,n))}function oP(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(oP=function(){return!!e})()}function aP(e){return aP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},aP(e)}function sP(e,t){return sP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},sP(e,t)}function lP(e,t,n){return(t=cP(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function cP(e){var t=function(e,t){if("object"!=eP(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=eP(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==eP(t)?t:t+""}qM(QM,"displayName","ReferenceLine"),qM(QM,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});var uP=function(e){function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),iP(this,n,arguments)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sP(e,t)}(n,e),r=n,(i=[{key:"render",value:function(){var e=this.props,r=e.x1,i=e.x2,o=e.y1,a=e.y2,s=e.className,l=e.alwaysShow,c=e.clipPathId;Kh(void 0===l,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var u=Gh(r),h=Gh(i),d=Gh(o),p=Gh(a),f=this.props.shape;if(!u&&!h&&!d&&!p&&!f)return null;var m=function(e,t,n,r,i){var o=i.x1,a=i.x2,s=i.y1,l=i.y2,c=i.xAxis,u=i.yAxis;if(!c||!u)return null;var h=sM({x:c.scale,y:u.scale}),d={x:e?h.x.apply(o,{position:"start"}):h.x.rangeMin,y:n?h.y.apply(s,{position:"start"}):h.y.rangeMin},p={x:t?h.x.apply(a,{position:"end"}):h.x.rangeMax,y:r?h.y.apply(l,{position:"end"}):h.y.rangeMax};return!SE(i,"discard")||h.isInRange(d)&&h.isInRange(p)?oM(d,p):null}(u,h,d,p,this.props);if(!m&&!f)return null;var g=SE(this.props,"hidden")?"url(#".concat(c,")"):void 0;return t.createElement(Jd,{className:kh("recharts-reference-area",s)},n.renderRect(f,nP(nP({clipPath:g},Md(this.props,!0)),m)),bE.renderCallByParent(this.props,m))}}])&&rP(r.prototype,i),o&&rP(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,i,o}(t.Component);function hP(e){return function(e){if(Array.isArray(e))return dP(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return dP(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return dP(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function dP(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}lP(uP,"displayName","ReferenceArea"),lP(uP,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1}),lP(uP,"renderRect",(function(e,n){return t.isValidElement(e)?t.cloneElement(e,n):ed()(e)?e(n):t.createElement(ry,$M({},n,{className:"recharts-reference-area-rect"}))}));var pP=function(e,t,n,r,i){var o=bd(e,QM),a=bd(e,vM),s=[].concat(hP(o),hP(a)),l=bd(e,uP),c="".concat(r,"Id"),u=r[0],h=t;if(s.length&&(h=s.reduce((function(e,t){if(t.props[c]===n&&SE(t.props,"extendDomain")&&Uh(t.props[u])){var r=t.props[u];return[Math.min(e[0],r),Math.max(e[1],r)]}return e}),h)),l.length){var d="".concat(u,"1"),p="".concat(u,"2");h=l.reduce((function(e,t){if(t.props[c]===n&&SE(t.props,"extendDomain")&&Uh(t.props[d])&&Uh(t.props[p])){var r=t.props[d],i=t.props[p];return[Math.min(e[0],r,i),Math.max(e[1],r,i)]}return e}),h)}return i&&i.length&&(h=i.reduce((function(e,t){return Uh(t)?[Math.min(e[0],t),Math.max(e[1],t)]:e}),h)),h},fP=n(7283),mP=new(n.n(fP)()),gP="recharts.syncMouseEvents";function yP(e){return yP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yP(e)}function _P(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,xP(r.key),r)}}function vP(e,t,n){return(t=xP(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function xP(e){var t=function(e,t){if("object"!=yP(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=yP(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==yP(t)?t:t+""}var bP=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),vP(this,"activeIndex",0),vP(this,"coordinateList",[]),vP(this,"layout","horizontal")},t=[{key:"setDetails",value:function(e){var t,n=e.coordinateList,r=void 0===n?null:n,i=e.container,o=void 0===i?null:i,a=e.layout,s=void 0===a?null:a,l=e.offset,c=void 0===l?null:l,u=e.mouseHandlerCallback,h=void 0===u?null:u;this.coordinateList=null!==(t=null!==r&&void 0!==r?r:this.coordinateList)&&void 0!==t?t:[],this.container=null!==o&&void 0!==o?o:this.container,this.layout=null!==s&&void 0!==s?s:this.layout,this.offset=null!==c&&void 0!==c?c:this.offset,this.mouseHandlerCallback=null!==h&&void 0!==h?h:this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(e){if(0!==this.coordinateList.length)switch(e.key){case"ArrowRight":if("horizontal"!==this.layout)return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break;case"ArrowLeft":if("horizontal"!==this.layout)return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse()}}},{key:"setIndex",value:function(e){this.activeIndex=e}},{key:"spoofMouse",value:function(){var e,t;if("horizontal"===this.layout&&0!==this.coordinateList.length){var n=this.container.getBoundingClientRect(),r=n.x,i=n.y,o=n.height,a=this.coordinateList[this.activeIndex].coordinate,s=(null===(e=window)||void 0===e?void 0:e.scrollX)||0,l=(null===(t=window)||void 0===t?void 0:t.scrollY)||0,c=r+a+s,u=i+this.offset.top+o/2+l;this.mouseHandlerCallback({pageX:c,pageY:u})}}}],t&&_P(e.prototype,t),n&&_P(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}();function wP(){}function SP(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function TP(e){this._context=e}function EP(e){this._context=e}function AP(e){this._context=e}TP.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:SP(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:SP(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},EP.prototype={areaStart:wP,areaEnd:wP,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:SP(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},AP.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:SP(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};class MP{constructor(e,t){this._context=e,this._x=t}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line}point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,t,e,t):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+t)/2,e,this._y0,e,t)}this._x0=e,this._y0=t}}function PP(e){this._context=e}function kP(e){this._context=e}function CP(e){return new kP(e)}function jP(e){return e<0?-1:1}function IP(e,t,n){var r=e._x1-e._x0,i=t-e._x1,o=(e._y1-e._y0)/(r||i<0&&-0),a=(n-e._y1)/(i||r<0&&-0),s=(o*i+a*r)/(r+i);return(jP(o)+jP(a))*Math.min(Math.abs(o),Math.abs(a),.5*Math.abs(s))||0}function OP(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function NP(e,t,n){var r=e._x0,i=e._y0,o=e._x1,a=e._y1,s=(o-r)/3;e._context.bezierCurveTo(r+s,i+s*t,o-s,a-s*n,o,a)}function DP(e){this._context=e}function LP(e){this._context=new zP(e)}function zP(e){this._context=e}function RP(e){this._context=e}function FP(e){var t,n,r=e.length-1,i=new Array(r),o=new Array(r),a=new Array(r);for(i[0]=0,o[0]=2,a[0]=e[0]+2*e[1],t=1;t<r-1;++t)i[t]=1,o[t]=4,a[t]=4*e[t]+2*e[t+1];for(i[r-1]=2,o[r-1]=7,a[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=i[t]/o[t-1],o[t]-=n,a[t]-=n*a[t-1];for(i[r-1]=a[r-1]/o[r-1],t=r-2;t>=0;--t)i[t]=(a[t]-i[t+1])/o[t];for(o[r-1]=(e[r]+i[r-1])/2,t=0;t<r-1;++t)o[t]=2*e[t+1]-i[t+1];return[i,o]}function BP(e,t){this._context=e,this._t=t}function VP(e){return e[0]}function UP(e){return e[1]}function GP(e,t){var n=hf(!0),r=null,i=CP,o=null,a=Of(s);function s(s){var l,c,u,h=(s=Kw(s)).length,d=!1;for(null==r&&(o=i(u=a())),l=0;l<=h;++l)!(l<h&&n(c=s[l],l,s))===d&&((d=!d)?o.lineStart():o.lineEnd()),d&&o.point(+e(c,l,s),+t(c,l,s));if(u)return o=null,u+""||null}return e="function"===typeof e?e:void 0===e?VP:hf(e),t="function"===typeof t?t:void 0===t?UP:hf(t),s.x=function(t){return arguments.length?(e="function"===typeof t?t:hf(+t),s):e},s.y=function(e){return arguments.length?(t="function"===typeof e?e:hf(+e),s):t},s.defined=function(e){return arguments.length?(n="function"===typeof e?e:hf(!!e),s):n},s.curve=function(e){return arguments.length?(i=e,null!=r&&(o=i(r)),s):i},s.context=function(e){return arguments.length?(null==e?r=o=null:o=i(r=e),s):r},s}function HP(e,t,n){var r=null,i=hf(!0),o=null,a=CP,s=null,l=Of(c);function c(c){var u,h,d,p,f,m=(c=Kw(c)).length,g=!1,y=new Array(m),_=new Array(m);for(null==o&&(s=a(f=l())),u=0;u<=m;++u){if(!(u<m&&i(p=c[u],u,c))===g)if(g=!g)h=u,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),d=u-1;d>=h;--d)s.point(y[d],_[d]);s.lineEnd(),s.areaEnd()}g&&(y[u]=+e(p,u,c),_[u]=+t(p,u,c),s.point(r?+r(p,u,c):y[u],n?+n(p,u,c):_[u]))}if(f)return s=null,f+""||null}function u(){return GP().defined(i).curve(a).context(o)}return e="function"===typeof e?e:void 0===e?VP:hf(+e),t="function"===typeof t?t:hf(void 0===t?0:+t),n="function"===typeof n?n:void 0===n?UP:hf(+n),c.x=function(t){return arguments.length?(e="function"===typeof t?t:hf(+t),r=null,c):e},c.x0=function(t){return arguments.length?(e="function"===typeof t?t:hf(+t),c):e},c.x1=function(e){return arguments.length?(r=null==e?null:"function"===typeof e?e:hf(+e),c):r},c.y=function(e){return arguments.length?(t="function"===typeof e?e:hf(+e),n=null,c):t},c.y0=function(e){return arguments.length?(t="function"===typeof e?e:hf(+e),c):t},c.y1=function(e){return arguments.length?(n=null==e?null:"function"===typeof e?e:hf(+e),c):n},c.lineX0=c.lineY0=function(){return u().x(e).y(t)},c.lineY1=function(){return u().x(e).y(n)},c.lineX1=function(){return u().x(r).y(t)},c.defined=function(e){return arguments.length?(i="function"===typeof e?e:hf(!!e),c):i},c.curve=function(e){return arguments.length?(a=e,null!=o&&(s=a(o)),c):a},c.context=function(e){return arguments.length?(null==e?o=s=null:s=a(o=e),c):o},c}function ZP(e){return ZP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ZP(e)}function qP(){return qP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},qP.apply(this,arguments)}function WP(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function XP(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?WP(Object(n),!0).forEach((function(t){YP(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):WP(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function YP(e,t,n){return t=function(e){var t=function(e,t){if("object"!=ZP(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=ZP(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ZP(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}PP.prototype={areaStart:wP,areaEnd:wP,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}},kP.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t)}}},DP.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:NP(this,this._t0,OP(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(t=+t,(e=+e)!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,NP(this,OP(this,n=IP(this,e,t)),n);break;default:NP(this,this._t0,n=IP(this,e,t))}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}},(LP.prototype=Object.create(DP.prototype)).point=function(e,t){DP.prototype.point.call(this,t,e)},zP.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,o){this._context.bezierCurveTo(t,e,r,n,o,i)}},RP.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),2===n)this._context.lineTo(e[1],t[1]);else for(var r=FP(e),i=FP(t),o=0,a=1;a<n;++o,++a)this._context.bezierCurveTo(r[0][o],i[0][o],r[1][o],i[1][o],e[a],t[a]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}},BP.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}}this._x=e,this._y=t}};var KP={curveBasisClosed:function(e){return new EP(e)},curveBasisOpen:function(e){return new AP(e)},curveBasis:function(e){return new TP(e)},curveBumpX:function(e){return new MP(e,!0)},curveBumpY:function(e){return new MP(e,!1)},curveLinearClosed:function(e){return new PP(e)},curveLinear:CP,curveMonotoneX:function(e){return new DP(e)},curveMonotoneY:function(e){return new LP(e)},curveNatural:function(e){return new RP(e)},curveStep:function(e){return new BP(e,.5)},curveStepAfter:function(e){return new BP(e,1)},curveStepBefore:function(e){return new BP(e,0)}},JP=function(e){return e.x===+e.x&&e.y===+e.y},QP=function(e){return e.x},$P=function(e){return e.y},ek=function(e){var t,n=e.type,r=void 0===n?"linear":n,i=e.points,o=void 0===i?[]:i,a=e.baseLine,s=e.layout,l=e.connectNulls,c=void 0!==l&&l,u=function(e,t){if(ed()(e))return e;var n="curve".concat(Vp()(e));return"curveMonotone"!==n&&"curveBump"!==n||!t?KP[n]||CP:KP["".concat(n).concat("vertical"===t?"Y":"X")]}(r,s),h=c?o.filter((function(e){return JP(e)})):o;if(Array.isArray(a)){var d=c?a.filter((function(e){return JP(e)})):a,p=h.map((function(e,t){return XP(XP({},e),{},{base:d[t]})}));return(t="vertical"===s?HP().y($P).x1(QP).x0((function(e){return e.base.x})):HP().x(QP).y1($P).y0((function(e){return e.base.y}))).defined(JP).curve(u),t(p)}return(t="vertical"===s&&Uh(a)?HP().y($P).x1(QP).x0(a):Uh(a)?HP().x(QP).y1($P).y0(a):GP().x(QP).y($P)).defined(JP).curve(u),t(h)},tk=function(e){var n=e.className,r=e.points,i=e.path,o=e.pathRef;if((!r||!r.length)&&!i)return null;var a=r&&r.length?ek(e):i;return t.createElement("path",qP({},Md(e,!1),ud(e),{className:kh("recharts-curve",n),d:a,ref:o}))};function nk(e){return nk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nk(e)}var rk=["x","y","top","left","width","height","className"];function ik(){return ik=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ik.apply(this,arguments)}function ok(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ak(e,t,n){return t=function(e){var t=function(e,t){if("object"!=nk(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=nk(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==nk(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function sk(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var lk=function(e,t,n,r,i,o){return"M".concat(e,",").concat(i,"v").concat(r,"M").concat(o,",").concat(t,"h").concat(n)},ck=function(e){var n=e.x,r=void 0===n?0:n,i=e.y,o=void 0===i?0:i,a=e.top,s=void 0===a?0:a,l=e.left,c=void 0===l?0:l,u=e.width,h=void 0===u?0:u,d=e.height,p=void 0===d?0:d,f=e.className,m=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ok(Object(n),!0).forEach((function(t){ak(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ok(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({x:r,y:o,top:s,left:c,width:h,height:p},sk(e,rk));return Uh(r)&&Uh(o)&&Uh(h)&&Uh(p)&&Uh(s)&&Uh(c)?t.createElement("path",ik({},Md(m,!0),{className:kh("recharts-cross",f),d:lk(r,o,h,p,s,c)})):null};function uk(e){var t=e.cx,n=e.cy,r=e.radius,i=e.startAngle,o=e.endAngle;return{points:[oE(t,n,r,i),oE(t,n,r,o)],cx:t,cy:n,radius:r,startAngle:i,endAngle:o}}function hk(e,t,n){var r,i,o,a;if("horizontal"===e)o=r=t.x,i=n.top,a=n.top+n.height;else if("vertical"===e)a=i=t.y,r=n.left,o=n.left+n.width;else if(null!=t.cx&&null!=t.cy){if("centric"!==e)return uk(t);var s=t.cx,l=t.cy,c=t.innerRadius,u=t.outerRadius,h=t.angle,d=oE(s,l,c,h),p=oE(s,l,u,h);r=d.x,i=d.y,o=p.x,a=p.y}return[{x:r,y:i},{x:o,y:a}]}function dk(e){return dk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},dk(e)}function pk(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function fk(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pk(Object(n),!0).forEach((function(t){mk(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pk(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function mk(e,t,n){return t=function(e){var t=function(e,t){if("object"!=dk(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=dk(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==dk(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function gk(e){var n,r,i,o=e.element,a=e.tooltipEventType,s=e.isActive,l=e.activeCoordinate,c=e.activePayload,u=e.offset,h=e.activeTooltipIndex,d=e.tooltipAxisBandSize,p=e.layout,f=e.chartName,m=null!==(n=o.props.cursor)&&void 0!==n?n:null===(r=o.type.defaultProps)||void 0===r?void 0:r.cursor;if(!o||!m||!s||!l||"ScatterChart"!==f&&"axis"!==a)return null;var g=tk;if("ScatterChart"===f)i=l,g=ck;else if("BarChart"===f)i=function(e,t,n,r){var i=r/2;return{stroke:"none",fill:"#ccc",x:"horizontal"===e?t.x-i:n.left+.5,y:"horizontal"===e?n.top+.5:t.y-i,width:"horizontal"===e?r:n.width-1,height:"horizontal"===e?n.height-1:r}}(p,l,u,d),g=ry;else if("radial"===p){var y=uk(l),_=y.cx,v=y.cy,x=y.radius;i={cx:_,cy:v,startAngle:y.startAngle,endAngle:y.endAngle,innerRadius:x,outerRadius:x},g=hA}else i={points:hk(p,l,u)},g=tk;var b=fk(fk(fk(fk({stroke:"#ccc",pointerEvents:"none"},u),i),Md(m,!1)),{},{payload:c,payloadIndex:h,className:kh("recharts-tooltip-cursor",m.className)});return(0,t.isValidElement)(m)?(0,t.cloneElement)(m,b):(0,t.createElement)(g,b)}var yk=["item"],_k=["children","className","width","height","style","compact","title","desc"];function vk(e){return vk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vk(e)}function xk(){return xk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},xk.apply(this,arguments)}function bk(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],l=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){c=!0,i=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw i}}return s}}(e,t)||kk(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function wk(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Sk(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Nk(r.key),r)}}function Tk(e,t,n){return t=Ak(t),function(e,t){if(t&&("object"===vk(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Ek()?Reflect.construct(t,n||[],Ak(e).constructor):t.apply(e,n))}function Ek(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Ek=function(){return!!e})()}function Ak(e){return Ak=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ak(e)}function Mk(e,t){return Mk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Mk(e,t)}function Pk(e){return function(e){if(Array.isArray(e))return Ck(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||kk(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function kk(e,t){if(e){if("string"===typeof e)return Ck(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ck(e,t):void 0}}function Ck(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function jk(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ik(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?jk(Object(n),!0).forEach((function(t){Ok(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jk(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ok(e,t,n){return(t=Nk(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Nk(e){var t=function(e,t){if("object"!=vk(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=vk(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==vk(t)?t:t+""}var Dk={xAxis:["bottom","top"],yAxis:["left","right"]},Lk={width:"100%",height:"100%"},zk={x:0,y:0};function Rk(e){return e}var Fk=function(e,t){var n=t.graphicalItems,r=t.dataStartIndex,i=t.dataEndIndex,o=(null!==n&&void 0!==n?n:[]).reduce((function(e,t){var n=t.props.data;return n&&n.length?[].concat(Pk(e),Pk(n)):e}),[]);return o.length>0?o:e&&e.length&&Uh(r)&&Uh(i)?e.slice(r,i+1):[]};function Bk(e){return"number"===e?[0,"auto"]:void 0}var Vk=function(e,t,n,r){var i=e.graphicalItems,o=e.tooltipAxis,a=Fk(t,e);return n<0||!i||!i.length||n>=a.length?null:i.reduce((function(i,s){var l,c,u=null!==(l=s.props.data)&&void 0!==l?l:t;(u&&e.dataStartIndex+e.dataEndIndex!==0&&e.dataEndIndex-e.dataStartIndex>=n&&(u=u.slice(e.dataStartIndex,e.dataEndIndex+1)),o.dataKey&&!o.allowDuplicatedCategory)?c=Yh(void 0===u?a:u,o.dataKey,r):c=u&&u[n]||a[n];return c?[].concat(Pk(i),[IT(s,c)]):i}),[])},Uk=function(e,t,n,r){var i=r||{x:e.chartX,y:e.chartY},o=function(e,t){return"horizontal"===t?e.x:"vertical"===t?e.y:"centric"===t?e.angle:e.radius}(i,n),a=e.orderedTooltipTicks,s=e.tooltipAxis,l=e.tooltipTicks,c=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,o=-1,a=null!==(t=null===n||void 0===n?void 0:n.length)&&void 0!==t?t:0;if(a<=1)return 0;if(i&&"angleAxis"===i.axisType&&Math.abs(Math.abs(i.range[1]-i.range[0])-360)<=1e-6)for(var s=i.range,l=0;l<a;l++){var c=l>0?r[l-1].coordinate:r[a-1].coordinate,u=r[l].coordinate,h=l>=a-1?r[0].coordinate:r[l+1].coordinate,d=void 0;if(Bh(u-c)!==Bh(h-u)){var p=[];if(Bh(h-u)===Bh(s[1]-s[0])){d=h;var f=u+s[1]-s[0];p[0]=Math.min(f,(f+c)/2),p[1]=Math.max(f,(f+c)/2)}else{d=c;var m=h+s[1]-s[0];p[0]=Math.min(u,(m+u)/2),p[1]=Math.max(u,(m+u)/2)}var g=[Math.min(u,(d+u)/2),Math.max(u,(d+u)/2)];if(e>g[0]&&e<=g[1]||e>=p[0]&&e<=p[1]){o=r[l].index;break}}else{var y=Math.min(c,h),_=Math.max(c,h);if(e>(y+u)/2&&e<=(_+u)/2){o=r[l].index;break}}}else for(var v=0;v<a;v++)if(0===v&&e<=(n[v].coordinate+n[v+1].coordinate)/2||v>0&&v<a-1&&e>(n[v].coordinate+n[v-1].coordinate)/2&&e<=(n[v].coordinate+n[v+1].coordinate)/2||v===a-1&&e>(n[v].coordinate+n[v-1].coordinate)/2){o=n[v].index;break}return o}(o,a,l,s);if(c>=0&&l){var u=l[c]&&l[c].value,h=Vk(e,t,c,u),d=function(e,t,n,r){var i=t.find((function(e){return e&&e.index===n}));if(i){if("horizontal"===e)return{x:i.coordinate,y:r.y};if("vertical"===e)return{x:r.x,y:i.coordinate};if("centric"===e){var o=i.coordinate,a=r.radius;return Ik(Ik(Ik({},r),oE(r.cx,r.cy,a,o)),{},{angle:o,radius:a})}var s=i.coordinate,l=r.angle;return Ik(Ik(Ik({},r),oE(r.cx,r.cy,s,l)),{},{angle:l,radius:s})}return zk}(n,a,c,i);return{activeTooltipIndex:c,activeLabel:u,activePayload:h,activeCoordinate:d}}return null},Gk=function(e,t){var n=t.axes,r=t.graphicalItems,i=t.axisType,o=t.axisIdKey,a=t.stackGroups,s=t.dataStartIndex,l=t.dataEndIndex,c=e.layout,u=e.children,h=e.stackOffset,d=pT(c,i);return n.reduce((function(t,n){var p,f=void 0!==n.type.defaultProps?Ik(Ik({},n.type.defaultProps),n.props):n.props,m=f.type,g=f.dataKey,y=f.allowDataOverflow,_=f.allowDuplicatedCategory,v=f.scale,x=f.ticks,b=f.includeHidden,w=f[o];if(t[w])return t;var S,T,E,A=Fk(e.data,{graphicalItems:r.filter((function(e){var t;return(o in e.props?e.props[o]:null===(t=e.type.defaultProps)||void 0===t?void 0:t[o])===w})),dataStartIndex:s,dataEndIndex:l}),M=A.length;(function(e,t,n){if("number"===n&&!0===t&&Array.isArray(e)){var r=null===e||void 0===e?void 0:e[0],i=null===e||void 0===e?void 0:e[1];if(r&&i&&Uh(r)&&Uh(i))return!0}return!1})(f.domain,y,m)&&(S=kT(f.domain,null,y),!d||"number"!==m&&"auto"===v||(E=cT(A,g,"category")));var P=Bk(m);if(!S||0===S.length){var k,C=null!==(k=f.domain)&&void 0!==k?k:P;if(g){if(S=cT(A,g,m),"category"===m&&d){var j=function(e){if(!Array.isArray(e))return!1;for(var t=e.length,n={},r=0;r<t;r++){if(n[e[r]])return!0;n[e[r]]=!0}return!1}(S);_&&j?(T=S,S=Fd()(0,M)):_||(S=jT(C,S,n).reduce((function(e,t){return e.indexOf(t)>=0?e:[].concat(Pk(e),[t])}),[]))}else if("category"===m)S=_?S.filter((function(e){return""!==e&&!Qh()(e)})):jT(C,S,n).reduce((function(e,t){return e.indexOf(t)>=0||""===t||Qh()(t)?e:[].concat(Pk(e),[t])}),[]);else if("number"===m){var I=function(e,t,n,r,i){var o=t.map((function(t){return hT(e,t,n,i,r)})).filter((function(e){return!Qh()(e)}));return o&&o.length?o.reduce((function(e,t){return[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}),[1/0,-1/0]):null}(A,r.filter((function(e){var t,n,r=o in e.props?e.props[o]:null===(t=e.type.defaultProps)||void 0===t?void 0:t[o],i="hide"in e.props?e.props.hide:null===(n=e.type.defaultProps)||void 0===n?void 0:n.hide;return r===w&&(b||!i)})),g,i,c);I&&(S=I)}!d||"number"!==m&&"auto"===v||(E=cT(A,g,"category"))}else S=d?Fd()(0,M):a&&a[w]&&a[w].hasStack&&"number"===m?"expand"===h?[0,1]:AT(a[w].stackGroups,s,l):dT(A,r.filter((function(e){var t=o in e.props?e.props[o]:e.type.defaultProps[o],n="hide"in e.props?e.props.hide:e.type.defaultProps.hide;return t===w&&(b||!n)})),m,c,!0);if("number"===m)S=pP(u,S,w,i,x),C&&(S=kT(C,S,y));else if("category"===m&&C){var O=C;S.every((function(e){return O.indexOf(e)>=0}))&&(S=O)}}return Ik(Ik({},t),{},Ok({},w,Ik(Ik({},f),{},{axisType:i,domain:S,categoricalDomain:E,duplicateDomain:T,originalDomain:null!==(p=f.domain)&&void 0!==p?p:P,isCategorical:d,layout:c})))}),{})},Hk=function(e,t){var n=t.axisType,r=void 0===n?"xAxis":n,i=t.AxisComp,o=t.graphicalItems,a=t.stackGroups,s=t.dataStartIndex,l=t.dataEndIndex,c=e.children,u="".concat(r,"Id"),h=bd(c,i),d={};return h&&h.length?d=Gk(e,{axes:h,graphicalItems:o,axisType:r,axisIdKey:u,stackGroups:a,dataStartIndex:s,dataEndIndex:l}):o&&o.length&&(d=function(e,t){var n=t.graphicalItems,r=t.Axis,i=t.axisType,o=t.axisIdKey,a=t.stackGroups,s=t.dataStartIndex,l=t.dataEndIndex,c=e.layout,u=e.children,h=Fk(e.data,{graphicalItems:n,dataStartIndex:s,dataEndIndex:l}),d=h.length,p=pT(c,i),f=-1;return n.reduce((function(e,t){var m,g=(void 0!==t.type.defaultProps?Ik(Ik({},t.type.defaultProps),t.props):t.props)[o],y=Bk("number");return e[g]?e:(f++,p?m=Fd()(0,d):a&&a[g]&&a[g].hasStack?(m=AT(a[g].stackGroups,s,l),m=pP(u,m,g,i)):(m=kT(y,dT(h,n.filter((function(e){var t,n,r=o in e.props?e.props[o]:null===(t=e.type.defaultProps)||void 0===t?void 0:t[o],i="hide"in e.props?e.props.hide:null===(n=e.type.defaultProps)||void 0===n?void 0:n.hide;return r===g&&!i})),"number",c),r.defaultProps.allowDataOverflow),m=pP(u,m,g,i)),Ik(Ik({},e),{},Ok({},g,Ik(Ik({axisType:i},r.defaultProps),{},{hide:!0,orientation:zh()(Dk,"".concat(i,".").concat(f%2),null),domain:m,originalDomain:y,isCategorical:p,layout:c}))))}),{})}(e,{Axis:i,graphicalItems:o,axisType:r,axisIdKey:u,stackGroups:a,dataStartIndex:s,dataEndIndex:l})),d},Zk=function(e){var t=e.children,n=e.defaultShowTooltip,r=wd(t,KT),i=0,o=0;return e.data&&0!==e.data.length&&(o=e.data.length-1),r&&r.props&&(r.props.startIndex>=0&&(i=r.props.startIndex),r.props.endIndex>=0&&(o=r.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:i,dataEndIndex:o,activeTooltipIndex:-1,isTooltipActive:Boolean(n)}},qk=function(e){return"horizontal"===e?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:"vertical"===e?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:"centric"===e?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},Wk=function(e,t){var n=e.props,r=(e.graphicalItems,e.xAxisMap),i=void 0===r?{}:r,o=e.yAxisMap,a=void 0===o?{}:o,s=n.width,l=n.height,c=n.children,u=n.margin||{},h=wd(c,KT),d=wd(c,mm),p=Object.keys(a).reduce((function(e,t){var n=a[t],r=n.orientation;return n.mirror||n.hide?e:Ik(Ik({},e),{},Ok({},r,e[r]+n.width))}),{left:u.left||0,right:u.right||0}),f=Object.keys(i).reduce((function(e,t){var n=i[t],r=n.orientation;return n.mirror||n.hide?e:Ik(Ik({},e),{},Ok({},r,zh()(e,"".concat(r))+n.height))}),{top:u.top||0,bottom:u.bottom||0}),m=Ik(Ik({},f),p),g=m.bottom;h&&(m.bottom+=h.props.height||KT.defaultProps.height),d&&t&&(m=function(e,t,n,r){var i=n.children,o=n.width,a=n.margin,s=o-(a.left||0)-(a.right||0),l=tT({children:i,legendWidth:s});if(l){var c=r||{},u=c.width,h=c.height,d=l.align,p=l.verticalAlign,f=l.layout;if(("vertical"===f||"horizontal"===f&&"middle"===p)&&"center"!==d&&Uh(e[d]))return aT(aT({},e),{},sT({},d,e[d]+(u||0)));if(("horizontal"===f||"vertical"===f&&"center"===d)&&"middle"!==p&&Uh(e[p]))return aT(aT({},e),{},sT({},p,e[p]+(h||0)))}return e}(m,0,n,t));var y=s-m.left-m.right,_=l-m.top-m.bottom;return Ik(Ik({brushBottom:g},m),{},{width:Math.max(y,0),height:Math.max(_,0)})},Xk=function(e,t){return"xAxis"===t?e[t].width:"yAxis"===t?e[t].height:void 0},Yk=function(e){var n=e.chartName,r=e.GraphicalChild,i=e.defaultTooltipEventType,o=void 0===i?"axis":i,a=e.validateTooltipEventTypes,s=void 0===a?["axis"]:a,l=e.axisComponents,c=e.legendContent,u=e.formatAxisMap,h=e.defaultProps,d=function(e,t){var n=t.graphicalItems,r=t.stackGroups,i=t.offset,o=t.updateId,a=t.dataStartIndex,s=t.dataEndIndex,c=e.barSize,u=e.layout,h=e.barGap,d=e.barCategoryGap,p=e.maxBarSize,f=qk(u),m=f.numericAxisName,g=f.cateAxisName,y=function(e){return!(!e||!e.length)&&e.some((function(e){var t=yd(e&&e.type);return t&&t.indexOf("Bar")>=0}))}(n),_=[];return n.forEach((function(n,f){var v=Fk(e.data,{graphicalItems:[n],dataStartIndex:a,dataEndIndex:s}),x=void 0!==n.type.defaultProps?Ik(Ik({},n.type.defaultProps),n.props):n.props,b=x.dataKey,w=x.maxBarSize,S=x["".concat(m,"Id")],T=x["".concat(g,"Id")],E=l.reduce((function(e,n){var r=t["".concat(n.axisType,"Map")],i=x["".concat(n.axisType,"Id")];r&&r[i]||"zAxis"===n.axisType||Gd(!1);var o=r[i];return Ik(Ik({},e),{},Ok(Ok({},n.axisType,o),"".concat(n.axisType,"Ticks"),mT(o)))}),{}),A=E[g],M=E["".concat(g,"Ticks")],P=r&&r[S]&&r[S].hasStack&&function(e,t){var n,r=(null!==(n=e.type)&&void 0!==n&&n.defaultProps?aT(aT({},e.type.defaultProps),e.props):e.props).stackId;if(Gh(r)){var i=t[r];if(i){var o=i.items.indexOf(e);return o>=0?i.stackedData[o]:null}}return null}(n,r[S].stackGroups),k=yd(n.type).indexOf("Bar")>=0,C=CT(A,M),j=[],I=y&&function(e){var t=e.barSize,n=e.totalSize,r=e.stackGroups,i=void 0===r?{}:r;if(!i)return{};for(var o={},a=Object.keys(i),s=0,l=a.length;s<l;s++)for(var c=i[a[s]].stackGroups,u=Object.keys(c),h=0,d=u.length;h<d;h++){var p=c[u[h]],f=p.items,m=p.cateAxisId,g=f.filter((function(e){return yd(e.type).indexOf("Bar")>=0}));if(g&&g.length){var y=g[0].type.defaultProps,_=void 0!==y?aT(aT({},y),g[0].props):g[0].props,v=_.barSize,x=_[m];o[x]||(o[x]=[]);var b=Qh()(v)?t:v;o[x].push({item:g[0],stackList:g.slice(1),barSize:Qh()(b)?void 0:qh(b,n,0)})}}return o}({barSize:c,stackGroups:r,totalSize:Xk(E,g)});if(k){var O,N,D=Qh()(w)?p:w,L=null!==(O=null!==(N=CT(A,M,!0))&&void 0!==N?N:D)&&void 0!==O?O:0;j=function(e){var t=e.barGap,n=e.barCategoryGap,r=e.bandSize,i=e.sizeList,o=void 0===i?[]:i,a=e.maxBarSize,s=o.length;if(s<1)return null;var l,c=qh(t,r,0,!0),u=[];if(o[0].barSize===+o[0].barSize){var h=!1,d=r/s,p=o.reduce((function(e,t){return e+t.barSize||0}),0);(p+=(s-1)*c)>=r&&(p-=(s-1)*c,c=0),p>=r&&d>0&&(h=!0,p=s*(d*=.9));var f={offset:((r-p)/2|0)-c,size:0};l=o.reduce((function(e,t){var n={item:t.item,position:{offset:f.offset+f.size+c,size:h?d:t.barSize}},r=[].concat(rT(e),[n]);return f=r[r.length-1].position,t.stackList&&t.stackList.length&&t.stackList.forEach((function(e){r.push({item:e,position:f})})),r}),u)}else{var m=qh(n,r,0,!0);r-2*m-(s-1)*c<=0&&(c=0);var g=(r-2*m-(s-1)*c)/s;g>1&&(g>>=0);var y=a===+a?Math.min(g,a):g;l=o.reduce((function(e,t,n){var r=[].concat(rT(e),[{item:t.item,position:{offset:m+(g+c)*n+(g-y)/2,size:y}}]);return t.stackList&&t.stackList.length&&t.stackList.forEach((function(e){r.push({item:e,position:r[r.length-1].position})})),r}),u)}return l}({barGap:h,barCategoryGap:d,bandSize:L!==C?L:C,sizeList:I[T],maxBarSize:D}),L!==C&&(j=j.map((function(e){return Ik(Ik({},e),{},{position:Ik(Ik({},e.position),{},{offset:e.position.offset-L/2})})})))}var z,R,F=n&&n.type&&n.type.getComposedData;F&&_.push({props:Ik(Ik({},F(Ik(Ik({},E),{},{displayedData:v,props:e,dataKey:b,item:n,bandSize:C,barPosition:j,offset:i,stackedData:P,layout:u,dataStartIndex:a,dataEndIndex:s}))),{},Ok(Ok(Ok({key:n.key||"item-".concat(f)},m,E[m]),g,E[g]),"animationId",o)),childIndex:(z=n,R=e.children,xd(R).indexOf(z)),item:n})})),_},p=function(e,t){var i=e.props,o=e.dataStartIndex,a=e.dataEndIndex,s=e.updateId;if(!Sd({props:i}))return null;var c=i.children,h=i.layout,p=i.stackOffset,f=i.data,m=i.reverseStackOrder,g=qk(h),y=g.numericAxisName,_=g.cateAxisName,v=bd(c,r),x=function(e,t,n,r,i,o){if(!e)return null;var a=(o?t.reverse():t).reduce((function(e,t){var i,o=null!==(i=t.type)&&void 0!==i&&i.defaultProps?aT(aT({},t.type.defaultProps),t.props):t.props,a=o.stackId;if(o.hide)return e;var s=o[n],l=e[s]||{hasStack:!1,stackGroups:{}};if(Gh(a)){var c=l.stackGroups[a]||{numericAxisId:n,cateAxisId:r,items:[]};c.items.push(t),l.hasStack=!0,l.stackGroups[a]=c}else l.stackGroups[Zh("_stackId_")]={numericAxisId:n,cateAxisId:r,items:[t]};return aT(aT({},e),{},sT({},s,l))}),{});return Object.keys(a).reduce((function(t,o){var s=a[o];return s.hasStack&&(s.stackGroups=Object.keys(s.stackGroups).reduce((function(t,o){var a=s.stackGroups[o];return aT(aT({},t),{},sT({},o,{numericAxisId:n,cateAxisId:r,items:a.items,stackedData:wT(e,a.items,i)}))}),{})),aT(aT({},t),{},sT({},o,s))}),{})}(f,v,"".concat(y,"Id"),"".concat(_,"Id"),p,m),b=l.reduce((function(e,t){var n="".concat(t.axisType,"Map");return Ik(Ik({},e),{},Ok({},n,Hk(i,Ik(Ik({},t),{},{graphicalItems:v,stackGroups:t.axisType===y&&x,dataStartIndex:o,dataEndIndex:a}))))}),{}),w=Wk(Ik(Ik({},b),{},{props:i,graphicalItems:v}),null===t||void 0===t?void 0:t.legendBBox);Object.keys(b).forEach((function(e){b[e]=u(i,b[e],w,e.replace("Map",""),n)}));var S=function(e){var t=Wh(e),n=mT(t,!1,!0);return{tooltipTicks:n,orderedTooltipTicks:Vd()(n,(function(e){return e.coordinate})),tooltipAxis:t,tooltipAxisBandSize:CT(t,n)}}(b["".concat(_,"Map")]),T=d(i,Ik(Ik({},b),{},{dataStartIndex:o,dataEndIndex:a,updateId:s,graphicalItems:v,stackGroups:x,offset:w}));return Ik(Ik({formattedGraphicalItems:T,graphicalItems:v,offset:w,stackGroups:x},S),b)},f=function(e){function r(e){var i,o,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),Ok(a=Tk(this,r,[e]),"eventEmitterSymbol",Symbol("rechartsEventEmitter")),Ok(a,"accessibilityManager",new bP),Ok(a,"handleLegendBBoxUpdate",(function(e){if(e){var t=a.state,n=t.dataStartIndex,r=t.dataEndIndex,i=t.updateId;a.setState(Ik({legendBBox:e},p({props:a.props,dataStartIndex:n,dataEndIndex:r,updateId:i},Ik(Ik({},a.state),{},{legendBBox:e}))))}})),Ok(a,"handleReceiveSyncEvent",(function(e,t,n){if(a.props.syncId===e){if(n===a.eventEmitterSymbol&&"function"!==typeof a.props.syncMethod)return;a.applySyncEvent(t)}})),Ok(a,"handleBrushChange",(function(e){var t=e.startIndex,n=e.endIndex;if(t!==a.state.dataStartIndex||n!==a.state.dataEndIndex){var r=a.state.updateId;a.setState((function(){return Ik({dataStartIndex:t,dataEndIndex:n},p({props:a.props,dataStartIndex:t,dataEndIndex:n,updateId:r},a.state))})),a.triggerSyncEvent({dataStartIndex:t,dataEndIndex:n})}})),Ok(a,"handleMouseEnter",(function(e){var t=a.getMouseInfo(e);if(t){var n=Ik(Ik({},t),{},{isTooltipActive:!0});a.setState(n),a.triggerSyncEvent(n);var r=a.props.onMouseEnter;ed()(r)&&r(n,e)}})),Ok(a,"triggeredAfterMouseMove",(function(e){var t=a.getMouseInfo(e),n=t?Ik(Ik({},t),{},{isTooltipActive:!0}):{isTooltipActive:!1};a.setState(n),a.triggerSyncEvent(n);var r=a.props.onMouseMove;ed()(r)&&r(n,e)})),Ok(a,"handleItemMouseEnter",(function(e){a.setState((function(){return{isTooltipActive:!0,activeItem:e,activePayload:e.tooltipPayload,activeCoordinate:e.tooltipPosition||{x:e.cx,y:e.cy}}}))})),Ok(a,"handleItemMouseLeave",(function(){a.setState((function(){return{isTooltipActive:!1}}))})),Ok(a,"handleMouseMove",(function(e){e.persist(),a.throttleTriggeredAfterMouseMove(e)})),Ok(a,"handleMouseLeave",(function(e){a.throttleTriggeredAfterMouseMove.cancel();var t={isTooltipActive:!1};a.setState(t),a.triggerSyncEvent(t);var n=a.props.onMouseLeave;ed()(n)&&n(t,e)})),Ok(a,"handleOuterEvent",(function(e){var t,n=function(e){var t=e&&e.type;return t&&gd[t]?gd[t]:null}(e),r=zh()(a.props,"".concat(n));n&&ed()(r)&&r(null!==(t=/.*touch.*/i.test(n)?a.getMouseInfo(e.changedTouches[0]):a.getMouseInfo(e))&&void 0!==t?t:{},e)})),Ok(a,"handleClick",(function(e){var t=a.getMouseInfo(e);if(t){var n=Ik(Ik({},t),{},{isTooltipActive:!0});a.setState(n),a.triggerSyncEvent(n);var r=a.props.onClick;ed()(r)&&r(n,e)}})),Ok(a,"handleMouseDown",(function(e){var t=a.props.onMouseDown;ed()(t)&&t(a.getMouseInfo(e),e)})),Ok(a,"handleMouseUp",(function(e){var t=a.props.onMouseUp;ed()(t)&&t(a.getMouseInfo(e),e)})),Ok(a,"handleTouchMove",(function(e){null!=e.changedTouches&&e.changedTouches.length>0&&a.throttleTriggeredAfterMouseMove(e.changedTouches[0])})),Ok(a,"handleTouchStart",(function(e){null!=e.changedTouches&&e.changedTouches.length>0&&a.handleMouseDown(e.changedTouches[0])})),Ok(a,"handleTouchEnd",(function(e){null!=e.changedTouches&&e.changedTouches.length>0&&a.handleMouseUp(e.changedTouches[0])})),Ok(a,"handleDoubleClick",(function(e){var t=a.props.onDoubleClick;ed()(t)&&t(a.getMouseInfo(e),e)})),Ok(a,"handleContextMenu",(function(e){var t=a.props.onContextMenu;ed()(t)&&t(a.getMouseInfo(e),e)})),Ok(a,"triggerSyncEvent",(function(e){void 0!==a.props.syncId&&mP.emit(gP,a.props.syncId,e,a.eventEmitterSymbol)})),Ok(a,"applySyncEvent",(function(e){var t=a.props,n=t.layout,r=t.syncMethod,i=a.state.updateId,o=e.dataStartIndex,s=e.dataEndIndex;if(void 0!==e.dataStartIndex||void 0!==e.dataEndIndex)a.setState(Ik({dataStartIndex:o,dataEndIndex:s},p({props:a.props,dataStartIndex:o,dataEndIndex:s,updateId:i},a.state)));else if(void 0!==e.activeTooltipIndex){var l=e.chartX,c=e.chartY,u=e.activeTooltipIndex,h=a.state,d=h.offset,f=h.tooltipTicks;if(!d)return;if("function"===typeof r)u=r(f,e);else if("value"===r){u=-1;for(var m=0;m<f.length;m++)if(f[m].value===e.activeLabel){u=m;break}}var g=Ik(Ik({},d),{},{x:d.left,y:d.top}),y=Math.min(l,g.x+g.width),_=Math.min(c,g.y+g.height),v=f[u]&&f[u].value,x=Vk(a.state,a.props.data,u),b=f[u]?{x:"horizontal"===n?f[u].coordinate:y,y:"horizontal"===n?_:f[u].coordinate}:zk;a.setState(Ik(Ik({},e),{},{activeLabel:v,activeCoordinate:b,activePayload:x,activeTooltipIndex:u}))}else a.setState(e)})),Ok(a,"renderCursor",(function(e){var r,i=a.state,o=i.isTooltipActive,s=i.activeCoordinate,l=i.activePayload,c=i.offset,u=i.activeTooltipIndex,h=i.tooltipAxisBandSize,d=a.getTooltipEventType(),p=null!==(r=e.props.active)&&void 0!==r?r:o,f=a.props.layout,m=e.key||"_recharts-cursor";return t.createElement(gk,{key:m,activeCoordinate:s,activePayload:l,activeTooltipIndex:u,chartName:n,element:e,isActive:p,layout:f,offset:c,tooltipAxisBandSize:h,tooltipEventType:d})})),Ok(a,"renderPolarAxis",(function(e,n,r){var i=zh()(e,"type.axisType"),o=zh()(a.state,"".concat(i,"Map")),s=e.type.defaultProps,l=void 0!==s?Ik(Ik({},s),e.props):e.props,c=o&&o[l["".concat(i,"Id")]];return(0,t.cloneElement)(e,Ik(Ik({},c),{},{className:kh(i,c.className),key:e.key||"".concat(n,"-").concat(r),ticks:mT(c,!0)}))})),Ok(a,"renderPolarGrid",(function(e){var n=e.props,r=n.radialLines,i=n.polarAngles,o=n.polarRadius,s=a.state,l=s.radiusAxisMap,c=s.angleAxisMap,u=Wh(l),h=Wh(c),d=h.cx,p=h.cy,f=h.innerRadius,m=h.outerRadius;return(0,t.cloneElement)(e,{polarAngles:Array.isArray(i)?i:mT(h,!0).map((function(e){return e.coordinate})),polarRadius:Array.isArray(o)?o:mT(u,!0).map((function(e){return e.coordinate})),cx:d,cy:p,innerRadius:f,outerRadius:m,key:e.key||"polar-grid",radialLines:r})})),Ok(a,"renderLegend",(function(){var e=a.state.formattedGraphicalItems,n=a.props,r=n.children,i=n.width,o=n.height,s=a.props.margin||{},l=i-(s.left||0)-(s.right||0),u=tT({children:r,formattedGraphicalItems:e,legendWidth:l,legendContent:c});if(!u)return null;var h=u.item,d=wk(u,yk);return(0,t.cloneElement)(h,Ik(Ik({},d),{},{chartWidth:i,chartHeight:o,margin:s,onBBoxUpdate:a.handleLegendBBoxUpdate}))})),Ok(a,"renderTooltip",(function(){var e,n=a.props,r=n.children,i=n.accessibilityLayer,o=wd(r,Fp);if(!o)return null;var s=a.state,l=s.isTooltipActive,c=s.activeCoordinate,u=s.activePayload,h=s.activeLabel,d=s.offset,p=null!==(e=o.props.active)&&void 0!==e?e:l;return(0,t.cloneElement)(o,{viewBox:Ik(Ik({},d),{},{x:d.left,y:d.top}),active:p,label:h,payload:p?u:[],coordinate:c,accessibilityLayer:i})})),Ok(a,"renderBrush",(function(e){var n=a.props,r=n.margin,i=n.data,o=a.state,s=o.offset,l=o.dataStartIndex,c=o.dataEndIndex,u=o.updateId;return(0,t.cloneElement)(e,{key:e.key||"_recharts-brush",onChange:yT(a.handleBrushChange,e.props.onChange),data:i,x:Uh(e.props.x)?e.props.x:s.left,y:Uh(e.props.y)?e.props.y:s.top+s.height+s.brushBottom-(r.bottom||0),width:Uh(e.props.width)?e.props.width:s.width,startIndex:l,endIndex:c,updateId:"brush-".concat(u)})})),Ok(a,"renderReferenceElement",(function(e,n,r){if(!e)return null;var i=a.clipPathId,o=a.state,s=o.xAxisMap,l=o.yAxisMap,c=o.offset,u=e.type.defaultProps||{},h=e.props,d=h.xAxisId,p=void 0===d?u.xAxisId:d,f=h.yAxisId,m=void 0===f?u.yAxisId:f;return(0,t.cloneElement)(e,{key:e.key||"".concat(n,"-").concat(r),xAxis:s[p],yAxis:l[m],viewBox:{x:c.left,y:c.top,width:c.width,height:c.height},clipPathId:i})})),Ok(a,"renderActivePoints",(function(e){var t=e.item,n=e.activePoint,i=e.basePoint,o=e.childIndex,a=e.isRange,s=[],l=t.props.key,c=void 0!==t.item.type.defaultProps?Ik(Ik({},t.item.type.defaultProps),t.item.props):t.item.props,u=c.activeDot,h=Ik(Ik({index:o,dataKey:c.dataKey,cx:n.x,cy:n.y,r:4,fill:uT(t.item),strokeWidth:2,stroke:"#fff",payload:n.payload,value:n.value},Md(u,!1)),ud(u));return s.push(r.renderActiveDot(u,h,"".concat(l,"-activePoint-").concat(o))),i?s.push(r.renderActiveDot(u,Ik(Ik({},h),{},{cx:i.x,cy:i.y}),"".concat(l,"-basePoint-").concat(o))):a&&s.push(null),s})),Ok(a,"renderGraphicChild",(function(e,n,r){var i=a.filterFormatItem(e,n,r);if(!i)return null;var o=a.getTooltipEventType(),s=a.state,l=s.isTooltipActive,c=s.tooltipAxis,u=s.activeTooltipIndex,h=s.activeLabel,d=wd(a.props.children,Fp),p=i.props,f=p.points,m=p.isRange,g=p.baseLine,y=void 0!==i.item.type.defaultProps?Ik(Ik({},i.item.type.defaultProps),i.item.props):i.item.props,_=y.activeDot,v=y.hide,x=y.activeBar,b=y.activeShape,w=Boolean(!v&&l&&d&&(_||x||b)),S={};"axis"!==o&&d&&"click"===d.props.trigger?S={onClick:yT(a.handleItemMouseEnter,e.props.onClick)}:"axis"!==o&&(S={onMouseLeave:yT(a.handleItemMouseLeave,e.props.onMouseLeave),onMouseEnter:yT(a.handleItemMouseEnter,e.props.onMouseEnter)});var T=(0,t.cloneElement)(e,Ik(Ik({},i.props),S));if(w){if(!(u>=0)){var E,A=(null!==(E=a.getItemByXY(a.state.activeCoordinate))&&void 0!==E?E:{graphicalItem:T}).graphicalItem,M=A.item,P=void 0===M?e:M,k=A.childIndex,C=Ik(Ik(Ik({},i.props),S),{},{activeIndex:k});return[(0,t.cloneElement)(P,C),null,null]}var j,I;if(c.dataKey&&!c.allowDuplicatedCategory){var O="function"===typeof c.dataKey?function(e){return"function"===typeof c.dataKey?c.dataKey(e.payload):null}:"payload.".concat(c.dataKey.toString());j=Yh(f,O,h),I=m&&g&&Yh(g,O,h)}else j=null===f||void 0===f?void 0:f[u],I=m&&g&&g[u];if(b||x){var N=void 0!==e.props.activeIndex?e.props.activeIndex:u;return[(0,t.cloneElement)(e,Ik(Ik(Ik({},i.props),S),{},{activeIndex:N})),null,null]}if(!Qh()(j))return[T].concat(Pk(a.renderActivePoints({item:i,activePoint:j,basePoint:I,childIndex:u,isRange:m})))}return m?[T,null,null]:[T,null]})),Ok(a,"renderCustomized",(function(e,n,r){return(0,t.cloneElement)(e,Ik(Ik({key:"recharts-customized-".concat(r)},a.props),a.state))})),Ok(a,"renderMap",{CartesianGrid:{handler:Rk,once:!0},ReferenceArea:{handler:a.renderReferenceElement},ReferenceLine:{handler:Rk},ReferenceDot:{handler:a.renderReferenceElement},XAxis:{handler:Rk},YAxis:{handler:Rk},Brush:{handler:a.renderBrush,once:!0},Bar:{handler:a.renderGraphicChild},Line:{handler:a.renderGraphicChild},Area:{handler:a.renderGraphicChild},Radar:{handler:a.renderGraphicChild},RadialBar:{handler:a.renderGraphicChild},Scatter:{handler:a.renderGraphicChild},Pie:{handler:a.renderGraphicChild},Funnel:{handler:a.renderGraphicChild},Tooltip:{handler:a.renderCursor,once:!0},PolarGrid:{handler:a.renderPolarGrid,once:!0},PolarAngleAxis:{handler:a.renderPolarAxis},PolarRadiusAxis:{handler:a.renderPolarAxis},Customized:{handler:a.renderCustomized}}),a.clipPathId="".concat(null!==(i=e.id)&&void 0!==i?i:Zh("recharts"),"-clip"),a.throttleTriggeredAfterMouseMove=jh()(a.triggeredAfterMouseMove,null!==(o=e.throttleDelay)&&void 0!==o?o:1e3/60),a.state={},a}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Mk(e,t)}(r,e),i=r,a=[{key:"componentDidMount",value:function(){var e,t;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:null!==(e=this.props.margin.left)&&void 0!==e?e:0,top:null!==(t=this.props.margin.top)&&void 0!==t?t:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var e=this.props,t=e.children,n=e.data,r=e.height,i=e.layout,o=wd(t,Fp);if(o){var a=o.props.defaultIndex;if(!("number"!==typeof a||a<0||a>this.state.tooltipTicks.length-1)){var s=this.state.tooltipTicks[a]&&this.state.tooltipTicks[a].value,l=Vk(this.state,n,a,s),c=this.state.tooltipTicks[a].coordinate,u=(this.state.offset.top+r)/2,h="horizontal"===i?{x:c,y:u}:{y:c,x:u},d=this.state.formattedGraphicalItems.find((function(e){return"Scatter"===e.item.type.name}));d&&(h=Ik(Ik({},h),d.props.points[a].tooltipPosition),l=d.props.points[a].tooltipPayload);var p={activeTooltipIndex:a,isTooltipActive:!0,activeLabel:s,activePayload:l,activeCoordinate:h};this.setState(p),this.renderCursor(o),this.accessibilityManager.setIndex(a)}}}},{key:"getSnapshotBeforeUpdate",value:function(e,t){return this.props.accessibilityLayer?(this.state.tooltipTicks!==t.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==e.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==e.margin&&this.accessibilityManager.setDetails({offset:{left:null!==(n=this.props.margin.left)&&void 0!==n?n:0,top:null!==(r=this.props.margin.top)&&void 0!==r?r:0}}),null):null;var n,r}},{key:"componentDidUpdate",value:function(e){Pd([wd(e.children,Fp)],[wd(this.props.children,Fp)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var e=wd(this.props.children,Fp);if(e&&"boolean"===typeof e.props.shared){var t=e.props.shared?"axis":"item";return s.indexOf(t)>=0?t:o}return o}},{key:"getMouseInfo",value:function(e){if(!this.container)return null;var t,n=this.container,r=n.getBoundingClientRect(),i={top:(t=r).top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft},o={chartX:Math.round(e.pageX-i.left),chartY:Math.round(e.pageY-i.top)},a=r.width/n.offsetWidth||1,s=this.inRange(o.chartX,o.chartY,a);if(!s)return null;var l=this.state,c=l.xAxisMap,u=l.yAxisMap;if("axis"!==this.getTooltipEventType()&&c&&u){var h=Wh(c).scale,d=Wh(u).scale,p=h&&h.invert?h.invert(o.chartX):null,f=d&&d.invert?d.invert(o.chartY):null;return Ik(Ik({},o),{},{xValue:p,yValue:f})}var m=Uk(this.state,this.props.data,this.props.layout,s);return m?Ik(Ik({},o),m):null}},{key:"inRange",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=this.props.layout,i=e/n,o=t/n;if("horizontal"===r||"vertical"===r){var a=this.state.offset;return i>=a.left&&i<=a.left+a.width&&o>=a.top&&o<=a.top+a.height?{x:i,y:o}:null}var s=this.state,l=s.angleAxisMap,c=s.radiusAxisMap;if(l&&c){var u=Wh(l);return cE({x:i,y:o},u)}return null}},{key:"parseEventsOfWrapper",value:function(){var e=this.props.children,t=this.getTooltipEventType(),n=wd(e,Fp),r={};return n&&"axis"===t&&(r="click"===n.props.trigger?{onClick:this.handleClick}:{onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu}),Ik(Ik({},ud(this.props,this.handleOuterEvent)),r)}},{key:"addListener",value:function(){mP.on(gP,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){mP.removeListener(gP,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(e,t,n){for(var r=this.state.formattedGraphicalItems,i=0,o=r.length;i<o;i++){var a=r[i];if(a.item===e||a.props.key===e.key||t===yd(a.item.type)&&n===a.childIndex)return a}return null}},{key:"renderClipPath",value:function(){var e=this.clipPathId,n=this.state.offset,r=n.left,i=n.top,o=n.height,a=n.width;return t.createElement("defs",null,t.createElement("clipPath",{id:e},t.createElement("rect",{x:r,y:i,height:o,width:a})))}},{key:"getXScales",value:function(){var e=this.state.xAxisMap;return e?Object.entries(e).reduce((function(e,t){var n=bk(t,2),r=n[0],i=n[1];return Ik(Ik({},e),{},Ok({},r,i.scale))}),{}):null}},{key:"getYScales",value:function(){var e=this.state.yAxisMap;return e?Object.entries(e).reduce((function(e,t){var n=bk(t,2),r=n[0],i=n[1];return Ik(Ik({},e),{},Ok({},r,i.scale))}),{}):null}},{key:"getXScaleByAxisId",value:function(e){var t;return null===(t=this.state.xAxisMap)||void 0===t||null===(t=t[e])||void 0===t?void 0:t.scale}},{key:"getYScaleByAxisId",value:function(e){var t;return null===(t=this.state.yAxisMap)||void 0===t||null===(t=t[e])||void 0===t?void 0:t.scale}},{key:"getItemByXY",value:function(e){var t=this.state,n=t.formattedGraphicalItems,r=t.activeItem;if(n&&n.length)for(var i=0,o=n.length;i<o;i++){var a=n[i],s=a.props,l=a.item,c=void 0!==l.type.defaultProps?Ik(Ik({},l.type.defaultProps),l.props):l.props,u=yd(l.type);if("Bar"===u){var h=(s.data||[]).find((function(t){return ty(e,t)}));if(h)return{graphicalItem:a,payload:h}}else if("RadialBar"===u){var d=(s.data||[]).find((function(t){return cE(e,t)}));if(d)return{graphicalItem:a,payload:d}}else if(bA(a,r)||wA(a,r)||SA(a,r)){var p=MA({graphicalItem:a,activeTooltipItem:r,itemData:c.data}),f=void 0===c.activeIndex?p:c.activeIndex;return{graphicalItem:Ik(Ik({},a),{},{childIndex:f}),payload:SA(a,r)?c.data[p]:a.props.data[p]}}}return null}},{key:"render",value:function(){var e=this;if(!Sd(this))return null;var n,r,i=this.props,o=i.children,a=i.className,s=i.width,l=i.height,c=i.style,u=i.compact,h=i.title,d=i.desc,p=wk(i,_k),f=Md(p,!1);if(u)return t.createElement(OM,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},t.createElement(Wd,xk({},f,{width:s,height:l,title:h,desc:d}),this.renderClipPath(),Cd(o,this.renderMap)));this.props.accessibilityLayer&&(f.tabIndex=null!==(n=this.props.tabIndex)&&void 0!==n?n:0,f.role=null!==(r=this.props.role)&&void 0!==r?r:"application",f.onKeyDown=function(t){e.accessibilityManager.keyboardEvent(t)},f.onFocus=function(){e.accessibilityManager.focus()});var m=this.parseEventsOfWrapper();return t.createElement(OM,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},t.createElement("div",xk({className:kh("recharts-wrapper",a),style:Ik({position:"relative",cursor:"default",width:s,height:l},c)},m,{ref:function(t){e.container=t}}),t.createElement(Wd,xk({},f,{width:s,height:l,title:h,desc:d,style:Lk}),this.renderClipPath(),Cd(o,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}],a&&Sk(i.prototype,a),l&&Sk(i,l),Object.defineProperty(i,"prototype",{writable:!1}),i;var i,a,l}(t.Component);Ok(f,"displayName",n),Ok(f,"defaultProps",Ik({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},h)),Ok(f,"getDerivedStateFromProps",(function(e,t){var n=e.dataKey,r=e.data,i=e.children,o=e.width,a=e.height,s=e.layout,l=e.stackOffset,c=e.margin,u=t.dataStartIndex,h=t.dataEndIndex;if(void 0===t.updateId){var d=Zk(e);return Ik(Ik(Ik({},d),{},{updateId:0},p(Ik(Ik({props:e},d),{},{updateId:0}),t)),{},{prevDataKey:n,prevData:r,prevWidth:o,prevHeight:a,prevLayout:s,prevStackOffset:l,prevMargin:c,prevChildren:i})}if(n!==t.prevDataKey||r!==t.prevData||o!==t.prevWidth||a!==t.prevHeight||s!==t.prevLayout||l!==t.prevStackOffset||!id(c,t.prevMargin)){var f=Zk(e),m={chartX:t.chartX,chartY:t.chartY,isTooltipActive:t.isTooltipActive},g=Ik(Ik({},Uk(t,r,s)),{},{updateId:t.updateId+1}),y=Ik(Ik(Ik({},f),m),g);return Ik(Ik(Ik({},y),p(Ik({props:e},y),t)),{},{prevDataKey:n,prevData:r,prevWidth:o,prevHeight:a,prevLayout:s,prevStackOffset:l,prevMargin:c,prevChildren:i})}if(!Pd(i,t.prevChildren)){var _,v,x,b,w=wd(i,KT),S=w&&null!==(_=null===(v=w.props)||void 0===v?void 0:v.startIndex)&&void 0!==_?_:u,T=w&&null!==(x=null===(b=w.props)||void 0===b?void 0:b.endIndex)&&void 0!==x?x:h,E=S!==u||T!==h,A=!Qh()(r)&&!E?t.updateId:t.updateId+1;return Ik(Ik({updateId:A},p(Ik(Ik({props:e},t),{},{updateId:A,dataStartIndex:S,dataEndIndex:T}),t)),{},{prevChildren:i,dataStartIndex:S,dataEndIndex:T})}return null})),Ok(f,"renderActiveDot",(function(e,n,r){var i;return i=(0,t.isValidElement)(e)?(0,t.cloneElement)(e,n):ed()(e)?e(n):t.createElement(ym,n),t.createElement(Jd,{className:"recharts-active-dot",key:r},i)}));var m=(0,t.forwardRef)((function(e,n){return t.createElement(f,xk({},e,{ref:n}))}));return m.displayName=f.displayName,m},Kk=["type","layout","connectNulls","ref"],Jk=["key"];function Qk(e){return Qk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qk(e)}function $k(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function eC(){return eC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},eC.apply(this,arguments)}function tC(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function nC(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tC(Object(n),!0).forEach((function(t){uC(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tC(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function rC(e){return function(e){if(Array.isArray(e))return iC(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return iC(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return iC(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function iC(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function oC(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,hC(r.key),r)}}function aC(e,t,n){return t=lC(t),function(e,t){if(t&&("object"===Qk(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,sC()?Reflect.construct(t,n||[],lC(e).constructor):t.apply(e,n))}function sC(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(sC=function(){return!!e})()}function lC(e){return lC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},lC(e)}function cC(e,t){return cC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},cC(e,t)}function uC(e,t,n){return(t=hC(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function hC(e){var t=function(e,t){if("object"!=Qk(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=Qk(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Qk(t)?t:t+""}var dC=function(e){function n(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return uC(e=aC(this,n,[].concat(r)),"state",{isAnimationFinished:!0,totalLength:0}),uC(e,"generateSimpleStrokeDasharray",(function(e,t){return"".concat(t,"px ").concat(e-t,"px")})),uC(e,"getStrokeDasharray",(function(t,r,i){var o=i.reduce((function(e,t){return e+t}));if(!o)return e.generateSimpleStrokeDasharray(r,t);for(var a=Math.floor(t/o),s=t%o,l=r-t,c=[],u=0,h=0;u<i.length;h+=i[u],++u)if(h+i[u]>s){c=[].concat(rC(i.slice(0,u)),[s-h]);break}var d=c.length%2===0?[0,l]:[l];return[].concat(rC(n.repeat(i,a)),rC(c),d).map((function(e){return"".concat(e,"px")})).join(", ")})),uC(e,"id",Zh("recharts-line-")),uC(e,"pathRef",(function(t){e.mainCurve=t})),uC(e,"handleAnimationEnd",(function(){e.setState({isAnimationFinished:!0}),e.props.onAnimationEnd&&e.props.onAnimationEnd()})),uC(e,"handleAnimationStart",(function(){e.setState({isAnimationFinished:!1}),e.props.onAnimationStart&&e.props.onAnimationStart()})),e}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&cC(e,t)}(n,e),r=n,i=[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var e=this.getTotalLength();this.setState({totalLength:e})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var e=this.getTotalLength();e!==this.state.totalLength&&this.setState({totalLength:e})}}},{key:"getTotalLength",value:function(){var e=this.mainCurve;try{return e&&e.getTotalLength&&e.getTotalLength()||0}catch(t){return 0}}},{key:"renderErrorBar",value:function(e,n){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var r=this.props,i=r.points,o=r.xAxis,a=r.yAxis,s=r.layout,l=bd(r.children,KS);if(!l)return null;var c=function(e,t){return{x:e.x,y:e.y,value:e.value,errorVal:lT(e.payload,t)}},u={clipPath:e?"url(#clipPath-".concat(n,")"):null};return t.createElement(Jd,u,l.map((function(e){return t.cloneElement(e,{key:"bar-".concat(e.props.dataKey),data:i,xAxis:o,yAxis:a,layout:s,dataPointFormatter:c})})))}},{key:"renderDots",value:function(e,r,i){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var o=this.props,a=o.dot,s=o.points,l=o.dataKey,c=Md(this.props,!1),u=Md(a,!0),h=s.map((function(e,t){var r=nC(nC(nC({key:"dot-".concat(t),r:3},c),u),{},{value:e.value,dataKey:l,cx:e.x,cy:e.y,index:t,payload:e.payload});return n.renderDotItem(a,r)})),d={clipPath:e?"url(#clipPath-".concat(r?"":"dots-").concat(i,")"):null};return t.createElement(Jd,eC({className:"recharts-line-dots",key:"dots"},d),h)}},{key:"renderCurveStatically",value:function(e,n,r,i){var o=this.props,a=o.type,s=o.layout,l=o.connectNulls,c=(o.ref,$k(o,Kk)),u=nC(nC(nC({},Md(c,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:n?"url(#clipPath-".concat(r,")"):null,points:e},i),{},{type:a,layout:s,connectNulls:l});return t.createElement(tk,eC({},u,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(e,n){var r=this,i=this.props,o=i.points,a=i.strokeDasharray,s=i.isAnimationActive,l=i.animationBegin,c=i.animationDuration,u=i.animationEasing,h=i.animationId,d=i.animateNewValues,p=i.width,f=i.height,m=this.state,g=m.prevPoints,y=m.totalLength;return t.createElement(qg,{begin:l,duration:c,isActive:s,easing:u,from:{t:0},to:{t:1},key:"line-".concat(h),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},(function(t){var i=t.t;if(g){var s=g.length/o.length,l=o.map((function(e,t){var n=Math.floor(t*s);if(g[n]){var r=g[n],o=Xh(r.x,e.x),a=Xh(r.y,e.y);return nC(nC({},e),{},{x:o(i),y:a(i)})}if(d){var l=Xh(2*p,e.x),c=Xh(f/2,e.y);return nC(nC({},e),{},{x:l(i),y:c(i)})}return nC(nC({},e),{},{x:e.x,y:e.y})}));return r.renderCurveStatically(l,e,n)}var c,u=Xh(0,y)(i);if(a){var h="".concat(a).split(/[,\s]+/gim).map((function(e){return parseFloat(e)}));c=r.getStrokeDasharray(u,y,h)}else c=r.generateSimpleStrokeDasharray(y,u);return r.renderCurveStatically(o,e,n,{strokeDasharray:c})}))}},{key:"renderCurve",value:function(e,t){var n=this.props,r=n.points,i=n.isAnimationActive,o=this.state,a=o.prevPoints,s=o.totalLength;return i&&r&&r.length&&(!a&&s>0||!sS()(a,r))?this.renderCurveWithAnimation(e,t):this.renderCurveStatically(r,e,t)}},{key:"render",value:function(){var e,n=this.props,r=n.hide,i=n.dot,o=n.points,a=n.className,s=n.xAxis,l=n.yAxis,c=n.top,u=n.left,h=n.width,d=n.height,p=n.isAnimationActive,f=n.id;if(r||!o||!o.length)return null;var m=this.state.isAnimationFinished,g=1===o.length,y=kh("recharts-line",a),_=s&&s.allowDataOverflow,v=l&&l.allowDataOverflow,x=_||v,b=Qh()(f)?this.id:f,w=null!==(e=Md(i,!1))&&void 0!==e?e:{r:3,strokeWidth:2},S=w.r,T=void 0===S?3:S,E=w.strokeWidth,A=void 0===E?2:E,M=(Ad(i)?i:{}).clipDot,P=void 0===M||M,k=2*T+A;return t.createElement(Jd,{className:y},_||v?t.createElement("defs",null,t.createElement("clipPath",{id:"clipPath-".concat(b)},t.createElement("rect",{x:_?u:u-h/2,y:v?c:c-d/2,width:_?h:2*h,height:v?d:2*d})),!P&&t.createElement("clipPath",{id:"clipPath-dots-".concat(b)},t.createElement("rect",{x:u-k/2,y:c-k/2,width:h+k,height:d+k}))):null,!g&&this.renderCurve(x,b),this.renderErrorBar(x,b),(g||i)&&this.renderDots(x,P,b),(!p||m)&&UE.renderCallByParent(this.props,o))}}],o=[{key:"getDerivedStateFromProps",value:function(e,t){return e.animationId!==t.prevAnimationId?{prevAnimationId:e.animationId,curPoints:e.points,prevPoints:t.curPoints}:e.points!==t.curPoints?{curPoints:e.points}:null}},{key:"repeat",value:function(e,t){for(var n=e.length%2!==0?[].concat(rC(e),[0]):e,r=[],i=0;i<t;++i)r=[].concat(rC(r),rC(n));return r}},{key:"renderDotItem",value:function(e,n){var r;if(t.isValidElement(e))r=t.cloneElement(e,n);else if(ed()(e))r=e(n);else{var i=n.key,o=$k(n,Jk),a=kh("recharts-line-dot","boolean"!==typeof e?e.className:"");r=t.createElement(ym,eC({key:i},o,{className:a}))}return r}}],i&&oC(r.prototype,i),o&&oC(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,i,o}(t.PureComponent);function pC(e,t,n){if(t<1)return[];if(1===t&&void 0===n)return e;for(var r=[],i=0;i<e.length;i+=t){if(void 0!==n&&!0!==n(e[i]))return;r.push(e[i])}return r}function fC(e,t,n){return function(e){var t=e.width,n=e.height,r=function(e){return(e%180+180)%180}(arguments.length>1&&void 0!==arguments[1]?arguments[1]:0),i=r*Math.PI/180,o=Math.atan(n/t),a=i>o&&i<Math.PI-o?n/Math.sin(i):t/Math.cos(i);return Math.abs(a)}({width:e.width+t.width,height:e.height+t.height},n)}function mC(e,t,n,r,i){if(e*t<e*r||e*t>e*i)return!1;var o=n();return e*(t-e*o/2-r)>=0&&e*(t+e*o/2-i)<=0}function gC(e){return gC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gC(e)}function yC(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?yC(Object(n),!0).forEach((function(t){vC(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yC(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function vC(e,t,n){return t=function(e){var t=function(e,t){if("object"!=gC(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=gC(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==gC(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function xC(e,t,n){var r=e.tick,i=e.ticks,o=e.viewBox,a=e.minTickGap,s=e.orientation,l=e.interval,c=e.tickFormatter,u=e.unit,h=e.angle;if(!i||!i.length||!r)return[];if(Uh(l)||Tp.isSsr)return function(e,t){return pC(e,t+1)}(i,"number"===typeof l&&Uh(l)?l:0);var d=[],p="top"===s||"bottom"===s?"width":"height",f=u&&"width"===p?Sy(u,{fontSize:t,letterSpacing:n}):{width:0,height:0},m=function(e,r){var i=ed()(c)?c(e.value,r):e.value;return"width"===p?fC(Sy(i,{fontSize:t,letterSpacing:n}),f,h):Sy(i,{fontSize:t,letterSpacing:n})[p]},g=i.length>=2?Bh(i[1].coordinate-i[0].coordinate):1,y=function(e,t,n){var r="width"===n,i=e.x,o=e.y,a=e.width,s=e.height;return 1===t?{start:r?i:o,end:r?i+a:o+s}:{start:r?i+a:o+s,end:r?i:o}}(o,g,p);return"equidistantPreserveStart"===l?function(e,t,n,r,i){for(var o,a=(r||[]).slice(),s=t.start,l=t.end,c=0,u=1,h=s,d=function(){var t=null===r||void 0===r?void 0:r[c];if(void 0===t)return{v:pC(r,u)};var o,a=c,d=function(){return void 0===o&&(o=n(t,a)),o},p=t.coordinate,f=0===c||mC(e,p,d,h,l);f||(c=0,h=s,u+=1),f&&(h=p+e*(d()/2+i),c+=u)};u<=a.length;)if(o=d())return o.v;return[]}(g,y,m,i,a):(d="preserveStart"===l||"preserveStartEnd"===l?function(e,t,n,r,i,o){var a=(r||[]).slice(),s=a.length,l=t.start,c=t.end;if(o){var u=r[s-1],h=n(u,s-1),d=e*(u.coordinate+e*h/2-c);a[s-1]=u=_C(_C({},u),{},{tickCoord:d>0?u.coordinate-d*e:u.coordinate}),mC(e,u.tickCoord,(function(){return h}),l,c)&&(c=u.tickCoord-e*(h/2+i),a[s-1]=_C(_C({},u),{},{isShow:!0}))}for(var p=o?s-1:s,f=function(t){var r,o=a[t],s=function(){return void 0===r&&(r=n(o,t)),r};if(0===t){var u=e*(o.coordinate-e*s()/2-l);a[t]=o=_C(_C({},o),{},{tickCoord:u<0?o.coordinate-u*e:o.coordinate})}else a[t]=o=_C(_C({},o),{},{tickCoord:o.coordinate});mC(e,o.tickCoord,s,l,c)&&(l=o.tickCoord+e*(s()/2+i),a[t]=_C(_C({},o),{},{isShow:!0}))},m=0;m<p;m++)f(m);return a}(g,y,m,i,a,"preserveStartEnd"===l):function(e,t,n,r,i){for(var o=(r||[]).slice(),a=o.length,s=t.start,l=t.end,c=function(t){var r,c=o[t],u=function(){return void 0===r&&(r=n(c,t)),r};if(t===a-1){var h=e*(c.coordinate+e*u()/2-l);o[t]=c=_C(_C({},c),{},{tickCoord:h>0?c.coordinate-h*e:c.coordinate})}else o[t]=c=_C(_C({},c),{},{tickCoord:c.coordinate});mC(e,c.tickCoord,u,s,l)&&(l=c.tickCoord-e*(u()/2+i),o[t]=_C(_C({},c),{},{isShow:!0}))},u=a-1;u>=0;u--)c(u);return o}(g,y,m,i,a),d.filter((function(e){return e.isShow})))}uC(dC,"displayName","Line"),uC(dC,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!Tp.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1}),uC(dC,"getComposedData",(function(e){var t=e.props,n=e.xAxis,r=e.yAxis,i=e.xAxisTicks,o=e.yAxisTicks,a=e.dataKey,s=e.bandSize,l=e.displayedData,c=e.offset,u=t.layout,h=l.map((function(e,t){var l=lT(e,a);return"horizontal"===u?{x:TT({axis:n,ticks:i,bandSize:s,entry:e,index:t}),y:Qh()(l)?null:r.scale(l),value:l,payload:e}:{x:Qh()(l)?null:n.scale(l),y:TT({axis:r,ticks:o,bandSize:s,entry:e,index:t}),value:l,payload:e}}));return nC({points:h,layout:u},c)}));var bC=["viewBox"],wC=["viewBox"],SC=["ticks"];function TC(e){return TC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},TC(e)}function EC(){return EC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},EC.apply(this,arguments)}function AC(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function MC(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?AC(Object(n),!0).forEach((function(t){NC(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):AC(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function PC(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function kC(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,DC(r.key),r)}}function CC(e,t,n){return t=IC(t),function(e,t){if(t&&("object"===TC(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,jC()?Reflect.construct(t,n||[],IC(e).constructor):t.apply(e,n))}function jC(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(jC=function(){return!!e})()}function IC(e){return IC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},IC(e)}function OC(e,t){return OC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},OC(e,t)}function NC(e,t,n){return(t=DC(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function DC(e){var t=function(e,t){if("object"!=TC(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=TC(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==TC(t)?t:t+""}var LC=function(e){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=CC(this,n,[e])).state={fontSize:"",letterSpacing:""},t}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&OC(e,t)}(n,e),r=n,i=[{key:"shouldComponentUpdate",value:function(e,t){var n=e.viewBox,r=PC(e,bC),i=this.props,o=i.viewBox,a=PC(i,wC);return!id(n,o)||!id(r,a)||!id(t,this.state)}},{key:"componentDidMount",value:function(){var e=this.layerReference;if(e){var t=e.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];t&&this.setState({fontSize:window.getComputedStyle(t).fontSize,letterSpacing:window.getComputedStyle(t).letterSpacing})}}},{key:"getTickLineCoord",value:function(e){var t,n,r,i,o,a,s=this.props,l=s.x,c=s.y,u=s.width,h=s.height,d=s.orientation,p=s.tickSize,f=s.mirror,m=s.tickMargin,g=f?-1:1,y=e.tickSize||p,_=Uh(e.tickCoord)?e.tickCoord:e.coordinate;switch(d){case"top":t=n=e.coordinate,a=(r=(i=c+ +!f*h)-g*y)-g*m,o=_;break;case"left":r=i=e.coordinate,o=(t=(n=l+ +!f*u)-g*y)-g*m,a=_;break;case"right":r=i=e.coordinate,o=(t=(n=l+ +f*u)+g*y)+g*m,a=_;break;default:t=n=e.coordinate,a=(r=(i=c+ +f*h)+g*y)+g*m,o=_}return{line:{x1:t,y1:r,x2:n,y2:i},tick:{x:o,y:a}}}},{key:"getTickTextAnchor",value:function(){var e,t=this.props,n=t.orientation,r=t.mirror;switch(n){case"left":e=r?"start":"end";break;case"right":e=r?"end":"start";break;default:e="middle"}return e}},{key:"getTickVerticalAnchor",value:function(){var e=this.props,t=e.orientation,n=e.mirror,r="end";switch(t){case"left":case"right":r="middle";break;case"top":r=n?"start":"end";break;default:r=n?"end":"start"}return r}},{key:"renderAxisLine",value:function(){var e=this.props,n=e.x,r=e.y,i=e.width,o=e.height,a=e.orientation,s=e.mirror,l=e.axisLine,c=MC(MC(MC({},Md(this.props,!1)),Md(l,!1)),{},{fill:"none"});if("top"===a||"bottom"===a){var u=+("top"===a&&!s||"bottom"===a&&s);c=MC(MC({},c),{},{x1:n,y1:r+u*o,x2:n+i,y2:r+u*o})}else{var h=+("left"===a&&!s||"right"===a&&s);c=MC(MC({},c),{},{x1:n+h*i,y1:r,x2:n+h*i,y2:r+o})}return t.createElement("line",EC({},c,{className:kh("recharts-cartesian-axis-line",zh()(l,"className"))}))}},{key:"renderTicks",value:function(e,r,i){var o=this,a=this.props,s=a.tickLine,l=a.stroke,c=a.tick,u=a.tickFormatter,h=a.unit,d=xC(MC(MC({},this.props),{},{ticks:e}),r,i),p=this.getTickTextAnchor(),f=this.getTickVerticalAnchor(),m=Md(this.props,!1),g=Md(c,!1),y=MC(MC({},m),{},{fill:"none"},Md(s,!1)),_=d.map((function(e,r){var i=o.getTickLineCoord(e),a=i.line,_=i.tick,v=MC(MC(MC(MC({textAnchor:p,verticalAnchor:f},m),{},{stroke:"none",fill:l},g),_),{},{index:r,payload:e,visibleTicksCount:d.length,tickFormatter:u});return t.createElement(Jd,EC({className:"recharts-cartesian-axis-tick",key:"tick-".concat(e.value,"-").concat(e.coordinate,"-").concat(e.tickCoord)},hd(o.props,e,r)),s&&t.createElement("line",EC({},y,a,{className:kh("recharts-cartesian-axis-tick-line",zh()(s,"className"))})),c&&n.renderTickItem(c,v,"".concat(ed()(u)?u(e.value,r):e.value).concat(h||"")))}));return t.createElement("g",{className:"recharts-cartesian-axis-ticks"},_)}},{key:"render",value:function(){var e=this,n=this.props,r=n.axisLine,i=n.width,o=n.height,a=n.ticksGenerator,s=n.className;if(n.hide)return null;var l=this.props,c=l.ticks,u=PC(l,SC),h=c;return ed()(a)&&(h=c&&c.length>0?a(this.props):a(u)),i<=0||o<=0||!h||!h.length?null:t.createElement(Jd,{className:kh("recharts-cartesian-axis",s),ref:function(t){e.layerReference=t}},r&&this.renderAxisLine(),this.renderTicks(h,this.state.fontSize,this.state.letterSpacing),bE.renderCallByParent(this.props))}}],o=[{key:"renderTickItem",value:function(e,n,r){return t.isValidElement(e)?t.cloneElement(e,n):ed()(e)?e(n):t.createElement(Qy,EC({},n,{className:"recharts-cartesian-axis-tick-value"}),r)}}],i&&kC(r.prototype,i),o&&kC(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,i,o}(t.Component);function zC(e){return zC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zC(e)}function RC(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,HC(r.key),r)}}function FC(e,t,n){return t=VC(t),function(e,t){if(t&&("object"===zC(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,BC()?Reflect.construct(t,n||[],VC(e).constructor):t.apply(e,n))}function BC(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(BC=function(){return!!e})()}function VC(e){return VC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},VC(e)}function UC(e,t){return UC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},UC(e,t)}function GC(e,t,n){return(t=HC(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function HC(e){var t=function(e,t){if("object"!=zC(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=zC(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==zC(t)?t:t+""}function ZC(){return ZC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ZC.apply(this,arguments)}function qC(e){var n=e.xAxisId,r=LM(),i=zM(),o=NM(n);return null==o?null:t.createElement(LC,ZC({},o,{className:kh("recharts-".concat(o.axisType," ").concat(o.axisType),o.className),viewBox:{x:0,y:0,width:r,height:i},ticksGenerator:function(e){return mT(e,!0)}}))}NC(LC,"displayName","CartesianAxis"),NC(LC,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var WC=function(e){function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),FC(this,n,arguments)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&UC(e,t)}(n,e),r=n,(i=[{key:"render",value:function(){return t.createElement(qC,this.props)}}])&&RC(r.prototype,i),o&&RC(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,i,o}(t.Component);function XC(e){return XC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},XC(e)}function YC(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,tj(r.key),r)}}function KC(e,t,n){return t=QC(t),function(e,t){if(t&&("object"===XC(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,JC()?Reflect.construct(t,n||[],QC(e).constructor):t.apply(e,n))}function JC(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(JC=function(){return!!e})()}function QC(e){return QC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},QC(e)}function $C(e,t){return $C=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},$C(e,t)}function ej(e,t,n){return(t=tj(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function tj(e){var t=function(e,t){if("object"!=XC(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=XC(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==XC(t)?t:t+""}function nj(){return nj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},nj.apply(this,arguments)}GC(WC,"displayName","XAxis"),GC(WC,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});var rj=function(e){var n=e.yAxisId,r=LM(),i=zM(),o=DM(n);return null==o?null:t.createElement(LC,nj({},o,{className:kh("recharts-".concat(o.axisType," ").concat(o.axisType),o.className),viewBox:{x:0,y:0,width:r,height:i},ticksGenerator:function(e){return mT(e,!0)}}))},ij=function(e){function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),KC(this,n,arguments)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$C(e,t)}(n,e),r=n,(i=[{key:"render",value:function(){return t.createElement(rj,this.props)}}])&&YC(r.prototype,i),o&&YC(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,i,o}(t.Component);ej(ij,"displayName","YAxis"),ej(ij,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});var oj=Yk({chartName:"LineChart",GraphicalChild:dC,axisComponents:[{axisType:"xAxis",AxisComp:WC},{axisType:"yAxis",AxisComp:ij}],formatAxisMap:iM});const aj=()=>{const{id:e}=function(){let{matches:e}=t.useContext(ie),n=e[e.length-1];return n?n.params:{}}(),[n,r]=(0,t.useState)(null),[i,o]=(0,t.useState)([]),[a,s]=(0,t.useState)(!1),[l,u]=(0,t.useState)(!1),[h,d]=(0,t.useState)(0),[p,f]=(0,t.useState)(!1),[m,g]=(0,t.useState)("12"),[y,_]=(0,t.useState)(null),[v,x]=(0,t.useState)(null),[b,w]=(0,t.useState)(!1),[S,T]=(0,t.useState)("overview"),[E,A]=(0,t.useState)("rent"),[M,P]=(0,t.useState)(!1),[k,C]=(0,t.useState)((null===n||void 0===n?void 0:n.price)||0),[j,I]=(0,t.useState)(8.5),[O,N]=(0,t.useState)(20),D=[{src:null===n||void 0===n?void 0:n.image,alt:null===n||void 0===n?void 0:n.title},{src:null===n||void 0===n?void 0:n.image,alt:"Interior view"},{src:null===n||void 0===n?void 0:n.image,alt:"Kitchen view"},{src:null===n||void 0===n?void 0:n.image,alt:"Bathroom view"}],L=[{month:"Jan 2024",price:6e7,change:"+2.5%"},{month:"Mar 2024",price:705e5,change:"+2.0%"},{month:"May 2024",price:78e6,change:"+1.9%"},{month:"Jul 2024",price:725e5,change:"-0.6%"},{month:"Sep 2024",price:79e6,change:"+1.9%"},{month:"Nov 2024",price:89e6,change:"+1.3%"}],z={essential:[{icon:ph,label:"High-speed WiFi"},{icon:fh,label:"Smart TV"},{icon:mh,label:"Air conditioning"},{icon:gh,label:"Hot water"}],featured:[{icon:yh,label:"Scenic views"},{icon:_h,label:"Fully equipped kitchen"},{icon:Ju,label:"Free parking"},{icon:vh,label:"24/7 security"}]},R=[{id:"overview",label:"Overview",icon:$c},{id:"details",label:"Details & Pricing",icon:xh},{id:"amenities",label:"Amenities",icon:bh},{id:"location",label:"Location",icon:tu},{id:"history",label:"Price History",icon:kt}];(0,t.useEffect)((()=>{const t=Hc.find((t=>t.id===parseInt(e)));if(r(t),t){const e=[];Zc.categories.forEach((n=>{n.items.forEach((r=>{Math.sqrt(Math.pow(t.coordinates[0]-r.location[0],2)+Math.pow(t.coordinates[1]-r.location[1],2))<=.05&&e.push(c(c({},r),{},{type:n.name,icon:F(n.id)}))}))})),o(e.slice(0,5))}}),[e]);const F=e=>{switch(e){case"schools":return Ku;case"hospitals":return Yu;case"shopping":return wh;default:return tu}},B=(e,t,n)=>{const r=parseFloat(e),i=parseFloat(t)/12/100,o=12*parseFloat(n);return r*i*Math.pow(1+i,o)/(Math.pow(1+i,o)-1)};return n?(0,Ot.jsxs)("div",{className:"min-h-screen bg-gray-50 pt-20",children:[(0,Ot.jsxs)("div",{className:"relative h-[70vh] bg-gray-100",children:[l?(0,Ot.jsx)("iframe",{src:"https://cdn.styldod.com/360/beverly-woods/app-files/index.html",width:"100%",height:"100%",frameBorder:"0",allowFullScreen:!0}):(0,Ot.jsx)("img",{src:D[h].src,alt:D[h].alt,className:"w-full h-full object-cover"}),(0,Ot.jsxs)("div",{className:"absolute top-4 right-4 z-10 flex space-x-2",children:[(0,Ot.jsx)("button",{onClick:()=>u(!l),className:"bg-white px-4 py-2 rounded-full shadow-lg text-sm font-medium",children:l?"View Photos":"360\xb0 View"}),(0,Ot.jsx)("button",{className:"bg-white p-2 rounded-full shadow-lg",children:(0,Ot.jsx)(fu,{className:"h-6 w-6 text-gray-600"})}),(0,Ot.jsx)("button",{className:"bg-white p-2 rounded-full shadow-lg",children:(0,Ot.jsx)(Jc,{className:"h-6 w-6 text-gray-600"})})]}),!l&&(0,Ot.jsxs)(Ot.Fragment,{children:[(0,Ot.jsx)("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 flex space-x-2",children:D.map(((e,t)=>(0,Ot.jsx)("button",{className:"w-2 h-2 rounded-full ".concat(h===t?"bg-[#0066CC]":"bg-white"),onClick:()=>d(t)},t)))}),(0,Ot.jsx)("button",{className:"absolute left-4 top-1/2 transform -translate-y-1/2 bg-white p-2 rounded-full shadow-lg",onClick:()=>d((e=>0===e?D.length-1:e-1)),children:(0,Ot.jsx)(Sh,{className:"h-6 w-6 text-gray-600"})}),(0,Ot.jsx)("button",{className:"absolute right-4 top-1/2 transform -translate-y-1/2 bg-white p-2 rounded-full shadow-lg",onClick:()=>d((e=>e===D.length-1?0:e+1)),children:(0,Ot.jsx)(Th,{className:"h-6 w-6 text-gray-600"})})]})]}),(0,Ot.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[(0,Ot.jsxs)("div",{className:"mb-8",children:[(0,Ot.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,Ot.jsxs)("div",{children:[(0,Ot.jsx)("h1",{className:"text-2xl font-bold mb-2",children:n.title}),(0,Ot.jsxs)("p",{className:"text-gray-600 flex items-center gap-2",children:[(0,Ot.jsx)(tu,{className:"h-4 w-4"}),n.location]})]}),(0,Ot.jsxs)("div",{className:"text-right",children:[(0,Ot.jsx)("p",{className:"text-2xl font-bold text-[#1c5bde]",children:n.price}),(0,Ot.jsx)("p",{className:"text-sm text-gray-600",children:"per month"})]})]}),(0,Ot.jsxs)("div",{className:"flex gap-4 py-4 border-y",children:[n.beds&&(0,Ot.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Ot.jsx)(hu,{className:"h-5 w-5 text-gray-600"}),(0,Ot.jsxs)("span",{children:[n.beds," Beds"]})]}),n.baths&&(0,Ot.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Ot.jsx)(du,{className:"h-5 w-5 text-gray-600"}),(0,Ot.jsxs)("span",{children:[n.baths," Baths"]})]}),(0,Ot.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Ot.jsx)(pu,{className:"h-5 w-5 text-gray-600"}),(0,Ot.jsx)("span",{children:n.area})]})]})]}),(0,Ot.jsx)("div",{className:"flex overflow-x-auto hide-scrollbar gap-2 mb-8 pb-2",children:R.map((e=>(0,Ot.jsxs)("button",{onClick:()=>T(e.id),className:"flex items-center gap-2 px-4 py-2 rounded-full whitespace-nowrap transition-colors ".concat(S===e.id?"bg-[#1c5bde] text-white":"bg-gray-50 text-gray-600 hover:bg-gray-100"),children:[(0,Ot.jsx)(e.icon,{className:"h-4 w-4"}),(0,Ot.jsx)("span",{children:e.label})]},e.id)))}),(0,Ot.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,Ot.jsxs)("div",{className:"lg:col-span-2",children:["overview"===S&&(0,Ot.jsxs)("div",{className:"space-y-6",children:[(0,Ot.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,Ot.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[(0,Ot.jsx)("button",{onClick:()=>A("rent"),className:"py-3 px-4 rounded-lg text-sm font-medium transition-colors ".concat("rent"===E?"bg-[#1c5bde] text-white":"bg-gray-50 text-gray-600 hover:bg-gray-100"),children:"Rent Property"}),(0,Ot.jsx)("button",{onClick:()=>A("buy"),className:"py-3 px-4 rounded-lg text-sm font-medium transition-colors ".concat("buy"===E?"bg-[#1c5bde] text-white":"bg-gray-50 text-gray-600 hover:bg-gray-100"),children:"Buy Property"})]}),"rent"===E&&(0,Ot.jsxs)("div",{className:"space-y-4",children:[(0,Ot.jsx)("h2",{className:"text-lg font-semibold",children:"Select Tenure Period"}),(0,Ot.jsx)("div",{className:"grid grid-cols-4 gap-3",children:[{value:"3",label:"3 Months"},{value:"6",label:"6 Months"},{value:"12",label:"1 Year"},{value:"continuous",label:"Continuous"}].map((e=>(0,Ot.jsx)("button",{onClick:()=>g(e.value),className:"py-2 px-4 rounded-lg text-sm font-medium transition-colors ".concat(m===e.value?"bg-[#1c5bde] text-white":"bg-gray-50 text-gray-600 hover:bg-gray-100"),children:e.label},e.value)))})]}),"buy"===E&&(0,Ot.jsxs)("div",{className:"space-y-4",children:[(0,Ot.jsx)("h2",{className:"text-lg font-semibold",children:"Purchase Options"}),(0,Ot.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,Ot.jsxs)("div",{className:"p-4 bg-gray-50 rounded-lg",children:[(0,Ot.jsx)("h3",{className:"font-medium mb-2",children:"Outright Purchase"}),(0,Ot.jsx)("p",{className:"text-gray-600 text-sm mb-3",children:"Full payment with complete ownership transfer"}),(0,Ot.jsx)("p",{className:"font-bold text-[#1c5bde]",children:null===n||void 0===n?void 0:n.price})]}),(0,Ot.jsxs)("div",{className:"p-4 bg-gray-50 rounded-lg",children:[(0,Ot.jsx)("h3",{className:"font-medium mb-2",children:"Mortgage Option"}),(0,Ot.jsx)("p",{className:"text-gray-600 text-sm mb-3",children:"Monthly payments with our banking partners"}),(0,Ot.jsx)("button",{onClick:()=>P(!0),className:"text-[#1c5bde] text-sm font-medium",children:"Calculate EMI \u2192"})]})]})]})]}),(0,Ot.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,Ot.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Property Overview"}),(0,Ot.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,Ot.jsxs)("div",{className:"space-y-4",children:[(0,Ot.jsxs)("div",{children:[(0,Ot.jsx)("h3",{className:"font-medium mb-2",children:"Key Features"}),(0,Ot.jsxs)("ul",{className:"space-y-2 text-gray-600",children:[(0,Ot.jsxs)("li",{className:"flex items-center gap-2",children:[(0,Ot.jsx)(Eh,{className:"h-4 w-4 text-[#1c5bde]"}),"Built in ",null===n||void 0===n?void 0:n.yearBuilt]}),(0,Ot.jsxs)("li",{className:"flex items-center gap-2",children:[(0,Ot.jsx)(Eh,{className:"h-4 w-4 text-[#1c5bde]"}),null===n||void 0===n?void 0:n.furnishing," furnished"]}),(0,Ot.jsxs)("li",{className:"flex items-center gap-2",children:[(0,Ot.jsx)(Eh,{className:"h-4 w-4 text-[#1c5bde]"}),null===n||void 0===n?void 0:n.facing," facing"]}),(0,Ot.jsxs)("li",{className:"flex items-center gap-2",children:[(0,Ot.jsx)(Eh,{className:"h-4 w-4 text-[#1c5bde]"}),"Floor ",null===n||void 0===n?void 0:n.floor," of ",null===n||void 0===n?void 0:n.totalFloors]})]})]}),(0,Ot.jsxs)("div",{children:[(0,Ot.jsx)("h3",{className:"font-medium mb-2",children:"Property Description"}),(0,Ot.jsx)("p",{className:"text-gray-600",children:null===n||void 0===n?void 0:n.description})]})]}),(0,Ot.jsxs)("div",{className:"space-y-4",children:[(0,Ot.jsxs)("div",{children:[(0,Ot.jsx)("h3",{className:"font-medium mb-2",children:"Property Highlights"}),(0,Ot.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,Ot.jsxs)("div",{className:"p-3 bg-gray-50 rounded-lg",children:[(0,Ot.jsx)("p",{className:"text-sm text-gray-600",children:"Property Age"}),(0,Ot.jsxs)("p",{className:"font-medium",children:[(new Date).getFullYear()-(null===n||void 0===n?void 0:n.yearBuilt)," years"]})]}),(0,Ot.jsxs)("div",{className:"p-3 bg-gray-50 rounded-lg",children:[(0,Ot.jsx)("p",{className:"text-sm text-gray-600",children:"Available From"}),(0,Ot.jsx)("p",{className:"font-medium",children:"Immediate"})]}),(0,Ot.jsxs)("div",{className:"p-3 bg-gray-50 rounded-lg",children:[(0,Ot.jsx)("p",{className:"text-sm text-gray-600",children:"Pet Policy"}),(0,Ot.jsx)("p",{className:"font-medium",children:null===n||void 0===n?void 0:n.petPolicy})]}),(0,Ot.jsxs)("div",{className:"p-3 bg-gray-50 rounded-lg",children:[(0,Ot.jsx)("p",{className:"text-sm text-gray-600",children:"Maintenance"}),(0,Ot.jsx)("p",{className:"font-medium",children:null===n||void 0===n?void 0:n.maintenance})]})]})]}),(0,Ot.jsxs)("div",{children:[(0,Ot.jsx)("h3",{className:"font-medium mb-2",children:"Additional Costs"}),(0,Ot.jsxs)("div",{className:"space-y-2 text-gray-600",children:[(0,Ot.jsx)("p",{children:"Security Deposit: 2 months rent"}),(0,Ot.jsxs)("p",{children:["Maintenance: ",null===n||void 0===n?void 0:n.maintenance,"/month"]}),(0,Ot.jsx)("p",{children:"Utilities: Not included"})]})]})]})]})]})]}),"details"===S&&(0,Ot.jsxs)("div",{className:"space-y-6",children:[(0,Ot.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,Ot.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Move-in Details"}),(0,Ot.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,Ot.jsxs)("div",{children:[(0,Ot.jsx)("label",{className:"block text-sm font-medium text-gray-600 mb-2",children:"Move-in Date"}),(0,Ot.jsx)("input",{type:"date",value:y,onChange:e=>_(e.target.value),className:"w-full p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-[#1c5bde]/20"})]}),(0,Ot.jsxs)("div",{children:[(0,Ot.jsx)("label",{className:"block text-sm font-medium text-gray-600 mb-2",children:"Move-out Date"}),(0,Ot.jsx)("input",{type:"date",value:v,onChange:e=>x(e.target.value),className:"w-full p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-[#1c5bde]/20"})]})]})]}),(0,Ot.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,Ot.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Property Details"}),(0,Ot.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,Ot.jsxs)("div",{children:[(0,Ot.jsx)("h3",{className:"font-medium mb-3",children:"Basic Information"}),(0,Ot.jsxs)("div",{className:"space-y-2 text-gray-600",children:[(0,Ot.jsxs)("p",{children:["Property Type: ",n.type]}),(0,Ot.jsxs)("p",{children:["Built Year: ",n.yearBuilt]}),(0,Ot.jsxs)("p",{children:["Floor Level: ",n.floor]}),(0,Ot.jsxs)("p",{children:["Total Floors: ",n.totalFloors]})]})]}),(0,Ot.jsxs)("div",{children:[(0,Ot.jsx)("h3",{className:"font-medium mb-3",children:"Additional Details"}),(0,Ot.jsxs)("div",{className:"space-y-2 text-gray-600",children:[(0,Ot.jsxs)("p",{children:["Furnishing: ",n.furnishing]}),(0,Ot.jsxs)("p",{children:["Facing: ",n.facing]}),(0,Ot.jsxs)("p",{children:["Pet Policy: ",n.petPolicy]}),(0,Ot.jsxs)("p",{children:["Maintenance: ",n.maintenance]})]})]})]})]})]}),"amenities"===S&&(0,Ot.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,Ot.jsx)("h2",{className:"text-lg font-semibold mb-6",children:"What this place offers"}),(0,Ot.jsx)("div",{className:"grid grid-cols-2 gap-6",children:Object.entries(z).map((e=>{let[t,n]=e;return(0,Ot.jsxs)("div",{children:[(0,Ot.jsx)("h3",{className:"font-medium mb-4 capitalize",children:t}),(0,Ot.jsx)("div",{className:"space-y-4",children:n.map(((e,t)=>(0,Ot.jsxs)("div",{className:"flex items-center gap-3",children:[(0,Ot.jsx)(e.icon,{className:"h-5 w-5 text-[#1c5bde]"}),(0,Ot.jsx)("span",{className:"text-gray-600",children:e.label})]},t)))})]},t)}))}),(0,Ot.jsx)("button",{onClick:()=>w(!0),className:"w-full mt-6 py-2 px-4 border border-[#1c5bde] text-[#1c5bde] rounded-lg hover:bg-[#1c5bde]/5 transition-colors",children:"Show all amenities"})]}),"location"===S&&(0,Ot.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,Ot.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Location"}),(0,Ot.jsx)("div",{className:"rounded-lg h-[400px] relative overflow-hidden mb-6",children:(0,Ot.jsx)("img",{src:"https://api.mapbox.com/styles/v1/mapbox/streets-v11/static/pin-s+ff0000(".concat(n.coordinates[0],",").concat(n.coordinates[1],")/").concat(n.coordinates[0],",").concat(n.coordinates[1],",14,0,0/800x400@2x?access_token=").concat("pk.eyJ1IjoibW10dWt1ciIsImEiOiJjbTEyZGk2dmwwbjZyMmtzMXFzb3V0cHRuIn0.pDgNHWd_o6u2NKVFib0EPQ"),alt:"Map showing ".concat(n.location),className:"absolute inset-0 w-full h-full object-cover rounded-lg"})}),(0,Ot.jsx)("div",{className:"space-y-4",children:i.map(((e,t)=>(0,Ot.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,Ot.jsxs)("div",{className:"flex items-center gap-3",children:[(0,Ot.jsx)(e.icon,{className:"h-5 w-5 text-[#1c5bde]"}),(0,Ot.jsxs)("div",{children:[(0,Ot.jsx)("p",{className:"font-medium",children:e.name}),(0,Ot.jsx)("p",{className:"text-sm text-gray-600",children:e.type})]})]}),(0,Ot.jsx)("span",{className:"text-gray-600",children:e.distance})]},t)))})]}),"history"===S&&(0,Ot.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,Ot.jsx)("h2",{className:"text-lg font-semibold mb-6",children:"Price History"}),(0,Ot.jsx)("div",{className:"h-[300px] mb-6",children:(0,Ot.jsx)(zd,{width:"100%",height:"100%",children:(0,Ot.jsxs)(oj,{data:L,children:[(0,Ot.jsx)(WC,{dataKey:"month"}),(0,Ot.jsx)(ij,{}),(0,Ot.jsx)(Fp,{}),(0,Ot.jsx)(dC,{type:"monotone",dataKey:"price",stroke:"#1c5bde",strokeWidth:2})]})})}),(0,Ot.jsx)("div",{className:"space-y-3",children:L.map(((e,t)=>(0,Ot.jsxs)("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg",children:[(0,Ot.jsx)("span",{className:"font-medium",children:e.month}),(0,Ot.jsxs)("div",{className:"text-right",children:[(0,Ot.jsxs)("span",{className:"font-medium",children:["\u20a6",e.price.toLocaleString()]}),(0,Ot.jsx)("span",{className:"ml-2 text-sm ".concat(e.change.startsWith("+")?"text-green-600":"text-red-600"),children:e.change})]})]},t)))})]})]}),(0,Ot.jsx)("div",{className:"lg:col-span-1",children:(0,Ot.jsxs)("div",{className:"sticky top-24 space-y-4",children:[(0,Ot.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,Ot.jsxs)("div",{className:"flex items-center mb-4",children:[(0,Ot.jsx)("div",{className:"h-12 w-12 rounded-full bg-[#1c5bde]/10 flex items-center justify-center mr-4",children:(0,Ot.jsx)(Ah,{className:"h-6 w-6 text-[#1c5bde]"})}),(0,Ot.jsxs)("div",{children:[(0,Ot.jsx)("h3",{className:"font-bold",children:"Muhammad Tukur"}),(0,Ot.jsx)("p",{className:"text-gray-600",children:"Premium Agent"})]})]}),(0,Ot.jsx)("button",{onClick:()=>s(!0),className:"w-full bg-[#1c5bde] text-white py-3 rounded-lg mb-3 hover:bg-[#0c0d8a] transition-colors duration-300",children:"Contact Agent"}),(0,Ot.jsx)("button",{className:"w-full border border-[#1c5bde] text-[#1c5bde] py-3 rounded-lg hover:bg-[#1c5bde]/10 transition-colors duration-300",children:"Schedule Viewing"})]}),(0,Ot.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:(0,Ot.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,Ot.jsxs)("button",{className:"flex items-center gap-2 text-gray-600 hover:text-[#1c5bde]",children:[(0,Ot.jsx)(fu,{className:"h-5 w-5"}),(0,Ot.jsx)("span",{children:"Share Property"})]}),(0,Ot.jsxs)("button",{className:"flex items-center gap-2 text-gray-600 hover:text-[#1c5bde]",children:[(0,Ot.jsx)(Jc,{className:"h-5 w-5"}),(0,Ot.jsx)("span",{children:"Save to Favorites"})]})]})})]})})]})]}),a&&(0,Ot.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,Ot.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[(0,Ot.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Contact Agent"}),(0,Ot.jsxs)("div",{className:"space-y-4",children:[(0,Ot.jsxs)("div",{children:[(0,Ot.jsx)("label",{className:"block text-gray-700 mb-2",children:"Your Name"}),(0,Ot.jsx)("input",{type:"text",className:"w-full p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-[#1c5bde]/20"})]}),(0,Ot.jsxs)("div",{children:[(0,Ot.jsx)("label",{className:"block text-gray-700 mb-2",children:"Your Email"}),(0,Ot.jsx)("input",{type:"email",className:"w-full p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-[#1c5bde]/20"})]}),(0,Ot.jsxs)("div",{children:[(0,Ot.jsx)("label",{className:"block text-gray-700 mb-2",children:"Message"}),(0,Ot.jsx)("textarea",{className:"w-full p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-[#1c5bde]/20",rows:4})]}),(0,Ot.jsxs)("div",{className:"flex space-x-3",children:[(0,Ot.jsx)("button",{className:"flex-1 bg-[#1c5bde] text-white py-2 rounded-lg hover:bg-[#0c0d8a] transition-colors duration-300",children:"Send Message"}),(0,Ot.jsx)("button",{onClick:()=>s(!1),className:"flex-1 border border-[#1c5bde] text-[#1c5bde] py-2 rounded-lg hover:bg-[#1c5bde]/10 transition-colors duration-300",children:"Cancel"})]})]})]})}),b&&(0,Ot.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:(0,Ot.jsxs)("div",{className:"bg-white rounded-xl max-w-2xl w-full max-h-[80vh] overflow-y-auto",children:[(0,Ot.jsxs)("div",{className:"sticky top-0 bg-white p-4 border-b flex justify-between items-center",children:[(0,Ot.jsx)("h3",{className:"text-xl font-semibold",children:"All Amenities"}),(0,Ot.jsx)("button",{onClick:()=>w(!1),className:"p-2 hover:bg-gray-100 rounded-full",children:(0,Ot.jsx)(jt,{className:"h-5 w-5"})})]}),(0,Ot.jsx)("div",{className:"p-6 space-y-8",children:[{title:"Bathroom",items:["Bathtub","Hair dryer","Shampoo"]},{title:"Bedroom",items:["Hangers","Iron","Extra pillows"]},{title:"Entertainment",items:['65" HDTV',"Netflix","Sound system"]},{title:"Heating & Cooling",items:["Central AC","Ceiling fans","Heating"]},{title:"Home Safety",items:["Smoke alarm","Fire extinguisher","First aid kit"]},{title:"Kitchen",items:["Full kitchen","Dishwasher","Coffee maker"]},{title:"Outdoor",items:["Private patio","BBQ grill","Garden"]},{title:"Parking",items:["Free parking","EV charger","Garage"]},{title:"Services",items:["Self check-in","Long term stays","Cleaning"]}].map((e=>(0,Ot.jsxs)("div",{children:[(0,Ot.jsx)("h4",{className:"font-semibold mb-4",children:e.title}),(0,Ot.jsx)("div",{className:"grid grid-cols-2 gap-4",children:e.items.map(((e,t)=>(0,Ot.jsxs)("div",{className:"flex items-center gap-3",children:[(0,Ot.jsx)(Eh,{className:"h-5 w-5 text-[#1c5bde]"}),(0,Ot.jsx)("span",{className:"text-gray-600",children:e})]},t)))})]},e.title)))})]})}),M&&(0,Ot.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:(0,Ot.jsxs)("div",{className:"bg-white rounded-xl max-w-lg w-full max-h-[90vh] overflow-y-auto",children:[(0,Ot.jsxs)("div",{className:"sticky top-0 bg-white p-4 border-b flex justify-between items-center",children:[(0,Ot.jsx)("h3",{className:"text-xl font-semibold",children:"Mortgage Calculator"}),(0,Ot.jsx)("button",{onClick:()=>P(!1),className:"p-2 hover:bg-gray-100 rounded-full",children:(0,Ot.jsx)(jt,{className:"h-5 w-5"})})]}),(0,Ot.jsxs)("div",{className:"p-6 space-y-6",children:[(0,Ot.jsxs)("div",{children:[(0,Ot.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Loan Amount (\u20a6)"}),(0,Ot.jsx)("input",{type:"number",value:k,onChange:e=>C(e.target.value),className:"w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-[#1c5bde]/20"}),(0,Ot.jsxs)("div",{className:"mt-2 flex justify-between text-sm text-gray-600",children:[(0,Ot.jsx)("span",{children:"Min: \u20a610M"}),(0,Ot.jsx)("span",{children:"Max: \u20a6500M"})]})]}),(0,Ot.jsxs)("div",{children:[(0,Ot.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Interest Rate (%)"}),(0,Ot.jsx)("input",{type:"number",value:j,onChange:e=>I(e.target.value),step:"0.1",className:"w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-[#1c5bde]/20"}),(0,Ot.jsxs)("div",{className:"mt-2 flex justify-between text-sm text-gray-600",children:[(0,Ot.jsx)("span",{children:"Current Rate: 8.5%"}),(0,Ot.jsx)("span",{children:"Max: 15%"})]})]}),(0,Ot.jsxs)("div",{children:[(0,Ot.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Loan Term (Years)"}),(0,Ot.jsx)("select",{value:O,onChange:e=>N(e.target.value),className:"w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-[#1c5bde]/20",children:[5,10,15,20,25,30].map((e=>(0,Ot.jsxs)("option",{value:e,children:[e," years"]},e)))})]}),(0,Ot.jsxs)("div",{className:"bg-gray-50 rounded-lg p-6",children:[(0,Ot.jsx)("h4",{className:"font-medium mb-4",children:"Monthly Payment Breakdown"}),(0,Ot.jsxs)("div",{className:"space-y-3",children:[(0,Ot.jsxs)("div",{className:"flex justify-between",children:[(0,Ot.jsx)("span",{className:"text-gray-600",children:"Monthly EMI"}),(0,Ot.jsxs)("span",{className:"font-semibold",children:["\u20a6",Math.round(B(k,j,O)).toLocaleString()]})]}),(0,Ot.jsxs)("div",{className:"flex justify-between",children:[(0,Ot.jsx)("span",{className:"text-gray-600",children:"Total Interest"}),(0,Ot.jsxs)("span",{className:"font-semibold text-[#1c5bde]",children:["\u20a6",Math.round(B(k,j,O)*O*12-k).toLocaleString()]})]}),(0,Ot.jsxs)("div",{className:"flex justify-between",children:[(0,Ot.jsx)("span",{className:"text-gray-600",children:"Total Amount"}),(0,Ot.jsxs)("span",{className:"font-semibold",children:["\u20a6",Math.round(B(k,j,O)*O*12).toLocaleString()]})]})]})]}),(0,Ot.jsxs)("div",{className:"flex gap-4",children:[(0,Ot.jsx)("button",{onClick:()=>P(!1),className:"flex-1 py-3 px-4 border rounded-lg hover:bg-gray-50",children:"Close"}),(0,Ot.jsx)("button",{onClick:()=>{},className:"flex-1 py-3 px-4 bg-[#1c5bde] text-white rounded-lg hover:bg-[#0c0d8a]",children:"Apply for Loan"})]})]})]})})]}):(0,Ot.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,Ot.jsx)("p",{children:"Loading..."})})},sj=Et("Store",[["path",{d:"m2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7",key:"ztvudi"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["path",{d:"M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4",key:"2ebpfo"}],["path",{d:"M2 7h20",key:"1fcdvo"}],["path",{d:"M22 7v3a2 2 0 0 1-2 2a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 16 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 12 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 8 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 4 12a2 2 0 0 1-2-2V7",key:"6c3vgh"}]]),lj=Et("Warehouse",[["path",{d:"M22 8.35V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8.35A2 2 0 0 1 3.26 6.5l8-3.2a2 2 0 0 1 1.48 0l8 3.2A2 2 0 0 1 22 8.35Z",key:"gksnxg"}],["path",{d:"M6 18h12",key:"9pbo8z"}],["path",{d:"M6 14h12",key:"4cwo0f"}],["rect",{width:"12",height:"12",x:"6",y:"10",key:"apd30q"}]]),cj=Et("TreePine",[["path",{d:"m17 14 3 3.3a1 1 0 0 1-.7 1.7H4.7a1 1 0 0 1-.7-1.7L7 14h-.3a1 1 0 0 1-.7-1.7L9 9h-.2A1 1 0 0 1 8 7.3L12 3l4 4.3a1 1 0 0 1-.8 1.7H15l3 3.3a1 1 0 0 1-.7 1.7H17Z",key:"cpyugq"}],["path",{d:"M12 22v-3",key:"kmzjlo"}]]),uj=Et("SlidersHorizontal",[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]]),hj=Et("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),dj=Et("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]),pj=Et("Crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]),fj=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class mj{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[t,n]=new Uint8Array(e,0,2);if(219!==t)throw new Error("Data does not appear to be in a KDBush format.");const r=n>>4;if(1!==r)throw new Error("Got v".concat(r," data when expected v").concat(1,"."));const i=fj[15&n];if(!i)throw new Error("Unrecognized array type.");const[o]=new Uint16Array(e,2,1),[a]=new Uint32Array(e,4,1);return new mj(a,o,i,e)}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:64,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Float64Array,r=arguments.length>3?arguments[3]:void 0;if(isNaN(e)||e<0)throw new Error("Unpexpected numItems value: ".concat(e,"."));this.numItems=+e,this.nodeSize=Math.min(Math.max(+t,2),65535),this.ArrayType=n,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const i=fj.indexOf(this.ArrayType),o=2*e*this.ArrayType.BYTES_PER_ELEMENT,a=e*this.IndexArrayType.BYTES_PER_ELEMENT,s=(8-a%8)%8;if(i<0)throw new Error("Unexpected typed array class: ".concat(n,"."));r&&r instanceof ArrayBuffer?(this.data=r,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+a+s,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+o+a+s),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+a+s,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+i]),new Uint16Array(this.data,2,1)[0]=t,new Uint32Array(this.data,4,1)[0]=e)}add(e,t){const n=this._pos>>1;return this.ids[n]=n,this.coords[this._pos++]=e,this.coords[this._pos++]=t,n}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error("Added ".concat(e," items when expected ").concat(this.numItems,"."));return gj(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,t,n,r){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:i,coords:o,nodeSize:a}=this,s=[0,i.length-1,0],l=[];for(;s.length;){const c=s.pop()||0,u=s.pop()||0,h=s.pop()||0;if(u-h<=a){for(let a=h;a<=u;a++){const s=o[2*a],c=o[2*a+1];s>=e&&s<=n&&c>=t&&c<=r&&l.push(i[a])}continue}const d=h+u>>1,p=o[2*d],f=o[2*d+1];p>=e&&p<=n&&f>=t&&f<=r&&l.push(i[d]),(0===c?e<=p:t<=f)&&(s.push(h),s.push(d-1),s.push(1-c)),(0===c?n>=p:r>=f)&&(s.push(d+1),s.push(u),s.push(1-c))}return l}within(e,t,n){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:r,coords:i,nodeSize:o}=this,a=[0,r.length-1,0],s=[],l=n*n;for(;a.length;){const c=a.pop()||0,u=a.pop()||0,h=a.pop()||0;if(u-h<=o){for(let n=h;n<=u;n++)xj(i[2*n],i[2*n+1],e,t)<=l&&s.push(r[n]);continue}const d=h+u>>1,p=i[2*d],f=i[2*d+1];xj(p,f,e,t)<=l&&s.push(r[d]),(0===c?e-n<=p:t-n<=f)&&(a.push(h),a.push(d-1),a.push(1-c)),(0===c?e+n>=p:t+n>=f)&&(a.push(d+1),a.push(u),a.push(1-c))}return s}}function gj(e,t,n,r,i,o){if(i-r<=n)return;const a=r+i>>1;yj(e,t,a,r,i,o),gj(e,t,n,r,a-1,1-o),gj(e,t,n,a+1,i,1-o)}function yj(e,t,n,r,i,o){for(;i>r;){if(i-r>600){const a=i-r+1,s=n-r+1,l=Math.log(a),c=.5*Math.exp(2*l/3),u=.5*Math.sqrt(l*c*(a-c)/a)*(s-a/2<0?-1:1);yj(e,t,n,Math.max(r,Math.floor(n-s*c/a+u)),Math.min(i,Math.floor(n+(a-s)*c/a+u)),o)}const a=t[2*n+o];let s=r,l=i;for(_j(e,t,r,n),t[2*i+o]>a&&_j(e,t,r,i);s<l;){for(_j(e,t,s,l),s++,l--;t[2*s+o]<a;)s++;for(;t[2*l+o]>a;)l--}t[2*r+o]===a?_j(e,t,r,l):(l++,_j(e,t,l,i)),l<=n&&(r=l+1),n<=l&&(i=l-1)}}function _j(e,t,n,r){vj(e,n,r),vj(t,2*n,2*r),vj(t,2*n+1,2*r+1)}function vj(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function xj(e,t,n,r){const i=e-n,o=t-r;return i*i+o*o}const bj={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:e=>e},wj=Math.fround||(Sj=new Float32Array(1),e=>(Sj[0]=+e,Sj[0]));var Sj;class Tj{constructor(e){this.options=Object.assign(Object.create(bj),e),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(e){const{log:t,minZoom:n,maxZoom:r}=this.options;t&&console.time("total time");const i="prepare ".concat(e.length," points");t&&console.time(i),this.points=e;const o=[];for(let s=0;s<e.length;s++){const t=e[s];if(!t.geometry)continue;const[n,r]=t.geometry.coordinates,i=wj(Mj(n)),a=wj(Pj(r));o.push(i,a,1/0,s,-1,1),this.options.reduce&&o.push(0)}let a=this.trees[r+1]=this._createTree(o);t&&console.timeEnd(i);for(let s=r;s>=n;s--){const e=+Date.now();a=this.trees[s]=this._createTree(this._cluster(a,s)),t&&console.log("z%d: %d clusters in %dms",s,a.numItems,+Date.now()-e)}return t&&console.timeEnd("total time"),this}getClusters(e,t){let n=((e[0]+180)%360+360)%360-180;const r=Math.max(-90,Math.min(90,e[1]));let i=180===e[2]?180:((e[2]+180)%360+360)%360-180;const o=Math.max(-90,Math.min(90,e[3]));if(e[2]-e[0]>=360)n=-180,i=180;else if(n>i){const e=this.getClusters([n,r,180,o],t),a=this.getClusters([-180,r,i,o],t);return e.concat(a)}const a=this.trees[this._limitZoom(t)],s=a.range(Mj(n),Pj(o),Mj(i),Pj(r)),l=a.data,c=[];for(const u of s){const e=this.stride*u;c.push(l[e+5]>1?Ej(l,e,this.clusterProps):this.points[l[e+3]])}return c}getChildren(e){const t=this._getOriginId(e),n=this._getOriginZoom(e),r="No cluster with the specified id.",i=this.trees[n];if(!i)throw new Error(r);const o=i.data;if(t*this.stride>=o.length)throw new Error(r);const a=this.options.radius/(this.options.extent*Math.pow(2,n-1)),s=o[t*this.stride],l=o[t*this.stride+1],c=i.within(s,l,a),u=[];for(const h of c){const t=h*this.stride;o[t+4]===e&&u.push(o[t+5]>1?Ej(o,t,this.clusterProps):this.points[o[t+3]])}if(0===u.length)throw new Error(r);return u}getLeaves(e,t,n){t=t||10,n=n||0;const r=[];return this._appendLeaves(r,e,t,n,0),r}getTile(e,t,n){const r=this.trees[this._limitZoom(e)],i=Math.pow(2,e),{extent:o,radius:a}=this.options,s=a/o,l=(n-s)/i,c=(n+1+s)/i,u={features:[]};return this._addTileFeatures(r.range((t-s)/i,l,(t+1+s)/i,c),r.data,t,n,i,u),0===t&&this._addTileFeatures(r.range(1-s/i,l,1,c),r.data,i,n,i,u),t===i-1&&this._addTileFeatures(r.range(0,l,s/i,c),r.data,-1,n,i,u),u.features.length?u:null}getClusterExpansionZoom(e){let t=this._getOriginZoom(e)-1;for(;t<=this.options.maxZoom;){const n=this.getChildren(e);if(t++,1!==n.length)break;e=n[0].properties.cluster_id}return t}_appendLeaves(e,t,n,r,i){const o=this.getChildren(t);for(const a of o){const t=a.properties;if(t&&t.cluster?i+t.point_count<=r?i+=t.point_count:i=this._appendLeaves(e,t.cluster_id,n,r,i):i<r?i++:e.push(a),e.length===n)break}return i}_createTree(e){const t=new mj(e.length/this.stride|0,this.options.nodeSize,Float32Array);for(let n=0;n<e.length;n+=this.stride)t.add(e[n],e[n+1]);return t.finish(),t.data=e,t}_addTileFeatures(e,t,n,r,i,o){for(const a of e){const e=a*this.stride,s=t[e+5]>1;let l,c,u;if(s)l=Aj(t,e,this.clusterProps),c=t[e],u=t[e+1];else{const n=this.points[t[e+3]];l=n.properties;const[r,i]=n.geometry.coordinates;c=Mj(r),u=Pj(i)}const h={type:1,geometry:[[Math.round(this.options.extent*(c*i-n)),Math.round(this.options.extent*(u*i-r))]],tags:l};let d;d=s||this.options.generateId?t[e+3]:this.points[t[e+3]].id,void 0!==d&&(h.id=d),o.features.push(h)}}_limitZoom(e){return Math.max(this.options.minZoom,Math.min(Math.floor(+e),this.options.maxZoom+1))}_cluster(e,t){const{radius:n,extent:r,reduce:i,minPoints:o}=this.options,a=n/(r*Math.pow(2,t)),s=e.data,l=[],c=this.stride;for(let u=0;u<s.length;u+=c){if(s[u+2]<=t)continue;s[u+2]=t;const n=s[u],r=s[u+1],h=e.within(s[u],s[u+1],a),d=s[u+5];let p=d;for(const e of h){const n=e*c;s[n+2]>t&&(p+=s[n+5])}if(p>d&&p>=o){let e,o=n*d,a=r*d,f=-1;const m=(u/c<<5)+(t+1)+this.points.length;for(const n of h){const r=n*c;if(s[r+2]<=t)continue;s[r+2]=t;const l=s[r+5];o+=s[r]*l,a+=s[r+1]*l,s[r+4]=m,i&&(e||(e=this._map(s,u,!0),f=this.clusterProps.length,this.clusterProps.push(e)),i(e,this._map(s,r)))}s[u+4]=m,l.push(o/p,a/p,1/0,m,-1,p),i&&l.push(f)}else{for(let e=0;e<c;e++)l.push(s[u+e]);if(p>1)for(const e of h){const n=e*c;if(!(s[n+2]<=t)){s[n+2]=t;for(let e=0;e<c;e++)l.push(s[n+e])}}}}return l}_getOriginId(e){return e-this.points.length>>5}_getOriginZoom(e){return(e-this.points.length)%32}_map(e,t,n){if(e[t+5]>1){const r=this.clusterProps[e[t+6]];return n?Object.assign({},r):r}const r=this.points[e[t+3]].properties,i=this.options.map(r);return n&&i===r?Object.assign({},i):i}}function Ej(e,t,n){return{type:"Feature",id:e[t+3],properties:Aj(e,t,n),geometry:{type:"Point",coordinates:[(r=e[t],360*(r-.5)),kj(e[t+1])]}};var r}function Aj(e,t,n){const r=e[t+5],i=r>=1e4?"".concat(Math.round(r/1e3),"k"):r>=1e3?"".concat(Math.round(r/100)/10,"k"):r,o=e[t+6],a=-1===o?{}:Object.assign({},n[o]);return Object.assign(a,{cluster:!0,cluster_id:e[t+3],point_count:r,point_count_abbreviated:i})}function Mj(e){return e/360+.5}function Pj(e){const t=Math.sin(e*Math.PI/180),n=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return n<0?0:n>1?1:n}function kj(e){const t=(180-360*e)*Math.PI/180;return 360*Math.atan(Math.exp(t))/Math.PI-90}const Cj=[{id:"all",label:"All",icon:lu},{id:"homes",label:"Homes",icon:$c},{id:"apts",label:"Apts",icon:nu},{id:"office",label:"Office",icon:dj},{id:"luxury",label:"Luxury",icon:pj},{id:"industrial",label:"Industrial",icon:ou},{id:"hotels",label:"Hotels",icon:hu},{id:"land",label:"Land",icon:uu}],jj=[{id:"any",label:"Any Price"},{id:"0-50m",label:"\u20a60 - \u20a650M"},{id:"50m-100m",label:"\u20a650M - \u20a6100M"},{id:"100m-200m",label:"\u20a6100M - \u20a6200M"},{id:"200m+",label:"\u20a6200M+"}],Ij=[{id:"any",label:"Any"},{id:"1",label:"1"},{id:"2",label:"2"},{id:"3",label:"3"},{id:"4",label:"4+"}],Oj=e=>{let{properties:n=[],onClose:r,filters:i}=e;const o=(0,t.useRef)(null),a=(0,t.useRef)(null),[s,l]=(0,t.useState)(null),[u,h]=(0,t.useState)("streets-v12"),[d,p]=(0,t.useState)(!1),[f,m]=(0,t.useState)(null),[g,y]=(0,t.useState)(!1),[_,v]=(0,t.useState)("split"),[x,b]=(0,t.useState)("all"),[w,S]=(0,t.useState)(!1),[T,E]=(0,t.useState)("any"),[A,M]=(0,t.useState)("any"),[P,k]=(0,t.useState)([]),C=ue(),[j,I]=(0,t.useState)(null);(0,t.useEffect)((()=>{if(!o.current||null===n||void 0===n||!n.length)return;Au().accessToken="pk.eyJ1IjoibW10dWt1ciIsImEiOiJjbTEyZGk2dmwwbjZyMmtzMXFzb3V0cHRuIn0.pDgNHWd_o6u2NKVFib0EPQ",a.current=new(Au().Map)({container:o.current,style:"mapbox://styles/mapbox/light-v11",center:[7.491,9.082],zoom:12,pitch:45,bearing:-17.6});const e=new Tj({radius:40,maxZoom:16,minPoints:2}),t=n.map((e=>({type:"Feature",properties:c(c({},e),{},{priceNum:parseInt(e.price.replace(/[\u20a6,]/g,""))/1e6}),geometry:{type:"Point",coordinates:e.coordinates}})));return e.load(t),I(e),a.current.on("load",(()=>{const t=()=>{const t=t=>{const n=(t=>{if(!e||!t)return 0;if(t.cluster_id)try{const n=e.getLeaves(t.cluster_id).map((e=>e.properties.growth)).filter(Boolean);return n.length?n.reduce(((e,t)=>e+t),0)/n.length:0}catch(n){return console.error("Error calculating cluster trend:",n),0}return t.growth||0})(t);return n>5?"\ud83d\udd25":n>0?"\ud83d\udcc8":""},n=a.current.getBounds(),r=Math.floor(a.current.getZoom()),i=e.getClusters([n.getWest(),n.getSouth(),n.getEast(),n.getNorth()],r);document.querySelectorAll(".marker-container").forEach((e=>e.remove())),i.forEach((n=>{const r=document.createElement("div");if(r.className="marker-container",n.properties.cluster){const o=n.properties.point_count,s=e.getLeaves(n.properties.cluster_id),l=s.reduce(((e,t)=>e+parseInt(t.properties.price.replace(/[\u20a6,]/g,""))/1e6),0)/o;r.innerHTML='\n              <div class="cluster-marker-'.concat((i=o,i<5?"small":i<10?"medium":"large"),'">\n                <span class="cluster-count">').concat(o,'</span>\n                <span class="cluster-price">Avg: \u20a6').concat(l.toFixed(1),"M</span>\n                ").concat(t(n.properties),"\n              </div>\n            "),new(Au().Marker)(r).setLngLat(n.geometry.coordinates).setPopup(new(Au().Popup)({offset:25}).setHTML('\n                    <div class="p-4">\n                      <h3 class="font-bold text-lg mb-2">'.concat(o,' Properties</h3>\n                      <div class="space-y-2">\n                        ').concat(s.slice(0,3).map((e=>'\n                          <div class="cursor-pointer hover:bg-gray-50 p-2 rounded" \n                               onclick="window.location.href=\'/properties/'.concat(e.properties.id,'\'">\n                            <div class="font-medium">').concat(e.properties.title,'</div>\n                            <div class="text-sm text-gray-600">\u20a6').concat(e.properties.priceNum,"M</div>\n                          </div>\n                        "))).join(""),"\n                        ").concat(s.length>3?'\n                          <div class="text-sm text-gray-500 pt-2 border-t">\n                            +'.concat(s.length-3," more properties\n                          </div>\n                        "):"","\n                      </div>\n                    </div>\n                  "))).addTo(a.current)}else r.innerHTML='\n              <div class="price-tag-container">\n                <div class="price-tag '.concat(O(n.properties),'">\n                  <div class="price-main">\n                    \u20a6').concat(n.properties.priceNum,'M\n                  </div>\n                  <div class="price-details">\n                    ').concat(n.properties.beds?"".concat(n.properties.beds,"bed"):""," \n                    ").concat(n.properties.area?"\xb7 ".concat(n.properties.area):"","\n                    ").concat("luxury"===n.properties.type?"\u2b50":"","\n                  </div>\n                  ").concat(n.properties.investment_score?'\n                    <div class="investment-badge '.concat(N(n.properties.investment_score),'">\n                      ').concat(D(n.properties.investment_score),"\n                    </div>\n                  "):"","\n                </div>\n              </div>\n            "),new(Au().Marker)(r).setLngLat(n.geometry.coordinates).setPopup(new(Au().Popup)({offset:25}).setHTML('\n                    <div class="p-3 cursor-pointer" onclick="window.location.href=\'/properties/'.concat(n.properties.id,'\'">\n                      <img src="').concat(n.properties.image,'" class="w-full h-32 object-cover rounded-lg mb-2" />\n                      <div class="flex items-center justify-between mb-1">\n                        <h3 class="font-bold text-gray-900">').concat(n.properties.title,"</h3>\n                        ").concat("luxury"===n.properties.type?'<span class="verified-badge">\u2713 Premium</span>':"",'\n                      </div>\n                      <p class="text-sm text-gray-600 mb-2">').concat(n.properties.location,"</p>\n                      ").concat(n.properties.description?'\n                        <p class="text-sm text-gray-600 mt-2">'.concat(n.properties.description,"</p>\n                      "):"","\n                      ").concat(n.properties.growth?'\n                        <div class="mt-2 flex items-center gap-1 text-green-600 text-sm">\n                          <span>\ud83d\udcc8</span> +'.concat(n.properties.growth,"% growth/year\n                        </div>\n                      "):"","\n                    </div>\n                  "))).addTo(a.current);var i}))};a.current.on("moveend",t),t()})),a.current.on("load",(()=>{a.current.addLayer({id:"3d-buildings",source:"composite","source-layer":"building",filter:["==","extrude","true"],type:"fill-extrusion",minzoom:14,paint:{"fill-extrusion-color":"#aaa","fill-extrusion-height":["get","height"],"fill-extrusion-base":["get","min_height"],"fill-extrusion-opacity":.6}}),n.forEach((e=>{const t=document.createElement("div");t.className="property-marker";const n=parseInt(e.price.replace(/[\u20a6,]/g,""))/1e6;var r;t.innerHTML='\n          <div class="price-tag-container">\n            <div class="price-tag">\n              <div class="price-main">\n                \u20a6'.concat(n,'M\n              </div>\n              <div class="price-details">\n                ').concat(e.beds?"".concat(e.beds,"bed"):""," \n                ").concat(e.area?"\xb7 ".concat(e.area):"","\n                ").concat("luxury"===e.type?"\u2b50":"","\n              </div>\n              ").concat(e.investment_score?'\n                <div class="investment-badge '.concat((r=e.investment_score,r>=8?"hot-investment":r>=6?"good-investment":"normal-investment"),'">\n                  ').concat(function(e){return e>=8?"\ud83d\udd25 Hot Area":e>=6?"\ud83d\udcc8 Growing":"\ud83d\udca1 Potential"}(e.investment_score),"\n                </div>\n              "):"","\n            </div>\n          </div>\n        ");const i=new(Au().Popup)({offset:25}).setHTML('\n            <div class="p-3 cursor-pointer property-popup" data-property-id="'.concat(e.id,'">\n              <img src="').concat(e.image,'" class="w-full h-32 object-cover rounded-lg mb-2" />\n              <div class="flex items-center justify-between mb-1">\n                <h3 class="font-bold text-gray-900">').concat(e.title,"</h3>\n                ").concat(e.verified?'<span class="verified-badge">\u2713 Verified</span>':"",'\n              </div>\n              <p class="text-sm text-gray-600 mb-2">').concat(e.location,'</p>\n              <div class="flex items-center justify-between">\n                <span class="text-xl font-bold">').concat(e.price,'</span>\n                <div class="flex items-center gap-2">\n                  ').concat(e.growth?'<span class="text-green-600 text-sm">+'.concat(e.growth,"% /yr</span>"):"",'\n                </div>\n              </div>\n              <div class="flex items-center gap-4 mt-2 text-sm text-gray-600">\n                ').concat(e.beds?'\n                  <div class="flex items-center gap-1">\n                    <BedDouble className="h-4 w-4" />\n                    '.concat(e.beds," Beds\n                  </div>\n                "):"","\n                ").concat(e.baths?'\n                  <div class="flex items-center gap-1">\n                    <Bath className="h-4 w-4" />\n                    '.concat(e.baths," Baths\n                  </div>\n                "):"","\n                ").concat(e.area?'\n                  <div class="flex items-center gap-1">\n                    <Square className="h-4 w-4" />\n                    '.concat(e.area,"\n                  </div>\n                "):"","\n              </div>\n            </div>\n          "));i.on("open",(()=>{const t=document.querySelector(".property-popup");t&&t.addEventListener("click",(()=>{C("/properties/".concat(e.id))}))})),new(Au().Marker)(t).setLngLat(e.coordinates).setPopup(i).addTo(a.current)}))})),a.current.addControl(new(Au().NavigationControl)),()=>a.current.remove()}),[n,C]);const O=e=>e.investment_score>=8?"hot-property":e.investment_score>=6?"good-property":"normal-property",N=e=>e>=8?"hot-investment":e>=6?"good-investment":"normal-investment",D=e=>e>=8?"\ud83d\udd25 Hot Area":e>=6?"\ud83d\udcc8 Growing":"\ud83d\udca1 Potential";return(0,Ot.jsxs)("div",{className:"fixed inset-0 bg-white z-40",children:[(0,Ot.jsx)("div",{className:"bg-white shadow-sm sticky top-[72px] z-10 border-b",children:(0,Ot.jsxs)("div",{className:"container mx-auto px-4",children:[(0,Ot.jsxs)("div",{className:"flex items-center gap-3 py-2",children:[(0,Ot.jsxs)("div",{className:"flex-1 relative",children:[(0,Ot.jsx)("input",{type:"text",placeholder:"Search properties...",className:"w-full pl-9 pr-4 py-2 text-sm border border-gray-200 rounded-full focus:outline-none focus:ring-2 focus:ring-[#1c5bde]/20 focus:border-[#1c5bde]"}),(0,Ot.jsx)(Ct,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 h-4 w-4"})]}),(0,Ot.jsxs)(zc.button,{whileTap:{scale:.95},onClick:()=>S(!0),className:"bg-[#1c5bde] text-white px-4 py-2 text-sm rounded-full flex items-center gap-1.5 hover:bg-[#0c0d8a] transition-colors",children:[(0,Ot.jsx)(uj,{className:"h-4 w-4"}),"Filters"]})]}),(0,Ot.jsx)("div",{className:"py-1.5 -mx-4 px-4 overflow-x-auto scrollbar-hide",children:(0,Ot.jsx)("div",{className:"flex space-x-3 min-w-max",children:Cj.map((e=>(0,Ot.jsxs)(zc.button,{whileHover:{y:-1},whileTap:{scale:.95},onClick:()=>b(e.id),className:"flex items-center gap-1.5 px-3 py-1.5 rounded-full whitespace-nowrap transition-all text-sm ".concat(x===e.id?"bg-[#1c5bde] text-white":"bg-gray-50 text-gray-600 hover:bg-gray-100"),children:[(0,Ot.jsx)(e.icon,{className:"h-4 w-4"}),(0,Ot.jsx)("span",{className:"font-medium",children:e.label})]},e.id)))})})]})}),(0,Ot.jsx)("div",{className:"h-[calc(100vh-72px)] mt-[72px]",children:(0,Ot.jsx)("div",{ref:o,className:"h-full"})}),(0,Ot.jsxs)("button",{onClick:r,className:"fixed bottom-6 left-1/2 -translate-x-1/2 z-40 bg-black text-white  px-8 py-3 rounded-full text-sm font-medium flex items-center gap-2  hover:bg-gray-900 transition-colors shadow-lg",children:[(0,Ot.jsx)(Sh,{className:"h-4 w-4"}),"Back to List"]}),(0,Ot.jsx)(Yt,{children:w&&(0,Ot.jsx)(zc.div,{initial:{opacity:0,x:"100%"},animate:{opacity:1,x:0},exit:{opacity:0,x:"100%"},className:"fixed inset-y-0 right-0 w-full max-w-md bg-white shadow-xl z-50",children:(0,Ot.jsxs)("div",{className:"h-full flex flex-col",children:[(0,Ot.jsxs)("div",{className:"p-4 border-b flex items-center justify-between",children:[(0,Ot.jsx)("h2",{className:"text-lg font-semibold",children:"Filters"}),(0,Ot.jsx)("button",{onClick:()=>S(!1),className:"p-2 hover:bg-gray-100 rounded-full",children:(0,Ot.jsx)(jt,{className:"h-5 w-5"})})]}),(0,Ot.jsxs)("div",{className:"flex-1 overflow-y-auto p-6 space-y-8",children:[(0,Ot.jsxs)("div",{className:"space-y-4",children:[(0,Ot.jsx)("h3",{className:"font-medium text-gray-900",children:"Price Range"}),(0,Ot.jsx)("div",{className:"grid grid-cols-2 gap-3",children:jj.map((e=>(0,Ot.jsx)("button",{onClick:()=>E(e.id),className:"px-4 py-2 rounded-lg border text-sm\n                          ".concat(T===e.id?"border-[#1c5bde] bg-[#1c5bde]/5 text-[#1c5bde]":"border-gray-200 hover:border-gray-300"),children:e.label},e.id)))})]}),(0,Ot.jsxs)("div",{className:"space-y-4",children:[(0,Ot.jsx)("h3",{className:"font-medium text-gray-900",children:"Bedrooms"}),(0,Ot.jsx)("div",{className:"flex flex-wrap gap-3",children:Ij.map((e=>(0,Ot.jsx)("button",{onClick:()=>M(e.id),className:"px-4 py-2 rounded-lg border text-sm\n                          ".concat(A===e.id?"border-[#1c5bde] bg-[#1c5bde]/5 text-[#1c5bde]":"border-gray-200 hover:border-gray-300"),children:e.label},e.id)))})]}),(0,Ot.jsxs)("div",{className:"space-y-4",children:[(0,Ot.jsx)("h3",{className:"font-medium text-gray-900",children:"Amenities"}),(0,Ot.jsx)("div",{className:"space-y-3",children:["Swimming Pool","Gym","Security","Parking","Garden"].map((e=>(0,Ot.jsxs)("label",{className:"flex items-center gap-3",children:[(0,Ot.jsx)("input",{type:"checkbox",checked:P.includes(e),onChange:t=>{t.target.checked?k([...P,e]):k(P.filter((t=>t!==e)))},className:"w-5 h-5 rounded border-gray-300 text-[#1c5bde] focus:ring-[#1c5bde]"}),(0,Ot.jsx)("span",{className:"text-gray-700",children:e})]},e)))})]})]}),(0,Ot.jsx)("div",{className:"p-4 border-t",children:(0,Ot.jsx)("button",{onClick:()=>S(!1),className:"w-full bg-[#1c5bde] text-white py-3 rounded-lg hover:bg-[#0c0d8a] transition-colors",children:"Apply Filters"})})]})})})]})},Nj=()=>{se();const e=ue(),[n,r]=(0,t.useState)({propertyType:"",priceRange:"",location:"",bedrooms:""}),[i,o]=(0,t.useState)(!1),[a,s]=(0,t.useState)(null),[l,c]=(0,t.useState)(!1),[u,h]=(0,t.useState)("all"),[d,p]=(0,t.useState)(1),[f,m]=(0,t.useState)(!1),g=[{id:"all",label:"All",icon:$c},{id:"residential",label:"Homes",icon:nu},{id:"apartments",label:"Apts",icon:lu},{id:"commercial",label:"Office",icon:sj},{id:"luxury",label:"Luxury",icon:iu},{id:"industrial",label:"Industrial",icon:lj},{id:"hotels",label:"Hotels",icon:au},{id:"land",label:"Land",icon:cj}],y=()=>{o(!1),s(null),document.body.style.overflow="unset"},_=t=>{y(),e("/properties/".concat(t))},v=9*d,x=v-9,b=Hc.slice(x,v),w=Math.ceil(Hc.length/9);return(0,Ot.jsxs)("div",{className:"min-h-screen bg-[#f8fafc] pt-20",children:[(0,Ot.jsx)("div",{className:"bg-white shadow-sm sticky top-20 z-10 border-b border-[#1c5bde]/10",children:(0,Ot.jsxs)("div",{className:"container mx-auto px-4",children:[(0,Ot.jsxs)("div",{className:"flex items-center gap-3 py-3",children:[(0,Ot.jsxs)("div",{className:"flex-1 relative",children:[(0,Ot.jsx)("input",{type:"text",placeholder:"Search properties...",className:"w-full pl-9 pr-4 py-2.5 text-sm border border-[#1c5bde]/20 rounded-xl  focus:outline-none focus:ring-2 focus:ring-[#1c5bde]/20 focus:border-[#1c5bde] transition-all duration-300"}),(0,Ot.jsx)(Ct,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-[#1c5bde]/60 h-4 w-4"})]}),(0,Ot.jsxs)(zc.button,{whileTap:{scale:.95},onClick:()=>c(!0),className:"bg-[#1c5bde] text-white px-4 py-2.5 text-sm rounded-xl flex items-center gap-1.5  hover:bg-[#1c5bde]/90 transition-all duration-300 hover:shadow-lg hover:shadow-[#1c5bde]/20",children:[(0,Ot.jsx)(uj,{className:"h-4 w-4"}),"Filters"]})]}),(0,Ot.jsx)("div",{className:"py-2 -mx-4 px-4 overflow-x-auto scrollbar-hide",children:(0,Ot.jsx)("div",{className:"flex space-x-3 min-w-max",children:g.map((e=>(0,Ot.jsxs)(zc.button,{whileHover:{y:-1},whileTap:{scale:.95},onClick:()=>h(e.id),className:"flex items-center gap-1.5 px-4 py-2 rounded-xl whitespace-nowrap transition-all text-sm\n                    ".concat(u===e.id?"bg-[#1c5bde] text-white shadow-md shadow-[#1c5bde]/20":"bg-white text-neutral-600 hover:bg-[#1c5bde]/5 border border-[#1c5bde]/10"),children:[(0,Ot.jsx)(e.icon,{className:"h-4 w-4"}),(0,Ot.jsx)("span",{className:"font-medium",children:e.label})]},e.id)))})})]})}),(0,Ot.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,Ot.jsxs)("div",{className:"mb-6 flex items-center justify-between",children:[(0,Ot.jsxs)("div",{children:[(0,Ot.jsx)("h1",{className:"text-2xl font-bold mb-1 bg-gradient-to-r from-[#1c5bde] to-[#1c5bde]/80 bg-clip-text text-transparent",children:"Available Properties"}),(0,Ot.jsxs)("p",{className:"text-sm text-neutral-600",children:["Showing ",Hc.length," properties"]})]}),(0,Ot.jsxs)("div",{className:"flex items-center gap-4",children:[(0,Ot.jsxs)("select",{className:"px-4 py-2 rounded-xl border border-[#1c5bde]/20 text-sm text-neutral-600 focus:outline-none focus:ring-2 focus:ring-[#1c5bde]/20",children:[(0,Ot.jsx)("option",{children:"Newest"}),(0,Ot.jsx)("option",{children:"Price: Low to High"}),(0,Ot.jsx)("option",{children:"Price: High to Low"}),(0,Ot.jsx)("option",{children:"Most Popular"})]}),(0,Ot.jsxs)("button",{onClick:()=>m(!f),className:"bg-white border border-[#1c5bde]/20 text-[#1c5bde] px-4 py-2 rounded-xl text-sm  font-medium flex items-center gap-2 hover:bg-[#1c5bde]/5 transition-colors",children:[(0,Ot.jsx)(uu,{className:"h-4 w-4"}),f?"List View":"Map View"]})]})]}),(0,Ot.jsx)(zc.div,{layout:!0,className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:(0,Ot.jsx)(Yt,{children:b.map((e=>(0,Ot.jsxs)(zc.div,{layout:!0,initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},onClick:()=>(e=>{s(e),o(!0),document.body.style.overflow="hidden"})(e),className:"group bg-white rounded-xl overflow-hidden hover:shadow-lg transition-all duration-300  border border-[#1c5bde]/10 hover:border-[#1c5bde]/20 cursor-pointer",children:[(0,Ot.jsxs)("div",{className:"relative h-64",children:[(0,Ot.jsx)("img",{src:e.image,alt:e.title,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-500"}),(0,Ot.jsx)("div",{className:"absolute top-4 left-4 px-3 py-1.5 rounded-lg bg-white/90 backdrop-blur-sm  shadow-sm border border-[#1c5bde]/10",children:(0,Ot.jsxs)("div",{className:"flex items-center gap-1.5",children:["residential"===e.type&&(0,Ot.jsx)(nu,{className:"h-3.5 w-3.5 text-[#1c5bde]"}),"apartments"===e.type&&(0,Ot.jsx)(lu,{className:"h-3.5 w-3.5 text-[#1c5bde]"}),"commercial"===e.type&&(0,Ot.jsx)(sj,{className:"h-3.5 w-3.5 text-[#1c5bde]"}),"luxury"===e.type&&(0,Ot.jsx)(iu,{className:"h-3.5 w-3.5 text-[#1c5bde]"}),"industrial"===e.type&&(0,Ot.jsx)(lj,{className:"h-3.5 w-3.5 text-[#1c5bde]"}),"hotels"===e.type&&(0,Ot.jsx)(au,{className:"h-3.5 w-3.5 text-[#1c5bde]"}),"land"===e.type&&(0,Ot.jsx)(cj,{className:"h-3.5 w-3.5 text-[#1c5bde]"}),(0,Ot.jsxs)("span",{className:"text-xs font-medium text-neutral-800",children:["residential"===e.type&&"Home","apartments"===e.type&&"Apt","commercial"===e.type&&"Office","luxury"===e.type&&"Luxury","industrial"===e.type&&"Industrial","hotels"===e.type&&"Hotel","land"===e.type&&"Land"]})]})}),(0,Ot.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent  opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),(0,Ot.jsxs)("div",{className:"absolute inset-x-0 top-1/2 -translate-y-1/2 flex justify-between px-2  opacity-0 group-hover:opacity-100 transition-opacity",children:[(0,Ot.jsx)(zc.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:e=>{e.stopPropagation()},className:"p-2 rounded-full bg-white/90 hover:bg-white shadow-lg transition-colors",children:(0,Ot.jsx)(hj,{className:"h-4 w-4 text-neutral-900"})}),(0,Ot.jsx)(zc.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:e=>{e.stopPropagation()},className:"p-2 rounded-full bg-white/90 hover:bg-white shadow-lg transition-colors",children:(0,Ot.jsx)(mu,{className:"h-4 w-4 text-neutral-900"})})]}),(0,Ot.jsx)("div",{className:"absolute top-4 right-4 flex gap-2",children:(0,Ot.jsx)(zc.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:e=>{e.stopPropagation()},className:"bg-white/90 backdrop-blur-sm hover:bg-white p-2 rounded-full shadow-lg transition-colors",children:(0,Ot.jsx)(Jc,{className:"h-4 w-4 text-[#ff8533]"})})}),(0,Ot.jsx)("div",{className:"absolute bottom-4 left-4",children:(0,Ot.jsx)("div",{className:"bg-white/90 backdrop-blur-sm px-3 py-1.5 rounded-lg shadow-sm",children:(0,Ot.jsx)("span",{className:"text-[#1c5bde] font-semibold",children:e.price})})})]}),(0,Ot.jsxs)("div",{className:"p-4",children:[(0,Ot.jsx)("div",{className:"flex justify-between items-start mb-2",children:(0,Ot.jsx)("h3",{className:"font-semibold text-lg text-neutral-800 group-hover:text-[#1c5bde] transition-colors",children:e.title})}),(0,Ot.jsxs)("p",{className:"text-neutral-600 flex items-center gap-1 mb-3 text-sm",children:[(0,Ot.jsx)(tu,{className:"h-4 w-4 text-[#1c5bde]"}),e.location]}),(0,Ot.jsxs)("div",{className:"flex items-center gap-4 text-neutral-600 text-sm",children:[e.beds&&(0,Ot.jsxs)("div",{className:"flex items-center gap-1 bg-[#f8fafc] px-2 py-1 rounded-lg",children:[(0,Ot.jsx)(hu,{className:"h-4 w-4 text-[#1c5bde]"}),(0,Ot.jsxs)("span",{children:[e.beds," Beds"]})]}),e.baths&&(0,Ot.jsxs)("div",{className:"flex items-center gap-1 bg-[#f8fafc] px-2 py-1 rounded-lg",children:[(0,Ot.jsx)(du,{className:"h-4 w-4 text-[#1c5bde]"}),(0,Ot.jsxs)("span",{children:[e.baths," Baths"]})]}),(0,Ot.jsxs)("div",{className:"flex items-center gap-1 bg-[#f8fafc] px-2 py-1 rounded-lg",children:[(0,Ot.jsx)(pu,{className:"h-4 w-4 text-[#1c5bde]"}),(0,Ot.jsx)("span",{children:e.area})]})]}),(0,Ot.jsx)(zc.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:t=>{t.stopPropagation(),_(e.id)},className:"w-full mt-4 bg-[#1c5bde]/5 hover:bg-[#1c5bde]/10 text-[#1c5bde] py-2 rounded-lg  text-center font-medium transition-colors",children:"View Details"})]})]},e.id)))})}),w>1&&(0,Ot.jsxs)("div",{className:"mt-8 flex justify-center gap-2",children:[(0,Ot.jsx)(zc.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>p((e=>Math.max(e-1,1))),disabled:1===d,className:"p-2 rounded-full bg-white border border-[#1c5bde]/20 hover:bg-[#1c5bde]/5  disabled:opacity-50 disabled:hover:bg-white transition-colors",children:(0,Ot.jsx)(hj,{className:"h-5 w-5 text-[#1c5bde]"})}),Array.from({length:w},((e,t)=>(0,Ot.jsx)(zc.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>p(t+1),className:"w-10 h-10 rounded-full font-medium transition-colors ".concat(d===t+1?"bg-[#1c5bde] text-white shadow-md shadow-[#1c5bde]/20":"bg-white border border-[#1c5bde]/20 text-neutral-600 hover:bg-[#1c5bde]/5"),children:t+1},t+1))),(0,Ot.jsx)(zc.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>p((e=>Math.min(e+1,w))),disabled:d===w,className:"p-2 rounded-full bg-white border border-[#1c5bde]/20 hover:bg-[#1c5bde]/5  disabled:opacity-50 disabled:hover:bg-white transition-colors",children:(0,Ot.jsx)(mu,{className:"h-5 w-5 text-[#1c5bde]"})})]})]}),(0,Ot.jsx)(Yt,{children:l&&(0,Ot.jsx)(zc.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 z-50",onClick:()=>c(!1),children:(0,Ot.jsxs)(zc.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},onClick:e=>e.stopPropagation(),className:"absolute right-0 top-0 h-full w-full max-w-md bg-white overflow-y-auto",children:[(0,Ot.jsx)("div",{className:"sticky top-0 bg-white p-4 border-b z-10",children:(0,Ot.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,Ot.jsx)("h2",{className:"text-xl font-semibold",children:"Filters"}),(0,Ot.jsx)("button",{onClick:()=>c(!1),className:"p-2 hover:bg-gray-100 rounded-full",children:(0,Ot.jsx)(jt,{className:"h-6 w-6"})})]})}),(0,Ot.jsxs)("div",{className:"p-4 space-y-6",children:[(0,Ot.jsxs)("div",{className:"space-y-4",children:[(0,Ot.jsx)("h3",{className:"font-semibold text-gray-900",children:"Price Range"}),(0,Ot.jsxs)("div",{className:"flex gap-4",children:[(0,Ot.jsx)("div",{className:"flex-1",children:(0,Ot.jsx)("input",{type:"number",placeholder:"Min",className:"w-full px-4 py-2 border rounded-lg"})}),(0,Ot.jsx)("div",{className:"flex-1",children:(0,Ot.jsx)("input",{type:"number",placeholder:"Max",className:"w-full px-4 py-2 border rounded-lg"})})]})]}),(0,Ot.jsxs)("div",{className:"space-y-4",children:[(0,Ot.jsx)("h3",{className:"font-semibold text-gray-900",children:"Property Type"}),(0,Ot.jsx)("div",{className:"grid grid-cols-2 gap-3",children:["Residential","Commercial","Industrial","Land"].map((e=>(0,Ot.jsx)("button",{className:"px-4 py-2 border rounded-lg text-gray-600 hover:border-[#1c5bde] hover:text-[#1c5bde] transition-colors",children:e},e)))})]}),(0,Ot.jsxs)("div",{className:"space-y-4",children:[(0,Ot.jsx)("h3",{className:"font-semibold text-gray-900",children:"Bedrooms"}),(0,Ot.jsx)("div",{className:"flex gap-2",children:[1,2,3,4,"5+"].map((e=>(0,Ot.jsx)("button",{className:"flex-1 px-4 py-2 border rounded-lg text-gray-600 hover:border-[#1c5bde] hover:text-[#1c5bde] transition-colors",children:e},e)))})]}),(0,Ot.jsxs)("div",{className:"space-y-4",children:[(0,Ot.jsx)("h3",{className:"font-semibold text-gray-900",children:"Amenities"}),(0,Ot.jsx)("div",{className:"grid grid-cols-2 gap-3",children:["Parking","Pool","Gym","Security","Garden","Elevator","Furnished","Pet Friendly"].map((e=>(0,Ot.jsxs)("label",{className:"flex items-center gap-2 text-gray-600",children:[(0,Ot.jsx)("input",{type:"checkbox",className:"rounded text-[#1c5bde]"}),e]},e)))})]})]}),(0,Ot.jsx)("div",{className:"sticky bottom-0 bg-white p-4 border-t",children:(0,Ot.jsx)("button",{onClick:()=>c(!1),className:"w-full bg-[#1c5bde] text-white py-3 rounded-lg hover:bg-[#0c0d8a] transition-colors",children:"Apply Filters"})})]})})}),(0,Ot.jsx)(Yt,{children:i&&a&&(0,Ot.jsx)(zc.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",onClick:y,children:(0,Ot.jsx)(zc.div,{initial:{scale:.95},animate:{scale:1},exit:{scale:.95},onClick:e=>e.stopPropagation(),className:"bg-white rounded-xl overflow-hidden max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:(0,Ot.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2",children:[(0,Ot.jsxs)("div",{className:"relative h-72 md:h-full",children:[(0,Ot.jsx)("img",{src:a.image,alt:a.title,className:"w-full h-full object-cover"}),(0,Ot.jsxs)("div",{className:"absolute inset-x-0 top-1/2 -translate-y-1/2 flex justify-between px-4",children:[(0,Ot.jsx)(zc.button,{whileHover:{scale:1.1},whileTap:{scale:.9},className:"p-2 rounded-full bg-white/90 hover:bg-white shadow-lg transition-colors",children:(0,Ot.jsx)(hj,{className:"h-5 w-5 text-gray-900"})}),(0,Ot.jsx)(zc.button,{whileHover:{scale:1.1},whileTap:{scale:.9},className:"p-2 rounded-full bg-white/90 hover:bg-white shadow-lg transition-colors",children:(0,Ot.jsx)(mu,{className:"h-5 w-5 text-gray-900"})})]}),(0,Ot.jsx)("button",{onClick:y,className:"absolute top-4 right-4 bg-white/90 p-2 rounded-full hover:bg-white transition-colors",children:(0,Ot.jsx)(jt,{className:"h-5 w-5"})})]}),(0,Ot.jsxs)("div",{className:"p-6 flex flex-col h-full",children:[(0,Ot.jsxs)("div",{className:"flex-1",children:[(0,Ot.jsx)("h2",{className:"text-2xl font-bold mb-2",children:a.title}),(0,Ot.jsx)("p",{className:"text-gray-600 mb-4",children:a.description}),(0,Ot.jsxs)("div",{className:"flex items-center gap-4 mb-4",children:[(0,Ot.jsxs)("div",{className:"flex items-center gap-1",children:[(0,Ot.jsx)(tu,{className:"h-5 w-5 text-[#1c5bde]"}),(0,Ot.jsx)("span",{children:a.location})]}),(0,Ot.jsxs)("div",{className:"flex items-center gap-1",children:[(0,Ot.jsx)(pu,{className:"h-5 w-5 text-[#1c5bde]"}),(0,Ot.jsx)("span",{children:a.area})]})]}),(0,Ot.jsx)("div",{className:"rounded-lg h-[400px] relative overflow-hidden mb-4",children:(0,Ot.jsx)("img",{src:"https://api.mapbox.com/styles/v1/mapbox/streets-v11/static/pin-s+ff0000(".concat(a.coordinates[0],",").concat(a.coordinates[1],")/").concat(a.coordinates[0],",").concat(a.coordinates[1],",14,0,0/800x400@2x?access_token=pk.eyJ1IjoibW10dWt1ciIsImEiOiJjbTEyZGk2dmwwbjZyMmtzMXFzb3V0cHRuIn0.pDgNHWd_o6u2NKVFib0EPQ"),alt:"Map showing ".concat(a.location),className:"absolute inset-0 w-full h-full object-cover rounded-lg"})})]}),(0,Ot.jsxs)("div",{className:"flex flex-col sm:flex-row justify-center sm:justify-end gap-3 mt-4",children:[(0,Ot.jsx)("button",{onClick:y,className:"px-6 py-2 border rounded-lg hover:bg-gray-50 transition-colors w-full sm:w-auto",children:"Close"}),(0,Ot.jsx)("button",{onClick:()=>_(a.id),className:"px-6 py-2 bg-[#1c5bde] text-white rounded-lg hover:bg-[#0c0d8a] transition-colors w-full sm:w-auto",children:"View Details"})]})]})]})})})}),(0,Ot.jsx)(Yt,{children:f&&(0,Ot.jsx)(Oj,{properties:Hc,onClose:()=>m(!1),filters:n})})]})};console.log("Mapbox Token:",qc.MAPBOX_TOKEN),Au().accessToken=qc.MAPBOX_TOKEN;const Dj=()=>{const[e]=mt(),n=e.get("property"),r=n?Hc.find((e=>e.id===parseInt(n))):null,i=(0,t.useRef)(null),o=(0,t.useRef)(null),[a,s]=(0,t.useState)("all");(0,t.useEffect)((()=>{o.current||(o.current=new(Au().Map)({container:i.current,style:"mapbox://styles/mapbox/streets-v11",center:r?r.coordinates:[3.422,6.448],zoom:12}),o.current.addControl(new(Au().NavigationControl)),o.current.on("load",(()=>{l(),r&&c(r)})))}),[]),(0,t.useEffect)((()=>{o.current&&u()}),[a]);const l=()=>{Zc.categories.forEach((e=>{e.items.forEach((t=>{const n=document.createElement("div");n.className="infrastructure-marker",n.style.backgroundColor=h(e.name),n.style.width="15px",n.style.height="15px",n.style.borderRadius="50%",n.style.border="2px solid white",n.style.cursor="pointer";const r=new(Au().Popup)({offset:25}).setHTML('\n            <div class="p-2">\n              <h3 class="font-semibold">'.concat(t.name,'</h3>\n              <p class="text-sm text-gray-600">').concat(e.name,'</p>\n              <p class="text-sm">').concat(t.distance," from center</p>\n            </div>\n          "));new(Au().Marker)(n).setLngLat(t.coordinates).setPopup(r).addTo(o.current),n.dataset.category=e.name}))}))},c=e=>{const t=document.createElement("div");t.className="property-marker",t.style.backgroundColor="#ff0000",t.style.width="20px",t.style.height="20px",t.style.borderRadius="50%",t.style.border="3px solid white";const n=new(Au().Popup)({offset:25}).setHTML('\n        <div class="p-2">\n          <h3 class="font-semibold">'.concat(e.title,'</h3>\n          <p class="text-sm">').concat(e.price,"</p>\n        </div>\n      "));new(Au().Marker)(t).setLngLat(e.coordinates).setPopup(n).addTo(o.current)},u=()=>{const e=document.getElementsByClassName("infrastructure-marker");Array.from(e).forEach((e=>{"all"===a||e.dataset.category===a?e.style.display="block":e.style.display="none"}))},h=e=>({Education:"#4CAF50",Healthcare:"#2196F3",Transportation:"#FFC107",Shopping:"#9C27B0",Entertainment:"#FF5722"}[e]||"#666666");return(0,Ot.jsxs)("div",{className:"min-h-screen",children:[(0,Ot.jsx)("div",{className:"bg-white shadow-sm p-4",children:(0,Ot.jsxs)("div",{className:"container mx-auto flex items-center justify-between",children:[(0,Ot.jsxs)(ut,{to:n?"/properties/".concat(n):"/properties",className:"flex items-center gap-2 text-gray-600 hover:text-[#0e109f]",children:[(0,Ot.jsx)(hj,{className:"h-5 w-5"}),"Back"]}),(0,Ot.jsx)("h1",{className:"text-lg font-semibold",children:"Infrastructure Map"})]})}),(0,Ot.jsx)("div",{className:"bg-white border-b p-4",children:(0,Ot.jsxs)("div",{className:"container mx-auto flex gap-2 overflow-x-auto",children:[(0,Ot.jsx)("button",{onClick:()=>s("all"),className:"px-4 py-2 rounded-full text-sm ".concat("all"===a?"bg-[#0e109f] text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:"All"}),Zc.categories.map((e=>(0,Ot.jsx)("button",{onClick:()=>s(e.name),className:"px-4 py-2 rounded-full text-sm whitespace-nowrap ".concat(a===e.name?"bg-[#0e109f] text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:e.name},e.name)))]})}),(0,Ot.jsx)("div",{ref:i,className:"h-[calc(100vh-128px)]"})]})},Lj=Et("Facebook",[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]]),zj=Et("Twitter",[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]]),Rj=Et("Instagram",[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]]),Fj=Et("Linkedin",[["path",{d:"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z",key:"c2jq9f"}],["rect",{width:"4",height:"12",x:"2",y:"9",key:"mk3on5"}],["circle",{cx:"4",cy:"4",r:"2",key:"bt5ra8"}]]),Bj=Et("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),Vj=Et("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),Uj=()=>{const e=(new Date).getFullYear(),t=[{title:"Company",links:[{label:"About Us",path:"/about"},{label:"Contact",path:"/contact"},{label:"Properties",path:"/properties"}]},{title:"Property Types",links:[{label:"Residential",path:"/properties?type=residential",icon:nu,description:"Homes & Apartments"},{label:"Commercial",path:"/properties?type=commercial",icon:sj,description:"Office & Retail spaces"},{label:"Luxury",path:"/properties?type=luxury",icon:iu,description:"Premium properties"},{label:"Industrial",path:"/properties?type=industrial",icon:lj,description:"Warehouses & Factories"}]},{title:"BuildFund Hub",isNew:!0,links:[{label:"CommunityPulse",path:"/buildfund-hub/community-pulse",icon:At,description:"Vote on infrastructure projects"},{label:"SmartVest",path:"/buildfund-hub/smart-vest",icon:Mt,description:"Invest from \u20a61,000"}]},{title:"Analysis",links:[{label:"Market Analysis",path:"/market-analysis",icon:kt,description:"Property market insights"},{label:"Infrastructure",path:"/infrastructure-analysis",icon:uu,description:"Development tracking"}]},{title:"Legal",links:[{label:"Terms of Service",path:"/terms"},{label:"Privacy Policy",path:"/privacy"}]}],r=[{icon:Lj,path:"https://facebook.com"},{icon:zj,path:"https://twitter.com"},{icon:Rj,path:"https://instagram.com"},{icon:Fj,path:"https://linkedin.com"}];return(0,Ot.jsx)("footer",{className:"bg-white border-t border-[#1c5bde]/10",children:(0,Ot.jsxs)("div",{className:"container mx-auto px-4 py-12",children:[(0,Ot.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-8",children:[(0,Ot.jsxs)("div",{className:"lg:col-span-2",children:[(0,Ot.jsx)(ut,{to:"/",className:"block mb-4",children:(0,Ot.jsx)("img",{src:new URL(n(2806),n.b).href,alt:"FastFind360 Logo",className:"h-10 w-auto"})}),(0,Ot.jsx)("p",{className:"text-neutral-600 text-sm mb-6",children:"Transforming real estate investment and community development in Nigeria"}),(0,Ot.jsxs)("div",{className:"space-y-3",children:[(0,Ot.jsxs)("div",{className:"flex items-center gap-2 text-neutral-600 text-sm hover:text-[#1c5bde] transition-colors",children:[(0,Ot.jsx)(Bj,{className:"h-4 w-4"}),(0,Ot.jsx)("a",{href:"mailto:contact@fastfind360.com",children:"contact@fastfind360.com"})]}),(0,Ot.jsxs)("div",{className:"flex items-center gap-2 text-neutral-600 text-sm hover:text-[#1c5bde] transition-colors",children:[(0,Ot.jsx)(Vj,{className:"h-4 w-4"}),(0,Ot.jsx)("a",{href:"tel:+2348000000000",children:"+234 800 000 0000"})]}),(0,Ot.jsxs)("div",{className:"flex items-center gap-2 text-neutral-600 text-sm",children:[(0,Ot.jsx)(tu,{className:"h-4 w-4"}),(0,Ot.jsx)("span",{children:"Lagos, Nigeria"})]})]})]}),t.map((e=>(0,Ot.jsxs)("div",{children:[(0,Ot.jsxs)("h3",{className:"font-semibold text-neutral-800 mb-4 flex items-center gap-2",children:[e.title,e.isNew&&(0,Ot.jsx)("span",{className:"px-1.5 py-0.5 bg-[#ff8533] text-white text-xs rounded-full",children:"New"})]}),(0,Ot.jsx)("ul",{className:"space-y-2.5",children:e.links.map((e=>(0,Ot.jsx)("li",{children:(0,Ot.jsxs)(ut,{to:e.path,className:"group text-sm text-neutral-600 hover:text-[#1c5bde] transition-colors flex items-center gap-2",children:[e.icon&&(0,Ot.jsx)(e.icon,{className:"h-4 w-4 text-neutral-500 group-hover:text-[#1c5bde] transition-colors"}),(0,Ot.jsxs)("div",{children:[(0,Ot.jsx)("span",{className:"group-hover:translate-x-0.5 transition-transform inline-block",children:e.label}),e.description&&(0,Ot.jsx)("p",{className:"text-xs text-neutral-500",children:e.description})]})]})},e.path)))})]},e.title)))]}),(0,Ot.jsx)("div",{className:"mt-12 pt-6 border-t border-[#1c5bde]/10",children:(0,Ot.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4",children:[(0,Ot.jsxs)("p",{className:"text-sm text-neutral-600",children:["\xa9 ",e," FastFind360. All rights reserved."]}),(0,Ot.jsx)("div",{className:"flex items-center gap-4",children:r.map(((e,t)=>(0,Ot.jsx)("a",{href:e.path,target:"_blank",rel:"noopener noreferrer",className:"p-2 rounded-full hover:bg-[#1c5bde]/5 text-neutral-600 hover:text-[#1c5bde] transition-colors",children:(0,Ot.jsx)(e.icon,{className:"h-4 w-4"})},t)))})]})})]})})};var Gj,Hj=["layout","type","stroke","connectNulls","isRange","ref"],Zj=["key"];function qj(e){return qj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qj(e)}function Wj(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Xj(){return Xj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Xj.apply(this,arguments)}function Yj(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Kj(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Yj(Object(n),!0).forEach((function(t){nI(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Yj(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Jj(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,rI(r.key),r)}}function Qj(e,t,n){return t=eI(t),function(e,t){if(t&&("object"===qj(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,$j()?Reflect.construct(t,n||[],eI(e).constructor):t.apply(e,n))}function $j(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return($j=function(){return!!e})()}function eI(e){return eI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},eI(e)}function tI(e,t){return tI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},tI(e,t)}function nI(e,t,n){return(t=rI(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function rI(e){var t=function(e,t){if("object"!=qj(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=qj(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==qj(t)?t:t+""}var iI=function(e){function n(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return nI(e=Qj(this,n,[].concat(r)),"state",{isAnimationFinished:!0}),nI(e,"id",Zh("recharts-area-")),nI(e,"handleAnimationEnd",(function(){var t=e.props.onAnimationEnd;e.setState({isAnimationFinished:!0}),ed()(t)&&t()})),nI(e,"handleAnimationStart",(function(){var t=e.props.onAnimationStart;e.setState({isAnimationFinished:!1}),ed()(t)&&t()})),e}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tI(e,t)}(n,e),r=n,i=[{key:"renderDots",value:function(e,r,i){var o=this.props.isAnimationActive,a=this.state.isAnimationFinished;if(o&&!a)return null;var s=this.props,l=s.dot,c=s.points,u=s.dataKey,h=Md(this.props,!1),d=Md(l,!0),p=c.map((function(e,t){var r=Kj(Kj(Kj({key:"dot-".concat(t),r:3},h),d),{},{index:t,cx:e.x,cy:e.y,dataKey:u,value:e.value,payload:e.payload,points:c});return n.renderDotItem(l,r)})),f={clipPath:e?"url(#clipPath-".concat(r?"":"dots-").concat(i,")"):null};return t.createElement(Jd,Xj({className:"recharts-area-dots"},f),p)}},{key:"renderHorizontalRect",value:function(e){var n=this.props,r=n.baseLine,i=n.points,o=n.strokeWidth,a=i[0].x,s=i[i.length-1].x,l=e*Math.abs(a-s),c=tS()(i.map((function(e){return e.y||0})));return Uh(r)&&"number"===typeof r?c=Math.max(r,c):r&&Array.isArray(r)&&r.length&&(c=Math.max(tS()(r.map((function(e){return e.y||0}))),c)),Uh(c)?t.createElement("rect",{x:a<s?a:a-l,y:0,width:l,height:Math.floor(c+(o?parseInt("".concat(o),10):1))}):null}},{key:"renderVerticalRect",value:function(e){var n=this.props,r=n.baseLine,i=n.points,o=n.strokeWidth,a=i[0].y,s=i[i.length-1].y,l=e*Math.abs(a-s),c=tS()(i.map((function(e){return e.x||0})));return Uh(r)&&"number"===typeof r?c=Math.max(r,c):r&&Array.isArray(r)&&r.length&&(c=Math.max(tS()(r.map((function(e){return e.x||0}))),c)),Uh(c)?t.createElement("rect",{x:0,y:a<s?a:a-l,width:c+(o?parseInt("".concat(o),10):1),height:Math.floor(l)}):null}},{key:"renderClipRect",value:function(e){return"vertical"===this.props.layout?this.renderVerticalRect(e):this.renderHorizontalRect(e)}},{key:"renderAreaStatically",value:function(e,n,r,i){var o=this.props,a=o.layout,s=o.type,l=o.stroke,c=o.connectNulls,u=o.isRange,h=(o.ref,Wj(o,Hj));return t.createElement(Jd,{clipPath:r?"url(#clipPath-".concat(i,")"):null},t.createElement(tk,Xj({},Md(h,!0),{points:e,connectNulls:c,type:s,baseLine:n,layout:a,stroke:"none",className:"recharts-area-area"})),"none"!==l&&t.createElement(tk,Xj({},Md(this.props,!1),{className:"recharts-area-curve",layout:a,type:s,connectNulls:c,fill:"none",points:e})),"none"!==l&&u&&t.createElement(tk,Xj({},Md(this.props,!1),{className:"recharts-area-curve",layout:a,type:s,connectNulls:c,fill:"none",points:n})))}},{key:"renderAreaWithAnimation",value:function(e,n){var r=this,i=this.props,o=i.points,a=i.baseLine,s=i.isAnimationActive,l=i.animationBegin,c=i.animationDuration,u=i.animationEasing,h=i.animationId,d=this.state,p=d.prevPoints,f=d.prevBaseLine;return t.createElement(qg,{begin:l,duration:c,isActive:s,easing:u,from:{t:0},to:{t:1},key:"area-".concat(h),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},(function(i){var s=i.t;if(p){var l,c=p.length/o.length,u=o.map((function(e,t){var n=Math.floor(t*c);if(p[n]){var r=p[n],i=Xh(r.x,e.x),o=Xh(r.y,e.y);return Kj(Kj({},e),{},{x:i(s),y:o(s)})}return e}));return l=Uh(a)&&"number"===typeof a?Xh(f,a)(s):Qh()(a)||Dh()(a)?Xh(f,0)(s):a.map((function(e,t){var n=Math.floor(t*c);if(f[n]){var r=f[n],i=Xh(r.x,e.x),o=Xh(r.y,e.y);return Kj(Kj({},e),{},{x:i(s),y:o(s)})}return e})),r.renderAreaStatically(u,l,e,n)}return t.createElement(Jd,null,t.createElement("defs",null,t.createElement("clipPath",{id:"animationClipPath-".concat(n)},r.renderClipRect(s))),t.createElement(Jd,{clipPath:"url(#animationClipPath-".concat(n,")")},r.renderAreaStatically(o,a,e,n)))}))}},{key:"renderArea",value:function(e,t){var n=this.props,r=n.points,i=n.baseLine,o=n.isAnimationActive,a=this.state,s=a.prevPoints,l=a.prevBaseLine,c=a.totalLength;return o&&r&&r.length&&(!s&&c>0||!sS()(s,r)||!sS()(l,i))?this.renderAreaWithAnimation(e,t):this.renderAreaStatically(r,i,e,t)}},{key:"render",value:function(){var e,n=this.props,r=n.hide,i=n.dot,o=n.points,a=n.className,s=n.top,l=n.left,c=n.xAxis,u=n.yAxis,h=n.width,d=n.height,p=n.isAnimationActive,f=n.id;if(r||!o||!o.length)return null;var m=this.state.isAnimationFinished,g=1===o.length,y=kh("recharts-area",a),_=c&&c.allowDataOverflow,v=u&&u.allowDataOverflow,x=_||v,b=Qh()(f)?this.id:f,w=null!==(e=Md(i,!1))&&void 0!==e?e:{r:3,strokeWidth:2},S=w.r,T=void 0===S?3:S,E=w.strokeWidth,A=void 0===E?2:E,M=(Ad(i)?i:{}).clipDot,P=void 0===M||M,k=2*T+A;return t.createElement(Jd,{className:y},_||v?t.createElement("defs",null,t.createElement("clipPath",{id:"clipPath-".concat(b)},t.createElement("rect",{x:_?l:l-h/2,y:v?s:s-d/2,width:_?h:2*h,height:v?d:2*d})),!P&&t.createElement("clipPath",{id:"clipPath-dots-".concat(b)},t.createElement("rect",{x:l-k/2,y:s-k/2,width:h+k,height:d+k}))):null,g?null:this.renderArea(x,b),(i||g)&&this.renderDots(x,P,b),(!p||m)&&UE.renderCallByParent(this.props,o))}}],o=[{key:"getDerivedStateFromProps",value:function(e,t){return e.animationId!==t.prevAnimationId?{prevAnimationId:e.animationId,curPoints:e.points,curBaseLine:e.baseLine,prevPoints:t.curPoints,prevBaseLine:t.curBaseLine}:e.points!==t.curPoints||e.baseLine!==t.curBaseLine?{curPoints:e.points,curBaseLine:e.baseLine}:null}}],i&&Jj(r.prototype,i),o&&Jj(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,i,o}(t.PureComponent);Gj=iI,nI(iI,"displayName","Area"),nI(iI,"defaultProps",{stroke:"#3182bd",fill:"#3182bd",fillOpacity:.6,xAxisId:0,yAxisId:0,legendType:"line",connectNulls:!1,points:[],dot:!1,activeDot:!0,hide:!1,isAnimationActive:!Tp.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"}),nI(iI,"getBaseValue",(function(e,t,n,r){var i=e.layout,o=e.baseValue,a=t.props.baseValue,s=null!==a&&void 0!==a?a:o;if(Uh(s)&&"number"===typeof s)return s;var l="horizontal"===i?r:n,c=l.scale.domain();if("number"===l.type){var u=Math.max(c[0],c[1]),h=Math.min(c[0],c[1]);return"dataMin"===s?h:"dataMax"===s||u<0?u:Math.max(Math.min(c[0],c[1]),0)}return"dataMin"===s?c[0]:"dataMax"===s?c[1]:c[0]})),nI(iI,"getComposedData",(function(e){var t,n=e.props,r=e.item,i=e.xAxis,o=e.yAxis,a=e.xAxisTicks,s=e.yAxisTicks,l=e.bandSize,c=e.dataKey,u=e.stackedData,h=e.dataStartIndex,d=e.displayedData,p=e.offset,f=n.layout,m=u&&u.length,g=Gj.getBaseValue(n,r,i,o),y="horizontal"===f,_=!1,v=d.map((function(e,t){var n;m?n=u[h+t]:(n=lT(e,c),Array.isArray(n)?_=!0:n=[g,n]);var r=null==n[1]||m&&null==lT(e,c);return y?{x:TT({axis:i,ticks:a,bandSize:l,entry:e,index:t}),y:r?null:o.scale(n[1]),value:n,payload:e}:{x:r?null:i.scale(n[1]),y:TT({axis:o,ticks:s,bandSize:l,entry:e,index:t}),value:n,payload:e}}));return t=m||_?v.map((function(e){var t=Array.isArray(e.value)?e.value[0]:null;return y?{x:e.x,y:null!=t&&null!=e.y?o.scale(t):null}:{x:null!=t?i.scale(t):null,y:e.y}})):y?o.scale(g):i.scale(g),Kj({points:v,baseLine:t,layout:f,isRange:_},p)})),nI(iI,"renderDotItem",(function(e,n){var r;if(t.isValidElement(e))r=t.cloneElement(e,n);else if(ed()(e))r=e(n);else{var i=kh("recharts-area-dot","boolean"!==typeof e?e.className:""),o=n.key,a=Wj(n,Zj);r=t.createElement(ym,Xj({},a,{key:o,className:i}))}return r}));var oI=Yk({chartName:"AreaChart",GraphicalChild:iI,axisComponents:[{axisType:"xAxis",AxisComp:WC},{axisType:"yAxis",AxisComp:ij}],formatAxisMap:iM}),aI=["x1","y1","x2","y2","key"],sI=["offset"];function lI(e){return lI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},lI(e)}function cI(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function uI(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?cI(Object(n),!0).forEach((function(t){hI(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):cI(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function hI(e,t,n){return t=function(e){var t=function(e,t){if("object"!=lI(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=lI(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==lI(t)?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function dI(){return dI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},dI.apply(this,arguments)}function pI(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var fI=function(e){var n=e.fill;if(!n||"none"===n)return null;var r=e.fillOpacity,i=e.x,o=e.y,a=e.width,s=e.height,l=e.ry;return t.createElement("rect",{x:i,y:o,ry:l,width:a,height:s,stroke:"none",fill:n,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function mI(e,n){var r;if(t.isValidElement(e))r=t.cloneElement(e,n);else if(ed()(e))r=e(n);else{var i=n.x1,o=n.y1,a=n.x2,s=n.y2,l=n.key,c=pI(n,aI),u=Md(c,!1),h=(u.offset,pI(u,sI));r=t.createElement("line",dI({},h,{x1:i,y1:o,x2:a,y2:s,fill:"none",key:l}))}return r}function gI(e){var n=e.x,r=e.width,i=e.horizontal,o=void 0===i||i,a=e.horizontalPoints;if(!o||!a||!a.length)return null;var s=a.map((function(t,i){var a=uI(uI({},e),{},{x1:n,y1:t,x2:n+r,y2:t,key:"line-".concat(i),index:i});return mI(o,a)}));return t.createElement("g",{className:"recharts-cartesian-grid-horizontal"},s)}function yI(e){var n=e.y,r=e.height,i=e.vertical,o=void 0===i||i,a=e.verticalPoints;if(!o||!a||!a.length)return null;var s=a.map((function(t,i){var a=uI(uI({},e),{},{x1:t,y1:n,x2:t,y2:n+r,key:"line-".concat(i),index:i});return mI(o,a)}));return t.createElement("g",{className:"recharts-cartesian-grid-vertical"},s)}function _I(e){var n=e.horizontalFill,r=e.fillOpacity,i=e.x,o=e.y,a=e.width,s=e.height,l=e.horizontalPoints,c=e.horizontal;if(!(void 0===c||c)||!n||!n.length)return null;var u=l.map((function(e){return Math.round(e+o-o)})).sort((function(e,t){return e-t}));o!==u[0]&&u.unshift(0);var h=u.map((function(e,l){var c=!u[l+1]?o+s-e:u[l+1]-e;if(c<=0)return null;var h=l%n.length;return t.createElement("rect",{key:"react-".concat(l),y:e,x:i,height:c,width:a,stroke:"none",fill:n[h],fillOpacity:r,className:"recharts-cartesian-grid-bg"})}));return t.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},h)}function vI(e){var n=e.vertical,r=void 0===n||n,i=e.verticalFill,o=e.fillOpacity,a=e.x,s=e.y,l=e.width,c=e.height,u=e.verticalPoints;if(!r||!i||!i.length)return null;var h=u.map((function(e){return Math.round(e+a-a)})).sort((function(e,t){return e-t}));a!==h[0]&&h.unshift(0);var d=h.map((function(e,n){var r=!h[n+1]?a+l-e:h[n+1]-e;if(r<=0)return null;var u=n%i.length;return t.createElement("rect",{key:"react-".concat(n),x:e,y:s,width:r,height:c,stroke:"none",fill:i[u],fillOpacity:o,className:"recharts-cartesian-grid-bg"})}));return t.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},d)}var xI=function(e,t){var n=e.xAxis,r=e.width,i=e.height,o=e.offset;return fT(xC(uI(uI(uI({},LC.defaultProps),n),{},{ticks:mT(n,!0),viewBox:{x:0,y:0,width:r,height:i}})),o.left,o.left+o.width,t)},bI=function(e,t){var n=e.yAxis,r=e.width,i=e.height,o=e.offset;return fT(xC(uI(uI(uI({},LC.defaultProps),n),{},{ticks:mT(n,!0),viewBox:{x:0,y:0,width:r,height:i}})),o.top,o.top+o.height,t)},wI={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function SI(e){var n,r,i,o,a,s,l=LM(),c=zM(),u=(0,t.useContext)(kM),h=uI(uI({},e),{},{stroke:null!==(n=e.stroke)&&void 0!==n?n:wI.stroke,fill:null!==(r=e.fill)&&void 0!==r?r:wI.fill,horizontal:null!==(i=e.horizontal)&&void 0!==i?i:wI.horizontal,horizontalFill:null!==(o=e.horizontalFill)&&void 0!==o?o:wI.horizontalFill,vertical:null!==(a=e.vertical)&&void 0!==a?a:wI.vertical,verticalFill:null!==(s=e.verticalFill)&&void 0!==s?s:wI.verticalFill,x:Uh(e.x)?e.x:u.left,y:Uh(e.y)?e.y:u.top,width:Uh(e.width)?e.width:u.width,height:Uh(e.height)?e.height:u.height}),d=h.x,p=h.y,f=h.width,m=h.height,g=h.syncWithTicks,y=h.horizontalValues,_=h.verticalValues,v=function(){var e=(0,t.useContext)(AM);return Wh(e)}(),x=function(){var e=(0,t.useContext)(MM);return SM()(e,(function(e){return ME()(e.domain,Number.isFinite)}))||Wh(e)}();if(!Uh(f)||f<=0||!Uh(m)||m<=0||!Uh(d)||d!==+d||!Uh(p)||p!==+p)return null;var b=h.verticalCoordinatesGenerator||xI,w=h.horizontalCoordinatesGenerator||bI,S=h.horizontalPoints,T=h.verticalPoints;if((!S||!S.length)&&ed()(w)){var E=y&&y.length,A=w({yAxis:x?uI(uI({},x),{},{ticks:E?y:x.ticks}):void 0,width:l,height:c,offset:u},!!E||g);Kh(Array.isArray(A),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(lI(A),"]")),Array.isArray(A)&&(S=A)}if((!T||!T.length)&&ed()(b)){var M=_&&_.length,P=b({xAxis:v?uI(uI({},v),{},{ticks:M?_:v.ticks}):void 0,width:l,height:c,offset:u},!!M||g);Kh(Array.isArray(P),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(lI(P),"]")),Array.isArray(P)&&(T=P)}return t.createElement("g",{className:"recharts-cartesian-grid"},t.createElement(fI,{fill:h.fill,fillOpacity:h.fillOpacity,x:h.x,y:h.y,width:h.width,height:h.height,ry:h.ry}),t.createElement(gI,dI({},h,{offset:u,horizontalPoints:S,xAxis:v,yAxis:x})),t.createElement(yI,dI({},h,{offset:u,verticalPoints:T,xAxis:v,yAxis:x})),t.createElement(_I,dI({},h,{horizontalPoints:S})),t.createElement(vI,dI({},h,{verticalPoints:T})))}SI.displayName="CartesianGrid";const TI=Et("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),EI=Et("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),AI=Et("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),MI=Et("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]),PI=Et("Newspaper",[["path",{d:"M4 22h16a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v16a2 2 0 0 1-2 2Zm0 0a2 2 0 0 1-2-2v-9c0-1.1.9-2 2-2h2",key:"7pis2x"}],["path",{d:"M18 14h-8",key:"sponae"}],["path",{d:"M15 18h-5",key:"95g1m2"}],["path",{d:"M10 6h8v4h-8V6Z",key:"smlsk5"}]]),kI=Et("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);const CI=(0,t.createContext)(null),jI=CI.Provider;function II(){const e=(0,t.useContext)(CI);if(null==e)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return e}var OI=n(228),NI=n.n(OI);const DI=["bounds","boundsOptions","center","children","className","id","placeholder","style","whenReady","zoom"];function LI(){return LI=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},LI.apply(this,arguments)}function zI(e,n){let{bounds:r,boundsOptions:o,center:a,children:s,className:l,id:c,placeholder:u,style:h,whenReady:d,zoom:p}=e,f=i(e,DI);const[m]=(0,t.useState)({className:l,id:c,style:h}),[g,y]=(0,t.useState)(null);(0,t.useImperativeHandle)(n,(()=>{var e;return null!==(e=null===g||void 0===g?void 0:g.map)&&void 0!==e?e:null}),[g]);const _=(0,t.useCallback)((e=>{if(null!==e&&null===g){const t=new OI.Map(e,f);null!=a&&null!=p?t.setView(a,p):null!=r&&t.fitBounds(r,o),null!=d&&t.whenReady(d),y(function(e){return Object.freeze({__version:1,map:e})}(t))}}),[]);(0,t.useEffect)((()=>()=>{null===g||void 0===g||g.map.remove()}),[g]);const v=g?t.createElement(jI,{value:g},s):null!==u&&void 0!==u?u:null;return t.createElement("div",LI({},m,{ref:_}),v)}const RI=(0,t.forwardRef)(zI);function FI(e,t,n){return Object.freeze({instance:e,context:t,container:n})}function BI(e,n){return null==n?function(n,r){const i=(0,t.useRef)();return i.current||(i.current=e(n,r)),i}:function(r,i){const o=(0,t.useRef)();o.current||(o.current=e(r,i));const a=(0,t.useRef)(r),{instance:s}=o.current;return(0,t.useEffect)((function(){a.current!==r&&(n(s,r,a.current),a.current=r)}),[s,r,i]),o}}function VI(e,n){const r=(0,t.useRef)(n);(0,t.useEffect)((function(){n!==r.current&&null!=e.attributionControl&&(null!=r.current&&e.attributionControl.removeAttribution(r.current),null!=n&&e.attributionControl.addAttribution(n)),r.current=n}),[e,n])}function UI(e,n){const r=(0,t.useRef)();(0,t.useEffect)((function(){return null!=n&&e.instance.on(n),r.current=n,function(){null!=r.current&&e.instance.off(r.current),r.current=null}}),[e,n])}function GI(e,t){var n;const r=null!==(n=e.pane)&&void 0!==n?n:t.pane;return r?c(c({},e),{},{pane:r}):e}function HI(e){return function(n){const r=II(),i=e(GI(n,r),r);return VI(r.map,n.attribution),UI(i.current,n.eventHandlers),function(e,n){(0,t.useEffect)((function(){var t;return(null!==(t=n.layerContainer)&&void 0!==t?t:n.map).addLayer(e.instance),function(){var t;null===(t=n.layerContainer)||void 0===t||t.removeLayer(e.instance),n.map.removeLayer(e.instance)}}),[n,e])}(i.current,r),i}}const ZI=["url"],qI=function(e){function n(n,r){const{instance:i}=e(n).current;return(0,t.useImperativeHandle)(r,(()=>i)),null}return(0,t.forwardRef)(n)}(HI(BI((function(e,t){let{url:n}=e,r=i(e,ZI);return FI(new OI.TileLayer(n,GI(r,t)),t)}),(function(e,t,n){!function(e,t,n){const{opacity:r,zIndex:i}=t;null!=r&&r!==n.opacity&&e.setOpacity(r),null!=i&&i!==n.zIndex&&e.setZIndex(i)}(e,t,n);const{url:r}=t;null!=r&&r!==n.url&&e.setUrl(r)}))));const WI=["position"],XI=function(e,n){return function(e){function n(n,r){const{instance:i,context:o}=e(n).current;return(0,t.useImperativeHandle)(r,(()=>i)),null==n.children?null:t.createElement(jI,{value:o},n.children)}return(0,t.forwardRef)(n)}(HI(BI(e,n)))}((function(e,t){let{position:n}=e,r=i(e,WI);const o=new OI.Marker(n,r);return FI(o,(a=t,s={overlayContainer:o},Object.freeze(c(c({},a),s))));var a,s}),(function(e,t,n){t.position!==n.position&&e.setLatLng(t.position),null!=t.icon&&t.icon!==n.icon&&e.setIcon(t.icon),null!=t.zIndexOffset&&t.zIndexOffset!==n.zIndexOffset&&e.setZIndexOffset(t.zIndexOffset),null!=t.opacity&&t.opacity!==n.opacity&&e.setOpacity(t.opacity),null!=e.dragging&&t.draggable!==n.draggable&&(!0===t.draggable?e.dragging.enable():e.dragging.disable())})),YI=function(e,n){const i=function(e,t){return function(n,r){const i=II(),o=e(GI(n,i),i);return VI(i.map,n.attribution),UI(o.current,n.eventHandlers),t(o.current,i,n,r),o}}(BI(e),n);return function(e){function n(n,i){const[o,a]=(0,t.useState)(!1),{instance:s}=e(n,a).current;(0,t.useImperativeHandle)(i,(()=>s)),(0,t.useEffect)((function(){o&&s.update()}),[s,o,n.children]);const l=s._contentNode;return l?(0,r.createPortal)(n.children,l):null}return(0,t.forwardRef)(n)}(i)}((function(e,t){return FI(new OI.Popup(e,t.overlayContainer),t)}),(function(e,n,r,i){let{position:o}=r;(0,t.useEffect)((function(){const{instance:t}=e;function r(e){e.popup===t&&(t.update(),i(!0))}function a(e){e.popup===t&&i(!1)}return n.map.on({popupopen:r,popupclose:a}),null==n.overlayContainer?(null!=o&&t.setLatLng(o),t.openOn(n.map)):n.overlayContainer.bindPopup(t),function(){var e;n.map.off({popupopen:r,popupclose:a}),null===(e=n.overlayContainer)||void 0===e||e.unbindPopup(),n.map.removeLayer(t)}}),[e,n,i,o])}));delete NI().Icon.Default.prototype._getIconUrl,NI().Icon.Default.mergeOptions({iconRetinaUrl:n(8249),iconUrl:n(7024),shadowUrl:n(1071)});const KI=()=>{const e=[9.0765,7.3986];return(0,Ot.jsxs)(RI,{center:e,zoom:12,style:{height:"400px",width:"100%"},children:[(0,Ot.jsx)(qI,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'\xa9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}),(0,Ot.jsx)(XI,{position:e,children:(0,Ot.jsx)(YI,{children:"Abuja, Nigeria"})})]})},JI=()=>{const e=ue(),[n,r]=(0,t.useState)("all"),[i,o]=(0,t.useState)("1y"),[a,s]=(0,t.useState)("all"),[l,c]=(0,t.useState)(!1),[u,h]=(0,t.useState)(!1),d=["Asokoro","Maitama","Wuse","Garki","Gwarinpa","Jabi","Utako","Life Camp","Katampe","Kubwa"],p="\u20a685M",f="+5.2%",m="1,234",g="+3.8%",y="45",_="-2.1%";return(0,Ot.jsxs)("div",{className:"min-h-screen bg-gray-50 pt-20",children:[(0,Ot.jsx)("div",{className:"bg-gradient-to-r from-[#1c5bde]/5 to-white",children:(0,Ot.jsxs)("div",{className:"container mx-auto px-4 py-12",children:[(0,Ot.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-center gap-8",children:[(0,Ot.jsxs)("div",{children:[(0,Ot.jsx)("h1",{className:"text-4xl font-bold mb-4",children:"Abuja Real Estate Market Analysis"}),(0,Ot.jsx)("p",{className:"text-gray-600 text-lg mb-6",children:"Comprehensive insights into Nigeria's capital city real estate market"}),(0,Ot.jsxs)("div",{className:"flex gap-4",children:[(0,Ot.jsxs)("button",{onClick:()=>h(!u),className:"flex items-center gap-2 px-4 py-2 bg-white rounded-lg shadow-sm hover:shadow-md transition-all",children:[(0,Ot.jsx)(TI,{className:"h-5 w-5"}),"Filters"]}),(0,Ot.jsxs)("button",{className:"flex items-center gap-2 px-4 py-2 bg-white rounded-lg shadow-sm hover:shadow-md transition-all",children:[(0,Ot.jsx)(EI,{className:"h-5 w-5"}),"Export Report"]}),(0,Ot.jsxs)("button",{className:"flex items-center gap-2 px-4 py-2 bg-white rounded-lg shadow-sm hover:shadow-md transition-all",children:[(0,Ot.jsx)(fu,{className:"h-5 w-5"}),"Share"]})]})]}),(0,Ot.jsxs)("div",{className:"bg-white p-6 rounded-xl shadow-sm",children:[(0,Ot.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Quick Stats"}),(0,Ot.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,Ot.jsxs)("div",{children:[(0,Ot.jsx)("p",{className:"text-sm text-gray-600",children:"Average Price"}),(0,Ot.jsx)("p",{className:"text-2xl font-bold text-[#1c5bde]",children:p})]}),(0,Ot.jsxs)("div",{children:[(0,Ot.jsx)("p",{className:"text-sm text-gray-600",children:"Active Listings"}),(0,Ot.jsx)("p",{className:"text-2xl font-bold text-[#1c5bde]",children:m})]})]})]})]}),u&&(0,Ot.jsx)("div",{className:"mt-6 bg-white p-6 rounded-xl shadow-sm",children:(0,Ot.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,Ot.jsxs)("div",{children:[(0,Ot.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Region"}),(0,Ot.jsxs)("select",{value:n,onChange:e=>r(e.target.value),className:"w-full p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-[#1c5bde]",children:[(0,Ot.jsx)("option",{value:"all",children:"All Regions"}),d.map((e=>(0,Ot.jsx)("option",{value:e,children:e},e)))]})]}),(0,Ot.jsxs)("div",{children:[(0,Ot.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Property Type"}),(0,Ot.jsxs)("select",{value:a,onChange:e=>s(e.target.value),className:"w-full p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-[#1c5bde]",children:[(0,Ot.jsx)("option",{value:"all",children:"All Types"}),(0,Ot.jsx)("option",{value:"residential",children:"Residential"}),(0,Ot.jsx)("option",{value:"commercial",children:"Commercial"}),(0,Ot.jsx)("option",{value:"land",children:"Land"})]})]}),(0,Ot.jsxs)("div",{children:[(0,Ot.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Price Range"}),(0,Ot.jsxs)("select",{className:"w-full p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-[#1c5bde]",children:[(0,Ot.jsx)("option",{value:"all",children:"All Prices"}),(0,Ot.jsx)("option",{value:"0-50m",children:"\u20a60 - \u20a650M"}),(0,Ot.jsx)("option",{value:"50m-100m",children:"\u20a650M - \u20a6100M"}),(0,Ot.jsx)("option",{value:"100m-plus",children:"\u20a6100M+"})]})]}),(0,Ot.jsxs)("div",{children:[(0,Ot.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Time Period"}),(0,Ot.jsxs)("select",{value:i,onChange:e=>o(e.target.value),className:"w-full p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-[#1c5bde]",children:[(0,Ot.jsx)("option",{value:"1m",children:"Last Month"}),(0,Ot.jsx)("option",{value:"3m",children:"Last 3 Months"}),(0,Ot.jsx)("option",{value:"6m",children:"Last 6 Months"}),(0,Ot.jsx)("option",{value:"1y",children:"Last Year"})]})]})]})})]})}),(0,Ot.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,Ot.jsxs)("section",{className:"bg-white rounded-xl shadow-sm p-6 mb-8",children:[(0,Ot.jsxs)("div",{className:"flex items-center gap-4 mb-6",children:[(0,Ot.jsx)("div",{className:"bg-[#1c5bde]/10 p-3 rounded-lg",children:(0,Ot.jsx)(kt,{className:"h-6 w-6 text-[#1c5bde]"})}),(0,Ot.jsx)("h2",{className:"text-2xl font-semibold",children:"Market Overview"})]}),(0,Ot.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[(0,Ot.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,Ot.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Average Price"}),(0,Ot.jsx)("p",{className:"text-3xl font-bold text-[#1c5bde]",children:p}),(0,Ot.jsxs)("p",{className:"text-green-600 text-sm",children:[f," from last month"]})]}),(0,Ot.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,Ot.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Properties Sold"}),(0,Ot.jsx)("p",{className:"text-3xl font-bold text-[#1c5bde]",children:m}),(0,Ot.jsxs)("p",{className:"text-green-600 text-sm",children:[g," from last month"]})]}),(0,Ot.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,Ot.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Days on Market"}),(0,Ot.jsx)("p",{className:"text-3xl font-bold text-[#1c5bde]",children:y}),(0,Ot.jsxs)("p",{className:"text-red-600 text-sm",children:[_," from last month"]})]})]})]}),(0,Ot.jsxs)("section",{className:"bg-white rounded-xl shadow-sm p-6 mb-8",children:[(0,Ot.jsx)("div",{className:"flex items-center justify-between mb-6",children:(0,Ot.jsxs)("div",{className:"flex items-center gap-4",children:[(0,Ot.jsx)("div",{className:"bg-[#1c5bde]/10 p-3 rounded-lg",children:(0,Ot.jsx)(AI,{className:"h-6 w-6 text-[#1c5bde]"})}),(0,Ot.jsx)("h2",{className:"text-2xl font-semibold",children:"Price Trends"})]})}),(0,Ot.jsx)("div",{className:"h-[400px]",children:(0,Ot.jsx)(zd,{width:"100%",height:"100%",children:(0,Ot.jsxs)(oI,{data:[{month:"Jan 2024",price:75e6,sales:150,demand:85},{month:"Feb 2024",price:78e6,sales:165,demand:88},{month:"Mar 2024",price:8e7,sales:180,demand:92},{month:"Apr 2024",price:82e6,sales:175,demand:90},{month:"May 2024",price:85e6,sales:190,demand:95},{month:"Jun 2024",price:87e6,sales:200,demand:98}],children:[(0,Ot.jsx)("defs",{children:(0,Ot.jsxs)("linearGradient",{id:"colorPrice",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,Ot.jsx)("stop",{offset:"5%",stopColor:"#1c5bde",stopOpacity:.8}),(0,Ot.jsx)("stop",{offset:"95%",stopColor:"#1c5bde",stopOpacity:0})]})}),(0,Ot.jsx)(WC,{dataKey:"month"}),(0,Ot.jsx)(ij,{}),(0,Ot.jsx)(SI,{strokeDasharray:"3 3"}),(0,Ot.jsx)(Fp,{}),(0,Ot.jsx)(iI,{type:"monotone",dataKey:"price",stroke:"#1c5bde",fillOpacity:1,fill:"url(#colorPrice)"}),(0,Ot.jsx)(iI,{type:"monotone",dataKey:"demand",stroke:"#4f46e5",fillOpacity:.3,fill:"#4f46e5"}),(0,Ot.jsx)(mm,{})]})})})]}),(0,Ot.jsxs)("section",{className:"bg-white rounded-xl shadow-sm p-6 mb-8",children:[(0,Ot.jsxs)("div",{className:"flex items-center gap-4 mb-6",children:[(0,Ot.jsx)("div",{className:"bg-[#1c5bde]/10 p-3 rounded-lg",children:(0,Ot.jsx)(uu,{className:"h-6 w-6 text-[#1c5bde]"})}),(0,Ot.jsx)("h2",{className:"text-2xl font-semibold",children:"Regional Analysis"})]}),(0,Ot.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,Ot.jsx)("div",{className:"col-span-2",children:(0,Ot.jsx)(KI,{})}),(0,Ot.jsxs)("div",{className:"space-y-4",children:[(0,Ot.jsx)("h3",{className:"text-lg font-semibold",children:"Key Regions in Abuja"}),(0,Ot.jsx)("ul",{className:"space-y-2",children:d.map((e=>(0,Ot.jsxs)("li",{className:"flex items-center gap-2",children:[(0,Ot.jsx)(cu,{className:"h-4 w-4 text-[#1c5bde]"}),(0,Ot.jsx)("span",{children:e})]},e)))})]})]})]}),(0,Ot.jsxs)("section",{className:"bg-white rounded-xl shadow-sm p-6 mb-8",children:[(0,Ot.jsxs)("div",{className:"flex items-center gap-4 mb-6",children:[(0,Ot.jsx)("div",{className:"bg-[#1c5bde]/10 p-3 rounded-lg",children:(0,Ot.jsx)(AI,{className:"h-6 w-6 text-[#1c5bde]"})}),(0,Ot.jsx)("h2",{className:"text-2xl font-semibold",children:"Economic Indicators"})]}),(0,Ot.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,Ot.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,Ot.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Interest Rates"}),(0,Ot.jsx)("p",{className:"text-3xl font-bold text-[#1c5bde]",children:"13.5%"}),(0,Ot.jsx)("p",{className:"text-gray-600",children:"Stable interest rates supporting market growth"})]}),(0,Ot.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,Ot.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Inflation Rate"}),(0,Ot.jsx)("p",{className:"text-3xl font-bold text-[#1c5bde]",children:"11.1%"}),(0,Ot.jsx)("p",{className:"text-gray-600",children:"Moderate inflation impacting purchasing power"})]})]})]}),(0,Ot.jsxs)("section",{className:"bg-white rounded-xl shadow-sm p-6 mb-8",children:[(0,Ot.jsxs)("div",{className:"flex items-center gap-4 mb-6",children:[(0,Ot.jsx)("div",{className:"bg-[#1c5bde]/10 p-3 rounded-lg",children:(0,Ot.jsx)(MI,{className:"h-6 w-6 text-[#1c5bde]"})}),(0,Ot.jsx)("h2",{className:"text-2xl font-semibold",children:"Expert Opinions"})]}),(0,Ot.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[{name:"Chinedu Okeke",role:"Real Estate Analyst",image:"/images/experts/chinedu.jpg",quote:"The Abuja market is showing resilience with a steady increase in demand for residential properties, particularly in the suburbs."},{name:"Ngozi Nwosu",role:"Property Economist",image:"/images/experts/ngozi.jpg",quote:"With stable interest rates, the market is favorable for both buyers and investors looking to capitalize on growth opportunities."}].map((e=>(0,Ot.jsxs)("div",{className:"bg-gray-50 rounded-lg p-6 hover:shadow-md transition-shadow",children:[(0,Ot.jsxs)("div",{className:"flex items-center gap-4 mb-4",children:[(0,Ot.jsx)("div",{className:"relative w-16 h-16",children:(0,Ot.jsx)("div",{className:"w-full h-full rounded-full overflow-hidden bg-[#1c5bde]/10 flex items-center justify-center",children:e.image?(0,Ot.jsxs)(Ot.Fragment,{children:[(0,Ot.jsx)("img",{src:e.image,alt:e.name,className:"w-full h-full object-cover",onError:e=>{e.target.style.display="none",e.target.nextSibling.style.display="flex"}}),(0,Ot.jsx)("div",{className:"absolute inset-0 hidden items-center justify-center",style:{backgroundColor:"rgba(14, 16, 159, 0.1)"},children:(0,Ot.jsx)(Ah,{className:"w-8 h-8 text-[#1c5bde]"})})]}):(0,Ot.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,Ot.jsx)(Ah,{className:"w-8 h-8 text-[#1c5bde]"})})})}),(0,Ot.jsxs)("div",{children:[(0,Ot.jsx)("h3",{className:"font-semibold text-lg",children:e.name}),(0,Ot.jsx)("p",{className:"text-sm text-gray-600",children:e.role})]})]}),(0,Ot.jsx)("div",{className:"pl-20",children:(0,Ot.jsxs)("p",{className:"text-gray-600 italic",children:['"',e.quote,'"']})})]},e.name)))})]}),(0,Ot.jsxs)("section",{className:"bg-white rounded-xl shadow-sm p-6 mb-8",children:[(0,Ot.jsxs)("div",{className:"flex items-center gap-4 mb-6",children:[(0,Ot.jsx)("div",{className:"bg-[#1c5bde]/10 p-3 rounded-lg",children:(0,Ot.jsx)(PI,{className:"h-6 w-6 text-[#1c5bde]"})}),(0,Ot.jsx)("h2",{className:"text-2xl font-semibold",children:"News and Updates"})]}),(0,Ot.jsxs)("div",{className:"space-y-4",children:[(0,Ot.jsxs)("div",{className:"border-b pb-4",children:[(0,Ot.jsx)("h3",{className:"font-semibold mb-2",children:"New Housing Policy Announced"}),(0,Ot.jsx)("p",{className:"text-gray-600 mb-2",children:"The Nigerian government has announced new initiatives to support first-time homebuyers in Abuja."}),(0,Ot.jsx)("p",{className:"text-sm text-gray-400",children:"2 hours ago"})]}),(0,Ot.jsxs)("div",{className:"border-b pb-4",children:[(0,Ot.jsx)("h3",{className:"font-semibold mb-2",children:"Market Growth Continues"}),(0,Ot.jsx)("p",{className:"text-gray-600 mb-2",children:"The Abuja real estate market shows resilience with continued price appreciation and demand."}),(0,Ot.jsx)("p",{className:"text-sm text-gray-400",children:"1 day ago"})]}),(0,Ot.jsxs)("div",{className:"pb-4",children:[(0,Ot.jsx)("h3",{className:"font-semibold mb-2",children:"New Development Projects"}),(0,Ot.jsx)("p",{className:"text-gray-600 mb-2",children:"Major development projects have been announced in growing suburban areas of Abuja."}),(0,Ot.jsx)("p",{className:"text-sm text-gray-400",children:"2 days ago"})]})]})]}),(0,Ot.jsxs)("section",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,Ot.jsxs)("div",{className:"flex items-center gap-4 mb-6",children:[(0,Ot.jsx)("div",{className:"bg-[#1c5bde]/10 p-3 rounded-lg",children:(0,Ot.jsx)(kI,{className:"h-6 w-6 text-[#1c5bde]"})}),(0,Ot.jsx)("h2",{className:"text-2xl font-semibold",children:"Tools and Calculators"})]}),(0,Ot.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,Ot.jsxs)("div",{className:"bg-gray-50 rounded-lg p-6 text-center",children:[(0,Ot.jsx)("h3",{className:"font-semibold mb-4",children:"Mortgage Calculator"}),(0,Ot.jsx)("button",{onClick:()=>e("/mortgage-calculator"),className:"bg-[#1c5bde] text-white px-6 py-2 rounded-lg hover:bg-[#0c0d8a] transition-colors",children:"Calculate Now"})]}),(0,Ot.jsxs)("div",{className:"bg-gray-50 rounded-lg p-6 text-center",children:[(0,Ot.jsx)("h3",{className:"font-semibold mb-4",children:"Investment ROI Calculator"}),(0,Ot.jsx)("button",{onClick:()=>e("/roi-calculator"),className:"bg-[#1c5bde] text-white px-6 py-2 rounded-lg hover:bg-[#0c0d8a] transition-colors",children:"Calculate ROI"})]}),(0,Ot.jsxs)("div",{className:"bg-gray-50 rounded-lg p-6 text-center",children:[(0,Ot.jsx)("h3",{className:"font-semibold mb-4",children:"Affordability Calculator"}),(0,Ot.jsx)("button",{onClick:()=>e("/affordability-calculator"),className:"bg-[#1c5bde] text-white px-6 py-2 rounded-lg hover:bg-[#0c0d8a] transition-colors",children:"Check Affordability"})]})]})]})]})]})},QI=Et("Percent",[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]),$I=Et("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),eO=Et("ChartPie",[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]]),tO=Et("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);function nO(e,t){let[n,r]=t;return Math.min(r,Math.max(n,e))}function rO(e,t){let{checkForDefaultPrevented:n=!0}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return function(r){if(null===e||void 0===e||e(r),!1===n||!r.defaultPrevented)return null===t||void 0===t?void 0:t(r)}}function iO(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return e=>t.forEach((t=>function(e,t){"function"===typeof e?e(t):null!==e&&void 0!==e&&(e.current=t)}(t,e)))}function oO(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.useCallback(iO(...n),n)}const aO=["scope","children"];function sO(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];const i=n[0];if(1===n.length)return i;const o=()=>{const e=n.map((e=>({useScope:e(),scopeName:e.scopeName})));return function(n){const r=e.reduce(((e,t)=>{let{useScope:r,scopeName:i}=t;const o=r(n)["__scope".concat(i)];return c(c({},e),o)}),{});return t.useMemo((()=>({["__scope".concat(i.scopeName)]:r})),[r])}};return o.scopeName=i.scopeName,o}function lO(e){const n=t.useRef(e);return t.useEffect((()=>{n.current=e})),t.useMemo((()=>function(){for(var e,t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return null===(e=n.current)||void 0===e?void 0:e.call(n,...r)}),[])}function cO(e){let{prop:n,defaultProp:r,onChange:i=()=>{}}=e;const[o,a]=function(e){let{defaultProp:n,onChange:r}=e;const i=t.useState(n),[o]=i,a=t.useRef(o),s=lO(r);return t.useEffect((()=>{a.current!==o&&(s(o),a.current=o)}),[o,a,s]),i}({defaultProp:r,onChange:i}),s=void 0!==n,l=s?n:o,c=lO(i);return[l,t.useCallback((e=>{if(s){const t="function"===typeof e?e(n):e;t!==n&&c(t)}else a(e)}),[s,n,a,c])]}var uO=t.createContext(void 0);var hO=Boolean(null===globalThis||void 0===globalThis?void 0:globalThis.document)?t.useLayoutEffect:()=>{};const dO=["children"],pO=["children"];var fO=t.forwardRef(((e,n)=>{const{children:r}=e,o=i(e,dO),a=t.Children.toArray(r),s=a.find(yO);if(s){const e=s.props.children,r=a.map((n=>n===s?t.Children.count(e)>1?t.Children.only(null):t.isValidElement(e)?e.props.children:null:n));return(0,Ot.jsx)(mO,c(c({},o),{},{ref:n,children:t.isValidElement(e)?t.cloneElement(e,void 0,r):null}))}return(0,Ot.jsx)(mO,c(c({},o),{},{ref:n,children:r}))}));fO.displayName="Slot";var mO=t.forwardRef(((e,n)=>{const{children:r}=e,o=i(e,pO);if(t.isValidElement(r)){const e=function(e){var t,n;let r=null===(t=Object.getOwnPropertyDescriptor(e.props,"ref"))||void 0===t?void 0:t.get,i=r&&"isReactWarning"in r&&r.isReactWarning;if(i)return e.ref;if(r=null===(n=Object.getOwnPropertyDescriptor(e,"ref"))||void 0===n?void 0:n.get,i=r&&"isReactWarning"in r&&r.isReactWarning,i)return e.props.ref;return e.props.ref||e.ref}(r);return t.cloneElement(r,c(c({},function(e,t){const n=c({},t);for(const r in t){const i=e[r],o=t[r];/^on[A-Z]/.test(r)?i&&o?n[r]=function(){o(...arguments),i(...arguments)}:i&&(n[r]=i):"style"===r?n[r]=c(c({},i),o):"className"===r&&(n[r]=[i,o].filter(Boolean).join(" "))}return c(c({},e),n)}(o,r.props)),{},{ref:n?iO(n,e):e}))}return t.Children.count(r)>1?t.Children.only(null):null}));mO.displayName="SlotClone";var gO=e=>{let{children:t}=e;return(0,Ot.jsx)(Ot.Fragment,{children:t})};function yO(e){return t.isValidElement(e)&&e.type===gO}const _O=["asChild"];var vO=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"].reduce(((e,n)=>{const r=t.forwardRef(((e,t)=>{const{asChild:r}=e,o=i(e,_O),a=r?fO:n;return"undefined"!==typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,Ot.jsx)(a,c(c({},o),{},{ref:t}))}));return r.displayName="Primitive.".concat(n),c(c({},e),{},{[n]:r})}),{});const xO=["scope","children"];function bO(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];const i=n[0];if(1===n.length)return i;const o=()=>{const e=n.map((e=>({useScope:e(),scopeName:e.scopeName})));return function(n){const r=e.reduce(((e,t)=>{let{useScope:r,scopeName:i}=t;const o=r(n)["__scope".concat(i)];return c(c({},e),o)}),{});return t.useMemo((()=>({["__scope".concat(i.scopeName)]:r})),[r])}};return o.scopeName=i.scopeName,o}const wO=["children"],SO=["children"];var TO=t.forwardRef(((e,n)=>{const{children:r}=e,o=i(e,wO),a=t.Children.toArray(r),s=a.find(MO);if(s){const e=s.props.children,r=a.map((n=>n===s?t.Children.count(e)>1?t.Children.only(null):t.isValidElement(e)?e.props.children:null:n));return(0,Ot.jsx)(EO,c(c({},o),{},{ref:n,children:t.isValidElement(e)?t.cloneElement(e,void 0,r):null}))}return(0,Ot.jsx)(EO,c(c({},o),{},{ref:n,children:r}))}));TO.displayName="Slot";var EO=t.forwardRef(((e,n)=>{const{children:r}=e,o=i(e,SO);if(t.isValidElement(r)){const e=function(e){var t,n;let r=null===(t=Object.getOwnPropertyDescriptor(e.props,"ref"))||void 0===t?void 0:t.get,i=r&&"isReactWarning"in r&&r.isReactWarning;if(i)return e.ref;if(r=null===(n=Object.getOwnPropertyDescriptor(e,"ref"))||void 0===n?void 0:n.get,i=r&&"isReactWarning"in r&&r.isReactWarning,i)return e.props.ref;return e.props.ref||e.ref}(r);return t.cloneElement(r,c(c({},function(e,t){const n=c({},t);for(const r in t){const i=e[r],o=t[r];/^on[A-Z]/.test(r)?i&&o?n[r]=function(){o(...arguments),i(...arguments)}:i&&(n[r]=i):"style"===r?n[r]=c(c({},i),o):"className"===r&&(n[r]=[i,o].filter(Boolean).join(" "))}return c(c({},e),n)}(o,r.props)),{},{ref:n?iO(n,e):e}))}return t.Children.count(r)>1?t.Children.only(null):null}));EO.displayName="SlotClone";var AO=e=>{let{children:t}=e;return(0,Ot.jsx)(Ot.Fragment,{children:t})};function MO(e){return t.isValidElement(e)&&e.type===AO}const PO=["scope","children"];const kO=["name","min","max","step","orientation","disabled","minStepsBetweenThumbs","defaultValue","value","onValueChange","onValueCommit","inverted","form"],CO=["min","max","dir","inverted","onSlideStart","onSlideMove","onSlideEnd","onStepKeyDown"],jO=["min","max","inverted","onSlideStart","onSlideMove","onSlideEnd","onStepKeyDown"],IO=["__scopeSlider","onSlideStart","onSlideMove","onSlideEnd","onHomeKeyDown","onEndKeyDown","onStepKeyDown"],OO=["__scopeSlider"],NO=["__scopeSlider"],DO=["__scopeSlider","index","name"],LO=["value"];var zO=["PageUp","PageDown"],RO=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],FO={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},BO="Slider",[VO,UO,GO]=function(e){const n=e+"CollectionProvider",[r,o]=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=[];const o=()=>{const n=r.map((e=>t.createContext(e)));return function(r){const i=(null===r||void 0===r?void 0:r[e])||n;return t.useMemo((()=>({["__scope".concat(e)]:c(c({},r),{},{[e]:i})})),[r,i])}};return o.scopeName=e,[function(n,o){const a=t.createContext(o),s=r.length;function l(n){const{scope:r,children:o}=n,l=i(n,xO),c=(null===r||void 0===r?void 0:r[e][s])||a,u=t.useMemo((()=>l),Object.values(l));return(0,Ot.jsx)(c.Provider,{value:u,children:o})}return r=[...r,o],l.displayName=n+"Provider",[l,function(r,i){const l=(null===i||void 0===i?void 0:i[e][s])||a,c=t.useContext(l);if(c)return c;if(void 0!==o)return o;throw new Error("`".concat(r,"` must be used within `").concat(n,"`"))}]},bO(o,...n)]}(n),[a,s]=r(n,{collectionRef:{current:null},itemMap:new Map}),l=e=>{const{scope:n,children:r}=e,i=t.useRef(null),o=t.useRef(new Map).current;return(0,Ot.jsx)(a,{scope:n,itemMap:o,collectionRef:i,children:r})};l.displayName=n;const u=e+"CollectionSlot",h=t.forwardRef(((e,t)=>{const{scope:n,children:r}=e,i=oO(t,s(u,n).collectionRef);return(0,Ot.jsx)(TO,{ref:i,children:r})}));h.displayName=u;const d=e+"CollectionItemSlot",p="data-radix-collection-item",f=t.forwardRef(((e,n)=>{const{scope:r,children:o}=e,a=i(e,PO),l=t.useRef(null),u=oO(n,l),h=s(d,r);return t.useEffect((()=>(h.itemMap.set(l,c({ref:l},a)),()=>{h.itemMap.delete(l)}))),(0,Ot.jsx)(TO,c(c({},{[p]:""}),{},{ref:u,children:o}))}));return f.displayName=d,[{Provider:l,Slot:h,ItemSlot:f},function(n){const r=s(e+"CollectionConsumer",n),i=t.useCallback((()=>{const e=r.collectionRef.current;if(!e)return[];const t=Array.from(e.querySelectorAll("[".concat(p,"]"))),n=Array.from(r.itemMap.values()).sort(((e,n)=>t.indexOf(e.ref.current)-t.indexOf(n.ref.current)));return n}),[r.collectionRef,r.itemMap]);return i},o]}(BO),[HO,ZO]=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=[];const o=()=>{const n=r.map((e=>t.createContext(e)));return function(r){const i=(null===r||void 0===r?void 0:r[e])||n;return t.useMemo((()=>({["__scope".concat(e)]:c(c({},r),{},{[e]:i})})),[r,i])}};return o.scopeName=e,[function(n,o){const a=t.createContext(o),s=r.length;r=[...r,o];const l=n=>{var r;const{scope:o,children:l}=n,c=i(n,aO),u=(null===o||void 0===o||null===(r=o[e])||void 0===r?void 0:r[s])||a,h=t.useMemo((()=>c),Object.values(c));return(0,Ot.jsx)(u.Provider,{value:h,children:l})};return l.displayName=n+"Provider",[l,function(r,i){var l;const c=(null===i||void 0===i||null===(l=i[e])||void 0===l?void 0:l[s])||a,u=t.useContext(c);if(u)return u;if(void 0!==o)return o;throw new Error("`".concat(r,"` must be used within `").concat(n,"`"))}]},sO(o,...n)]}(BO,[GO]),[qO,WO]=HO(BO),XO=t.forwardRef(((e,n)=>{const{name:r,min:o=0,max:a=100,step:s=1,orientation:l="horizontal",disabled:u=!1,minStepsBetweenThumbs:h=0,defaultValue:d=[o],value:p,onValueChange:f=()=>{},onValueCommit:m=()=>{},inverted:g=!1,form:y}=e,_=i(e,kO),v=t.useRef(new Set),x=t.useRef(0),b="horizontal"===l?JO:QO,[w=[],S]=cO({prop:p,defaultProp:d,onChange:e=>{var t;null===(t=[...v.current][x.current])||void 0===t||t.focus(),f(e)}}),T=t.useRef(w);function E(e,t){let{commit:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{commit:!1};const r=function(e){return(String(e).split(".")[1]||"").length}(s),i=function(e,t){const n=Math.pow(10,t);return Math.round(e*n)/n}(Math.round((e-o)/s)*s+o,r),l=nO(i,[o,a]);S((function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const r=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;const r=[...e];return r[n]=t,r.sort(((e,t)=>e-t))}(e,l,t);if(function(e,t){if(t>0){const n=function(e){return e.slice(0,-1).map(((t,n)=>e[n+1]-t))}(e);return Math.min(...n)>=t}return!0}(r,h*s)){x.current=r.indexOf(l);const t=String(r)!==String(e);return t&&n&&m(r),t?r:e}return e}))}return(0,Ot.jsx)(qO,{scope:e.__scopeSlider,name:r,disabled:u,min:o,max:a,valueIndexToChangeRef:x,thumbs:v.current,values:w,orientation:l,form:y,children:(0,Ot.jsx)(VO.Provider,{scope:e.__scopeSlider,children:(0,Ot.jsx)(VO.Slot,{scope:e.__scopeSlider,children:(0,Ot.jsx)(b,c(c({"aria-disabled":u,"data-disabled":u?"":void 0},_),{},{ref:n,onPointerDown:rO(_.onPointerDown,(()=>{u||(T.current=w)})),min:o,max:a,inverted:g,onSlideStart:u?void 0:function(e){const t=function(e,t){if(1===e.length)return 0;const n=e.map((e=>Math.abs(e-t))),r=Math.min(...n);return n.indexOf(r)}(w,e);E(e,t)},onSlideMove:u?void 0:function(e){E(e,x.current)},onSlideEnd:u?void 0:function(){const e=T.current[x.current];w[x.current]!==e&&m(w)},onHomeKeyDown:()=>!u&&E(o,0,{commit:!0}),onEndKeyDown:()=>!u&&E(a,w.length-1,{commit:!0}),onStepKeyDown:e=>{let{event:t,direction:n}=e;if(!u){const e=zO.includes(t.key)||t.shiftKey&&RO.includes(t.key)?10:1,r=x.current;E(w[r]+s*e*n,r,{commit:!0})}}}))})})})}));XO.displayName=BO;var[YO,KO]=HO(BO,{startEdge:"left",endEdge:"right",size:"width",direction:1}),JO=t.forwardRef(((e,n)=>{const{min:r,max:o,dir:a,inverted:s,onSlideStart:l,onSlideMove:u,onSlideEnd:h,onStepKeyDown:d}=e,p=i(e,CO),[f,m]=t.useState(null),g=oO(n,(e=>m(e))),y=t.useRef(),_=function(e){const n=t.useContext(uO);return e||n||"ltr"}(a),v="ltr"===_,x=v&&!s||!v&&s;function b(e){const t=y.current||f.getBoundingClientRect(),n=cN([0,t.width],x?[r,o]:[o,r]);return y.current=t,n(e-t.left)}return(0,Ot.jsx)(YO,{scope:e.__scopeSlider,startEdge:x?"left":"right",endEdge:x?"right":"left",direction:x?1:-1,size:"width",children:(0,Ot.jsx)($O,c(c({dir:_,"data-orientation":"horizontal"},p),{},{ref:g,style:c(c({},p.style),{},{"--radix-slider-thumb-transform":"translateX(-50%)"}),onSlideStart:e=>{const t=b(e.clientX);null===l||void 0===l||l(t)},onSlideMove:e=>{const t=b(e.clientX);null===u||void 0===u||u(t)},onSlideEnd:()=>{y.current=void 0,null===h||void 0===h||h()},onStepKeyDown:e=>{const t=FO[x?"from-left":"from-right"].includes(e.key);null===d||void 0===d||d({event:e,direction:t?-1:1})}}))})})),QO=t.forwardRef(((e,n)=>{const{min:r,max:o,inverted:a,onSlideStart:s,onSlideMove:l,onSlideEnd:u,onStepKeyDown:h}=e,d=i(e,jO),p=t.useRef(null),f=oO(n,p),m=t.useRef(),g=!a;function y(e){const t=m.current||p.current.getBoundingClientRect(),n=cN([0,t.height],g?[o,r]:[r,o]);return m.current=t,n(e-t.top)}return(0,Ot.jsx)(YO,{scope:e.__scopeSlider,startEdge:g?"bottom":"top",endEdge:g?"top":"bottom",size:"height",direction:g?1:-1,children:(0,Ot.jsx)($O,c(c({"data-orientation":"vertical"},d),{},{ref:f,style:c(c({},d.style),{},{"--radix-slider-thumb-transform":"translateY(50%)"}),onSlideStart:e=>{const t=y(e.clientY);null===s||void 0===s||s(t)},onSlideMove:e=>{const t=y(e.clientY);null===l||void 0===l||l(t)},onSlideEnd:()=>{m.current=void 0,null===u||void 0===u||u()},onStepKeyDown:e=>{const t=FO[g?"from-bottom":"from-top"].includes(e.key);null===h||void 0===h||h({event:e,direction:t?-1:1})}}))})})),$O=t.forwardRef(((e,t)=>{const{__scopeSlider:n,onSlideStart:r,onSlideMove:o,onSlideEnd:a,onHomeKeyDown:s,onEndKeyDown:l,onStepKeyDown:u}=e,h=i(e,IO),d=WO(BO,n);return(0,Ot.jsx)(vO.span,c(c({},h),{},{ref:t,onKeyDown:rO(e.onKeyDown,(e=>{"Home"===e.key?(s(e),e.preventDefault()):"End"===e.key?(l(e),e.preventDefault()):zO.concat(RO).includes(e.key)&&(u(e),e.preventDefault())})),onPointerDown:rO(e.onPointerDown,(e=>{const t=e.target;t.setPointerCapture(e.pointerId),e.preventDefault(),d.thumbs.has(t)?t.focus():r(e)})),onPointerMove:rO(e.onPointerMove,(e=>{e.target.hasPointerCapture(e.pointerId)&&o(e)})),onPointerUp:rO(e.onPointerUp,(e=>{const t=e.target;t.hasPointerCapture(e.pointerId)&&(t.releasePointerCapture(e.pointerId),a(e))}))}))})),eN="SliderTrack",tN=t.forwardRef(((e,t)=>{const{__scopeSlider:n}=e,r=i(e,OO),o=WO(eN,n);return(0,Ot.jsx)(vO.span,c(c({"data-disabled":o.disabled?"":void 0,"data-orientation":o.orientation},r),{},{ref:t}))}));tN.displayName=eN;var nN="SliderRange",rN=t.forwardRef(((e,n)=>{const{__scopeSlider:r}=e,o=i(e,NO),a=WO(nN,r),s=KO(nN,r),l=oO(n,t.useRef(null)),u=a.values.length,h=a.values.map((e=>lN(e,a.min,a.max))),d=u>1?Math.min(...h):0,p=100-Math.max(...h);return(0,Ot.jsx)(vO.span,c(c({"data-orientation":a.orientation,"data-disabled":a.disabled?"":void 0},o),{},{ref:l,style:c(c({},e.style),{},{[s.startEdge]:d+"%",[s.endEdge]:p+"%"})}))}));rN.displayName=nN;var iN="SliderThumb",oN=t.forwardRef(((e,n)=>{const r=UO(e.__scopeSlider),[i,o]=t.useState(null),a=oO(n,(e=>o(e))),s=t.useMemo((()=>i?r().findIndex((e=>e.ref.current===i)):-1),[r,i]);return(0,Ot.jsx)(aN,c(c({},e),{},{ref:a,index:s}))})),aN=t.forwardRef(((e,n)=>{const{__scopeSlider:r,index:o,name:a}=e,s=i(e,DO),l=WO(iN,r),u=KO(iN,r),[h,d]=t.useState(null),p=oO(n,(e=>d(e))),f=!h||(l.form||!!h.closest("form")),m=function(e){const[n,r]=t.useState(void 0);return hO((()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});const t=new ResizeObserver((t=>{if(!Array.isArray(t))return;if(!t.length)return;const n=t[0];let i,o;if("borderBoxSize"in n){const e=n.borderBoxSize,t=Array.isArray(e)?e[0]:e;i=t.inlineSize,o=t.blockSize}else i=e.offsetWidth,o=e.offsetHeight;r({width:i,height:o})}));return t.observe(e,{box:"border-box"}),()=>t.unobserve(e)}r(void 0)}),[e]),n}(h),g=l.values[o],y=void 0===g?0:lN(g,l.min,l.max),_=function(e,t){return t>2?"Value ".concat(e+1," of ").concat(t):2===t?["Minimum","Maximum"][e]:void 0}(o,l.values.length),v=null===m||void 0===m?void 0:m[u.size],x=v?function(e,t,n){const r=e/2,i=cN([0,50],[0,r]);return(r-i(t)*n)*n}(v,y,u.direction):0;return t.useEffect((()=>{if(h)return l.thumbs.add(h),()=>{l.thumbs.delete(h)}}),[h,l.thumbs]),(0,Ot.jsxs)("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[u.startEdge]:"calc(".concat(y,"% + ").concat(x,"px)")},children:[(0,Ot.jsx)(VO.ItemSlot,{scope:e.__scopeSlider,children:(0,Ot.jsx)(vO.span,c(c({role:"slider","aria-label":e["aria-label"]||_,"aria-valuemin":l.min,"aria-valuenow":g,"aria-valuemax":l.max,"aria-orientation":l.orientation,"data-orientation":l.orientation,"data-disabled":l.disabled?"":void 0,tabIndex:l.disabled?void 0:0},s),{},{ref:p,style:void 0===g?{display:"none"}:e.style,onFocus:rO(e.onFocus,(()=>{l.valueIndexToChangeRef.current=o}))}))}),f&&(0,Ot.jsx)(sN,{name:null!==a&&void 0!==a?a:l.name?l.name+(l.values.length>1?"[]":""):void 0,form:l.form,value:g},o)]})}));oN.displayName=iN;var sN=e=>{const{value:n}=e,r=i(e,LO),o=t.useRef(null),a=function(e){const n=t.useRef({value:e,previous:e});return t.useMemo((()=>(n.current.value!==e&&(n.current.previous=n.current.value,n.current.value=e),n.current.previous)),[e])}(n);return t.useEffect((()=>{const e=o.current,t=window.HTMLInputElement.prototype,r=Object.getOwnPropertyDescriptor(t,"value").set;if(a!==n&&r){const t=new Event("input",{bubbles:!0});r.call(e,n),e.dispatchEvent(t)}}),[a,n]),(0,Ot.jsx)("input",c(c({style:{display:"none"}},r),{},{ref:o,defaultValue:n}))};function lN(e,t,n){return nO(100/(n-t)*(e-t),[0,100])}function cN(e,t){return n=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const r=(t[1]-t[0])/(e[1]-e[0]);return t[0]+r*(n-e[0])}}var uN=XO,hN=tN,dN=rN,pN=oN;const fN=(e,t)=>{var n;if(0===e.length)return t.classGroupId;const r=e[0],i=t.nextPart.get(r),o=i?fN(e.slice(1),i):void 0;if(o)return o;if(0===t.validators.length)return;const a=e.join("-");return null===(n=t.validators.find((e=>{let{validator:t}=e;return t(a)})))||void 0===n?void 0:n.classGroupId},mN=/^\[(.+)\]$/,gN=e=>{if(mN.test(e)){const t=mN.exec(e)[1],n=null===t||void 0===t?void 0:t.substring(0,t.indexOf(":"));if(n)return"arbitrary.."+n}},yN=e=>{const{theme:t,prefix:n}=e,r={nextPart:new Map,validators:[]};return bN(Object.entries(e.classGroups),n).forEach((e=>{let[n,i]=e;_N(i,r,n,t)})),r},_N=(e,t,n,r)=>{e.forEach((e=>{if("string"!==typeof e){if("function"===typeof e)return xN(e)?void _N(e(r),t,n,r):void t.validators.push({validator:e,classGroupId:n});Object.entries(e).forEach((e=>{let[i,o]=e;_N(o,vN(t,i),n,r)}))}else{(""===e?t:vN(t,e)).classGroupId=n}}))},vN=(e,t)=>{let n=e;return t.split("-").forEach((e=>{n.nextPart.has(e)||n.nextPart.set(e,{nextPart:new Map,validators:[]}),n=n.nextPart.get(e)})),n},xN=e=>e.isThemeGetter,bN=(e,t)=>t?e.map((e=>{let[n,r]=e;const i=r.map((e=>"string"===typeof e?t+e:"object"===typeof e?Object.fromEntries(Object.entries(e).map((e=>{let[n,r]=e;return[t+n,r]}))):e));return[n,i]})):e,wN=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,n=new Map,r=new Map;const i=(i,o)=>{n.set(i,o),t++,t>e&&(t=0,r=n,n=new Map)};return{get(e){let t=n.get(e);return void 0!==t?t:void 0!==(t=r.get(e))?(i(e,t),t):void 0},set(e,t){n.has(e)?n.set(e,t):i(e,t)}}},SN=e=>{const{separator:t,experimentalParseClassName:n}=e,r=1===t.length,i=t[0],o=t.length,a=e=>{const n=[];let a,s=0,l=0;for(let h=0;h<e.length;h++){let c=e[h];if(0===s){if(c===i&&(r||e.slice(h,h+o)===t)){n.push(e.slice(l,h)),l=h+o;continue}if("/"===c){a=h;continue}}"["===c?s++:"]"===c&&s--}const c=0===n.length?e:e.substring(l),u=c.startsWith("!");return{modifiers:n,hasImportantModifier:u,baseClassName:u?c.substring(1):c,maybePostfixModifierPosition:a&&a>l?a-l:void 0}};return n?e=>n({className:e,parseClassName:a}):a},TN=e=>{if(e.length<=1)return e;const t=[];let n=[];return e.forEach((e=>{"["===e[0]?(t.push(...n.sort(),e),n=[]):n.push(e)})),t.push(...n.sort()),t},EN=e=>c({cache:wN(e.cacheSize),parseClassName:SN(e)},(e=>{const t=yN(e),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=e;return{getClassGroupId:e=>{const n=e.split("-");return""===n[0]&&1!==n.length&&n.shift(),fN(n,t)||gN(e)},getConflictingClassGroupIds:(e,t)=>{const i=n[e]||[];return t&&r[e]?[...i,...r[e]]:i}}})(e)),AN=/\s+/;function MN(){let e,t,n=0,r="";for(;n<arguments.length;)(e=arguments[n++])&&(t=PN(e))&&(r&&(r+=" "),r+=t);return r}const PN=e=>{if("string"===typeof e)return e;let t,n="";for(let r=0;r<e.length;r++)e[r]&&(t=PN(e[r]))&&(n&&(n+=" "),n+=t);return n};function kN(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];let i,o,a,s=function(t){const r=n.reduce(((e,t)=>t(e)),e());return i=EN(r),o=i.cache.get,a=i.cache.set,s=l,l(t)};function l(e){const t=o(e);if(t)return t;const n=((e,t)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:i}=t,o=[],a=e.trim().split(AN);let s="";for(let l=a.length-1;l>=0;l-=1){const e=a[l],{modifiers:t,hasImportantModifier:c,baseClassName:u,maybePostfixModifierPosition:h}=n(e);let d=Boolean(h),p=r(d?u.substring(0,h):u);if(!p){if(!d){s=e+(s.length>0?" "+s:s);continue}if(p=r(u),!p){s=e+(s.length>0?" "+s:s);continue}d=!1}const f=TN(t).join(":"),m=c?f+"!":f,g=m+p;if(o.includes(g))continue;o.push(g);const y=i(p,d);for(let n=0;n<y.length;++n){const e=y[n];o.push(m+e)}s=e+(s.length>0?" "+s:s)}return s})(e,i);return a(e,n),n}return function(){return s(MN.apply(null,arguments))}}const CN=e=>{const t=t=>t[e]||[];return t.isThemeGetter=!0,t},jN=/^\[(?:([a-z-]+):)?(.+)\]$/i,IN=/^\d+\/\d+$/,ON=new Set(["px","full","screen"]),NN=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,DN=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,LN=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,zN=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,RN=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,FN=e=>VN(e)||ON.has(e)||IN.test(e),BN=e=>eD(e,"length",tD),VN=e=>Boolean(e)&&!Number.isNaN(Number(e)),UN=e=>eD(e,"number",VN),GN=e=>Boolean(e)&&Number.isInteger(Number(e)),HN=e=>e.endsWith("%")&&VN(e.slice(0,-1)),ZN=e=>jN.test(e),qN=e=>NN.test(e),WN=new Set(["length","size","percentage"]),XN=e=>eD(e,WN,nD),YN=e=>eD(e,"position",nD),KN=new Set(["image","url"]),JN=e=>eD(e,KN,iD),QN=e=>eD(e,"",rD),$N=()=>!0,eD=(e,t,n)=>{const r=jN.exec(e);return!!r&&(r[1]?"string"===typeof t?r[1]===t:t.has(r[1]):n(r[2]))},tD=e=>DN.test(e)&&!LN.test(e),nD=()=>!1,rD=e=>zN.test(e),iD=e=>RN.test(e),oD=(Symbol.toStringTag,()=>{const e=CN("colors"),t=CN("spacing"),n=CN("blur"),r=CN("brightness"),i=CN("borderColor"),o=CN("borderRadius"),a=CN("borderSpacing"),s=CN("borderWidth"),l=CN("contrast"),c=CN("grayscale"),u=CN("hueRotate"),h=CN("invert"),d=CN("gap"),p=CN("gradientColorStops"),f=CN("gradientColorStopPositions"),m=CN("inset"),g=CN("margin"),y=CN("opacity"),_=CN("padding"),v=CN("saturate"),x=CN("scale"),b=CN("sepia"),w=CN("skew"),S=CN("space"),T=CN("translate"),E=()=>["auto",ZN,t],A=()=>[ZN,t],M=()=>["",FN,BN],P=()=>["auto",VN,ZN],k=()=>["","0",ZN],C=()=>[VN,ZN];return{cacheSize:500,separator:":",theme:{colors:[$N],spacing:[FN,BN],blur:["none","",qN,ZN],brightness:C(),borderColor:[e],borderRadius:["none","","full",qN,ZN],borderSpacing:A(),borderWidth:M(),contrast:C(),grayscale:k(),hueRotate:C(),invert:k(),gap:A(),gradientColorStops:[e],gradientColorStopPositions:[HN,BN],inset:E(),margin:E(),opacity:C(),padding:A(),saturate:C(),scale:C(),sepia:k(),skew:C(),space:A(),translate:A()},classGroups:{aspect:[{aspect:["auto","square","video",ZN]}],container:["container"],columns:[{columns:[qN]}],"break-after":[{"break-after":["auto","avoid","all","avoid-page","page","left","right","column"]}],"break-before":[{"break-before":["auto","avoid","all","avoid-page","page","left","right","column"]}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top",ZN]}],overflow:[{overflow:["auto","hidden","clip","visible","scroll"]}],"overflow-x":[{"overflow-x":["auto","hidden","clip","visible","scroll"]}],"overflow-y":[{"overflow-y":["auto","hidden","clip","visible","scroll"]}],overscroll:[{overscroll:["auto","contain","none"]}],"overscroll-x":[{"overscroll-x":["auto","contain","none"]}],"overscroll-y":[{"overscroll-y":["auto","contain","none"]}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[m]}],"inset-x":[{"inset-x":[m]}],"inset-y":[{"inset-y":[m]}],start:[{start:[m]}],end:[{end:[m]}],top:[{top:[m]}],right:[{right:[m]}],bottom:[{bottom:[m]}],left:[{left:[m]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",GN,ZN]}],basis:[{basis:E()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",ZN]}],grow:[{grow:k()}],shrink:[{shrink:k()}],order:[{order:["first","last","none",GN,ZN]}],"grid-cols":[{"grid-cols":[$N]}],"col-start-end":[{col:["auto",{span:["full",GN,ZN]},ZN]}],"col-start":[{"col-start":P()}],"col-end":[{"col-end":P()}],"grid-rows":[{"grid-rows":[$N]}],"row-start-end":[{row:["auto",{span:[GN,ZN]},ZN]}],"row-start":[{"row-start":P()}],"row-end":[{"row-end":P()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",ZN]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",ZN]}],gap:[{gap:[d]}],"gap-x":[{"gap-x":[d]}],"gap-y":[{"gap-y":[d]}],"justify-content":[{justify:["normal","start","end","center","between","around","evenly","stretch"]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal","start","end","center","between","around","evenly","stretch","baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":["start","end","center","between","around","evenly","stretch","baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[_]}],px:[{px:[_]}],py:[{py:[_]}],ps:[{ps:[_]}],pe:[{pe:[_]}],pt:[{pt:[_]}],pr:[{pr:[_]}],pb:[{pb:[_]}],pl:[{pl:[_]}],m:[{m:[g]}],mx:[{mx:[g]}],my:[{my:[g]}],ms:[{ms:[g]}],me:[{me:[g]}],mt:[{mt:[g]}],mr:[{mr:[g]}],mb:[{mb:[g]}],ml:[{ml:[g]}],"space-x":[{"space-x":[S]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[S]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",ZN,t]}],"min-w":[{"min-w":[ZN,t,"min","max","fit"]}],"max-w":[{"max-w":[ZN,t,"none","full","min","max","fit","prose",{screen:[qN]},qN]}],h:[{h:[ZN,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[ZN,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[ZN,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[ZN,t,"auto","min","max","fit"]}],"font-size":[{text:["base",qN,BN]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",UN]}],"font-family":[{font:[$N]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",ZN]}],"line-clamp":[{"line-clamp":["none",VN,UN]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",FN,ZN]}],"list-image":[{"list-image":["none",ZN]}],"list-style-type":[{list:["none","disc","decimal",ZN]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[y]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[y]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:["solid","dashed","dotted","double","none","wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",FN,BN]}],"underline-offset":[{"underline-offset":["auto",FN,ZN]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:A()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",ZN]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",ZN]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[y]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top",YN]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",XN]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},JN]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[f]}],"gradient-via-pos":[{via:[f]}],"gradient-to-pos":[{to:[f]}],"gradient-from":[{from:[p]}],"gradient-via":[{via:[p]}],"gradient-to":[{to:[p]}],rounded:[{rounded:[o]}],"rounded-s":[{"rounded-s":[o]}],"rounded-e":[{"rounded-e":[o]}],"rounded-t":[{"rounded-t":[o]}],"rounded-r":[{"rounded-r":[o]}],"rounded-b":[{"rounded-b":[o]}],"rounded-l":[{"rounded-l":[o]}],"rounded-ss":[{"rounded-ss":[o]}],"rounded-se":[{"rounded-se":[o]}],"rounded-ee":[{"rounded-ee":[o]}],"rounded-es":[{"rounded-es":[o]}],"rounded-tl":[{"rounded-tl":[o]}],"rounded-tr":[{"rounded-tr":[o]}],"rounded-br":[{"rounded-br":[o]}],"rounded-bl":[{"rounded-bl":[o]}],"border-w":[{border:[s]}],"border-w-x":[{"border-x":[s]}],"border-w-y":[{"border-y":[s]}],"border-w-s":[{"border-s":[s]}],"border-w-e":[{"border-e":[s]}],"border-w-t":[{"border-t":[s]}],"border-w-r":[{"border-r":[s]}],"border-w-b":[{"border-b":[s]}],"border-w-l":[{"border-l":[s]}],"border-opacity":[{"border-opacity":[y]}],"border-style":[{border:["solid","dashed","dotted","double","none","hidden"]}],"divide-x":[{"divide-x":[s]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[s]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[y]}],"divide-style":[{divide:["solid","dashed","dotted","double","none"]}],"border-color":[{border:[i]}],"border-color-x":[{"border-x":[i]}],"border-color-y":[{"border-y":[i]}],"border-color-s":[{"border-s":[i]}],"border-color-e":[{"border-e":[i]}],"border-color-t":[{"border-t":[i]}],"border-color-r":[{"border-r":[i]}],"border-color-b":[{"border-b":[i]}],"border-color-l":[{"border-l":[i]}],"divide-color":[{divide:[i]}],"outline-style":[{outline:["","solid","dashed","dotted","double","none"]}],"outline-offset":[{"outline-offset":[FN,ZN]}],"outline-w":[{outline:[FN,BN]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:M()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[y]}],"ring-offset-w":[{"ring-offset":[FN,BN]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",qN,QN]}],"shadow-color":[{shadow:[$N]}],opacity:[{opacity:[y]}],"mix-blend":[{"mix-blend":["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"]}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[r]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",qN,ZN]}],grayscale:[{grayscale:[c]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[h]}],saturate:[{saturate:[v]}],sepia:[{sepia:[b]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[c]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[h]}],"backdrop-opacity":[{"backdrop-opacity":[y]}],"backdrop-saturate":[{"backdrop-saturate":[v]}],"backdrop-sepia":[{"backdrop-sepia":[b]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[a]}],"border-spacing-x":[{"border-spacing-x":[a]}],"border-spacing-y":[{"border-spacing-y":[a]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",ZN]}],duration:[{duration:C()}],ease:[{ease:["linear","in","out","in-out",ZN]}],delay:[{delay:C()}],animate:[{animate:["none","spin","ping","pulse","bounce",ZN]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[x]}],"scale-x":[{"scale-x":[x]}],"scale-y":[{"scale-y":[x]}],rotate:[{rotate:[GN,ZN]}],"translate-x":[{"translate-x":[T]}],"translate-y":[{"translate-y":[T]}],"skew-x":[{"skew-x":[w]}],"skew-y":[{"skew-y":[w]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",ZN]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",ZN]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":A()}],"scroll-mx":[{"scroll-mx":A()}],"scroll-my":[{"scroll-my":A()}],"scroll-ms":[{"scroll-ms":A()}],"scroll-me":[{"scroll-me":A()}],"scroll-mt":[{"scroll-mt":A()}],"scroll-mr":[{"scroll-mr":A()}],"scroll-mb":[{"scroll-mb":A()}],"scroll-ml":[{"scroll-ml":A()}],"scroll-p":[{"scroll-p":A()}],"scroll-px":[{"scroll-px":A()}],"scroll-py":[{"scroll-py":A()}],"scroll-ps":[{"scroll-ps":A()}],"scroll-pe":[{"scroll-pe":A()}],"scroll-pt":[{"scroll-pt":A()}],"scroll-pr":[{"scroll-pr":A()}],"scroll-pb":[{"scroll-pb":A()}],"scroll-pl":[{"scroll-pl":A()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",ZN]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[FN,BN,UN]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}}),aD=kN(oD);function sD(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return aD(Ph(t))}const lD=["className"],cD=t.forwardRef(((e,t)=>{let{className:n}=e,r=i(e,lD);return(0,Ot.jsxs)(uN,c(c({ref:t,className:sD("relative flex w-full touch-none select-none items-center",n)},r),{},{children:[(0,Ot.jsx)(hN,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-gray-100",children:(0,Ot.jsx)(dN,{className:"absolute h-full bg-[#0e109f]"})}),(0,Ot.jsx)(pN,{className:"block h-5 w-5 rounded-full border-2 border-[#0e109f] bg-white ring-offset-white transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-gray-950 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}))}));cD.displayName=uN.displayName;var uD=["points","className","baseLinePoints","connectNulls"];function hD(){return hD=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},hD.apply(this,arguments)}function dD(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function pD(e){return function(e){if(Array.isArray(e))return fD(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return fD(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return fD(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fD(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var mD=function(e){return e&&e.x===+e.x&&e.y===+e.y},gD=function(e,t){var n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=[[]];return e.forEach((function(e){mD(e)?t[t.length-1].push(e):t[t.length-1].length>0&&t.push([])})),mD(e[0])&&t[t.length-1].push(e[0]),t[t.length-1].length<=0&&(t=t.slice(0,-1)),t}(e);t&&(n=[n.reduce((function(e,t){return[].concat(pD(e),pD(t))}),[])]);var r=n.map((function(e){return e.reduce((function(e,t,n){return"".concat(e).concat(0===n?"M":"L").concat(t.x,",").concat(t.y)}),"")})).join("");return 1===n.length?"".concat(r,"Z"):r},yD=function(e){var n=e.points,r=e.className,i=e.baseLinePoints,o=e.connectNulls,a=dD(e,uD);if(!n||!n.length)return null;var s=kh("recharts-polygon",r);if(i&&i.length){var l=a.stroke&&"none"!==a.stroke,c=function(e,t,n){var r=gD(e,n);return"".concat("Z"===r.slice(-1)?r.slice(0,-1):r,"L").concat(gD(t.reverse(),n).slice(1))}(n,i,o);return t.createElement("g",{className:s},t.createElement("path",hD({},Md(a,!0),{fill:"Z"===c.slice(-1)?a.fill:"none",stroke:"none",d:c})),l?t.createElement("path",hD({},Md(a,!0),{fill:"none",d:gD(n,o)})):null,l?t.createElement("path",hD({},Md(a,!0),{fill:"none",d:gD(i,o)})):null)}var u=gD(n,o);return t.createElement("path",hD({},Md(a,!0),{fill:"Z"===u.slice(-1)?a.fill:"none",className:s,d:u}))};function _D(e){return _D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_D(e)}function vD(){return vD=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},vD.apply(this,arguments)}function xD(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function bD(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xD(Object(n),!0).forEach((function(t){MD(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xD(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function wD(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,PD(r.key),r)}}function SD(e,t,n){return t=ED(t),function(e,t){if(t&&("object"===_D(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,TD()?Reflect.construct(t,n||[],ED(e).constructor):t.apply(e,n))}function TD(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(TD=function(){return!!e})()}function ED(e){return ED=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ED(e)}function AD(e,t){return AD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},AD(e,t)}function MD(e,t,n){return(t=PD(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function PD(e){var t=function(e,t){if("object"!=_D(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=_D(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==_D(t)?t:t+""}var kD=Math.PI/180,CD=1e-5,jD=function(e){function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),SD(this,n,arguments)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&AD(e,t)}(n,e),r=n,i=[{key:"getTickLineCoord",value:function(e){var t=this.props,n=t.cx,r=t.cy,i=t.radius,o=t.orientation,a=t.tickSize||8,s=oE(n,r,i,e.coordinate),l=oE(n,r,i+("inner"===o?-1:1)*a,e.coordinate);return{x1:s.x,y1:s.y,x2:l.x,y2:l.y}}},{key:"getTickTextAnchor",value:function(e){var t=this.props.orientation,n=Math.cos(-e.coordinate*kD);return n>CD?"outer"===t?"start":"end":n<-CD?"outer"===t?"end":"start":"middle"}},{key:"renderAxisLine",value:function(){var e=this.props,n=e.cx,r=e.cy,i=e.radius,o=e.axisLine,a=e.axisLineType,s=bD(bD({},Md(this.props,!1)),{},{fill:"none"},Md(o,!1));if("circle"===a)return t.createElement(ym,vD({className:"recharts-polar-angle-axis-line"},s,{cx:n,cy:r,r:i}));var l=this.props.ticks.map((function(e){return oE(n,r,i,e.coordinate)}));return t.createElement(yD,vD({className:"recharts-polar-angle-axis-line"},s,{points:l}))}},{key:"renderTicks",value:function(){var e=this,r=this.props,i=r.ticks,o=r.tick,a=r.tickLine,s=r.tickFormatter,l=r.stroke,c=Md(this.props,!1),u=Md(o,!1),h=bD(bD({},c),{},{fill:"none"},Md(a,!1)),d=i.map((function(r,i){var d=e.getTickLineCoord(r),p=bD(bD(bD({textAnchor:e.getTickTextAnchor(r)},c),{},{stroke:"none",fill:l},u),{},{index:i,payload:r,x:d.x2,y:d.y2});return t.createElement(Jd,vD({className:kh("recharts-polar-angle-axis-tick",uE(o)),key:"tick-".concat(r.coordinate)},hd(e.props,r,i)),a&&t.createElement("line",vD({className:"recharts-polar-angle-axis-tick-line"},h,d)),o&&n.renderTickItem(o,p,s?s(r.value,i):r.value))}));return t.createElement(Jd,{className:"recharts-polar-angle-axis-ticks"},d)}},{key:"render",value:function(){var e=this.props,n=e.ticks,r=e.radius,i=e.axisLine;return r<=0||!n||!n.length?null:t.createElement(Jd,{className:kh("recharts-polar-angle-axis",this.props.className)},i&&this.renderAxisLine(),this.renderTicks())}}],o=[{key:"renderTickItem",value:function(e,n,r){return t.isValidElement(e)?t.cloneElement(e,n):ed()(e)?e(n):t.createElement(Qy,vD({},n,{className:"recharts-polar-angle-axis-tick-value"}),r)}}],i&&wD(r.prototype,i),o&&wD(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,i,o}(t.PureComponent);MD(jD,"displayName","PolarAngleAxis"),MD(jD,"axisType","angleAxis"),MD(jD,"defaultProps",{type:"category",angleAxisId:0,scale:"auto",cx:0,cy:0,orientation:"outer",axisLine:!0,tickLine:!0,tickSize:8,tick:!0,hide:!1,allowDuplicatedCategory:!0});var ID=n(2794),OD=n.n(ID),ND=n(9364),DD=n.n(ND),LD=["cx","cy","angle","ticks","axisLine"],zD=["ticks","tick","angle","tickFormatter","stroke"];function RD(e){return RD="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},RD(e)}function FD(){return FD=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},FD.apply(this,arguments)}function BD(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function VD(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?BD(Object(n),!0).forEach((function(t){XD(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):BD(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function UD(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function GD(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,YD(r.key),r)}}function HD(e,t,n){return t=qD(t),function(e,t){if(t&&("object"===RD(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,ZD()?Reflect.construct(t,n||[],qD(e).constructor):t.apply(e,n))}function ZD(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ZD=function(){return!!e})()}function qD(e){return qD=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},qD(e)}function WD(e,t){return WD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},WD(e,t)}function XD(e,t,n){return(t=YD(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function YD(e){var t=function(e,t){if("object"!=RD(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=RD(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==RD(t)?t:t+""}var KD,JD=function(e){function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),HD(this,n,arguments)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&WD(e,t)}(n,e),r=n,i=[{key:"getTickValueCoord",value:function(e){var t=e.coordinate,n=this.props,r=n.angle,i=n.cx,o=n.cy;return oE(i,o,t,r)}},{key:"getTickTextAnchor",value:function(){var e;switch(this.props.orientation){case"left":e="end";break;case"right":e="start";break;default:e="middle"}return e}},{key:"getViewBox",value:function(){var e=this.props,t=e.cx,n=e.cy,r=e.angle,i=e.ticks,o=OD()(i,(function(e){return e.coordinate||0}));return{cx:t,cy:n,startAngle:r,endAngle:r,innerRadius:DD()(i,(function(e){return e.coordinate||0})).coordinate||0,outerRadius:o.coordinate||0}}},{key:"renderAxisLine",value:function(){var e=this.props,n=e.cx,r=e.cy,i=e.angle,o=e.ticks,a=e.axisLine,s=UD(e,LD),l=o.reduce((function(e,t){return[Math.min(e[0],t.coordinate),Math.max(e[1],t.coordinate)]}),[1/0,-1/0]),c=oE(n,r,l[0],i),u=oE(n,r,l[1],i),h=VD(VD(VD({},Md(s,!1)),{},{fill:"none"},Md(a,!1)),{},{x1:c.x,y1:c.y,x2:u.x,y2:u.y});return t.createElement("line",FD({className:"recharts-polar-radius-axis-line"},h))}},{key:"renderTicks",value:function(){var e=this,r=this.props,i=r.ticks,o=r.tick,a=r.angle,s=r.tickFormatter,l=r.stroke,c=UD(r,zD),u=this.getTickTextAnchor(),h=Md(c,!1),d=Md(o,!1),p=i.map((function(r,i){var c=e.getTickValueCoord(r),p=VD(VD(VD(VD({textAnchor:u,transform:"rotate(".concat(90-a,", ").concat(c.x,", ").concat(c.y,")")},h),{},{stroke:"none",fill:l},d),{},{index:i},c),{},{payload:r});return t.createElement(Jd,FD({className:kh("recharts-polar-radius-axis-tick",uE(o)),key:"tick-".concat(r.coordinate)},hd(e.props,r,i)),n.renderTickItem(o,p,s?s(r.value,i):r.value))}));return t.createElement(Jd,{className:"recharts-polar-radius-axis-ticks"},p)}},{key:"render",value:function(){var e=this.props,n=e.ticks,r=e.axisLine,i=e.tick;return n&&n.length?t.createElement(Jd,{className:kh("recharts-polar-radius-axis",this.props.className)},r&&this.renderAxisLine(),i&&this.renderTicks(),bE.renderCallByParent(this.props,this.getViewBox())):null}}],o=[{key:"renderTickItem",value:function(e,n,r){return t.isValidElement(e)?t.cloneElement(e,n):ed()(e)?e(n):t.createElement(Qy,FD({},n,{className:"recharts-polar-radius-axis-tick-value"}),r)}}],i&&GD(r.prototype,i),o&&GD(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,i,o}(t.PureComponent);function QD(e){return QD="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},QD(e)}function $D(){return $D=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},$D.apply(this,arguments)}function eL(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function tL(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?eL(Object(n),!0).forEach((function(t){sL(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eL(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function nL(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,lL(r.key),r)}}function rL(e,t,n){return t=oL(t),function(e,t){if(t&&("object"===QD(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,iL()?Reflect.construct(t,n||[],oL(e).constructor):t.apply(e,n))}function iL(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(iL=function(){return!!e})()}function oL(e){return oL=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},oL(e)}function aL(e,t){return aL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},aL(e,t)}function sL(e,t,n){return(t=lL(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function lL(e){var t=function(e,t){if("object"!=QD(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=QD(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==QD(t)?t:t+""}XD(JD,"displayName","PolarRadiusAxis"),XD(JD,"axisType","radiusAxis"),XD(JD,"defaultProps",{type:"number",radiusAxisId:0,cx:0,cy:0,angle:0,orientation:"right",stroke:"#ccc",axisLine:!0,tick:!0,tickCount:5,allowDataOverflow:!1,scale:"auto",allowDuplicatedCategory:!0});var cL=function(e){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),sL(t=rL(this,n,[e]),"pieRef",null),sL(t,"sectorRefs",[]),sL(t,"id",Zh("recharts-pie-")),sL(t,"handleAnimationEnd",(function(){var e=t.props.onAnimationEnd;t.setState({isAnimationFinished:!0}),ed()(e)&&e()})),sL(t,"handleAnimationStart",(function(){var e=t.props.onAnimationStart;t.setState({isAnimationFinished:!1}),ed()(e)&&e()})),t.state={isAnimationFinished:!e.isAnimationActive,prevIsAnimationActive:e.isAnimationActive,prevAnimationId:e.animationId,sectorToFocus:0},t}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&aL(e,t)}(n,e),r=n,o=[{key:"getDerivedStateFromProps",value:function(e,t){return t.prevIsAnimationActive!==e.isAnimationActive?{prevIsAnimationActive:e.isAnimationActive,prevAnimationId:e.animationId,curSectors:e.sectors,prevSectors:[],isAnimationFinished:!0}:e.isAnimationActive&&e.animationId!==t.prevAnimationId?{prevAnimationId:e.animationId,curSectors:e.sectors,prevSectors:t.curSectors,isAnimationFinished:!0}:e.sectors!==t.curSectors?{curSectors:e.sectors,isAnimationFinished:!0}:null}},{key:"getTextAnchor",value:function(e,t){return e>t?"start":e<t?"end":"middle"}},{key:"renderLabelLineItem",value:function(e,n,r){if(t.isValidElement(e))return t.cloneElement(e,n);if(ed()(e))return e(n);var i=kh("recharts-pie-label-line","boolean"!==typeof e?e.className:"");return t.createElement(tk,$D({},n,{key:r,type:"linear",className:i}))}},{key:"renderLabelItem",value:function(e,n,r){if(t.isValidElement(e))return t.cloneElement(e,n);var i=r;if(ed()(e)&&(i=e(n),t.isValidElement(i)))return i;var o=kh("recharts-pie-label-text","boolean"===typeof e||ed()(e)?"":e.className);return t.createElement(Qy,$D({},n,{alignmentBaseline:"middle",className:o}),i)}}],(i=[{key:"isActiveIndex",value:function(e){var t=this.props.activeIndex;return Array.isArray(t)?-1!==t.indexOf(e):e===t}},{key:"hasActiveIndex",value:function(){var e=this.props.activeIndex;return Array.isArray(e)?0!==e.length:e||0===e}},{key:"renderLabels",value:function(e){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var r=this.props,i=r.label,o=r.labelLine,a=r.dataKey,s=r.valueKey,l=Md(this.props,!1),c=Md(i,!1),u=Md(o,!1),h=i&&i.offsetRadius||20,d=e.map((function(e,r){var d=(e.startAngle+e.endAngle)/2,p=oE(e.cx,e.cy,e.outerRadius+h,d),f=tL(tL(tL(tL({},l),e),{},{stroke:"none"},c),{},{index:r,textAnchor:n.getTextAnchor(p.x,e.cx)},p),m=tL(tL(tL(tL({},l),e),{},{fill:"none",stroke:e.fill},u),{},{index:r,points:[oE(e.cx,e.cy,e.outerRadius,d),p]}),g=a;return Qh()(a)&&Qh()(s)?g="value":Qh()(a)&&(g=s),t.createElement(Jd,{key:"label-".concat(e.startAngle,"-").concat(e.endAngle,"-").concat(e.midAngle,"-").concat(r)},o&&n.renderLabelLineItem(o,m,"line"),n.renderLabelItem(i,f,lT(e,g)))}));return t.createElement(Jd,{className:"recharts-pie-labels"},d)}},{key:"renderSectorsStatically",value:function(e){var n=this,r=this.props,i=r.activeShape,o=r.blendStroke,a=r.inactiveShape;return e.map((function(r,s){if(0===(null===r||void 0===r?void 0:r.startAngle)&&0===(null===r||void 0===r?void 0:r.endAngle)&&1!==e.length)return null;var l=n.isActiveIndex(s),c=a&&n.hasActiveIndex()?a:null,u=l?i:c,h=tL(tL({},r),{},{stroke:o?r.fill:r.stroke,tabIndex:-1});return t.createElement(Jd,$D({ref:function(e){e&&!n.sectorRefs.includes(e)&&n.sectorRefs.push(e)},tabIndex:-1,className:"recharts-pie-sector"},hd(n.props,r,s),{key:"sector-".concat(null===r||void 0===r?void 0:r.startAngle,"-").concat(null===r||void 0===r?void 0:r.endAngle,"-").concat(r.midAngle,"-").concat(s)}),t.createElement(xA,$D({option:u,isActive:l,shapeType:"sector"},h)))}))}},{key:"renderSectorsWithAnimation",value:function(){var e=this,n=this.props,r=n.sectors,i=n.isAnimationActive,o=n.animationBegin,a=n.animationDuration,s=n.animationEasing,l=n.animationId,c=this.state,u=c.prevSectors,h=c.prevIsAnimationActive;return t.createElement(qg,{begin:o,duration:a,isActive:i,easing:s,from:{t:0},to:{t:1},key:"pie-".concat(l,"-").concat(h),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},(function(n){var i=n.t,o=[],a=(r&&r[0]).startAngle;return r.forEach((function(e,t){var n=u&&u[t],r=t>0?zh()(e,"paddingAngle",0):0;if(n){var s=Xh(n.endAngle-n.startAngle,e.endAngle-e.startAngle),l=tL(tL({},e),{},{startAngle:a+r,endAngle:a+s(i)+r});o.push(l),a=l.endAngle}else{var c=e.endAngle,h=e.startAngle,d=Xh(0,c-h)(i),p=tL(tL({},e),{},{startAngle:a+r,endAngle:a+d+r});o.push(p),a=p.endAngle}})),t.createElement(Jd,null,e.renderSectorsStatically(o))}))}},{key:"attachKeyboardHandlers",value:function(e){var t=this;e.onkeydown=function(e){if(!e.altKey)switch(e.key){case"ArrowLeft":var n=++t.state.sectorToFocus%t.sectorRefs.length;t.sectorRefs[n].focus(),t.setState({sectorToFocus:n});break;case"ArrowRight":var r=--t.state.sectorToFocus<0?t.sectorRefs.length-1:t.state.sectorToFocus%t.sectorRefs.length;t.sectorRefs[r].focus(),t.setState({sectorToFocus:r});break;case"Escape":t.sectorRefs[t.state.sectorToFocus].blur(),t.setState({sectorToFocus:0})}}}},{key:"renderSectors",value:function(){var e=this.props,t=e.sectors,n=e.isAnimationActive,r=this.state.prevSectors;return!(n&&t&&t.length)||r&&sS()(r,t)?this.renderSectorsStatically(t):this.renderSectorsWithAnimation()}},{key:"componentDidMount",value:function(){this.pieRef&&this.attachKeyboardHandlers(this.pieRef)}},{key:"render",value:function(){var e=this,n=this.props,r=n.hide,i=n.sectors,o=n.className,a=n.label,s=n.cx,l=n.cy,c=n.innerRadius,u=n.outerRadius,h=n.isAnimationActive,d=this.state.isAnimationFinished;if(r||!i||!i.length||!Uh(s)||!Uh(l)||!Uh(c)||!Uh(u))return null;var p=kh("recharts-pie",o);return t.createElement(Jd,{tabIndex:this.props.rootTabIndex,className:p,ref:function(t){e.pieRef=t}},this.renderSectors(),a&&this.renderLabels(i),bE.renderCallByParent(this.props,null,!1),(!h||d)&&UE.renderCallByParent(this.props,i,!1))}}])&&nL(r.prototype,i),o&&nL(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,i,o}(t.PureComponent);KD=cL,sL(cL,"displayName","Pie"),sL(cL,"defaultProps",{stroke:"#fff",fill:"#808080",legendType:"rect",cx:"50%",cy:"50%",startAngle:0,endAngle:360,innerRadius:0,outerRadius:"80%",paddingAngle:0,labelLine:!0,hide:!1,minAngle:0,isAnimationActive:!Tp.isSsr,animationBegin:400,animationDuration:1500,animationEasing:"ease",nameKey:"name",blendStroke:!1,rootTabIndex:0}),sL(cL,"parseDeltaAngle",(function(e,t){return Bh(t-e)*Math.min(Math.abs(t-e),360)})),sL(cL,"getRealPieData",(function(e){var t=e.data,n=e.children,r=Md(e,!1),i=bd(n,PE);return t&&t.length?t.map((function(e,t){return tL(tL(tL({payload:e},r),e),i&&i[t]&&i[t].props)})):i&&i.length?i.map((function(e){return tL(tL({},r),e.props)})):[]})),sL(cL,"parseCoordinateOfPie",(function(e,t){var n=t.top,r=t.left,i=t.width,o=t.height,a=aE(i,o);return{cx:r+qh(e.cx,i,i/2),cy:n+qh(e.cy,o,o/2),innerRadius:qh(e.innerRadius,a,0),outerRadius:qh(e.outerRadius,a,.8*a),maxRadius:e.maxRadius||Math.sqrt(i*i+o*o)/2}})),sL(cL,"getComposedData",(function(e){var t=e.item,n=e.offset,r=void 0!==t.type.defaultProps?tL(tL({},t.type.defaultProps),t.props):t.props,i=KD.getRealPieData(r);if(!i||!i.length)return null;var o=r.cornerRadius,a=r.startAngle,s=r.endAngle,l=r.paddingAngle,c=r.dataKey,u=r.nameKey,h=r.valueKey,d=r.tooltipType,p=Math.abs(r.minAngle),f=KD.parseCoordinateOfPie(r,n),m=KD.parseDeltaAngle(a,s),g=Math.abs(m),y=c;Qh()(c)&&Qh()(h)?(Kh(!1,'Use "dataKey" to specify the value of pie,\n      the props "valueKey" will be deprecated in 1.1.0'),y="value"):Qh()(c)&&(Kh(!1,'Use "dataKey" to specify the value of pie,\n      the props "valueKey" will be deprecated in 1.1.0'),y=h);var _,v,x=i.filter((function(e){return 0!==lT(e,y,0)})).length,b=g-x*p-(g>=360?x:x-1)*l,w=i.reduce((function(e,t){var n=lT(t,y,0);return e+(Uh(n)?n:0)}),0);w>0&&(_=i.map((function(e,t){var n,r=lT(e,y,0),i=lT(e,u,t),s=(Uh(r)?r:0)/w,c=(n=t?v.endAngle+Bh(m)*l*(0!==r?1:0):a)+Bh(m)*((0!==r?p:0)+s*b),h=(n+c)/2,g=(f.innerRadius+f.outerRadius)/2,_=[{name:i,value:r,payload:e,dataKey:y,type:d}],x=oE(f.cx,f.cy,g,h);return v=tL(tL(tL({percent:s,cornerRadius:o,name:i,tooltipPayload:_,midAngle:h,middleRadius:g,tooltipPosition:x},e),f),{},{value:lT(e,y),startAngle:n,endAngle:c,payload:e,paddingAngle:Bh(m)*l})})));return tL(tL({},f),{},{sectors:_,data:i})}));var uL=Yk({chartName:"PieChart",GraphicalChild:cL,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",legendContent:"children",axisComponents:[{axisType:"angleAxis",AxisComp:jD},{axisType:"radiusAxis",AxisComp:JD}],formatAxisMap:function(e,t,n,r,i){var o=e.width,a=e.height,s=e.startAngle,l=e.endAngle,c=qh(e.cx,o,o/2),u=qh(e.cy,a,a/2),h=aE(o,a,n),d=qh(e.innerRadius,h,0),p=qh(e.outerRadius,h,.8*h);return Object.keys(t).reduce((function(e,n){var o,a=t[n],h=a.domain,f=a.reversed;if(Qh()(a.range))"angleAxis"===r?o=[s,l]:"radiusAxis"===r&&(o=[d,p]),f&&(o=[o[1],o[0]]);else{var m=tE(o=a.range,2);s=m[0],l=m[1]}var g=_T(a,i),y=g.realScaleType,_=g.scale;_.domain(h).range(o),xT(_);var v=ST(_,$T($T({},a),{},{realScaleType:y})),x=$T($T($T({},a),v),{},{range:o,radius:p,realScaleType:y,scale:_,cx:c,cy:u,innerRadius:d,outerRadius:p,startAngle:s,endAngle:l});return $T($T({},e),{},eE({},n,x))}),{})},defaultProps:{layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}});const hL=()=>{const[e,n]=(0,t.useState)(5e6),[r,i]=(0,t.useState)(15),[o,a]=(0,t.useState)(20),[s,l]=(0,t.useState)(20),[c,u]=(0,t.useState)(1.2),[h,d]=(0,t.useState)(.5),[p,f]=(0,t.useState)("monthly"),[m,g]=(0,t.useState)(0),[y,_]=(0,t.useState)(0),[v,x]=(0,t.useState)(0),[b,w]=(0,t.useState)([]);(0,t.useEffect)((()=>{(()=>{const t=e*(1-s/100),n=r/100/12,i=12*o,a=t*(n*Math.pow(1+n,i))/(Math.pow(1+n,i)-1),l=a+e*(c/100)/12+e*(h/100)/12,u=l*i,d=u-t;let p=t;const f=[];for(let e=1;e<=i;e++){const t=p*n,r=a-t;p-=r,e%12!==0&&1!==e&&e!==i||f.push({month:e,payment:a,principalPayment:r,interestPayment:t,balance:Math.max(0,p),totalInterest:t*e})}g(l),_(u),x(d),w(f)})()}),[e,r,o,s,c,h,p]);const S=e=>new Intl.NumberFormat("en-NG",{style:"currency",currency:"NGN",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),T=[{name:"Principal",value:e*(1-s/100)},{name:"Interest",value:v},{name:"Tax & Insurance",value:y-v-e*(1-s/100)}],E=["#1c5bde","#ff6b6b","#51cf66"];return(0,Ot.jsx)("div",{className:"container mx-auto p-4 space-y-6",children:(0,Ot.jsxs)(xu,{children:[(0,Ot.jsxs)(bu,{children:[(0,Ot.jsxs)(wu,{className:"flex items-center gap-2",children:[(0,Ot.jsx)(kI,{className:"h-6 w-6"}),"Mortgage Calculator"]}),(0,Ot.jsx)(Tu,{children:"Calculate your monthly mortgage payments and view detailed amortization schedule"})]}),(0,Ot.jsxs)(Su,{children:[(0,Ot.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,Ot.jsxs)("div",{className:"space-y-6",children:[(0,Ot.jsxs)("div",{className:"space-y-2",children:[(0,Ot.jsxs)("label",{className:"flex items-center gap-2 text-sm font-medium",children:[(0,Ot.jsx)(AI,{className:"h-4 w-4"}),"Loan Amount: ",S(e)]}),(0,Ot.jsx)(cD,{value:[e],onValueChange:e=>{let[t]=e;return n(t)},min:1e6,max:1e8,step:1e5,className:"w-full"})]}),(0,Ot.jsxs)("div",{className:"space-y-2",children:[(0,Ot.jsxs)("label",{className:"flex items-center gap-2 text-sm font-medium",children:[(0,Ot.jsx)(QI,{className:"h-4 w-4"}),"Interest Rate: ",r,"%"]}),(0,Ot.jsx)(cD,{value:[r],onValueChange:e=>{let[t]=e;return i(t)},min:1,max:30,step:.1,className:"w-full"})]}),(0,Ot.jsxs)("div",{className:"space-y-2",children:[(0,Ot.jsxs)("label",{className:"flex items-center gap-2 text-sm font-medium",children:[(0,Ot.jsx)($I,{className:"h-4 w-4"}),"Loan Term: ",o," years"]}),(0,Ot.jsx)(cD,{value:[o],onValueChange:e=>{let[t]=e;return a(t)},min:1,max:30,step:1,className:"w-full"})]}),(0,Ot.jsxs)("div",{className:"space-y-2",children:[(0,Ot.jsxs)("label",{className:"flex items-center gap-2 text-sm font-medium",children:[(0,Ot.jsx)(AI,{className:"h-4 w-4"}),"Down Payment: ",s,"%"]}),(0,Ot.jsx)(cD,{value:[s],onValueChange:e=>{let[t]=e;return l(t)},min:0,max:90,step:1,className:"w-full"})]}),(0,Ot.jsxs)("div",{className:"space-y-2",children:[(0,Ot.jsxs)("label",{className:"flex items-center gap-2 text-sm font-medium",children:[(0,Ot.jsx)(QI,{className:"h-4 w-4"}),"Property Tax: ",c,"%"]}),(0,Ot.jsx)(cD,{value:[c],onValueChange:e=>{let[t]=e;return u(t)},min:0,max:5,step:.1,className:"w-full"})]}),(0,Ot.jsxs)("div",{className:"space-y-2",children:[(0,Ot.jsxs)("label",{className:"flex items-center gap-2 text-sm font-medium",children:[(0,Ot.jsx)(QI,{className:"h-4 w-4"}),"Insurance: ",h,"%"]}),(0,Ot.jsx)(cD,{value:[h],onValueChange:e=>{let[t]=e;return d(t)},min:0,max:2,step:.1,className:"w-full"})]}),(0,Ot.jsxs)("div",{className:"space-y-2",children:[(0,Ot.jsx)("label",{className:"text-sm font-medium",children:"Payment Frequency"}),(0,Ot.jsxs)(Uu,{value:p,onValueChange:f,children:[(0,Ot.jsx)(Gu,{children:(0,Ot.jsx)(Hu,{})}),(0,Ot.jsxs)(Zu,{children:[(0,Ot.jsx)(qu,{value:"monthly",children:"Monthly"}),(0,Ot.jsx)(qu,{value:"biweekly",children:"Bi-weekly"}),(0,Ot.jsx)(qu,{value:"weekly",children:"Weekly"})]})]})]})]}),(0,Ot.jsxs)("div",{className:"space-y-6",children:[(0,Ot.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,Ot.jsxs)(xu,{children:[(0,Ot.jsx)(bu,{className:"p-4",children:(0,Ot.jsx)(wu,{className:"text-lg",children:"Monthly Payment"})}),(0,Ot.jsx)(Su,{children:(0,Ot.jsx)("p",{className:"text-2xl font-bold text-[#1c5bde]",children:S(m)})})]}),(0,Ot.jsxs)(xu,{children:[(0,Ot.jsx)(bu,{className:"p-4",children:(0,Ot.jsx)(wu,{className:"text-lg",children:"Total Payment"})}),(0,Ot.jsx)(Su,{children:(0,Ot.jsx)("p",{className:"text-2xl font-bold text-[#1c5bde]",children:S(y)})})]})]}),(0,Ot.jsxs)(xu,{children:[(0,Ot.jsx)(bu,{className:"p-4",children:(0,Ot.jsxs)(wu,{className:"text-lg flex items-center gap-2",children:[(0,Ot.jsx)(eO,{className:"h-5 w-5"}),"Payment Breakdown"]})}),(0,Ot.jsx)(Su,{children:(0,Ot.jsx)("div",{className:"h-[200px]",children:(0,Ot.jsx)(zd,{width:"100%",height:"100%",children:(0,Ot.jsxs)(uL,{children:[(0,Ot.jsx)(cL,{data:T,cx:"50%",cy:"50%",innerRadius:60,outerRadius:80,paddingAngle:5,dataKey:"value",children:T.map(((e,t)=>(0,Ot.jsx)(PE,{fill:E[t]},"cell-".concat(t))))}),(0,Ot.jsx)(Fp,{formatter:e=>S(e)}),(0,Ot.jsx)(mm,{})]})})})})]}),(0,Ot.jsxs)("div",{className:"flex gap-4",children:[(0,Ot.jsxs)(Xu,{className:"flex-1",variant:"outline",onClick:()=>window.print(),children:[(0,Ot.jsx)(EI,{className:"h-4 w-4 mr-2"}),"Download Report"]}),(0,Ot.jsxs)(Xu,{className:"flex-1",onClick:()=>{n(5e6),i(15),a(20),l(20),u(1.2),d(.5)},children:[(0,Ot.jsx)(tO,{className:"h-4 w-4 mr-2"}),"Reset Calculator"]})]})]})]}),(0,Ot.jsxs)("div",{className:"mt-8",children:[(0,Ot.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Amortization Schedule"}),(0,Ot.jsx)("div",{className:"overflow-x-auto",children:(0,Ot.jsxs)("table",{className:"w-full border-collapse",children:[(0,Ot.jsx)("thead",{children:(0,Ot.jsxs)("tr",{className:"bg-gray-50",children:[(0,Ot.jsx)("th",{className:"p-2 text-left border",children:"Year"}),(0,Ot.jsx)("th",{className:"p-2 text-left border",children:"Payment"}),(0,Ot.jsx)("th",{className:"p-2 text-left border",children:"Principal"}),(0,Ot.jsx)("th",{className:"p-2 text-left border",children:"Interest"}),(0,Ot.jsx)("th",{className:"p-2 text-left border",children:"Balance"})]})}),(0,Ot.jsx)("tbody",{children:b.map((e=>(0,Ot.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,Ot.jsx)("td",{className:"p-2 border",children:Math.ceil(e.month/12)}),(0,Ot.jsx)("td",{className:"p-2 border",children:S(e.payment)}),(0,Ot.jsx)("td",{className:"p-2 border",children:S(e.principalPayment)}),(0,Ot.jsx)("td",{className:"p-2 border",children:S(e.interestPayment)}),(0,Ot.jsx)("td",{className:"p-2 border",children:S(e.balance)})]},e.month)))})]})})]})]})]})})},dL=()=>{const[e,n]=(0,t.useState)(5e7),[r,i]=(0,t.useState)(20),[o,a]=(0,t.useState)(5),[s,l]=(0,t.useState)(2e5),[c,u]=(0,t.useState)(15),[h,d]=(0,t.useState)(5),[p,f]=(0,t.useState)(1e6),[m,g]=(0,t.useState)(0),[y,_]=(0,t.useState)(0),[v,x]=(0,t.useState)(0),[b,w]=(0,t.useState)(0),[S,T]=(0,t.useState)([]);(0,t.useEffect)((()=>{(()=>{const t=e*(r/100)+p,n=s-s*(c/100),i=12*n,a=i/t*100,l=e*Math.pow(1+o/100,h),u=(l-e+i*h)/t*100,d=[];for(let r=0;r<=h;r++){const t=e*Math.pow(1+o/100,r),n=i*r;d.push({year:r,propertyValue:t,cumulativeReturn:n+(t-e),rentalIncome:n})}g(n),_(a),x(u),w(l),T(d)})()}),[e,r,o,s,c,h,p]);const E=e=>new Intl.NumberFormat("en-NG",{style:"currency",currency:"NGN",minimumFractionDigits:0,maximumFractionDigits:0}).format(e);return(0,Ot.jsx)("div",{className:"container mx-auto p-4 space-y-6",children:(0,Ot.jsxs)(xu,{children:[(0,Ot.jsxs)(bu,{children:[(0,Ot.jsxs)(wu,{className:"flex items-center gap-2",children:[(0,Ot.jsx)(kI,{className:"h-6 w-6"}),"Investment ROI Calculator"]}),(0,Ot.jsx)(Tu,{children:"Calculate your potential return on investment for real estate properties"})]}),(0,Ot.jsx)(Su,{children:(0,Ot.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,Ot.jsxs)("div",{className:"space-y-6",children:[(0,Ot.jsxs)("div",{className:"space-y-2",children:[(0,Ot.jsxs)("label",{className:"flex items-center gap-2 text-sm font-medium",children:[(0,Ot.jsx)(AI,{className:"h-4 w-4"}),"Purchase Price: ",E(e)]}),(0,Ot.jsx)(cD,{value:[e],onValueChange:e=>{let[t]=e;return n(t)},min:1e7,max:5e8,step:1e6,className:"w-full"})]}),(0,Ot.jsxs)("div",{className:"space-y-2",children:[(0,Ot.jsxs)("label",{className:"flex items-center gap-2 text-sm font-medium",children:[(0,Ot.jsx)(QI,{className:"h-4 w-4"}),"Down Payment: ",r,"%"]}),(0,Ot.jsx)(cD,{value:[r],onValueChange:e=>{let[t]=e;return i(t)},min:10,max:100,step:5,className:"w-full"})]}),(0,Ot.jsxs)("div",{className:"space-y-2",children:[(0,Ot.jsxs)("label",{className:"flex items-center gap-2 text-sm font-medium",children:[(0,Ot.jsx)(kt,{className:"h-4 w-4"}),"Annual Appreciation: ",o,"%"]}),(0,Ot.jsx)(cD,{value:[o],onValueChange:e=>{let[t]=e;return a(t)},min:0,max:20,step:.5,className:"w-full"})]}),(0,Ot.jsxs)("div",{className:"space-y-2",children:[(0,Ot.jsxs)("label",{className:"flex items-center gap-2 text-sm font-medium",children:[(0,Ot.jsx)(AI,{className:"h-4 w-4"}),"Monthly Rental Income: ",E(s)]}),(0,Ot.jsx)(cD,{value:[s],onValueChange:e=>{let[t]=e;return l(t)},min:5e4,max:2e6,step:1e4,className:"w-full"})]}),(0,Ot.jsxs)("div",{className:"space-y-2",children:[(0,Ot.jsxs)("label",{className:"flex items-center gap-2 text-sm font-medium",children:[(0,Ot.jsx)(QI,{className:"h-4 w-4"}),"Operating Expenses: ",c,"%"]}),(0,Ot.jsx)(cD,{value:[c],onValueChange:e=>{let[t]=e;return u(t)},min:5,max:50,step:1,className:"w-full"})]}),(0,Ot.jsxs)("div",{className:"space-y-2",children:[(0,Ot.jsxs)("label",{className:"flex items-center gap-2 text-sm font-medium",children:[(0,Ot.jsx)(Qu,{className:"h-4 w-4"}),"Holding Period: ",h," years"]}),(0,Ot.jsx)(cD,{value:[h],onValueChange:e=>{let[t]=e;return d(t)},min:1,max:30,step:1,className:"w-full"})]}),(0,Ot.jsxs)("div",{className:"space-y-2",children:[(0,Ot.jsxs)("label",{className:"flex items-center gap-2 text-sm font-medium",children:[(0,Ot.jsx)(AI,{className:"h-4 w-4"}),"Renovation Costs: ",E(p)]}),(0,Ot.jsx)(cD,{value:[p],onValueChange:e=>{let[t]=e;return f(t)},min:0,max:5e7,step:1e5,className:"w-full"})]})]}),(0,Ot.jsxs)("div",{className:"space-y-6",children:[(0,Ot.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,Ot.jsxs)(xu,{children:[(0,Ot.jsx)(bu,{className:"p-4",children:(0,Ot.jsx)(wu,{className:"text-lg",children:"Monthly Cash Flow"})}),(0,Ot.jsx)(Su,{children:(0,Ot.jsx)("p",{className:"text-2xl font-bold text-[#0e109f]",children:E(m)})})]}),(0,Ot.jsxs)(xu,{children:[(0,Ot.jsx)(bu,{className:"p-4",children:(0,Ot.jsx)(wu,{className:"text-lg",children:"Annual ROI"})}),(0,Ot.jsx)(Su,{children:(0,Ot.jsxs)("p",{className:"text-2xl font-bold text-[#0e109f]",children:[y.toFixed(1),"%"]})})]}),(0,Ot.jsxs)(xu,{children:[(0,Ot.jsx)(bu,{className:"p-4",children:(0,Ot.jsx)(wu,{className:"text-lg",children:"Total ROI"})}),(0,Ot.jsx)(Su,{children:(0,Ot.jsxs)("p",{className:"text-2xl font-bold text-[#0e109f]",children:[v.toFixed(1),"%"]})})]}),(0,Ot.jsxs)(xu,{children:[(0,Ot.jsx)(bu,{className:"p-4",children:(0,Ot.jsx)(wu,{className:"text-lg",children:"Future Value"})}),(0,Ot.jsx)(Su,{children:(0,Ot.jsx)("p",{className:"text-2xl font-bold text-[#0e109f]",children:E(b)})})]})]}),(0,Ot.jsxs)(xu,{children:[(0,Ot.jsx)(bu,{className:"p-4",children:(0,Ot.jsx)(wu,{className:"text-lg",children:"Projected Returns"})}),(0,Ot.jsx)(Su,{children:(0,Ot.jsx)("div",{className:"h-[300px]",children:(0,Ot.jsx)(zd,{width:"100%",height:"100%",children:(0,Ot.jsxs)(oj,{data:S,children:[(0,Ot.jsx)(SI,{strokeDasharray:"3 3"}),(0,Ot.jsx)(WC,{dataKey:"year",label:{value:"Years",position:"bottom"}}),(0,Ot.jsx)(ij,{tickFormatter:e=>E(e)}),(0,Ot.jsx)(Fp,{formatter:e=>E(e)}),(0,Ot.jsx)(mm,{}),(0,Ot.jsx)(dC,{type:"monotone",dataKey:"propertyValue",name:"Property Value",stroke:"#0e109f",strokeWidth:2}),(0,Ot.jsx)(dC,{type:"monotone",dataKey:"cumulativeReturn",name:"Total Return",stroke:"#10B981",strokeWidth:2}),(0,Ot.jsx)(dC,{type:"monotone",dataKey:"rentalIncome",name:"Rental Income",stroke:"#6366F1",strokeWidth:2})]})})})})]}),(0,Ot.jsxs)("div",{className:"flex gap-4",children:[(0,Ot.jsxs)(Xu,{className:"flex-1",variant:"outline",onClick:()=>window.print(),children:[(0,Ot.jsx)(EI,{className:"h-4 w-4 mr-2"}),"Download Report"]}),(0,Ot.jsxs)(Xu,{className:"flex-1",onClick:()=>{n(5e7),i(20),a(5),l(2e5),u(15),d(5),f(1e6)},children:[(0,Ot.jsx)(tO,{className:"h-4 w-4 mr-2"}),"Reset Calculator"]})]})]})]})})]})})},pL=Et("Wallet",[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]]),fL=Et("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]),mL=()=>{const[e,n]=(0,t.useState)(5e6),[r,i]=(0,t.useState)(1e5),[o,a]=(0,t.useState)(20),[s,l]=(0,t.useState)(15),[c,u]=(0,t.useState)(25),[h,d]=(0,t.useState)(1.2),[p,f]=(0,t.useState)(.5),[m,g]=(0,t.useState)(0),[y,_]=(0,t.useState)(0),[v,x]=(0,t.useState)(0),[b,w]=(0,t.useState)({});(0,t.useEffect)((()=>{(()=>{const t=e/12,n=r/t*100,i=s/100/12,a=12*c,l=.28*t*((Math.pow(1+i,a)-1)/(i*Math.pow(1+i,a))),u=l/(1-o/100),d=u*(h/100)/12,f=u*(p/100)/12,m=l*(i*Math.pow(1+i,a))/(Math.pow(1+i,a)-1);g(u),_(m+d+f),x(n),w({principalAndInterest:m,propertyTax:d,insurance:f,otherDebts:r})})()}),[e,r,o,s,c,h,p]);const S=e=>new Intl.NumberFormat("en-NG",{style:"currency",currency:"NGN",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),T=[{name:"Principal & Interest",value:b.principalAndInterest},{name:"Property Tax",value:b.propertyTax},{name:"Insurance",value:b.insurance},{name:"Other Debts",value:b.otherDebts}],E=["#1c5bde","#4f46e5","#818cf8","#c7d2fe"];return(0,Ot.jsx)("div",{className:"container mx-auto p-4 space-y-6",children:(0,Ot.jsxs)(xu,{children:[(0,Ot.jsxs)(bu,{children:[(0,Ot.jsxs)(wu,{className:"flex items-center gap-2",children:[(0,Ot.jsx)(kI,{className:"h-6 w-6"}),"Affordability Calculator"]}),(0,Ot.jsx)(Tu,{children:"Calculate how much house you can afford based on your income and expenses"})]}),(0,Ot.jsx)(Su,{children:(0,Ot.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,Ot.jsxs)("div",{className:"space-y-6",children:[(0,Ot.jsxs)("div",{className:"space-y-2",children:[(0,Ot.jsxs)("label",{className:"flex items-center gap-2 text-sm font-medium",children:[(0,Ot.jsx)(pL,{className:"h-4 w-4"}),"Annual Income: ",S(e)]}),(0,Ot.jsx)(cD,{value:[e],onValueChange:e=>{let[t]=e;return n(t)},min:1e6,max:5e7,step:1e5,className:"w-full"})]}),(0,Ot.jsxs)("div",{className:"space-y-2",children:[(0,Ot.jsxs)("label",{className:"flex items-center gap-2 text-sm font-medium",children:[(0,Ot.jsx)(fL,{className:"h-4 w-4"}),"Monthly Debts: ",S(r)]}),(0,Ot.jsx)(cD,{value:[r],onValueChange:e=>{let[t]=e;return i(t)},min:0,max:1e6,step:1e4,className:"w-full"})]}),(0,Ot.jsxs)("div",{className:"space-y-2",children:[(0,Ot.jsxs)("label",{className:"flex items-center gap-2 text-sm font-medium",children:[(0,Ot.jsx)(AI,{className:"h-4 w-4"}),"Down Payment: ",o,"%"]}),(0,Ot.jsx)(cD,{value:[o],onValueChange:e=>{let[t]=e;return a(t)},min:5,max:50,step:1,className:"w-full"})]}),(0,Ot.jsxs)("div",{className:"space-y-2",children:[(0,Ot.jsxs)("label",{className:"flex items-center gap-2 text-sm font-medium",children:[(0,Ot.jsx)(QI,{className:"h-4 w-4"}),"Interest Rate: ",s,"%"]}),(0,Ot.jsx)(cD,{value:[s],onValueChange:e=>{let[t]=e;return l(t)},min:1,max:30,step:.1,className:"w-full"})]}),(0,Ot.jsxs)("div",{className:"space-y-2",children:[(0,Ot.jsxs)("label",{className:"flex items-center gap-2 text-sm font-medium",children:[(0,Ot.jsx)(lu,{className:"h-4 w-4"}),"Loan Term: ",c," years"]}),(0,Ot.jsx)(cD,{value:[c],onValueChange:e=>{let[t]=e;return u(t)},min:5,max:30,step:1,className:"w-full"})]})]}),(0,Ot.jsxs)("div",{className:"space-y-6",children:[(0,Ot.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,Ot.jsxs)(xu,{children:[(0,Ot.jsx)(bu,{className:"p-4",children:(0,Ot.jsx)(wu,{className:"text-lg",children:"Maximum Home Price"})}),(0,Ot.jsx)(Su,{children:(0,Ot.jsx)("p",{className:"text-2xl font-bold text-[#1c5bde]",children:S(m)})})]}),(0,Ot.jsxs)(xu,{children:[(0,Ot.jsx)(bu,{className:"p-4",children:(0,Ot.jsx)(wu,{className:"text-lg",children:"Monthly Payment"})}),(0,Ot.jsx)(Su,{children:(0,Ot.jsx)("p",{className:"text-2xl font-bold text-[#1c5bde]",children:S(y)})})]})]}),(0,Ot.jsxs)(xu,{children:[(0,Ot.jsx)(bu,{className:"p-4",children:(0,Ot.jsx)(wu,{className:"text-lg",children:"Monthly Expenses Breakdown"})}),(0,Ot.jsx)(Su,{children:(0,Ot.jsx)("div",{className:"h-[300px]",children:(0,Ot.jsx)(zd,{width:"100%",height:"100%",children:(0,Ot.jsxs)(uL,{children:[(0,Ot.jsx)(cL,{data:T,cx:"50%",cy:"50%",innerRadius:60,outerRadius:80,fill:"#8884d8",paddingAngle:5,dataKey:"value",children:T.map(((e,t)=>(0,Ot.jsx)(PE,{fill:E[t%E.length]},"cell-".concat(t))))}),(0,Ot.jsx)(Fp,{formatter:e=>S(e)}),(0,Ot.jsx)(mm,{})]})})})})]}),(0,Ot.jsxs)("div",{className:"flex gap-4",children:[(0,Ot.jsxs)(Xu,{className:"flex-1",variant:"outline",onClick:()=>window.print(),children:[(0,Ot.jsx)(EI,{className:"h-4 w-4 mr-2"}),"Download Report"]}),(0,Ot.jsxs)(Xu,{className:"flex-1",onClick:()=>{n(5e6),i(1e5),a(20),l(15),u(25),d(1.2),f(.5)},children:[(0,Ot.jsx)(tO,{className:"h-4 w-4 mr-2"}),"Reset Calculator"]})]})]})]})})]})})},gL=Et("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]),yL=Et("ChartBar",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M7 16h8",key:"srdodz"}],["path",{d:"M7 11h12",key:"127s9w"}],["path",{d:"M7 6h3",key:"w9rmul"}]]),_L=()=>{const e=[{label:"Properties Listed",value:"10,000+",icon:lu},{label:"Happy Clients",value:"5,000+",icon:At},{label:"Cities Covered",value:"50+",icon:tu},{label:"Years Experience",value:"10+",icon:gL}],t=[{title:"Transparency",description:"We believe in complete transparency in all our dealings, providing accurate and verified property information.",icon:vh},{title:"Innovation",description:"Constantly improving our platform with cutting-edge technology to enhance your property search experience.",icon:yL}];return(0,Ot.jsxs)("div",{className:"min-h-screen bg-white",children:[(0,Ot.jsx)(zc.section,{initial:{opacity:0},animate:{opacity:1},className:"relative bg-gradient-to-br from-[#1c5bde]/10 via-white to-[#1c5bde]/10 py-20",children:(0,Ot.jsx)("div",{className:"container mx-auto px-4",children:(0,Ot.jsxs)("div",{className:"max-w-3xl mx-auto text-center",children:[(0,Ot.jsx)(zc.h1,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},className:"text-4xl md:text-5xl font-bold mb-6",children:"About FastFind"}),(0,Ot.jsx)(zc.p,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1},className:"text-lg text-gray-600 mb-8",children:"Your trusted partner in finding the perfect property in Nigeria. We combine technology and local expertise to make property search seamless and efficient."})]})})}),(0,Ot.jsx)("section",{className:"py-16 bg-white",children:(0,Ot.jsx)("div",{className:"container mx-auto px-4",children:(0,Ot.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-8",children:e.map(((e,t)=>(0,Ot.jsxs)(zc.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1*t},className:"text-center",children:[(0,Ot.jsx)("div",{className:"flex justify-center mb-4",children:(0,Ot.jsx)("div",{className:"bg-[#1c5bde]/10 p-4 rounded-full",children:(0,Ot.jsx)(e.icon,{className:"h-6 w-6 text-[#1c5bde]"})})}),(0,Ot.jsx)("h3",{className:"text-3xl font-bold mb-2",children:e.value}),(0,Ot.jsx)("p",{className:"text-gray-600",children:e.label})]},t)))})})}),(0,Ot.jsx)("section",{className:"py-16 bg-gray-50",children:(0,Ot.jsx)("div",{className:"container mx-auto px-4",children:(0,Ot.jsxs)("div",{className:"max-w-3xl mx-auto text-center",children:[(0,Ot.jsx)(zc.h2,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},className:"text-3xl font-bold mb-6",children:"Our Mission"}),(0,Ot.jsx)(zc.p,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1},className:"text-lg text-gray-600",children:"To revolutionize property search in Nigeria by providing a transparent, efficient, and technology-driven platform that connects property seekers with their dream properties while offering valuable insights for informed decision-making."})]})})}),(0,Ot.jsx)("section",{className:"py-16 bg-white",children:(0,Ot.jsx)("div",{className:"container mx-auto px-4",children:(0,Ot.jsxs)("div",{className:"max-w-3xl mx-auto",children:[(0,Ot.jsx)(zc.h2,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},className:"text-3xl font-bold mb-12 text-center",children:"Our Values"}),(0,Ot.jsx)("div",{className:"grid md:grid-cols-2 gap-8",children:t.map(((e,t)=>(0,Ot.jsxs)(zc.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1*t},className:"bg-gray-50 p-6 rounded-lg",children:[(0,Ot.jsxs)("div",{className:"flex items-center gap-4 mb-4",children:[(0,Ot.jsx)("div",{className:"bg-[#1c5bde]/10 p-3 rounded-full",children:(0,Ot.jsx)(e.icon,{className:"h-6 w-6 text-[#1c5bde]"})}),(0,Ot.jsx)("h3",{className:"text-xl font-semibold",children:e.title})]}),(0,Ot.jsx)("p",{className:"text-gray-600",children:e.description})]},t)))})]})})})]})},vL={crowdfunding:{initializeFunding:async e=>(console.log("Initializing funding for:",e),{status:"success",fundingId:"F"+Math.random().toString(36).substr(2,9)})},governmentBridge:{processLandAllocation:async e=>(console.log("Processing land allocation:",e),{status:"pending",applicationId:"L"+Math.random().toString(36).substr(2,9)})},communityEngagement:{startVoting:async e=>(console.log("Starting community voting for:",e),{status:"active",votingId:"V"+Math.random().toString(36).substr(2,9)})},riskManagement:{assessProject:async e=>(console.log("Assessing project risk:",e),{score:Math.floor(100*Math.random()),risk:"low",recommendations:["Verify land documents","Check market demand"]})}},xL=()=>{const[e,n]=(0,t.useState)(null),[r,i]=(0,t.useState)(null),[o,a]=(0,t.useState)(null),s=[{title:"Micro-Investment",description:"Invest in real estate projects from \u20a61,000",icon:Mt,action:"Start Investing",onClick:()=>console.log("Initialize micro-investment")},{title:"Project Funding",description:"Get funding for your real estate projects",icon:lu,action:"Submit Project",onClick:()=>{(async e=>{const t=await vL.crowdfunding.initializeFunding(e);i(t);const r=await vL.governmentBridge.processLandAllocation(e);a(r),await vL.communityEngagement.startVoting(e);const o=await vL.riskManagement.assessProject(e);n(c(c({},e),{},{riskAssessment:o}))})({title:"New Housing Development",location:"Lagos",fundingRequired:"\u20a650M",landDetails:{size:"2000 sqm",zone:"residential"}})}},{title:"Government Bridge",description:"Streamlined land allocation and approvals",icon:su,action:"Learn More",onClick:()=>console.log("Show government bridge details")}];return(0,Ot.jsxs)("div",{className:"min-h-screen bg-[#f8fafc]",children:[(0,Ot.jsx)(zc.section,{initial:{opacity:0},animate:{opacity:1},className:"relative bg-gradient-to-br from-[#1c5bde]/10 via-white to-[#1c5bde]/10 py-20",children:(0,Ot.jsx)("div",{className:"container mx-auto px-4",children:(0,Ot.jsxs)("div",{className:"max-w-4xl mx-auto text-center",children:[(0,Ot.jsx)(zc.h1,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},className:"text-4xl md:text-5xl font-bold mb-6 bg-gradient-to-r from-[#1c5bde] to-[#1c5bde]/80 bg-clip-text text-transparent",children:"FastFind BuildFund"}),(0,Ot.jsx)(zc.p,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1},className:"text-xl text-gray-600 mb-8",children:"Revolutionizing real estate funding and development in Nigeria"}),(0,Ot.jsxs)(zc.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2},className:"flex justify-center gap-4",children:[(0,Ot.jsx)("button",{className:"px-8 py-3 bg-[#1c5bde] text-white rounded-lg hover:bg-[#1c5bde]/90 transition-all",children:"Get Started"}),(0,Ot.jsx)("button",{className:"px-8 py-3 border border-[#1c5bde] text-[#1c5bde] rounded-lg hover:bg-[#1c5bde]/5 transition-all",children:"Learn More"})]})]})})}),(0,Ot.jsx)("section",{className:"py-16",children:(0,Ot.jsx)("div",{className:"container mx-auto px-4",children:(0,Ot.jsx)("div",{className:"grid md:grid-cols-3 gap-8",children:s.map(((e,t)=>(0,Ot.jsxs)(zc.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1*t},className:"bg-white p-6 rounded-xl shadow-lg hover:shadow-xl transition-shadow",children:[(0,Ot.jsx)("div",{className:"bg-[#1c5bde]/10 p-3 rounded-full w-fit mb-4",children:(0,Ot.jsx)(e.icon,{className:"h-6 w-6 text-[#1c5bde]"})}),(0,Ot.jsx)("h3",{className:"text-xl font-semibold mb-2",children:e.title}),(0,Ot.jsx)("p",{className:"text-gray-600 mb-4",children:e.description}),(0,Ot.jsxs)("button",{onClick:e.onClick,className:"text-[#1c5bde] font-medium hover:underline",children:[e.action," \u2192"]})]},t)))})})}),(r||o||e)&&(0,Ot.jsx)("section",{className:"py-8 bg-gray-50",children:(0,Ot.jsx)("div",{className:"container mx-auto px-4",children:(0,Ot.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,Ot.jsx)("h3",{className:"text-2xl font-bold mb-4",children:"Project Status"}),(0,Ot.jsxs)("div",{className:"space-y-4",children:[r&&(0,Ot.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow",children:[(0,Ot.jsx)("h4",{className:"font-semibold",children:"Funding Status"}),(0,Ot.jsxs)("p",{children:["ID: ",r.fundingId]}),(0,Ot.jsxs)("p",{children:["Status: ",r.status]})]}),o&&(0,Ot.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow",children:[(0,Ot.jsx)("h4",{className:"font-semibold",children:"Land Allocation Status"}),(0,Ot.jsxs)("p",{children:["Application ID: ",o.applicationId]}),(0,Ot.jsxs)("p",{children:["Status: ",o.status]})]}),(null===e||void 0===e?void 0:e.riskAssessment)&&(0,Ot.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow",children:[(0,Ot.jsx)("h4",{className:"font-semibold",children:"Risk Assessment"}),(0,Ot.jsxs)("p",{children:["Score: ",e.riskAssessment.score,"/100"]}),(0,Ot.jsxs)("p",{children:["Risk Level: ",e.riskAssessment.risk]})]})]})]})})}),(0,Ot.jsx)("section",{className:"py-16 bg-gray-50",children:(0,Ot.jsxs)("div",{className:"container mx-auto px-4",children:[(0,Ot.jsx)("h2",{className:"text-3xl font-bold text-center mb-12",children:"How It Works"}),(0,Ot.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,Ot.jsxs)("div",{className:"grid md:grid-cols-2 gap-8",children:[(0,Ot.jsxs)("div",{className:"space-y-6",children:[(0,Ot.jsx)("h3",{className:"text-2xl font-semibold mb-6",children:"For Investors"}),(0,Ot.jsxs)("div",{className:"space-y-4",children:[(0,Ot.jsxs)("div",{className:"flex items-start gap-4",children:[(0,Ot.jsx)("div",{className:"bg-[#1c5bde]/10 p-2 rounded-full",children:(0,Ot.jsx)(Mt,{className:"h-5 w-5 text-[#1c5bde]"})}),(0,Ot.jsxs)("div",{children:[(0,Ot.jsx)("h4",{className:"font-medium mb-1",children:"1. Start with \u20a61,000"}),(0,Ot.jsx)("p",{className:"text-gray-600",children:"Invest in verified real estate projects with as little as \u20a61,000"})]})]}),(0,Ot.jsxs)("div",{className:"flex items-start gap-4",children:[(0,Ot.jsx)("div",{className:"bg-[#1c5bde]/10 p-2 rounded-full",children:(0,Ot.jsx)(yL,{className:"h-5 w-5 text-[#1c5bde]"})}),(0,Ot.jsxs)("div",{children:[(0,Ot.jsx)("h4",{className:"font-medium mb-1",children:"2. Track Your Investment"}),(0,Ot.jsx)("p",{className:"text-gray-600",children:"Monitor project progress and returns in real-time"})]})]}),(0,Ot.jsxs)("div",{className:"flex items-start gap-4",children:[(0,Ot.jsx)("div",{className:"bg-[#1c5bde]/10 p-2 rounded-full",children:(0,Ot.jsx)(vh,{className:"h-5 w-5 text-[#1c5bde]"})}),(0,Ot.jsxs)("div",{children:[(0,Ot.jsx)("h4",{className:"font-medium mb-1",children:"3. Secure Returns"}),(0,Ot.jsx)("p",{className:"text-gray-600",children:"Receive automated returns through smart contracts"})]})]})]})]}),(0,Ot.jsxs)("div",{className:"space-y-6",children:[(0,Ot.jsx)("h3",{className:"text-2xl font-semibold mb-6",children:"For Developers"}),(0,Ot.jsxs)("div",{className:"space-y-4",children:[(0,Ot.jsxs)("div",{className:"flex items-start gap-4",children:[(0,Ot.jsx)("div",{className:"bg-[#1c5bde]/10 p-2 rounded-full",children:(0,Ot.jsx)(lu,{className:"h-5 w-5 text-[#1c5bde]"})}),(0,Ot.jsxs)("div",{children:[(0,Ot.jsx)("h4",{className:"font-medium mb-1",children:"1. Submit Your Project"}),(0,Ot.jsx)("p",{className:"text-gray-600",children:"List your project with required documentation"})]})]}),(0,Ot.jsxs)("div",{className:"flex items-start gap-4",children:[(0,Ot.jsx)("div",{className:"bg-[#1c5bde]/10 p-2 rounded-full",children:(0,Ot.jsx)(su,{className:"h-5 w-5 text-[#1c5bde]"})}),(0,Ot.jsxs)("div",{children:[(0,Ot.jsx)("h4",{className:"font-medium mb-1",children:"2. Fast-Track Approvals"}),(0,Ot.jsx)("p",{className:"text-gray-600",children:"Get streamlined government approvals and land allocation"})]})]}),(0,Ot.jsxs)("div",{className:"flex items-start gap-4",children:[(0,Ot.jsx)("div",{className:"bg-[#1c5bde]/10 p-2 rounded-full",children:(0,Ot.jsx)(At,{className:"h-5 w-5 text-[#1c5bde]"})}),(0,Ot.jsxs)("div",{children:[(0,Ot.jsx)("h4",{className:"font-medium mb-1",children:"3. Access Funding"}),(0,Ot.jsx)("p",{className:"text-gray-600",children:"Receive milestone-based funding from verified investors"})]})]})]})]})]}),(0,Ot.jsx)("div",{className:"mt-12 text-center",children:(0,Ot.jsx)("button",{className:"px-8 py-3 bg-[#1c5bde] text-white rounded-lg hover:bg-[#0c0d8a] transition-all",children:"Get Started Now"})})]})]})})]})},bL=()=>{ue();const e=[{title:"CommunityPulse",description:"Shape your community's future through blockchain-verified voting on infrastructure projects",icon:At,path:"/buildfund-hub/community-pulse",stats:[{label:"Active Projects",value:"15+"},{label:"Community Members",value:"5,000+"},{label:"Total Votes",value:"15,678"}]},{title:"SmartVest",description:"Smart real estate investment platform with AI-powered insights and automated returns",icon:Mt,path:"/buildfund-hub/smart-vest",stats:[{label:"Min Investment",value:"\u20a61,000"},{label:"Total Invested",value:"\u20a6500M+"},{label:"Avg. ROI",value:"25%"}]},{title:"RevenueSense",description:"AI-powered government asset optimization and revenue generation platform",icon:yL,path:"/buildfund-hub/revenue-sense",stats:[{label:"Revenue Increase",value:"30%"},{label:"Assets Managed",value:"500+"},{label:"Collection Rate",value:"95%"}]}];return(0,Ot.jsx)("div",{className:"min-h-screen bg-gray-50 pt-20",children:(0,Ot.jsxs)("div",{className:"container mx-auto px-4 py-12",children:[(0,Ot.jsxs)(zc.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center max-w-3xl mx-auto mb-16",children:[(0,Ot.jsx)("h1",{className:"text-4xl font-bold mb-4",children:"BuildFund Hub"}),(0,Ot.jsx)("p",{className:"text-xl text-gray-600",children:"Revolutionizing real estate investment and community development in Nigeria"})]}),(0,Ot.jsx)("div",{className:"grid md:grid-cols-2 gap-8 max-w-6xl mx-auto",children:e.map(((e,t)=>(0,Ot.jsxs)(zc.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2*t},className:"bg-white rounded-xl shadow-lg hover:shadow-xl transition-shadow p-8",children:[(0,Ot.jsxs)("div",{className:"flex items-center gap-4 mb-6",children:[(0,Ot.jsx)("div",{className:"p-3 bg-[#1c5bde]/10 rounded-lg",children:(0,Ot.jsx)(e.icon,{className:"h-6 w-6 text-[#1c5bde]"})}),(0,Ot.jsx)("h2",{className:"text-2xl font-bold",children:e.title})]}),(0,Ot.jsx)("p",{className:"text-gray-600 mb-8",children:e.description}),(0,Ot.jsx)("div",{className:"grid grid-cols-3 gap-4 mb-8",children:e.stats.map(((e,t)=>(0,Ot.jsxs)("div",{className:"text-center",children:[(0,Ot.jsx)("div",{className:"font-bold text-lg text-[#1c5bde]",children:e.value}),(0,Ot.jsx)("div",{className:"text-sm text-gray-600",children:e.label})]},t)))}),(0,Ot.jsxs)(ut,{to:e.path,className:"inline-flex items-center gap-2 w-full justify-center px-6 py-3 bg-[#1c5bde] text-white rounded-lg hover:bg-[#0c0d8a] transition-colors",children:["Get Started",(0,Ot.jsx)(mu,{className:"h-4 w-4"})]})]},e.title)))})]})})},wL=Et("Vote",[["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}],["path",{d:"M5 7c0-1.1.9-2 2-2h10a2 2 0 0 1 2 2v12H5V7Z",key:"1ezoue"}],["path",{d:"M22 19H2",key:"nuriw5"}]]),SL=Et("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),TL=e=>{let{project:t,onVote:n}=e;const r=t.votesFor+t.votesAgainst,i=(t.votesFor/r*100).toFixed(1);return(0,Ot.jsxs)("div",{className:"bg-white rounded-lg border hover:shadow-md transition-shadow p-6",children:[(0,Ot.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,Ot.jsxs)("div",{children:[(0,Ot.jsx)("h3",{className:"font-semibold text-lg mb-1",children:t.title}),(0,Ot.jsx)("p",{className:"text-gray-600 text-sm",children:t.description})]}),(0,Ot.jsx)("span",{className:"px-2 py-1 bg-green-100 text-green-700 text-xs rounded-full",children:t.status})]}),(0,Ot.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 mb-4",children:[(0,Ot.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[(0,Ot.jsx)(tu,{className:"h-4 w-4"}),(0,Ot.jsx)("span",{children:t.location})]}),(0,Ot.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[(0,Ot.jsx)(Qu,{className:"h-4 w-4"}),(0,Ot.jsx)("span",{children:t.timeline})]}),(0,Ot.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[(0,Ot.jsx)(pL,{className:"h-4 w-4"}),(0,Ot.jsx)("span",{children:t.budget})]})]}),(0,Ot.jsxs)("div",{className:"mb-4",children:[(0,Ot.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,Ot.jsxs)("span",{children:["Votes: ",r]}),(0,Ot.jsxs)("span",{children:[i,"% Support"]})]}),(0,Ot.jsx)("div",{className:"h-2 bg-gray-100 rounded-full overflow-hidden",children:(0,Ot.jsx)("div",{className:"h-full bg-green-500 rounded-full",style:{width:"".concat(i,"%")}})})]}),(0,Ot.jsxs)("div",{className:"border-t pt-4 mt-4",children:[(0,Ot.jsx)("h4",{className:"text-sm font-medium mb-2",children:"Projected Impact"}),(0,Ot.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,Ot.jsxs)("div",{className:"text-center",children:[(0,Ot.jsx)("div",{className:"text-sm font-medium text-gray-900",children:t.impact.population}),(0,Ot.jsx)("div",{className:"text-xs text-gray-600",children:"Population"})]}),(0,Ot.jsxs)("div",{className:"text-center",children:[(0,Ot.jsx)("div",{className:"text-sm font-medium text-gray-900",children:t.impact.propertyValue}),(0,Ot.jsx)("div",{className:"text-xs text-gray-600",children:"Property Value"})]}),(0,Ot.jsxs)("div",{className:"text-center",children:[(0,Ot.jsx)("div",{className:"text-sm font-medium text-gray-900",children:t.impact.timeline}),(0,Ot.jsx)("div",{className:"text-xs text-gray-600",children:"Timeline"})]})]})]}),(0,Ot.jsxs)("button",{onClick:n,className:"w-full mt-4 px-4 py-2 bg-[#1c5bde] text-white rounded-lg hover:bg-[#0c0d8a] transition-colors flex items-center justify-center gap-2",children:["Cast Your Vote",(0,Ot.jsx)(Th,{className:"h-4 w-4"})]})]})},EL=Et("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),AL=Et("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]]),ML=Et("ThumbsDown",[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}]]),PL=e=>{let{project:n,onClose:r,onVote:i}=e;const[o,a]=(0,t.useState)(null),[s,l]=(0,t.useState)(!1);return(0,Ot.jsx)(Yt,{children:(0,Ot.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:(0,Ot.jsxs)(zc.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"bg-white rounded-2xl shadow-xl max-w-lg w-full overflow-hidden",children:[(0,Ot.jsx)("div",{className:"p-6 border-b",children:(0,Ot.jsxs)("div",{className:"flex justify-between items-start",children:[(0,Ot.jsxs)("div",{children:[(0,Ot.jsx)("h3",{className:"text-xl font-semibold mb-1",children:n.title}),(0,Ot.jsx)("p",{className:"text-sm text-gray-600",children:n.location})]}),(0,Ot.jsx)("button",{onClick:r,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:(0,Ot.jsx)(jt,{className:"h-5 w-5"})})]})}),(0,Ot.jsxs)("div",{className:"p-6 space-y-6",children:[(0,Ot.jsxs)("div",{className:"space-y-4",children:[(0,Ot.jsxs)("div",{className:"flex items-start gap-3",children:[(0,Ot.jsx)(EL,{className:"h-5 w-5 text-blue-600 mt-0.5"}),(0,Ot.jsxs)("div",{children:[(0,Ot.jsx)("h4",{className:"font-medium mb-1",children:"Impact Overview"}),(0,Ot.jsx)("p",{className:"text-sm text-gray-600",children:n.description})]})]}),(0,Ot.jsxs)("div",{className:"grid grid-cols-3 gap-4 bg-gray-50 rounded-xl p-4",children:[(0,Ot.jsxs)("div",{className:"text-center",children:[(0,Ot.jsx)("div",{className:"text-sm font-medium text-gray-900",children:n.budget}),(0,Ot.jsx)("div",{className:"text-xs text-gray-600",children:"Budget"})]}),(0,Ot.jsxs)("div",{className:"text-center",children:[(0,Ot.jsx)("div",{className:"text-sm font-medium text-gray-900",children:n.impact.population}),(0,Ot.jsx)("div",{className:"text-xs text-gray-600",children:"Beneficiaries"})]}),(0,Ot.jsxs)("div",{className:"text-center",children:[(0,Ot.jsx)("div",{className:"text-sm font-medium text-gray-900",children:n.timeline}),(0,Ot.jsx)("div",{className:"text-xs text-gray-600",children:"Timeline"})]})]})]}),(0,Ot.jsxs)("div",{className:"space-y-4",children:[(0,Ot.jsx)("h4",{className:"font-medium",children:"Cast Your Vote"}),(0,Ot.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,Ot.jsxs)("button",{onClick:()=>a(!0),className:"p-4 rounded-xl border-2 transition-all ".concat(!0===o?"border-green-500 bg-green-50":"border-gray-200 hover:border-green-500"),children:[(0,Ot.jsx)(AL,{className:"h-6 w-6 mx-auto mb-2 ".concat(!0===o?"text-green-500":"text-gray-400")}),(0,Ot.jsx)("div",{className:"text-sm font-medium",children:"Support"})]}),(0,Ot.jsxs)("button",{onClick:()=>a(!1),className:"p-4 rounded-xl border-2 transition-all ".concat(!1===o?"border-red-500 bg-red-50":"border-gray-200 hover:border-red-500"),children:[(0,Ot.jsx)(ML,{className:"h-6 w-6 mx-auto mb-2 ".concat(!1===o?"text-red-500":"text-gray-400")}),(0,Ot.jsx)("div",{className:"text-sm font-medium",children:"Oppose"})]})]})]})]}),(0,Ot.jsx)("div",{className:"p-6 border-t bg-gray-50",children:(0,Ot.jsx)("button",{onClick:async()=>{null!==o&&(l(!0),await new Promise((e=>setTimeout(e,1e3))),i(o),l(!1))},disabled:null===o||s,className:"w-full py-3 rounded-lg font-medium flex items-center justify-center gap-2\n                ".concat(null===o?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-[#1c5bde] text-white hover:bg-[#0c0d8a]"," transition-colors"),children:s?(0,Ot.jsxs)(Ot.Fragment,{children:[(0,Ot.jsx)(zc.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},children:(0,Ot.jsx)(Eh,{className:"h-5 w-5"})}),"Submitting..."]}):"Confirm Vote"})})]})})})},kL=e=>{let{onVerificationComplete:n}=e;const[r,i]=(0,t.useState)(""),[o,a]=(0,t.useState)(!1),[s,l]=(0,t.useState)("");return(0,Ot.jsxs)("div",{className:"bg-white rounded-xl border shadow-sm p-6",children:[(0,Ot.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,Ot.jsx)("div",{className:"p-2 bg-[#1c5bde]/10 rounded-lg",children:(0,Ot.jsx)(vh,{className:"h-6 w-6 text-[#1c5bde]"})}),(0,Ot.jsxs)("div",{children:[(0,Ot.jsx)("h3",{className:"font-semibold text-lg",children:"Verify Your Identity"}),(0,Ot.jsx)("p",{className:"text-sm text-gray-600",children:"Enter your NIN to start voting on community projects"})]})]}),(0,Ot.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),11===r.length){a(!0),l("");try{await new Promise((e=>setTimeout(e,2e3))),n()}catch(s){l("Verification failed. Please try again.")}finally{a(!1)}}else l("NIN must be 11 digits")},className:"space-y-4",children:[(0,Ot.jsxs)("div",{children:[(0,Ot.jsx)("label",{htmlFor:"nin",className:"block text-sm font-medium text-gray-700 mb-1",children:"National Identification Number (NIN)"}),(0,Ot.jsx)("input",{type:"text",id:"nin",value:r,onChange:e=>{const t=e.target.value.replace(/\D/g,"");t.length<=11&&i(t)},className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-[#1c5bde] focus:border-[#1c5bde] transition-colors",placeholder:"Enter your 11-digit NIN",maxLength:11}),s&&(0,Ot.jsxs)(zc.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"flex items-center gap-2 mt-2 text-red-600 text-sm",children:[(0,Ot.jsx)(EL,{className:"h-4 w-4"}),s]})]}),(0,Ot.jsxs)("div",{className:"bg-blue-50 rounded-lg p-4",children:[(0,Ot.jsx)("h4",{className:"text-sm font-medium text-blue-900 mb-2",children:"Why verify with NIN?"}),(0,Ot.jsx)("ul",{className:"space-y-2",children:["Ensure one vote per citizen","Prevent fraudulent voting","Maintain community trust","Secure blockchain verification"].map(((e,t)=>(0,Ot.jsxs)(zc.li,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1*t},className:"flex items-center gap-2 text-sm text-blue-700",children:[(0,Ot.jsx)(Eh,{className:"h-4 w-4 text-blue-500"}),e]},t)))})]}),(0,Ot.jsx)("button",{type:"submit",disabled:11!==r.length||o,className:"w-full py-3 rounded-lg font-medium flex items-center justify-center gap-2\n            ".concat(11!==r.length?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-[#1c5bde] text-white hover:bg-[#0c0d8a]"," transition-colors"),children:o?(0,Ot.jsxs)(Ot.Fragment,{children:[(0,Ot.jsx)(th,{className:"h-5 w-5 animate-spin"}),"Verifying..."]}):"Verify NIN"})]})]})},CL=()=>{const[e,n]=(0,t.useState)(!1),[r,i]=(0,t.useState)([]),[o,a]=(0,t.useState)(null),[s,l]=(0,t.useState)(!1),[c,u]=(0,t.useState)(0),h=[{id:1,title:"Gwarinpa Road Expansion",description:"Expansion of major roads in Gwarinpa to reduce traffic congestion",location:"Gwarinpa, Abuja",budget:"\u20a6500M",timeline:"12 months",votesFor:1234,votesAgainst:123,status:"active",category:"transportation",impact:{population:"50,000+",propertyValue:"+15%",timeline:"2024-2025"}},{id:2,title:"Jabi Lake Smart Lighting",description:"Installation of solar-powered smart street lights around Jabi Lake",location:"Jabi, Abuja",budget:"\u20a6150M",timeline:"6 months",votesFor:856,votesAgainst:234,status:"active",category:"utilities",impact:{population:"25,000+",propertyValue:"+8%",timeline:"2024"}}];(0,t.useEffect)((()=>{i(h)}),[]);const d=[{title:"Active Projects",value:r.length,icon:nu,color:"text-blue-600"},{title:"Community Members",value:"5,234",icon:At,color:"text-green-600"},{title:"Total Votes Cast",value:"15,678",icon:wL,color:"text-purple-600"},{title:"Projects Completed",value:"12",icon:SL,color:"text-emerald-600"}];return(0,Ot.jsxs)("div",{className:"min-h-screen bg-gray-50 pt-20",children:[(0,Ot.jsx)("section",{className:"bg-white border-b",children:(0,Ot.jsx)("div",{className:"container mx-auto px-4 py-12",children:(0,Ot.jsxs)("div",{className:"max-w-4xl mx-auto text-center",children:[(0,Ot.jsx)(zc.h1,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-3xl md:text-4xl font-bold mb-4",children:"Shape Your Community's Future"}),(0,Ot.jsx)(zc.p,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"text-gray-600 mb-8",children:"Vote on infrastructure projects that matter to your community. Verified with NIN for transparent and secure voting."}),(0,Ot.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-8",children:d.map(((e,t)=>(0,Ot.jsxs)(zc.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2+.1*t},className:"bg-white p-4 rounded-lg border hover:shadow-md transition-shadow",children:[(0,Ot.jsxs)("div",{className:"flex items-center justify-center gap-2 mb-2",children:[(0,Ot.jsx)(e.icon,{className:"h-5 w-5 ".concat(e.color)}),(0,Ot.jsx)("span",{className:"font-bold text-xl",children:e.value})]}),(0,Ot.jsx)("p",{className:"text-sm text-gray-600",children:e.title})]},e.title)))})]})})}),(0,Ot.jsx)("section",{className:"container mx-auto px-4 py-8",children:(0,Ot.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,Ot.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,Ot.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Ot.jsx)("h2",{className:"text-xl font-semibold",children:"Active Projects"}),(0,Ot.jsx)("button",{className:"text-sm text-[#1c5bde] hover:underline",children:"View All"})]}),r.map((t=>(0,Ot.jsx)(TL,{project:t,onVote:()=>{e&&(a(t),l(!0))}},t.id)))]}),(0,Ot.jsx)("div",{className:"space-y-6",children:e?(0,Ot.jsxs)("div",{className:"bg-white p-6 rounded-lg border",children:[(0,Ot.jsxs)("div",{className:"flex items-center gap-2 text-green-600 mb-4",children:[(0,Ot.jsx)(SL,{className:"h-5 w-5"}),(0,Ot.jsx)("span",{className:"font-medium",children:"Verified Voter"})]}),(0,Ot.jsxs)("p",{className:"text-sm text-gray-600 mb-4",children:["Your voting power: ",c]}),(0,Ot.jsx)("button",{className:"w-full px-4 py-2 bg-[#1c5bde] text-white rounded-lg hover:bg-[#0c0d8a] transition-colors",children:"View Voting History"})]}):(0,Ot.jsx)(kL,{onVerificationComplete:()=>n(!0)})})]})}),s&&o&&(0,Ot.jsx)(PL,{project:o,onClose:()=>l(!1),onVote:e=>{l(!1)}})]})},jL=()=>{const[e,n]=(0,t.useState)("opportunities"),r=[{title:"Total Investments",value:"\u20a6500M+",icon:Mt,color:"text-blue-600"},{title:"Active Projects",value:"15",icon:nu,color:"text-green-600"},{title:"Avg. ROI",value:"25%",icon:kt,color:"text-purple-600"},{title:"Investors",value:"5,000+",icon:pL,color:"text-orange-600"}];return(0,Ot.jsxs)("div",{className:"min-h-screen bg-gray-50 pt-20",children:[(0,Ot.jsx)("section",{className:"bg-white border-b",children:(0,Ot.jsx)("div",{className:"container mx-auto px-4 py-12",children:(0,Ot.jsxs)("div",{className:"max-w-4xl mx-auto text-center",children:[(0,Ot.jsx)(zc.h1,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-3xl md:text-4xl font-bold mb-4",children:"Smart Real Estate Investment"}),(0,Ot.jsx)(zc.p,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"text-xl text-gray-600 mb-8",children:"Start investing in premium real estate from \u20a61,000 with AI-powered insights"}),(0,Ot.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-8",children:r.map(((e,t)=>(0,Ot.jsxs)(zc.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2+.1*t},className:"bg-white p-4 rounded-xl border hover:shadow-md transition-shadow",children:[(0,Ot.jsxs)("div",{className:"flex items-center justify-center gap-2 mb-2",children:[(0,Ot.jsx)(e.icon,{className:"h-5 w-5 ".concat(e.color)}),(0,Ot.jsx)("span",{className:"font-bold text-xl",children:e.value})]}),(0,Ot.jsx)("p",{className:"text-sm text-gray-600",children:e.title})]},e.title)))})]})})}),(0,Ot.jsx)("section",{className:"container mx-auto px-4 py-8",children:(0,Ot.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,Ot.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,Ot.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Ot.jsx)("h2",{className:"text-xl font-semibold",children:"Investment Opportunities"}),(0,Ot.jsx)("div",{className:"flex items-center gap-2",children:(0,Ot.jsx)("button",{className:"text-sm text-[#1c5bde] hover:underline",children:"View All"})})]}),[{id:1,title:"Premium Office Complex",location:"Victoria Island, Lagos",type:"Commercial",minInvestment:"\u20a65,000",expectedROI:"22%",duration:"24 months",totalValue:"\u20a6500M",funded:75,risk:"Medium",highlights:["Prime location","Pre-leased to Fortune 500 company","Quarterly returns"]},{id:2,title:"Smart Homes Development",location:"Lekki Phase 1, Lagos",type:"Residential",minInvestment:"\u20a61,000",expectedROI:"18%",duration:"36 months",totalValue:"\u20a6300M",funded:45,risk:"Low",highlights:["Solar-powered homes","Smart home technology","High rental demand area"]}].map((e=>(0,Ot.jsxs)(zc.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-xl border hover:shadow-lg transition-shadow p-6",children:[(0,Ot.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,Ot.jsxs)("div",{children:[(0,Ot.jsx)("h3",{className:"font-semibold text-lg mb-1",children:e.title}),(0,Ot.jsx)("p",{className:"text-gray-600 text-sm",children:e.location})]}),(0,Ot.jsxs)("span",{className:"px-3 py-1 rounded-full text-sm font-medium\n                    ".concat("Low"===e.risk?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"),children:[e.risk," Risk"]})]}),(0,Ot.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[(0,Ot.jsxs)("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[(0,Ot.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.minInvestment}),(0,Ot.jsx)("div",{className:"text-xs text-gray-600",children:"Min. Investment"})]}),(0,Ot.jsxs)("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[(0,Ot.jsx)("div",{className:"text-sm font-medium text-green-600",children:e.expectedROI}),(0,Ot.jsx)("div",{className:"text-xs text-gray-600",children:"Expected ROI"})]}),(0,Ot.jsxs)("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[(0,Ot.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.duration}),(0,Ot.jsx)("div",{className:"text-xs text-gray-600",children:"Duration"})]})]}),(0,Ot.jsxs)("div",{className:"mb-4",children:[(0,Ot.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,Ot.jsx)("span",{children:"Funding Progress"}),(0,Ot.jsxs)("span",{children:[e.funded,"%"]})]}),(0,Ot.jsx)("div",{className:"h-2 bg-gray-100 rounded-full overflow-hidden",children:(0,Ot.jsx)("div",{className:"h-full bg-green-500 rounded-full",style:{width:"".concat(e.funded,"%")}})})]}),(0,Ot.jsxs)("div",{className:"border-t pt-4",children:[(0,Ot.jsx)("h4",{className:"text-sm font-medium mb-2",children:"Highlights"}),(0,Ot.jsx)("div",{className:"flex flex-wrap gap-2",children:e.highlights.map(((e,t)=>(0,Ot.jsx)("span",{className:"px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded-full",children:e},t)))})]}),(0,Ot.jsxs)("button",{className:"w-full mt-4 px-4 py-2 bg-[#1c5bde] text-white rounded-lg hover:bg-[#0c0d8a] transition-colors flex items-center justify-center gap-2",children:["Invest Now",(0,Ot.jsx)(mu,{className:"h-4 w-4"})]})]},e.id)))]}),(0,Ot.jsxs)("div",{className:"space-y-6",children:[(0,Ot.jsxs)("div",{className:"bg-white rounded-xl border p-6",children:[(0,Ot.jsx)("h3",{className:"font-semibold mb-4",children:"Your Portfolio"}),(0,Ot.jsxs)("div",{className:"space-y-4",children:[(0,Ot.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ot.jsx)("span",{className:"text-sm text-gray-600",children:"Total Invested"}),(0,Ot.jsx)("span",{className:"font-medium",children:"\u20a60.00"})]}),(0,Ot.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ot.jsx)("span",{className:"text-sm text-gray-600",children:"Active Investments"}),(0,Ot.jsx)("span",{className:"font-medium",children:"0"})]}),(0,Ot.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ot.jsx)("span",{className:"text-sm text-gray-600",children:"Total Returns"}),(0,Ot.jsx)("span",{className:"font-medium text-green-600",children:"\u20a60.00"})]}),(0,Ot.jsxs)("button",{className:"w-full px-4 py-2 bg-gray-100 text-gray-600 rounded-lg hover:bg-gray-200 transition-colors flex items-center justify-center gap-2",children:[(0,Ot.jsx)(eO,{className:"h-4 w-4"}),"View Details"]})]})]}),(0,Ot.jsxs)("div",{className:"bg-white rounded-xl border p-6",children:[(0,Ot.jsx)("h3",{className:"font-semibold mb-4",children:"AI Market Insights"}),(0,Ot.jsxs)("div",{className:"space-y-4",children:[(0,Ot.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-green-50 rounded-lg",children:[(0,Ot.jsx)(kt,{className:"h-5 w-5 text-green-600"}),(0,Ot.jsxs)("div",{className:"text-sm",children:[(0,Ot.jsx)("span",{className:"font-medium text-green-700",children:"+15% Growth"}),(0,Ot.jsx)("p",{className:"text-green-600",children:"Victoria Island market trend"})]})]}),(0,Ot.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-blue-50 rounded-lg",children:[(0,Ot.jsx)(Pt,{className:"h-5 w-5 text-blue-600"}),(0,Ot.jsxs)("div",{className:"text-sm",children:[(0,Ot.jsx)("span",{className:"font-medium text-blue-700",children:"High Demand"}),(0,Ot.jsx)("p",{className:"text-blue-600",children:"Commercial properties in Lekki"})]})]}),(0,Ot.jsx)("button",{className:"w-full px-4 py-2 bg-[#1c5bde] text-white rounded-lg hover:bg-[#0c0d8a] transition-colors",children:"View Full Analysis"})]})]})]})]})})]})},IL=Et("Thermometer",[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]]),OL=Et("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]),NL=Et("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]),DL=()=>{const[e,n]=(0,t.useState)("1Y"),[r,i]=(0,t.useState)(null),o=8.5,a="Hot Market",s={avgDaysOnMarket:15,listToSaleRatio:"98%",competitionLevel:"High",seasonalDemand:"Peak"},l={predictions:[{period:"Q1 2024",forecast:"+3.2%",confidence:"85%"},{period:"Q2 2024",forecast:"+2.8%",confidence:"82%"},{period:"Q3 2024",forecast:"+3.5%",confidence:"78%"},{period:"Q4 2024",forecast:"+3.0%",confidence:"75%"}],factors:[{factor:"Economic Growth",impact:"High",trend:"positive"},{factor:"Local Development",impact:"Medium",trend:"positive"},{factor:"Supply Constraints",impact:"High",trend:"negative"}]},c={ratio:.75,trend:"increasing",monthsOfInventory:2.3,newListings:"+5%",pendingSales:"+12%",buyerCompetition:{multipleOffers:"72%",avgOffersPerProperty:3.8,aboveAskingSales:"45%"}},u=[{title:"Mortgage Calculator",icon:kI,description:"Calculate monthly payments and total costs",metrics:["Principal","Interest","Term","Down Payment"]},{title:"Investment ROI",icon:kt,description:"Analyze potential return on investment",metrics:["Purchase Price","Rental Income","Appreciation","Expenses"]},{title:"Affordability Analysis",icon:AI,description:"Determine your buying power",metrics:["Income","Debt","Down Payment","Interest Rate"]},{title:"Rental Yield",icon:QI,description:"Calculate gross and net rental yields",metrics:["Purchase Price","Rental Income","Expenses","Vacancy Rate"]}];return(0,Ot.jsxs)("div",{className:"min-h-screen bg-gray-50 pt-20",children:[(0,Ot.jsx)("section",{className:"bg-white border-b",children:(0,Ot.jsx)("div",{className:"container mx-auto px-4 py-12",children:(0,Ot.jsx)(zc.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"max-w-6xl mx-auto",children:(0,Ot.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 items-center",children:[(0,Ot.jsxs)("div",{className:"text-center md:text-left",children:[(0,Ot.jsx)("h2",{className:"text-3xl font-bold mb-4",children:"Market Temperature"}),(0,Ot.jsxs)("div",{className:"flex items-center justify-center md:justify-start gap-4",children:[(0,Ot.jsxs)("div",{className:"relative w-32 h-32",children:[(0,Ot.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,Ot.jsx)(IL,{className:"h-12 w-12 text-[#1c5bde]"})}),(0,Ot.jsxs)("svg",{className:"transform -rotate-90",children:[(0,Ot.jsx)("circle",{className:"text-gray-200",strokeWidth:"8",stroke:"currentColor",fill:"transparent",r:"58",cx:"64",cy:"64"}),(0,Ot.jsx)("circle",{className:"text-[#1c5bde]",strokeWidth:"8",strokeDasharray:"".concat(36.5*o," 365"),strokeLinecap:"round",stroke:"currentColor",fill:"transparent",r:"58",cx:"64",cy:"64"})]})]}),(0,Ot.jsxs)("div",{children:[(0,Ot.jsx)("div",{className:"text-4xl font-bold text-[#1c5bde]",children:o}),(0,Ot.jsx)("div",{className:"text-lg font-medium text-gray-600",children:a})]})]})]}),(0,Ot.jsx)("div",{className:"grid grid-cols-2 gap-4",children:Object.entries(s).map((e=>{let[t,n]=e;return(0,Ot.jsxs)("div",{className:"bg-gray-50 rounded-xl p-4",children:[(0,Ot.jsx)("h3",{className:"text-sm text-gray-600 capitalize",children:t.replace(/([A-Z])/g," $1").trim()}),(0,Ot.jsx)("div",{className:"text-xl font-bold text-[#1c5bde]",children:n})]},t)}))})]})})})}),(0,Ot.jsx)("section",{className:"container mx-auto px-4 py-12",children:(0,Ot.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm p-8",children:[(0,Ot.jsx)("h2",{className:"text-2xl font-bold mb-8",children:"Price Forecast"}),(0,Ot.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,Ot.jsx)("div",{className:"lg:col-span-2 grid grid-cols-2 md:grid-cols-4 gap-4",children:l.predictions.map((e=>(0,Ot.jsxs)("div",{className:"bg-gray-50 rounded-xl p-4",children:[(0,Ot.jsx)("div",{className:"text-sm text-gray-600 mb-2",children:e.period}),(0,Ot.jsx)("div",{className:"text-2xl font-bold text-green-600",children:e.forecast}),(0,Ot.jsxs)("div",{className:"text-sm text-gray-500",children:["Confidence: ",e.confidence]})]},e.period)))}),(0,Ot.jsxs)("div",{className:"space-y-4",children:[(0,Ot.jsx)("h3",{className:"font-semibold text-gray-700",children:"Impact Factors"}),l.factors.map((e=>(0,Ot.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[(0,Ot.jsx)("div",{className:"p-2 rounded-full ".concat("positive"===e.trend?"bg-green-100 text-green-600":"bg-red-100 text-red-600"),children:"positive"===e.trend?(0,Ot.jsx)(OL,{className:"h-4 w-4"}):(0,Ot.jsx)(NL,{className:"h-4 w-4"})}),(0,Ot.jsxs)("div",{children:[(0,Ot.jsx)("div",{className:"font-medium",children:e.factor}),(0,Ot.jsxs)("div",{className:"text-sm text-gray-600",children:["Impact: ",e.impact]})]})]},e.factor)))]})]})]})}),(0,Ot.jsx)("section",{className:"container mx-auto px-4 pb-12",children:(0,Ot.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm p-8",children:[(0,Ot.jsx)("h2",{className:"text-2xl font-bold mb-8",children:"Supply & Demand"}),(0,Ot.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,Ot.jsxs)("div",{className:"space-y-6",children:[(0,Ot.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ot.jsxs)("div",{children:[(0,Ot.jsx)("h3",{className:"font-semibold",children:"Market Balance"}),(0,Ot.jsx)("p",{className:"text-sm text-gray-600",children:"Supply vs Demand Ratio"})]}),(0,Ot.jsx)("div",{className:"text-2xl font-bold text-[#1c5bde]",children:c.ratio.toFixed(2)})]}),(0,Ot.jsx)("div",{className:"h-2 bg-gray-100 rounded-full",children:(0,Ot.jsx)("div",{className:"h-full bg-[#1c5bde] rounded-full",style:{width:"".concat(100*c.ratio,"%")}})}),(0,Ot.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,Ot.jsxs)("div",{className:"bg-gray-50 rounded-xl p-4",children:[(0,Ot.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"Months of Inventory"}),(0,Ot.jsx)("div",{className:"text-xl font-bold",children:c.monthsOfInventory})]}),(0,Ot.jsxs)("div",{className:"bg-gray-50 rounded-xl p-4",children:[(0,Ot.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"New Listings"}),(0,Ot.jsx)("div",{className:"text-xl font-bold text-green-600",children:c.newListings})]})]})]}),(0,Ot.jsxs)("div",{className:"bg-gray-50 rounded-xl p-6",children:[(0,Ot.jsx)("h3",{className:"font-semibold mb-4",children:"Buyer Competition"}),(0,Ot.jsxs)("div",{className:"space-y-4",children:[(0,Ot.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ot.jsx)("span",{className:"text-gray-600",children:"Multiple Offers"}),(0,Ot.jsx)("span",{className:"font-medium",children:c.buyerCompetition.multipleOffers})]}),(0,Ot.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ot.jsx)("span",{className:"text-gray-600",children:"Avg Offers/Property"}),(0,Ot.jsx)("span",{className:"font-medium",children:c.buyerCompetition.avgOffersPerProperty})]}),(0,Ot.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ot.jsx)("span",{className:"text-gray-600",children:"Above Asking"}),(0,Ot.jsx)("span",{className:"font-medium",children:c.buyerCompetition.aboveAskingSales})]})]})]})]})]})}),(0,Ot.jsx)("section",{className:"container mx-auto px-4 py-12",children:(0,Ot.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm p-8",children:[(0,Ot.jsx)("h2",{className:"text-2xl font-bold mb-8",children:"Financial Tools"}),(0,Ot.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:u.map((e=>(0,Ot.jsxs)(zc.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-gray-50 rounded-xl p-6 hover:shadow-md transition-all",children:[(0,Ot.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,Ot.jsx)("div",{className:"p-3 bg-[#1c5bde]/10 rounded-lg",children:(0,Ot.jsx)(e.icon,{className:"h-6 w-6 text-[#1c5bde]"})}),(0,Ot.jsx)("h3",{className:"font-semibold",children:e.title})]}),(0,Ot.jsx)("p",{className:"text-gray-600 text-sm mb-4",children:e.description}),(0,Ot.jsx)("div",{className:"text-sm text-gray-500",children:e.metrics.map(((t,n)=>(0,Ot.jsxs)("span",{className:"inline-block",children:[t,n<e.metrics.length-1?" \u2022 ":""]},t)))}),(0,Ot.jsx)("button",{className:"w-full mt-4 px-4 py-2 bg-[#1c5bde] text-white rounded-lg hover:bg-[#0c0d8a] transition-colors",children:"Calculate Now"})]},e.title)))})]})}),(0,Ot.jsx)("section",{className:"container mx-auto px-4 py-12",children:(0,Ot.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm p-8",children:[(0,Ot.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,Ot.jsx)("h2",{className:"text-2xl font-bold",children:"Market News & Updates"}),(0,Ot.jsxs)("button",{className:"text-[#1c5bde] hover:underline flex items-center gap-1",children:["View All ",(0,Ot.jsx)(Th,{className:"h-4 w-4"})]})]}),(0,Ot.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[{category:"Policy Update",title:"New Housing Regulations Announced",summary:"Government introduces new policies to boost affordable housing",date:"2 hours ago",impact:"High",source:"Housing Authority"},{category:"Market Insight",title:"Property Prices Show Strong Growth",summary:"Q1 2024 shows 15% YoY increase in premium locations",date:"1 day ago",impact:"Medium",source:"Market Analysis"},{category:"Development",title:"Major Infrastructure Project Announced",summary:"New transportation hub to boost property values",date:"2 days ago",impact:"High",source:"Urban Planning"}].map((e=>(0,Ot.jsxs)(zc.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"border rounded-xl p-6",children:[(0,Ot.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,Ot.jsx)("span",{className:"px-2 py-1 bg-[#1c5bde]/10 text-[#1c5bde] text-sm rounded-full",children:e.category}),(0,Ot.jsx)("span",{className:"text-sm text-gray-500",children:e.date})]}),(0,Ot.jsx)("h3",{className:"font-semibold mb-2",children:e.title}),(0,Ot.jsx)("p",{className:"text-gray-600 text-sm mb-4",children:e.summary}),(0,Ot.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,Ot.jsxs)("span",{className:"text-gray-500",children:["Source: ",e.source]}),(0,Ot.jsxs)("span",{className:"px-2 py-1 rounded-full ".concat("High"===e.impact?"bg-red-100 text-red-600":"bg-yellow-100 text-yellow-600"),children:[e.impact," Impact"]})]})]},e.title)))})]})}),(0,Ot.jsx)("section",{className:"container mx-auto px-4 py-12",children:(0,Ot.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm p-8",children:[(0,Ot.jsx)("h2",{className:"text-2xl font-bold mb-8",children:"Expert Insights"}),(0,Ot.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[{name:"Dr. Sarah Johnson",role:"Chief Market Analyst",image:"/experts/sarah.jpg",prediction:"Market set for steady growth in Q2",confidence:85,keyPoints:["Strong economic indicators","Infrastructure development","Growing foreign investment"]},{name:"Michael Chen",role:"Investment Strategist",image:"/experts/michael.jpg",prediction:"Premium locations to outperform market",confidence:78,keyPoints:["Limited supply in prime areas","High rental demand","Corporate expansion plans"]}].map((e=>(0,Ot.jsxs)(zc.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex gap-6 bg-gray-50 rounded-xl p-6",children:[(0,Ot.jsx)("div",{className:"flex-shrink-0",children:(0,Ot.jsx)("img",{src:e.image,alt:e.name,className:"w-16 h-16 rounded-full object-cover"})}),(0,Ot.jsxs)("div",{children:[(0,Ot.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,Ot.jsx)("h3",{className:"font-semibold",children:e.name}),(0,Ot.jsx)("span",{className:"text-sm text-gray-500",children:"\u2022"}),(0,Ot.jsx)("span",{className:"text-sm text-gray-500",children:e.role})]}),(0,Ot.jsx)("p",{className:"text-gray-800 mb-3",children:e.prediction}),(0,Ot.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,Ot.jsx)("div",{className:"flex-grow h-2 bg-gray-200 rounded-full",children:(0,Ot.jsx)("div",{className:"h-full bg-[#1c5bde] rounded-full",style:{width:"".concat(e.confidence,"%")}})}),(0,Ot.jsxs)("span",{className:"text-sm text-gray-600",children:[e.confidence,"% confidence"]})]}),(0,Ot.jsx)("div",{className:"space-y-1",children:e.keyPoints.map(((e,t)=>(0,Ot.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[(0,Ot.jsx)("div",{className:"w-1.5 h-1.5 rounded-full bg-[#1c5bde]"}),e]},t)))})]})]},e.name)))})]})})]})},LL=Et("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]),zL=Et("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),RL=Et("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),FL=()=>{const e=[{title:"Infrastructure Analysis",description:"Comprehensive scoring and insights for infrastructure quality across different regions",icon:Pt,path:"/infrastructure/analysis",stats:[{label:"Regions Analyzed",value:"50+"},{label:"Data Points",value:"10,000+"},{label:"Updated",value:"Daily"}]},{title:"Market Trends",description:"Real-time market analysis and property value trends based on infrastructure development",icon:kt,path:"/infrastructure/market",stats:[{label:"Price Trends",value:"Live"},{label:"Market Insights",value:"24/7"},{label:"Historical Data",value:"5 Years"}]}],t=[{icon:LL,title:"Infrastructure Impact",description:"See how infrastructure development directly affects property values"},{icon:zL,title:"Real-time Updates",description:"Get instant notifications about infrastructure changes in your area"},{icon:vh,title:"Risk Assessment",description:"Evaluate infrastructure-related risks before investing"},{icon:RL,title:"Growth Opportunities",description:"Identify areas with high infrastructure development potential"}];return(0,Ot.jsxs)("div",{className:"min-h-screen bg-[#f8fafc] pt-20",children:[(0,Ot.jsx)("section",{className:"bg-gradient-to-b from-white to-[#f8fafc] border-b",children:(0,Ot.jsx)("div",{className:"container mx-auto px-4 py-16",children:(0,Ot.jsxs)("div",{className:"max-w-4xl mx-auto text-center",children:[(0,Ot.jsx)(zc.h1,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-4xl md:text-5xl font-bold mb-6 bg-gradient-to-r from-[#1c5bde] to-[#1c5bde]/80 bg-clip-text text-transparent",children:"Infrastructure Intelligence"}),(0,Ot.jsx)(zc.p,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"text-xl text-neutral-600 mb-8",children:"Make informed investment decisions with our comprehensive infrastructure analysis tools"})]})})}),(0,Ot.jsx)("section",{className:"container mx-auto px-4 py-16",children:(0,Ot.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:e.map(((e,t)=>(0,Ot.jsxs)(zc.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2*t},className:"bg-white rounded-2xl shadow-sm hover:shadow-md transition-all duration-300 border border-[#1c5bde]/10",children:[(0,Ot.jsxs)("div",{className:"flex items-center gap-4 p-8",children:[(0,Ot.jsx)("div",{className:"p-3 bg-[#1c5bde]/10 rounded-xl",children:(0,Ot.jsx)(e.icon,{className:"h-8 w-8 text-[#1c5bde]"})}),(0,Ot.jsx)("h2",{className:"text-2xl font-bold text-neutral-800",children:e.title})]}),(0,Ot.jsxs)("div",{className:"px-8 pb-8",children:[(0,Ot.jsx)("p",{className:"text-neutral-600 mb-8",children:e.description}),(0,Ot.jsx)("div",{className:"grid grid-cols-3 gap-4 mb-8",children:e.stats.map(((e,t)=>(0,Ot.jsxs)("div",{className:"text-center p-3 rounded-lg bg-[#f8fafc]",children:[(0,Ot.jsx)("div",{className:"font-bold text-lg text-[#1c5bde]",children:e.value}),(0,Ot.jsx)("div",{className:"text-sm text-neutral-600",children:e.label})]},t)))}),(0,Ot.jsxs)(ut,{to:e.path,className:"inline-flex items-center gap-2 w-full justify-center px-6 py-3 bg-[#1c5bde] text-white rounded-xl hover:bg-[#1c5bde]/90 transition-all duration-300 shadow-sm hover:shadow-[#1c5bde]/25 hover:shadow-lg",children:["Explore ",e.title,(0,Ot.jsx)(mu,{className:"h-4 w-4"})]})]})]},e.title)))})}),(0,Ot.jsx)("section",{className:"bg-white border-y border-[#1c5bde]/10",children:(0,Ot.jsxs)("div",{className:"container mx-auto px-4 py-16",children:[(0,Ot.jsxs)("div",{className:"text-center mb-12",children:[(0,Ot.jsx)("h2",{className:"text-3xl font-bold mb-4 bg-gradient-to-r from-[#1c5bde] to-[#1c5bde]/80 bg-clip-text text-transparent",children:"Key Insights"}),(0,Ot.jsx)("p",{className:"text-neutral-600",children:"Leverage our infrastructure data to make better investment decisions"})]}),(0,Ot.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8",children:t.map(((e,t)=>(0,Ot.jsxs)(zc.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*t},className:"text-center group hover:scale-105 transition-all duration-300",children:[(0,Ot.jsx)("div",{className:"bg-[#1c5bde]/5 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4 group-hover:bg-[#1c5bde]/10 transition-colors",children:(0,Ot.jsx)(e.icon,{className:"h-8 w-8 text-[#1c5bde]"})}),(0,Ot.jsx)("h3",{className:"font-semibold text-lg mb-2 text-neutral-800",children:e.title}),(0,Ot.jsx)("p",{className:"text-neutral-600",children:e.description})]},e.title)))})]})}),(0,Ot.jsx)("section",{className:"container mx-auto px-4 py-16",children:(0,Ot.jsxs)("div",{className:"bg-gradient-to-br from-[#1c5bde] to-[#1c5bde]/90 rounded-2xl p-8 md:p-12 text-center text-white shadow-lg",children:[(0,Ot.jsx)("h2",{className:"text-3xl font-bold mb-4",children:"Ready to Make Data-Driven Decisions?"}),(0,Ot.jsx)("p",{className:"text-lg opacity-90 mb-8",children:"Start exploring our infrastructure analysis tools today"}),(0,Ot.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[(0,Ot.jsxs)(ut,{to:"/infrastructure/analysis",className:"inline-flex items-center justify-center gap-2 px-6 py-3 bg-white text-[#1c5bde] rounded-xl hover:bg-[#f8fafc] transition-all duration-300 shadow-sm hover:shadow-lg",children:["Start Analysis",(0,Ot.jsx)(Th,{className:"h-4 w-4"})]}),(0,Ot.jsxs)(ut,{to:"/infrastructure/market",className:"inline-flex items-center justify-center gap-2 px-6 py-3 bg-[#ff8533] text-white rounded-xl hover:bg-[#ff8533]/90 transition-all duration-300 shadow-sm hover:shadow-lg",children:["View Market Trends",(0,Ot.jsx)(Th,{className:"h-4 w-4"})]})]})]})})]})},BL=Et("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),VL=Et("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),UL=()=>(0,Ot.jsxs)("svg",{viewBox:"0 0 24 24",className:"h-5 w-5","aria-hidden":"true",children:[(0,Ot.jsx)("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),(0,Ot.jsx)("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),(0,Ot.jsx)("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),(0,Ot.jsx)("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),GL=()=>(0,Ot.jsx)("svg",{viewBox:"0 0 24 24",className:"h-5 w-5",fill:"currentColor","aria-hidden":"true",children:(0,Ot.jsx)("path",{d:"M12.152 6.896c-.948 0-2.415-1.078-3.96-1.04-2.04.027-3.91 1.183-4.961 3.014-2.117 3.675-.546 9.103 1.519 12.09 1.013 1.454 2.208 3.09 3.792 3.039 1.52-.065 2.09-.987 3.935-.987 1.831 0 2.35.987 3.96.948 1.637-.026 2.676-1.48 3.676-2.948 1.156-1.688 1.636-3.325 1.662-3.415-.039-.013-3.182-1.221-3.22-4.857-.026-3.04 2.48-4.494 2.597-4.559-1.429-2.09-3.623-2.324-4.39-2.376-2-.156-3.675 1.09-4.61 1.09zM15.53 3.83c.843-1.012 1.4-2.427 1.245-3.83-1.207.052-2.662.805-3.532 1.818-.78.896-1.454 2.338-1.273 3.714 1.338.104 2.715-.688 3.559-1.701"})}),HL=()=>{const[e,n]=(0,t.useState)(!1),[r,i]=(0,t.useState)({email:"",password:"",rememberMe:!1});return(0,Ot.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-[#f8fafc] via-white to-[#1c5bde]/5 flex items-center justify-center p-4",children:(0,Ot.jsxs)("div",{className:"w-full max-w-4xl grid grid-cols-1 lg:grid-cols-2 gap-8 items-center",children:[(0,Ot.jsxs)("div",{className:"bg-white p-8 rounded-2xl shadow-xl shadow-[#1c5bde]/10 border border-[#1c5bde]/10",children:[(0,Ot.jsxs)(zc.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center mb-8",children:[(0,Ot.jsx)(ut,{to:"/",className:"inline-block mb-6",children:(0,Ot.jsx)("img",{src:Rc,alt:"FastFind360 Logo",className:"h-8 w-auto"})}),(0,Ot.jsx)("h1",{className:"text-2xl font-bold mb-2 bg-gradient-to-r from-[#1c5bde] to-[#1c5bde]/80 bg-clip-text text-transparent",children:"Welcome Back"}),(0,Ot.jsx)("p",{className:"text-neutral-600",children:"Sign in to your FastFind360 account"})]}),(0,Ot.jsxs)(zc.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-6",children:[(0,Ot.jsxs)("div",{children:[(0,Ot.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-1.5",children:"Email address"}),(0,Ot.jsxs)("div",{className:"relative",children:[(0,Ot.jsx)("input",{type:"email",value:r.email,onChange:e=>i(c(c({},r),{},{email:e.target.value})),className:"w-full px-4 py-3 rounded-xl border border-[#1c5bde]/20  focus:outline-none focus:ring-2 focus:ring-[#1c5bde]/20 focus:border-[#1c5bde] pl-11 transition-all",placeholder:"Enter your email"}),(0,Ot.jsx)(Bj,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-neutral-400"})]})]}),(0,Ot.jsxs)("div",{children:[(0,Ot.jsxs)("div",{className:"flex justify-between items-center mb-1.5",children:[(0,Ot.jsx)("label",{className:"block text-sm font-medium text-neutral-700",children:"Password"}),(0,Ot.jsx)(ut,{to:"/forgot-password",className:"text-sm text-[#1c5bde] hover:text-[#1c5bde]/80 transition-colors",children:"Forgot password?"})]}),(0,Ot.jsxs)("div",{className:"relative",children:[(0,Ot.jsx)("input",{type:e?"text":"password",value:r.password,onChange:e=>i(c(c({},r),{},{password:e.target.value})),className:"w-full px-4 py-3 rounded-xl border border-[#1c5bde]/20  focus:outline-none focus:ring-2 focus:ring-[#1c5bde]/20 focus:border-[#1c5bde] pl-11 pr-11 transition-all",placeholder:"Enter your password"}),(0,Ot.jsx)(BL,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-neutral-400"}),(0,Ot.jsx)("button",{type:"button",onClick:()=>n(!e),className:"absolute right-4 top-1/2 -translate-y-1/2 text-neutral-400 hover:text-neutral-600",children:e?(0,Ot.jsx)(VL,{className:"h-5 w-5"}):(0,Ot.jsx)(Qc,{className:"h-5 w-5"})})]})]}),(0,Ot.jsxs)("div",{className:"flex items-center",children:[(0,Ot.jsx)("input",{type:"checkbox",id:"remember-me",checked:r.rememberMe,onChange:e=>i(c(c({},r),{},{rememberMe:e.target.checked})),className:"h-4 w-4 rounded border-[#1c5bde]/20 text-[#1c5bde] focus:ring-[#1c5bde]/20"}),(0,Ot.jsx)("label",{htmlFor:"remember-me",className:"ml-2 text-sm text-neutral-600",children:"Remember me"})]}),(0,Ot.jsx)(zc.button,{whileHover:{scale:1.01},whileTap:{scale:.99},className:"w-full px-4 py-3 rounded-xl bg-[#1c5bde] text-white  hover:bg-[#1c5bde]/90 transition-all font-medium",children:"Sign In"}),(0,Ot.jsxs)("div",{className:"relative",children:[(0,Ot.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,Ot.jsx)("div",{className:"w-full border-t border-[#1c5bde]/10"})}),(0,Ot.jsx)("div",{className:"relative flex justify-center text-sm",children:(0,Ot.jsx)("span",{className:"px-2 bg-white text-neutral-500",children:"or continue with"})})]}),(0,Ot.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,Ot.jsxs)(zc.button,{whileHover:{scale:1.01},whileTap:{scale:.99},className:"flex items-center justify-center gap-2 p-3 rounded-xl border border-[#1c5bde]/10  hover:border-[#1c5bde]/20 hover:bg-[#1c5bde]/5 transition-all",children:[(0,Ot.jsx)(UL,{}),(0,Ot.jsx)("span",{className:"font-medium",children:"Google"})]}),(0,Ot.jsxs)(zc.button,{whileHover:{scale:1.01},whileTap:{scale:.99},className:"flex items-center justify-center gap-2 p-3 rounded-xl border border-[#1c5bde]/10  hover:border-[#1c5bde]/20 hover:bg-[#1c5bde]/5 transition-all",children:[(0,Ot.jsx)(GL,{}),(0,Ot.jsx)("span",{className:"font-medium",children:"Apple"})]})]})]}),(0,Ot.jsxs)("p",{className:"mt-8 text-center text-sm text-neutral-600",children:["Don't have an account?"," ",(0,Ot.jsx)(ut,{to:"/signup",className:"font-semibold text-[#1c5bde] hover:text-[#1c5bde]/80 transition-colors",children:"Get Started"})]})]}),(0,Ot.jsx)("div",{className:"hidden lg:block",children:(0,Ot.jsxs)(zc.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-[#1c5bde]/5 rounded-2xl p-8 border border-[#1c5bde]/10",children:[(0,Ot.jsx)("h2",{className:"text-xl font-bold mb-6 text-neutral-800",children:"Account Benefits"}),(0,Ot.jsx)("div",{className:"space-y-6",children:[{title:"Saved Properties",description:"Save and track your favorite properties"},{title:"Property Alerts",description:"Get notified about new properties matching your criteria"},{title:"Investment Dashboard",description:"Track your property investments in one place"},{title:"Community Voting",description:"Participate in infrastructure development decisions"}].map(((e,t)=>(0,Ot.jsxs)(zc.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.3+.1*t},className:"flex gap-3",children:[(0,Ot.jsx)("div",{className:"mt-1",children:(0,Ot.jsx)(SL,{className:"h-5 w-5 text-[#1c5bde]"})}),(0,Ot.jsxs)("div",{children:[(0,Ot.jsx)("h3",{className:"font-medium text-neutral-800 mb-1",children:e.title}),(0,Ot.jsx)("p",{className:"text-sm text-neutral-600",children:e.description})]})]},t)))})]})})]})})},ZL=()=>(0,Ot.jsxs)("svg",{viewBox:"0 0 24 24",className:"h-5 w-5","aria-hidden":"true",children:[(0,Ot.jsx)("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),(0,Ot.jsx)("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),(0,Ot.jsx)("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),(0,Ot.jsx)("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),qL=()=>(0,Ot.jsx)("svg",{viewBox:"0 0 24 24",className:"h-5 w-5",fill:"currentColor","aria-hidden":"true",children:(0,Ot.jsx)("path",{d:"M12.152 6.896c-.948 0-2.415-1.078-3.96-1.04-2.04.027-3.91 1.183-4.961 3.014-2.117 3.675-.546 9.103 1.519 12.09 1.013 1.454 2.208 3.09 3.792 3.039 1.52-.065 2.09-.987 3.935-.987 1.831 0 2.35.987 3.96.948 1.637-.026 2.676-1.48 3.676-2.948 1.156-1.688 1.636-3.325 1.662-3.415-.039-.013-3.182-1.221-3.22-4.857-.026-3.04 2.48-4.494 2.597-4.559-1.429-2.09-3.623-2.324-4.39-2.376-2-.156-3.675 1.09-4.61 1.09zM15.53 3.83c.843-1.012 1.4-2.427 1.245-3.83-1.207.052-2.662.805-3.532 1.818-.78.896-1.454 2.338-1.273 3.714 1.338.104 2.715-.688 3.559-1.701"})}),WL=()=>{const[e,n]=(0,t.useState)(1),[r,i]=(0,t.useState)(!1),[o,a]=(0,t.useState)({email:"",phone:"",password:"",accountType:""}),s=[{id:"personal",title:"Home Seeker",description:"Looking to buy, rent, or invest in properties",icon:$c,color:"bg-emerald-50 text-emerald-600"},{id:"agent",title:"Real Estate Agent",description:"Professional real estate agent or property manager",icon:lu,color:"bg-blue-50 text-blue-600"},{id:"developer",title:"Property Developer",description:"Property development and construction company",icon:dj,color:"bg-purple-50 text-purple-600"}],l=[{title:"Account Type",completed:e>1},{title:"Personal Info",completed:e>2},{title:"Verification",completed:!1}];return(0,Ot.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-[#f8fafc] via-white to-[#1c5bde]/5 flex items-center justify-center py-2 px-4 pt-24",children:(0,Ot.jsxs)("div",{className:"w-full max-w-4xl grid grid-cols-1 lg:grid-cols-2 gap-8 items-center",children:[(0,Ot.jsxs)("div",{className:"bg-white p-8 rounded-2xl shadow-xl shadow-[#1c5bde]/10 border border-[#1c5bde]/10",children:[(0,Ot.jsxs)(zc.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center mb-8",children:[(0,Ot.jsx)(ut,{to:"/",className:"inline-block mb-6",children:(0,Ot.jsx)("img",{src:Rc,alt:"FastFind360 Logo",className:"h-8 w-auto"})}),(0,Ot.jsx)("h1",{className:"text-2xl font-bold mb-2 bg-gradient-to-r from-[#1c5bde] to-[#1c5bde]/80 bg-clip-text text-transparent",children:"Create Your Account"}),(0,Ot.jsx)("p",{className:"text-neutral-600",children:"Join Nigeria's leading property platform"})]}),(0,Ot.jsx)("div",{className:"flex justify-between mb-8 text-xs sm:text-sm",children:l.map(((e,t)=>(0,Ot.jsxs)("div",{className:"flex items-center flex-1",children:[(0,Ot.jsx)("div",{className:"flex items-center justify-center w-6 h-6 sm:w-8 sm:h-8 rounded-full \n                  ".concat(e.completed?"bg-[#1c5bde] text-white":"bg-[#1c5bde]/10 text-[#1c5bde]"),children:e.completed?(0,Ot.jsx)(SL,{className:"h-4 w-4 sm:h-5 sm:w-5"}):t+1}),(0,Ot.jsx)("span",{className:"ml-2 font-medium text-neutral-600 whitespace-nowrap",children:e.title}),t<l.length-1&&(0,Ot.jsx)("div",{className:"w-full h-0.5 mx-2 ".concat(e.completed?"bg-[#1c5bde]":"bg-[#1c5bde]/10")})]},t)))}),(0,Ot.jsxs)(Yt,{mode:"wait",children:[1===e&&(0,Ot.jsxs)(zc.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-6",children:[(0,Ot.jsx)("div",{className:"space-y-4",children:s.map((e=>(0,Ot.jsx)(zc.button,{whileHover:{scale:1.01},whileTap:{scale:.99},onClick:()=>{a(c(c({},o),{},{accountType:e.id})),n(2)},className:"w-full p-4 rounded-xl text-left transition-all border group\n                        ".concat(o.accountType===e.id?"border-[#1c5bde] bg-[#1c5bde]/5":"border-[#1c5bde]/10 hover:border-[#1c5bde]/20 hover:bg-[#1c5bde]/5"),children:(0,Ot.jsxs)("div",{className:"flex items-start gap-4",children:[(0,Ot.jsx)("div",{className:"p-2 rounded-lg ".concat(e.color),children:(0,Ot.jsx)(e.icon,{className:"h-6 w-6"})}),(0,Ot.jsxs)("div",{className:"flex-1",children:[(0,Ot.jsxs)("h3",{className:"font-semibold text-neutral-800 mb-1 flex items-center justify-between",children:[e.title,(0,Ot.jsx)(mu,{className:"h-5 w-5 transition-colors\n                              ".concat(o.accountType===e.id?"text-[#1c5bde]":"text-neutral-400 group-hover:text-[#1c5bde]")})]}),(0,Ot.jsx)("p",{className:"text-sm text-neutral-600",children:e.description})]})]})},e.id)))}),(0,Ot.jsxs)("div",{className:"relative",children:[(0,Ot.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,Ot.jsx)("div",{className:"w-full border-t border-[#1c5bde]/10"})}),(0,Ot.jsx)("div",{className:"relative flex justify-center text-sm",children:(0,Ot.jsx)("span",{className:"px-2 bg-white text-neutral-500",children:"or continue with"})})]}),(0,Ot.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,Ot.jsxs)(zc.button,{whileHover:{scale:1.01},whileTap:{scale:.99},className:"flex items-center justify-center gap-2 p-3 rounded-xl border border-[#1c5bde]/10  hover:border-[#1c5bde]/20 hover:bg-[#1c5bde]/5 transition-all",children:[(0,Ot.jsx)(ZL,{}),(0,Ot.jsx)("span",{className:"font-medium",children:"Google"})]}),(0,Ot.jsxs)(zc.button,{whileHover:{scale:1.01},whileTap:{scale:.99},className:"flex items-center justify-center gap-2 p-3 rounded-xl border border-[#1c5bde]/10  hover:border-[#1c5bde]/20 hover:bg-[#1c5bde]/5 transition-all",children:[(0,Ot.jsx)(qL,{}),(0,Ot.jsx)("span",{className:"font-medium",children:"Apple"})]})]})]},"step1"),2===e&&(0,Ot.jsxs)(zc.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-6",children:[(0,Ot.jsxs)("div",{className:"space-y-4",children:[(0,Ot.jsxs)("div",{children:[(0,Ot.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-neutral-700 mb-1",children:"Email Address"}),(0,Ot.jsxs)("div",{className:"relative",children:[(0,Ot.jsx)(Bj,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-neutral-400"}),(0,Ot.jsx)("input",{type:"email",id:"email",value:o.email,onChange:e=>a(c(c({},o),{},{email:e.target.value})),className:"w-full pl-10 pr-4 py-2 border border-[#1c5bde]/10 rounded-xl focus:outline-none focus:border-[#1c5bde]",placeholder:"Enter your email"})]})]}),(0,Ot.jsxs)("div",{children:[(0,Ot.jsx)("label",{htmlFor:"phone",className:"block text-sm font-medium text-neutral-700 mb-1",children:"Phone Number"}),(0,Ot.jsxs)("div",{className:"relative",children:[(0,Ot.jsx)(Vj,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-neutral-400"}),(0,Ot.jsx)("input",{type:"tel",id:"phone",value:o.phone,onChange:e=>a(c(c({},o),{},{phone:e.target.value})),className:"w-full pl-10 pr-4 py-2 border border-[#1c5bde]/10 rounded-xl focus:outline-none focus:border-[#1c5bde]",placeholder:"Enter your phone number"})]})]}),(0,Ot.jsxs)("div",{children:[(0,Ot.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-neutral-700 mb-1",children:"Password"}),(0,Ot.jsxs)("div",{className:"relative",children:[(0,Ot.jsx)(BL,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-neutral-400"}),(0,Ot.jsx)("input",{type:r?"text":"password",id:"password",value:o.password,onChange:e=>a(c(c({},o),{},{password:e.target.value})),className:"w-full pl-10 pr-12 py-2 border border-[#1c5bde]/10 rounded-xl focus:outline-none focus:border-[#1c5bde]",placeholder:"Create a password"}),(0,Ot.jsx)("button",{type:"button",onClick:()=>i(!r),className:"absolute right-3 top-1/2 -translate-y-1/2",children:r?(0,Ot.jsx)(VL,{className:"h-5 w-5 text-neutral-400"}):(0,Ot.jsx)(Qc,{className:"h-5 w-5 text-neutral-400"})})]})]})]}),(0,Ot.jsxs)("div",{className:"flex gap-4",children:[(0,Ot.jsx)(zc.button,{whileHover:{scale:1.01},whileTap:{scale:.99},onClick:()=>n(1),className:"flex-1 py-2 rounded-xl border border-[#1c5bde]/10 hover:bg-[#1c5bde]/5",children:"Back"}),(0,Ot.jsx)(zc.button,{whileHover:{scale:1.01},whileTap:{scale:.99},onClick:()=>n(3),className:"flex-1 py-2 rounded-xl bg-[#1c5bde] text-white hover:bg-[#1c5bde]/90",children:"Continue"})]})]},"step2"),3===e&&(0,Ot.jsxs)(zc.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-6",children:[(0,Ot.jsxs)("div",{className:"text-center",children:[(0,Ot.jsx)("div",{className:"mb-4 inline-flex items-center justify-center w-16 h-16 rounded-full bg-[#1c5bde]/10",children:(0,Ot.jsx)(Bj,{className:"h-8 w-8 text-[#1c5bde]"})}),(0,Ot.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Verify Your Email"}),(0,Ot.jsxs)("p",{className:"text-neutral-600",children:["We've sent a verification code to",(0,Ot.jsx)("br",{}),(0,Ot.jsx)("span",{className:"font-medium text-neutral-800",children:o.email})]})]}),(0,Ot.jsx)("div",{className:"flex gap-4 justify-center",children:[1,2,3,4].map(((e,t)=>(0,Ot.jsx)("input",{type:"text",maxLength:"1",className:"w-12 h-12 text-center text-lg font-semibold border border-[#1c5bde]/10 rounded-xl focus:outline-none focus:border-[#1c5bde]"},t)))}),(0,Ot.jsxs)("div",{className:"flex gap-4",children:[(0,Ot.jsx)(zc.button,{whileHover:{scale:1.01},whileTap:{scale:.99},onClick:()=>n(2),className:"flex-1 py-2 rounded-xl border border-[#1c5bde]/10 hover:bg-[#1c5bde]/5",children:"Back"}),(0,Ot.jsx)(zc.button,{whileHover:{scale:1.01},whileTap:{scale:.99},className:"flex-1 py-2 rounded-xl bg-[#1c5bde] text-white hover:bg-[#1c5bde]/90",children:"Verify Email"})]}),(0,Ot.jsxs)("p",{className:"text-center text-sm text-neutral-600",children:["Didn't receive the code?"," ",(0,Ot.jsx)("button",{className:"font-semibold text-[#1c5bde] hover:text-[#1c5bde]/80",children:"Resend"})]})]},"step3")]}),(0,Ot.jsxs)("p",{className:"mt-8 text-center text-sm text-neutral-600",children:["Already have an account?"," ",(0,Ot.jsx)(ut,{to:"/signin",className:"font-semibold text-[#1c5bde] hover:text-[#1c5bde]/80 transition-colors",children:"Sign in"})]})]}),(0,Ot.jsx)("div",{className:"hidden lg:block",children:(0,Ot.jsxs)(zc.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-[#1c5bde]/5 rounded-2xl p-8 border border-[#1c5bde]/10",children:[(0,Ot.jsx)("h2",{className:"text-xl font-bold mb-6 text-neutral-800",children:"Why Choose FastFind360?"}),(0,Ot.jsx)("div",{className:"space-y-6",children:[{title:"Smart Property Search",description:"Find your perfect property with our AI-powered search"},{title:"Verified Listings",description:"All properties are verified for authenticity"},{title:"Investment Opportunities",description:"Access exclusive property investment deals"},{title:"Community Development",description:"Be part of shaping infrastructure development"}].map(((e,t)=>(0,Ot.jsxs)(zc.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.3+.1*t},className:"flex gap-3",children:[(0,Ot.jsx)("div",{className:"mt-1",children:(0,Ot.jsx)(SL,{className:"h-5 w-5 text-[#1c5bde]"})}),(0,Ot.jsxs)("div",{children:[(0,Ot.jsx)("h3",{className:"font-medium text-neutral-800 mb-1",children:e.title}),(0,Ot.jsx)("p",{className:"text-sm text-neutral-600",children:e.description})]})]},t)))})]})})]})})},XL=()=>{const e=[{icon:kt,title:"Revenue Growth",value:"\u20a65B+",description:"Additional Revenue Generated"},{icon:nu,title:"Assets Optimized",value:"500+",description:"Properties Under Management"},{icon:EL,title:"Leakage Reduction",value:"40%",description:"In Revenue Leakage"},{icon:xh,title:"Collection Rate",value:"95%",description:"Success Rate"}];return(0,Ot.jsx)("div",{className:"min-h-screen bg-gray-50 pt-20",children:(0,Ot.jsx)("div",{className:"container mx-auto px-4 py-12",children:(0,Ot.jsx)(zc.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"max-w-6xl mx-auto",children:(0,Ot.jsxs)("div",{className:"space-y-12",children:[(0,Ot.jsxs)("div",{className:"text-center space-y-4",children:[(0,Ot.jsx)("h2",{className:"text-3xl font-bold",children:"Transform Government Revenue"}),(0,Ot.jsx)("p",{className:"text-gray-600 max-w-2xl mx-auto",children:"Leverage AI and blockchain technology to optimize government assets, eliminate revenue leakage, and increase collection efficiency."})]}),(0,Ot.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6",children:e.map(((e,t)=>(0,Ot.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-lg hover:shadow-xl transition-shadow",children:[(0,Ot.jsx)(e.icon,{className:"h-8 w-8 text-[#1c5bde] mb-4"}),(0,Ot.jsx)("div",{className:"text-2xl font-bold text-[#1c5bde]",children:e.value}),(0,Ot.jsx)("div",{className:"text-sm font-medium",children:e.title}),(0,Ot.jsx)("div",{className:"text-sm text-gray-600",children:e.description})]},t)))})]})})})})},YL=()=>(0,Ot.jsx)(lt,{children:(0,Ot.jsxs)("div",{className:"flex flex-col min-h-screen",children:[(0,Ot.jsx)(Fc,{}),(0,Ot.jsxs)("main",{className:"flex-grow",children:[(0,Ot.jsxs)(Me,{children:[(0,Ot.jsx)(Ee,{path:"/",element:(0,Ot.jsx)(Vu,{})}),(0,Ot.jsx)(Ee,{path:"/properties",element:(0,Ot.jsx)(Nj,{})}),(0,Ot.jsx)(Ee,{path:"/market-analysis",element:(0,Ot.jsx)(JI,{})}),(0,Ot.jsx)(Ee,{path:"/mortgage-calculator",element:(0,Ot.jsx)(hL,{})}),(0,Ot.jsx)(Ee,{path:"/roi-calculator",element:(0,Ot.jsx)(dL,{})}),(0,Ot.jsx)(Ee,{path:"/affordability-calculator",element:(0,Ot.jsx)(mL,{})}),(0,Ot.jsx)(Ee,{path:"/properties/:id",element:(0,Ot.jsx)(aj,{})}),(0,Ot.jsx)(Ee,{path:"/infrastructure-analysis",element:(0,Ot.jsx)(dh,{})}),(0,Ot.jsx)(Ee,{path:"/infrastructure-map",element:(0,Ot.jsx)(Dj,{})}),(0,Ot.jsx)(Ee,{path:"/about",element:(0,Ot.jsx)(_L,{})}),(0,Ot.jsx)(Ee,{path:"/buildfund",element:(0,Ot.jsx)(xL,{})}),(0,Ot.jsx)(Ee,{path:"/buildfund-hub",element:(0,Ot.jsx)(bL,{})}),(0,Ot.jsx)(Ee,{path:"/buildfund-hub/community-pulse",element:(0,Ot.jsx)(CL,{})}),(0,Ot.jsx)(Ee,{path:"/buildfund-hub/smart-vest",element:(0,Ot.jsx)(jL,{})}),(0,Ot.jsx)(Ee,{path:"/buildfund-hub/revenue-sense",element:(0,Ot.jsx)(XL,{})}),(0,Ot.jsx)(Ee,{path:"/infrastructure",element:(0,Ot.jsx)(FL,{})}),(0,Ot.jsx)(Ee,{path:"/infrastructure/analysis",element:(0,Ot.jsx)(dh,{})}),(0,Ot.jsx)(Ee,{path:"/infrastructure/market",element:(0,Ot.jsx)(DL,{})}),(0,Ot.jsx)(Ee,{path:"/signup",element:(0,Ot.jsx)(WL,{})}),(0,Ot.jsx)(Ee,{path:"/signin",element:(0,Ot.jsx)(HL,{})})]}),(0,Ot.jsx)(Xc,{})]}),(0,Ot.jsx)(Uj,{})]})});r.render((0,Ot.jsx)(YL,{}),document.getElementById("root"))})()})();
//# sourceMappingURL=main.f4a1c0e4.js.map